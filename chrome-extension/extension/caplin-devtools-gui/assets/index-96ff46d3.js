var __defProp = Object.defineProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};
var _a, _b;
(function polyfill() {
  const relList = document.createElement("link").relList;
  if (relList && relList.supports && relList.supports("modulepreload")) {
    return;
  }
  for (const link of document.querySelectorAll('link[rel="modulepreload"]')) {
    processPreload(link);
  }
  new MutationObserver((mutations) => {
    for (const mutation of mutations) {
      if (mutation.type !== "childList") {
        continue;
      }
      for (const node of mutation.addedNodes) {
        if (node.tagName === "LINK" && node.rel === "modulepreload")
          processPreload(node);
      }
    }
  }).observe(document, { childList: true, subtree: true });
  function getFetchOpts(link) {
    const fetchOpts = {};
    if (link.integrity)
      fetchOpts.integrity = link.integrity;
    if (link.referrerPolicy)
      fetchOpts.referrerPolicy = link.referrerPolicy;
    if (link.crossOrigin === "use-credentials")
      fetchOpts.credentials = "include";
    else if (link.crossOrigin === "anonymous")
      fetchOpts.credentials = "omit";
    else
      fetchOpts.credentials = "same-origin";
    return fetchOpts;
  }
  function processPreload(link) {
    if (link.ep)
      return;
    link.ep = true;
    const fetchOpts = getFetchOpts(link);
    fetch(link.href, fetchOpts);
  }
})();
const underline = "";
var commonjsGlobal = typeof globalThis !== "undefined" ? globalThis : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : {};
function getDefaultExportFromCjs(x2) {
  return x2 && x2.__esModule && Object.prototype.hasOwnProperty.call(x2, "default") ? x2["default"] : x2;
}
function getAugmentedNamespace(n2) {
  if (n2.__esModule)
    return n2;
  var f2 = n2.default;
  if (typeof f2 == "function") {
    var a = function a2() {
      if (this instanceof a2) {
        return Reflect.construct(f2, arguments, this.constructor);
      }
      return f2.apply(this, arguments);
    };
    a.prototype = f2.prototype;
  } else
    a = {};
  Object.defineProperty(a, "__esModule", { value: true });
  Object.keys(n2).forEach(function(k2) {
    var d = Object.getOwnPropertyDescriptor(n2, k2);
    Object.defineProperty(a, k2, d.get ? d : {
      enumerable: true,
      get: function() {
        return n2[k2];
      }
    });
  });
  return a;
}
var jsxRuntime = { exports: {} };
var reactJsxRuntime_production_min = {};
var react = { exports: {} };
var react_production_min = {};
/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var l$4 = Symbol.for("react.element"), n$2 = Symbol.for("react.portal"), p$4 = Symbol.for("react.fragment"), q$1 = Symbol.for("react.strict_mode"), r$1 = Symbol.for("react.profiler"), t$2 = Symbol.for("react.provider"), u$2 = Symbol.for("react.context"), v$2 = Symbol.for("react.forward_ref"), w$2 = Symbol.for("react.suspense"), x$2 = Symbol.for("react.memo"), y$2 = Symbol.for("react.lazy"), z$2 = Symbol.iterator;
function A$2(a) {
  if (null === a || "object" !== typeof a)
    return null;
  a = z$2 && a[z$2] || a["@@iterator"];
  return "function" === typeof a ? a : null;
}
var B$3 = { isMounted: function() {
  return false;
}, enqueueForceUpdate: function() {
}, enqueueReplaceState: function() {
}, enqueueSetState: function() {
} }, C$2 = Object.assign, D$2 = {};
function E$3(a, b, e) {
  this.props = a;
  this.context = b;
  this.refs = D$2;
  this.updater = e || B$3;
}
E$3.prototype.isReactComponent = {};
E$3.prototype.setState = function(a, b) {
  if ("object" !== typeof a && "function" !== typeof a && null != a)
    throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");
  this.updater.enqueueSetState(this, a, b, "setState");
};
E$3.prototype.forceUpdate = function(a) {
  this.updater.enqueueForceUpdate(this, a, "forceUpdate");
};
function F$1() {
}
F$1.prototype = E$3.prototype;
function G$2(a, b, e) {
  this.props = a;
  this.context = b;
  this.refs = D$2;
  this.updater = e || B$3;
}
var H$3 = G$2.prototype = new F$1();
H$3.constructor = G$2;
C$2(H$3, E$3.prototype);
H$3.isPureReactComponent = true;
var I$3 = Array.isArray, J$2 = Object.prototype.hasOwnProperty, K$3 = { current: null }, L$3 = { key: true, ref: true, __self: true, __source: true };
function M$3(a, b, e) {
  var d, c = {}, k2 = null, h = null;
  if (null != b)
    for (d in void 0 !== b.ref && (h = b.ref), void 0 !== b.key && (k2 = "" + b.key), b)
      J$2.call(b, d) && !L$3.hasOwnProperty(d) && (c[d] = b[d]);
  var g = arguments.length - 2;
  if (1 === g)
    c.children = e;
  else if (1 < g) {
    for (var f2 = Array(g), m2 = 0; m2 < g; m2++)
      f2[m2] = arguments[m2 + 2];
    c.children = f2;
  }
  if (a && a.defaultProps)
    for (d in g = a.defaultProps, g)
      void 0 === c[d] && (c[d] = g[d]);
  return { $$typeof: l$4, type: a, key: k2, ref: h, props: c, _owner: K$3.current };
}
function N$3(a, b) {
  return { $$typeof: l$4, type: a.type, key: b, ref: a.ref, props: a.props, _owner: a._owner };
}
function O$3(a) {
  return "object" === typeof a && null !== a && a.$$typeof === l$4;
}
function escape(a) {
  var b = { "=": "=0", ":": "=2" };
  return "$" + a.replace(/[=:]/g, function(a2) {
    return b[a2];
  });
}
var P$3 = /\/+/g;
function Q$3(a, b) {
  return "object" === typeof a && null !== a && null != a.key ? escape("" + a.key) : b.toString(36);
}
function R$4(a, b, e, d, c) {
  var k2 = typeof a;
  if ("undefined" === k2 || "boolean" === k2)
    a = null;
  var h = false;
  if (null === a)
    h = true;
  else
    switch (k2) {
      case "string":
      case "number":
        h = true;
        break;
      case "object":
        switch (a.$$typeof) {
          case l$4:
          case n$2:
            h = true;
        }
    }
  if (h)
    return h = a, c = c(h), a = "" === d ? "." + Q$3(h, 0) : d, I$3(c) ? (e = "", null != a && (e = a.replace(P$3, "$&/") + "/"), R$4(c, b, e, "", function(a2) {
      return a2;
    })) : null != c && (O$3(c) && (c = N$3(c, e + (!c.key || h && h.key === c.key ? "" : ("" + c.key).replace(P$3, "$&/") + "/") + a)), b.push(c)), 1;
  h = 0;
  d = "" === d ? "." : d + ":";
  if (I$3(a))
    for (var g = 0; g < a.length; g++) {
      k2 = a[g];
      var f2 = d + Q$3(k2, g);
      h += R$4(k2, b, e, f2, c);
    }
  else if (f2 = A$2(a), "function" === typeof f2)
    for (a = f2.call(a), g = 0; !(k2 = a.next()).done; )
      k2 = k2.value, f2 = d + Q$3(k2, g++), h += R$4(k2, b, e, f2, c);
  else if ("object" === k2)
    throw b = String(a), Error("Objects are not valid as a React child (found: " + ("[object Object]" === b ? "object with keys {" + Object.keys(a).join(", ") + "}" : b) + "). If you meant to render a collection of children, use an array instead.");
  return h;
}
function S$3(a, b, e) {
  if (null == a)
    return a;
  var d = [], c = 0;
  R$4(a, d, "", "", function(a2) {
    return b.call(e, a2, c++);
  });
  return d;
}
function T$3(a) {
  if (-1 === a._status) {
    var b = a._result;
    b = b();
    b.then(function(b2) {
      if (0 === a._status || -1 === a._status)
        a._status = 1, a._result = b2;
    }, function(b2) {
      if (0 === a._status || -1 === a._status)
        a._status = 2, a._result = b2;
    });
    -1 === a._status && (a._status = 0, a._result = b);
  }
  if (1 === a._status)
    return a._result.default;
  throw a._result;
}
var U$3 = { current: null }, V$3 = { transition: null }, W$3 = { ReactCurrentDispatcher: U$3, ReactCurrentBatchConfig: V$3, ReactCurrentOwner: K$3 };
react_production_min.Children = { map: S$3, forEach: function(a, b, e) {
  S$3(a, function() {
    b.apply(this, arguments);
  }, e);
}, count: function(a) {
  var b = 0;
  S$3(a, function() {
    b++;
  });
  return b;
}, toArray: function(a) {
  return S$3(a, function(a2) {
    return a2;
  }) || [];
}, only: function(a) {
  if (!O$3(a))
    throw Error("React.Children.only expected to receive a single React element child.");
  return a;
} };
react_production_min.Component = E$3;
react_production_min.Fragment = p$4;
react_production_min.Profiler = r$1;
react_production_min.PureComponent = G$2;
react_production_min.StrictMode = q$1;
react_production_min.Suspense = w$2;
react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED = W$3;
react_production_min.cloneElement = function(a, b, e) {
  if (null === a || void 0 === a)
    throw Error("React.cloneElement(...): The argument must be a React element, but you passed " + a + ".");
  var d = C$2({}, a.props), c = a.key, k2 = a.ref, h = a._owner;
  if (null != b) {
    void 0 !== b.ref && (k2 = b.ref, h = K$3.current);
    void 0 !== b.key && (c = "" + b.key);
    if (a.type && a.type.defaultProps)
      var g = a.type.defaultProps;
    for (f2 in b)
      J$2.call(b, f2) && !L$3.hasOwnProperty(f2) && (d[f2] = void 0 === b[f2] && void 0 !== g ? g[f2] : b[f2]);
  }
  var f2 = arguments.length - 2;
  if (1 === f2)
    d.children = e;
  else if (1 < f2) {
    g = Array(f2);
    for (var m2 = 0; m2 < f2; m2++)
      g[m2] = arguments[m2 + 2];
    d.children = g;
  }
  return { $$typeof: l$4, type: a.type, key: c, ref: k2, props: d, _owner: h };
};
react_production_min.createContext = function(a) {
  a = { $$typeof: u$2, _currentValue: a, _currentValue2: a, _threadCount: 0, Provider: null, Consumer: null, _defaultValue: null, _globalName: null };
  a.Provider = { $$typeof: t$2, _context: a };
  return a.Consumer = a;
};
react_production_min.createElement = M$3;
react_production_min.createFactory = function(a) {
  var b = M$3.bind(null, a);
  b.type = a;
  return b;
};
react_production_min.createRef = function() {
  return { current: null };
};
react_production_min.forwardRef = function(a) {
  return { $$typeof: v$2, render: a };
};
react_production_min.isValidElement = O$3;
react_production_min.lazy = function(a) {
  return { $$typeof: y$2, _payload: { _status: -1, _result: a }, _init: T$3 };
};
react_production_min.memo = function(a, b) {
  return { $$typeof: x$2, type: a, compare: void 0 === b ? null : b };
};
react_production_min.startTransition = function(a) {
  var b = V$3.transition;
  V$3.transition = {};
  try {
    a();
  } finally {
    V$3.transition = b;
  }
};
react_production_min.unstable_act = function() {
  throw Error("act(...) is not supported in production builds of React.");
};
react_production_min.useCallback = function(a, b) {
  return U$3.current.useCallback(a, b);
};
react_production_min.useContext = function(a) {
  return U$3.current.useContext(a);
};
react_production_min.useDebugValue = function() {
};
react_production_min.useDeferredValue = function(a) {
  return U$3.current.useDeferredValue(a);
};
react_production_min.useEffect = function(a, b) {
  return U$3.current.useEffect(a, b);
};
react_production_min.useId = function() {
  return U$3.current.useId();
};
react_production_min.useImperativeHandle = function(a, b, e) {
  return U$3.current.useImperativeHandle(a, b, e);
};
react_production_min.useInsertionEffect = function(a, b) {
  return U$3.current.useInsertionEffect(a, b);
};
react_production_min.useLayoutEffect = function(a, b) {
  return U$3.current.useLayoutEffect(a, b);
};
react_production_min.useMemo = function(a, b) {
  return U$3.current.useMemo(a, b);
};
react_production_min.useReducer = function(a, b, e) {
  return U$3.current.useReducer(a, b, e);
};
react_production_min.useRef = function(a) {
  return U$3.current.useRef(a);
};
react_production_min.useState = function(a) {
  return U$3.current.useState(a);
};
react_production_min.useSyncExternalStore = function(a, b, e) {
  return U$3.current.useSyncExternalStore(a, b, e);
};
react_production_min.useTransition = function() {
  return U$3.current.useTransition();
};
react_production_min.version = "18.2.0";
{
  react.exports = react_production_min;
}
var reactExports = react.exports;
const React = /* @__PURE__ */ getDefaultExportFromCjs(reactExports);
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var f = reactExports, k$1 = Symbol.for("react.element"), l$3 = Symbol.for("react.fragment"), m$1 = Object.prototype.hasOwnProperty, n$1 = f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner, p$3 = { key: true, ref: true, __self: true, __source: true };
function q(c, a, g) {
  var b, d = {}, e = null, h = null;
  void 0 !== g && (e = "" + g);
  void 0 !== a.key && (e = "" + a.key);
  void 0 !== a.ref && (h = a.ref);
  for (b in a)
    m$1.call(a, b) && !p$3.hasOwnProperty(b) && (d[b] = a[b]);
  if (c && c.defaultProps)
    for (b in a = c.defaultProps, a)
      void 0 === d[b] && (d[b] = a[b]);
  return { $$typeof: k$1, type: c, key: e, ref: h, props: d, _owner: n$1.current };
}
reactJsxRuntime_production_min.Fragment = l$3;
reactJsxRuntime_production_min.jsx = q;
reactJsxRuntime_production_min.jsxs = q;
{
  jsxRuntime.exports = reactJsxRuntime_production_min;
}
var jsxRuntimeExports = jsxRuntime.exports;
var reactDom = { exports: {} };
var reactDom_production_min = {};
var scheduler = { exports: {} };
var scheduler_production_min = {};
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
(function(exports) {
  function f2(a, b) {
    var c = a.length;
    a.push(b);
    a:
      for (; 0 < c; ) {
        var d = c - 1 >>> 1, e = a[d];
        if (0 < g(e, b))
          a[d] = b, a[c] = e, c = d;
        else
          break a;
      }
  }
  function h(a) {
    return 0 === a.length ? null : a[0];
  }
  function k2(a) {
    if (0 === a.length)
      return null;
    var b = a[0], c = a.pop();
    if (c !== b) {
      a[0] = c;
      a:
        for (var d = 0, e = a.length, w2 = e >>> 1; d < w2; ) {
          var m2 = 2 * (d + 1) - 1, C2 = a[m2], n2 = m2 + 1, x2 = a[n2];
          if (0 > g(C2, c))
            n2 < e && 0 > g(x2, C2) ? (a[d] = x2, a[n2] = c, d = n2) : (a[d] = C2, a[m2] = c, d = m2);
          else if (n2 < e && 0 > g(x2, c))
            a[d] = x2, a[n2] = c, d = n2;
          else
            break a;
        }
    }
    return b;
  }
  function g(a, b) {
    var c = a.sortIndex - b.sortIndex;
    return 0 !== c ? c : a.id - b.id;
  }
  if ("object" === typeof performance && "function" === typeof performance.now) {
    var l2 = performance;
    exports.unstable_now = function() {
      return l2.now();
    };
  } else {
    var p2 = Date, q2 = p2.now();
    exports.unstable_now = function() {
      return p2.now() - q2;
    };
  }
  var r2 = [], t2 = [], u2 = 1, v2 = null, y2 = 3, z2 = false, A2 = false, B2 = false, D2 = "function" === typeof setTimeout ? setTimeout : null, E2 = "function" === typeof clearTimeout ? clearTimeout : null, F2 = "undefined" !== typeof setImmediate ? setImmediate : null;
  "undefined" !== typeof navigator && void 0 !== navigator.scheduling && void 0 !== navigator.scheduling.isInputPending && navigator.scheduling.isInputPending.bind(navigator.scheduling);
  function G2(a) {
    for (var b = h(t2); null !== b; ) {
      if (null === b.callback)
        k2(t2);
      else if (b.startTime <= a)
        k2(t2), b.sortIndex = b.expirationTime, f2(r2, b);
      else
        break;
      b = h(t2);
    }
  }
  function H2(a) {
    B2 = false;
    G2(a);
    if (!A2)
      if (null !== h(r2))
        A2 = true, I2(J2);
      else {
        var b = h(t2);
        null !== b && K2(H2, b.startTime - a);
      }
  }
  function J2(a, b) {
    A2 = false;
    B2 && (B2 = false, E2(L2), L2 = -1);
    z2 = true;
    var c = y2;
    try {
      G2(b);
      for (v2 = h(r2); null !== v2 && (!(v2.expirationTime > b) || a && !M2()); ) {
        var d = v2.callback;
        if ("function" === typeof d) {
          v2.callback = null;
          y2 = v2.priorityLevel;
          var e = d(v2.expirationTime <= b);
          b = exports.unstable_now();
          "function" === typeof e ? v2.callback = e : v2 === h(r2) && k2(r2);
          G2(b);
        } else
          k2(r2);
        v2 = h(r2);
      }
      if (null !== v2)
        var w2 = true;
      else {
        var m2 = h(t2);
        null !== m2 && K2(H2, m2.startTime - b);
        w2 = false;
      }
      return w2;
    } finally {
      v2 = null, y2 = c, z2 = false;
    }
  }
  var N2 = false, O2 = null, L2 = -1, P2 = 5, Q2 = -1;
  function M2() {
    return exports.unstable_now() - Q2 < P2 ? false : true;
  }
  function R2() {
    if (null !== O2) {
      var a = exports.unstable_now();
      Q2 = a;
      var b = true;
      try {
        b = O2(true, a);
      } finally {
        b ? S2() : (N2 = false, O2 = null);
      }
    } else
      N2 = false;
  }
  var S2;
  if ("function" === typeof F2)
    S2 = function() {
      F2(R2);
    };
  else if ("undefined" !== typeof MessageChannel) {
    var T2 = new MessageChannel(), U2 = T2.port2;
    T2.port1.onmessage = R2;
    S2 = function() {
      U2.postMessage(null);
    };
  } else
    S2 = function() {
      D2(R2, 0);
    };
  function I2(a) {
    O2 = a;
    N2 || (N2 = true, S2());
  }
  function K2(a, b) {
    L2 = D2(function() {
      a(exports.unstable_now());
    }, b);
  }
  exports.unstable_IdlePriority = 5;
  exports.unstable_ImmediatePriority = 1;
  exports.unstable_LowPriority = 4;
  exports.unstable_NormalPriority = 3;
  exports.unstable_Profiling = null;
  exports.unstable_UserBlockingPriority = 2;
  exports.unstable_cancelCallback = function(a) {
    a.callback = null;
  };
  exports.unstable_continueExecution = function() {
    A2 || z2 || (A2 = true, I2(J2));
  };
  exports.unstable_forceFrameRate = function(a) {
    0 > a || 125 < a ? console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported") : P2 = 0 < a ? Math.floor(1e3 / a) : 5;
  };
  exports.unstable_getCurrentPriorityLevel = function() {
    return y2;
  };
  exports.unstable_getFirstCallbackNode = function() {
    return h(r2);
  };
  exports.unstable_next = function(a) {
    switch (y2) {
      case 1:
      case 2:
      case 3:
        var b = 3;
        break;
      default:
        b = y2;
    }
    var c = y2;
    y2 = b;
    try {
      return a();
    } finally {
      y2 = c;
    }
  };
  exports.unstable_pauseExecution = function() {
  };
  exports.unstable_requestPaint = function() {
  };
  exports.unstable_runWithPriority = function(a, b) {
    switch (a) {
      case 1:
      case 2:
      case 3:
      case 4:
      case 5:
        break;
      default:
        a = 3;
    }
    var c = y2;
    y2 = a;
    try {
      return b();
    } finally {
      y2 = c;
    }
  };
  exports.unstable_scheduleCallback = function(a, b, c) {
    var d = exports.unstable_now();
    "object" === typeof c && null !== c ? (c = c.delay, c = "number" === typeof c && 0 < c ? d + c : d) : c = d;
    switch (a) {
      case 1:
        var e = -1;
        break;
      case 2:
        e = 250;
        break;
      case 5:
        e = 1073741823;
        break;
      case 4:
        e = 1e4;
        break;
      default:
        e = 5e3;
    }
    e = c + e;
    a = { id: u2++, callback: b, priorityLevel: a, startTime: c, expirationTime: e, sortIndex: -1 };
    c > d ? (a.sortIndex = c, f2(t2, a), null === h(r2) && a === h(t2) && (B2 ? (E2(L2), L2 = -1) : B2 = true, K2(H2, c - d))) : (a.sortIndex = e, f2(r2, a), A2 || z2 || (A2 = true, I2(J2)));
    return a;
  };
  exports.unstable_shouldYield = M2;
  exports.unstable_wrapCallback = function(a) {
    var b = y2;
    return function() {
      var c = y2;
      y2 = b;
      try {
        return a.apply(this, arguments);
      } finally {
        y2 = c;
      }
    };
  };
})(scheduler_production_min);
{
  scheduler.exports = scheduler_production_min;
}
var schedulerExports = scheduler.exports;
/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var aa$2 = reactExports, ca$1 = schedulerExports;
function p$2(a) {
  for (var b = "https://reactjs.org/docs/error-decoder.html?invariant=" + a, c = 1; c < arguments.length; c++)
    b += "&args[]=" + encodeURIComponent(arguments[c]);
  return "Minified React error #" + a + "; visit " + b + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
}
var da$1 = /* @__PURE__ */ new Set(), ea$1 = {};
function fa$2(a, b) {
  ha$2(a, b);
  ha$2(a + "Capture", b);
}
function ha$2(a, b) {
  ea$1[a] = b;
  for (a = 0; a < b.length; a++)
    da$1.add(b[a]);
}
var ia$2 = !("undefined" === typeof window || "undefined" === typeof window.document || "undefined" === typeof window.document.createElement), ja$2 = Object.prototype.hasOwnProperty, ka$2 = /^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/, la$2 = {}, ma$1 = {};
function oa$2(a) {
  if (ja$2.call(ma$1, a))
    return true;
  if (ja$2.call(la$2, a))
    return false;
  if (ka$2.test(a))
    return ma$1[a] = true;
  la$2[a] = true;
  return false;
}
function pa$2(a, b, c, d) {
  if (null !== c && 0 === c.type)
    return false;
  switch (typeof b) {
    case "function":
    case "symbol":
      return true;
    case "boolean":
      if (d)
        return false;
      if (null !== c)
        return !c.acceptsBooleans;
      a = a.toLowerCase().slice(0, 5);
      return "data-" !== a && "aria-" !== a;
    default:
      return false;
  }
}
function qa$2(a, b, c, d) {
  if (null === b || "undefined" === typeof b || pa$2(a, b, c, d))
    return true;
  if (d)
    return false;
  if (null !== c)
    switch (c.type) {
      case 3:
        return !b;
      case 4:
        return false === b;
      case 5:
        return isNaN(b);
      case 6:
        return isNaN(b) || 1 > b;
    }
  return false;
}
function v$1(a, b, c, d, e, f2, g) {
  this.acceptsBooleans = 2 === b || 3 === b || 4 === b;
  this.attributeName = d;
  this.attributeNamespace = e;
  this.mustUseProperty = c;
  this.propertyName = a;
  this.type = b;
  this.sanitizeURL = f2;
  this.removeEmptyString = g;
}
var z$1 = {};
"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a) {
  z$1[a] = new v$1(a, 0, false, a, null, false, false);
});
[["acceptCharset", "accept-charset"], ["className", "class"], ["htmlFor", "for"], ["httpEquiv", "http-equiv"]].forEach(function(a) {
  var b = a[0];
  z$1[b] = new v$1(b, 1, false, a[1], null, false, false);
});
["contentEditable", "draggable", "spellCheck", "value"].forEach(function(a) {
  z$1[a] = new v$1(a, 2, false, a.toLowerCase(), null, false, false);
});
["autoReverse", "externalResourcesRequired", "focusable", "preserveAlpha"].forEach(function(a) {
  z$1[a] = new v$1(a, 2, false, a, null, false, false);
});
"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a) {
  z$1[a] = new v$1(a, 3, false, a.toLowerCase(), null, false, false);
});
["checked", "multiple", "muted", "selected"].forEach(function(a) {
  z$1[a] = new v$1(a, 3, true, a, null, false, false);
});
["capture", "download"].forEach(function(a) {
  z$1[a] = new v$1(a, 4, false, a, null, false, false);
});
["cols", "rows", "size", "span"].forEach(function(a) {
  z$1[a] = new v$1(a, 6, false, a, null, false, false);
});
["rowSpan", "start"].forEach(function(a) {
  z$1[a] = new v$1(a, 5, false, a.toLowerCase(), null, false, false);
});
var ra$2 = /[\-:]([a-z])/g;
function sa$2(a) {
  return a[1].toUpperCase();
}
"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a) {
  var b = a.replace(
    ra$2,
    sa$2
  );
  z$1[b] = new v$1(b, 1, false, a, null, false, false);
});
"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a) {
  var b = a.replace(ra$2, sa$2);
  z$1[b] = new v$1(b, 1, false, a, "http://www.w3.org/1999/xlink", false, false);
});
["xml:base", "xml:lang", "xml:space"].forEach(function(a) {
  var b = a.replace(ra$2, sa$2);
  z$1[b] = new v$1(b, 1, false, a, "http://www.w3.org/XML/1998/namespace", false, false);
});
["tabIndex", "crossOrigin"].forEach(function(a) {
  z$1[a] = new v$1(a, 1, false, a.toLowerCase(), null, false, false);
});
z$1.xlinkHref = new v$1("xlinkHref", 1, false, "xlink:href", "http://www.w3.org/1999/xlink", true, false);
["src", "href", "action", "formAction"].forEach(function(a) {
  z$1[a] = new v$1(a, 1, false, a.toLowerCase(), null, true, true);
});
function ta$2(a, b, c, d) {
  var e = z$1.hasOwnProperty(b) ? z$1[b] : null;
  if (null !== e ? 0 !== e.type : d || !(2 < b.length) || "o" !== b[0] && "O" !== b[0] || "n" !== b[1] && "N" !== b[1])
    qa$2(b, c, e, d) && (c = null), d || null === e ? oa$2(b) && (null === c ? a.removeAttribute(b) : a.setAttribute(b, "" + c)) : e.mustUseProperty ? a[e.propertyName] = null === c ? 3 === e.type ? false : "" : c : (b = e.attributeName, d = e.attributeNamespace, null === c ? a.removeAttribute(b) : (e = e.type, c = 3 === e || 4 === e && true === c ? "" : "" + c, d ? a.setAttributeNS(d, b, c) : a.setAttribute(b, c)));
}
var ua$2 = aa$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED, va$2 = Symbol.for("react.element"), wa$2 = Symbol.for("react.portal"), ya$2 = Symbol.for("react.fragment"), za$2 = Symbol.for("react.strict_mode"), Aa$2 = Symbol.for("react.profiler"), Ba$2 = Symbol.for("react.provider"), Ca$2 = Symbol.for("react.context"), Da$2 = Symbol.for("react.forward_ref"), Ea$2 = Symbol.for("react.suspense"), Fa$2 = Symbol.for("react.suspense_list"), Ga$2 = Symbol.for("react.memo"), Ha$2 = Symbol.for("react.lazy");
var Ia$2 = Symbol.for("react.offscreen");
var Ja$2 = Symbol.iterator;
function Ka$2(a) {
  if (null === a || "object" !== typeof a)
    return null;
  a = Ja$2 && a[Ja$2] || a["@@iterator"];
  return "function" === typeof a ? a : null;
}
var A$1 = Object.assign, La$2;
function Ma$2(a) {
  if (void 0 === La$2)
    try {
      throw Error();
    } catch (c) {
      var b = c.stack.trim().match(/\n( *(at )?)/);
      La$2 = b && b[1] || "";
    }
  return "\n" + La$2 + a;
}
var Na$2 = false;
function Oa$2(a, b) {
  if (!a || Na$2)
    return "";
  Na$2 = true;
  var c = Error.prepareStackTrace;
  Error.prepareStackTrace = void 0;
  try {
    if (b)
      if (b = function() {
        throw Error();
      }, Object.defineProperty(b.prototype, "props", { set: function() {
        throw Error();
      } }), "object" === typeof Reflect && Reflect.construct) {
        try {
          Reflect.construct(b, []);
        } catch (l2) {
          var d = l2;
        }
        Reflect.construct(a, [], b);
      } else {
        try {
          b.call();
        } catch (l2) {
          d = l2;
        }
        a.call(b.prototype);
      }
    else {
      try {
        throw Error();
      } catch (l2) {
        d = l2;
      }
      a();
    }
  } catch (l2) {
    if (l2 && d && "string" === typeof l2.stack) {
      for (var e = l2.stack.split("\n"), f2 = d.stack.split("\n"), g = e.length - 1, h = f2.length - 1; 1 <= g && 0 <= h && e[g] !== f2[h]; )
        h--;
      for (; 1 <= g && 0 <= h; g--, h--)
        if (e[g] !== f2[h]) {
          if (1 !== g || 1 !== h) {
            do
              if (g--, h--, 0 > h || e[g] !== f2[h]) {
                var k2 = "\n" + e[g].replace(" at new ", " at ");
                a.displayName && k2.includes("<anonymous>") && (k2 = k2.replace("<anonymous>", a.displayName));
                return k2;
              }
            while (1 <= g && 0 <= h);
          }
          break;
        }
    }
  } finally {
    Na$2 = false, Error.prepareStackTrace = c;
  }
  return (a = a ? a.displayName || a.name : "") ? Ma$2(a) : "";
}
function Pa$2(a) {
  switch (a.tag) {
    case 5:
      return Ma$2(a.type);
    case 16:
      return Ma$2("Lazy");
    case 13:
      return Ma$2("Suspense");
    case 19:
      return Ma$2("SuspenseList");
    case 0:
    case 2:
    case 15:
      return a = Oa$2(a.type, false), a;
    case 11:
      return a = Oa$2(a.type.render, false), a;
    case 1:
      return a = Oa$2(a.type, true), a;
    default:
      return "";
  }
}
function Qa$2(a) {
  if (null == a)
    return null;
  if ("function" === typeof a)
    return a.displayName || a.name || null;
  if ("string" === typeof a)
    return a;
  switch (a) {
    case ya$2:
      return "Fragment";
    case wa$2:
      return "Portal";
    case Aa$2:
      return "Profiler";
    case za$2:
      return "StrictMode";
    case Ea$2:
      return "Suspense";
    case Fa$2:
      return "SuspenseList";
  }
  if ("object" === typeof a)
    switch (a.$$typeof) {
      case Ca$2:
        return (a.displayName || "Context") + ".Consumer";
      case Ba$2:
        return (a._context.displayName || "Context") + ".Provider";
      case Da$2:
        var b = a.render;
        a = a.displayName;
        a || (a = b.displayName || b.name || "", a = "" !== a ? "ForwardRef(" + a + ")" : "ForwardRef");
        return a;
      case Ga$2:
        return b = a.displayName || null, null !== b ? b : Qa$2(a.type) || "Memo";
      case Ha$2:
        b = a._payload;
        a = a._init;
        try {
          return Qa$2(a(b));
        } catch (c) {
        }
    }
  return null;
}
function Ra$2(a) {
  var b = a.type;
  switch (a.tag) {
    case 24:
      return "Cache";
    case 9:
      return (b.displayName || "Context") + ".Consumer";
    case 10:
      return (b._context.displayName || "Context") + ".Provider";
    case 18:
      return "DehydratedFragment";
    case 11:
      return a = b.render, a = a.displayName || a.name || "", b.displayName || ("" !== a ? "ForwardRef(" + a + ")" : "ForwardRef");
    case 7:
      return "Fragment";
    case 5:
      return b;
    case 4:
      return "Portal";
    case 3:
      return "Root";
    case 6:
      return "Text";
    case 16:
      return Qa$2(b);
    case 8:
      return b === za$2 ? "StrictMode" : "Mode";
    case 22:
      return "Offscreen";
    case 12:
      return "Profiler";
    case 21:
      return "Scope";
    case 13:
      return "Suspense";
    case 19:
      return "SuspenseList";
    case 25:
      return "TracingMarker";
    case 1:
    case 0:
    case 17:
    case 2:
    case 14:
    case 15:
      if ("function" === typeof b)
        return b.displayName || b.name || null;
      if ("string" === typeof b)
        return b;
  }
  return null;
}
function Sa$2(a) {
  switch (typeof a) {
    case "boolean":
    case "number":
    case "string":
    case "undefined":
      return a;
    case "object":
      return a;
    default:
      return "";
  }
}
function Ta$2(a) {
  var b = a.type;
  return (a = a.nodeName) && "input" === a.toLowerCase() && ("checkbox" === b || "radio" === b);
}
function Ua$2(a) {
  var b = Ta$2(a) ? "checked" : "value", c = Object.getOwnPropertyDescriptor(a.constructor.prototype, b), d = "" + a[b];
  if (!a.hasOwnProperty(b) && "undefined" !== typeof c && "function" === typeof c.get && "function" === typeof c.set) {
    var e = c.get, f2 = c.set;
    Object.defineProperty(a, b, { configurable: true, get: function() {
      return e.call(this);
    }, set: function(a2) {
      d = "" + a2;
      f2.call(this, a2);
    } });
    Object.defineProperty(a, b, { enumerable: c.enumerable });
    return { getValue: function() {
      return d;
    }, setValue: function(a2) {
      d = "" + a2;
    }, stopTracking: function() {
      a._valueTracker = null;
      delete a[b];
    } };
  }
}
function Va$2(a) {
  a._valueTracker || (a._valueTracker = Ua$2(a));
}
function Wa$2(a) {
  if (!a)
    return false;
  var b = a._valueTracker;
  if (!b)
    return true;
  var c = b.getValue();
  var d = "";
  a && (d = Ta$2(a) ? a.checked ? "true" : "false" : a.value);
  a = d;
  return a !== c ? (b.setValue(a), true) : false;
}
function Xa$2(a) {
  a = a || ("undefined" !== typeof document ? document : void 0);
  if ("undefined" === typeof a)
    return null;
  try {
    return a.activeElement || a.body;
  } catch (b) {
    return a.body;
  }
}
function Ya$2(a, b) {
  var c = b.checked;
  return A$1({}, b, { defaultChecked: void 0, defaultValue: void 0, value: void 0, checked: null != c ? c : a._wrapperState.initialChecked });
}
function Za$2(a, b) {
  var c = null == b.defaultValue ? "" : b.defaultValue, d = null != b.checked ? b.checked : b.defaultChecked;
  c = Sa$2(null != b.value ? b.value : c);
  a._wrapperState = { initialChecked: d, initialValue: c, controlled: "checkbox" === b.type || "radio" === b.type ? null != b.checked : null != b.value };
}
function ab$2(a, b) {
  b = b.checked;
  null != b && ta$2(a, "checked", b, false);
}
function bb$2(a, b) {
  ab$2(a, b);
  var c = Sa$2(b.value), d = b.type;
  if (null != c)
    if ("number" === d) {
      if (0 === c && "" === a.value || a.value != c)
        a.value = "" + c;
    } else
      a.value !== "" + c && (a.value = "" + c);
  else if ("submit" === d || "reset" === d) {
    a.removeAttribute("value");
    return;
  }
  b.hasOwnProperty("value") ? cb$2(a, b.type, c) : b.hasOwnProperty("defaultValue") && cb$2(a, b.type, Sa$2(b.defaultValue));
  null == b.checked && null != b.defaultChecked && (a.defaultChecked = !!b.defaultChecked);
}
function db$2(a, b, c) {
  if (b.hasOwnProperty("value") || b.hasOwnProperty("defaultValue")) {
    var d = b.type;
    if (!("submit" !== d && "reset" !== d || void 0 !== b.value && null !== b.value))
      return;
    b = "" + a._wrapperState.initialValue;
    c || b === a.value || (a.value = b);
    a.defaultValue = b;
  }
  c = a.name;
  "" !== c && (a.name = "");
  a.defaultChecked = !!a._wrapperState.initialChecked;
  "" !== c && (a.name = c);
}
function cb$2(a, b, c) {
  if ("number" !== b || Xa$2(a.ownerDocument) !== a)
    null == c ? a.defaultValue = "" + a._wrapperState.initialValue : a.defaultValue !== "" + c && (a.defaultValue = "" + c);
}
var eb$2 = Array.isArray;
function fb$2(a, b, c, d) {
  a = a.options;
  if (b) {
    b = {};
    for (var e = 0; e < c.length; e++)
      b["$" + c[e]] = true;
    for (c = 0; c < a.length; c++)
      e = b.hasOwnProperty("$" + a[c].value), a[c].selected !== e && (a[c].selected = e), e && d && (a[c].defaultSelected = true);
  } else {
    c = "" + Sa$2(c);
    b = null;
    for (e = 0; e < a.length; e++) {
      if (a[e].value === c) {
        a[e].selected = true;
        d && (a[e].defaultSelected = true);
        return;
      }
      null !== b || a[e].disabled || (b = a[e]);
    }
    null !== b && (b.selected = true);
  }
}
function gb$2(a, b) {
  if (null != b.dangerouslySetInnerHTML)
    throw Error(p$2(91));
  return A$1({}, b, { value: void 0, defaultValue: void 0, children: "" + a._wrapperState.initialValue });
}
function hb$2(a, b) {
  var c = b.value;
  if (null == c) {
    c = b.children;
    b = b.defaultValue;
    if (null != c) {
      if (null != b)
        throw Error(p$2(92));
      if (eb$2(c)) {
        if (1 < c.length)
          throw Error(p$2(93));
        c = c[0];
      }
      b = c;
    }
    null == b && (b = "");
    c = b;
  }
  a._wrapperState = { initialValue: Sa$2(c) };
}
function ib$2(a, b) {
  var c = Sa$2(b.value), d = Sa$2(b.defaultValue);
  null != c && (c = "" + c, c !== a.value && (a.value = c), null == b.defaultValue && a.defaultValue !== c && (a.defaultValue = c));
  null != d && (a.defaultValue = "" + d);
}
function jb$2(a) {
  var b = a.textContent;
  b === a._wrapperState.initialValue && "" !== b && null !== b && (a.value = b);
}
function kb$2(a) {
  switch (a) {
    case "svg":
      return "http://www.w3.org/2000/svg";
    case "math":
      return "http://www.w3.org/1998/Math/MathML";
    default:
      return "http://www.w3.org/1999/xhtml";
  }
}
function lb$2(a, b) {
  return null == a || "http://www.w3.org/1999/xhtml" === a ? kb$2(b) : "http://www.w3.org/2000/svg" === a && "foreignObject" === b ? "http://www.w3.org/1999/xhtml" : a;
}
var mb$1, nb$1 = function(a) {
  return "undefined" !== typeof MSApp && MSApp.execUnsafeLocalFunction ? function(b, c, d, e) {
    MSApp.execUnsafeLocalFunction(function() {
      return a(b, c, d, e);
    });
  } : a;
}(function(a, b) {
  if ("http://www.w3.org/2000/svg" !== a.namespaceURI || "innerHTML" in a)
    a.innerHTML = b;
  else {
    mb$1 = mb$1 || document.createElement("div");
    mb$1.innerHTML = "<svg>" + b.valueOf().toString() + "</svg>";
    for (b = mb$1.firstChild; a.firstChild; )
      a.removeChild(a.firstChild);
    for (; b.firstChild; )
      a.appendChild(b.firstChild);
  }
});
function ob$2(a, b) {
  if (b) {
    var c = a.firstChild;
    if (c && c === a.lastChild && 3 === c.nodeType) {
      c.nodeValue = b;
      return;
    }
  }
  a.textContent = b;
}
var pb$2 = {
  animationIterationCount: true,
  aspectRatio: true,
  borderImageOutset: true,
  borderImageSlice: true,
  borderImageWidth: true,
  boxFlex: true,
  boxFlexGroup: true,
  boxOrdinalGroup: true,
  columnCount: true,
  columns: true,
  flex: true,
  flexGrow: true,
  flexPositive: true,
  flexShrink: true,
  flexNegative: true,
  flexOrder: true,
  gridArea: true,
  gridRow: true,
  gridRowEnd: true,
  gridRowSpan: true,
  gridRowStart: true,
  gridColumn: true,
  gridColumnEnd: true,
  gridColumnSpan: true,
  gridColumnStart: true,
  fontWeight: true,
  lineClamp: true,
  lineHeight: true,
  opacity: true,
  order: true,
  orphans: true,
  tabSize: true,
  widows: true,
  zIndex: true,
  zoom: true,
  fillOpacity: true,
  floodOpacity: true,
  stopOpacity: true,
  strokeDasharray: true,
  strokeDashoffset: true,
  strokeMiterlimit: true,
  strokeOpacity: true,
  strokeWidth: true
}, qb$2 = ["Webkit", "ms", "Moz", "O"];
Object.keys(pb$2).forEach(function(a) {
  qb$2.forEach(function(b) {
    b = b + a.charAt(0).toUpperCase() + a.substring(1);
    pb$2[b] = pb$2[a];
  });
});
function rb$2(a, b, c) {
  return null == b || "boolean" === typeof b || "" === b ? "" : c || "number" !== typeof b || 0 === b || pb$2.hasOwnProperty(a) && pb$2[a] ? ("" + b).trim() : b + "px";
}
function sb$2(a, b) {
  a = a.style;
  for (var c in b)
    if (b.hasOwnProperty(c)) {
      var d = 0 === c.indexOf("--"), e = rb$2(c, b[c], d);
      "float" === c && (c = "cssFloat");
      d ? a.setProperty(c, e) : a[c] = e;
    }
}
var tb$2 = A$1({ menuitem: true }, { area: true, base: true, br: true, col: true, embed: true, hr: true, img: true, input: true, keygen: true, link: true, meta: true, param: true, source: true, track: true, wbr: true });
function ub$2(a, b) {
  if (b) {
    if (tb$2[a] && (null != b.children || null != b.dangerouslySetInnerHTML))
      throw Error(p$2(137, a));
    if (null != b.dangerouslySetInnerHTML) {
      if (null != b.children)
        throw Error(p$2(60));
      if ("object" !== typeof b.dangerouslySetInnerHTML || !("__html" in b.dangerouslySetInnerHTML))
        throw Error(p$2(61));
    }
    if (null != b.style && "object" !== typeof b.style)
      throw Error(p$2(62));
  }
}
function vb$2(a, b) {
  if (-1 === a.indexOf("-"))
    return "string" === typeof b.is;
  switch (a) {
    case "annotation-xml":
    case "color-profile":
    case "font-face":
    case "font-face-src":
    case "font-face-uri":
    case "font-face-format":
    case "font-face-name":
    case "missing-glyph":
      return false;
    default:
      return true;
  }
}
var wb$2 = null;
function xb$2(a) {
  a = a.target || a.srcElement || window;
  a.correspondingUseElement && (a = a.correspondingUseElement);
  return 3 === a.nodeType ? a.parentNode : a;
}
var yb$2 = null, zb$2 = null, Ab$2 = null;
function Bb$2(a) {
  if (a = Cb$2(a)) {
    if ("function" !== typeof yb$2)
      throw Error(p$2(280));
    var b = a.stateNode;
    b && (b = Db$2(b), yb$2(a.stateNode, a.type, b));
  }
}
function Eb$2(a) {
  zb$2 ? Ab$2 ? Ab$2.push(a) : Ab$2 = [a] : zb$2 = a;
}
function Fb$1() {
  if (zb$2) {
    var a = zb$2, b = Ab$2;
    Ab$2 = zb$2 = null;
    Bb$2(a);
    if (b)
      for (a = 0; a < b.length; a++)
        Bb$2(b[a]);
  }
}
function Gb$2(a, b) {
  return a(b);
}
function Hb$2() {
}
var Ib$2 = false;
function Jb$2(a, b, c) {
  if (Ib$2)
    return a(b, c);
  Ib$2 = true;
  try {
    return Gb$2(a, b, c);
  } finally {
    if (Ib$2 = false, null !== zb$2 || null !== Ab$2)
      Hb$2(), Fb$1();
  }
}
function Kb$2(a, b) {
  var c = a.stateNode;
  if (null === c)
    return null;
  var d = Db$2(c);
  if (null === d)
    return null;
  c = d[b];
  a:
    switch (b) {
      case "onClick":
      case "onClickCapture":
      case "onDoubleClick":
      case "onDoubleClickCapture":
      case "onMouseDown":
      case "onMouseDownCapture":
      case "onMouseMove":
      case "onMouseMoveCapture":
      case "onMouseUp":
      case "onMouseUpCapture":
      case "onMouseEnter":
        (d = !d.disabled) || (a = a.type, d = !("button" === a || "input" === a || "select" === a || "textarea" === a));
        a = !d;
        break a;
      default:
        a = false;
    }
  if (a)
    return null;
  if (c && "function" !== typeof c)
    throw Error(p$2(231, b, typeof c));
  return c;
}
var Lb$2 = false;
if (ia$2)
  try {
    var Mb$2 = {};
    Object.defineProperty(Mb$2, "passive", { get: function() {
      Lb$2 = true;
    } });
    window.addEventListener("test", Mb$2, Mb$2);
    window.removeEventListener("test", Mb$2, Mb$2);
  } catch (a) {
    Lb$2 = false;
  }
function Nb$2(a, b, c, d, e, f2, g, h, k2) {
  var l2 = Array.prototype.slice.call(arguments, 3);
  try {
    b.apply(c, l2);
  } catch (m2) {
    this.onError(m2);
  }
}
var Ob$2 = false, Pb$2 = null, Qb$2 = false, Rb$2 = null, Sb$2 = { onError: function(a) {
  Ob$2 = true;
  Pb$2 = a;
} };
function Tb$2(a, b, c, d, e, f2, g, h, k2) {
  Ob$2 = false;
  Pb$2 = null;
  Nb$2.apply(Sb$2, arguments);
}
function Ub$1(a, b, c, d, e, f2, g, h, k2) {
  Tb$2.apply(this, arguments);
  if (Ob$2) {
    if (Ob$2) {
      var l2 = Pb$2;
      Ob$2 = false;
      Pb$2 = null;
    } else
      throw Error(p$2(198));
    Qb$2 || (Qb$2 = true, Rb$2 = l2);
  }
}
function Vb$1(a) {
  var b = a, c = a;
  if (a.alternate)
    for (; b.return; )
      b = b.return;
  else {
    a = b;
    do
      b = a, 0 !== (b.flags & 4098) && (c = b.return), a = b.return;
    while (a);
  }
  return 3 === b.tag ? c : null;
}
function Wb$1(a) {
  if (13 === a.tag) {
    var b = a.memoizedState;
    null === b && (a = a.alternate, null !== a && (b = a.memoizedState));
    if (null !== b)
      return b.dehydrated;
  }
  return null;
}
function Xb$1(a) {
  if (Vb$1(a) !== a)
    throw Error(p$2(188));
}
function Yb$1(a) {
  var b = a.alternate;
  if (!b) {
    b = Vb$1(a);
    if (null === b)
      throw Error(p$2(188));
    return b !== a ? null : a;
  }
  for (var c = a, d = b; ; ) {
    var e = c.return;
    if (null === e)
      break;
    var f2 = e.alternate;
    if (null === f2) {
      d = e.return;
      if (null !== d) {
        c = d;
        continue;
      }
      break;
    }
    if (e.child === f2.child) {
      for (f2 = e.child; f2; ) {
        if (f2 === c)
          return Xb$1(e), a;
        if (f2 === d)
          return Xb$1(e), b;
        f2 = f2.sibling;
      }
      throw Error(p$2(188));
    }
    if (c.return !== d.return)
      c = e, d = f2;
    else {
      for (var g = false, h = e.child; h; ) {
        if (h === c) {
          g = true;
          c = e;
          d = f2;
          break;
        }
        if (h === d) {
          g = true;
          d = e;
          c = f2;
          break;
        }
        h = h.sibling;
      }
      if (!g) {
        for (h = f2.child; h; ) {
          if (h === c) {
            g = true;
            c = f2;
            d = e;
            break;
          }
          if (h === d) {
            g = true;
            d = f2;
            c = e;
            break;
          }
          h = h.sibling;
        }
        if (!g)
          throw Error(p$2(189));
      }
    }
    if (c.alternate !== d)
      throw Error(p$2(190));
  }
  if (3 !== c.tag)
    throw Error(p$2(188));
  return c.stateNode.current === c ? a : b;
}
function Zb$1(a) {
  a = Yb$1(a);
  return null !== a ? $b$1(a) : null;
}
function $b$1(a) {
  if (5 === a.tag || 6 === a.tag)
    return a;
  for (a = a.child; null !== a; ) {
    var b = $b$1(a);
    if (null !== b)
      return b;
    a = a.sibling;
  }
  return null;
}
var ac$1 = ca$1.unstable_scheduleCallback, bc$1 = ca$1.unstable_cancelCallback, cc$1 = ca$1.unstable_shouldYield, dc$1 = ca$1.unstable_requestPaint, B$2 = ca$1.unstable_now, ec$1 = ca$1.unstable_getCurrentPriorityLevel, fc$1 = ca$1.unstable_ImmediatePriority, gc$1 = ca$1.unstable_UserBlockingPriority, hc$1 = ca$1.unstable_NormalPriority, ic$1 = ca$1.unstable_LowPriority, jc$1 = ca$1.unstable_IdlePriority, kc$1 = null, lc$1 = null;
function mc$1(a) {
  if (lc$1 && "function" === typeof lc$1.onCommitFiberRoot)
    try {
      lc$1.onCommitFiberRoot(kc$1, a, void 0, 128 === (a.current.flags & 128));
    } catch (b) {
    }
}
var oc$1 = Math.clz32 ? Math.clz32 : nc$1, pc$1 = Math.log, qc$1 = Math.LN2;
function nc$1(a) {
  a >>>= 0;
  return 0 === a ? 32 : 31 - (pc$1(a) / qc$1 | 0) | 0;
}
var rc$1 = 64, sc$1 = 4194304;
function tc$1(a) {
  switch (a & -a) {
    case 1:
      return 1;
    case 2:
      return 2;
    case 4:
      return 4;
    case 8:
      return 8;
    case 16:
      return 16;
    case 32:
      return 32;
    case 64:
    case 128:
    case 256:
    case 512:
    case 1024:
    case 2048:
    case 4096:
    case 8192:
    case 16384:
    case 32768:
    case 65536:
    case 131072:
    case 262144:
    case 524288:
    case 1048576:
    case 2097152:
      return a & 4194240;
    case 4194304:
    case 8388608:
    case 16777216:
    case 33554432:
    case 67108864:
      return a & 130023424;
    case 134217728:
      return 134217728;
    case 268435456:
      return 268435456;
    case 536870912:
      return 536870912;
    case 1073741824:
      return 1073741824;
    default:
      return a;
  }
}
function uc$1(a, b) {
  var c = a.pendingLanes;
  if (0 === c)
    return 0;
  var d = 0, e = a.suspendedLanes, f2 = a.pingedLanes, g = c & 268435455;
  if (0 !== g) {
    var h = g & ~e;
    0 !== h ? d = tc$1(h) : (f2 &= g, 0 !== f2 && (d = tc$1(f2)));
  } else
    g = c & ~e, 0 !== g ? d = tc$1(g) : 0 !== f2 && (d = tc$1(f2));
  if (0 === d)
    return 0;
  if (0 !== b && b !== d && 0 === (b & e) && (e = d & -d, f2 = b & -b, e >= f2 || 16 === e && 0 !== (f2 & 4194240)))
    return b;
  0 !== (d & 4) && (d |= c & 16);
  b = a.entangledLanes;
  if (0 !== b)
    for (a = a.entanglements, b &= d; 0 < b; )
      c = 31 - oc$1(b), e = 1 << c, d |= a[c], b &= ~e;
  return d;
}
function vc$1(a, b) {
  switch (a) {
    case 1:
    case 2:
    case 4:
      return b + 250;
    case 8:
    case 16:
    case 32:
    case 64:
    case 128:
    case 256:
    case 512:
    case 1024:
    case 2048:
    case 4096:
    case 8192:
    case 16384:
    case 32768:
    case 65536:
    case 131072:
    case 262144:
    case 524288:
    case 1048576:
    case 2097152:
      return b + 5e3;
    case 4194304:
    case 8388608:
    case 16777216:
    case 33554432:
    case 67108864:
      return -1;
    case 134217728:
    case 268435456:
    case 536870912:
    case 1073741824:
      return -1;
    default:
      return -1;
  }
}
function wc$1(a, b) {
  for (var c = a.suspendedLanes, d = a.pingedLanes, e = a.expirationTimes, f2 = a.pendingLanes; 0 < f2; ) {
    var g = 31 - oc$1(f2), h = 1 << g, k2 = e[g];
    if (-1 === k2) {
      if (0 === (h & c) || 0 !== (h & d))
        e[g] = vc$1(h, b);
    } else
      k2 <= b && (a.expiredLanes |= h);
    f2 &= ~h;
  }
}
function xc$1(a) {
  a = a.pendingLanes & -1073741825;
  return 0 !== a ? a : a & 1073741824 ? 1073741824 : 0;
}
function yc$1() {
  var a = rc$1;
  rc$1 <<= 1;
  0 === (rc$1 & 4194240) && (rc$1 = 64);
  return a;
}
function zc$1(a) {
  for (var b = [], c = 0; 31 > c; c++)
    b.push(a);
  return b;
}
function Ac$1(a, b, c) {
  a.pendingLanes |= b;
  536870912 !== b && (a.suspendedLanes = 0, a.pingedLanes = 0);
  a = a.eventTimes;
  b = 31 - oc$1(b);
  a[b] = c;
}
function Bc$1(a, b) {
  var c = a.pendingLanes & ~b;
  a.pendingLanes = b;
  a.suspendedLanes = 0;
  a.pingedLanes = 0;
  a.expiredLanes &= b;
  a.mutableReadLanes &= b;
  a.entangledLanes &= b;
  b = a.entanglements;
  var d = a.eventTimes;
  for (a = a.expirationTimes; 0 < c; ) {
    var e = 31 - oc$1(c), f2 = 1 << e;
    b[e] = 0;
    d[e] = -1;
    a[e] = -1;
    c &= ~f2;
  }
}
function Cc$1(a, b) {
  var c = a.entangledLanes |= b;
  for (a = a.entanglements; c; ) {
    var d = 31 - oc$1(c), e = 1 << d;
    e & b | a[d] & b && (a[d] |= b);
    c &= ~e;
  }
}
var C$1 = 0;
function Dc$1(a) {
  a &= -a;
  return 1 < a ? 4 < a ? 0 !== (a & 268435455) ? 16 : 536870912 : 4 : 1;
}
var Ec$1, Fc$1, Gc$1, Hc$1, Ic$1, Jc$1 = false, Kc$1 = [], Lc$1 = null, Mc$1 = null, Nc$1 = null, Oc$1 = /* @__PURE__ */ new Map(), Pc$1 = /* @__PURE__ */ new Map(), Qc$1 = [], Rc$1 = "mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");
function Sc$1(a, b) {
  switch (a) {
    case "focusin":
    case "focusout":
      Lc$1 = null;
      break;
    case "dragenter":
    case "dragleave":
      Mc$1 = null;
      break;
    case "mouseover":
    case "mouseout":
      Nc$1 = null;
      break;
    case "pointerover":
    case "pointerout":
      Oc$1.delete(b.pointerId);
      break;
    case "gotpointercapture":
    case "lostpointercapture":
      Pc$1.delete(b.pointerId);
  }
}
function Tc$1(a, b, c, d, e, f2) {
  if (null === a || a.nativeEvent !== f2)
    return a = { blockedOn: b, domEventName: c, eventSystemFlags: d, nativeEvent: f2, targetContainers: [e] }, null !== b && (b = Cb$2(b), null !== b && Fc$1(b)), a;
  a.eventSystemFlags |= d;
  b = a.targetContainers;
  null !== e && -1 === b.indexOf(e) && b.push(e);
  return a;
}
function Uc$1(a, b, c, d, e) {
  switch (b) {
    case "focusin":
      return Lc$1 = Tc$1(Lc$1, a, b, c, d, e), true;
    case "dragenter":
      return Mc$1 = Tc$1(Mc$1, a, b, c, d, e), true;
    case "mouseover":
      return Nc$1 = Tc$1(Nc$1, a, b, c, d, e), true;
    case "pointerover":
      var f2 = e.pointerId;
      Oc$1.set(f2, Tc$1(Oc$1.get(f2) || null, a, b, c, d, e));
      return true;
    case "gotpointercapture":
      return f2 = e.pointerId, Pc$1.set(f2, Tc$1(Pc$1.get(f2) || null, a, b, c, d, e)), true;
  }
  return false;
}
function Vc$1(a) {
  var b = Wc$1(a.target);
  if (null !== b) {
    var c = Vb$1(b);
    if (null !== c) {
      if (b = c.tag, 13 === b) {
        if (b = Wb$1(c), null !== b) {
          a.blockedOn = b;
          Ic$1(a.priority, function() {
            Gc$1(c);
          });
          return;
        }
      } else if (3 === b && c.stateNode.current.memoizedState.isDehydrated) {
        a.blockedOn = 3 === c.tag ? c.stateNode.containerInfo : null;
        return;
      }
    }
  }
  a.blockedOn = null;
}
function Xc$1(a) {
  if (null !== a.blockedOn)
    return false;
  for (var b = a.targetContainers; 0 < b.length; ) {
    var c = Yc$1(a.domEventName, a.eventSystemFlags, b[0], a.nativeEvent);
    if (null === c) {
      c = a.nativeEvent;
      var d = new c.constructor(c.type, c);
      wb$2 = d;
      c.target.dispatchEvent(d);
      wb$2 = null;
    } else
      return b = Cb$2(c), null !== b && Fc$1(b), a.blockedOn = c, false;
    b.shift();
  }
  return true;
}
function Zc$1(a, b, c) {
  Xc$1(a) && c.delete(b);
}
function $c$1() {
  Jc$1 = false;
  null !== Lc$1 && Xc$1(Lc$1) && (Lc$1 = null);
  null !== Mc$1 && Xc$1(Mc$1) && (Mc$1 = null);
  null !== Nc$1 && Xc$1(Nc$1) && (Nc$1 = null);
  Oc$1.forEach(Zc$1);
  Pc$1.forEach(Zc$1);
}
function ad$1(a, b) {
  a.blockedOn === b && (a.blockedOn = null, Jc$1 || (Jc$1 = true, ca$1.unstable_scheduleCallback(ca$1.unstable_NormalPriority, $c$1)));
}
function bd$1(a) {
  function b(b2) {
    return ad$1(b2, a);
  }
  if (0 < Kc$1.length) {
    ad$1(Kc$1[0], a);
    for (var c = 1; c < Kc$1.length; c++) {
      var d = Kc$1[c];
      d.blockedOn === a && (d.blockedOn = null);
    }
  }
  null !== Lc$1 && ad$1(Lc$1, a);
  null !== Mc$1 && ad$1(Mc$1, a);
  null !== Nc$1 && ad$1(Nc$1, a);
  Oc$1.forEach(b);
  Pc$1.forEach(b);
  for (c = 0; c < Qc$1.length; c++)
    d = Qc$1[c], d.blockedOn === a && (d.blockedOn = null);
  for (; 0 < Qc$1.length && (c = Qc$1[0], null === c.blockedOn); )
    Vc$1(c), null === c.blockedOn && Qc$1.shift();
}
var cd$1 = ua$2.ReactCurrentBatchConfig, dd$1 = true;
function ed$1(a, b, c, d) {
  var e = C$1, f2 = cd$1.transition;
  cd$1.transition = null;
  try {
    C$1 = 1, fd$1(a, b, c, d);
  } finally {
    C$1 = e, cd$1.transition = f2;
  }
}
function gd$1(a, b, c, d) {
  var e = C$1, f2 = cd$1.transition;
  cd$1.transition = null;
  try {
    C$1 = 4, fd$1(a, b, c, d);
  } finally {
    C$1 = e, cd$1.transition = f2;
  }
}
function fd$1(a, b, c, d) {
  if (dd$1) {
    var e = Yc$1(a, b, c, d);
    if (null === e)
      hd$1(a, b, d, id$1, c), Sc$1(a, d);
    else if (Uc$1(e, a, b, c, d))
      d.stopPropagation();
    else if (Sc$1(a, d), b & 4 && -1 < Rc$1.indexOf(a)) {
      for (; null !== e; ) {
        var f2 = Cb$2(e);
        null !== f2 && Ec$1(f2);
        f2 = Yc$1(a, b, c, d);
        null === f2 && hd$1(a, b, d, id$1, c);
        if (f2 === e)
          break;
        e = f2;
      }
      null !== e && d.stopPropagation();
    } else
      hd$1(a, b, d, null, c);
  }
}
var id$1 = null;
function Yc$1(a, b, c, d) {
  id$1 = null;
  a = xb$2(d);
  a = Wc$1(a);
  if (null !== a)
    if (b = Vb$1(a), null === b)
      a = null;
    else if (c = b.tag, 13 === c) {
      a = Wb$1(b);
      if (null !== a)
        return a;
      a = null;
    } else if (3 === c) {
      if (b.stateNode.current.memoizedState.isDehydrated)
        return 3 === b.tag ? b.stateNode.containerInfo : null;
      a = null;
    } else
      b !== a && (a = null);
  id$1 = a;
  return null;
}
function jd$1(a) {
  switch (a) {
    case "cancel":
    case "click":
    case "close":
    case "contextmenu":
    case "copy":
    case "cut":
    case "auxclick":
    case "dblclick":
    case "dragend":
    case "dragstart":
    case "drop":
    case "focusin":
    case "focusout":
    case "input":
    case "invalid":
    case "keydown":
    case "keypress":
    case "keyup":
    case "mousedown":
    case "mouseup":
    case "paste":
    case "pause":
    case "play":
    case "pointercancel":
    case "pointerdown":
    case "pointerup":
    case "ratechange":
    case "reset":
    case "resize":
    case "seeked":
    case "submit":
    case "touchcancel":
    case "touchend":
    case "touchstart":
    case "volumechange":
    case "change":
    case "selectionchange":
    case "textInput":
    case "compositionstart":
    case "compositionend":
    case "compositionupdate":
    case "beforeblur":
    case "afterblur":
    case "beforeinput":
    case "blur":
    case "fullscreenchange":
    case "focus":
    case "hashchange":
    case "popstate":
    case "select":
    case "selectstart":
      return 1;
    case "drag":
    case "dragenter":
    case "dragexit":
    case "dragleave":
    case "dragover":
    case "mousemove":
    case "mouseout":
    case "mouseover":
    case "pointermove":
    case "pointerout":
    case "pointerover":
    case "scroll":
    case "toggle":
    case "touchmove":
    case "wheel":
    case "mouseenter":
    case "mouseleave":
    case "pointerenter":
    case "pointerleave":
      return 4;
    case "message":
      switch (ec$1()) {
        case fc$1:
          return 1;
        case gc$1:
          return 4;
        case hc$1:
        case ic$1:
          return 16;
        case jc$1:
          return 536870912;
        default:
          return 16;
      }
    default:
      return 16;
  }
}
var kd$1 = null, ld$1 = null, md = null;
function nd() {
  if (md)
    return md;
  var a, b = ld$1, c = b.length, d, e = "value" in kd$1 ? kd$1.value : kd$1.textContent, f2 = e.length;
  for (a = 0; a < c && b[a] === e[a]; a++)
    ;
  var g = c - a;
  for (d = 1; d <= g && b[c - d] === e[f2 - d]; d++)
    ;
  return md = e.slice(a, 1 < d ? 1 - d : void 0);
}
function od(a) {
  var b = a.keyCode;
  "charCode" in a ? (a = a.charCode, 0 === a && 13 === b && (a = 13)) : a = b;
  10 === a && (a = 13);
  return 32 <= a || 13 === a ? a : 0;
}
function pd() {
  return true;
}
function qd() {
  return false;
}
function rd(a) {
  function b(b2, d, e, f2, g) {
    this._reactName = b2;
    this._targetInst = e;
    this.type = d;
    this.nativeEvent = f2;
    this.target = g;
    this.currentTarget = null;
    for (var c in a)
      a.hasOwnProperty(c) && (b2 = a[c], this[c] = b2 ? b2(f2) : f2[c]);
    this.isDefaultPrevented = (null != f2.defaultPrevented ? f2.defaultPrevented : false === f2.returnValue) ? pd : qd;
    this.isPropagationStopped = qd;
    return this;
  }
  A$1(b.prototype, { preventDefault: function() {
    this.defaultPrevented = true;
    var a2 = this.nativeEvent;
    a2 && (a2.preventDefault ? a2.preventDefault() : "unknown" !== typeof a2.returnValue && (a2.returnValue = false), this.isDefaultPrevented = pd);
  }, stopPropagation: function() {
    var a2 = this.nativeEvent;
    a2 && (a2.stopPropagation ? a2.stopPropagation() : "unknown" !== typeof a2.cancelBubble && (a2.cancelBubble = true), this.isPropagationStopped = pd);
  }, persist: function() {
  }, isPersistent: pd });
  return b;
}
var sd = { eventPhase: 0, bubbles: 0, cancelable: 0, timeStamp: function(a) {
  return a.timeStamp || Date.now();
}, defaultPrevented: 0, isTrusted: 0 }, td = rd(sd), ud = A$1({}, sd, { view: 0, detail: 0 }), vd = rd(ud), wd, xd, yd, Ad = A$1({}, ud, { screenX: 0, screenY: 0, clientX: 0, clientY: 0, pageX: 0, pageY: 0, ctrlKey: 0, shiftKey: 0, altKey: 0, metaKey: 0, getModifierState: zd, button: 0, buttons: 0, relatedTarget: function(a) {
  return void 0 === a.relatedTarget ? a.fromElement === a.srcElement ? a.toElement : a.fromElement : a.relatedTarget;
}, movementX: function(a) {
  if ("movementX" in a)
    return a.movementX;
  a !== yd && (yd && "mousemove" === a.type ? (wd = a.screenX - yd.screenX, xd = a.screenY - yd.screenY) : xd = wd = 0, yd = a);
  return wd;
}, movementY: function(a) {
  return "movementY" in a ? a.movementY : xd;
} }), Bd = rd(Ad), Cd = A$1({}, Ad, { dataTransfer: 0 }), Dd = rd(Cd), Ed = A$1({}, ud, { relatedTarget: 0 }), Fd = rd(Ed), Gd = A$1({}, sd, { animationName: 0, elapsedTime: 0, pseudoElement: 0 }), Hd = rd(Gd), Id = A$1({}, sd, { clipboardData: function(a) {
  return "clipboardData" in a ? a.clipboardData : window.clipboardData;
} }), Jd = rd(Id), Kd = A$1({}, sd, { data: 0 }), Ld = rd(Kd), Md = {
  Esc: "Escape",
  Spacebar: " ",
  Left: "ArrowLeft",
  Up: "ArrowUp",
  Right: "ArrowRight",
  Down: "ArrowDown",
  Del: "Delete",
  Win: "OS",
  Menu: "ContextMenu",
  Apps: "ContextMenu",
  Scroll: "ScrollLock",
  MozPrintableKey: "Unidentified"
}, Nd = {
  8: "Backspace",
  9: "Tab",
  12: "Clear",
  13: "Enter",
  16: "Shift",
  17: "Control",
  18: "Alt",
  19: "Pause",
  20: "CapsLock",
  27: "Escape",
  32: " ",
  33: "PageUp",
  34: "PageDown",
  35: "End",
  36: "Home",
  37: "ArrowLeft",
  38: "ArrowUp",
  39: "ArrowRight",
  40: "ArrowDown",
  45: "Insert",
  46: "Delete",
  112: "F1",
  113: "F2",
  114: "F3",
  115: "F4",
  116: "F5",
  117: "F6",
  118: "F7",
  119: "F8",
  120: "F9",
  121: "F10",
  122: "F11",
  123: "F12",
  144: "NumLock",
  145: "ScrollLock",
  224: "Meta"
}, Od = { Alt: "altKey", Control: "ctrlKey", Meta: "metaKey", Shift: "shiftKey" };
function Pd(a) {
  var b = this.nativeEvent;
  return b.getModifierState ? b.getModifierState(a) : (a = Od[a]) ? !!b[a] : false;
}
function zd() {
  return Pd;
}
var Qd = A$1({}, ud, { key: function(a) {
  if (a.key) {
    var b = Md[a.key] || a.key;
    if ("Unidentified" !== b)
      return b;
  }
  return "keypress" === a.type ? (a = od(a), 13 === a ? "Enter" : String.fromCharCode(a)) : "keydown" === a.type || "keyup" === a.type ? Nd[a.keyCode] || "Unidentified" : "";
}, code: 0, location: 0, ctrlKey: 0, shiftKey: 0, altKey: 0, metaKey: 0, repeat: 0, locale: 0, getModifierState: zd, charCode: function(a) {
  return "keypress" === a.type ? od(a) : 0;
}, keyCode: function(a) {
  return "keydown" === a.type || "keyup" === a.type ? a.keyCode : 0;
}, which: function(a) {
  return "keypress" === a.type ? od(a) : "keydown" === a.type || "keyup" === a.type ? a.keyCode : 0;
} }), Rd = rd(Qd), Sd = A$1({}, Ad, { pointerId: 0, width: 0, height: 0, pressure: 0, tangentialPressure: 0, tiltX: 0, tiltY: 0, twist: 0, pointerType: 0, isPrimary: 0 }), Td = rd(Sd), Ud = A$1({}, ud, { touches: 0, targetTouches: 0, changedTouches: 0, altKey: 0, metaKey: 0, ctrlKey: 0, shiftKey: 0, getModifierState: zd }), Vd = rd(Ud), Wd = A$1({}, sd, { propertyName: 0, elapsedTime: 0, pseudoElement: 0 }), Xd = rd(Wd), Yd = A$1({}, Ad, {
  deltaX: function(a) {
    return "deltaX" in a ? a.deltaX : "wheelDeltaX" in a ? -a.wheelDeltaX : 0;
  },
  deltaY: function(a) {
    return "deltaY" in a ? a.deltaY : "wheelDeltaY" in a ? -a.wheelDeltaY : "wheelDelta" in a ? -a.wheelDelta : 0;
  },
  deltaZ: 0,
  deltaMode: 0
}), Zd = rd(Yd), $d = [9, 13, 27, 32], ae = ia$2 && "CompositionEvent" in window, be = null;
ia$2 && "documentMode" in document && (be = document.documentMode);
var ce = ia$2 && "TextEvent" in window && !be, de = ia$2 && (!ae || be && 8 < be && 11 >= be), ee = String.fromCharCode(32), fe = false;
function ge(a, b) {
  switch (a) {
    case "keyup":
      return -1 !== $d.indexOf(b.keyCode);
    case "keydown":
      return 229 !== b.keyCode;
    case "keypress":
    case "mousedown":
    case "focusout":
      return true;
    default:
      return false;
  }
}
function he(a) {
  a = a.detail;
  return "object" === typeof a && "data" in a ? a.data : null;
}
var ie = false;
function je(a, b) {
  switch (a) {
    case "compositionend":
      return he(b);
    case "keypress":
      if (32 !== b.which)
        return null;
      fe = true;
      return ee;
    case "textInput":
      return a = b.data, a === ee && fe ? null : a;
    default:
      return null;
  }
}
function ke(a, b) {
  if (ie)
    return "compositionend" === a || !ae && ge(a, b) ? (a = nd(), md = ld$1 = kd$1 = null, ie = false, a) : null;
  switch (a) {
    case "paste":
      return null;
    case "keypress":
      if (!(b.ctrlKey || b.altKey || b.metaKey) || b.ctrlKey && b.altKey) {
        if (b.char && 1 < b.char.length)
          return b.char;
        if (b.which)
          return String.fromCharCode(b.which);
      }
      return null;
    case "compositionend":
      return de && "ko" !== b.locale ? null : b.data;
    default:
      return null;
  }
}
var le = { color: true, date: true, datetime: true, "datetime-local": true, email: true, month: true, number: true, password: true, range: true, search: true, tel: true, text: true, time: true, url: true, week: true };
function me(a) {
  var b = a && a.nodeName && a.nodeName.toLowerCase();
  return "input" === b ? !!le[a.type] : "textarea" === b ? true : false;
}
function ne(a, b, c, d) {
  Eb$2(d);
  b = oe(b, "onChange");
  0 < b.length && (c = new td("onChange", "change", null, c, d), a.push({ event: c, listeners: b }));
}
var pe = null, qe = null;
function re(a) {
  se(a, 0);
}
function te(a) {
  var b = ue(a);
  if (Wa$2(b))
    return a;
}
function ve(a, b) {
  if ("change" === a)
    return b;
}
var we = false;
if (ia$2) {
  var xe;
  if (ia$2) {
    var ye = "oninput" in document;
    if (!ye) {
      var ze = document.createElement("div");
      ze.setAttribute("oninput", "return;");
      ye = "function" === typeof ze.oninput;
    }
    xe = ye;
  } else
    xe = false;
  we = xe && (!document.documentMode || 9 < document.documentMode);
}
function Ae() {
  pe && (pe.detachEvent("onpropertychange", Be), qe = pe = null);
}
function Be(a) {
  if ("value" === a.propertyName && te(qe)) {
    var b = [];
    ne(b, qe, a, xb$2(a));
    Jb$2(re, b);
  }
}
function Ce(a, b, c) {
  "focusin" === a ? (Ae(), pe = b, qe = c, pe.attachEvent("onpropertychange", Be)) : "focusout" === a && Ae();
}
function De(a) {
  if ("selectionchange" === a || "keyup" === a || "keydown" === a)
    return te(qe);
}
function Ee(a, b) {
  if ("click" === a)
    return te(b);
}
function Fe(a, b) {
  if ("input" === a || "change" === a)
    return te(b);
}
function Ge(a, b) {
  return a === b && (0 !== a || 1 / a === 1 / b) || a !== a && b !== b;
}
var He = "function" === typeof Object.is ? Object.is : Ge;
function Ie(a, b) {
  if (He(a, b))
    return true;
  if ("object" !== typeof a || null === a || "object" !== typeof b || null === b)
    return false;
  var c = Object.keys(a), d = Object.keys(b);
  if (c.length !== d.length)
    return false;
  for (d = 0; d < c.length; d++) {
    var e = c[d];
    if (!ja$2.call(b, e) || !He(a[e], b[e]))
      return false;
  }
  return true;
}
function Je(a) {
  for (; a && a.firstChild; )
    a = a.firstChild;
  return a;
}
function Ke(a, b) {
  var c = Je(a);
  a = 0;
  for (var d; c; ) {
    if (3 === c.nodeType) {
      d = a + c.textContent.length;
      if (a <= b && d >= b)
        return { node: c, offset: b - a };
      a = d;
    }
    a: {
      for (; c; ) {
        if (c.nextSibling) {
          c = c.nextSibling;
          break a;
        }
        c = c.parentNode;
      }
      c = void 0;
    }
    c = Je(c);
  }
}
function Le(a, b) {
  return a && b ? a === b ? true : a && 3 === a.nodeType ? false : b && 3 === b.nodeType ? Le(a, b.parentNode) : "contains" in a ? a.contains(b) : a.compareDocumentPosition ? !!(a.compareDocumentPosition(b) & 16) : false : false;
}
function Me() {
  for (var a = window, b = Xa$2(); b instanceof a.HTMLIFrameElement; ) {
    try {
      var c = "string" === typeof b.contentWindow.location.href;
    } catch (d) {
      c = false;
    }
    if (c)
      a = b.contentWindow;
    else
      break;
    b = Xa$2(a.document);
  }
  return b;
}
function Ne(a) {
  var b = a && a.nodeName && a.nodeName.toLowerCase();
  return b && ("input" === b && ("text" === a.type || "search" === a.type || "tel" === a.type || "url" === a.type || "password" === a.type) || "textarea" === b || "true" === a.contentEditable);
}
function Oe(a) {
  var b = Me(), c = a.focusedElem, d = a.selectionRange;
  if (b !== c && c && c.ownerDocument && Le(c.ownerDocument.documentElement, c)) {
    if (null !== d && Ne(c)) {
      if (b = d.start, a = d.end, void 0 === a && (a = b), "selectionStart" in c)
        c.selectionStart = b, c.selectionEnd = Math.min(a, c.value.length);
      else if (a = (b = c.ownerDocument || document) && b.defaultView || window, a.getSelection) {
        a = a.getSelection();
        var e = c.textContent.length, f2 = Math.min(d.start, e);
        d = void 0 === d.end ? f2 : Math.min(d.end, e);
        !a.extend && f2 > d && (e = d, d = f2, f2 = e);
        e = Ke(c, f2);
        var g = Ke(
          c,
          d
        );
        e && g && (1 !== a.rangeCount || a.anchorNode !== e.node || a.anchorOffset !== e.offset || a.focusNode !== g.node || a.focusOffset !== g.offset) && (b = b.createRange(), b.setStart(e.node, e.offset), a.removeAllRanges(), f2 > d ? (a.addRange(b), a.extend(g.node, g.offset)) : (b.setEnd(g.node, g.offset), a.addRange(b)));
      }
    }
    b = [];
    for (a = c; a = a.parentNode; )
      1 === a.nodeType && b.push({ element: a, left: a.scrollLeft, top: a.scrollTop });
    "function" === typeof c.focus && c.focus();
    for (c = 0; c < b.length; c++)
      a = b[c], a.element.scrollLeft = a.left, a.element.scrollTop = a.top;
  }
}
var Pe = ia$2 && "documentMode" in document && 11 >= document.documentMode, Qe = null, Re = null, Se = null, Te = false;
function Ue(a, b, c) {
  var d = c.window === c ? c.document : 9 === c.nodeType ? c : c.ownerDocument;
  Te || null == Qe || Qe !== Xa$2(d) || (d = Qe, "selectionStart" in d && Ne(d) ? d = { start: d.selectionStart, end: d.selectionEnd } : (d = (d.ownerDocument && d.ownerDocument.defaultView || window).getSelection(), d = { anchorNode: d.anchorNode, anchorOffset: d.anchorOffset, focusNode: d.focusNode, focusOffset: d.focusOffset }), Se && Ie(Se, d) || (Se = d, d = oe(Re, "onSelect"), 0 < d.length && (b = new td("onSelect", "select", null, b, c), a.push({ event: b, listeners: d }), b.target = Qe)));
}
function Ve(a, b) {
  var c = {};
  c[a.toLowerCase()] = b.toLowerCase();
  c["Webkit" + a] = "webkit" + b;
  c["Moz" + a] = "moz" + b;
  return c;
}
var We = { animationend: Ve("Animation", "AnimationEnd"), animationiteration: Ve("Animation", "AnimationIteration"), animationstart: Ve("Animation", "AnimationStart"), transitionend: Ve("Transition", "TransitionEnd") }, Xe = {}, Ye = {};
ia$2 && (Ye = document.createElement("div").style, "AnimationEvent" in window || (delete We.animationend.animation, delete We.animationiteration.animation, delete We.animationstart.animation), "TransitionEvent" in window || delete We.transitionend.transition);
function Ze(a) {
  if (Xe[a])
    return Xe[a];
  if (!We[a])
    return a;
  var b = We[a], c;
  for (c in b)
    if (b.hasOwnProperty(c) && c in Ye)
      return Xe[a] = b[c];
  return a;
}
var $e = Ze("animationend"), af = Ze("animationiteration"), bf = Ze("animationstart"), cf = Ze("transitionend"), df = /* @__PURE__ */ new Map(), ef = "abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");
function ff(a, b) {
  df.set(a, b);
  fa$2(b, [a]);
}
for (var gf = 0; gf < ef.length; gf++) {
  var hf = ef[gf], jf = hf.toLowerCase(), kf = hf[0].toUpperCase() + hf.slice(1);
  ff(jf, "on" + kf);
}
ff($e, "onAnimationEnd");
ff(af, "onAnimationIteration");
ff(bf, "onAnimationStart");
ff("dblclick", "onDoubleClick");
ff("focusin", "onFocus");
ff("focusout", "onBlur");
ff(cf, "onTransitionEnd");
ha$2("onMouseEnter", ["mouseout", "mouseover"]);
ha$2("onMouseLeave", ["mouseout", "mouseover"]);
ha$2("onPointerEnter", ["pointerout", "pointerover"]);
ha$2("onPointerLeave", ["pointerout", "pointerover"]);
fa$2("onChange", "change click focusin focusout input keydown keyup selectionchange".split(" "));
fa$2("onSelect", "focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));
fa$2("onBeforeInput", ["compositionend", "keypress", "textInput", "paste"]);
fa$2("onCompositionEnd", "compositionend focusout keydown keypress keyup mousedown".split(" "));
fa$2("onCompositionStart", "compositionstart focusout keydown keypress keyup mousedown".split(" "));
fa$2("onCompositionUpdate", "compositionupdate focusout keydown keypress keyup mousedown".split(" "));
var lf = "abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "), mf = new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));
function nf(a, b, c) {
  var d = a.type || "unknown-event";
  a.currentTarget = c;
  Ub$1(d, b, void 0, a);
  a.currentTarget = null;
}
function se(a, b) {
  b = 0 !== (b & 4);
  for (var c = 0; c < a.length; c++) {
    var d = a[c], e = d.event;
    d = d.listeners;
    a: {
      var f2 = void 0;
      if (b)
        for (var g = d.length - 1; 0 <= g; g--) {
          var h = d[g], k2 = h.instance, l2 = h.currentTarget;
          h = h.listener;
          if (k2 !== f2 && e.isPropagationStopped())
            break a;
          nf(e, h, l2);
          f2 = k2;
        }
      else
        for (g = 0; g < d.length; g++) {
          h = d[g];
          k2 = h.instance;
          l2 = h.currentTarget;
          h = h.listener;
          if (k2 !== f2 && e.isPropagationStopped())
            break a;
          nf(e, h, l2);
          f2 = k2;
        }
    }
  }
  if (Qb$2)
    throw a = Rb$2, Qb$2 = false, Rb$2 = null, a;
}
function D$1(a, b) {
  var c = b[of];
  void 0 === c && (c = b[of] = /* @__PURE__ */ new Set());
  var d = a + "__bubble";
  c.has(d) || (pf(b, a, 2, false), c.add(d));
}
function qf(a, b, c) {
  var d = 0;
  b && (d |= 4);
  pf(c, a, d, b);
}
var rf = "_reactListening" + Math.random().toString(36).slice(2);
function sf(a) {
  if (!a[rf]) {
    a[rf] = true;
    da$1.forEach(function(b2) {
      "selectionchange" !== b2 && (mf.has(b2) || qf(b2, false, a), qf(b2, true, a));
    });
    var b = 9 === a.nodeType ? a : a.ownerDocument;
    null === b || b[rf] || (b[rf] = true, qf("selectionchange", false, b));
  }
}
function pf(a, b, c, d) {
  switch (jd$1(b)) {
    case 1:
      var e = ed$1;
      break;
    case 4:
      e = gd$1;
      break;
    default:
      e = fd$1;
  }
  c = e.bind(null, b, c, a);
  e = void 0;
  !Lb$2 || "touchstart" !== b && "touchmove" !== b && "wheel" !== b || (e = true);
  d ? void 0 !== e ? a.addEventListener(b, c, { capture: true, passive: e }) : a.addEventListener(b, c, true) : void 0 !== e ? a.addEventListener(b, c, { passive: e }) : a.addEventListener(b, c, false);
}
function hd$1(a, b, c, d, e) {
  var f2 = d;
  if (0 === (b & 1) && 0 === (b & 2) && null !== d)
    a:
      for (; ; ) {
        if (null === d)
          return;
        var g = d.tag;
        if (3 === g || 4 === g) {
          var h = d.stateNode.containerInfo;
          if (h === e || 8 === h.nodeType && h.parentNode === e)
            break;
          if (4 === g)
            for (g = d.return; null !== g; ) {
              var k2 = g.tag;
              if (3 === k2 || 4 === k2) {
                if (k2 = g.stateNode.containerInfo, k2 === e || 8 === k2.nodeType && k2.parentNode === e)
                  return;
              }
              g = g.return;
            }
          for (; null !== h; ) {
            g = Wc$1(h);
            if (null === g)
              return;
            k2 = g.tag;
            if (5 === k2 || 6 === k2) {
              d = f2 = g;
              continue a;
            }
            h = h.parentNode;
          }
        }
        d = d.return;
      }
  Jb$2(function() {
    var d2 = f2, e2 = xb$2(c), g2 = [];
    a: {
      var h3 = df.get(a);
      if (void 0 !== h3) {
        var k3 = td, n2 = a;
        switch (a) {
          case "keypress":
            if (0 === od(c))
              break a;
          case "keydown":
          case "keyup":
            k3 = Rd;
            break;
          case "focusin":
            n2 = "focus";
            k3 = Fd;
            break;
          case "focusout":
            n2 = "blur";
            k3 = Fd;
            break;
          case "beforeblur":
          case "afterblur":
            k3 = Fd;
            break;
          case "click":
            if (2 === c.button)
              break a;
          case "auxclick":
          case "dblclick":
          case "mousedown":
          case "mousemove":
          case "mouseup":
          case "mouseout":
          case "mouseover":
          case "contextmenu":
            k3 = Bd;
            break;
          case "drag":
          case "dragend":
          case "dragenter":
          case "dragexit":
          case "dragleave":
          case "dragover":
          case "dragstart":
          case "drop":
            k3 = Dd;
            break;
          case "touchcancel":
          case "touchend":
          case "touchmove":
          case "touchstart":
            k3 = Vd;
            break;
          case $e:
          case af:
          case bf:
            k3 = Hd;
            break;
          case cf:
            k3 = Xd;
            break;
          case "scroll":
            k3 = vd;
            break;
          case "wheel":
            k3 = Zd;
            break;
          case "copy":
          case "cut":
          case "paste":
            k3 = Jd;
            break;
          case "gotpointercapture":
          case "lostpointercapture":
          case "pointercancel":
          case "pointerdown":
          case "pointermove":
          case "pointerout":
          case "pointerover":
          case "pointerup":
            k3 = Td;
        }
        var t2 = 0 !== (b & 4), J2 = !t2 && "scroll" === a, x2 = t2 ? null !== h3 ? h3 + "Capture" : null : h3;
        t2 = [];
        for (var w2 = d2, u2; null !== w2; ) {
          u2 = w2;
          var F2 = u2.stateNode;
          5 === u2.tag && null !== F2 && (u2 = F2, null !== x2 && (F2 = Kb$2(w2, x2), null != F2 && t2.push(tf(w2, F2, u2))));
          if (J2)
            break;
          w2 = w2.return;
        }
        0 < t2.length && (h3 = new k3(h3, n2, null, c, e2), g2.push({ event: h3, listeners: t2 }));
      }
    }
    if (0 === (b & 7)) {
      a: {
        h3 = "mouseover" === a || "pointerover" === a;
        k3 = "mouseout" === a || "pointerout" === a;
        if (h3 && c !== wb$2 && (n2 = c.relatedTarget || c.fromElement) && (Wc$1(n2) || n2[uf]))
          break a;
        if (k3 || h3) {
          h3 = e2.window === e2 ? e2 : (h3 = e2.ownerDocument) ? h3.defaultView || h3.parentWindow : window;
          if (k3) {
            if (n2 = c.relatedTarget || c.toElement, k3 = d2, n2 = n2 ? Wc$1(n2) : null, null !== n2 && (J2 = Vb$1(n2), n2 !== J2 || 5 !== n2.tag && 6 !== n2.tag))
              n2 = null;
          } else
            k3 = null, n2 = d2;
          if (k3 !== n2) {
            t2 = Bd;
            F2 = "onMouseLeave";
            x2 = "onMouseEnter";
            w2 = "mouse";
            if ("pointerout" === a || "pointerover" === a)
              t2 = Td, F2 = "onPointerLeave", x2 = "onPointerEnter", w2 = "pointer";
            J2 = null == k3 ? h3 : ue(k3);
            u2 = null == n2 ? h3 : ue(n2);
            h3 = new t2(F2, w2 + "leave", k3, c, e2);
            h3.target = J2;
            h3.relatedTarget = u2;
            F2 = null;
            Wc$1(e2) === d2 && (t2 = new t2(x2, w2 + "enter", n2, c, e2), t2.target = u2, t2.relatedTarget = J2, F2 = t2);
            J2 = F2;
            if (k3 && n2)
              b: {
                t2 = k3;
                x2 = n2;
                w2 = 0;
                for (u2 = t2; u2; u2 = vf(u2))
                  w2++;
                u2 = 0;
                for (F2 = x2; F2; F2 = vf(F2))
                  u2++;
                for (; 0 < w2 - u2; )
                  t2 = vf(t2), w2--;
                for (; 0 < u2 - w2; )
                  x2 = vf(x2), u2--;
                for (; w2--; ) {
                  if (t2 === x2 || null !== x2 && t2 === x2.alternate)
                    break b;
                  t2 = vf(t2);
                  x2 = vf(x2);
                }
                t2 = null;
              }
            else
              t2 = null;
            null !== k3 && wf(g2, h3, k3, t2, false);
            null !== n2 && null !== J2 && wf(g2, J2, n2, t2, true);
          }
        }
      }
      a: {
        h3 = d2 ? ue(d2) : window;
        k3 = h3.nodeName && h3.nodeName.toLowerCase();
        if ("select" === k3 || "input" === k3 && "file" === h3.type)
          var na2 = ve;
        else if (me(h3))
          if (we)
            na2 = Fe;
          else {
            na2 = De;
            var xa2 = Ce;
          }
        else
          (k3 = h3.nodeName) && "input" === k3.toLowerCase() && ("checkbox" === h3.type || "radio" === h3.type) && (na2 = Ee);
        if (na2 && (na2 = na2(a, d2))) {
          ne(g2, na2, c, e2);
          break a;
        }
        xa2 && xa2(a, h3, d2);
        "focusout" === a && (xa2 = h3._wrapperState) && xa2.controlled && "number" === h3.type && cb$2(h3, "number", h3.value);
      }
      xa2 = d2 ? ue(d2) : window;
      switch (a) {
        case "focusin":
          if (me(xa2) || "true" === xa2.contentEditable)
            Qe = xa2, Re = d2, Se = null;
          break;
        case "focusout":
          Se = Re = Qe = null;
          break;
        case "mousedown":
          Te = true;
          break;
        case "contextmenu":
        case "mouseup":
        case "dragend":
          Te = false;
          Ue(g2, c, e2);
          break;
        case "selectionchange":
          if (Pe)
            break;
        case "keydown":
        case "keyup":
          Ue(g2, c, e2);
      }
      var $a2;
      if (ae)
        b: {
          switch (a) {
            case "compositionstart":
              var ba2 = "onCompositionStart";
              break b;
            case "compositionend":
              ba2 = "onCompositionEnd";
              break b;
            case "compositionupdate":
              ba2 = "onCompositionUpdate";
              break b;
          }
          ba2 = void 0;
        }
      else
        ie ? ge(a, c) && (ba2 = "onCompositionEnd") : "keydown" === a && 229 === c.keyCode && (ba2 = "onCompositionStart");
      ba2 && (de && "ko" !== c.locale && (ie || "onCompositionStart" !== ba2 ? "onCompositionEnd" === ba2 && ie && ($a2 = nd()) : (kd$1 = e2, ld$1 = "value" in kd$1 ? kd$1.value : kd$1.textContent, ie = true)), xa2 = oe(d2, ba2), 0 < xa2.length && (ba2 = new Ld(ba2, a, null, c, e2), g2.push({ event: ba2, listeners: xa2 }), $a2 ? ba2.data = $a2 : ($a2 = he(c), null !== $a2 && (ba2.data = $a2))));
      if ($a2 = ce ? je(a, c) : ke(a, c))
        d2 = oe(d2, "onBeforeInput"), 0 < d2.length && (e2 = new Ld("onBeforeInput", "beforeinput", null, c, e2), g2.push({ event: e2, listeners: d2 }), e2.data = $a2);
    }
    se(g2, b);
  });
}
function tf(a, b, c) {
  return { instance: a, listener: b, currentTarget: c };
}
function oe(a, b) {
  for (var c = b + "Capture", d = []; null !== a; ) {
    var e = a, f2 = e.stateNode;
    5 === e.tag && null !== f2 && (e = f2, f2 = Kb$2(a, c), null != f2 && d.unshift(tf(a, f2, e)), f2 = Kb$2(a, b), null != f2 && d.push(tf(a, f2, e)));
    a = a.return;
  }
  return d;
}
function vf(a) {
  if (null === a)
    return null;
  do
    a = a.return;
  while (a && 5 !== a.tag);
  return a ? a : null;
}
function wf(a, b, c, d, e) {
  for (var f2 = b._reactName, g = []; null !== c && c !== d; ) {
    var h = c, k2 = h.alternate, l2 = h.stateNode;
    if (null !== k2 && k2 === d)
      break;
    5 === h.tag && null !== l2 && (h = l2, e ? (k2 = Kb$2(c, f2), null != k2 && g.unshift(tf(c, k2, h))) : e || (k2 = Kb$2(c, f2), null != k2 && g.push(tf(c, k2, h))));
    c = c.return;
  }
  0 !== g.length && a.push({ event: b, listeners: g });
}
var xf = /\r\n?/g, yf = /\u0000|\uFFFD/g;
function zf(a) {
  return ("string" === typeof a ? a : "" + a).replace(xf, "\n").replace(yf, "");
}
function Af(a, b, c) {
  b = zf(b);
  if (zf(a) !== b && c)
    throw Error(p$2(425));
}
function Bf() {
}
var Cf = null, Df = null;
function Ef(a, b) {
  return "textarea" === a || "noscript" === a || "string" === typeof b.children || "number" === typeof b.children || "object" === typeof b.dangerouslySetInnerHTML && null !== b.dangerouslySetInnerHTML && null != b.dangerouslySetInnerHTML.__html;
}
var Ff = "function" === typeof setTimeout ? setTimeout : void 0, Gf = "function" === typeof clearTimeout ? clearTimeout : void 0, Hf = "function" === typeof Promise ? Promise : void 0, Jf = "function" === typeof queueMicrotask ? queueMicrotask : "undefined" !== typeof Hf ? function(a) {
  return Hf.resolve(null).then(a).catch(If);
} : Ff;
function If(a) {
  setTimeout(function() {
    throw a;
  });
}
function Kf(a, b) {
  var c = b, d = 0;
  do {
    var e = c.nextSibling;
    a.removeChild(c);
    if (e && 8 === e.nodeType)
      if (c = e.data, "/$" === c) {
        if (0 === d) {
          a.removeChild(e);
          bd$1(b);
          return;
        }
        d--;
      } else
        "$" !== c && "$?" !== c && "$!" !== c || d++;
    c = e;
  } while (c);
  bd$1(b);
}
function Lf(a) {
  for (; null != a; a = a.nextSibling) {
    var b = a.nodeType;
    if (1 === b || 3 === b)
      break;
    if (8 === b) {
      b = a.data;
      if ("$" === b || "$!" === b || "$?" === b)
        break;
      if ("/$" === b)
        return null;
    }
  }
  return a;
}
function Mf(a) {
  a = a.previousSibling;
  for (var b = 0; a; ) {
    if (8 === a.nodeType) {
      var c = a.data;
      if ("$" === c || "$!" === c || "$?" === c) {
        if (0 === b)
          return a;
        b--;
      } else
        "/$" === c && b++;
    }
    a = a.previousSibling;
  }
  return null;
}
var Nf = Math.random().toString(36).slice(2), Of = "__reactFiber$" + Nf, Pf = "__reactProps$" + Nf, uf = "__reactContainer$" + Nf, of = "__reactEvents$" + Nf, Qf = "__reactListeners$" + Nf, Rf = "__reactHandles$" + Nf;
function Wc$1(a) {
  var b = a[Of];
  if (b)
    return b;
  for (var c = a.parentNode; c; ) {
    if (b = c[uf] || c[Of]) {
      c = b.alternate;
      if (null !== b.child || null !== c && null !== c.child)
        for (a = Mf(a); null !== a; ) {
          if (c = a[Of])
            return c;
          a = Mf(a);
        }
      return b;
    }
    a = c;
    c = a.parentNode;
  }
  return null;
}
function Cb$2(a) {
  a = a[Of] || a[uf];
  return !a || 5 !== a.tag && 6 !== a.tag && 13 !== a.tag && 3 !== a.tag ? null : a;
}
function ue(a) {
  if (5 === a.tag || 6 === a.tag)
    return a.stateNode;
  throw Error(p$2(33));
}
function Db$2(a) {
  return a[Pf] || null;
}
var Sf = [], Tf = -1;
function Uf(a) {
  return { current: a };
}
function E$2(a) {
  0 > Tf || (a.current = Sf[Tf], Sf[Tf] = null, Tf--);
}
function G$1(a, b) {
  Tf++;
  Sf[Tf] = a.current;
  a.current = b;
}
var Vf = {}, H$2 = Uf(Vf), Wf = Uf(false), Xf = Vf;
function Yf(a, b) {
  var c = a.type.contextTypes;
  if (!c)
    return Vf;
  var d = a.stateNode;
  if (d && d.__reactInternalMemoizedUnmaskedChildContext === b)
    return d.__reactInternalMemoizedMaskedChildContext;
  var e = {}, f2;
  for (f2 in c)
    e[f2] = b[f2];
  d && (a = a.stateNode, a.__reactInternalMemoizedUnmaskedChildContext = b, a.__reactInternalMemoizedMaskedChildContext = e);
  return e;
}
function Zf(a) {
  a = a.childContextTypes;
  return null !== a && void 0 !== a;
}
function $f() {
  E$2(Wf);
  E$2(H$2);
}
function ag(a, b, c) {
  if (H$2.current !== Vf)
    throw Error(p$2(168));
  G$1(H$2, b);
  G$1(Wf, c);
}
function bg(a, b, c) {
  var d = a.stateNode;
  b = b.childContextTypes;
  if ("function" !== typeof d.getChildContext)
    return c;
  d = d.getChildContext();
  for (var e in d)
    if (!(e in b))
      throw Error(p$2(108, Ra$2(a) || "Unknown", e));
  return A$1({}, c, d);
}
function cg(a) {
  a = (a = a.stateNode) && a.__reactInternalMemoizedMergedChildContext || Vf;
  Xf = H$2.current;
  G$1(H$2, a);
  G$1(Wf, Wf.current);
  return true;
}
function dg(a, b, c) {
  var d = a.stateNode;
  if (!d)
    throw Error(p$2(169));
  c ? (a = bg(a, b, Xf), d.__reactInternalMemoizedMergedChildContext = a, E$2(Wf), E$2(H$2), G$1(H$2, a)) : E$2(Wf);
  G$1(Wf, c);
}
var eg = null, fg = false, gg = false;
function hg(a) {
  null === eg ? eg = [a] : eg.push(a);
}
function ig(a) {
  fg = true;
  hg(a);
}
function jg() {
  if (!gg && null !== eg) {
    gg = true;
    var a = 0, b = C$1;
    try {
      var c = eg;
      for (C$1 = 1; a < c.length; a++) {
        var d = c[a];
        do
          d = d(true);
        while (null !== d);
      }
      eg = null;
      fg = false;
    } catch (e) {
      throw null !== eg && (eg = eg.slice(a + 1)), ac$1(fc$1, jg), e;
    } finally {
      C$1 = b, gg = false;
    }
  }
  return null;
}
var kg = [], lg = 0, mg = null, ng = 0, og = [], pg = 0, qg = null, rg = 1, sg = "";
function tg(a, b) {
  kg[lg++] = ng;
  kg[lg++] = mg;
  mg = a;
  ng = b;
}
function ug(a, b, c) {
  og[pg++] = rg;
  og[pg++] = sg;
  og[pg++] = qg;
  qg = a;
  var d = rg;
  a = sg;
  var e = 32 - oc$1(d) - 1;
  d &= ~(1 << e);
  c += 1;
  var f2 = 32 - oc$1(b) + e;
  if (30 < f2) {
    var g = e - e % 5;
    f2 = (d & (1 << g) - 1).toString(32);
    d >>= g;
    e -= g;
    rg = 1 << 32 - oc$1(b) + e | c << e | d;
    sg = f2 + a;
  } else
    rg = 1 << f2 | c << e | d, sg = a;
}
function vg(a) {
  null !== a.return && (tg(a, 1), ug(a, 1, 0));
}
function wg(a) {
  for (; a === mg; )
    mg = kg[--lg], kg[lg] = null, ng = kg[--lg], kg[lg] = null;
  for (; a === qg; )
    qg = og[--pg], og[pg] = null, sg = og[--pg], og[pg] = null, rg = og[--pg], og[pg] = null;
}
var xg = null, yg = null, I$2 = false, zg = null;
function Ag(a, b) {
  var c = Bg(5, null, null, 0);
  c.elementType = "DELETED";
  c.stateNode = b;
  c.return = a;
  b = a.deletions;
  null === b ? (a.deletions = [c], a.flags |= 16) : b.push(c);
}
function Cg(a, b) {
  switch (a.tag) {
    case 5:
      var c = a.type;
      b = 1 !== b.nodeType || c.toLowerCase() !== b.nodeName.toLowerCase() ? null : b;
      return null !== b ? (a.stateNode = b, xg = a, yg = Lf(b.firstChild), true) : false;
    case 6:
      return b = "" === a.pendingProps || 3 !== b.nodeType ? null : b, null !== b ? (a.stateNode = b, xg = a, yg = null, true) : false;
    case 13:
      return b = 8 !== b.nodeType ? null : b, null !== b ? (c = null !== qg ? { id: rg, overflow: sg } : null, a.memoizedState = { dehydrated: b, treeContext: c, retryLane: 1073741824 }, c = Bg(18, null, null, 0), c.stateNode = b, c.return = a, a.child = c, xg = a, yg = null, true) : false;
    default:
      return false;
  }
}
function Dg(a) {
  return 0 !== (a.mode & 1) && 0 === (a.flags & 128);
}
function Eg(a) {
  if (I$2) {
    var b = yg;
    if (b) {
      var c = b;
      if (!Cg(a, b)) {
        if (Dg(a))
          throw Error(p$2(418));
        b = Lf(c.nextSibling);
        var d = xg;
        b && Cg(a, b) ? Ag(d, c) : (a.flags = a.flags & -4097 | 2, I$2 = false, xg = a);
      }
    } else {
      if (Dg(a))
        throw Error(p$2(418));
      a.flags = a.flags & -4097 | 2;
      I$2 = false;
      xg = a;
    }
  }
}
function Fg(a) {
  for (a = a.return; null !== a && 5 !== a.tag && 3 !== a.tag && 13 !== a.tag; )
    a = a.return;
  xg = a;
}
function Gg(a) {
  if (a !== xg)
    return false;
  if (!I$2)
    return Fg(a), I$2 = true, false;
  var b;
  (b = 3 !== a.tag) && !(b = 5 !== a.tag) && (b = a.type, b = "head" !== b && "body" !== b && !Ef(a.type, a.memoizedProps));
  if (b && (b = yg)) {
    if (Dg(a))
      throw Hg(), Error(p$2(418));
    for (; b; )
      Ag(a, b), b = Lf(b.nextSibling);
  }
  Fg(a);
  if (13 === a.tag) {
    a = a.memoizedState;
    a = null !== a ? a.dehydrated : null;
    if (!a)
      throw Error(p$2(317));
    a: {
      a = a.nextSibling;
      for (b = 0; a; ) {
        if (8 === a.nodeType) {
          var c = a.data;
          if ("/$" === c) {
            if (0 === b) {
              yg = Lf(a.nextSibling);
              break a;
            }
            b--;
          } else
            "$" !== c && "$!" !== c && "$?" !== c || b++;
        }
        a = a.nextSibling;
      }
      yg = null;
    }
  } else
    yg = xg ? Lf(a.stateNode.nextSibling) : null;
  return true;
}
function Hg() {
  for (var a = yg; a; )
    a = Lf(a.nextSibling);
}
function Ig() {
  yg = xg = null;
  I$2 = false;
}
function Jg(a) {
  null === zg ? zg = [a] : zg.push(a);
}
var Kg = ua$2.ReactCurrentBatchConfig;
function Lg(a, b) {
  if (a && a.defaultProps) {
    b = A$1({}, b);
    a = a.defaultProps;
    for (var c in a)
      void 0 === b[c] && (b[c] = a[c]);
    return b;
  }
  return b;
}
var Mg = Uf(null), Ng = null, Og = null, Pg = null;
function Qg() {
  Pg = Og = Ng = null;
}
function Rg(a) {
  var b = Mg.current;
  E$2(Mg);
  a._currentValue = b;
}
function Sg(a, b, c) {
  for (; null !== a; ) {
    var d = a.alternate;
    (a.childLanes & b) !== b ? (a.childLanes |= b, null !== d && (d.childLanes |= b)) : null !== d && (d.childLanes & b) !== b && (d.childLanes |= b);
    if (a === c)
      break;
    a = a.return;
  }
}
function Tg(a, b) {
  Ng = a;
  Pg = Og = null;
  a = a.dependencies;
  null !== a && null !== a.firstContext && (0 !== (a.lanes & b) && (Ug = true), a.firstContext = null);
}
function Vg(a) {
  var b = a._currentValue;
  if (Pg !== a)
    if (a = { context: a, memoizedValue: b, next: null }, null === Og) {
      if (null === Ng)
        throw Error(p$2(308));
      Og = a;
      Ng.dependencies = { lanes: 0, firstContext: a };
    } else
      Og = Og.next = a;
  return b;
}
var Wg = null;
function Xg(a) {
  null === Wg ? Wg = [a] : Wg.push(a);
}
function Yg(a, b, c, d) {
  var e = b.interleaved;
  null === e ? (c.next = c, Xg(b)) : (c.next = e.next, e.next = c);
  b.interleaved = c;
  return Zg(a, d);
}
function Zg(a, b) {
  a.lanes |= b;
  var c = a.alternate;
  null !== c && (c.lanes |= b);
  c = a;
  for (a = a.return; null !== a; )
    a.childLanes |= b, c = a.alternate, null !== c && (c.childLanes |= b), c = a, a = a.return;
  return 3 === c.tag ? c.stateNode : null;
}
var $g = false;
function ah(a) {
  a.updateQueue = { baseState: a.memoizedState, firstBaseUpdate: null, lastBaseUpdate: null, shared: { pending: null, interleaved: null, lanes: 0 }, effects: null };
}
function bh(a, b) {
  a = a.updateQueue;
  b.updateQueue === a && (b.updateQueue = { baseState: a.baseState, firstBaseUpdate: a.firstBaseUpdate, lastBaseUpdate: a.lastBaseUpdate, shared: a.shared, effects: a.effects });
}
function ch(a, b) {
  return { eventTime: a, lane: b, tag: 0, payload: null, callback: null, next: null };
}
function dh(a, b, c) {
  var d = a.updateQueue;
  if (null === d)
    return null;
  d = d.shared;
  if (0 !== (K$2 & 2)) {
    var e = d.pending;
    null === e ? b.next = b : (b.next = e.next, e.next = b);
    d.pending = b;
    return Zg(a, c);
  }
  e = d.interleaved;
  null === e ? (b.next = b, Xg(d)) : (b.next = e.next, e.next = b);
  d.interleaved = b;
  return Zg(a, c);
}
function eh(a, b, c) {
  b = b.updateQueue;
  if (null !== b && (b = b.shared, 0 !== (c & 4194240))) {
    var d = b.lanes;
    d &= a.pendingLanes;
    c |= d;
    b.lanes = c;
    Cc$1(a, c);
  }
}
function fh(a, b) {
  var c = a.updateQueue, d = a.alternate;
  if (null !== d && (d = d.updateQueue, c === d)) {
    var e = null, f2 = null;
    c = c.firstBaseUpdate;
    if (null !== c) {
      do {
        var g = { eventTime: c.eventTime, lane: c.lane, tag: c.tag, payload: c.payload, callback: c.callback, next: null };
        null === f2 ? e = f2 = g : f2 = f2.next = g;
        c = c.next;
      } while (null !== c);
      null === f2 ? e = f2 = b : f2 = f2.next = b;
    } else
      e = f2 = b;
    c = { baseState: d.baseState, firstBaseUpdate: e, lastBaseUpdate: f2, shared: d.shared, effects: d.effects };
    a.updateQueue = c;
    return;
  }
  a = c.lastBaseUpdate;
  null === a ? c.firstBaseUpdate = b : a.next = b;
  c.lastBaseUpdate = b;
}
function gh(a, b, c, d) {
  var e = a.updateQueue;
  $g = false;
  var f2 = e.firstBaseUpdate, g = e.lastBaseUpdate, h = e.shared.pending;
  if (null !== h) {
    e.shared.pending = null;
    var k2 = h, l2 = k2.next;
    k2.next = null;
    null === g ? f2 = l2 : g.next = l2;
    g = k2;
    var m2 = a.alternate;
    null !== m2 && (m2 = m2.updateQueue, h = m2.lastBaseUpdate, h !== g && (null === h ? m2.firstBaseUpdate = l2 : h.next = l2, m2.lastBaseUpdate = k2));
  }
  if (null !== f2) {
    var q2 = e.baseState;
    g = 0;
    m2 = l2 = k2 = null;
    h = f2;
    do {
      var r2 = h.lane, y2 = h.eventTime;
      if ((d & r2) === r2) {
        null !== m2 && (m2 = m2.next = {
          eventTime: y2,
          lane: 0,
          tag: h.tag,
          payload: h.payload,
          callback: h.callback,
          next: null
        });
        a: {
          var n2 = a, t2 = h;
          r2 = b;
          y2 = c;
          switch (t2.tag) {
            case 1:
              n2 = t2.payload;
              if ("function" === typeof n2) {
                q2 = n2.call(y2, q2, r2);
                break a;
              }
              q2 = n2;
              break a;
            case 3:
              n2.flags = n2.flags & -65537 | 128;
            case 0:
              n2 = t2.payload;
              r2 = "function" === typeof n2 ? n2.call(y2, q2, r2) : n2;
              if (null === r2 || void 0 === r2)
                break a;
              q2 = A$1({}, q2, r2);
              break a;
            case 2:
              $g = true;
          }
        }
        null !== h.callback && 0 !== h.lane && (a.flags |= 64, r2 = e.effects, null === r2 ? e.effects = [h] : r2.push(h));
      } else
        y2 = { eventTime: y2, lane: r2, tag: h.tag, payload: h.payload, callback: h.callback, next: null }, null === m2 ? (l2 = m2 = y2, k2 = q2) : m2 = m2.next = y2, g |= r2;
      h = h.next;
      if (null === h)
        if (h = e.shared.pending, null === h)
          break;
        else
          r2 = h, h = r2.next, r2.next = null, e.lastBaseUpdate = r2, e.shared.pending = null;
    } while (1);
    null === m2 && (k2 = q2);
    e.baseState = k2;
    e.firstBaseUpdate = l2;
    e.lastBaseUpdate = m2;
    b = e.shared.interleaved;
    if (null !== b) {
      e = b;
      do
        g |= e.lane, e = e.next;
      while (e !== b);
    } else
      null === f2 && (e.shared.lanes = 0);
    hh |= g;
    a.lanes = g;
    a.memoizedState = q2;
  }
}
function ih(a, b, c) {
  a = b.effects;
  b.effects = null;
  if (null !== a)
    for (b = 0; b < a.length; b++) {
      var d = a[b], e = d.callback;
      if (null !== e) {
        d.callback = null;
        d = c;
        if ("function" !== typeof e)
          throw Error(p$2(191, e));
        e.call(d);
      }
    }
}
var jh = new aa$2.Component().refs;
function kh(a, b, c, d) {
  b = a.memoizedState;
  c = c(d, b);
  c = null === c || void 0 === c ? b : A$1({}, b, c);
  a.memoizedState = c;
  0 === a.lanes && (a.updateQueue.baseState = c);
}
var nh = { isMounted: function(a) {
  return (a = a._reactInternals) ? Vb$1(a) === a : false;
}, enqueueSetState: function(a, b, c) {
  a = a._reactInternals;
  var d = L$2(), e = lh(a), f2 = ch(d, e);
  f2.payload = b;
  void 0 !== c && null !== c && (f2.callback = c);
  b = dh(a, f2, e);
  null !== b && (mh(b, a, e, d), eh(b, a, e));
}, enqueueReplaceState: function(a, b, c) {
  a = a._reactInternals;
  var d = L$2(), e = lh(a), f2 = ch(d, e);
  f2.tag = 1;
  f2.payload = b;
  void 0 !== c && null !== c && (f2.callback = c);
  b = dh(a, f2, e);
  null !== b && (mh(b, a, e, d), eh(b, a, e));
}, enqueueForceUpdate: function(a, b) {
  a = a._reactInternals;
  var c = L$2(), d = lh(a), e = ch(c, d);
  e.tag = 2;
  void 0 !== b && null !== b && (e.callback = b);
  b = dh(a, e, d);
  null !== b && (mh(b, a, d, c), eh(b, a, d));
} };
function oh(a, b, c, d, e, f2, g) {
  a = a.stateNode;
  return "function" === typeof a.shouldComponentUpdate ? a.shouldComponentUpdate(d, f2, g) : b.prototype && b.prototype.isPureReactComponent ? !Ie(c, d) || !Ie(e, f2) : true;
}
function ph(a, b, c) {
  var d = false, e = Vf;
  var f2 = b.contextType;
  "object" === typeof f2 && null !== f2 ? f2 = Vg(f2) : (e = Zf(b) ? Xf : H$2.current, d = b.contextTypes, f2 = (d = null !== d && void 0 !== d) ? Yf(a, e) : Vf);
  b = new b(c, f2);
  a.memoizedState = null !== b.state && void 0 !== b.state ? b.state : null;
  b.updater = nh;
  a.stateNode = b;
  b._reactInternals = a;
  d && (a = a.stateNode, a.__reactInternalMemoizedUnmaskedChildContext = e, a.__reactInternalMemoizedMaskedChildContext = f2);
  return b;
}
function qh(a, b, c, d) {
  a = b.state;
  "function" === typeof b.componentWillReceiveProps && b.componentWillReceiveProps(c, d);
  "function" === typeof b.UNSAFE_componentWillReceiveProps && b.UNSAFE_componentWillReceiveProps(c, d);
  b.state !== a && nh.enqueueReplaceState(b, b.state, null);
}
function rh(a, b, c, d) {
  var e = a.stateNode;
  e.props = c;
  e.state = a.memoizedState;
  e.refs = jh;
  ah(a);
  var f2 = b.contextType;
  "object" === typeof f2 && null !== f2 ? e.context = Vg(f2) : (f2 = Zf(b) ? Xf : H$2.current, e.context = Yf(a, f2));
  e.state = a.memoizedState;
  f2 = b.getDerivedStateFromProps;
  "function" === typeof f2 && (kh(a, b, f2, c), e.state = a.memoizedState);
  "function" === typeof b.getDerivedStateFromProps || "function" === typeof e.getSnapshotBeforeUpdate || "function" !== typeof e.UNSAFE_componentWillMount && "function" !== typeof e.componentWillMount || (b = e.state, "function" === typeof e.componentWillMount && e.componentWillMount(), "function" === typeof e.UNSAFE_componentWillMount && e.UNSAFE_componentWillMount(), b !== e.state && nh.enqueueReplaceState(e, e.state, null), gh(a, c, e, d), e.state = a.memoizedState);
  "function" === typeof e.componentDidMount && (a.flags |= 4194308);
}
function sh(a, b, c) {
  a = c.ref;
  if (null !== a && "function" !== typeof a && "object" !== typeof a) {
    if (c._owner) {
      c = c._owner;
      if (c) {
        if (1 !== c.tag)
          throw Error(p$2(309));
        var d = c.stateNode;
      }
      if (!d)
        throw Error(p$2(147, a));
      var e = d, f2 = "" + a;
      if (null !== b && null !== b.ref && "function" === typeof b.ref && b.ref._stringRef === f2)
        return b.ref;
      b = function(a2) {
        var b2 = e.refs;
        b2 === jh && (b2 = e.refs = {});
        null === a2 ? delete b2[f2] : b2[f2] = a2;
      };
      b._stringRef = f2;
      return b;
    }
    if ("string" !== typeof a)
      throw Error(p$2(284));
    if (!c._owner)
      throw Error(p$2(290, a));
  }
  return a;
}
function th(a, b) {
  a = Object.prototype.toString.call(b);
  throw Error(p$2(31, "[object Object]" === a ? "object with keys {" + Object.keys(b).join(", ") + "}" : a));
}
function uh(a) {
  var b = a._init;
  return b(a._payload);
}
function vh(a) {
  function b(b2, c2) {
    if (a) {
      var d2 = b2.deletions;
      null === d2 ? (b2.deletions = [c2], b2.flags |= 16) : d2.push(c2);
    }
  }
  function c(c2, d2) {
    if (!a)
      return null;
    for (; null !== d2; )
      b(c2, d2), d2 = d2.sibling;
    return null;
  }
  function d(a2, b2) {
    for (a2 = /* @__PURE__ */ new Map(); null !== b2; )
      null !== b2.key ? a2.set(b2.key, b2) : a2.set(b2.index, b2), b2 = b2.sibling;
    return a2;
  }
  function e(a2, b2) {
    a2 = wh(a2, b2);
    a2.index = 0;
    a2.sibling = null;
    return a2;
  }
  function f2(b2, c2, d2) {
    b2.index = d2;
    if (!a)
      return b2.flags |= 1048576, c2;
    d2 = b2.alternate;
    if (null !== d2)
      return d2 = d2.index, d2 < c2 ? (b2.flags |= 2, c2) : d2;
    b2.flags |= 2;
    return c2;
  }
  function g(b2) {
    a && null === b2.alternate && (b2.flags |= 2);
    return b2;
  }
  function h(a2, b2, c2, d2) {
    if (null === b2 || 6 !== b2.tag)
      return b2 = xh(c2, a2.mode, d2), b2.return = a2, b2;
    b2 = e(b2, c2);
    b2.return = a2;
    return b2;
  }
  function k2(a2, b2, c2, d2) {
    var f3 = c2.type;
    if (f3 === ya$2)
      return m2(a2, b2, c2.props.children, d2, c2.key);
    if (null !== b2 && (b2.elementType === f3 || "object" === typeof f3 && null !== f3 && f3.$$typeof === Ha$2 && uh(f3) === b2.type))
      return d2 = e(b2, c2.props), d2.ref = sh(a2, b2, c2), d2.return = a2, d2;
    d2 = yh(c2.type, c2.key, c2.props, null, a2.mode, d2);
    d2.ref = sh(a2, b2, c2);
    d2.return = a2;
    return d2;
  }
  function l2(a2, b2, c2, d2) {
    if (null === b2 || 4 !== b2.tag || b2.stateNode.containerInfo !== c2.containerInfo || b2.stateNode.implementation !== c2.implementation)
      return b2 = zh(c2, a2.mode, d2), b2.return = a2, b2;
    b2 = e(b2, c2.children || []);
    b2.return = a2;
    return b2;
  }
  function m2(a2, b2, c2, d2, f3) {
    if (null === b2 || 7 !== b2.tag)
      return b2 = Ah(c2, a2.mode, d2, f3), b2.return = a2, b2;
    b2 = e(b2, c2);
    b2.return = a2;
    return b2;
  }
  function q2(a2, b2, c2) {
    if ("string" === typeof b2 && "" !== b2 || "number" === typeof b2)
      return b2 = xh("" + b2, a2.mode, c2), b2.return = a2, b2;
    if ("object" === typeof b2 && null !== b2) {
      switch (b2.$$typeof) {
        case va$2:
          return c2 = yh(b2.type, b2.key, b2.props, null, a2.mode, c2), c2.ref = sh(a2, null, b2), c2.return = a2, c2;
        case wa$2:
          return b2 = zh(b2, a2.mode, c2), b2.return = a2, b2;
        case Ha$2:
          var d2 = b2._init;
          return q2(a2, d2(b2._payload), c2);
      }
      if (eb$2(b2) || Ka$2(b2))
        return b2 = Ah(b2, a2.mode, c2, null), b2.return = a2, b2;
      th(a2, b2);
    }
    return null;
  }
  function r2(a2, b2, c2, d2) {
    var e2 = null !== b2 ? b2.key : null;
    if ("string" === typeof c2 && "" !== c2 || "number" === typeof c2)
      return null !== e2 ? null : h(a2, b2, "" + c2, d2);
    if ("object" === typeof c2 && null !== c2) {
      switch (c2.$$typeof) {
        case va$2:
          return c2.key === e2 ? k2(a2, b2, c2, d2) : null;
        case wa$2:
          return c2.key === e2 ? l2(a2, b2, c2, d2) : null;
        case Ha$2:
          return e2 = c2._init, r2(
            a2,
            b2,
            e2(c2._payload),
            d2
          );
      }
      if (eb$2(c2) || Ka$2(c2))
        return null !== e2 ? null : m2(a2, b2, c2, d2, null);
      th(a2, c2);
    }
    return null;
  }
  function y2(a2, b2, c2, d2, e2) {
    if ("string" === typeof d2 && "" !== d2 || "number" === typeof d2)
      return a2 = a2.get(c2) || null, h(b2, a2, "" + d2, e2);
    if ("object" === typeof d2 && null !== d2) {
      switch (d2.$$typeof) {
        case va$2:
          return a2 = a2.get(null === d2.key ? c2 : d2.key) || null, k2(b2, a2, d2, e2);
        case wa$2:
          return a2 = a2.get(null === d2.key ? c2 : d2.key) || null, l2(b2, a2, d2, e2);
        case Ha$2:
          var f3 = d2._init;
          return y2(a2, b2, c2, f3(d2._payload), e2);
      }
      if (eb$2(d2) || Ka$2(d2))
        return a2 = a2.get(c2) || null, m2(b2, a2, d2, e2, null);
      th(b2, d2);
    }
    return null;
  }
  function n2(e2, g2, h3, k3) {
    for (var l3 = null, m3 = null, u2 = g2, w2 = g2 = 0, x2 = null; null !== u2 && w2 < h3.length; w2++) {
      u2.index > w2 ? (x2 = u2, u2 = null) : x2 = u2.sibling;
      var n3 = r2(e2, u2, h3[w2], k3);
      if (null === n3) {
        null === u2 && (u2 = x2);
        break;
      }
      a && u2 && null === n3.alternate && b(e2, u2);
      g2 = f2(n3, g2, w2);
      null === m3 ? l3 = n3 : m3.sibling = n3;
      m3 = n3;
      u2 = x2;
    }
    if (w2 === h3.length)
      return c(e2, u2), I$2 && tg(e2, w2), l3;
    if (null === u2) {
      for (; w2 < h3.length; w2++)
        u2 = q2(e2, h3[w2], k3), null !== u2 && (g2 = f2(u2, g2, w2), null === m3 ? l3 = u2 : m3.sibling = u2, m3 = u2);
      I$2 && tg(e2, w2);
      return l3;
    }
    for (u2 = d(e2, u2); w2 < h3.length; w2++)
      x2 = y2(u2, e2, w2, h3[w2], k3), null !== x2 && (a && null !== x2.alternate && u2.delete(null === x2.key ? w2 : x2.key), g2 = f2(x2, g2, w2), null === m3 ? l3 = x2 : m3.sibling = x2, m3 = x2);
    a && u2.forEach(function(a2) {
      return b(e2, a2);
    });
    I$2 && tg(e2, w2);
    return l3;
  }
  function t2(e2, g2, h3, k3) {
    var l3 = Ka$2(h3);
    if ("function" !== typeof l3)
      throw Error(p$2(150));
    h3 = l3.call(h3);
    if (null == h3)
      throw Error(p$2(151));
    for (var u2 = l3 = null, m3 = g2, w2 = g2 = 0, x2 = null, n3 = h3.next(); null !== m3 && !n3.done; w2++, n3 = h3.next()) {
      m3.index > w2 ? (x2 = m3, m3 = null) : x2 = m3.sibling;
      var t3 = r2(e2, m3, n3.value, k3);
      if (null === t3) {
        null === m3 && (m3 = x2);
        break;
      }
      a && m3 && null === t3.alternate && b(e2, m3);
      g2 = f2(t3, g2, w2);
      null === u2 ? l3 = t3 : u2.sibling = t3;
      u2 = t3;
      m3 = x2;
    }
    if (n3.done)
      return c(
        e2,
        m3
      ), I$2 && tg(e2, w2), l3;
    if (null === m3) {
      for (; !n3.done; w2++, n3 = h3.next())
        n3 = q2(e2, n3.value, k3), null !== n3 && (g2 = f2(n3, g2, w2), null === u2 ? l3 = n3 : u2.sibling = n3, u2 = n3);
      I$2 && tg(e2, w2);
      return l3;
    }
    for (m3 = d(e2, m3); !n3.done; w2++, n3 = h3.next())
      n3 = y2(m3, e2, w2, n3.value, k3), null !== n3 && (a && null !== n3.alternate && m3.delete(null === n3.key ? w2 : n3.key), g2 = f2(n3, g2, w2), null === u2 ? l3 = n3 : u2.sibling = n3, u2 = n3);
    a && m3.forEach(function(a2) {
      return b(e2, a2);
    });
    I$2 && tg(e2, w2);
    return l3;
  }
  function J2(a2, d2, f3, h3) {
    "object" === typeof f3 && null !== f3 && f3.type === ya$2 && null === f3.key && (f3 = f3.props.children);
    if ("object" === typeof f3 && null !== f3) {
      switch (f3.$$typeof) {
        case va$2:
          a: {
            for (var k3 = f3.key, l3 = d2; null !== l3; ) {
              if (l3.key === k3) {
                k3 = f3.type;
                if (k3 === ya$2) {
                  if (7 === l3.tag) {
                    c(a2, l3.sibling);
                    d2 = e(l3, f3.props.children);
                    d2.return = a2;
                    a2 = d2;
                    break a;
                  }
                } else if (l3.elementType === k3 || "object" === typeof k3 && null !== k3 && k3.$$typeof === Ha$2 && uh(k3) === l3.type) {
                  c(a2, l3.sibling);
                  d2 = e(l3, f3.props);
                  d2.ref = sh(a2, l3, f3);
                  d2.return = a2;
                  a2 = d2;
                  break a;
                }
                c(a2, l3);
                break;
              } else
                b(a2, l3);
              l3 = l3.sibling;
            }
            f3.type === ya$2 ? (d2 = Ah(f3.props.children, a2.mode, h3, f3.key), d2.return = a2, a2 = d2) : (h3 = yh(f3.type, f3.key, f3.props, null, a2.mode, h3), h3.ref = sh(a2, d2, f3), h3.return = a2, a2 = h3);
          }
          return g(a2);
        case wa$2:
          a: {
            for (l3 = f3.key; null !== d2; ) {
              if (d2.key === l3)
                if (4 === d2.tag && d2.stateNode.containerInfo === f3.containerInfo && d2.stateNode.implementation === f3.implementation) {
                  c(a2, d2.sibling);
                  d2 = e(d2, f3.children || []);
                  d2.return = a2;
                  a2 = d2;
                  break a;
                } else {
                  c(a2, d2);
                  break;
                }
              else
                b(a2, d2);
              d2 = d2.sibling;
            }
            d2 = zh(f3, a2.mode, h3);
            d2.return = a2;
            a2 = d2;
          }
          return g(a2);
        case Ha$2:
          return l3 = f3._init, J2(a2, d2, l3(f3._payload), h3);
      }
      if (eb$2(f3))
        return n2(a2, d2, f3, h3);
      if (Ka$2(f3))
        return t2(a2, d2, f3, h3);
      th(a2, f3);
    }
    return "string" === typeof f3 && "" !== f3 || "number" === typeof f3 ? (f3 = "" + f3, null !== d2 && 6 === d2.tag ? (c(a2, d2.sibling), d2 = e(d2, f3), d2.return = a2, a2 = d2) : (c(a2, d2), d2 = xh(f3, a2.mode, h3), d2.return = a2, a2 = d2), g(a2)) : c(a2, d2);
  }
  return J2;
}
var Bh = vh(true), Ch = vh(false), Dh = {}, Eh = Uf(Dh), Fh = Uf(Dh), Gh = Uf(Dh);
function Hh(a) {
  if (a === Dh)
    throw Error(p$2(174));
  return a;
}
function Ih(a, b) {
  G$1(Gh, b);
  G$1(Fh, a);
  G$1(Eh, Dh);
  a = b.nodeType;
  switch (a) {
    case 9:
    case 11:
      b = (b = b.documentElement) ? b.namespaceURI : lb$2(null, "");
      break;
    default:
      a = 8 === a ? b.parentNode : b, b = a.namespaceURI || null, a = a.tagName, b = lb$2(b, a);
  }
  E$2(Eh);
  G$1(Eh, b);
}
function Jh() {
  E$2(Eh);
  E$2(Fh);
  E$2(Gh);
}
function Kh(a) {
  Hh(Gh.current);
  var b = Hh(Eh.current);
  var c = lb$2(b, a.type);
  b !== c && (G$1(Fh, a), G$1(Eh, c));
}
function Lh(a) {
  Fh.current === a && (E$2(Eh), E$2(Fh));
}
var M$2 = Uf(0);
function Mh(a) {
  for (var b = a; null !== b; ) {
    if (13 === b.tag) {
      var c = b.memoizedState;
      if (null !== c && (c = c.dehydrated, null === c || "$?" === c.data || "$!" === c.data))
        return b;
    } else if (19 === b.tag && void 0 !== b.memoizedProps.revealOrder) {
      if (0 !== (b.flags & 128))
        return b;
    } else if (null !== b.child) {
      b.child.return = b;
      b = b.child;
      continue;
    }
    if (b === a)
      break;
    for (; null === b.sibling; ) {
      if (null === b.return || b.return === a)
        return null;
      b = b.return;
    }
    b.sibling.return = b.return;
    b = b.sibling;
  }
  return null;
}
var Nh = [];
function Oh() {
  for (var a = 0; a < Nh.length; a++)
    Nh[a]._workInProgressVersionPrimary = null;
  Nh.length = 0;
}
var Ph = ua$2.ReactCurrentDispatcher, Qh = ua$2.ReactCurrentBatchConfig, Rh = 0, N$2 = null, O$2 = null, P$2 = null, Sh = false, Th = false, Uh = 0, Vh = 0;
function Q$2() {
  throw Error(p$2(321));
}
function Wh(a, b) {
  if (null === b)
    return false;
  for (var c = 0; c < b.length && c < a.length; c++)
    if (!He(a[c], b[c]))
      return false;
  return true;
}
function Xh(a, b, c, d, e, f2) {
  Rh = f2;
  N$2 = b;
  b.memoizedState = null;
  b.updateQueue = null;
  b.lanes = 0;
  Ph.current = null === a || null === a.memoizedState ? Yh : Zh;
  a = c(d, e);
  if (Th) {
    f2 = 0;
    do {
      Th = false;
      Uh = 0;
      if (25 <= f2)
        throw Error(p$2(301));
      f2 += 1;
      P$2 = O$2 = null;
      b.updateQueue = null;
      Ph.current = $h;
      a = c(d, e);
    } while (Th);
  }
  Ph.current = ai;
  b = null !== O$2 && null !== O$2.next;
  Rh = 0;
  P$2 = O$2 = N$2 = null;
  Sh = false;
  if (b)
    throw Error(p$2(300));
  return a;
}
function bi() {
  var a = 0 !== Uh;
  Uh = 0;
  return a;
}
function ci() {
  var a = { memoizedState: null, baseState: null, baseQueue: null, queue: null, next: null };
  null === P$2 ? N$2.memoizedState = P$2 = a : P$2 = P$2.next = a;
  return P$2;
}
function di() {
  if (null === O$2) {
    var a = N$2.alternate;
    a = null !== a ? a.memoizedState : null;
  } else
    a = O$2.next;
  var b = null === P$2 ? N$2.memoizedState : P$2.next;
  if (null !== b)
    P$2 = b, O$2 = a;
  else {
    if (null === a)
      throw Error(p$2(310));
    O$2 = a;
    a = { memoizedState: O$2.memoizedState, baseState: O$2.baseState, baseQueue: O$2.baseQueue, queue: O$2.queue, next: null };
    null === P$2 ? N$2.memoizedState = P$2 = a : P$2 = P$2.next = a;
  }
  return P$2;
}
function ei(a, b) {
  return "function" === typeof b ? b(a) : b;
}
function fi(a) {
  var b = di(), c = b.queue;
  if (null === c)
    throw Error(p$2(311));
  c.lastRenderedReducer = a;
  var d = O$2, e = d.baseQueue, f2 = c.pending;
  if (null !== f2) {
    if (null !== e) {
      var g = e.next;
      e.next = f2.next;
      f2.next = g;
    }
    d.baseQueue = e = f2;
    c.pending = null;
  }
  if (null !== e) {
    f2 = e.next;
    d = d.baseState;
    var h = g = null, k2 = null, l2 = f2;
    do {
      var m2 = l2.lane;
      if ((Rh & m2) === m2)
        null !== k2 && (k2 = k2.next = { lane: 0, action: l2.action, hasEagerState: l2.hasEagerState, eagerState: l2.eagerState, next: null }), d = l2.hasEagerState ? l2.eagerState : a(d, l2.action);
      else {
        var q2 = {
          lane: m2,
          action: l2.action,
          hasEagerState: l2.hasEagerState,
          eagerState: l2.eagerState,
          next: null
        };
        null === k2 ? (h = k2 = q2, g = d) : k2 = k2.next = q2;
        N$2.lanes |= m2;
        hh |= m2;
      }
      l2 = l2.next;
    } while (null !== l2 && l2 !== f2);
    null === k2 ? g = d : k2.next = h;
    He(d, b.memoizedState) || (Ug = true);
    b.memoizedState = d;
    b.baseState = g;
    b.baseQueue = k2;
    c.lastRenderedState = d;
  }
  a = c.interleaved;
  if (null !== a) {
    e = a;
    do
      f2 = e.lane, N$2.lanes |= f2, hh |= f2, e = e.next;
    while (e !== a);
  } else
    null === e && (c.lanes = 0);
  return [b.memoizedState, c.dispatch];
}
function gi(a) {
  var b = di(), c = b.queue;
  if (null === c)
    throw Error(p$2(311));
  c.lastRenderedReducer = a;
  var d = c.dispatch, e = c.pending, f2 = b.memoizedState;
  if (null !== e) {
    c.pending = null;
    var g = e = e.next;
    do
      f2 = a(f2, g.action), g = g.next;
    while (g !== e);
    He(f2, b.memoizedState) || (Ug = true);
    b.memoizedState = f2;
    null === b.baseQueue && (b.baseState = f2);
    c.lastRenderedState = f2;
  }
  return [f2, d];
}
function hi() {
}
function ii(a, b) {
  var c = N$2, d = di(), e = b(), f2 = !He(d.memoizedState, e);
  f2 && (d.memoizedState = e, Ug = true);
  d = d.queue;
  ji(ki.bind(null, c, d, a), [a]);
  if (d.getSnapshot !== b || f2 || null !== P$2 && P$2.memoizedState.tag & 1) {
    c.flags |= 2048;
    li(9, mi.bind(null, c, d, e, b), void 0, null);
    if (null === R$3)
      throw Error(p$2(349));
    0 !== (Rh & 30) || ni(c, b, e);
  }
  return e;
}
function ni(a, b, c) {
  a.flags |= 16384;
  a = { getSnapshot: b, value: c };
  b = N$2.updateQueue;
  null === b ? (b = { lastEffect: null, stores: null }, N$2.updateQueue = b, b.stores = [a]) : (c = b.stores, null === c ? b.stores = [a] : c.push(a));
}
function mi(a, b, c, d) {
  b.value = c;
  b.getSnapshot = d;
  oi(b) && pi(a);
}
function ki(a, b, c) {
  return c(function() {
    oi(b) && pi(a);
  });
}
function oi(a) {
  var b = a.getSnapshot;
  a = a.value;
  try {
    var c = b();
    return !He(a, c);
  } catch (d) {
    return true;
  }
}
function pi(a) {
  var b = Zg(a, 1);
  null !== b && mh(b, a, 1, -1);
}
function qi(a) {
  var b = ci();
  "function" === typeof a && (a = a());
  b.memoizedState = b.baseState = a;
  a = { pending: null, interleaved: null, lanes: 0, dispatch: null, lastRenderedReducer: ei, lastRenderedState: a };
  b.queue = a;
  a = a.dispatch = ri.bind(null, N$2, a);
  return [b.memoizedState, a];
}
function li(a, b, c, d) {
  a = { tag: a, create: b, destroy: c, deps: d, next: null };
  b = N$2.updateQueue;
  null === b ? (b = { lastEffect: null, stores: null }, N$2.updateQueue = b, b.lastEffect = a.next = a) : (c = b.lastEffect, null === c ? b.lastEffect = a.next = a : (d = c.next, c.next = a, a.next = d, b.lastEffect = a));
  return a;
}
function si() {
  return di().memoizedState;
}
function ti(a, b, c, d) {
  var e = ci();
  N$2.flags |= a;
  e.memoizedState = li(1 | b, c, void 0, void 0 === d ? null : d);
}
function ui(a, b, c, d) {
  var e = di();
  d = void 0 === d ? null : d;
  var f2 = void 0;
  if (null !== O$2) {
    var g = O$2.memoizedState;
    f2 = g.destroy;
    if (null !== d && Wh(d, g.deps)) {
      e.memoizedState = li(b, c, f2, d);
      return;
    }
  }
  N$2.flags |= a;
  e.memoizedState = li(1 | b, c, f2, d);
}
function vi(a, b) {
  return ti(8390656, 8, a, b);
}
function ji(a, b) {
  return ui(2048, 8, a, b);
}
function wi(a, b) {
  return ui(4, 2, a, b);
}
function xi(a, b) {
  return ui(4, 4, a, b);
}
function yi(a, b) {
  if ("function" === typeof b)
    return a = a(), b(a), function() {
      b(null);
    };
  if (null !== b && void 0 !== b)
    return a = a(), b.current = a, function() {
      b.current = null;
    };
}
function zi(a, b, c) {
  c = null !== c && void 0 !== c ? c.concat([a]) : null;
  return ui(4, 4, yi.bind(null, b, a), c);
}
function Ai() {
}
function Bi(a, b) {
  var c = di();
  b = void 0 === b ? null : b;
  var d = c.memoizedState;
  if (null !== d && null !== b && Wh(b, d[1]))
    return d[0];
  c.memoizedState = [a, b];
  return a;
}
function Ci(a, b) {
  var c = di();
  b = void 0 === b ? null : b;
  var d = c.memoizedState;
  if (null !== d && null !== b && Wh(b, d[1]))
    return d[0];
  a = a();
  c.memoizedState = [a, b];
  return a;
}
function Di(a, b, c) {
  if (0 === (Rh & 21))
    return a.baseState && (a.baseState = false, Ug = true), a.memoizedState = c;
  He(c, b) || (c = yc$1(), N$2.lanes |= c, hh |= c, a.baseState = true);
  return b;
}
function Ei(a, b) {
  var c = C$1;
  C$1 = 0 !== c && 4 > c ? c : 4;
  a(true);
  var d = Qh.transition;
  Qh.transition = {};
  try {
    a(false), b();
  } finally {
    C$1 = c, Qh.transition = d;
  }
}
function Fi() {
  return di().memoizedState;
}
function Gi(a, b, c) {
  var d = lh(a);
  c = { lane: d, action: c, hasEagerState: false, eagerState: null, next: null };
  if (Hi(a))
    Ii(b, c);
  else if (c = Yg(a, b, c, d), null !== c) {
    var e = L$2();
    mh(c, a, d, e);
    Ji(c, b, d);
  }
}
function ri(a, b, c) {
  var d = lh(a), e = { lane: d, action: c, hasEagerState: false, eagerState: null, next: null };
  if (Hi(a))
    Ii(b, e);
  else {
    var f2 = a.alternate;
    if (0 === a.lanes && (null === f2 || 0 === f2.lanes) && (f2 = b.lastRenderedReducer, null !== f2))
      try {
        var g = b.lastRenderedState, h = f2(g, c);
        e.hasEagerState = true;
        e.eagerState = h;
        if (He(h, g)) {
          var k2 = b.interleaved;
          null === k2 ? (e.next = e, Xg(b)) : (e.next = k2.next, k2.next = e);
          b.interleaved = e;
          return;
        }
      } catch (l2) {
      } finally {
      }
    c = Yg(a, b, e, d);
    null !== c && (e = L$2(), mh(c, a, d, e), Ji(c, b, d));
  }
}
function Hi(a) {
  var b = a.alternate;
  return a === N$2 || null !== b && b === N$2;
}
function Ii(a, b) {
  Th = Sh = true;
  var c = a.pending;
  null === c ? b.next = b : (b.next = c.next, c.next = b);
  a.pending = b;
}
function Ji(a, b, c) {
  if (0 !== (c & 4194240)) {
    var d = b.lanes;
    d &= a.pendingLanes;
    c |= d;
    b.lanes = c;
    Cc$1(a, c);
  }
}
var ai = { readContext: Vg, useCallback: Q$2, useContext: Q$2, useEffect: Q$2, useImperativeHandle: Q$2, useInsertionEffect: Q$2, useLayoutEffect: Q$2, useMemo: Q$2, useReducer: Q$2, useRef: Q$2, useState: Q$2, useDebugValue: Q$2, useDeferredValue: Q$2, useTransition: Q$2, useMutableSource: Q$2, useSyncExternalStore: Q$2, useId: Q$2, unstable_isNewReconciler: false }, Yh = { readContext: Vg, useCallback: function(a, b) {
  ci().memoizedState = [a, void 0 === b ? null : b];
  return a;
}, useContext: Vg, useEffect: vi, useImperativeHandle: function(a, b, c) {
  c = null !== c && void 0 !== c ? c.concat([a]) : null;
  return ti(
    4194308,
    4,
    yi.bind(null, b, a),
    c
  );
}, useLayoutEffect: function(a, b) {
  return ti(4194308, 4, a, b);
}, useInsertionEffect: function(a, b) {
  return ti(4, 2, a, b);
}, useMemo: function(a, b) {
  var c = ci();
  b = void 0 === b ? null : b;
  a = a();
  c.memoizedState = [a, b];
  return a;
}, useReducer: function(a, b, c) {
  var d = ci();
  b = void 0 !== c ? c(b) : b;
  d.memoizedState = d.baseState = b;
  a = { pending: null, interleaved: null, lanes: 0, dispatch: null, lastRenderedReducer: a, lastRenderedState: b };
  d.queue = a;
  a = a.dispatch = Gi.bind(null, N$2, a);
  return [d.memoizedState, a];
}, useRef: function(a) {
  var b = ci();
  a = { current: a };
  return b.memoizedState = a;
}, useState: qi, useDebugValue: Ai, useDeferredValue: function(a) {
  return ci().memoizedState = a;
}, useTransition: function() {
  var a = qi(false), b = a[0];
  a = Ei.bind(null, a[1]);
  ci().memoizedState = a;
  return [b, a];
}, useMutableSource: function() {
}, useSyncExternalStore: function(a, b, c) {
  var d = N$2, e = ci();
  if (I$2) {
    if (void 0 === c)
      throw Error(p$2(407));
    c = c();
  } else {
    c = b();
    if (null === R$3)
      throw Error(p$2(349));
    0 !== (Rh & 30) || ni(d, b, c);
  }
  e.memoizedState = c;
  var f2 = { value: c, getSnapshot: b };
  e.queue = f2;
  vi(ki.bind(
    null,
    d,
    f2,
    a
  ), [a]);
  d.flags |= 2048;
  li(9, mi.bind(null, d, f2, c, b), void 0, null);
  return c;
}, useId: function() {
  var a = ci(), b = R$3.identifierPrefix;
  if (I$2) {
    var c = sg;
    var d = rg;
    c = (d & ~(1 << 32 - oc$1(d) - 1)).toString(32) + c;
    b = ":" + b + "R" + c;
    c = Uh++;
    0 < c && (b += "H" + c.toString(32));
    b += ":";
  } else
    c = Vh++, b = ":" + b + "r" + c.toString(32) + ":";
  return a.memoizedState = b;
}, unstable_isNewReconciler: false }, Zh = {
  readContext: Vg,
  useCallback: Bi,
  useContext: Vg,
  useEffect: ji,
  useImperativeHandle: zi,
  useInsertionEffect: wi,
  useLayoutEffect: xi,
  useMemo: Ci,
  useReducer: fi,
  useRef: si,
  useState: function() {
    return fi(ei);
  },
  useDebugValue: Ai,
  useDeferredValue: function(a) {
    var b = di();
    return Di(b, O$2.memoizedState, a);
  },
  useTransition: function() {
    var a = fi(ei)[0], b = di().memoizedState;
    return [a, b];
  },
  useMutableSource: hi,
  useSyncExternalStore: ii,
  useId: Fi,
  unstable_isNewReconciler: false
}, $h = { readContext: Vg, useCallback: Bi, useContext: Vg, useEffect: ji, useImperativeHandle: zi, useInsertionEffect: wi, useLayoutEffect: xi, useMemo: Ci, useReducer: gi, useRef: si, useState: function() {
  return gi(ei);
}, useDebugValue: Ai, useDeferredValue: function(a) {
  var b = di();
  return null === O$2 ? b.memoizedState = a : Di(b, O$2.memoizedState, a);
}, useTransition: function() {
  var a = gi(ei)[0], b = di().memoizedState;
  return [a, b];
}, useMutableSource: hi, useSyncExternalStore: ii, useId: Fi, unstable_isNewReconciler: false };
function Ki(a, b) {
  try {
    var c = "", d = b;
    do
      c += Pa$2(d), d = d.return;
    while (d);
    var e = c;
  } catch (f2) {
    e = "\nError generating stack: " + f2.message + "\n" + f2.stack;
  }
  return { value: a, source: b, stack: e, digest: null };
}
function Li(a, b, c) {
  return { value: a, source: null, stack: null != c ? c : null, digest: null != b ? b : null };
}
function Mi(a, b) {
  try {
    console.error(b.value);
  } catch (c) {
    setTimeout(function() {
      throw c;
    });
  }
}
var Ni = "function" === typeof WeakMap ? WeakMap : Map;
function Oi(a, b, c) {
  c = ch(-1, c);
  c.tag = 3;
  c.payload = { element: null };
  var d = b.value;
  c.callback = function() {
    Pi || (Pi = true, Qi = d);
    Mi(a, b);
  };
  return c;
}
function Ri(a, b, c) {
  c = ch(-1, c);
  c.tag = 3;
  var d = a.type.getDerivedStateFromError;
  if ("function" === typeof d) {
    var e = b.value;
    c.payload = function() {
      return d(e);
    };
    c.callback = function() {
      Mi(a, b);
    };
  }
  var f2 = a.stateNode;
  null !== f2 && "function" === typeof f2.componentDidCatch && (c.callback = function() {
    Mi(a, b);
    "function" !== typeof d && (null === Si ? Si = /* @__PURE__ */ new Set([this]) : Si.add(this));
    var c2 = b.stack;
    this.componentDidCatch(b.value, { componentStack: null !== c2 ? c2 : "" });
  });
  return c;
}
function Ti(a, b, c) {
  var d = a.pingCache;
  if (null === d) {
    d = a.pingCache = new Ni();
    var e = /* @__PURE__ */ new Set();
    d.set(b, e);
  } else
    e = d.get(b), void 0 === e && (e = /* @__PURE__ */ new Set(), d.set(b, e));
  e.has(c) || (e.add(c), a = Ui.bind(null, a, b, c), b.then(a, a));
}
function Vi(a) {
  do {
    var b;
    if (b = 13 === a.tag)
      b = a.memoizedState, b = null !== b ? null !== b.dehydrated ? true : false : true;
    if (b)
      return a;
    a = a.return;
  } while (null !== a);
  return null;
}
function Wi(a, b, c, d, e) {
  if (0 === (a.mode & 1))
    return a === b ? a.flags |= 65536 : (a.flags |= 128, c.flags |= 131072, c.flags &= -52805, 1 === c.tag && (null === c.alternate ? c.tag = 17 : (b = ch(-1, 1), b.tag = 2, dh(c, b, 1))), c.lanes |= 1), a;
  a.flags |= 65536;
  a.lanes = e;
  return a;
}
var Xi = ua$2.ReactCurrentOwner, Ug = false;
function Yi(a, b, c, d) {
  b.child = null === a ? Ch(b, null, c, d) : Bh(b, a.child, c, d);
}
function Zi(a, b, c, d, e) {
  c = c.render;
  var f2 = b.ref;
  Tg(b, e);
  d = Xh(a, b, c, d, f2, e);
  c = bi();
  if (null !== a && !Ug)
    return b.updateQueue = a.updateQueue, b.flags &= -2053, a.lanes &= ~e, $i(a, b, e);
  I$2 && c && vg(b);
  b.flags |= 1;
  Yi(a, b, d, e);
  return b.child;
}
function aj(a, b, c, d, e) {
  if (null === a) {
    var f2 = c.type;
    if ("function" === typeof f2 && !bj(f2) && void 0 === f2.defaultProps && null === c.compare && void 0 === c.defaultProps)
      return b.tag = 15, b.type = f2, cj(a, b, f2, d, e);
    a = yh(c.type, null, d, b, b.mode, e);
    a.ref = b.ref;
    a.return = b;
    return b.child = a;
  }
  f2 = a.child;
  if (0 === (a.lanes & e)) {
    var g = f2.memoizedProps;
    c = c.compare;
    c = null !== c ? c : Ie;
    if (c(g, d) && a.ref === b.ref)
      return $i(a, b, e);
  }
  b.flags |= 1;
  a = wh(f2, d);
  a.ref = b.ref;
  a.return = b;
  return b.child = a;
}
function cj(a, b, c, d, e) {
  if (null !== a) {
    var f2 = a.memoizedProps;
    if (Ie(f2, d) && a.ref === b.ref)
      if (Ug = false, b.pendingProps = d = f2, 0 !== (a.lanes & e))
        0 !== (a.flags & 131072) && (Ug = true);
      else
        return b.lanes = a.lanes, $i(a, b, e);
  }
  return dj(a, b, c, d, e);
}
function ej(a, b, c) {
  var d = b.pendingProps, e = d.children, f2 = null !== a ? a.memoizedState : null;
  if ("hidden" === d.mode)
    if (0 === (b.mode & 1))
      b.memoizedState = { baseLanes: 0, cachePool: null, transitions: null }, G$1(fj, gj), gj |= c;
    else {
      if (0 === (c & 1073741824))
        return a = null !== f2 ? f2.baseLanes | c : c, b.lanes = b.childLanes = 1073741824, b.memoizedState = { baseLanes: a, cachePool: null, transitions: null }, b.updateQueue = null, G$1(fj, gj), gj |= a, null;
      b.memoizedState = { baseLanes: 0, cachePool: null, transitions: null };
      d = null !== f2 ? f2.baseLanes : c;
      G$1(fj, gj);
      gj |= d;
    }
  else
    null !== f2 ? (d = f2.baseLanes | c, b.memoizedState = null) : d = c, G$1(fj, gj), gj |= d;
  Yi(a, b, e, c);
  return b.child;
}
function hj(a, b) {
  var c = b.ref;
  if (null === a && null !== c || null !== a && a.ref !== c)
    b.flags |= 512, b.flags |= 2097152;
}
function dj(a, b, c, d, e) {
  var f2 = Zf(c) ? Xf : H$2.current;
  f2 = Yf(b, f2);
  Tg(b, e);
  c = Xh(a, b, c, d, f2, e);
  d = bi();
  if (null !== a && !Ug)
    return b.updateQueue = a.updateQueue, b.flags &= -2053, a.lanes &= ~e, $i(a, b, e);
  I$2 && d && vg(b);
  b.flags |= 1;
  Yi(a, b, c, e);
  return b.child;
}
function ij(a, b, c, d, e) {
  if (Zf(c)) {
    var f2 = true;
    cg(b);
  } else
    f2 = false;
  Tg(b, e);
  if (null === b.stateNode)
    jj(a, b), ph(b, c, d), rh(b, c, d, e), d = true;
  else if (null === a) {
    var g = b.stateNode, h = b.memoizedProps;
    g.props = h;
    var k2 = g.context, l2 = c.contextType;
    "object" === typeof l2 && null !== l2 ? l2 = Vg(l2) : (l2 = Zf(c) ? Xf : H$2.current, l2 = Yf(b, l2));
    var m2 = c.getDerivedStateFromProps, q2 = "function" === typeof m2 || "function" === typeof g.getSnapshotBeforeUpdate;
    q2 || "function" !== typeof g.UNSAFE_componentWillReceiveProps && "function" !== typeof g.componentWillReceiveProps || (h !== d || k2 !== l2) && qh(b, g, d, l2);
    $g = false;
    var r2 = b.memoizedState;
    g.state = r2;
    gh(b, d, g, e);
    k2 = b.memoizedState;
    h !== d || r2 !== k2 || Wf.current || $g ? ("function" === typeof m2 && (kh(b, c, m2, d), k2 = b.memoizedState), (h = $g || oh(b, c, h, d, r2, k2, l2)) ? (q2 || "function" !== typeof g.UNSAFE_componentWillMount && "function" !== typeof g.componentWillMount || ("function" === typeof g.componentWillMount && g.componentWillMount(), "function" === typeof g.UNSAFE_componentWillMount && g.UNSAFE_componentWillMount()), "function" === typeof g.componentDidMount && (b.flags |= 4194308)) : ("function" === typeof g.componentDidMount && (b.flags |= 4194308), b.memoizedProps = d, b.memoizedState = k2), g.props = d, g.state = k2, g.context = l2, d = h) : ("function" === typeof g.componentDidMount && (b.flags |= 4194308), d = false);
  } else {
    g = b.stateNode;
    bh(a, b);
    h = b.memoizedProps;
    l2 = b.type === b.elementType ? h : Lg(b.type, h);
    g.props = l2;
    q2 = b.pendingProps;
    r2 = g.context;
    k2 = c.contextType;
    "object" === typeof k2 && null !== k2 ? k2 = Vg(k2) : (k2 = Zf(c) ? Xf : H$2.current, k2 = Yf(b, k2));
    var y2 = c.getDerivedStateFromProps;
    (m2 = "function" === typeof y2 || "function" === typeof g.getSnapshotBeforeUpdate) || "function" !== typeof g.UNSAFE_componentWillReceiveProps && "function" !== typeof g.componentWillReceiveProps || (h !== q2 || r2 !== k2) && qh(b, g, d, k2);
    $g = false;
    r2 = b.memoizedState;
    g.state = r2;
    gh(b, d, g, e);
    var n2 = b.memoizedState;
    h !== q2 || r2 !== n2 || Wf.current || $g ? ("function" === typeof y2 && (kh(b, c, y2, d), n2 = b.memoizedState), (l2 = $g || oh(b, c, l2, d, r2, n2, k2) || false) ? (m2 || "function" !== typeof g.UNSAFE_componentWillUpdate && "function" !== typeof g.componentWillUpdate || ("function" === typeof g.componentWillUpdate && g.componentWillUpdate(d, n2, k2), "function" === typeof g.UNSAFE_componentWillUpdate && g.UNSAFE_componentWillUpdate(d, n2, k2)), "function" === typeof g.componentDidUpdate && (b.flags |= 4), "function" === typeof g.getSnapshotBeforeUpdate && (b.flags |= 1024)) : ("function" !== typeof g.componentDidUpdate || h === a.memoizedProps && r2 === a.memoizedState || (b.flags |= 4), "function" !== typeof g.getSnapshotBeforeUpdate || h === a.memoizedProps && r2 === a.memoizedState || (b.flags |= 1024), b.memoizedProps = d, b.memoizedState = n2), g.props = d, g.state = n2, g.context = k2, d = l2) : ("function" !== typeof g.componentDidUpdate || h === a.memoizedProps && r2 === a.memoizedState || (b.flags |= 4), "function" !== typeof g.getSnapshotBeforeUpdate || h === a.memoizedProps && r2 === a.memoizedState || (b.flags |= 1024), d = false);
  }
  return kj(a, b, c, d, f2, e);
}
function kj(a, b, c, d, e, f2) {
  hj(a, b);
  var g = 0 !== (b.flags & 128);
  if (!d && !g)
    return e && dg(b, c, false), $i(a, b, f2);
  d = b.stateNode;
  Xi.current = b;
  var h = g && "function" !== typeof c.getDerivedStateFromError ? null : d.render();
  b.flags |= 1;
  null !== a && g ? (b.child = Bh(b, a.child, null, f2), b.child = Bh(b, null, h, f2)) : Yi(a, b, h, f2);
  b.memoizedState = d.state;
  e && dg(b, c, true);
  return b.child;
}
function lj(a) {
  var b = a.stateNode;
  b.pendingContext ? ag(a, b.pendingContext, b.pendingContext !== b.context) : b.context && ag(a, b.context, false);
  Ih(a, b.containerInfo);
}
function mj(a, b, c, d, e) {
  Ig();
  Jg(e);
  b.flags |= 256;
  Yi(a, b, c, d);
  return b.child;
}
var nj = { dehydrated: null, treeContext: null, retryLane: 0 };
function oj(a) {
  return { baseLanes: a, cachePool: null, transitions: null };
}
function pj(a, b, c) {
  var d = b.pendingProps, e = M$2.current, f2 = false, g = 0 !== (b.flags & 128), h;
  (h = g) || (h = null !== a && null === a.memoizedState ? false : 0 !== (e & 2));
  if (h)
    f2 = true, b.flags &= -129;
  else if (null === a || null !== a.memoizedState)
    e |= 1;
  G$1(M$2, e & 1);
  if (null === a) {
    Eg(b);
    a = b.memoizedState;
    if (null !== a && (a = a.dehydrated, null !== a))
      return 0 === (b.mode & 1) ? b.lanes = 1 : "$!" === a.data ? b.lanes = 8 : b.lanes = 1073741824, null;
    g = d.children;
    a = d.fallback;
    return f2 ? (d = b.mode, f2 = b.child, g = { mode: "hidden", children: g }, 0 === (d & 1) && null !== f2 ? (f2.childLanes = 0, f2.pendingProps = g) : f2 = qj(g, d, 0, null), a = Ah(a, d, c, null), f2.return = b, a.return = b, f2.sibling = a, b.child = f2, b.child.memoizedState = oj(c), b.memoizedState = nj, a) : rj(b, g);
  }
  e = a.memoizedState;
  if (null !== e && (h = e.dehydrated, null !== h))
    return sj(a, b, g, d, h, e, c);
  if (f2) {
    f2 = d.fallback;
    g = b.mode;
    e = a.child;
    h = e.sibling;
    var k2 = { mode: "hidden", children: d.children };
    0 === (g & 1) && b.child !== e ? (d = b.child, d.childLanes = 0, d.pendingProps = k2, b.deletions = null) : (d = wh(e, k2), d.subtreeFlags = e.subtreeFlags & 14680064);
    null !== h ? f2 = wh(h, f2) : (f2 = Ah(f2, g, c, null), f2.flags |= 2);
    f2.return = b;
    d.return = b;
    d.sibling = f2;
    b.child = d;
    d = f2;
    f2 = b.child;
    g = a.child.memoizedState;
    g = null === g ? oj(c) : { baseLanes: g.baseLanes | c, cachePool: null, transitions: g.transitions };
    f2.memoizedState = g;
    f2.childLanes = a.childLanes & ~c;
    b.memoizedState = nj;
    return d;
  }
  f2 = a.child;
  a = f2.sibling;
  d = wh(f2, { mode: "visible", children: d.children });
  0 === (b.mode & 1) && (d.lanes = c);
  d.return = b;
  d.sibling = null;
  null !== a && (c = b.deletions, null === c ? (b.deletions = [a], b.flags |= 16) : c.push(a));
  b.child = d;
  b.memoizedState = null;
  return d;
}
function rj(a, b) {
  b = qj({ mode: "visible", children: b }, a.mode, 0, null);
  b.return = a;
  return a.child = b;
}
function tj(a, b, c, d) {
  null !== d && Jg(d);
  Bh(b, a.child, null, c);
  a = rj(b, b.pendingProps.children);
  a.flags |= 2;
  b.memoizedState = null;
  return a;
}
function sj(a, b, c, d, e, f2, g) {
  if (c) {
    if (b.flags & 256)
      return b.flags &= -257, d = Li(Error(p$2(422))), tj(a, b, g, d);
    if (null !== b.memoizedState)
      return b.child = a.child, b.flags |= 128, null;
    f2 = d.fallback;
    e = b.mode;
    d = qj({ mode: "visible", children: d.children }, e, 0, null);
    f2 = Ah(f2, e, g, null);
    f2.flags |= 2;
    d.return = b;
    f2.return = b;
    d.sibling = f2;
    b.child = d;
    0 !== (b.mode & 1) && Bh(b, a.child, null, g);
    b.child.memoizedState = oj(g);
    b.memoizedState = nj;
    return f2;
  }
  if (0 === (b.mode & 1))
    return tj(a, b, g, null);
  if ("$!" === e.data) {
    d = e.nextSibling && e.nextSibling.dataset;
    if (d)
      var h = d.dgst;
    d = h;
    f2 = Error(p$2(419));
    d = Li(f2, d, void 0);
    return tj(a, b, g, d);
  }
  h = 0 !== (g & a.childLanes);
  if (Ug || h) {
    d = R$3;
    if (null !== d) {
      switch (g & -g) {
        case 4:
          e = 2;
          break;
        case 16:
          e = 8;
          break;
        case 64:
        case 128:
        case 256:
        case 512:
        case 1024:
        case 2048:
        case 4096:
        case 8192:
        case 16384:
        case 32768:
        case 65536:
        case 131072:
        case 262144:
        case 524288:
        case 1048576:
        case 2097152:
        case 4194304:
        case 8388608:
        case 16777216:
        case 33554432:
        case 67108864:
          e = 32;
          break;
        case 536870912:
          e = 268435456;
          break;
        default:
          e = 0;
      }
      e = 0 !== (e & (d.suspendedLanes | g)) ? 0 : e;
      0 !== e && e !== f2.retryLane && (f2.retryLane = e, Zg(a, e), mh(d, a, e, -1));
    }
    uj();
    d = Li(Error(p$2(421)));
    return tj(a, b, g, d);
  }
  if ("$?" === e.data)
    return b.flags |= 128, b.child = a.child, b = vj.bind(null, a), e._reactRetry = b, null;
  a = f2.treeContext;
  yg = Lf(e.nextSibling);
  xg = b;
  I$2 = true;
  zg = null;
  null !== a && (og[pg++] = rg, og[pg++] = sg, og[pg++] = qg, rg = a.id, sg = a.overflow, qg = b);
  b = rj(b, d.children);
  b.flags |= 4096;
  return b;
}
function wj(a, b, c) {
  a.lanes |= b;
  var d = a.alternate;
  null !== d && (d.lanes |= b);
  Sg(a.return, b, c);
}
function xj(a, b, c, d, e) {
  var f2 = a.memoizedState;
  null === f2 ? a.memoizedState = { isBackwards: b, rendering: null, renderingStartTime: 0, last: d, tail: c, tailMode: e } : (f2.isBackwards = b, f2.rendering = null, f2.renderingStartTime = 0, f2.last = d, f2.tail = c, f2.tailMode = e);
}
function yj(a, b, c) {
  var d = b.pendingProps, e = d.revealOrder, f2 = d.tail;
  Yi(a, b, d.children, c);
  d = M$2.current;
  if (0 !== (d & 2))
    d = d & 1 | 2, b.flags |= 128;
  else {
    if (null !== a && 0 !== (a.flags & 128))
      a:
        for (a = b.child; null !== a; ) {
          if (13 === a.tag)
            null !== a.memoizedState && wj(a, c, b);
          else if (19 === a.tag)
            wj(a, c, b);
          else if (null !== a.child) {
            a.child.return = a;
            a = a.child;
            continue;
          }
          if (a === b)
            break a;
          for (; null === a.sibling; ) {
            if (null === a.return || a.return === b)
              break a;
            a = a.return;
          }
          a.sibling.return = a.return;
          a = a.sibling;
        }
    d &= 1;
  }
  G$1(M$2, d);
  if (0 === (b.mode & 1))
    b.memoizedState = null;
  else
    switch (e) {
      case "forwards":
        c = b.child;
        for (e = null; null !== c; )
          a = c.alternate, null !== a && null === Mh(a) && (e = c), c = c.sibling;
        c = e;
        null === c ? (e = b.child, b.child = null) : (e = c.sibling, c.sibling = null);
        xj(b, false, e, c, f2);
        break;
      case "backwards":
        c = null;
        e = b.child;
        for (b.child = null; null !== e; ) {
          a = e.alternate;
          if (null !== a && null === Mh(a)) {
            b.child = e;
            break;
          }
          a = e.sibling;
          e.sibling = c;
          c = e;
          e = a;
        }
        xj(b, true, c, null, f2);
        break;
      case "together":
        xj(b, false, null, null, void 0);
        break;
      default:
        b.memoizedState = null;
    }
  return b.child;
}
function jj(a, b) {
  0 === (b.mode & 1) && null !== a && (a.alternate = null, b.alternate = null, b.flags |= 2);
}
function $i(a, b, c) {
  null !== a && (b.dependencies = a.dependencies);
  hh |= b.lanes;
  if (0 === (c & b.childLanes))
    return null;
  if (null !== a && b.child !== a.child)
    throw Error(p$2(153));
  if (null !== b.child) {
    a = b.child;
    c = wh(a, a.pendingProps);
    b.child = c;
    for (c.return = b; null !== a.sibling; )
      a = a.sibling, c = c.sibling = wh(a, a.pendingProps), c.return = b;
    c.sibling = null;
  }
  return b.child;
}
function zj(a, b, c) {
  switch (b.tag) {
    case 3:
      lj(b);
      Ig();
      break;
    case 5:
      Kh(b);
      break;
    case 1:
      Zf(b.type) && cg(b);
      break;
    case 4:
      Ih(b, b.stateNode.containerInfo);
      break;
    case 10:
      var d = b.type._context, e = b.memoizedProps.value;
      G$1(Mg, d._currentValue);
      d._currentValue = e;
      break;
    case 13:
      d = b.memoizedState;
      if (null !== d) {
        if (null !== d.dehydrated)
          return G$1(M$2, M$2.current & 1), b.flags |= 128, null;
        if (0 !== (c & b.child.childLanes))
          return pj(a, b, c);
        G$1(M$2, M$2.current & 1);
        a = $i(a, b, c);
        return null !== a ? a.sibling : null;
      }
      G$1(M$2, M$2.current & 1);
      break;
    case 19:
      d = 0 !== (c & b.childLanes);
      if (0 !== (a.flags & 128)) {
        if (d)
          return yj(a, b, c);
        b.flags |= 128;
      }
      e = b.memoizedState;
      null !== e && (e.rendering = null, e.tail = null, e.lastEffect = null);
      G$1(M$2, M$2.current);
      if (d)
        break;
      else
        return null;
    case 22:
    case 23:
      return b.lanes = 0, ej(a, b, c);
  }
  return $i(a, b, c);
}
var Aj, Bj, Cj, Dj;
Aj = function(a, b) {
  for (var c = b.child; null !== c; ) {
    if (5 === c.tag || 6 === c.tag)
      a.appendChild(c.stateNode);
    else if (4 !== c.tag && null !== c.child) {
      c.child.return = c;
      c = c.child;
      continue;
    }
    if (c === b)
      break;
    for (; null === c.sibling; ) {
      if (null === c.return || c.return === b)
        return;
      c = c.return;
    }
    c.sibling.return = c.return;
    c = c.sibling;
  }
};
Bj = function() {
};
Cj = function(a, b, c, d) {
  var e = a.memoizedProps;
  if (e !== d) {
    a = b.stateNode;
    Hh(Eh.current);
    var f2 = null;
    switch (c) {
      case "input":
        e = Ya$2(a, e);
        d = Ya$2(a, d);
        f2 = [];
        break;
      case "select":
        e = A$1({}, e, { value: void 0 });
        d = A$1({}, d, { value: void 0 });
        f2 = [];
        break;
      case "textarea":
        e = gb$2(a, e);
        d = gb$2(a, d);
        f2 = [];
        break;
      default:
        "function" !== typeof e.onClick && "function" === typeof d.onClick && (a.onclick = Bf);
    }
    ub$2(c, d);
    var g;
    c = null;
    for (l2 in e)
      if (!d.hasOwnProperty(l2) && e.hasOwnProperty(l2) && null != e[l2])
        if ("style" === l2) {
          var h = e[l2];
          for (g in h)
            h.hasOwnProperty(g) && (c || (c = {}), c[g] = "");
        } else
          "dangerouslySetInnerHTML" !== l2 && "children" !== l2 && "suppressContentEditableWarning" !== l2 && "suppressHydrationWarning" !== l2 && "autoFocus" !== l2 && (ea$1.hasOwnProperty(l2) ? f2 || (f2 = []) : (f2 = f2 || []).push(l2, null));
    for (l2 in d) {
      var k2 = d[l2];
      h = null != e ? e[l2] : void 0;
      if (d.hasOwnProperty(l2) && k2 !== h && (null != k2 || null != h))
        if ("style" === l2)
          if (h) {
            for (g in h)
              !h.hasOwnProperty(g) || k2 && k2.hasOwnProperty(g) || (c || (c = {}), c[g] = "");
            for (g in k2)
              k2.hasOwnProperty(g) && h[g] !== k2[g] && (c || (c = {}), c[g] = k2[g]);
          } else
            c || (f2 || (f2 = []), f2.push(
              l2,
              c
            )), c = k2;
        else
          "dangerouslySetInnerHTML" === l2 ? (k2 = k2 ? k2.__html : void 0, h = h ? h.__html : void 0, null != k2 && h !== k2 && (f2 = f2 || []).push(l2, k2)) : "children" === l2 ? "string" !== typeof k2 && "number" !== typeof k2 || (f2 = f2 || []).push(l2, "" + k2) : "suppressContentEditableWarning" !== l2 && "suppressHydrationWarning" !== l2 && (ea$1.hasOwnProperty(l2) ? (null != k2 && "onScroll" === l2 && D$1("scroll", a), f2 || h === k2 || (f2 = [])) : (f2 = f2 || []).push(l2, k2));
    }
    c && (f2 = f2 || []).push("style", c);
    var l2 = f2;
    if (b.updateQueue = l2)
      b.flags |= 4;
  }
};
Dj = function(a, b, c, d) {
  c !== d && (b.flags |= 4);
};
function Ej(a, b) {
  if (!I$2)
    switch (a.tailMode) {
      case "hidden":
        b = a.tail;
        for (var c = null; null !== b; )
          null !== b.alternate && (c = b), b = b.sibling;
        null === c ? a.tail = null : c.sibling = null;
        break;
      case "collapsed":
        c = a.tail;
        for (var d = null; null !== c; )
          null !== c.alternate && (d = c), c = c.sibling;
        null === d ? b || null === a.tail ? a.tail = null : a.tail.sibling = null : d.sibling = null;
    }
}
function S$2(a) {
  var b = null !== a.alternate && a.alternate.child === a.child, c = 0, d = 0;
  if (b)
    for (var e = a.child; null !== e; )
      c |= e.lanes | e.childLanes, d |= e.subtreeFlags & 14680064, d |= e.flags & 14680064, e.return = a, e = e.sibling;
  else
    for (e = a.child; null !== e; )
      c |= e.lanes | e.childLanes, d |= e.subtreeFlags, d |= e.flags, e.return = a, e = e.sibling;
  a.subtreeFlags |= d;
  a.childLanes = c;
  return b;
}
function Fj(a, b, c) {
  var d = b.pendingProps;
  wg(b);
  switch (b.tag) {
    case 2:
    case 16:
    case 15:
    case 0:
    case 11:
    case 7:
    case 8:
    case 12:
    case 9:
    case 14:
      return S$2(b), null;
    case 1:
      return Zf(b.type) && $f(), S$2(b), null;
    case 3:
      d = b.stateNode;
      Jh();
      E$2(Wf);
      E$2(H$2);
      Oh();
      d.pendingContext && (d.context = d.pendingContext, d.pendingContext = null);
      if (null === a || null === a.child)
        Gg(b) ? b.flags |= 4 : null === a || a.memoizedState.isDehydrated && 0 === (b.flags & 256) || (b.flags |= 1024, null !== zg && (Gj(zg), zg = null));
      Bj(a, b);
      S$2(b);
      return null;
    case 5:
      Lh(b);
      var e = Hh(Gh.current);
      c = b.type;
      if (null !== a && null != b.stateNode)
        Cj(a, b, c, d, e), a.ref !== b.ref && (b.flags |= 512, b.flags |= 2097152);
      else {
        if (!d) {
          if (null === b.stateNode)
            throw Error(p$2(166));
          S$2(b);
          return null;
        }
        a = Hh(Eh.current);
        if (Gg(b)) {
          d = b.stateNode;
          c = b.type;
          var f2 = b.memoizedProps;
          d[Of] = b;
          d[Pf] = f2;
          a = 0 !== (b.mode & 1);
          switch (c) {
            case "dialog":
              D$1("cancel", d);
              D$1("close", d);
              break;
            case "iframe":
            case "object":
            case "embed":
              D$1("load", d);
              break;
            case "video":
            case "audio":
              for (e = 0; e < lf.length; e++)
                D$1(lf[e], d);
              break;
            case "source":
              D$1("error", d);
              break;
            case "img":
            case "image":
            case "link":
              D$1(
                "error",
                d
              );
              D$1("load", d);
              break;
            case "details":
              D$1("toggle", d);
              break;
            case "input":
              Za$2(d, f2);
              D$1("invalid", d);
              break;
            case "select":
              d._wrapperState = { wasMultiple: !!f2.multiple };
              D$1("invalid", d);
              break;
            case "textarea":
              hb$2(d, f2), D$1("invalid", d);
          }
          ub$2(c, f2);
          e = null;
          for (var g in f2)
            if (f2.hasOwnProperty(g)) {
              var h = f2[g];
              "children" === g ? "string" === typeof h ? d.textContent !== h && (true !== f2.suppressHydrationWarning && Af(d.textContent, h, a), e = ["children", h]) : "number" === typeof h && d.textContent !== "" + h && (true !== f2.suppressHydrationWarning && Af(
                d.textContent,
                h,
                a
              ), e = ["children", "" + h]) : ea$1.hasOwnProperty(g) && null != h && "onScroll" === g && D$1("scroll", d);
            }
          switch (c) {
            case "input":
              Va$2(d);
              db$2(d, f2, true);
              break;
            case "textarea":
              Va$2(d);
              jb$2(d);
              break;
            case "select":
            case "option":
              break;
            default:
              "function" === typeof f2.onClick && (d.onclick = Bf);
          }
          d = e;
          b.updateQueue = d;
          null !== d && (b.flags |= 4);
        } else {
          g = 9 === e.nodeType ? e : e.ownerDocument;
          "http://www.w3.org/1999/xhtml" === a && (a = kb$2(c));
          "http://www.w3.org/1999/xhtml" === a ? "script" === c ? (a = g.createElement("div"), a.innerHTML = "<script><\/script>", a = a.removeChild(a.firstChild)) : "string" === typeof d.is ? a = g.createElement(c, { is: d.is }) : (a = g.createElement(c), "select" === c && (g = a, d.multiple ? g.multiple = true : d.size && (g.size = d.size))) : a = g.createElementNS(a, c);
          a[Of] = b;
          a[Pf] = d;
          Aj(a, b, false, false);
          b.stateNode = a;
          a: {
            g = vb$2(c, d);
            switch (c) {
              case "dialog":
                D$1("cancel", a);
                D$1("close", a);
                e = d;
                break;
              case "iframe":
              case "object":
              case "embed":
                D$1("load", a);
                e = d;
                break;
              case "video":
              case "audio":
                for (e = 0; e < lf.length; e++)
                  D$1(lf[e], a);
                e = d;
                break;
              case "source":
                D$1("error", a);
                e = d;
                break;
              case "img":
              case "image":
              case "link":
                D$1(
                  "error",
                  a
                );
                D$1("load", a);
                e = d;
                break;
              case "details":
                D$1("toggle", a);
                e = d;
                break;
              case "input":
                Za$2(a, d);
                e = Ya$2(a, d);
                D$1("invalid", a);
                break;
              case "option":
                e = d;
                break;
              case "select":
                a._wrapperState = { wasMultiple: !!d.multiple };
                e = A$1({}, d, { value: void 0 });
                D$1("invalid", a);
                break;
              case "textarea":
                hb$2(a, d);
                e = gb$2(a, d);
                D$1("invalid", a);
                break;
              default:
                e = d;
            }
            ub$2(c, e);
            h = e;
            for (f2 in h)
              if (h.hasOwnProperty(f2)) {
                var k2 = h[f2];
                "style" === f2 ? sb$2(a, k2) : "dangerouslySetInnerHTML" === f2 ? (k2 = k2 ? k2.__html : void 0, null != k2 && nb$1(a, k2)) : "children" === f2 ? "string" === typeof k2 ? ("textarea" !== c || "" !== k2) && ob$2(a, k2) : "number" === typeof k2 && ob$2(a, "" + k2) : "suppressContentEditableWarning" !== f2 && "suppressHydrationWarning" !== f2 && "autoFocus" !== f2 && (ea$1.hasOwnProperty(f2) ? null != k2 && "onScroll" === f2 && D$1("scroll", a) : null != k2 && ta$2(a, f2, k2, g));
              }
            switch (c) {
              case "input":
                Va$2(a);
                db$2(a, d, false);
                break;
              case "textarea":
                Va$2(a);
                jb$2(a);
                break;
              case "option":
                null != d.value && a.setAttribute("value", "" + Sa$2(d.value));
                break;
              case "select":
                a.multiple = !!d.multiple;
                f2 = d.value;
                null != f2 ? fb$2(a, !!d.multiple, f2, false) : null != d.defaultValue && fb$2(
                  a,
                  !!d.multiple,
                  d.defaultValue,
                  true
                );
                break;
              default:
                "function" === typeof e.onClick && (a.onclick = Bf);
            }
            switch (c) {
              case "button":
              case "input":
              case "select":
              case "textarea":
                d = !!d.autoFocus;
                break a;
              case "img":
                d = true;
                break a;
              default:
                d = false;
            }
          }
          d && (b.flags |= 4);
        }
        null !== b.ref && (b.flags |= 512, b.flags |= 2097152);
      }
      S$2(b);
      return null;
    case 6:
      if (a && null != b.stateNode)
        Dj(a, b, a.memoizedProps, d);
      else {
        if ("string" !== typeof d && null === b.stateNode)
          throw Error(p$2(166));
        c = Hh(Gh.current);
        Hh(Eh.current);
        if (Gg(b)) {
          d = b.stateNode;
          c = b.memoizedProps;
          d[Of] = b;
          if (f2 = d.nodeValue !== c) {
            if (a = xg, null !== a)
              switch (a.tag) {
                case 3:
                  Af(d.nodeValue, c, 0 !== (a.mode & 1));
                  break;
                case 5:
                  true !== a.memoizedProps.suppressHydrationWarning && Af(d.nodeValue, c, 0 !== (a.mode & 1));
              }
          }
          f2 && (b.flags |= 4);
        } else
          d = (9 === c.nodeType ? c : c.ownerDocument).createTextNode(d), d[Of] = b, b.stateNode = d;
      }
      S$2(b);
      return null;
    case 13:
      E$2(M$2);
      d = b.memoizedState;
      if (null === a || null !== a.memoizedState && null !== a.memoizedState.dehydrated) {
        if (I$2 && null !== yg && 0 !== (b.mode & 1) && 0 === (b.flags & 128))
          Hg(), Ig(), b.flags |= 98560, f2 = false;
        else if (f2 = Gg(b), null !== d && null !== d.dehydrated) {
          if (null === a) {
            if (!f2)
              throw Error(p$2(318));
            f2 = b.memoizedState;
            f2 = null !== f2 ? f2.dehydrated : null;
            if (!f2)
              throw Error(p$2(317));
            f2[Of] = b;
          } else
            Ig(), 0 === (b.flags & 128) && (b.memoizedState = null), b.flags |= 4;
          S$2(b);
          f2 = false;
        } else
          null !== zg && (Gj(zg), zg = null), f2 = true;
        if (!f2)
          return b.flags & 65536 ? b : null;
      }
      if (0 !== (b.flags & 128))
        return b.lanes = c, b;
      d = null !== d;
      d !== (null !== a && null !== a.memoizedState) && d && (b.child.flags |= 8192, 0 !== (b.mode & 1) && (null === a || 0 !== (M$2.current & 1) ? 0 === T$2 && (T$2 = 3) : uj()));
      null !== b.updateQueue && (b.flags |= 4);
      S$2(b);
      return null;
    case 4:
      return Jh(), Bj(a, b), null === a && sf(b.stateNode.containerInfo), S$2(b), null;
    case 10:
      return Rg(b.type._context), S$2(b), null;
    case 17:
      return Zf(b.type) && $f(), S$2(b), null;
    case 19:
      E$2(M$2);
      f2 = b.memoizedState;
      if (null === f2)
        return S$2(b), null;
      d = 0 !== (b.flags & 128);
      g = f2.rendering;
      if (null === g)
        if (d)
          Ej(f2, false);
        else {
          if (0 !== T$2 || null !== a && 0 !== (a.flags & 128))
            for (a = b.child; null !== a; ) {
              g = Mh(a);
              if (null !== g) {
                b.flags |= 128;
                Ej(f2, false);
                d = g.updateQueue;
                null !== d && (b.updateQueue = d, b.flags |= 4);
                b.subtreeFlags = 0;
                d = c;
                for (c = b.child; null !== c; )
                  f2 = c, a = d, f2.flags &= 14680066, g = f2.alternate, null === g ? (f2.childLanes = 0, f2.lanes = a, f2.child = null, f2.subtreeFlags = 0, f2.memoizedProps = null, f2.memoizedState = null, f2.updateQueue = null, f2.dependencies = null, f2.stateNode = null) : (f2.childLanes = g.childLanes, f2.lanes = g.lanes, f2.child = g.child, f2.subtreeFlags = 0, f2.deletions = null, f2.memoizedProps = g.memoizedProps, f2.memoizedState = g.memoizedState, f2.updateQueue = g.updateQueue, f2.type = g.type, a = g.dependencies, f2.dependencies = null === a ? null : { lanes: a.lanes, firstContext: a.firstContext }), c = c.sibling;
                G$1(M$2, M$2.current & 1 | 2);
                return b.child;
              }
              a = a.sibling;
            }
          null !== f2.tail && B$2() > Hj && (b.flags |= 128, d = true, Ej(f2, false), b.lanes = 4194304);
        }
      else {
        if (!d)
          if (a = Mh(g), null !== a) {
            if (b.flags |= 128, d = true, c = a.updateQueue, null !== c && (b.updateQueue = c, b.flags |= 4), Ej(f2, true), null === f2.tail && "hidden" === f2.tailMode && !g.alternate && !I$2)
              return S$2(b), null;
          } else
            2 * B$2() - f2.renderingStartTime > Hj && 1073741824 !== c && (b.flags |= 128, d = true, Ej(f2, false), b.lanes = 4194304);
        f2.isBackwards ? (g.sibling = b.child, b.child = g) : (c = f2.last, null !== c ? c.sibling = g : b.child = g, f2.last = g);
      }
      if (null !== f2.tail)
        return b = f2.tail, f2.rendering = b, f2.tail = b.sibling, f2.renderingStartTime = B$2(), b.sibling = null, c = M$2.current, G$1(M$2, d ? c & 1 | 2 : c & 1), b;
      S$2(b);
      return null;
    case 22:
    case 23:
      return Ij(), d = null !== b.memoizedState, null !== a && null !== a.memoizedState !== d && (b.flags |= 8192), d && 0 !== (b.mode & 1) ? 0 !== (gj & 1073741824) && (S$2(b), b.subtreeFlags & 6 && (b.flags |= 8192)) : S$2(b), null;
    case 24:
      return null;
    case 25:
      return null;
  }
  throw Error(p$2(156, b.tag));
}
function Jj(a, b) {
  wg(b);
  switch (b.tag) {
    case 1:
      return Zf(b.type) && $f(), a = b.flags, a & 65536 ? (b.flags = a & -65537 | 128, b) : null;
    case 3:
      return Jh(), E$2(Wf), E$2(H$2), Oh(), a = b.flags, 0 !== (a & 65536) && 0 === (a & 128) ? (b.flags = a & -65537 | 128, b) : null;
    case 5:
      return Lh(b), null;
    case 13:
      E$2(M$2);
      a = b.memoizedState;
      if (null !== a && null !== a.dehydrated) {
        if (null === b.alternate)
          throw Error(p$2(340));
        Ig();
      }
      a = b.flags;
      return a & 65536 ? (b.flags = a & -65537 | 128, b) : null;
    case 19:
      return E$2(M$2), null;
    case 4:
      return Jh(), null;
    case 10:
      return Rg(b.type._context), null;
    case 22:
    case 23:
      return Ij(), null;
    case 24:
      return null;
    default:
      return null;
  }
}
var Kj = false, U$2 = false, Lj = "function" === typeof WeakSet ? WeakSet : Set, V$2 = null;
function Mj(a, b) {
  var c = a.ref;
  if (null !== c)
    if ("function" === typeof c)
      try {
        c(null);
      } catch (d) {
        W$2(a, b, d);
      }
    else
      c.current = null;
}
function Nj(a, b, c) {
  try {
    c();
  } catch (d) {
    W$2(a, b, d);
  }
}
var Oj = false;
function Pj(a, b) {
  Cf = dd$1;
  a = Me();
  if (Ne(a)) {
    if ("selectionStart" in a)
      var c = { start: a.selectionStart, end: a.selectionEnd };
    else
      a: {
        c = (c = a.ownerDocument) && c.defaultView || window;
        var d = c.getSelection && c.getSelection();
        if (d && 0 !== d.rangeCount) {
          c = d.anchorNode;
          var e = d.anchorOffset, f2 = d.focusNode;
          d = d.focusOffset;
          try {
            c.nodeType, f2.nodeType;
          } catch (F2) {
            c = null;
            break a;
          }
          var g = 0, h = -1, k2 = -1, l2 = 0, m2 = 0, q2 = a, r2 = null;
          b:
            for (; ; ) {
              for (var y2; ; ) {
                q2 !== c || 0 !== e && 3 !== q2.nodeType || (h = g + e);
                q2 !== f2 || 0 !== d && 3 !== q2.nodeType || (k2 = g + d);
                3 === q2.nodeType && (g += q2.nodeValue.length);
                if (null === (y2 = q2.firstChild))
                  break;
                r2 = q2;
                q2 = y2;
              }
              for (; ; ) {
                if (q2 === a)
                  break b;
                r2 === c && ++l2 === e && (h = g);
                r2 === f2 && ++m2 === d && (k2 = g);
                if (null !== (y2 = q2.nextSibling))
                  break;
                q2 = r2;
                r2 = q2.parentNode;
              }
              q2 = y2;
            }
          c = -1 === h || -1 === k2 ? null : { start: h, end: k2 };
        } else
          c = null;
      }
    c = c || { start: 0, end: 0 };
  } else
    c = null;
  Df = { focusedElem: a, selectionRange: c };
  dd$1 = false;
  for (V$2 = b; null !== V$2; )
    if (b = V$2, a = b.child, 0 !== (b.subtreeFlags & 1028) && null !== a)
      a.return = b, V$2 = a;
    else
      for (; null !== V$2; ) {
        b = V$2;
        try {
          var n2 = b.alternate;
          if (0 !== (b.flags & 1024))
            switch (b.tag) {
              case 0:
              case 11:
              case 15:
                break;
              case 1:
                if (null !== n2) {
                  var t2 = n2.memoizedProps, J2 = n2.memoizedState, x2 = b.stateNode, w2 = x2.getSnapshotBeforeUpdate(b.elementType === b.type ? t2 : Lg(b.type, t2), J2);
                  x2.__reactInternalSnapshotBeforeUpdate = w2;
                }
                break;
              case 3:
                var u2 = b.stateNode.containerInfo;
                1 === u2.nodeType ? u2.textContent = "" : 9 === u2.nodeType && u2.documentElement && u2.removeChild(u2.documentElement);
                break;
              case 5:
              case 6:
              case 4:
              case 17:
                break;
              default:
                throw Error(p$2(163));
            }
        } catch (F2) {
          W$2(b, b.return, F2);
        }
        a = b.sibling;
        if (null !== a) {
          a.return = b.return;
          V$2 = a;
          break;
        }
        V$2 = b.return;
      }
  n2 = Oj;
  Oj = false;
  return n2;
}
function Qj(a, b, c) {
  var d = b.updateQueue;
  d = null !== d ? d.lastEffect : null;
  if (null !== d) {
    var e = d = d.next;
    do {
      if ((e.tag & a) === a) {
        var f2 = e.destroy;
        e.destroy = void 0;
        void 0 !== f2 && Nj(b, c, f2);
      }
      e = e.next;
    } while (e !== d);
  }
}
function Rj(a, b) {
  b = b.updateQueue;
  b = null !== b ? b.lastEffect : null;
  if (null !== b) {
    var c = b = b.next;
    do {
      if ((c.tag & a) === a) {
        var d = c.create;
        c.destroy = d();
      }
      c = c.next;
    } while (c !== b);
  }
}
function Sj(a) {
  var b = a.ref;
  if (null !== b) {
    var c = a.stateNode;
    switch (a.tag) {
      case 5:
        a = c;
        break;
      default:
        a = c;
    }
    "function" === typeof b ? b(a) : b.current = a;
  }
}
function Tj(a) {
  var b = a.alternate;
  null !== b && (a.alternate = null, Tj(b));
  a.child = null;
  a.deletions = null;
  a.sibling = null;
  5 === a.tag && (b = a.stateNode, null !== b && (delete b[Of], delete b[Pf], delete b[of], delete b[Qf], delete b[Rf]));
  a.stateNode = null;
  a.return = null;
  a.dependencies = null;
  a.memoizedProps = null;
  a.memoizedState = null;
  a.pendingProps = null;
  a.stateNode = null;
  a.updateQueue = null;
}
function Uj(a) {
  return 5 === a.tag || 3 === a.tag || 4 === a.tag;
}
function Vj(a) {
  a:
    for (; ; ) {
      for (; null === a.sibling; ) {
        if (null === a.return || Uj(a.return))
          return null;
        a = a.return;
      }
      a.sibling.return = a.return;
      for (a = a.sibling; 5 !== a.tag && 6 !== a.tag && 18 !== a.tag; ) {
        if (a.flags & 2)
          continue a;
        if (null === a.child || 4 === a.tag)
          continue a;
        else
          a.child.return = a, a = a.child;
      }
      if (!(a.flags & 2))
        return a.stateNode;
    }
}
function Wj(a, b, c) {
  var d = a.tag;
  if (5 === d || 6 === d)
    a = a.stateNode, b ? 8 === c.nodeType ? c.parentNode.insertBefore(a, b) : c.insertBefore(a, b) : (8 === c.nodeType ? (b = c.parentNode, b.insertBefore(a, c)) : (b = c, b.appendChild(a)), c = c._reactRootContainer, null !== c && void 0 !== c || null !== b.onclick || (b.onclick = Bf));
  else if (4 !== d && (a = a.child, null !== a))
    for (Wj(a, b, c), a = a.sibling; null !== a; )
      Wj(a, b, c), a = a.sibling;
}
function Xj(a, b, c) {
  var d = a.tag;
  if (5 === d || 6 === d)
    a = a.stateNode, b ? c.insertBefore(a, b) : c.appendChild(a);
  else if (4 !== d && (a = a.child, null !== a))
    for (Xj(a, b, c), a = a.sibling; null !== a; )
      Xj(a, b, c), a = a.sibling;
}
var X$2 = null, Yj = false;
function Zj(a, b, c) {
  for (c = c.child; null !== c; )
    ak(a, b, c), c = c.sibling;
}
function ak(a, b, c) {
  if (lc$1 && "function" === typeof lc$1.onCommitFiberUnmount)
    try {
      lc$1.onCommitFiberUnmount(kc$1, c);
    } catch (h) {
    }
  switch (c.tag) {
    case 5:
      U$2 || Mj(c, b);
    case 6:
      var d = X$2, e = Yj;
      X$2 = null;
      Zj(a, b, c);
      X$2 = d;
      Yj = e;
      null !== X$2 && (Yj ? (a = X$2, c = c.stateNode, 8 === a.nodeType ? a.parentNode.removeChild(c) : a.removeChild(c)) : X$2.removeChild(c.stateNode));
      break;
    case 18:
      null !== X$2 && (Yj ? (a = X$2, c = c.stateNode, 8 === a.nodeType ? Kf(a.parentNode, c) : 1 === a.nodeType && Kf(a, c), bd$1(a)) : Kf(X$2, c.stateNode));
      break;
    case 4:
      d = X$2;
      e = Yj;
      X$2 = c.stateNode.containerInfo;
      Yj = true;
      Zj(a, b, c);
      X$2 = d;
      Yj = e;
      break;
    case 0:
    case 11:
    case 14:
    case 15:
      if (!U$2 && (d = c.updateQueue, null !== d && (d = d.lastEffect, null !== d))) {
        e = d = d.next;
        do {
          var f2 = e, g = f2.destroy;
          f2 = f2.tag;
          void 0 !== g && (0 !== (f2 & 2) ? Nj(c, b, g) : 0 !== (f2 & 4) && Nj(c, b, g));
          e = e.next;
        } while (e !== d);
      }
      Zj(a, b, c);
      break;
    case 1:
      if (!U$2 && (Mj(c, b), d = c.stateNode, "function" === typeof d.componentWillUnmount))
        try {
          d.props = c.memoizedProps, d.state = c.memoizedState, d.componentWillUnmount();
        } catch (h) {
          W$2(c, b, h);
        }
      Zj(a, b, c);
      break;
    case 21:
      Zj(a, b, c);
      break;
    case 22:
      c.mode & 1 ? (U$2 = (d = U$2) || null !== c.memoizedState, Zj(a, b, c), U$2 = d) : Zj(a, b, c);
      break;
    default:
      Zj(a, b, c);
  }
}
function bk(a) {
  var b = a.updateQueue;
  if (null !== b) {
    a.updateQueue = null;
    var c = a.stateNode;
    null === c && (c = a.stateNode = new Lj());
    b.forEach(function(b2) {
      var d = ck.bind(null, a, b2);
      c.has(b2) || (c.add(b2), b2.then(d, d));
    });
  }
}
function dk(a, b) {
  var c = b.deletions;
  if (null !== c)
    for (var d = 0; d < c.length; d++) {
      var e = c[d];
      try {
        var f2 = a, g = b, h = g;
        a:
          for (; null !== h; ) {
            switch (h.tag) {
              case 5:
                X$2 = h.stateNode;
                Yj = false;
                break a;
              case 3:
                X$2 = h.stateNode.containerInfo;
                Yj = true;
                break a;
              case 4:
                X$2 = h.stateNode.containerInfo;
                Yj = true;
                break a;
            }
            h = h.return;
          }
        if (null === X$2)
          throw Error(p$2(160));
        ak(f2, g, e);
        X$2 = null;
        Yj = false;
        var k2 = e.alternate;
        null !== k2 && (k2.return = null);
        e.return = null;
      } catch (l2) {
        W$2(e, b, l2);
      }
    }
  if (b.subtreeFlags & 12854)
    for (b = b.child; null !== b; )
      ek(b, a), b = b.sibling;
}
function ek(a, b) {
  var c = a.alternate, d = a.flags;
  switch (a.tag) {
    case 0:
    case 11:
    case 14:
    case 15:
      dk(b, a);
      fk(a);
      if (d & 4) {
        try {
          Qj(3, a, a.return), Rj(3, a);
        } catch (t2) {
          W$2(a, a.return, t2);
        }
        try {
          Qj(5, a, a.return);
        } catch (t2) {
          W$2(a, a.return, t2);
        }
      }
      break;
    case 1:
      dk(b, a);
      fk(a);
      d & 512 && null !== c && Mj(c, c.return);
      break;
    case 5:
      dk(b, a);
      fk(a);
      d & 512 && null !== c && Mj(c, c.return);
      if (a.flags & 32) {
        var e = a.stateNode;
        try {
          ob$2(e, "");
        } catch (t2) {
          W$2(a, a.return, t2);
        }
      }
      if (d & 4 && (e = a.stateNode, null != e)) {
        var f2 = a.memoizedProps, g = null !== c ? c.memoizedProps : f2, h = a.type, k2 = a.updateQueue;
        a.updateQueue = null;
        if (null !== k2)
          try {
            "input" === h && "radio" === f2.type && null != f2.name && ab$2(e, f2);
            vb$2(h, g);
            var l2 = vb$2(h, f2);
            for (g = 0; g < k2.length; g += 2) {
              var m2 = k2[g], q2 = k2[g + 1];
              "style" === m2 ? sb$2(e, q2) : "dangerouslySetInnerHTML" === m2 ? nb$1(e, q2) : "children" === m2 ? ob$2(e, q2) : ta$2(e, m2, q2, l2);
            }
            switch (h) {
              case "input":
                bb$2(e, f2);
                break;
              case "textarea":
                ib$2(e, f2);
                break;
              case "select":
                var r2 = e._wrapperState.wasMultiple;
                e._wrapperState.wasMultiple = !!f2.multiple;
                var y2 = f2.value;
                null != y2 ? fb$2(e, !!f2.multiple, y2, false) : r2 !== !!f2.multiple && (null != f2.defaultValue ? fb$2(
                  e,
                  !!f2.multiple,
                  f2.defaultValue,
                  true
                ) : fb$2(e, !!f2.multiple, f2.multiple ? [] : "", false));
            }
            e[Pf] = f2;
          } catch (t2) {
            W$2(a, a.return, t2);
          }
      }
      break;
    case 6:
      dk(b, a);
      fk(a);
      if (d & 4) {
        if (null === a.stateNode)
          throw Error(p$2(162));
        e = a.stateNode;
        f2 = a.memoizedProps;
        try {
          e.nodeValue = f2;
        } catch (t2) {
          W$2(a, a.return, t2);
        }
      }
      break;
    case 3:
      dk(b, a);
      fk(a);
      if (d & 4 && null !== c && c.memoizedState.isDehydrated)
        try {
          bd$1(b.containerInfo);
        } catch (t2) {
          W$2(a, a.return, t2);
        }
      break;
    case 4:
      dk(b, a);
      fk(a);
      break;
    case 13:
      dk(b, a);
      fk(a);
      e = a.child;
      e.flags & 8192 && (f2 = null !== e.memoizedState, e.stateNode.isHidden = f2, !f2 || null !== e.alternate && null !== e.alternate.memoizedState || (gk = B$2()));
      d & 4 && bk(a);
      break;
    case 22:
      m2 = null !== c && null !== c.memoizedState;
      a.mode & 1 ? (U$2 = (l2 = U$2) || m2, dk(b, a), U$2 = l2) : dk(b, a);
      fk(a);
      if (d & 8192) {
        l2 = null !== a.memoizedState;
        if ((a.stateNode.isHidden = l2) && !m2 && 0 !== (a.mode & 1))
          for (V$2 = a, m2 = a.child; null !== m2; ) {
            for (q2 = V$2 = m2; null !== V$2; ) {
              r2 = V$2;
              y2 = r2.child;
              switch (r2.tag) {
                case 0:
                case 11:
                case 14:
                case 15:
                  Qj(4, r2, r2.return);
                  break;
                case 1:
                  Mj(r2, r2.return);
                  var n2 = r2.stateNode;
                  if ("function" === typeof n2.componentWillUnmount) {
                    d = r2;
                    c = r2.return;
                    try {
                      b = d, n2.props = b.memoizedProps, n2.state = b.memoizedState, n2.componentWillUnmount();
                    } catch (t2) {
                      W$2(d, c, t2);
                    }
                  }
                  break;
                case 5:
                  Mj(r2, r2.return);
                  break;
                case 22:
                  if (null !== r2.memoizedState) {
                    hk(q2);
                    continue;
                  }
              }
              null !== y2 ? (y2.return = r2, V$2 = y2) : hk(q2);
            }
            m2 = m2.sibling;
          }
        a:
          for (m2 = null, q2 = a; ; ) {
            if (5 === q2.tag) {
              if (null === m2) {
                m2 = q2;
                try {
                  e = q2.stateNode, l2 ? (f2 = e.style, "function" === typeof f2.setProperty ? f2.setProperty("display", "none", "important") : f2.display = "none") : (h = q2.stateNode, k2 = q2.memoizedProps.style, g = void 0 !== k2 && null !== k2 && k2.hasOwnProperty("display") ? k2.display : null, h.style.display = rb$2("display", g));
                } catch (t2) {
                  W$2(a, a.return, t2);
                }
              }
            } else if (6 === q2.tag) {
              if (null === m2)
                try {
                  q2.stateNode.nodeValue = l2 ? "" : q2.memoizedProps;
                } catch (t2) {
                  W$2(a, a.return, t2);
                }
            } else if ((22 !== q2.tag && 23 !== q2.tag || null === q2.memoizedState || q2 === a) && null !== q2.child) {
              q2.child.return = q2;
              q2 = q2.child;
              continue;
            }
            if (q2 === a)
              break a;
            for (; null === q2.sibling; ) {
              if (null === q2.return || q2.return === a)
                break a;
              m2 === q2 && (m2 = null);
              q2 = q2.return;
            }
            m2 === q2 && (m2 = null);
            q2.sibling.return = q2.return;
            q2 = q2.sibling;
          }
      }
      break;
    case 19:
      dk(b, a);
      fk(a);
      d & 4 && bk(a);
      break;
    case 21:
      break;
    default:
      dk(
        b,
        a
      ), fk(a);
  }
}
function fk(a) {
  var b = a.flags;
  if (b & 2) {
    try {
      a: {
        for (var c = a.return; null !== c; ) {
          if (Uj(c)) {
            var d = c;
            break a;
          }
          c = c.return;
        }
        throw Error(p$2(160));
      }
      switch (d.tag) {
        case 5:
          var e = d.stateNode;
          d.flags & 32 && (ob$2(e, ""), d.flags &= -33);
          var f2 = Vj(a);
          Xj(a, f2, e);
          break;
        case 3:
        case 4:
          var g = d.stateNode.containerInfo, h = Vj(a);
          Wj(a, h, g);
          break;
        default:
          throw Error(p$2(161));
      }
    } catch (k2) {
      W$2(a, a.return, k2);
    }
    a.flags &= -3;
  }
  b & 4096 && (a.flags &= -4097);
}
function ik(a, b, c) {
  V$2 = a;
  jk(a);
}
function jk(a, b, c) {
  for (var d = 0 !== (a.mode & 1); null !== V$2; ) {
    var e = V$2, f2 = e.child;
    if (22 === e.tag && d) {
      var g = null !== e.memoizedState || Kj;
      if (!g) {
        var h = e.alternate, k2 = null !== h && null !== h.memoizedState || U$2;
        h = Kj;
        var l2 = U$2;
        Kj = g;
        if ((U$2 = k2) && !l2)
          for (V$2 = e; null !== V$2; )
            g = V$2, k2 = g.child, 22 === g.tag && null !== g.memoizedState ? kk(e) : null !== k2 ? (k2.return = g, V$2 = k2) : kk(e);
        for (; null !== f2; )
          V$2 = f2, jk(f2), f2 = f2.sibling;
        V$2 = e;
        Kj = h;
        U$2 = l2;
      }
      lk(a);
    } else
      0 !== (e.subtreeFlags & 8772) && null !== f2 ? (f2.return = e, V$2 = f2) : lk(a);
  }
}
function lk(a) {
  for (; null !== V$2; ) {
    var b = V$2;
    if (0 !== (b.flags & 8772)) {
      var c = b.alternate;
      try {
        if (0 !== (b.flags & 8772))
          switch (b.tag) {
            case 0:
            case 11:
            case 15:
              U$2 || Rj(5, b);
              break;
            case 1:
              var d = b.stateNode;
              if (b.flags & 4 && !U$2)
                if (null === c)
                  d.componentDidMount();
                else {
                  var e = b.elementType === b.type ? c.memoizedProps : Lg(b.type, c.memoizedProps);
                  d.componentDidUpdate(e, c.memoizedState, d.__reactInternalSnapshotBeforeUpdate);
                }
              var f2 = b.updateQueue;
              null !== f2 && ih(b, f2, d);
              break;
            case 3:
              var g = b.updateQueue;
              if (null !== g) {
                c = null;
                if (null !== b.child)
                  switch (b.child.tag) {
                    case 5:
                      c = b.child.stateNode;
                      break;
                    case 1:
                      c = b.child.stateNode;
                  }
                ih(b, g, c);
              }
              break;
            case 5:
              var h = b.stateNode;
              if (null === c && b.flags & 4) {
                c = h;
                var k2 = b.memoizedProps;
                switch (b.type) {
                  case "button":
                  case "input":
                  case "select":
                  case "textarea":
                    k2.autoFocus && c.focus();
                    break;
                  case "img":
                    k2.src && (c.src = k2.src);
                }
              }
              break;
            case 6:
              break;
            case 4:
              break;
            case 12:
              break;
            case 13:
              if (null === b.memoizedState) {
                var l2 = b.alternate;
                if (null !== l2) {
                  var m2 = l2.memoizedState;
                  if (null !== m2) {
                    var q2 = m2.dehydrated;
                    null !== q2 && bd$1(q2);
                  }
                }
              }
              break;
            case 19:
            case 17:
            case 21:
            case 22:
            case 23:
            case 25:
              break;
            default:
              throw Error(p$2(163));
          }
        U$2 || b.flags & 512 && Sj(b);
      } catch (r2) {
        W$2(b, b.return, r2);
      }
    }
    if (b === a) {
      V$2 = null;
      break;
    }
    c = b.sibling;
    if (null !== c) {
      c.return = b.return;
      V$2 = c;
      break;
    }
    V$2 = b.return;
  }
}
function hk(a) {
  for (; null !== V$2; ) {
    var b = V$2;
    if (b === a) {
      V$2 = null;
      break;
    }
    var c = b.sibling;
    if (null !== c) {
      c.return = b.return;
      V$2 = c;
      break;
    }
    V$2 = b.return;
  }
}
function kk(a) {
  for (; null !== V$2; ) {
    var b = V$2;
    try {
      switch (b.tag) {
        case 0:
        case 11:
        case 15:
          var c = b.return;
          try {
            Rj(4, b);
          } catch (k2) {
            W$2(b, c, k2);
          }
          break;
        case 1:
          var d = b.stateNode;
          if ("function" === typeof d.componentDidMount) {
            var e = b.return;
            try {
              d.componentDidMount();
            } catch (k2) {
              W$2(b, e, k2);
            }
          }
          var f2 = b.return;
          try {
            Sj(b);
          } catch (k2) {
            W$2(b, f2, k2);
          }
          break;
        case 5:
          var g = b.return;
          try {
            Sj(b);
          } catch (k2) {
            W$2(b, g, k2);
          }
      }
    } catch (k2) {
      W$2(b, b.return, k2);
    }
    if (b === a) {
      V$2 = null;
      break;
    }
    var h = b.sibling;
    if (null !== h) {
      h.return = b.return;
      V$2 = h;
      break;
    }
    V$2 = b.return;
  }
}
var mk = Math.ceil, nk = ua$2.ReactCurrentDispatcher, ok = ua$2.ReactCurrentOwner, pk = ua$2.ReactCurrentBatchConfig, K$2 = 0, R$3 = null, Y$2 = null, Z$2 = 0, gj = 0, fj = Uf(0), T$2 = 0, qk = null, hh = 0, rk = 0, sk = 0, tk = null, uk = null, gk = 0, Hj = Infinity, vk = null, Pi = false, Qi = null, Si = null, wk = false, xk = null, yk = 0, zk = 0, Ak = null, Bk = -1, Ck = 0;
function L$2() {
  return 0 !== (K$2 & 6) ? B$2() : -1 !== Bk ? Bk : Bk = B$2();
}
function lh(a) {
  if (0 === (a.mode & 1))
    return 1;
  if (0 !== (K$2 & 2) && 0 !== Z$2)
    return Z$2 & -Z$2;
  if (null !== Kg.transition)
    return 0 === Ck && (Ck = yc$1()), Ck;
  a = C$1;
  if (0 !== a)
    return a;
  a = window.event;
  a = void 0 === a ? 16 : jd$1(a.type);
  return a;
}
function mh(a, b, c, d) {
  if (50 < zk)
    throw zk = 0, Ak = null, Error(p$2(185));
  Ac$1(a, c, d);
  if (0 === (K$2 & 2) || a !== R$3)
    a === R$3 && (0 === (K$2 & 2) && (rk |= c), 4 === T$2 && Dk(a, Z$2)), Ek(a, d), 1 === c && 0 === K$2 && 0 === (b.mode & 1) && (Hj = B$2() + 500, fg && jg());
}
function Ek(a, b) {
  var c = a.callbackNode;
  wc$1(a, b);
  var d = uc$1(a, a === R$3 ? Z$2 : 0);
  if (0 === d)
    null !== c && bc$1(c), a.callbackNode = null, a.callbackPriority = 0;
  else if (b = d & -d, a.callbackPriority !== b) {
    null != c && bc$1(c);
    if (1 === b)
      0 === a.tag ? ig(Fk.bind(null, a)) : hg(Fk.bind(null, a)), Jf(function() {
        0 === (K$2 & 6) && jg();
      }), c = null;
    else {
      switch (Dc$1(d)) {
        case 1:
          c = fc$1;
          break;
        case 4:
          c = gc$1;
          break;
        case 16:
          c = hc$1;
          break;
        case 536870912:
          c = jc$1;
          break;
        default:
          c = hc$1;
      }
      c = Gk(c, Hk.bind(null, a));
    }
    a.callbackPriority = b;
    a.callbackNode = c;
  }
}
function Hk(a, b) {
  Bk = -1;
  Ck = 0;
  if (0 !== (K$2 & 6))
    throw Error(p$2(327));
  var c = a.callbackNode;
  if (Ik() && a.callbackNode !== c)
    return null;
  var d = uc$1(a, a === R$3 ? Z$2 : 0);
  if (0 === d)
    return null;
  if (0 !== (d & 30) || 0 !== (d & a.expiredLanes) || b)
    b = Jk(a, d);
  else {
    b = d;
    var e = K$2;
    K$2 |= 2;
    var f2 = Kk();
    if (R$3 !== a || Z$2 !== b)
      vk = null, Hj = B$2() + 500, Lk(a, b);
    do
      try {
        Mk();
        break;
      } catch (h) {
        Nk(a, h);
      }
    while (1);
    Qg();
    nk.current = f2;
    K$2 = e;
    null !== Y$2 ? b = 0 : (R$3 = null, Z$2 = 0, b = T$2);
  }
  if (0 !== b) {
    2 === b && (e = xc$1(a), 0 !== e && (d = e, b = Ok(a, e)));
    if (1 === b)
      throw c = qk, Lk(a, 0), Dk(a, d), Ek(a, B$2()), c;
    if (6 === b)
      Dk(a, d);
    else {
      e = a.current.alternate;
      if (0 === (d & 30) && !Pk(e) && (b = Jk(a, d), 2 === b && (f2 = xc$1(a), 0 !== f2 && (d = f2, b = Ok(a, f2))), 1 === b))
        throw c = qk, Lk(a, 0), Dk(a, d), Ek(a, B$2()), c;
      a.finishedWork = e;
      a.finishedLanes = d;
      switch (b) {
        case 0:
        case 1:
          throw Error(p$2(345));
        case 2:
          Qk(a, uk, vk);
          break;
        case 3:
          Dk(a, d);
          if ((d & 130023424) === d && (b = gk + 500 - B$2(), 10 < b)) {
            if (0 !== uc$1(a, 0))
              break;
            e = a.suspendedLanes;
            if ((e & d) !== d) {
              L$2();
              a.pingedLanes |= a.suspendedLanes & e;
              break;
            }
            a.timeoutHandle = Ff(Qk.bind(null, a, uk, vk), b);
            break;
          }
          Qk(a, uk, vk);
          break;
        case 4:
          Dk(a, d);
          if ((d & 4194240) === d)
            break;
          b = a.eventTimes;
          for (e = -1; 0 < d; ) {
            var g = 31 - oc$1(d);
            f2 = 1 << g;
            g = b[g];
            g > e && (e = g);
            d &= ~f2;
          }
          d = e;
          d = B$2() - d;
          d = (120 > d ? 120 : 480 > d ? 480 : 1080 > d ? 1080 : 1920 > d ? 1920 : 3e3 > d ? 3e3 : 4320 > d ? 4320 : 1960 * mk(d / 1960)) - d;
          if (10 < d) {
            a.timeoutHandle = Ff(Qk.bind(null, a, uk, vk), d);
            break;
          }
          Qk(a, uk, vk);
          break;
        case 5:
          Qk(a, uk, vk);
          break;
        default:
          throw Error(p$2(329));
      }
    }
  }
  Ek(a, B$2());
  return a.callbackNode === c ? Hk.bind(null, a) : null;
}
function Ok(a, b) {
  var c = tk;
  a.current.memoizedState.isDehydrated && (Lk(a, b).flags |= 256);
  a = Jk(a, b);
  2 !== a && (b = uk, uk = c, null !== b && Gj(b));
  return a;
}
function Gj(a) {
  null === uk ? uk = a : uk.push.apply(uk, a);
}
function Pk(a) {
  for (var b = a; ; ) {
    if (b.flags & 16384) {
      var c = b.updateQueue;
      if (null !== c && (c = c.stores, null !== c))
        for (var d = 0; d < c.length; d++) {
          var e = c[d], f2 = e.getSnapshot;
          e = e.value;
          try {
            if (!He(f2(), e))
              return false;
          } catch (g) {
            return false;
          }
        }
    }
    c = b.child;
    if (b.subtreeFlags & 16384 && null !== c)
      c.return = b, b = c;
    else {
      if (b === a)
        break;
      for (; null === b.sibling; ) {
        if (null === b.return || b.return === a)
          return true;
        b = b.return;
      }
      b.sibling.return = b.return;
      b = b.sibling;
    }
  }
  return true;
}
function Dk(a, b) {
  b &= ~sk;
  b &= ~rk;
  a.suspendedLanes |= b;
  a.pingedLanes &= ~b;
  for (a = a.expirationTimes; 0 < b; ) {
    var c = 31 - oc$1(b), d = 1 << c;
    a[c] = -1;
    b &= ~d;
  }
}
function Fk(a) {
  if (0 !== (K$2 & 6))
    throw Error(p$2(327));
  Ik();
  var b = uc$1(a, 0);
  if (0 === (b & 1))
    return Ek(a, B$2()), null;
  var c = Jk(a, b);
  if (0 !== a.tag && 2 === c) {
    var d = xc$1(a);
    0 !== d && (b = d, c = Ok(a, d));
  }
  if (1 === c)
    throw c = qk, Lk(a, 0), Dk(a, b), Ek(a, B$2()), c;
  if (6 === c)
    throw Error(p$2(345));
  a.finishedWork = a.current.alternate;
  a.finishedLanes = b;
  Qk(a, uk, vk);
  Ek(a, B$2());
  return null;
}
function Rk(a, b) {
  var c = K$2;
  K$2 |= 1;
  try {
    return a(b);
  } finally {
    K$2 = c, 0 === K$2 && (Hj = B$2() + 500, fg && jg());
  }
}
function Sk(a) {
  null !== xk && 0 === xk.tag && 0 === (K$2 & 6) && Ik();
  var b = K$2;
  K$2 |= 1;
  var c = pk.transition, d = C$1;
  try {
    if (pk.transition = null, C$1 = 1, a)
      return a();
  } finally {
    C$1 = d, pk.transition = c, K$2 = b, 0 === (K$2 & 6) && jg();
  }
}
function Ij() {
  gj = fj.current;
  E$2(fj);
}
function Lk(a, b) {
  a.finishedWork = null;
  a.finishedLanes = 0;
  var c = a.timeoutHandle;
  -1 !== c && (a.timeoutHandle = -1, Gf(c));
  if (null !== Y$2)
    for (c = Y$2.return; null !== c; ) {
      var d = c;
      wg(d);
      switch (d.tag) {
        case 1:
          d = d.type.childContextTypes;
          null !== d && void 0 !== d && $f();
          break;
        case 3:
          Jh();
          E$2(Wf);
          E$2(H$2);
          Oh();
          break;
        case 5:
          Lh(d);
          break;
        case 4:
          Jh();
          break;
        case 13:
          E$2(M$2);
          break;
        case 19:
          E$2(M$2);
          break;
        case 10:
          Rg(d.type._context);
          break;
        case 22:
        case 23:
          Ij();
      }
      c = c.return;
    }
  R$3 = a;
  Y$2 = a = wh(a.current, null);
  Z$2 = gj = b;
  T$2 = 0;
  qk = null;
  sk = rk = hh = 0;
  uk = tk = null;
  if (null !== Wg) {
    for (b = 0; b < Wg.length; b++)
      if (c = Wg[b], d = c.interleaved, null !== d) {
        c.interleaved = null;
        var e = d.next, f2 = c.pending;
        if (null !== f2) {
          var g = f2.next;
          f2.next = e;
          d.next = g;
        }
        c.pending = d;
      }
    Wg = null;
  }
  return a;
}
function Nk(a, b) {
  do {
    var c = Y$2;
    try {
      Qg();
      Ph.current = ai;
      if (Sh) {
        for (var d = N$2.memoizedState; null !== d; ) {
          var e = d.queue;
          null !== e && (e.pending = null);
          d = d.next;
        }
        Sh = false;
      }
      Rh = 0;
      P$2 = O$2 = N$2 = null;
      Th = false;
      Uh = 0;
      ok.current = null;
      if (null === c || null === c.return) {
        T$2 = 1;
        qk = b;
        Y$2 = null;
        break;
      }
      a: {
        var f2 = a, g = c.return, h = c, k2 = b;
        b = Z$2;
        h.flags |= 32768;
        if (null !== k2 && "object" === typeof k2 && "function" === typeof k2.then) {
          var l2 = k2, m2 = h, q2 = m2.tag;
          if (0 === (m2.mode & 1) && (0 === q2 || 11 === q2 || 15 === q2)) {
            var r2 = m2.alternate;
            r2 ? (m2.updateQueue = r2.updateQueue, m2.memoizedState = r2.memoizedState, m2.lanes = r2.lanes) : (m2.updateQueue = null, m2.memoizedState = null);
          }
          var y2 = Vi(g);
          if (null !== y2) {
            y2.flags &= -257;
            Wi(y2, g, h, f2, b);
            y2.mode & 1 && Ti(f2, l2, b);
            b = y2;
            k2 = l2;
            var n2 = b.updateQueue;
            if (null === n2) {
              var t2 = /* @__PURE__ */ new Set();
              t2.add(k2);
              b.updateQueue = t2;
            } else
              n2.add(k2);
            break a;
          } else {
            if (0 === (b & 1)) {
              Ti(f2, l2, b);
              uj();
              break a;
            }
            k2 = Error(p$2(426));
          }
        } else if (I$2 && h.mode & 1) {
          var J2 = Vi(g);
          if (null !== J2) {
            0 === (J2.flags & 65536) && (J2.flags |= 256);
            Wi(J2, g, h, f2, b);
            Jg(Ki(k2, h));
            break a;
          }
        }
        f2 = k2 = Ki(k2, h);
        4 !== T$2 && (T$2 = 2);
        null === tk ? tk = [f2] : tk.push(f2);
        f2 = g;
        do {
          switch (f2.tag) {
            case 3:
              f2.flags |= 65536;
              b &= -b;
              f2.lanes |= b;
              var x2 = Oi(f2, k2, b);
              fh(f2, x2);
              break a;
            case 1:
              h = k2;
              var w2 = f2.type, u2 = f2.stateNode;
              if (0 === (f2.flags & 128) && ("function" === typeof w2.getDerivedStateFromError || null !== u2 && "function" === typeof u2.componentDidCatch && (null === Si || !Si.has(u2)))) {
                f2.flags |= 65536;
                b &= -b;
                f2.lanes |= b;
                var F2 = Ri(f2, h, b);
                fh(f2, F2);
                break a;
              }
          }
          f2 = f2.return;
        } while (null !== f2);
      }
      Tk(c);
    } catch (na2) {
      b = na2;
      Y$2 === c && null !== c && (Y$2 = c = c.return);
      continue;
    }
    break;
  } while (1);
}
function Kk() {
  var a = nk.current;
  nk.current = ai;
  return null === a ? ai : a;
}
function uj() {
  if (0 === T$2 || 3 === T$2 || 2 === T$2)
    T$2 = 4;
  null === R$3 || 0 === (hh & 268435455) && 0 === (rk & 268435455) || Dk(R$3, Z$2);
}
function Jk(a, b) {
  var c = K$2;
  K$2 |= 2;
  var d = Kk();
  if (R$3 !== a || Z$2 !== b)
    vk = null, Lk(a, b);
  do
    try {
      Uk();
      break;
    } catch (e) {
      Nk(a, e);
    }
  while (1);
  Qg();
  K$2 = c;
  nk.current = d;
  if (null !== Y$2)
    throw Error(p$2(261));
  R$3 = null;
  Z$2 = 0;
  return T$2;
}
function Uk() {
  for (; null !== Y$2; )
    Vk(Y$2);
}
function Mk() {
  for (; null !== Y$2 && !cc$1(); )
    Vk(Y$2);
}
function Vk(a) {
  var b = Wk(a.alternate, a, gj);
  a.memoizedProps = a.pendingProps;
  null === b ? Tk(a) : Y$2 = b;
  ok.current = null;
}
function Tk(a) {
  var b = a;
  do {
    var c = b.alternate;
    a = b.return;
    if (0 === (b.flags & 32768)) {
      if (c = Fj(c, b, gj), null !== c) {
        Y$2 = c;
        return;
      }
    } else {
      c = Jj(c, b);
      if (null !== c) {
        c.flags &= 32767;
        Y$2 = c;
        return;
      }
      if (null !== a)
        a.flags |= 32768, a.subtreeFlags = 0, a.deletions = null;
      else {
        T$2 = 6;
        Y$2 = null;
        return;
      }
    }
    b = b.sibling;
    if (null !== b) {
      Y$2 = b;
      return;
    }
    Y$2 = b = a;
  } while (null !== b);
  0 === T$2 && (T$2 = 5);
}
function Qk(a, b, c) {
  var d = C$1, e = pk.transition;
  try {
    pk.transition = null, C$1 = 1, Xk(a, b, c, d);
  } finally {
    pk.transition = e, C$1 = d;
  }
  return null;
}
function Xk(a, b, c, d) {
  do
    Ik();
  while (null !== xk);
  if (0 !== (K$2 & 6))
    throw Error(p$2(327));
  c = a.finishedWork;
  var e = a.finishedLanes;
  if (null === c)
    return null;
  a.finishedWork = null;
  a.finishedLanes = 0;
  if (c === a.current)
    throw Error(p$2(177));
  a.callbackNode = null;
  a.callbackPriority = 0;
  var f2 = c.lanes | c.childLanes;
  Bc$1(a, f2);
  a === R$3 && (Y$2 = R$3 = null, Z$2 = 0);
  0 === (c.subtreeFlags & 2064) && 0 === (c.flags & 2064) || wk || (wk = true, Gk(hc$1, function() {
    Ik();
    return null;
  }));
  f2 = 0 !== (c.flags & 15990);
  if (0 !== (c.subtreeFlags & 15990) || f2) {
    f2 = pk.transition;
    pk.transition = null;
    var g = C$1;
    C$1 = 1;
    var h = K$2;
    K$2 |= 4;
    ok.current = null;
    Pj(a, c);
    ek(c, a);
    Oe(Df);
    dd$1 = !!Cf;
    Df = Cf = null;
    a.current = c;
    ik(c);
    dc$1();
    K$2 = h;
    C$1 = g;
    pk.transition = f2;
  } else
    a.current = c;
  wk && (wk = false, xk = a, yk = e);
  f2 = a.pendingLanes;
  0 === f2 && (Si = null);
  mc$1(c.stateNode);
  Ek(a, B$2());
  if (null !== b)
    for (d = a.onRecoverableError, c = 0; c < b.length; c++)
      e = b[c], d(e.value, { componentStack: e.stack, digest: e.digest });
  if (Pi)
    throw Pi = false, a = Qi, Qi = null, a;
  0 !== (yk & 1) && 0 !== a.tag && Ik();
  f2 = a.pendingLanes;
  0 !== (f2 & 1) ? a === Ak ? zk++ : (zk = 0, Ak = a) : zk = 0;
  jg();
  return null;
}
function Ik() {
  if (null !== xk) {
    var a = Dc$1(yk), b = pk.transition, c = C$1;
    try {
      pk.transition = null;
      C$1 = 16 > a ? 16 : a;
      if (null === xk)
        var d = false;
      else {
        a = xk;
        xk = null;
        yk = 0;
        if (0 !== (K$2 & 6))
          throw Error(p$2(331));
        var e = K$2;
        K$2 |= 4;
        for (V$2 = a.current; null !== V$2; ) {
          var f2 = V$2, g = f2.child;
          if (0 !== (V$2.flags & 16)) {
            var h = f2.deletions;
            if (null !== h) {
              for (var k2 = 0; k2 < h.length; k2++) {
                var l2 = h[k2];
                for (V$2 = l2; null !== V$2; ) {
                  var m2 = V$2;
                  switch (m2.tag) {
                    case 0:
                    case 11:
                    case 15:
                      Qj(8, m2, f2);
                  }
                  var q2 = m2.child;
                  if (null !== q2)
                    q2.return = m2, V$2 = q2;
                  else
                    for (; null !== V$2; ) {
                      m2 = V$2;
                      var r2 = m2.sibling, y2 = m2.return;
                      Tj(m2);
                      if (m2 === l2) {
                        V$2 = null;
                        break;
                      }
                      if (null !== r2) {
                        r2.return = y2;
                        V$2 = r2;
                        break;
                      }
                      V$2 = y2;
                    }
                }
              }
              var n2 = f2.alternate;
              if (null !== n2) {
                var t2 = n2.child;
                if (null !== t2) {
                  n2.child = null;
                  do {
                    var J2 = t2.sibling;
                    t2.sibling = null;
                    t2 = J2;
                  } while (null !== t2);
                }
              }
              V$2 = f2;
            }
          }
          if (0 !== (f2.subtreeFlags & 2064) && null !== g)
            g.return = f2, V$2 = g;
          else
            b:
              for (; null !== V$2; ) {
                f2 = V$2;
                if (0 !== (f2.flags & 2048))
                  switch (f2.tag) {
                    case 0:
                    case 11:
                    case 15:
                      Qj(9, f2, f2.return);
                  }
                var x2 = f2.sibling;
                if (null !== x2) {
                  x2.return = f2.return;
                  V$2 = x2;
                  break b;
                }
                V$2 = f2.return;
              }
        }
        var w2 = a.current;
        for (V$2 = w2; null !== V$2; ) {
          g = V$2;
          var u2 = g.child;
          if (0 !== (g.subtreeFlags & 2064) && null !== u2)
            u2.return = g, V$2 = u2;
          else
            b:
              for (g = w2; null !== V$2; ) {
                h = V$2;
                if (0 !== (h.flags & 2048))
                  try {
                    switch (h.tag) {
                      case 0:
                      case 11:
                      case 15:
                        Rj(9, h);
                    }
                  } catch (na2) {
                    W$2(h, h.return, na2);
                  }
                if (h === g) {
                  V$2 = null;
                  break b;
                }
                var F2 = h.sibling;
                if (null !== F2) {
                  F2.return = h.return;
                  V$2 = F2;
                  break b;
                }
                V$2 = h.return;
              }
        }
        K$2 = e;
        jg();
        if (lc$1 && "function" === typeof lc$1.onPostCommitFiberRoot)
          try {
            lc$1.onPostCommitFiberRoot(kc$1, a);
          } catch (na2) {
          }
        d = true;
      }
      return d;
    } finally {
      C$1 = c, pk.transition = b;
    }
  }
  return false;
}
function Yk(a, b, c) {
  b = Ki(c, b);
  b = Oi(a, b, 1);
  a = dh(a, b, 1);
  b = L$2();
  null !== a && (Ac$1(a, 1, b), Ek(a, b));
}
function W$2(a, b, c) {
  if (3 === a.tag)
    Yk(a, a, c);
  else
    for (; null !== b; ) {
      if (3 === b.tag) {
        Yk(b, a, c);
        break;
      } else if (1 === b.tag) {
        var d = b.stateNode;
        if ("function" === typeof b.type.getDerivedStateFromError || "function" === typeof d.componentDidCatch && (null === Si || !Si.has(d))) {
          a = Ki(c, a);
          a = Ri(b, a, 1);
          b = dh(b, a, 1);
          a = L$2();
          null !== b && (Ac$1(b, 1, a), Ek(b, a));
          break;
        }
      }
      b = b.return;
    }
}
function Ui(a, b, c) {
  var d = a.pingCache;
  null !== d && d.delete(b);
  b = L$2();
  a.pingedLanes |= a.suspendedLanes & c;
  R$3 === a && (Z$2 & c) === c && (4 === T$2 || 3 === T$2 && (Z$2 & 130023424) === Z$2 && 500 > B$2() - gk ? Lk(a, 0) : sk |= c);
  Ek(a, b);
}
function Zk(a, b) {
  0 === b && (0 === (a.mode & 1) ? b = 1 : (b = sc$1, sc$1 <<= 1, 0 === (sc$1 & 130023424) && (sc$1 = 4194304)));
  var c = L$2();
  a = Zg(a, b);
  null !== a && (Ac$1(a, b, c), Ek(a, c));
}
function vj(a) {
  var b = a.memoizedState, c = 0;
  null !== b && (c = b.retryLane);
  Zk(a, c);
}
function ck(a, b) {
  var c = 0;
  switch (a.tag) {
    case 13:
      var d = a.stateNode;
      var e = a.memoizedState;
      null !== e && (c = e.retryLane);
      break;
    case 19:
      d = a.stateNode;
      break;
    default:
      throw Error(p$2(314));
  }
  null !== d && d.delete(b);
  Zk(a, c);
}
var Wk;
Wk = function(a, b, c) {
  if (null !== a)
    if (a.memoizedProps !== b.pendingProps || Wf.current)
      Ug = true;
    else {
      if (0 === (a.lanes & c) && 0 === (b.flags & 128))
        return Ug = false, zj(a, b, c);
      Ug = 0 !== (a.flags & 131072) ? true : false;
    }
  else
    Ug = false, I$2 && 0 !== (b.flags & 1048576) && ug(b, ng, b.index);
  b.lanes = 0;
  switch (b.tag) {
    case 2:
      var d = b.type;
      jj(a, b);
      a = b.pendingProps;
      var e = Yf(b, H$2.current);
      Tg(b, c);
      e = Xh(null, b, d, a, e, c);
      var f2 = bi();
      b.flags |= 1;
      "object" === typeof e && null !== e && "function" === typeof e.render && void 0 === e.$$typeof ? (b.tag = 1, b.memoizedState = null, b.updateQueue = null, Zf(d) ? (f2 = true, cg(b)) : f2 = false, b.memoizedState = null !== e.state && void 0 !== e.state ? e.state : null, ah(b), e.updater = nh, b.stateNode = e, e._reactInternals = b, rh(b, d, a, c), b = kj(null, b, d, true, f2, c)) : (b.tag = 0, I$2 && f2 && vg(b), Yi(null, b, e, c), b = b.child);
      return b;
    case 16:
      d = b.elementType;
      a: {
        jj(a, b);
        a = b.pendingProps;
        e = d._init;
        d = e(d._payload);
        b.type = d;
        e = b.tag = $k(d);
        a = Lg(d, a);
        switch (e) {
          case 0:
            b = dj(null, b, d, a, c);
            break a;
          case 1:
            b = ij(null, b, d, a, c);
            break a;
          case 11:
            b = Zi(null, b, d, a, c);
            break a;
          case 14:
            b = aj(null, b, d, Lg(d.type, a), c);
            break a;
        }
        throw Error(p$2(
          306,
          d,
          ""
        ));
      }
      return b;
    case 0:
      return d = b.type, e = b.pendingProps, e = b.elementType === d ? e : Lg(d, e), dj(a, b, d, e, c);
    case 1:
      return d = b.type, e = b.pendingProps, e = b.elementType === d ? e : Lg(d, e), ij(a, b, d, e, c);
    case 3:
      a: {
        lj(b);
        if (null === a)
          throw Error(p$2(387));
        d = b.pendingProps;
        f2 = b.memoizedState;
        e = f2.element;
        bh(a, b);
        gh(b, d, null, c);
        var g = b.memoizedState;
        d = g.element;
        if (f2.isDehydrated)
          if (f2 = { element: d, isDehydrated: false, cache: g.cache, pendingSuspenseBoundaries: g.pendingSuspenseBoundaries, transitions: g.transitions }, b.updateQueue.baseState = f2, b.memoizedState = f2, b.flags & 256) {
            e = Ki(Error(p$2(423)), b);
            b = mj(a, b, d, c, e);
            break a;
          } else if (d !== e) {
            e = Ki(Error(p$2(424)), b);
            b = mj(a, b, d, c, e);
            break a;
          } else
            for (yg = Lf(b.stateNode.containerInfo.firstChild), xg = b, I$2 = true, zg = null, c = Ch(b, null, d, c), b.child = c; c; )
              c.flags = c.flags & -3 | 4096, c = c.sibling;
        else {
          Ig();
          if (d === e) {
            b = $i(a, b, c);
            break a;
          }
          Yi(a, b, d, c);
        }
        b = b.child;
      }
      return b;
    case 5:
      return Kh(b), null === a && Eg(b), d = b.type, e = b.pendingProps, f2 = null !== a ? a.memoizedProps : null, g = e.children, Ef(d, e) ? g = null : null !== f2 && Ef(d, f2) && (b.flags |= 32), hj(a, b), Yi(a, b, g, c), b.child;
    case 6:
      return null === a && Eg(b), null;
    case 13:
      return pj(a, b, c);
    case 4:
      return Ih(b, b.stateNode.containerInfo), d = b.pendingProps, null === a ? b.child = Bh(b, null, d, c) : Yi(a, b, d, c), b.child;
    case 11:
      return d = b.type, e = b.pendingProps, e = b.elementType === d ? e : Lg(d, e), Zi(a, b, d, e, c);
    case 7:
      return Yi(a, b, b.pendingProps, c), b.child;
    case 8:
      return Yi(a, b, b.pendingProps.children, c), b.child;
    case 12:
      return Yi(a, b, b.pendingProps.children, c), b.child;
    case 10:
      a: {
        d = b.type._context;
        e = b.pendingProps;
        f2 = b.memoizedProps;
        g = e.value;
        G$1(Mg, d._currentValue);
        d._currentValue = g;
        if (null !== f2)
          if (He(f2.value, g)) {
            if (f2.children === e.children && !Wf.current) {
              b = $i(a, b, c);
              break a;
            }
          } else
            for (f2 = b.child, null !== f2 && (f2.return = b); null !== f2; ) {
              var h = f2.dependencies;
              if (null !== h) {
                g = f2.child;
                for (var k2 = h.firstContext; null !== k2; ) {
                  if (k2.context === d) {
                    if (1 === f2.tag) {
                      k2 = ch(-1, c & -c);
                      k2.tag = 2;
                      var l2 = f2.updateQueue;
                      if (null !== l2) {
                        l2 = l2.shared;
                        var m2 = l2.pending;
                        null === m2 ? k2.next = k2 : (k2.next = m2.next, m2.next = k2);
                        l2.pending = k2;
                      }
                    }
                    f2.lanes |= c;
                    k2 = f2.alternate;
                    null !== k2 && (k2.lanes |= c);
                    Sg(
                      f2.return,
                      c,
                      b
                    );
                    h.lanes |= c;
                    break;
                  }
                  k2 = k2.next;
                }
              } else if (10 === f2.tag)
                g = f2.type === b.type ? null : f2.child;
              else if (18 === f2.tag) {
                g = f2.return;
                if (null === g)
                  throw Error(p$2(341));
                g.lanes |= c;
                h = g.alternate;
                null !== h && (h.lanes |= c);
                Sg(g, c, b);
                g = f2.sibling;
              } else
                g = f2.child;
              if (null !== g)
                g.return = f2;
              else
                for (g = f2; null !== g; ) {
                  if (g === b) {
                    g = null;
                    break;
                  }
                  f2 = g.sibling;
                  if (null !== f2) {
                    f2.return = g.return;
                    g = f2;
                    break;
                  }
                  g = g.return;
                }
              f2 = g;
            }
        Yi(a, b, e.children, c);
        b = b.child;
      }
      return b;
    case 9:
      return e = b.type, d = b.pendingProps.children, Tg(b, c), e = Vg(e), d = d(e), b.flags |= 1, Yi(a, b, d, c), b.child;
    case 14:
      return d = b.type, e = Lg(d, b.pendingProps), e = Lg(d.type, e), aj(a, b, d, e, c);
    case 15:
      return cj(a, b, b.type, b.pendingProps, c);
    case 17:
      return d = b.type, e = b.pendingProps, e = b.elementType === d ? e : Lg(d, e), jj(a, b), b.tag = 1, Zf(d) ? (a = true, cg(b)) : a = false, Tg(b, c), ph(b, d, e), rh(b, d, e, c), kj(null, b, d, true, a, c);
    case 19:
      return yj(a, b, c);
    case 22:
      return ej(a, b, c);
  }
  throw Error(p$2(156, b.tag));
};
function Gk(a, b) {
  return ac$1(a, b);
}
function al(a, b, c, d) {
  this.tag = a;
  this.key = c;
  this.sibling = this.child = this.return = this.stateNode = this.type = this.elementType = null;
  this.index = 0;
  this.ref = null;
  this.pendingProps = b;
  this.dependencies = this.memoizedState = this.updateQueue = this.memoizedProps = null;
  this.mode = d;
  this.subtreeFlags = this.flags = 0;
  this.deletions = null;
  this.childLanes = this.lanes = 0;
  this.alternate = null;
}
function Bg(a, b, c, d) {
  return new al(a, b, c, d);
}
function bj(a) {
  a = a.prototype;
  return !(!a || !a.isReactComponent);
}
function $k(a) {
  if ("function" === typeof a)
    return bj(a) ? 1 : 0;
  if (void 0 !== a && null !== a) {
    a = a.$$typeof;
    if (a === Da$2)
      return 11;
    if (a === Ga$2)
      return 14;
  }
  return 2;
}
function wh(a, b) {
  var c = a.alternate;
  null === c ? (c = Bg(a.tag, b, a.key, a.mode), c.elementType = a.elementType, c.type = a.type, c.stateNode = a.stateNode, c.alternate = a, a.alternate = c) : (c.pendingProps = b, c.type = a.type, c.flags = 0, c.subtreeFlags = 0, c.deletions = null);
  c.flags = a.flags & 14680064;
  c.childLanes = a.childLanes;
  c.lanes = a.lanes;
  c.child = a.child;
  c.memoizedProps = a.memoizedProps;
  c.memoizedState = a.memoizedState;
  c.updateQueue = a.updateQueue;
  b = a.dependencies;
  c.dependencies = null === b ? null : { lanes: b.lanes, firstContext: b.firstContext };
  c.sibling = a.sibling;
  c.index = a.index;
  c.ref = a.ref;
  return c;
}
function yh(a, b, c, d, e, f2) {
  var g = 2;
  d = a;
  if ("function" === typeof a)
    bj(a) && (g = 1);
  else if ("string" === typeof a)
    g = 5;
  else
    a:
      switch (a) {
        case ya$2:
          return Ah(c.children, e, f2, b);
        case za$2:
          g = 8;
          e |= 8;
          break;
        case Aa$2:
          return a = Bg(12, c, b, e | 2), a.elementType = Aa$2, a.lanes = f2, a;
        case Ea$2:
          return a = Bg(13, c, b, e), a.elementType = Ea$2, a.lanes = f2, a;
        case Fa$2:
          return a = Bg(19, c, b, e), a.elementType = Fa$2, a.lanes = f2, a;
        case Ia$2:
          return qj(c, e, f2, b);
        default:
          if ("object" === typeof a && null !== a)
            switch (a.$$typeof) {
              case Ba$2:
                g = 10;
                break a;
              case Ca$2:
                g = 9;
                break a;
              case Da$2:
                g = 11;
                break a;
              case Ga$2:
                g = 14;
                break a;
              case Ha$2:
                g = 16;
                d = null;
                break a;
            }
          throw Error(p$2(130, null == a ? a : typeof a, ""));
      }
  b = Bg(g, c, b, e);
  b.elementType = a;
  b.type = d;
  b.lanes = f2;
  return b;
}
function Ah(a, b, c, d) {
  a = Bg(7, a, d, b);
  a.lanes = c;
  return a;
}
function qj(a, b, c, d) {
  a = Bg(22, a, d, b);
  a.elementType = Ia$2;
  a.lanes = c;
  a.stateNode = { isHidden: false };
  return a;
}
function xh(a, b, c) {
  a = Bg(6, a, null, b);
  a.lanes = c;
  return a;
}
function zh(a, b, c) {
  b = Bg(4, null !== a.children ? a.children : [], a.key, b);
  b.lanes = c;
  b.stateNode = { containerInfo: a.containerInfo, pendingChildren: null, implementation: a.implementation };
  return b;
}
function bl(a, b, c, d, e) {
  this.tag = b;
  this.containerInfo = a;
  this.finishedWork = this.pingCache = this.current = this.pendingChildren = null;
  this.timeoutHandle = -1;
  this.callbackNode = this.pendingContext = this.context = null;
  this.callbackPriority = 0;
  this.eventTimes = zc$1(0);
  this.expirationTimes = zc$1(-1);
  this.entangledLanes = this.finishedLanes = this.mutableReadLanes = this.expiredLanes = this.pingedLanes = this.suspendedLanes = this.pendingLanes = 0;
  this.entanglements = zc$1(0);
  this.identifierPrefix = d;
  this.onRecoverableError = e;
  this.mutableSourceEagerHydrationData = null;
}
function cl(a, b, c, d, e, f2, g, h, k2) {
  a = new bl(a, b, c, h, k2);
  1 === b ? (b = 1, true === f2 && (b |= 8)) : b = 0;
  f2 = Bg(3, null, null, b);
  a.current = f2;
  f2.stateNode = a;
  f2.memoizedState = { element: d, isDehydrated: c, cache: null, transitions: null, pendingSuspenseBoundaries: null };
  ah(f2);
  return a;
}
function dl(a, b, c) {
  var d = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : null;
  return { $$typeof: wa$2, key: null == d ? null : "" + d, children: a, containerInfo: b, implementation: c };
}
function el(a) {
  if (!a)
    return Vf;
  a = a._reactInternals;
  a: {
    if (Vb$1(a) !== a || 1 !== a.tag)
      throw Error(p$2(170));
    var b = a;
    do {
      switch (b.tag) {
        case 3:
          b = b.stateNode.context;
          break a;
        case 1:
          if (Zf(b.type)) {
            b = b.stateNode.__reactInternalMemoizedMergedChildContext;
            break a;
          }
      }
      b = b.return;
    } while (null !== b);
    throw Error(p$2(171));
  }
  if (1 === a.tag) {
    var c = a.type;
    if (Zf(c))
      return bg(a, c, b);
  }
  return b;
}
function fl(a, b, c, d, e, f2, g, h, k2) {
  a = cl(c, d, true, a, e, f2, g, h, k2);
  a.context = el(null);
  c = a.current;
  d = L$2();
  e = lh(c);
  f2 = ch(d, e);
  f2.callback = void 0 !== b && null !== b ? b : null;
  dh(c, f2, e);
  a.current.lanes = e;
  Ac$1(a, e, d);
  Ek(a, d);
  return a;
}
function gl(a, b, c, d) {
  var e = b.current, f2 = L$2(), g = lh(e);
  c = el(c);
  null === b.context ? b.context = c : b.pendingContext = c;
  b = ch(f2, g);
  b.payload = { element: a };
  d = void 0 === d ? null : d;
  null !== d && (b.callback = d);
  a = dh(e, b, g);
  null !== a && (mh(a, e, g, f2), eh(a, e, g));
  return g;
}
function hl(a) {
  a = a.current;
  if (!a.child)
    return null;
  switch (a.child.tag) {
    case 5:
      return a.child.stateNode;
    default:
      return a.child.stateNode;
  }
}
function il(a, b) {
  a = a.memoizedState;
  if (null !== a && null !== a.dehydrated) {
    var c = a.retryLane;
    a.retryLane = 0 !== c && c < b ? c : b;
  }
}
function jl(a, b) {
  il(a, b);
  (a = a.alternate) && il(a, b);
}
function kl() {
  return null;
}
var ll = "function" === typeof reportError ? reportError : function(a) {
  console.error(a);
};
function ml(a) {
  this._internalRoot = a;
}
nl.prototype.render = ml.prototype.render = function(a) {
  var b = this._internalRoot;
  if (null === b)
    throw Error(p$2(409));
  gl(a, b, null, null);
};
nl.prototype.unmount = ml.prototype.unmount = function() {
  var a = this._internalRoot;
  if (null !== a) {
    this._internalRoot = null;
    var b = a.containerInfo;
    Sk(function() {
      gl(null, a, null, null);
    });
    b[uf] = null;
  }
};
function nl(a) {
  this._internalRoot = a;
}
nl.prototype.unstable_scheduleHydration = function(a) {
  if (a) {
    var b = Hc$1();
    a = { blockedOn: null, target: a, priority: b };
    for (var c = 0; c < Qc$1.length && 0 !== b && b < Qc$1[c].priority; c++)
      ;
    Qc$1.splice(c, 0, a);
    0 === c && Vc$1(a);
  }
};
function ol(a) {
  return !(!a || 1 !== a.nodeType && 9 !== a.nodeType && 11 !== a.nodeType);
}
function pl(a) {
  return !(!a || 1 !== a.nodeType && 9 !== a.nodeType && 11 !== a.nodeType && (8 !== a.nodeType || " react-mount-point-unstable " !== a.nodeValue));
}
function ql() {
}
function rl(a, b, c, d, e) {
  if (e) {
    if ("function" === typeof d) {
      var f2 = d;
      d = function() {
        var a2 = hl(g);
        f2.call(a2);
      };
    }
    var g = fl(b, d, a, 0, null, false, false, "", ql);
    a._reactRootContainer = g;
    a[uf] = g.current;
    sf(8 === a.nodeType ? a.parentNode : a);
    Sk();
    return g;
  }
  for (; e = a.lastChild; )
    a.removeChild(e);
  if ("function" === typeof d) {
    var h = d;
    d = function() {
      var a2 = hl(k2);
      h.call(a2);
    };
  }
  var k2 = cl(a, 0, false, null, null, false, false, "", ql);
  a._reactRootContainer = k2;
  a[uf] = k2.current;
  sf(8 === a.nodeType ? a.parentNode : a);
  Sk(function() {
    gl(b, k2, c, d);
  });
  return k2;
}
function sl(a, b, c, d, e) {
  var f2 = c._reactRootContainer;
  if (f2) {
    var g = f2;
    if ("function" === typeof e) {
      var h = e;
      e = function() {
        var a2 = hl(g);
        h.call(a2);
      };
    }
    gl(b, g, a, e);
  } else
    g = rl(c, b, a, e, d);
  return hl(g);
}
Ec$1 = function(a) {
  switch (a.tag) {
    case 3:
      var b = a.stateNode;
      if (b.current.memoizedState.isDehydrated) {
        var c = tc$1(b.pendingLanes);
        0 !== c && (Cc$1(b, c | 1), Ek(b, B$2()), 0 === (K$2 & 6) && (Hj = B$2() + 500, jg()));
      }
      break;
    case 13:
      Sk(function() {
        var b2 = Zg(a, 1);
        if (null !== b2) {
          var c2 = L$2();
          mh(b2, a, 1, c2);
        }
      }), jl(a, 1);
  }
};
Fc$1 = function(a) {
  if (13 === a.tag) {
    var b = Zg(a, 134217728);
    if (null !== b) {
      var c = L$2();
      mh(b, a, 134217728, c);
    }
    jl(a, 134217728);
  }
};
Gc$1 = function(a) {
  if (13 === a.tag) {
    var b = lh(a), c = Zg(a, b);
    if (null !== c) {
      var d = L$2();
      mh(c, a, b, d);
    }
    jl(a, b);
  }
};
Hc$1 = function() {
  return C$1;
};
Ic$1 = function(a, b) {
  var c = C$1;
  try {
    return C$1 = a, b();
  } finally {
    C$1 = c;
  }
};
yb$2 = function(a, b, c) {
  switch (b) {
    case "input":
      bb$2(a, c);
      b = c.name;
      if ("radio" === c.type && null != b) {
        for (c = a; c.parentNode; )
          c = c.parentNode;
        c = c.querySelectorAll("input[name=" + JSON.stringify("" + b) + '][type="radio"]');
        for (b = 0; b < c.length; b++) {
          var d = c[b];
          if (d !== a && d.form === a.form) {
            var e = Db$2(d);
            if (!e)
              throw Error(p$2(90));
            Wa$2(d);
            bb$2(d, e);
          }
        }
      }
      break;
    case "textarea":
      ib$2(a, c);
      break;
    case "select":
      b = c.value, null != b && fb$2(a, !!c.multiple, b, false);
  }
};
Gb$2 = Rk;
Hb$2 = Sk;
var tl = { usingClientEntryPoint: false, Events: [Cb$2, ue, Db$2, Eb$2, Fb$1, Rk] }, ul = { findFiberByHostInstance: Wc$1, bundleType: 0, version: "18.2.0", rendererPackageName: "react-dom" };
var vl = { bundleType: ul.bundleType, version: ul.version, rendererPackageName: ul.rendererPackageName, rendererConfig: ul.rendererConfig, overrideHookState: null, overrideHookStateDeletePath: null, overrideHookStateRenamePath: null, overrideProps: null, overridePropsDeletePath: null, overridePropsRenamePath: null, setErrorHandler: null, setSuspenseHandler: null, scheduleUpdate: null, currentDispatcherRef: ua$2.ReactCurrentDispatcher, findHostInstanceByFiber: function(a) {
  a = Zb$1(a);
  return null === a ? null : a.stateNode;
}, findFiberByHostInstance: ul.findFiberByHostInstance || kl, findHostInstancesForRefresh: null, scheduleRefresh: null, scheduleRoot: null, setRefreshHandler: null, getCurrentFiber: null, reconcilerVersion: "18.2.0-next-9e3b772b8-20220608" };
if ("undefined" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__) {
  var wl = __REACT_DEVTOOLS_GLOBAL_HOOK__;
  if (!wl.isDisabled && wl.supportsFiber)
    try {
      kc$1 = wl.inject(vl), lc$1 = wl;
    } catch (a) {
    }
}
reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED = tl;
reactDom_production_min.createPortal = function(a, b) {
  var c = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : null;
  if (!ol(b))
    throw Error(p$2(200));
  return dl(a, b, null, c);
};
reactDom_production_min.createRoot = function(a, b) {
  if (!ol(a))
    throw Error(p$2(299));
  var c = false, d = "", e = ll;
  null !== b && void 0 !== b && (true === b.unstable_strictMode && (c = true), void 0 !== b.identifierPrefix && (d = b.identifierPrefix), void 0 !== b.onRecoverableError && (e = b.onRecoverableError));
  b = cl(a, 1, false, null, null, c, false, d, e);
  a[uf] = b.current;
  sf(8 === a.nodeType ? a.parentNode : a);
  return new ml(b);
};
reactDom_production_min.findDOMNode = function(a) {
  if (null == a)
    return null;
  if (1 === a.nodeType)
    return a;
  var b = a._reactInternals;
  if (void 0 === b) {
    if ("function" === typeof a.render)
      throw Error(p$2(188));
    a = Object.keys(a).join(",");
    throw Error(p$2(268, a));
  }
  a = Zb$1(b);
  a = null === a ? null : a.stateNode;
  return a;
};
reactDom_production_min.flushSync = function(a) {
  return Sk(a);
};
reactDom_production_min.hydrate = function(a, b, c) {
  if (!pl(b))
    throw Error(p$2(200));
  return sl(null, a, b, true, c);
};
reactDom_production_min.hydrateRoot = function(a, b, c) {
  if (!ol(a))
    throw Error(p$2(405));
  var d = null != c && c.hydratedSources || null, e = false, f2 = "", g = ll;
  null !== c && void 0 !== c && (true === c.unstable_strictMode && (e = true), void 0 !== c.identifierPrefix && (f2 = c.identifierPrefix), void 0 !== c.onRecoverableError && (g = c.onRecoverableError));
  b = fl(b, null, a, 1, null != c ? c : null, e, false, f2, g);
  a[uf] = b.current;
  sf(a);
  if (d)
    for (a = 0; a < d.length; a++)
      c = d[a], e = c._getVersion, e = e(c._source), null == b.mutableSourceEagerHydrationData ? b.mutableSourceEagerHydrationData = [c, e] : b.mutableSourceEagerHydrationData.push(
        c,
        e
      );
  return new nl(b);
};
reactDom_production_min.render = function(a, b, c) {
  if (!pl(b))
    throw Error(p$2(200));
  return sl(null, a, b, false, c);
};
reactDom_production_min.unmountComponentAtNode = function(a) {
  if (!pl(a))
    throw Error(p$2(40));
  return a._reactRootContainer ? (Sk(function() {
    sl(null, null, a, false, function() {
      a._reactRootContainer = null;
      a[uf] = null;
    });
  }), true) : false;
};
reactDom_production_min.unstable_batchedUpdates = Rk;
reactDom_production_min.unstable_renderSubtreeIntoContainer = function(a, b, c, d) {
  if (!pl(c))
    throw Error(p$2(200));
  if (null == a || void 0 === a._reactInternals)
    throw Error(p$2(38));
  return sl(a, b, c, false, d);
};
reactDom_production_min.version = "18.2.0-next-9e3b772b8-20220608";
function checkDCE() {
  if (typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === "undefined" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== "function") {
    return;
  }
  try {
    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);
  } catch (err) {
    console.error(err);
  }
}
{
  checkDCE();
  reactDom.exports = reactDom_production_min;
}
var reactDomExports = reactDom.exports;
var createRoot;
var m = reactDomExports;
{
  createRoot = m.createRoot;
  m.hydrateRoot;
}
var events$1 = { exports: {} };
var R$2 = typeof Reflect === "object" ? Reflect : null;
var ReflectApply = R$2 && typeof R$2.apply === "function" ? R$2.apply : function ReflectApply2(target, receiver, args) {
  return Function.prototype.apply.call(target, receiver, args);
};
var ReflectOwnKeys;
if (R$2 && typeof R$2.ownKeys === "function") {
  ReflectOwnKeys = R$2.ownKeys;
} else if (Object.getOwnPropertySymbols) {
  ReflectOwnKeys = function ReflectOwnKeys2(target) {
    return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target));
  };
} else {
  ReflectOwnKeys = function ReflectOwnKeys2(target) {
    return Object.getOwnPropertyNames(target);
  };
}
function ProcessEmitWarning(warning) {
  if (console && console.warn)
    console.warn(warning);
}
var NumberIsNaN = Number.isNaN || function NumberIsNaN2(value) {
  return value !== value;
};
function EventEmitter() {
  EventEmitter.init.call(this);
}
events$1.exports = EventEmitter;
events$1.exports.once = once2;
EventEmitter.EventEmitter = EventEmitter;
EventEmitter.prototype._events = void 0;
EventEmitter.prototype._eventsCount = 0;
EventEmitter.prototype._maxListeners = void 0;
var defaultMaxListeners = 10;
function checkListener(listener) {
  if (typeof listener !== "function") {
    throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof listener);
  }
}
Object.defineProperty(EventEmitter, "defaultMaxListeners", {
  enumerable: true,
  get: function() {
    return defaultMaxListeners;
  },
  set: function(arg) {
    if (typeof arg !== "number" || arg < 0 || NumberIsNaN(arg)) {
      throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + arg + ".");
    }
    defaultMaxListeners = arg;
  }
});
EventEmitter.init = function() {
  if (this._events === void 0 || this._events === Object.getPrototypeOf(this)._events) {
    this._events = /* @__PURE__ */ Object.create(null);
    this._eventsCount = 0;
  }
  this._maxListeners = this._maxListeners || void 0;
};
EventEmitter.prototype.setMaxListeners = function setMaxListeners(n2) {
  if (typeof n2 !== "number" || n2 < 0 || NumberIsNaN(n2)) {
    throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + n2 + ".");
  }
  this._maxListeners = n2;
  return this;
};
function _getMaxListeners(that) {
  if (that._maxListeners === void 0)
    return EventEmitter.defaultMaxListeners;
  return that._maxListeners;
}
EventEmitter.prototype.getMaxListeners = function getMaxListeners() {
  return _getMaxListeners(this);
};
EventEmitter.prototype.emit = function emit(type) {
  var args = [];
  for (var i = 1; i < arguments.length; i++)
    args.push(arguments[i]);
  var doError = type === "error";
  var events2 = this._events;
  if (events2 !== void 0)
    doError = doError && events2.error === void 0;
  else if (!doError)
    return false;
  if (doError) {
    var er;
    if (args.length > 0)
      er = args[0];
    if (er instanceof Error) {
      throw er;
    }
    var err = new Error("Unhandled error." + (er ? " (" + er.message + ")" : ""));
    err.context = er;
    throw err;
  }
  var handler = events2[type];
  if (handler === void 0)
    return false;
  if (typeof handler === "function") {
    ReflectApply(handler, this, args);
  } else {
    var len = handler.length;
    var listeners2 = arrayClone(handler, len);
    for (var i = 0; i < len; ++i)
      ReflectApply(listeners2[i], this, args);
  }
  return true;
};
function _addListener(target, type, listener, prepend) {
  var m2;
  var events2;
  var existing;
  checkListener(listener);
  events2 = target._events;
  if (events2 === void 0) {
    events2 = target._events = /* @__PURE__ */ Object.create(null);
    target._eventsCount = 0;
  } else {
    if (events2.newListener !== void 0) {
      target.emit(
        "newListener",
        type,
        listener.listener ? listener.listener : listener
      );
      events2 = target._events;
    }
    existing = events2[type];
  }
  if (existing === void 0) {
    existing = events2[type] = listener;
    ++target._eventsCount;
  } else {
    if (typeof existing === "function") {
      existing = events2[type] = prepend ? [listener, existing] : [existing, listener];
    } else if (prepend) {
      existing.unshift(listener);
    } else {
      existing.push(listener);
    }
    m2 = _getMaxListeners(target);
    if (m2 > 0 && existing.length > m2 && !existing.warned) {
      existing.warned = true;
      var w2 = new Error("Possible EventEmitter memory leak detected. " + existing.length + " " + String(type) + " listeners added. Use emitter.setMaxListeners() to increase limit");
      w2.name = "MaxListenersExceededWarning";
      w2.emitter = target;
      w2.type = type;
      w2.count = existing.length;
      ProcessEmitWarning(w2);
    }
  }
  return target;
}
EventEmitter.prototype.addListener = function addListener(type, listener) {
  return _addListener(this, type, listener, false);
};
EventEmitter.prototype.on = EventEmitter.prototype.addListener;
EventEmitter.prototype.prependListener = function prependListener(type, listener) {
  return _addListener(this, type, listener, true);
};
function onceWrapper() {
  if (!this.fired) {
    this.target.removeListener(this.type, this.wrapFn);
    this.fired = true;
    if (arguments.length === 0)
      return this.listener.call(this.target);
    return this.listener.apply(this.target, arguments);
  }
}
function _onceWrap(target, type, listener) {
  var state = { fired: false, wrapFn: void 0, target, type, listener };
  var wrapped = onceWrapper.bind(state);
  wrapped.listener = listener;
  state.wrapFn = wrapped;
  return wrapped;
}
EventEmitter.prototype.once = function once(type, listener) {
  checkListener(listener);
  this.on(type, _onceWrap(this, type, listener));
  return this;
};
EventEmitter.prototype.prependOnceListener = function prependOnceListener(type, listener) {
  checkListener(listener);
  this.prependListener(type, _onceWrap(this, type, listener));
  return this;
};
EventEmitter.prototype.removeListener = function removeListener(type, listener) {
  var list, events2, position, i, originalListener;
  checkListener(listener);
  events2 = this._events;
  if (events2 === void 0)
    return this;
  list = events2[type];
  if (list === void 0)
    return this;
  if (list === listener || list.listener === listener) {
    if (--this._eventsCount === 0)
      this._events = /* @__PURE__ */ Object.create(null);
    else {
      delete events2[type];
      if (events2.removeListener)
        this.emit("removeListener", type, list.listener || listener);
    }
  } else if (typeof list !== "function") {
    position = -1;
    for (i = list.length - 1; i >= 0; i--) {
      if (list[i] === listener || list[i].listener === listener) {
        originalListener = list[i].listener;
        position = i;
        break;
      }
    }
    if (position < 0)
      return this;
    if (position === 0)
      list.shift();
    else {
      spliceOne(list, position);
    }
    if (list.length === 1)
      events2[type] = list[0];
    if (events2.removeListener !== void 0)
      this.emit("removeListener", type, originalListener || listener);
  }
  return this;
};
EventEmitter.prototype.off = EventEmitter.prototype.removeListener;
EventEmitter.prototype.removeAllListeners = function removeAllListeners(type) {
  var listeners2, events2, i;
  events2 = this._events;
  if (events2 === void 0)
    return this;
  if (events2.removeListener === void 0) {
    if (arguments.length === 0) {
      this._events = /* @__PURE__ */ Object.create(null);
      this._eventsCount = 0;
    } else if (events2[type] !== void 0) {
      if (--this._eventsCount === 0)
        this._events = /* @__PURE__ */ Object.create(null);
      else
        delete events2[type];
    }
    return this;
  }
  if (arguments.length === 0) {
    var keys2 = Object.keys(events2);
    var key;
    for (i = 0; i < keys2.length; ++i) {
      key = keys2[i];
      if (key === "removeListener")
        continue;
      this.removeAllListeners(key);
    }
    this.removeAllListeners("removeListener");
    this._events = /* @__PURE__ */ Object.create(null);
    this._eventsCount = 0;
    return this;
  }
  listeners2 = events2[type];
  if (typeof listeners2 === "function") {
    this.removeListener(type, listeners2);
  } else if (listeners2 !== void 0) {
    for (i = listeners2.length - 1; i >= 0; i--) {
      this.removeListener(type, listeners2[i]);
    }
  }
  return this;
};
function _listeners(target, type, unwrap) {
  var events2 = target._events;
  if (events2 === void 0)
    return [];
  var evlistener = events2[type];
  if (evlistener === void 0)
    return [];
  if (typeof evlistener === "function")
    return unwrap ? [evlistener.listener || evlistener] : [evlistener];
  return unwrap ? unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);
}
EventEmitter.prototype.listeners = function listeners(type) {
  return _listeners(this, type, true);
};
EventEmitter.prototype.rawListeners = function rawListeners(type) {
  return _listeners(this, type, false);
};
EventEmitter.listenerCount = function(emitter, type) {
  if (typeof emitter.listenerCount === "function") {
    return emitter.listenerCount(type);
  } else {
    return listenerCount.call(emitter, type);
  }
};
EventEmitter.prototype.listenerCount = listenerCount;
function listenerCount(type) {
  var events2 = this._events;
  if (events2 !== void 0) {
    var evlistener = events2[type];
    if (typeof evlistener === "function") {
      return 1;
    } else if (evlistener !== void 0) {
      return evlistener.length;
    }
  }
  return 0;
}
EventEmitter.prototype.eventNames = function eventNames() {
  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];
};
function arrayClone(arr, n2) {
  var copy = new Array(n2);
  for (var i = 0; i < n2; ++i)
    copy[i] = arr[i];
  return copy;
}
function spliceOne(list, index2) {
  for (; index2 + 1 < list.length; index2++)
    list[index2] = list[index2 + 1];
  list.pop();
}
function unwrapListeners(arr) {
  var ret = new Array(arr.length);
  for (var i = 0; i < ret.length; ++i) {
    ret[i] = arr[i].listener || arr[i];
  }
  return ret;
}
function once2(emitter, name) {
  return new Promise(function(resolve2, reject) {
    function errorListener(err) {
      emitter.removeListener(name, resolver);
      reject(err);
    }
    function resolver() {
      if (typeof emitter.removeListener === "function") {
        emitter.removeListener("error", errorListener);
      }
      resolve2([].slice.call(arguments));
    }
    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });
    if (name !== "error") {
      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });
    }
  });
}
function addErrorHandlerIfEventEmitter(emitter, handler, flags) {
  if (typeof emitter.on === "function") {
    eventTargetAgnosticAddListener(emitter, "error", handler, flags);
  }
}
function eventTargetAgnosticAddListener(emitter, name, listener, flags) {
  if (typeof emitter.on === "function") {
    if (flags.once) {
      emitter.once(name, listener);
    } else {
      emitter.on(name, listener);
    }
  } else if (typeof emitter.addEventListener === "function") {
    emitter.addEventListener(name, function wrapListener(arg) {
      if (flags.once) {
        emitter.removeEventListener(name, wrapListener);
      }
      listener(arg);
    });
  } else {
    throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type ' + typeof emitter);
  }
}
var eventsExports = events$1.exports;
class Orientation {
  static flip(from2) {
    if (from2 === Orientation.HORZ) {
      return Orientation.VERT;
    } else {
      return Orientation.HORZ;
    }
  }
  /** @internal */
  constructor(name) {
    this._name = name;
  }
  getName() {
    return this._name;
  }
  toString() {
    return this._name;
  }
}
Orientation.HORZ = new Orientation("horz");
Orientation.VERT = new Orientation("vert");
class Rect {
  static empty() {
    return new Rect(0, 0, 0, 0);
  }
  static fromJson(json) {
    return new Rect(json.x, json.y, json.width, json.height);
  }
  constructor(x2, y2, width, height) {
    this.x = x2;
    this.y = y2;
    this.width = width;
    this.height = height;
  }
  toJson() {
    return { x: this.x, y: this.y, width: this.width, height: this.height };
  }
  snap(round2) {
    this.x = Math.round(this.x / round2) * round2;
    this.y = Math.round(this.y / round2) * round2;
    this.width = Math.round(this.width / round2) * round2;
    this.height = Math.round(this.height / round2) * round2;
  }
  static getBoundingClientRect(element) {
    let { x: x2, y: y2, width, height } = element.getBoundingClientRect();
    return new Rect(x2, y2, width, height);
  }
  static getContentRect(element) {
    const rect = element.getBoundingClientRect();
    const style2 = window.getComputedStyle(element);
    const paddingLeft = parseFloat(style2.paddingLeft);
    const paddingRight = parseFloat(style2.paddingRight);
    const paddingTop = parseFloat(style2.paddingTop);
    const paddingBottom = parseFloat(style2.paddingBottom);
    const borderLeftWidth = parseFloat(style2.borderLeftWidth);
    const borderRightWidth = parseFloat(style2.borderRightWidth);
    const borderTopWidth = parseFloat(style2.borderTopWidth);
    const borderBottomWidth = parseFloat(style2.borderBottomWidth);
    const contentWidth = rect.width - borderLeftWidth - paddingLeft - paddingRight - borderRightWidth;
    const contentHeight = rect.height - borderTopWidth - paddingTop - paddingBottom - borderBottomWidth;
    return new Rect(rect.left + borderLeftWidth + paddingLeft, rect.top + borderTopWidth + paddingTop, contentWidth, contentHeight);
  }
  static fromDomRect(domRect) {
    return new Rect(domRect.x, domRect.y, domRect.width, domRect.height);
  }
  relativeTo(r2) {
    return new Rect(this.x - r2.x, this.y - r2.y, this.width, this.height);
  }
  clone() {
    return new Rect(this.x, this.y, this.width, this.height);
  }
  equals(rect) {
    return this.x === (rect === null || rect === void 0 ? void 0 : rect.x) && this.y === (rect === null || rect === void 0 ? void 0 : rect.y) && this.width === (rect === null || rect === void 0 ? void 0 : rect.width) && this.height === (rect === null || rect === void 0 ? void 0 : rect.height);
  }
  equalSize(rect) {
    return this.width === (rect === null || rect === void 0 ? void 0 : rect.width) && this.height === (rect === null || rect === void 0 ? void 0 : rect.height);
  }
  getBottom() {
    return this.y + this.height;
  }
  getRight() {
    return this.x + this.width;
  }
  getCenter() {
    return { x: this.x + this.width / 2, y: this.y + this.height / 2 };
  }
  positionElement(element, position) {
    this.styleWithPosition(element.style, position);
  }
  styleWithPosition(style2, position = "absolute") {
    style2.left = this.x + "px";
    style2.top = this.y + "px";
    style2.width = Math.max(0, this.width) + "px";
    style2.height = Math.max(0, this.height) + "px";
    style2.position = position;
    return style2;
  }
  contains(x2, y2) {
    if (this.x <= x2 && x2 <= this.getRight() && this.y <= y2 && y2 <= this.getBottom()) {
      return true;
    } else {
      return false;
    }
  }
  removeInsets(insets) {
    return new Rect(this.x + insets.left, this.y + insets.top, Math.max(0, this.width - insets.left - insets.right), Math.max(0, this.height - insets.top - insets.bottom));
  }
  centerInRect(outerRect) {
    this.x = (outerRect.width - this.width) / 2;
    this.y = (outerRect.height - this.height) / 2;
  }
  /** @internal */
  _getSize(orientation) {
    let prefSize = this.width;
    if (orientation === Orientation.VERT) {
      prefSize = this.height;
    }
    return prefSize;
  }
  toString() {
    return "(Rect: x=" + this.x + ", y=" + this.y + ", width=" + this.width + ", height=" + this.height + ")";
  }
}
class DockLocation {
  /** @internal */
  static getByName(name) {
    return DockLocation.values.get(name);
  }
  /** @internal */
  static getLocation(rect, x2, y2) {
    x2 = (x2 - rect.x) / rect.width;
    y2 = (y2 - rect.y) / rect.height;
    if (x2 >= 0.25 && x2 < 0.75 && y2 >= 0.25 && y2 < 0.75) {
      return DockLocation.CENTER;
    }
    const bl2 = y2 >= x2;
    const br = y2 >= 1 - x2;
    if (bl2) {
      return br ? DockLocation.BOTTOM : DockLocation.LEFT;
    } else {
      return br ? DockLocation.RIGHT : DockLocation.TOP;
    }
  }
  /** @internal */
  constructor(_name, _orientation, _indexPlus) {
    this.name = _name;
    this.orientation = _orientation;
    this.indexPlus = _indexPlus;
    DockLocation.values.set(this.name, this);
  }
  getName() {
    return this.name;
  }
  getOrientation() {
    return this.orientation;
  }
  /** @internal */
  getDockRect(r2) {
    if (this === DockLocation.TOP) {
      return new Rect(r2.x, r2.y, r2.width, r2.height / 2);
    } else if (this === DockLocation.BOTTOM) {
      return new Rect(r2.x, r2.getBottom() - r2.height / 2, r2.width, r2.height / 2);
    }
    if (this === DockLocation.LEFT) {
      return new Rect(r2.x, r2.y, r2.width / 2, r2.height);
    } else if (this === DockLocation.RIGHT) {
      return new Rect(r2.getRight() - r2.width / 2, r2.y, r2.width / 2, r2.height);
    } else {
      return r2.clone();
    }
  }
  /** @internal */
  split(rect, size) {
    if (this === DockLocation.TOP) {
      const r1 = new Rect(rect.x, rect.y, rect.width, size);
      const r2 = new Rect(rect.x, rect.y + size, rect.width, rect.height - size);
      return { start: r1, end: r2 };
    } else if (this === DockLocation.LEFT) {
      const r1 = new Rect(rect.x, rect.y, size, rect.height);
      const r2 = new Rect(rect.x + size, rect.y, rect.width - size, rect.height);
      return { start: r1, end: r2 };
    }
    if (this === DockLocation.RIGHT) {
      const r1 = new Rect(rect.getRight() - size, rect.y, size, rect.height);
      const r2 = new Rect(rect.x, rect.y, rect.width - size, rect.height);
      return { start: r1, end: r2 };
    } else {
      const r1 = new Rect(rect.x, rect.getBottom() - size, rect.width, size);
      const r2 = new Rect(rect.x, rect.y, rect.width, rect.height - size);
      return { start: r1, end: r2 };
    }
  }
  /** @internal */
  reflect() {
    if (this === DockLocation.TOP) {
      return DockLocation.BOTTOM;
    } else if (this === DockLocation.LEFT) {
      return DockLocation.RIGHT;
    }
    if (this === DockLocation.RIGHT) {
      return DockLocation.LEFT;
    } else {
      return DockLocation.TOP;
    }
  }
  toString() {
    return "(DockLocation: name=" + this.name + ", orientation=" + this.orientation + ")";
  }
}
DockLocation.values = /* @__PURE__ */ new Map();
DockLocation.TOP = new DockLocation("top", Orientation.VERT, 0);
DockLocation.BOTTOM = new DockLocation("bottom", Orientation.VERT, 1);
DockLocation.LEFT = new DockLocation("left", Orientation.HORZ, 0);
DockLocation.RIGHT = new DockLocation("right", Orientation.HORZ, 1);
DockLocation.CENTER = new DockLocation("center", Orientation.VERT, 0);
var I18nLabel;
(function(I18nLabel2) {
  I18nLabel2["Close_Tab"] = "Close";
  I18nLabel2["Close_Tabset"] = "Close tab set";
  I18nLabel2["Active_Tabset"] = "Active tab set";
  I18nLabel2["Move_Tabset"] = "Move tab set";
  I18nLabel2["Move_Tabs"] = "Move tabs(?)";
  I18nLabel2["Maximize"] = "Maximize tab set";
  I18nLabel2["Restore"] = "Restore tab set";
  I18nLabel2["Popout_Tab"] = "Popout selected tab";
  I18nLabel2["Overflow_Menu_Tooltip"] = "Hidden tabs";
  I18nLabel2["Error_rendering_component"] = "Error rendering component";
})(I18nLabel || (I18nLabel = {}));
var CLASSES;
(function(CLASSES2) {
  CLASSES2["FLEXLAYOUT__BORDER"] = "flexlayout__border";
  CLASSES2["FLEXLAYOUT__BORDER_"] = "flexlayout__border_";
  CLASSES2["FLEXLAYOUT__BORDER_TAB_CONTENTS"] = "flexlayout__border_tab_contents";
  CLASSES2["FLEXLAYOUT__BORDER_BUTTON"] = "flexlayout__border_button";
  CLASSES2["FLEXLAYOUT__BORDER_BUTTON_"] = "flexlayout__border_button_";
  CLASSES2["FLEXLAYOUT__BORDER_BUTTON_CONTENT"] = "flexlayout__border_button_content";
  CLASSES2["FLEXLAYOUT__BORDER_BUTTON_LEADING"] = "flexlayout__border_button_leading";
  CLASSES2["FLEXLAYOUT__BORDER_BUTTON_TRAILING"] = "flexlayout__border_button_trailing";
  CLASSES2["FLEXLAYOUT__BORDER_BUTTON__SELECTED"] = "flexlayout__border_button--selected";
  CLASSES2["FLEXLAYOUT__BORDER_BUTTON__UNSELECTED"] = "flexlayout__border_button--unselected";
  CLASSES2["FLEXLAYOUT__BORDER_TOOLBAR_BUTTON_OVERFLOW"] = "flexlayout__border_toolbar_button_overflow";
  CLASSES2["FLEXLAYOUT__BORDER_TOOLBAR_BUTTON_OVERFLOW_"] = "flexlayout__border_toolbar_button_overflow_";
  CLASSES2["FLEXLAYOUT__BORDER_INNER"] = "flexlayout__border_inner";
  CLASSES2["FLEXLAYOUT__BORDER_INNER_"] = "flexlayout__border_inner_";
  CLASSES2["FLEXLAYOUT__BORDER_INNER_TAB_CONTAINER"] = "flexlayout__border_inner_tab_container";
  CLASSES2["FLEXLAYOUT__BORDER_INNER_TAB_CONTAINER_"] = "flexlayout__border_inner_tab_container_";
  CLASSES2["FLEXLAYOUT__BORDER_TAB_DIVIDER"] = "flexlayout__border_tab_divider";
  CLASSES2["FLEXLAYOUT__BORDER_SIZER"] = "flexlayout__border_sizer";
  CLASSES2["FLEXLAYOUT__BORDER_TOOLBAR"] = "flexlayout__border_toolbar";
  CLASSES2["FLEXLAYOUT__BORDER_TOOLBAR_"] = "flexlayout__border_toolbar_";
  CLASSES2["FLEXLAYOUT__BORDER_TOOLBAR_BUTTON"] = "flexlayout__border_toolbar_button";
  CLASSES2["FLEXLAYOUT__BORDER_TOOLBAR_BUTTON_FLOAT"] = "flexlayout__border_toolbar_button-float";
  CLASSES2["FLEXLAYOUT__DRAG_RECT"] = "flexlayout__drag_rect";
  CLASSES2["FLEXLAYOUT__EDGE_RECT"] = "flexlayout__edge_rect";
  CLASSES2["FLEXLAYOUT__EDGE_RECT_TOP"] = "flexlayout__edge_rect_top";
  CLASSES2["FLEXLAYOUT__EDGE_RECT_LEFT"] = "flexlayout__edge_rect_left";
  CLASSES2["FLEXLAYOUT__EDGE_RECT_BOTTOM"] = "flexlayout__edge_rect_bottom";
  CLASSES2["FLEXLAYOUT__EDGE_RECT_RIGHT"] = "flexlayout__edge_rect_right";
  CLASSES2["FLEXLAYOUT__ERROR_BOUNDARY_CONTAINER"] = "flexlayout__error_boundary_container";
  CLASSES2["FLEXLAYOUT__ERROR_BOUNDARY_CONTENT"] = "flexlayout__error_boundary_content";
  CLASSES2["FLEXLAYOUT__FLOATING_WINDOW_CONTENT"] = "flexlayout__floating_window_content";
  CLASSES2["FLEXLAYOUT__FLOATING_WINDOW_TAB"] = "flexlayout__floating_window_tab";
  CLASSES2["FLEXLAYOUT__LAYOUT"] = "flexlayout__layout";
  CLASSES2["FLEXLAYOUT__LAYOUT_MOVEABLES"] = "flexlayout__layout_moveables";
  CLASSES2["FLEXLAYOUT__LAYOUT_OVERLAY"] = "flexlayout__layout_overlay";
  CLASSES2["FLEXLAYOUT__LAYOUT_TAB_STAMPS"] = "flexlayout__layout_tab_stamps";
  CLASSES2["FLEXLAYOUT__LAYOUT_MAIN"] = "flexlayout__layout_main";
  CLASSES2["FLEXLAYOUT__LAYOUT_BORDER_CONTAINER"] = "flexlayout__layout_border_container";
  CLASSES2["FLEXLAYOUT__LAYOUT_BORDER_CONTAINER_INNER"] = "flexlayout__layout_border_container_inner";
  CLASSES2["FLEXLAYOUT__OUTLINE_RECT"] = "flexlayout__outline_rect";
  CLASSES2["FLEXLAYOUT__OUTLINE_RECT_EDGE"] = "flexlayout__outline_rect_edge";
  CLASSES2["FLEXLAYOUT__SPLITTER"] = "flexlayout__splitter";
  CLASSES2["FLEXLAYOUT__SPLITTER_EXTRA"] = "flexlayout__splitter_extra";
  CLASSES2["FLEXLAYOUT__SPLITTER_"] = "flexlayout__splitter_";
  CLASSES2["FLEXLAYOUT__SPLITTER_BORDER"] = "flexlayout__splitter_border";
  CLASSES2["FLEXLAYOUT__SPLITTER_DRAG"] = "flexlayout__splitter_drag";
  CLASSES2["FLEXLAYOUT__SPLITTER_HANDLE"] = "flexlayout__splitter_handle";
  CLASSES2["FLEXLAYOUT__SPLITTER_HANDLE_HORZ"] = "flexlayout__splitter_handle_horz";
  CLASSES2["FLEXLAYOUT__SPLITTER_HANDLE_VERT"] = "flexlayout__splitter_handle_vert";
  CLASSES2["FLEXLAYOUT__ROW"] = "flexlayout__row";
  CLASSES2["FLEXLAYOUT__TAB"] = "flexlayout__tab";
  CLASSES2["FLEXLAYOUT__TAB_POSITION"] = "flexlayout__tab_position";
  CLASSES2["FLEXLAYOUT__TAB_MOVEABLE"] = "flexlayout__tab_moveable";
  CLASSES2["FLEXLAYOUT__TAB_OVERLAY"] = "flexlayout__tab_overlay";
  CLASSES2["FLEXLAYOUT__TABSET"] = "flexlayout__tabset";
  CLASSES2["FLEXLAYOUT__TABSET_CONTAINER"] = "flexlayout__tabset_container";
  CLASSES2["FLEXLAYOUT__TABSET_HEADER"] = "flexlayout__tabset_header";
  CLASSES2["FLEXLAYOUT__TABSET_HEADER_SIZER"] = "flexlayout__tabset_header_sizer";
  CLASSES2["FLEXLAYOUT__TABSET_HEADER_CONTENT"] = "flexlayout__tabset_header_content";
  CLASSES2["FLEXLAYOUT__TABSET_MAXIMIZED"] = "flexlayout__tabset-maximized";
  CLASSES2["FLEXLAYOUT__TABSET_SELECTED"] = "flexlayout__tabset-selected";
  CLASSES2["FLEXLAYOUT__TABSET_SIZER"] = "flexlayout__tabset_sizer";
  CLASSES2["FLEXLAYOUT__TABSET_TAB_DIVIDER"] = "flexlayout__tabset_tab_divider";
  CLASSES2["FLEXLAYOUT__TABSET_CONTENT"] = "flexlayout__tabset_content";
  CLASSES2["FLEXLAYOUT__TABSET_TABBAR_INNER"] = "flexlayout__tabset_tabbar_inner";
  CLASSES2["FLEXLAYOUT__TABSET_TABBAR_INNER_"] = "flexlayout__tabset_tabbar_inner_";
  CLASSES2["FLEXLAYOUT__TABSET_TABBAR_INNER_TAB_CONTAINER"] = "flexlayout__tabset_tabbar_inner_tab_container";
  CLASSES2["FLEXLAYOUT__TABSET_TABBAR_INNER_TAB_CONTAINER_"] = "flexlayout__tabset_tabbar_inner_tab_container_";
  CLASSES2["FLEXLAYOUT__TABSET_TABBAR_OUTER"] = "flexlayout__tabset_tabbar_outer";
  CLASSES2["FLEXLAYOUT__TABSET_TABBAR_OUTER_"] = "flexlayout__tabset_tabbar_outer_";
  CLASSES2["FLEXLAYOUT__TAB_BORDER"] = "flexlayout__tab_border";
  CLASSES2["FLEXLAYOUT__TAB_BORDER_"] = "flexlayout__tab_border_";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON"] = "flexlayout__tab_button";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON_STRETCH"] = "flexlayout__tab_button_stretch";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON_CONTENT"] = "flexlayout__tab_button_content";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON_LEADING"] = "flexlayout__tab_button_leading";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON_OVERFLOW"] = "flexlayout__tab_button_overflow";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON_OVERFLOW_COUNT"] = "flexlayout__tab_button_overflow_count";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON_TEXTBOX"] = "flexlayout__tab_button_textbox";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON_TRAILING"] = "flexlayout__tab_button_trailing";
  CLASSES2["FLEXLAYOUT__TAB_BUTTON_STAMP"] = "flexlayout__tab_button_stamp";
  CLASSES2["FLEXLAYOUT__TAB_FLOATING"] = "flexlayout__tab_floating";
  CLASSES2["FLEXLAYOUT__TAB_FLOATING_INNER"] = "flexlayout__tab_floating_inner";
  CLASSES2["FLEXLAYOUT__TAB_TOOLBAR"] = "flexlayout__tab_toolbar";
  CLASSES2["FLEXLAYOUT__TAB_TOOLBAR_BUTTON"] = "flexlayout__tab_toolbar_button";
  CLASSES2["FLEXLAYOUT__TAB_TOOLBAR_ICON"] = "flexlayout__tab_toolbar_icon";
  CLASSES2["FLEXLAYOUT__TAB_TOOLBAR_BUTTON_"] = "flexlayout__tab_toolbar_button-";
  CLASSES2["FLEXLAYOUT__TAB_TOOLBAR_BUTTON_FLOAT"] = "flexlayout__tab_toolbar_button-float";
  CLASSES2["FLEXLAYOUT__TAB_TOOLBAR_STICKY_BUTTONS_CONTAINER"] = "flexlayout__tab_toolbar_sticky_buttons_container";
  CLASSES2["FLEXLAYOUT__TAB_TOOLBAR_BUTTON_CLOSE"] = "flexlayout__tab_toolbar_button-close";
  CLASSES2["FLEXLAYOUT__POPUP_MENU_CONTAINER"] = "flexlayout__popup_menu_container";
  CLASSES2["FLEXLAYOUT__POPUP_MENU_ITEM"] = "flexlayout__popup_menu_item";
  CLASSES2["FLEXLAYOUT__POPUP_MENU"] = "flexlayout__popup_menu";
})(CLASSES || (CLASSES = {}));
class Action {
  constructor(type, data) {
    this.type = type;
    this.data = data;
  }
}
class Actions {
  /**
   * Adds a tab node to the given tabset node
   * @param json the json for the new tab node e.g {type:"tab", component:"table"}
   * @param toNodeId the new tab node will be added to the tabset with this node id
   * @param location the location where the new tab will be added, one of the DockLocation enum values.
   * @param index for docking to the center this value is the index of the tab, use -1 to add to the end.
   * @param select (optional) whether to select the new tab, overriding autoSelectTab
   * @returns {Action} the action
   */
  static addNode(json, toNodeId, location, index2, select) {
    return new Action(Actions.ADD_NODE, {
      json,
      toNode: toNodeId,
      location: location.getName(),
      index: index2,
      select
    });
  }
  /**
   * Moves a node (tab or tabset) from one location to another
   * @param fromNodeId the id of the node to move
   * @param toNodeId the id of the node to receive the moved node
   * @param location the location where the moved node will be added, one of the DockLocation enum values.
   * @param index for docking to the center this value is the index of the tab, use -1 to add to the end.
   * @param select (optional) whether to select the moved tab(s) in new tabset, overriding autoSelectTab
   * @returns {Action} the action
   */
  static moveNode(fromNodeId, toNodeId, location, index2, select) {
    return new Action(Actions.MOVE_NODE, {
      fromNode: fromNodeId,
      toNode: toNodeId,
      location: location.getName(),
      index: index2,
      select
    });
  }
  /**
   * Deletes a tab node from the layout
   * @param tabNodeId the id of the tab node to delete
   * @returns {Action} the action
   */
  static deleteTab(tabNodeId) {
    return new Action(Actions.DELETE_TAB, { node: tabNodeId });
  }
  /**
   * Deletes a tabset node and all it's child tab nodes from the layout
   * @param tabsetNodeId the id of the tabset node to delete
   * @returns {Action} the action
   */
  static deleteTabset(tabsetNodeId) {
    return new Action(Actions.DELETE_TABSET, { node: tabsetNodeId });
  }
  /**
   * Change the given nodes tab text
   * @param tabNodeId the id of the node to rename
   * @param text the test of the tab
   * @returns {Action} the action
   */
  static renameTab(tabNodeId, text) {
    return new Action(Actions.RENAME_TAB, { node: tabNodeId, text });
  }
  /**
   * Selects the given tab in its parent tabset
   * @param tabNodeId the id of the node to set selected
   * @returns {Action} the action
   */
  static selectTab(tabNodeId) {
    return new Action(Actions.SELECT_TAB, { tabNode: tabNodeId });
  }
  /**
   * Set the given tabset node as the active tabset
   * @param tabsetNodeId the id of the tabset node to set as active
   * @returns {Action} the action
   */
  static setActiveTabset(tabsetNodeId, windowId) {
    return new Action(Actions.SET_ACTIVE_TABSET, { tabsetNode: tabsetNodeId, windowId });
  }
  /**
   * Adjust the weights of a row, used when the splitter is moved
   * @param nodeId the row node whose childrens weights are being adjusted
   * @param weights an array of weights to be applied to the children
   * @returns {Action} the action
   */
  static adjustWeights(nodeId, weights) {
    return new Action(Actions.ADJUST_WEIGHTS, { nodeId, weights });
  }
  static adjustBorderSplit(nodeId, pos) {
    return new Action(Actions.ADJUST_BORDER_SPLIT, { node: nodeId, pos });
  }
  /**
   * Maximizes the given tabset
   * @param tabsetNodeId the id of the tabset to maximize
   * @returns {Action} the action
   */
  static maximizeToggle(tabsetNodeId, windowId) {
    return new Action(Actions.MAXIMIZE_TOGGLE, { node: tabsetNodeId, windowId });
  }
  /**
   * Updates the global model jsone attributes
   * @param attributes the json for the model attributes to update (merge into the existing attributes)
   * @returns {Action} the action
   */
  static updateModelAttributes(attributes) {
    return new Action(Actions.UPDATE_MODEL_ATTRIBUTES, { json: attributes });
  }
  /**
   * Updates the given nodes json attributes
   * @param nodeId the id of the node to update
   * @param attributes the json attributes to update (merge with the existing attributes)
   * @returns {Action} the action
   */
  static updateNodeAttributes(nodeId, attributes) {
    return new Action(Actions.UPDATE_NODE_ATTRIBUTES, { node: nodeId, json: attributes });
  }
  /**
   * Pops out the given tab node into a new browser window
   * @param nodeId the tab node to popout
   * @returns
   */
  static popoutTab(nodeId) {
    return new Action(Actions.POPOUT_TAB, { node: nodeId });
  }
  /**
   * Pops out the given tab set node into a new browser window
   * @param nodeId the tab set node to popout
   * @returns
   */
  static popoutTabset(nodeId) {
    return new Action(Actions.POPOUT_TABSET, { node: nodeId });
  }
  /**
   * Closes the popout window
   * @param windowId the id of the popout window to close
   * @returns
   */
  static closeWindow(windowId) {
    return new Action(Actions.CLOSE_WINDOW, { windowId });
  }
  /**
   * Creates a new empty popout window with the given layout
   * @param layout the json layout for the new window
   * @param rect the window rectangle in screen coordinates
   * @returns
   */
  static createWindow(layout, rect) {
    return new Action(Actions.CREATE_WINDOW, { layout, rect });
  }
}
Actions.ADD_NODE = "FlexLayout_AddNode";
Actions.MOVE_NODE = "FlexLayout_MoveNode";
Actions.DELETE_TAB = "FlexLayout_DeleteTab";
Actions.DELETE_TABSET = "FlexLayout_DeleteTabset";
Actions.RENAME_TAB = "FlexLayout_RenameTab";
Actions.SELECT_TAB = "FlexLayout_SelectTab";
Actions.SET_ACTIVE_TABSET = "FlexLayout_SetActiveTabset";
Actions.ADJUST_WEIGHTS = "FlexLayout_AdjustWeights";
Actions.ADJUST_BORDER_SPLIT = "FlexLayout_AdjustBorderSplit";
Actions.MAXIMIZE_TOGGLE = "FlexLayout_MaximizeToggle";
Actions.UPDATE_MODEL_ATTRIBUTES = "FlexLayout_UpdateModelAttributes";
Actions.UPDATE_NODE_ATTRIBUTES = "FlexLayout_UpdateNodeAttributes";
Actions.POPOUT_TAB = "FlexLayout_PopoutTab";
Actions.POPOUT_TABSET = "FlexLayout_PopoutTabset";
Actions.CLOSE_WINDOW = "FlexLayout_CloseWindow";
Actions.CREATE_WINDOW = "FlexLayout_CreateWindow";
class Attribute {
  constructor(name, modelName, defaultValue, alwaysWriteJson) {
    this.name = name;
    this.alias = void 0;
    this.modelName = modelName;
    this.defaultValue = defaultValue;
    this.alwaysWriteJson = alwaysWriteJson;
    this.required = false;
    this.fixed = false;
    this.type = "any";
  }
  setType(value) {
    this.type = value;
    return this;
  }
  setAlias(value) {
    this.alias = value;
    return this;
  }
  setDescription(value) {
    this.description = value;
  }
  setRequired() {
    this.required = true;
    return this;
  }
  setFixed() {
    this.fixed = true;
    return this;
  }
  // sets modelAttr for nodes, and nodeAttr for model
  setpairedAttr(value) {
    this.pairedAttr = value;
  }
  setPairedType(value) {
    this.pairedType = value;
  }
}
Attribute.NUMBER = "number";
Attribute.STRING = "string";
Attribute.BOOLEAN = "boolean";
class AttributeDefinitions {
  constructor() {
    this.attributes = [];
    this.nameToAttribute = /* @__PURE__ */ new Map();
  }
  addWithAll(name, modelName, defaultValue, alwaysWriteJson) {
    const attr = new Attribute(name, modelName, defaultValue, alwaysWriteJson);
    this.attributes.push(attr);
    this.nameToAttribute.set(name, attr);
    return attr;
  }
  addInherited(name, modelName) {
    return this.addWithAll(name, modelName, void 0, false);
  }
  add(name, defaultValue, alwaysWriteJson) {
    return this.addWithAll(name, void 0, defaultValue, alwaysWriteJson);
  }
  getAttributes() {
    return this.attributes;
  }
  getModelName(name) {
    const conversion = this.nameToAttribute.get(name);
    if (conversion !== void 0) {
      return conversion.modelName;
    }
    return void 0;
  }
  toJson(jsonObj, obj) {
    for (const attr of this.attributes) {
      const fromValue = obj[attr.name];
      if (attr.alwaysWriteJson || fromValue !== attr.defaultValue) {
        jsonObj[attr.name] = fromValue;
      }
    }
  }
  fromJson(jsonObj, obj) {
    for (const attr of this.attributes) {
      let fromValue = jsonObj[attr.name];
      if (fromValue === void 0 && attr.alias) {
        fromValue = jsonObj[attr.alias];
      }
      if (fromValue === void 0) {
        obj[attr.name] = attr.defaultValue;
      } else {
        obj[attr.name] = fromValue;
      }
    }
  }
  update(jsonObj, obj) {
    for (const attr of this.attributes) {
      if (jsonObj.hasOwnProperty(attr.name)) {
        const fromValue = jsonObj[attr.name];
        if (fromValue === void 0) {
          delete obj[attr.name];
        } else {
          obj[attr.name] = fromValue;
        }
      }
    }
  }
  setDefaults(obj) {
    for (const attr of this.attributes) {
      obj[attr.name] = attr.defaultValue;
    }
  }
  pairAttributes(type, childAttributes) {
    for (const attr of childAttributes.attributes) {
      if (attr.modelName && this.nameToAttribute.has(attr.modelName)) {
        const pairedAttr = this.nameToAttribute.get(attr.modelName);
        pairedAttr.setpairedAttr(attr);
        attr.setpairedAttr(pairedAttr);
        pairedAttr.setPairedType(type);
      }
    }
  }
  toTypescriptInterface(name, parentAttributes) {
    var _a2, _b2;
    const lines = [];
    const sorted = this.attributes.sort((a, b) => a.name.localeCompare(b.name));
    lines.push("export interface I" + name + "Attributes {");
    for (let i = 0; i < sorted.length; i++) {
      const c = sorted[i];
      let type = c.type;
      let defaultValue = void 0;
      let attr = c;
      let inherited = void 0;
      if (attr.defaultValue !== void 0) {
        defaultValue = attr.defaultValue;
      } else if (attr.modelName !== void 0 && parentAttributes !== void 0 && parentAttributes.nameToAttribute.get(attr.modelName) !== void 0) {
        inherited = attr.modelName;
        attr = parentAttributes.nameToAttribute.get(inherited);
        defaultValue = attr.defaultValue;
        type = attr.type;
      }
      let defValue = JSON.stringify(defaultValue);
      const required = attr.required ? "" : "?";
      let sb2 = "	/**\n	  ";
      if (c.description) {
        sb2 += c.description;
      } else if (c.pairedType && ((_a2 = c.pairedAttr) === null || _a2 === void 0 ? void 0 : _a2.description)) {
        sb2 += `Value for ${c.pairedType} attribute ${c.pairedAttr.name} if not overridden`;
        sb2 += "\n\n	  ";
        sb2 += (_b2 = c.pairedAttr) === null || _b2 === void 0 ? void 0 : _b2.description;
      }
      sb2 += "\n\n	  ";
      if (c.fixed) {
        sb2 += `Fixed value: ${defValue}`;
      } else if (inherited) {
        sb2 += `Default: inherited from Global attribute ${c.modelName} (default ${defValue})`;
      } else {
        sb2 += `Default: ${defValue}`;
      }
      sb2 += "\n	 */";
      lines.push(sb2);
      lines.push("	" + c.name + required + ": " + type + ";\n");
    }
    lines.push("}");
    return lines.join("\n");
  }
}
class DropInfo {
  constructor(node, rect, location, index2, className) {
    this.node = node;
    this.rect = rect;
    this.location = location;
    this.index = index2;
    this.className = className;
  }
}
class BorderSet {
  /** @internal */
  static fromJson(json, model) {
    const borderSet = new BorderSet(model);
    borderSet.borders = json.map((borderJson) => BorderNode.fromJson(borderJson, model));
    for (const border of borderSet.borders) {
      borderSet.borderMap.set(border.getLocation(), border);
    }
    return borderSet;
  }
  /** @internal */
  constructor(_model) {
    this.borders = [];
    this.borderMap = /* @__PURE__ */ new Map();
    this.layoutHorizontal = true;
  }
  toJson() {
    return this.borders.map((borderNode) => borderNode.toJson());
  }
  /** @internal */
  getLayoutHorizontal() {
    return this.layoutHorizontal;
  }
  /** @internal */
  getBorders() {
    return this.borders;
  }
  /** @internal */
  getBorderMap() {
    return this.borderMap;
  }
  /** @internal */
  forEachNode(fn) {
    for (const borderNode of this.borders) {
      fn(borderNode, 0);
      for (const node of borderNode.getChildren()) {
        node.forEachNode(fn, 1);
      }
    }
  }
  /** @internal */
  setPaths() {
    for (const borderNode of this.borders) {
      const path = "/border/" + borderNode.getLocation().getName();
      borderNode.setPath(path);
      let i = 0;
      for (const node of borderNode.getChildren()) {
        node.setPath(path + "/t" + i);
        i++;
      }
    }
  }
  /** @internal */
  findDropTargetNode(dragNode, x2, y2) {
    for (const border of this.borders) {
      if (border.isShowing()) {
        const dropInfo = border.canDrop(dragNode, x2, y2);
        if (dropInfo !== void 0) {
          return dropInfo;
        }
      }
    }
    return void 0;
  }
}
let Node$1 = class Node2 {
  /** @internal */
  constructor(_model) {
    this.model = _model;
    this.attributes = {};
    this.children = [];
    this.rect = Rect.empty();
    this.listeners = /* @__PURE__ */ new Map();
    this.path = "";
  }
  getId() {
    let id2 = this.attributes.id;
    if (id2 !== void 0) {
      return id2;
    }
    id2 = this.model.nextUniqueId();
    this.setId(id2);
    return id2;
  }
  getModel() {
    return this.model;
  }
  getType() {
    return this.attributes.type;
  }
  getParent() {
    return this.parent;
  }
  getChildren() {
    return this.children;
  }
  getRect() {
    return this.rect;
  }
  getPath() {
    return this.path;
  }
  getOrientation() {
    if (this.parent === void 0) {
      return this.model.isRootOrientationVertical() ? Orientation.VERT : Orientation.HORZ;
    } else {
      return Orientation.flip(this.parent.getOrientation());
    }
  }
  // event can be: resize, visibility, maximize (on tabset), close
  setEventListener(event, callback2) {
    this.listeners.set(event, callback2);
  }
  removeEventListener(event) {
    this.listeners.delete(event);
  }
  /** @internal */
  setId(id2) {
    this.attributes.id = id2;
  }
  /** @internal */
  fireEvent(event, params) {
    if (this.listeners.has(event)) {
      this.listeners.get(event)(params);
    }
  }
  /** @internal */
  getAttr(name) {
    let val = this.attributes[name];
    if (val === void 0) {
      const modelName = this.getAttributeDefinitions().getModelName(name);
      if (modelName !== void 0) {
        val = this.model.getAttribute(modelName);
      }
    }
    return val;
  }
  /** @internal */
  forEachNode(fn, level) {
    fn(this, level);
    level++;
    for (const node of this.children) {
      node.forEachNode(fn, level);
    }
  }
  /** @internal */
  setPaths(path) {
    let i = 0;
    for (const node of this.children) {
      let newPath = path;
      if (node.getType() === "row") {
        if (node.getOrientation() === Orientation.VERT) {
          newPath += "/c" + i;
        } else {
          newPath += "/r" + i;
        }
      } else if (node.getType() === "tabset") {
        newPath += "/ts" + i;
      } else if (node.getType() === "tab") {
        newPath += "/t" + i;
      }
      node.path = newPath;
      node.setPaths(newPath);
      i++;
    }
  }
  /** @internal */
  setParent(parent) {
    this.parent = parent;
  }
  /** @internal */
  setRect(rect) {
    this.rect = rect;
  }
  /** @internal */
  setPath(path) {
    this.path = path;
  }
  /** @internal */
  setWeight(weight) {
    this.attributes.weight = weight;
  }
  /** @internal */
  setSelected(index2) {
    this.attributes.selected = index2;
  }
  /** @internal */
  findDropTargetNode(windowId, dragNode, x2, y2) {
    let rtn;
    if (this.rect.contains(x2, y2)) {
      if (this.model.getMaximizedTabset(windowId) !== void 0) {
        rtn = this.model.getMaximizedTabset(windowId).canDrop(dragNode, x2, y2);
      } else {
        rtn = this.canDrop(dragNode, x2, y2);
        if (rtn === void 0) {
          if (this.children.length !== 0) {
            for (const child of this.children) {
              rtn = child.findDropTargetNode(windowId, dragNode, x2, y2);
              if (rtn !== void 0) {
                break;
              }
            }
          }
        }
      }
    }
    return rtn;
  }
  /** @internal */
  canDrop(dragNode, x2, y2) {
    return void 0;
  }
  /** @internal */
  canDockInto(dragNode, dropInfo) {
    if (dropInfo != null) {
      if (dropInfo.location === DockLocation.CENTER && dropInfo.node.isEnableDrop() === false) {
        return false;
      }
      if (dropInfo.location === DockLocation.CENTER && dragNode.getType() === "tabset" && dragNode.getName() !== void 0) {
        return false;
      }
      if (dropInfo.location !== DockLocation.CENTER && dropInfo.node.isEnableDivide() === false) {
        return false;
      }
      if (this.model.getOnAllowDrop()) {
        return this.model.getOnAllowDrop()(dragNode, dropInfo);
      }
    }
    return true;
  }
  /** @internal */
  removeChild(childNode) {
    const pos = this.children.indexOf(childNode);
    if (pos !== -1) {
      this.children.splice(pos, 1);
    }
    return pos;
  }
  /** @internal */
  addChild(childNode, pos) {
    if (pos != null) {
      this.children.splice(pos, 0, childNode);
    } else {
      this.children.push(childNode);
      pos = this.children.length - 1;
    }
    childNode.parent = this;
    return pos;
  }
  /** @internal */
  removeAll() {
    this.children = [];
  }
  /** @internal */
  styleWithPosition(style2) {
    if (style2 == null) {
      style2 = {};
    }
    return this.rect.styleWithPosition(style2);
  }
  /** @internal */
  isEnableDivide() {
    return true;
  }
  /** @internal */
  toAttributeString() {
    return JSON.stringify(this.attributes, void 0, "	");
  }
};
class TabNode extends Node$1 {
  /** @internal */
  static fromJson(json, model, addToModel = true) {
    const newLayoutNode = new TabNode(model, json, addToModel);
    return newLayoutNode;
  }
  /** @internal */
  constructor(model, json, addToModel = true) {
    super(model);
    this.tabRect = Rect.empty();
    this.extra = {};
    this.moveableElement = null;
    this.tabStamp = null;
    this.rendered = false;
    this.visible = false;
    TabNode.attributeDefinitions.fromJson(json, this.attributes);
    if (addToModel === true) {
      model.addNode(this);
    }
  }
  getName() {
    return this.getAttr("name");
  }
  getHelpText() {
    return this.getAttr("helpText");
  }
  getComponent() {
    return this.getAttr("component");
  }
  getWindowId() {
    if (this.parent instanceof TabSetNode) {
      return this.parent.getWindowId();
    }
    return Model.MAIN_WINDOW_ID;
  }
  getWindow() {
    const layoutWindow = this.model.getwindowsMap().get(this.getWindowId());
    if (layoutWindow) {
      return layoutWindow.window;
    }
    return void 0;
  }
  /**
   * Returns the config attribute that can be used to store node specific data that
   * WILL be saved to the json. The config attribute should be changed via the action Actions.updateNodeAttributes rather
   * than directly, for example:
   * this.state.model.doAction(
   *   FlexLayout.Actions.updateNodeAttributes(node.getId(), {config:myConfigObject}));
   */
  getConfig() {
    return this.attributes.config;
  }
  /**
   * Returns an object that can be used to store transient node specific data that will
   * NOT be saved in the json.
   */
  getExtraData() {
    return this.extra;
  }
  isPoppedOut() {
    return this.getWindowId() !== Model.MAIN_WINDOW_ID;
  }
  isSelected() {
    return this.getParent().getSelectedNode() === this;
  }
  getIcon() {
    return this.getAttr("icon");
  }
  isEnableClose() {
    return this.getAttr("enableClose");
  }
  getCloseType() {
    return this.getAttr("closeType");
  }
  isEnablePopout() {
    return this.getAttr("enablePopout");
  }
  isEnablePopoutIcon() {
    return this.getAttr("enablePopoutIcon");
  }
  isEnablePopoutOverlay() {
    return this.getAttr("enablePopoutOverlay");
  }
  isEnableDrag() {
    return this.getAttr("enableDrag");
  }
  isEnableRename() {
    return this.getAttr("enableRename");
  }
  isEnableWindowReMount() {
    return this.getAttr("enableWindowReMount");
  }
  getClassName() {
    return this.getAttr("className");
  }
  getContentClassName() {
    return this.getAttr("contentClassName");
  }
  getTabSetClassName() {
    return this.getAttr("tabsetClassName");
  }
  isEnableRenderOnDemand() {
    return this.getAttr("enableRenderOnDemand");
  }
  getMinWidth() {
    return this.getAttr("minWidth");
  }
  getMinHeight() {
    return this.getAttr("minHeight");
  }
  getMaxWidth() {
    return this.getAttr("maxWidth");
  }
  getMaxHeight() {
    return this.getAttr("maxHeight");
  }
  toJson() {
    const json = {};
    TabNode.attributeDefinitions.toJson(json, this.attributes);
    return json;
  }
  /** @internal */
  saveScrollPosition() {
    if (this.moveableElement) {
      this.scrollLeft = this.moveableElement.scrollLeft;
      this.scrollTop = this.moveableElement.scrollTop;
    }
  }
  /** @internal */
  restoreScrollPosition() {
    if (this.scrollTop) {
      requestAnimationFrame(() => {
        if (this.moveableElement) {
          if (this.scrollTop) {
            this.moveableElement.scrollTop = this.scrollTop;
            this.moveableElement.scrollLeft = this.scrollLeft;
          }
        }
      });
    }
  }
  /** @internal */
  setRect(rect) {
    if (!rect.equals(this.rect)) {
      this.fireEvent("resize", { rect });
      this.rect = rect;
    }
  }
  /** @internal */
  setVisible(visible) {
    if (visible !== this.visible) {
      this.fireEvent("visibility", { visible });
      this.visible = visible;
    }
  }
  /** @internal */
  getScrollTop() {
    return this.scrollTop;
  }
  /** @internal */
  setScrollTop(scrollTop) {
    this.scrollTop = scrollTop;
  }
  /** @internal */
  getScrollLeft() {
    return this.scrollLeft;
  }
  /** @internal */
  setScrollLeft(scrollLeft) {
    this.scrollLeft = scrollLeft;
  }
  /** @internal */
  isRendered() {
    return this.rendered;
  }
  /** @internal */
  setRendered(rendered) {
    this.rendered = rendered;
  }
  /** @internal */
  getTabRect() {
    return this.tabRect;
  }
  /** @internal */
  setTabRect(rect) {
    this.tabRect = rect;
  }
  /** @internal */
  getTabStamp() {
    return this.tabStamp;
  }
  /** @internal */
  setTabStamp(stamp) {
    this.tabStamp = stamp;
  }
  /** @internal */
  getMoveableElement() {
    return this.moveableElement;
  }
  /** @internal */
  setMoveableElement(element) {
    this.moveableElement = element;
  }
  /** @internal */
  setRenderedName(name) {
    this.renderedName = name;
  }
  /** @internal */
  getNameForOverflowMenu() {
    const altName = this.getAttr("altName");
    if (altName !== void 0) {
      return altName;
    }
    return this.renderedName;
  }
  /** @internal */
  setName(name) {
    this.attributes.name = name;
  }
  /** @internal */
  delete() {
    this.parent.remove(this);
    this.fireEvent("close", {});
  }
  /** @internal */
  updateAttrs(json) {
    TabNode.attributeDefinitions.update(json, this.attributes);
  }
  /** @internal */
  getAttributeDefinitions() {
    return TabNode.attributeDefinitions;
  }
  /** @internal */
  setBorderWidth(width) {
    this.attributes.borderWidth = width;
  }
  /** @internal */
  setBorderHeight(height) {
    this.attributes.borderHeight = height;
  }
  /** @internal */
  static getAttributeDefinitions() {
    return TabNode.attributeDefinitions;
  }
  /** @internal */
  static createAttributeDefinitions() {
    const attributeDefinitions = new AttributeDefinitions();
    attributeDefinitions.add("type", TabNode.TYPE, true).setType(Attribute.STRING).setFixed();
    attributeDefinitions.add("id", void 0).setType(Attribute.STRING).setDescription(`the unique id of the tab, if left undefined a uuid will be assigned`);
    attributeDefinitions.add("name", "[Unnamed Tab]").setType(Attribute.STRING).setDescription(`name of tab to be displayed in the tab button`);
    attributeDefinitions.add("altName", void 0).setType(Attribute.STRING).setDescription(`if there is no name specifed then this value will be used in the overflow menu`);
    attributeDefinitions.add("helpText", void 0).setType(Attribute.STRING).setDescription(`An optional help text for the tab to be displayed upon tab hover.`);
    attributeDefinitions.add("component", void 0).setType(Attribute.STRING).setDescription(`string identifying which component to run (for factory)`);
    attributeDefinitions.add("config", void 0).setType("any").setDescription(`a place to hold json config for the hosted component`);
    attributeDefinitions.add("tabsetClassName", void 0).setType(Attribute.STRING).setDescription(`class applied to parent tabset when this is the only tab and it is stretched to fill the tabset`);
    attributeDefinitions.add("enableWindowReMount", false).setType(Attribute.BOOLEAN).setDescription(`if enabled the tab will re-mount when popped out/in`);
    attributeDefinitions.addInherited("enableClose", "tabEnableClose").setType(Attribute.BOOLEAN).setDescription(`allow user to close tab via close button`);
    attributeDefinitions.addInherited("closeType", "tabCloseType").setType("ICloseType").setDescription(`see values in ICloseType`);
    attributeDefinitions.addInherited("enableDrag", "tabEnableDrag").setType(Attribute.BOOLEAN).setDescription(`allow user to drag tab to new location`);
    attributeDefinitions.addInherited("enableRename", "tabEnableRename").setType(Attribute.BOOLEAN).setDescription(`allow user to rename tabs by double clicking`);
    attributeDefinitions.addInherited("className", "tabClassName").setType(Attribute.STRING).setDescription(`class applied to tab button`);
    attributeDefinitions.addInherited("contentClassName", "tabContentClassName").setType(Attribute.STRING).setDescription(`class applied to tab content`);
    attributeDefinitions.addInherited("icon", "tabIcon").setType(Attribute.STRING).setDescription(`the tab icon`);
    attributeDefinitions.addInherited("enableRenderOnDemand", "tabEnableRenderOnDemand").setType(Attribute.BOOLEAN).setDescription(`whether to avoid rendering component until tab is visible`);
    attributeDefinitions.addInherited("enablePopout", "tabEnablePopout").setType(Attribute.BOOLEAN).setAlias("enableFloat").setDescription(`enable popout (in popout capable browser)`);
    attributeDefinitions.addInherited("enablePopoutIcon", "tabEnablePopoutIcon").setType(Attribute.BOOLEAN).setDescription(`whether to show the popout icon in the tabset header if this tab enables popouts`);
    attributeDefinitions.addInherited("enablePopoutOverlay", "tabEnablePopoutOverlay").setType(Attribute.BOOLEAN).setDescription(`if this tab will not work correctly in a popout window when the main window is backgrounded (inactive)
            then enabling this option will gray out this tab`);
    attributeDefinitions.addInherited("borderWidth", "tabBorderWidth").setType(Attribute.NUMBER).setDescription(`width when added to border, -1 will use border size`);
    attributeDefinitions.addInherited("borderHeight", "tabBorderHeight").setType(Attribute.NUMBER).setDescription(`height when added to border, -1 will use border size`);
    attributeDefinitions.addInherited("minWidth", "tabMinWidth").setType(Attribute.NUMBER).setDescription(`the min width of this tab`);
    attributeDefinitions.addInherited("minHeight", "tabMinHeight").setType(Attribute.NUMBER).setDescription(`the min height of this tab`);
    attributeDefinitions.addInherited("maxWidth", "tabMaxWidth").setType(Attribute.NUMBER).setDescription(`the max width of this tab`);
    attributeDefinitions.addInherited("maxHeight", "tabMaxHeight").setType(Attribute.NUMBER).setDescription(`the max height of this tab`);
    return attributeDefinitions;
  }
}
TabNode.TYPE = "tab";
TabNode.attributeDefinitions = TabNode.createAttributeDefinitions();
function isDesktop() {
  const desktop = typeof window !== "undefined" && window.matchMedia && window.matchMedia("(hover: hover) and (pointer: fine)").matches;
  return desktop;
}
function getRenderStateEx(layout, node, iconAngle) {
  let leadingContent = void 0;
  let titleContent = node.getName();
  let name = node.getName();
  if (iconAngle === void 0) {
    iconAngle = 0;
  }
  if (leadingContent === void 0 && node.getIcon() !== void 0) {
    if (iconAngle !== 0) {
      leadingContent = reactExports.createElement("img", { style: { width: "1em", height: "1em", transform: "rotate(" + iconAngle + "deg)" }, src: node.getIcon(), alt: "leadingContent" });
    } else {
      leadingContent = reactExports.createElement("img", { style: { width: "1em", height: "1em" }, src: node.getIcon(), alt: "leadingContent" });
    }
  }
  let buttons = [];
  const renderState = { leading: leadingContent, content: titleContent, name, buttons };
  layout.customizeTab(node, renderState);
  node.setRenderedName(renderState.name);
  return renderState;
}
function isAuxMouseEvent(event) {
  let auxEvent = false;
  if (event.nativeEvent instanceof MouseEvent) {
    if (event.nativeEvent.button !== 0 || event.ctrlKey || event.altKey || event.metaKey || event.shiftKey) {
      auxEvent = true;
    }
  }
  return auxEvent;
}
function enablePointerOnIFrames(enable, currentDocument) {
  const iframes = [
    ...getElementsByTagName("iframe", currentDocument),
    ...getElementsByTagName("webview", currentDocument)
  ];
  for (const iframe of iframes) {
    iframe.style.pointerEvents = enable ? "auto" : "none";
  }
}
function getElementsByTagName(tag, currentDocument) {
  return [...currentDocument.getElementsByTagName(tag)];
}
function startDrag(doc, event, drag, dragEnd, dragCancel) {
  event.preventDefault();
  const pointerMove = (ev) => {
    ev.preventDefault();
    drag(ev.clientX, ev.clientY);
  };
  const pointerCancel = (ev) => {
    ev.preventDefault();
    dragCancel();
  };
  const pointerUp = () => {
    doc.removeEventListener("pointermove", pointerMove);
    doc.removeEventListener("pointerup", pointerUp);
    doc.removeEventListener("pointercancel", pointerCancel);
    dragEnd();
  };
  doc.addEventListener("pointermove", pointerMove);
  doc.addEventListener("pointerup", pointerUp);
  doc.addEventListener("pointercancel", pointerCancel);
}
function canDockToWindow(node) {
  if (node instanceof TabNode) {
    return node.isEnablePopout();
  } else if (node instanceof TabSetNode) {
    for (const child of node.getChildren()) {
      if (child.isEnablePopout() === false) {
        return false;
      }
    }
    return true;
  }
  return false;
}
function keepOnScreen(rect) {
  rect.snap(10);
  const availableScreenWidth = window.screen.availWidth;
  const availableScreenHeight = window.screen.availHeight;
  if (rect.x + rect.width > availableScreenWidth || rect.y + rect.height > availableScreenHeight) {
    rect.x = Math.max(0, Math.min(rect.x, availableScreenWidth - rect.width));
    rect.y = Math.max(0, Math.min(rect.y, availableScreenHeight - rect.height));
  }
  return rect;
}
function isOnScreen(rect) {
  const availableScreenWidth = window.screen.availWidth;
  const availableScreenHeight = window.screen.availHeight;
  return rect.x >= 0 && rect.getRight() <= availableScreenWidth && rect.y >= 0 || rect.getBottom() <= availableScreenHeight;
}
function copyInlineStyles(source, target) {
  const sourceStyle = source.getAttribute("style");
  const targetStyle = target.getAttribute("style");
  if (sourceStyle === targetStyle)
    return false;
  if (sourceStyle) {
    target.setAttribute("style", sourceStyle);
  } else {
    target.removeAttribute("style");
  }
  return true;
}
function isSafari$1() {
  const userAgent = navigator.userAgent;
  return userAgent.includes("Safari") && !userAgent.includes("Chrome") && !userAgent.includes("Chromium");
}
function adjustSelectedIndex(parent, removedIndex) {
  if (parent !== void 0 && (parent instanceof TabSetNode || parent instanceof BorderNode)) {
    const selectedIndex = parent.getSelected();
    if (selectedIndex !== -1) {
      if (removedIndex === selectedIndex && parent.getChildren().length > 0) {
        if (removedIndex >= parent.getChildren().length) {
          parent.setSelected(parent.getChildren().length - 1);
        }
      } else if (removedIndex < selectedIndex) {
        parent.setSelected(selectedIndex - 1);
      } else if (removedIndex > selectedIndex)
        ;
      else {
        parent.setSelected(-1);
      }
    }
  }
}
function randomUUID$1() {
  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) => (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16));
}
class TabSetNode extends Node$1 {
  /** @internal */
  static fromJson(json, model, layoutWindow) {
    const newLayoutNode = new TabSetNode(model, json);
    if (json.children != null) {
      for (const jsonChild of json.children) {
        const child = TabNode.fromJson(jsonChild, model);
        newLayoutNode.addChild(child);
      }
    }
    if (newLayoutNode.children.length === 0) {
      newLayoutNode.setSelected(-1);
    }
    if (json.maximized && json.maximized === true) {
      layoutWindow.maximizedTabSet = newLayoutNode;
    }
    if (json.active && json.active === true) {
      layoutWindow.activeTabSet = newLayoutNode;
    }
    return newLayoutNode;
  }
  /** @internal */
  constructor(model, json) {
    super(model);
    this.tabStripRect = Rect.empty();
    this.contentRect = Rect.empty();
    this.calculatedMinHeight = 0;
    this.calculatedMinWidth = 0;
    this.calculatedMaxHeight = 0;
    this.calculatedMaxWidth = 0;
    TabSetNode.attributeDefinitions.fromJson(json, this.attributes);
    model.addNode(this);
  }
  getName() {
    return this.getAttr("name");
  }
  isEnableActiveIcon() {
    return this.getAttr("enableActiveIcon");
  }
  getSelected() {
    const selected = this.attributes.selected;
    if (selected !== void 0) {
      return selected;
    }
    return -1;
  }
  getSelectedNode() {
    const selected = this.getSelected();
    if (selected !== -1) {
      return this.children[selected];
    }
    return void 0;
  }
  getWeight() {
    return this.getAttr("weight");
  }
  getAttrMinWidth() {
    return this.getAttr("minWidth");
  }
  getAttrMinHeight() {
    return this.getAttr("minHeight");
  }
  getMinWidth() {
    return this.calculatedMinWidth;
  }
  getMinHeight() {
    return this.calculatedMinHeight;
  }
  /** @internal */
  getMinSize(orientation) {
    if (orientation === Orientation.HORZ) {
      return this.getMinWidth();
    } else {
      return this.getMinHeight();
    }
  }
  getAttrMaxWidth() {
    return this.getAttr("maxWidth");
  }
  getAttrMaxHeight() {
    return this.getAttr("maxHeight");
  }
  getMaxWidth() {
    return this.calculatedMaxWidth;
  }
  getMaxHeight() {
    return this.calculatedMaxHeight;
  }
  /** @internal */
  getMaxSize(orientation) {
    if (orientation === Orientation.HORZ) {
      return this.getMaxWidth();
    } else {
      return this.getMaxHeight();
    }
  }
  /**
   * Returns the config attribute that can be used to store node specific data that
   * WILL be saved to the json. The config attribute should be changed via the action Actions.updateNodeAttributes rather
   * than directly, for example:
   * this.state.model.doAction(
   *   FlexLayout.Actions.updateNodeAttributes(node.getId(), {config:myConfigObject}));
   */
  getConfig() {
    return this.attributes.config;
  }
  isMaximized() {
    return this.model.getMaximizedTabset(this.getWindowId()) === this;
  }
  isActive() {
    return this.model.getActiveTabset(this.getWindowId()) === this;
  }
  isEnableDeleteWhenEmpty() {
    return this.getAttr("enableDeleteWhenEmpty");
  }
  isEnableDrop() {
    return this.getAttr("enableDrop");
  }
  isEnableTabWrap() {
    return this.getAttr("enableTabWrap");
  }
  isEnableDrag() {
    return this.getAttr("enableDrag");
  }
  isEnableDivide() {
    return this.getAttr("enableDivide");
  }
  isEnableMaximize() {
    return this.getAttr("enableMaximize");
  }
  isEnableClose() {
    return this.getAttr("enableClose");
  }
  isEnableSingleTabStretch() {
    return this.getAttr("enableSingleTabStretch");
  }
  isEnableTabStrip() {
    return this.getAttr("enableTabStrip");
  }
  isAutoSelectTab() {
    return this.getAttr("autoSelectTab");
  }
  getClassNameTabStrip() {
    return this.getAttr("classNameTabStrip");
  }
  getTabLocation() {
    return this.getAttr("tabLocation");
  }
  toJson() {
    const json = {};
    TabSetNode.attributeDefinitions.toJson(json, this.attributes);
    json.children = this.children.map((child) => child.toJson());
    if (this.isActive()) {
      json.active = true;
    }
    if (this.isMaximized()) {
      json.maximized = true;
    }
    return json;
  }
  /** @internal */
  calcMinMaxSize() {
    this.calculatedMinHeight = this.getAttrMinHeight();
    this.calculatedMinWidth = this.getAttrMinWidth();
    this.calculatedMaxHeight = this.getAttrMaxHeight();
    this.calculatedMaxWidth = this.getAttrMaxWidth();
    for (const child of this.children) {
      const c = child;
      this.calculatedMinWidth = Math.max(this.calculatedMinWidth, c.getMinWidth());
      this.calculatedMinHeight = Math.max(this.calculatedMinHeight, c.getMinHeight());
      this.calculatedMaxWidth = Math.min(this.calculatedMaxWidth, c.getMaxWidth());
      this.calculatedMaxHeight = Math.min(this.calculatedMaxHeight, c.getMaxHeight());
    }
  }
  /** @internal */
  canMaximize() {
    if (this.isEnableMaximize()) {
      if (this.getModel().getMaximizedTabset(this.getWindowId()) === this) {
        return true;
      }
      if (this.getParent() === this.getModel().getRoot(this.getWindowId()) && this.getModel().getRoot(this.getWindowId()).getChildren().length === 1) {
        return false;
      }
      return true;
    }
    return false;
  }
  /** @internal */
  setContentRect(rect) {
    this.contentRect = rect;
  }
  /** @internal */
  getContentRect() {
    return this.contentRect;
  }
  /** @internal */
  setTabStripRect(rect) {
    this.tabStripRect = rect;
  }
  /** @internal */
  setWeight(weight) {
    this.attributes.weight = weight;
  }
  /** @internal */
  setSelected(index2) {
    this.attributes.selected = index2;
  }
  getWindowId() {
    return this.parent.getWindowId();
  }
  /** @internal */
  canDrop(dragNode, x2, y2) {
    let dropInfo;
    if (dragNode === this) {
      const dockLocation = DockLocation.CENTER;
      const outlineRect = this.tabStripRect;
      dropInfo = new DropInfo(this, outlineRect, dockLocation, -1, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
    } else if (this.getWindowId() !== Model.MAIN_WINDOW_ID && !canDockToWindow(dragNode)) {
      return void 0;
    } else if (this.contentRect.contains(x2, y2)) {
      let dockLocation = DockLocation.CENTER;
      if (this.model.getMaximizedTabset(this.parent.getWindowId()) === void 0) {
        dockLocation = DockLocation.getLocation(this.contentRect, x2, y2);
      }
      const outlineRect = dockLocation.getDockRect(this.rect);
      dropInfo = new DropInfo(this, outlineRect, dockLocation, -1, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
    } else if (this.tabStripRect != null && this.tabStripRect.contains(x2, y2)) {
      let r2;
      let yy;
      let h;
      if (this.children.length === 0) {
        r2 = this.tabStripRect.clone();
        yy = r2.y + 3;
        h = r2.height - 4;
        r2.width = 2;
      } else {
        let child = this.children[0];
        r2 = child.getTabRect();
        yy = r2.y;
        h = r2.height;
        let p2 = this.tabStripRect.x;
        let childCenter = 0;
        for (let i = 0; i < this.children.length; i++) {
          child = this.children[i];
          r2 = child.getTabRect();
          if (r2.y !== yy) {
            yy = r2.y;
            p2 = this.tabStripRect.x;
          }
          childCenter = r2.x + r2.width / 2;
          if (x2 >= p2 && x2 < childCenter && y2 > r2.y && y2 < r2.getBottom()) {
            const dockLocation = DockLocation.CENTER;
            const outlineRect = new Rect(r2.x - 2, r2.y, 3, r2.height);
            dropInfo = new DropInfo(this, outlineRect, dockLocation, i, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
            break;
          }
          p2 = childCenter;
        }
      }
      if (dropInfo == null) {
        const dockLocation = DockLocation.CENTER;
        const outlineRect = new Rect(r2.getRight() - 2, yy, 3, h);
        dropInfo = new DropInfo(this, outlineRect, dockLocation, this.children.length, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
      }
    }
    if (!dragNode.canDockInto(dragNode, dropInfo)) {
      return void 0;
    }
    return dropInfo;
  }
  /** @internal */
  delete() {
    this.parent.removeChild(this);
  }
  /** @internal */
  remove(node) {
    const removedIndex = this.removeChild(node);
    this.model.tidy();
    adjustSelectedIndex(this, removedIndex);
  }
  /** @internal */
  drop(dragNode, location, index2, select) {
    const dockLocation = location;
    if (this === dragNode) {
      return;
    }
    let dragParent = dragNode.getParent();
    let fromIndex = 0;
    if (dragParent !== void 0) {
      fromIndex = dragParent.removeChild(dragNode);
      if (dragParent instanceof BorderNode && dragParent.getSelected() === fromIndex) {
        dragParent.setSelected(-1);
      } else {
        adjustSelectedIndex(dragParent, fromIndex);
      }
    }
    if (dragNode instanceof TabNode && dragParent === this && fromIndex < index2 && index2 > 0) {
      index2--;
    }
    if (dockLocation === DockLocation.CENTER) {
      let insertPos = index2;
      if (insertPos === -1) {
        insertPos = this.children.length;
      }
      if (dragNode instanceof TabNode) {
        this.addChild(dragNode, insertPos);
        if (select || select !== false && this.isAutoSelectTab()) {
          this.setSelected(insertPos);
        }
      } else if (dragNode instanceof RowNode$1) {
        dragNode.forEachNode((child, level) => {
          if (child instanceof TabNode) {
            this.addChild(child, insertPos);
            insertPos++;
          }
        }, 0);
      } else {
        for (let i = 0; i < dragNode.getChildren().length; i++) {
          const child = dragNode.getChildren()[i];
          this.addChild(child, insertPos);
          insertPos++;
        }
        if (this.getSelected() === -1 && this.children.length > 0) {
          this.setSelected(0);
        }
      }
      this.model.setActiveTabset(this, this.parent.getWindowId());
    } else {
      let moveNode = dragNode;
      if (dragNode instanceof TabNode) {
        const callback2 = this.model.getOnCreateTabSet();
        moveNode = new TabSetNode(this.model, callback2 ? callback2(dragNode) : {});
        moveNode.addChild(dragNode);
        dragParent = moveNode;
      } else if (dragNode instanceof RowNode$1) {
        const parent = this.getParent();
        if (dragNode.getOrientation() === parent.getOrientation() && (location.getOrientation() === parent.getOrientation() || location === DockLocation.CENTER)) {
          const node = new RowNode$1(this.model, this.getWindowId(), {});
          node.addChild(dragNode);
          moveNode = node;
        }
      } else {
        moveNode = dragNode;
      }
      const parentRow = this.parent;
      const pos = parentRow.getChildren().indexOf(this);
      if (parentRow.getOrientation() === dockLocation.orientation) {
        moveNode.setWeight(this.getWeight() / 2);
        this.setWeight(this.getWeight() / 2);
        parentRow.addChild(moveNode, pos + dockLocation.indexPlus);
      } else {
        const newRow = new RowNode$1(this.model, this.getWindowId(), {});
        newRow.setWeight(this.getWeight());
        newRow.addChild(this);
        this.setWeight(50);
        moveNode.setWeight(50);
        newRow.addChild(moveNode, dockLocation.indexPlus);
        parentRow.removeChild(this);
        parentRow.addChild(newRow, pos);
      }
      if (moveNode instanceof TabSetNode) {
        this.model.setActiveTabset(moveNode, this.getWindowId());
      }
    }
    this.model.tidy();
  }
  /** @internal */
  updateAttrs(json) {
    TabSetNode.attributeDefinitions.update(json, this.attributes);
  }
  /** @internal */
  getAttributeDefinitions() {
    return TabSetNode.attributeDefinitions;
  }
  /** @internal */
  static getAttributeDefinitions() {
    return TabSetNode.attributeDefinitions;
  }
  /** @internal */
  static createAttributeDefinitions() {
    const attributeDefinitions = new AttributeDefinitions();
    attributeDefinitions.add("type", TabSetNode.TYPE, true).setType(Attribute.STRING).setFixed();
    attributeDefinitions.add("id", void 0).setType(Attribute.STRING).setDescription(`the unique id of the tab set, if left undefined a uuid will be assigned`);
    attributeDefinitions.add("weight", 100).setType(Attribute.NUMBER).setDescription(`relative weight for sizing of this tabset in parent row`);
    attributeDefinitions.add("selected", 0).setType(Attribute.NUMBER).setDescription(`index of selected/visible tab in tabset`);
    attributeDefinitions.add("name", void 0).setType(Attribute.STRING);
    attributeDefinitions.add("config", void 0).setType("any").setDescription(`a place to hold json config used in your own code`);
    attributeDefinitions.addInherited("enableDeleteWhenEmpty", "tabSetEnableDeleteWhenEmpty").setDescription(`whether to delete this tabset when is has no tabs`);
    attributeDefinitions.addInherited("enableDrop", "tabSetEnableDrop").setDescription(`allow user to drag tabs into this tabset`);
    attributeDefinitions.addInherited("enableDrag", "tabSetEnableDrag").setDescription(`allow user to drag tabs out this tabset`);
    attributeDefinitions.addInherited("enableDivide", "tabSetEnableDivide").setDescription(`allow user to drag tabs to region of this tabset, splitting into new tabset`);
    attributeDefinitions.addInherited("enableMaximize", "tabSetEnableMaximize").setDescription(`allow user to maximize tabset to fill view via maximize button`);
    attributeDefinitions.addInherited("enableClose", "tabSetEnableClose").setDescription(`allow user to close tabset via a close button`);
    attributeDefinitions.addInherited("enableSingleTabStretch", "tabSetEnableSingleTabStretch").setDescription(`if the tabset has only a single tab then stretch the single tab to fill area and display in a header style`);
    attributeDefinitions.addInherited("classNameTabStrip", "tabSetClassNameTabStrip").setDescription(`a class name to apply to the tab strip`);
    attributeDefinitions.addInherited("enableTabStrip", "tabSetEnableTabStrip").setDescription(`enable tab strip and allow multiple tabs in this tabset`);
    attributeDefinitions.addInherited("minWidth", "tabSetMinWidth").setDescription(`minimum width (in px) for this tabset`);
    attributeDefinitions.addInherited("minHeight", "tabSetMinHeight").setDescription(`minimum height (in px) for this tabset`);
    attributeDefinitions.addInherited("maxWidth", "tabSetMaxWidth").setDescription(`maximum width (in px) for this tabset`);
    attributeDefinitions.addInherited("maxHeight", "tabSetMaxHeight").setDescription(`maximum height (in px) for this tabset`);
    attributeDefinitions.addInherited("enableTabWrap", "tabSetEnableTabWrap").setDescription(`show tabs in location top or bottom`);
    attributeDefinitions.addInherited("tabLocation", "tabSetTabLocation").setDescription(`the location of the tabs either top or bottom`);
    attributeDefinitions.addInherited("autoSelectTab", "tabSetAutoSelectTab").setType(Attribute.BOOLEAN).setDescription(`whether to select new/moved tabs in tabset`);
    attributeDefinitions.addInherited("enableActiveIcon", "tabSetEnableActiveIcon").setType(Attribute.BOOLEAN).setDescription(`whether the active icon (*) should be displayed when the tabset is active`);
    return attributeDefinitions;
  }
}
TabSetNode.TYPE = "tabset";
TabSetNode.attributeDefinitions = TabSetNode.createAttributeDefinitions();
let RowNode$1 = class RowNode extends Node$1 {
  /** @internal */
  static fromJson(json, model, layoutWindow) {
    const newLayoutNode = new RowNode(model, layoutWindow.windowId, json);
    if (json.children != null) {
      for (const jsonChild of json.children) {
        if (jsonChild.type === TabSetNode.TYPE) {
          const child = TabSetNode.fromJson(jsonChild, model, layoutWindow);
          newLayoutNode.addChild(child);
        } else {
          const child = RowNode.fromJson(jsonChild, model, layoutWindow);
          newLayoutNode.addChild(child);
        }
      }
    }
    return newLayoutNode;
  }
  /** @internal */
  constructor(model, windowId, json) {
    super(model);
    this.windowId = windowId;
    this.minHeight = DefaultMin;
    this.minWidth = DefaultMin;
    this.maxHeight = DefaultMax;
    this.maxWidth = DefaultMax;
    RowNode.attributeDefinitions.fromJson(json, this.attributes);
    this.normalizeWeights();
    model.addNode(this);
  }
  getWeight() {
    return this.attributes.weight;
  }
  toJson() {
    const json = {};
    RowNode.attributeDefinitions.toJson(json, this.attributes);
    json.children = [];
    for (const child of this.children) {
      json.children.push(child.toJson());
    }
    return json;
  }
  /** @internal */
  getWindowId() {
    return this.windowId;
  }
  setWindowId(windowId) {
    this.windowId = windowId;
  }
  /** @internal */
  setWeight(weight) {
    this.attributes.weight = weight;
  }
  /** @internal */
  getSplitterBounds(index2) {
    const h = this.getOrientation() === Orientation.HORZ;
    const c = this.getChildren();
    const ss = this.model.getSplitterSize();
    const fr = c[0].getRect();
    const lr = c[c.length - 1].getRect();
    let p2 = h ? [fr.x, lr.getRight()] : [fr.y, lr.getBottom()];
    const q2 = h ? [fr.x, lr.getRight()] : [fr.y, lr.getBottom()];
    for (let i = 0; i < index2; i++) {
      const n2 = c[i];
      p2[0] += h ? n2.getMinWidth() : n2.getMinHeight();
      q2[0] += h ? n2.getMaxWidth() : n2.getMaxHeight();
      if (i > 0) {
        p2[0] += ss;
        q2[0] += ss;
      }
    }
    for (let i = c.length - 1; i >= index2; i--) {
      const n2 = c[i];
      p2[1] -= (h ? n2.getMinWidth() : n2.getMinHeight()) + ss;
      q2[1] -= (h ? n2.getMaxWidth() : n2.getMaxHeight()) + ss;
    }
    p2 = [Math.max(q2[1], p2[0]), Math.min(q2[0], p2[1])];
    return p2;
  }
  /** @internal */
  getSplitterInitials(index2) {
    const h = this.getOrientation() === Orientation.HORZ;
    const c = this.getChildren();
    const ss = this.model.getSplitterSize();
    const initialSizes = [];
    let sum2 = 0;
    for (let i = 0; i < c.length; i++) {
      const n2 = c[i];
      const r2 = n2.getRect();
      const s2 = h ? r2.width : r2.height;
      initialSizes.push(s2);
      sum2 += s2;
    }
    const startRect = c[index2].getRect();
    const startPosition = (h ? startRect.x : startRect.y) - ss;
    return { initialSizes, sum: sum2, startPosition };
  }
  /** @internal */
  calculateSplit(index2, splitterPos, initialSizes, sum2, startPosition) {
    const h = this.getOrientation() === Orientation.HORZ;
    const c = this.getChildren();
    const sn = c[index2];
    const smax = h ? sn.getMaxWidth() : sn.getMaxHeight();
    const sizes = [...initialSizes];
    if (splitterPos < startPosition) {
      let shift = startPosition - splitterPos;
      let altShift = 0;
      if (sizes[index2] + shift > smax) {
        altShift = sizes[index2] + shift - smax;
        sizes[index2] = smax;
      } else {
        sizes[index2] += shift;
      }
      for (let i = index2 - 1; i >= 0; i--) {
        const n2 = c[i];
        const m2 = h ? n2.getMinWidth() : n2.getMinHeight();
        if (sizes[i] - shift > m2) {
          sizes[i] -= shift;
          break;
        } else {
          shift -= sizes[i] - m2;
          sizes[i] = m2;
        }
      }
      for (let i = index2 + 1; i < c.length; i++) {
        const n2 = c[i];
        const m2 = h ? n2.getMaxWidth() : n2.getMaxHeight();
        if (sizes[i] + altShift < m2) {
          sizes[i] += altShift;
          break;
        } else {
          altShift -= m2 - sizes[i];
          sizes[i] = m2;
        }
      }
    } else {
      let shift = splitterPos - startPosition;
      let altShift = 0;
      if (sizes[index2 - 1] + shift > smax) {
        altShift = sizes[index2 - 1] + shift - smax;
        sizes[index2 - 1] = smax;
      } else {
        sizes[index2 - 1] += shift;
      }
      for (let i = index2; i < c.length; i++) {
        const n2 = c[i];
        const m2 = h ? n2.getMinWidth() : n2.getMinHeight();
        if (sizes[i] - shift > m2) {
          sizes[i] -= shift;
          break;
        } else {
          shift -= sizes[i] - m2;
          sizes[i] = m2;
        }
      }
      for (let i = index2 - 1; i >= 0; i--) {
        const n2 = c[i];
        const m2 = h ? n2.getMaxWidth() : n2.getMaxHeight();
        if (sizes[i] + altShift < m2) {
          sizes[i] += altShift;
          break;
        } else {
          altShift -= m2 - sizes[i];
          sizes[i] = m2;
        }
      }
    }
    const weights = sizes.map((s2) => Math.max(0.1, s2) * 100 / sum2);
    return weights;
  }
  /** @internal */
  getMinSize(orientation) {
    if (orientation === Orientation.HORZ) {
      return this.getMinWidth();
    } else {
      return this.getMinHeight();
    }
  }
  /** @internal */
  getMinWidth() {
    return this.minWidth;
  }
  /** @internal */
  getMinHeight() {
    return this.minHeight;
  }
  /** @internal */
  getMaxSize(orientation) {
    if (orientation === Orientation.HORZ) {
      return this.getMaxWidth();
    } else {
      return this.getMaxHeight();
    }
  }
  /** @internal */
  getMaxWidth() {
    return this.maxWidth;
  }
  /** @internal */
  getMaxHeight() {
    return this.maxHeight;
  }
  /** @internal */
  calcMinMaxSize() {
    this.minHeight = DefaultMin;
    this.minWidth = DefaultMin;
    this.maxHeight = DefaultMax;
    this.maxWidth = DefaultMax;
    let first = true;
    for (const child of this.children) {
      const c = child;
      c.calcMinMaxSize();
      if (this.getOrientation() === Orientation.VERT) {
        this.minHeight += c.getMinHeight();
        this.maxHeight += c.getMaxHeight();
        if (!first) {
          this.minHeight += this.model.getSplitterSize();
          this.maxHeight += this.model.getSplitterSize();
        }
        this.minWidth = Math.max(this.minWidth, c.getMinWidth());
        this.maxWidth = Math.min(this.maxWidth, c.getMaxWidth());
      } else {
        this.minWidth += c.getMinWidth();
        this.maxWidth += c.getMaxWidth();
        if (!first) {
          this.minWidth += this.model.getSplitterSize();
          this.maxWidth += this.model.getSplitterSize();
        }
        this.minHeight = Math.max(this.minHeight, c.getMinHeight());
        this.maxHeight = Math.min(this.maxHeight, c.getMaxHeight());
      }
      first = false;
    }
  }
  /** @internal */
  tidy() {
    let i = 0;
    while (i < this.children.length) {
      const child = this.children[i];
      if (child instanceof RowNode) {
        child.tidy();
        const childChildren = child.getChildren();
        if (childChildren.length === 0) {
          this.removeChild(child);
        } else if (childChildren.length === 1) {
          const subchild = childChildren[0];
          this.removeChild(child);
          if (subchild instanceof RowNode) {
            let subChildrenTotal = 0;
            const subChildChildren = subchild.getChildren();
            for (const ssc of subChildChildren) {
              const subsubChild = ssc;
              subChildrenTotal += subsubChild.getWeight();
            }
            for (let j = 0; j < subChildChildren.length; j++) {
              const subsubChild = subChildChildren[j];
              subsubChild.setWeight(child.getWeight() * subsubChild.getWeight() / subChildrenTotal);
              this.addChild(subsubChild, i + j);
            }
          } else {
            subchild.setWeight(child.getWeight());
            this.addChild(subchild, i);
          }
        } else {
          i++;
        }
      } else if (child instanceof TabSetNode && child.getChildren().length === 0) {
        if (child.isEnableDeleteWhenEmpty()) {
          this.removeChild(child);
          if (child === this.model.getMaximizedTabset(this.windowId)) {
            this.model.setMaximizedTabset(void 0, this.windowId);
          }
        } else {
          i++;
        }
      } else {
        i++;
      }
    }
    if (this === this.model.getRoot(this.windowId) && this.children.length === 0) {
      const callback2 = this.model.getOnCreateTabSet();
      let attrs = callback2 ? callback2() : {};
      attrs = Object.assign(Object.assign({}, attrs), { selected: -1 });
      const child = new TabSetNode(this.model, attrs);
      this.model.setActiveTabset(child, this.windowId);
      this.addChild(child);
    }
  }
  /** @internal */
  canDrop(dragNode, x2, y2) {
    const yy = y2 - this.rect.y;
    const xx = x2 - this.rect.x;
    const w2 = this.rect.width;
    const h = this.rect.height;
    const margin = 10;
    const half = 50;
    let dropInfo;
    if (this.getWindowId() !== Model.MAIN_WINDOW_ID && !canDockToWindow(dragNode)) {
      return void 0;
    }
    if (this.model.isEnableEdgeDock() && this.parent === void 0) {
      if (x2 < this.rect.x + margin && yy > h / 2 - half && yy < h / 2 + half) {
        const dockLocation = DockLocation.LEFT;
        const outlineRect = dockLocation.getDockRect(this.rect);
        outlineRect.width = outlineRect.width / 2;
        dropInfo = new DropInfo(this, outlineRect, dockLocation, -1, CLASSES.FLEXLAYOUT__OUTLINE_RECT_EDGE);
      } else if (x2 > this.rect.getRight() - margin && yy > h / 2 - half && yy < h / 2 + half) {
        const dockLocation = DockLocation.RIGHT;
        const outlineRect = dockLocation.getDockRect(this.rect);
        outlineRect.width = outlineRect.width / 2;
        outlineRect.x += outlineRect.width;
        dropInfo = new DropInfo(this, outlineRect, dockLocation, -1, CLASSES.FLEXLAYOUT__OUTLINE_RECT_EDGE);
      } else if (y2 < this.rect.y + margin && xx > w2 / 2 - half && xx < w2 / 2 + half) {
        const dockLocation = DockLocation.TOP;
        const outlineRect = dockLocation.getDockRect(this.rect);
        outlineRect.height = outlineRect.height / 2;
        dropInfo = new DropInfo(this, outlineRect, dockLocation, -1, CLASSES.FLEXLAYOUT__OUTLINE_RECT_EDGE);
      } else if (y2 > this.rect.getBottom() - margin && xx > w2 / 2 - half && xx < w2 / 2 + half) {
        const dockLocation = DockLocation.BOTTOM;
        const outlineRect = dockLocation.getDockRect(this.rect);
        outlineRect.height = outlineRect.height / 2;
        outlineRect.y += outlineRect.height;
        dropInfo = new DropInfo(this, outlineRect, dockLocation, -1, CLASSES.FLEXLAYOUT__OUTLINE_RECT_EDGE);
      }
      if (dropInfo !== void 0) {
        if (!dragNode.canDockInto(dragNode, dropInfo)) {
          return void 0;
        }
      }
    }
    return dropInfo;
  }
  /** @internal */
  drop(dragNode, location, index2) {
    const dockLocation = location;
    const parent = dragNode.getParent();
    if (parent) {
      parent.removeChild(dragNode);
    }
    if (parent !== void 0 && parent instanceof TabSetNode) {
      parent.setSelected(0);
    }
    if (parent !== void 0 && parent instanceof BorderNode) {
      parent.setSelected(-1);
    }
    let node;
    if (dragNode instanceof TabSetNode || dragNode instanceof RowNode) {
      node = dragNode;
      if (node instanceof RowNode && node.getOrientation() === this.getOrientation() && (location.getOrientation() === this.getOrientation() || location === DockLocation.CENTER)) {
        node = new RowNode(this.model, this.windowId, {});
        node.addChild(dragNode);
      }
    } else {
      const callback2 = this.model.getOnCreateTabSet();
      node = new TabSetNode(this.model, callback2 ? callback2(dragNode) : {});
      node.addChild(dragNode);
    }
    let size = this.children.reduce((sum2, child) => {
      return sum2 + child.getWeight();
    }, 0);
    if (size === 0) {
      size = 100;
    }
    node.setWeight(size / 3);
    const horz = !this.model.isRootOrientationVertical();
    if (dockLocation === DockLocation.CENTER) {
      if (index2 === -1) {
        this.addChild(node, this.children.length);
      } else {
        this.addChild(node, index2);
      }
    } else if (horz && dockLocation === DockLocation.LEFT || !horz && dockLocation === DockLocation.TOP) {
      this.addChild(node, 0);
    } else if (horz && dockLocation === DockLocation.RIGHT || !horz && dockLocation === DockLocation.BOTTOM) {
      this.addChild(node);
    } else if (horz && dockLocation === DockLocation.TOP || !horz && dockLocation === DockLocation.LEFT) {
      const vrow = new RowNode(this.model, this.windowId, {});
      const hrow = new RowNode(this.model, this.windowId, {});
      hrow.setWeight(75);
      node.setWeight(25);
      for (const child of this.children) {
        hrow.addChild(child);
      }
      this.removeAll();
      vrow.addChild(node);
      vrow.addChild(hrow);
      this.addChild(vrow);
    } else if (horz && dockLocation === DockLocation.BOTTOM || !horz && dockLocation === DockLocation.RIGHT) {
      const vrow = new RowNode(this.model, this.windowId, {});
      const hrow = new RowNode(this.model, this.windowId, {});
      hrow.setWeight(75);
      node.setWeight(25);
      for (const child of this.children) {
        hrow.addChild(child);
      }
      this.removeAll();
      vrow.addChild(hrow);
      vrow.addChild(node);
      this.addChild(vrow);
    }
    if (node instanceof TabSetNode) {
      this.model.setActiveTabset(node, this.windowId);
    }
    this.model.tidy();
  }
  /** @internal */
  isEnableDrop() {
    return true;
  }
  /** @internal */
  getAttributeDefinitions() {
    return RowNode.attributeDefinitions;
  }
  /** @internal */
  updateAttrs(json) {
    RowNode.attributeDefinitions.update(json, this.attributes);
  }
  /** @internal */
  static getAttributeDefinitions() {
    return RowNode.attributeDefinitions;
  }
  // NOTE:  flex-grow cannot have values < 1 otherwise will not fill parent, need to normalize 
  normalizeWeights() {
    let sum2 = 0;
    for (const n2 of this.children) {
      const node = n2;
      sum2 += node.getWeight();
    }
    if (sum2 === 0) {
      sum2 = 1;
    }
    for (const n2 of this.children) {
      const node = n2;
      node.setWeight(Math.max(1e-3, 100 * node.getWeight() / sum2));
    }
  }
  /** @internal */
  static createAttributeDefinitions() {
    const attributeDefinitions = new AttributeDefinitions();
    attributeDefinitions.add("type", RowNode.TYPE, true).setType(Attribute.STRING).setFixed();
    attributeDefinitions.add("id", void 0).setType(Attribute.STRING).setDescription(`the unique id of the row, if left undefined a uuid will be assigned`);
    attributeDefinitions.add("weight", 100).setType(Attribute.NUMBER).setDescription(`relative weight for sizing of this row in parent row`);
    return attributeDefinitions;
  }
};
RowNode$1.TYPE = "row";
RowNode$1.attributeDefinitions = RowNode$1.createAttributeDefinitions();
class LayoutWindow {
  constructor(windowId, rect) {
    this._windowId = windowId;
    this._rect = rect;
    this._toScreenRectFunction = (r2) => r2;
  }
  visitNodes(fn) {
    this.root.forEachNode(fn, 0);
  }
  get windowId() {
    return this._windowId;
  }
  get rect() {
    return this._rect;
  }
  get layout() {
    return this._layout;
  }
  get window() {
    return this._window;
  }
  get root() {
    return this._root;
  }
  get maximizedTabSet() {
    return this._maximizedTabSet;
  }
  get activeTabSet() {
    return this._activeTabSet;
  }
  /** @internal */
  set rect(value) {
    this._rect = value;
  }
  /** @internal */
  set layout(value) {
    this._layout = value;
  }
  /** @internal */
  set window(value) {
    this._window = value;
  }
  /** @internal */
  set root(value) {
    this._root = value;
  }
  /** @internal */
  set maximizedTabSet(value) {
    this._maximizedTabSet = value;
  }
  /** @internal */
  set activeTabSet(value) {
    this._activeTabSet = value;
  }
  /** @internal */
  get toScreenRectFunction() {
    return this._toScreenRectFunction;
  }
  /** @internal */
  set toScreenRectFunction(value) {
    this._toScreenRectFunction = value;
  }
  toJson() {
    if (this._window && this._window.screenTop > -1e4) {
      this.rect = new Rect(this._window.screenLeft, this._window.screenTop, this._window.outerWidth, this._window.outerHeight);
    }
    return { layout: this.root.toJson(), rect: this.rect.toJson() };
  }
  static fromJson(windowJson, model, windowId) {
    const count = model.getwindowsMap().size;
    let rect = windowJson.rect ? Rect.fromJson(windowJson.rect) : new Rect(50 + 50 * count, 50 + 50 * count, 600, 400);
    rect = keepOnScreen(rect);
    const layoutWindow = new LayoutWindow(windowId, rect);
    layoutWindow.root = RowNode$1.fromJson(windowJson.layout, model, layoutWindow);
    return layoutWindow;
  }
}
const DefaultMin = 0;
const DefaultMax = 99999;
class Model {
  /**
   * 'private' constructor. Use the static method Model.fromJson(json) to create a model
   *  @internal
   */
  constructor() {
    this.attributes = {};
    this.idMap = /* @__PURE__ */ new Map();
    this.borders = new BorderSet(this);
    this.windows = /* @__PURE__ */ new Map();
    this.rootWindow = new LayoutWindow(Model.MAIN_WINDOW_ID, Rect.empty());
    this.windows.set(Model.MAIN_WINDOW_ID, this.rootWindow);
    this.changeListeners = [];
  }
  /**
   * Update the node tree by performing the given action,
   * Actions should be generated via static methods on the Actions class
   * @param action the action to perform
   * @returns added Node for Actions.addNode, windowId for createWindow
   */
  doAction(action) {
    var _a2;
    let returnVal = void 0;
    switch (action.type) {
      case Actions.ADD_NODE: {
        const newNode = new TabNode(this, action.data.json, true);
        const toNode = this.idMap.get(action.data.toNode);
        if (toNode instanceof TabSetNode || toNode instanceof BorderNode || toNode instanceof RowNode$1) {
          toNode.drop(newNode, DockLocation.getByName(action.data.location), action.data.index, action.data.select);
          returnVal = newNode;
        }
        break;
      }
      case Actions.MOVE_NODE: {
        const fromNode = this.idMap.get(action.data.fromNode);
        if (fromNode instanceof TabNode || fromNode instanceof TabSetNode || fromNode instanceof RowNode$1) {
          if (fromNode === this.getMaximizedTabset(fromNode.getWindowId())) {
            const fromWindow = this.windows.get(fromNode.getWindowId());
            fromWindow.maximizedTabSet = void 0;
          }
          const toNode = this.idMap.get(action.data.toNode);
          if (toNode instanceof TabSetNode || toNode instanceof BorderNode || toNode instanceof RowNode$1) {
            toNode.drop(fromNode, DockLocation.getByName(action.data.location), action.data.index, action.data.select);
          }
        }
        this.removeEmptyWindows();
        break;
      }
      case Actions.DELETE_TAB: {
        const node = this.idMap.get(action.data.node);
        if (node instanceof TabNode) {
          node.delete();
        }
        this.removeEmptyWindows();
        break;
      }
      case Actions.DELETE_TABSET: {
        const node = this.idMap.get(action.data.node);
        if (node instanceof TabSetNode) {
          const children = [...node.getChildren()];
          for (let i = 0; i < children.length; i++) {
            const child = children[i];
            if (child.isEnableClose()) {
              child.delete();
            }
          }
          if (node.getChildren().length === 0) {
            node.delete();
          }
          this.tidy();
        }
        this.removeEmptyWindows();
        break;
      }
      case Actions.POPOUT_TABSET: {
        const node = this.idMap.get(action.data.node);
        if (node instanceof TabSetNode) {
          const isMaximized = node.isMaximized();
          const oldLayoutWindow = this.windows.get(node.getWindowId());
          const windowId = randomUUID$1();
          const layoutWindow = new LayoutWindow(windowId, oldLayoutWindow.toScreenRectFunction(node.getRect()));
          const json = {
            type: "row",
            children: []
          };
          const row = RowNode$1.fromJson(json, this, layoutWindow);
          layoutWindow.root = row;
          this.windows.set(windowId, layoutWindow);
          row.drop(node, DockLocation.CENTER, 0);
          if (isMaximized) {
            this.rootWindow.maximizedTabSet = void 0;
          }
        }
        this.removeEmptyWindows();
        break;
      }
      case Actions.POPOUT_TAB: {
        const node = this.idMap.get(action.data.node);
        if (node instanceof TabNode) {
          const windowId = randomUUID$1();
          let r2 = Rect.empty();
          if (node.getParent() instanceof TabSetNode) {
            r2 = node.getParent().getRect();
          } else {
            r2 = node.getParent().getContentRect();
          }
          const oldLayoutWindow = this.windows.get(node.getWindowId());
          const layoutWindow = new LayoutWindow(windowId, oldLayoutWindow.toScreenRectFunction(r2));
          const tabsetId = randomUUID$1();
          const json = {
            type: "row",
            children: [
              { type: "tabset", id: tabsetId }
            ]
          };
          const row = RowNode$1.fromJson(json, this, layoutWindow);
          layoutWindow.root = row;
          this.windows.set(windowId, layoutWindow);
          const tabset = this.idMap.get(tabsetId);
          tabset.drop(node, DockLocation.CENTER, 0, true);
        }
        this.removeEmptyWindows();
        break;
      }
      case Actions.CLOSE_WINDOW: {
        const window2 = this.windows.get(action.data.windowId);
        if (window2) {
          (_a2 = this.rootWindow.root) === null || _a2 === void 0 ? void 0 : _a2.drop(window2 === null || window2 === void 0 ? void 0 : window2.root, DockLocation.CENTER, -1);
          this.rootWindow.visitNodes((node, level) => {
            if (node instanceof RowNode$1) {
              node.setWindowId(Model.MAIN_WINDOW_ID);
            }
          });
          this.windows.delete(action.data.windowId);
        }
        break;
      }
      case Actions.CREATE_WINDOW: {
        const windowId = randomUUID$1();
        const layoutWindow = new LayoutWindow(windowId, Rect.fromJson(action.data.rect));
        const row = RowNode$1.fromJson(action.data.layout, this, layoutWindow);
        layoutWindow.root = row;
        this.windows.set(windowId, layoutWindow);
        returnVal = windowId;
        break;
      }
      case Actions.RENAME_TAB: {
        const node = this.idMap.get(action.data.node);
        if (node instanceof TabNode) {
          node.setName(action.data.text);
        }
        break;
      }
      case Actions.SELECT_TAB: {
        const tabNode = this.idMap.get(action.data.tabNode);
        const windowId = action.data.windowId ? action.data.windowId : Model.MAIN_WINDOW_ID;
        const window2 = this.windows.get(windowId);
        if (tabNode instanceof TabNode) {
          const parent = tabNode.getParent();
          const pos = parent.getChildren().indexOf(tabNode);
          if (parent instanceof BorderNode) {
            if (parent.getSelected() === pos) {
              parent.setSelected(-1);
            } else {
              parent.setSelected(pos);
            }
          } else if (parent instanceof TabSetNode) {
            if (parent.getSelected() !== pos) {
              parent.setSelected(pos);
            }
            window2.activeTabSet = parent;
          }
        }
        break;
      }
      case Actions.SET_ACTIVE_TABSET: {
        const windowId = action.data.windowId ? action.data.windowId : Model.MAIN_WINDOW_ID;
        const window2 = this.windows.get(windowId);
        if (action.data.tabsetNode === void 0) {
          window2.activeTabSet = void 0;
        } else {
          const tabsetNode = this.idMap.get(action.data.tabsetNode);
          if (tabsetNode instanceof TabSetNode) {
            window2.activeTabSet = tabsetNode;
          }
        }
        break;
      }
      case Actions.ADJUST_WEIGHTS: {
        const row = this.idMap.get(action.data.nodeId);
        const c = row.getChildren();
        for (let i = 0; i < c.length; i++) {
          const n2 = c[i];
          n2.setWeight(action.data.weights[i]);
        }
        break;
      }
      case Actions.ADJUST_BORDER_SPLIT: {
        const node = this.idMap.get(action.data.node);
        if (node instanceof BorderNode) {
          node.setSize(action.data.pos);
        }
        break;
      }
      case Actions.MAXIMIZE_TOGGLE: {
        const windowId = action.data.windowId ? action.data.windowId : Model.MAIN_WINDOW_ID;
        const window2 = this.windows.get(windowId);
        const node = this.idMap.get(action.data.node);
        if (node instanceof TabSetNode) {
          if (node === window2.maximizedTabSet) {
            window2.maximizedTabSet = void 0;
          } else {
            window2.maximizedTabSet = node;
            window2.activeTabSet = node;
          }
        }
        break;
      }
      case Actions.UPDATE_MODEL_ATTRIBUTES: {
        this.updateAttrs(action.data.json);
        break;
      }
      case Actions.UPDATE_NODE_ATTRIBUTES: {
        const node = this.idMap.get(action.data.node);
        node.updateAttrs(action.data.json);
        break;
      }
    }
    this.updateIdMap();
    for (const listener of this.changeListeners) {
      listener(action);
    }
    return returnVal;
  }
  /**
   * Get the currently active tabset node
   */
  getActiveTabset(windowId = Model.MAIN_WINDOW_ID) {
    const window2 = this.windows.get(windowId);
    if (window2 && window2.activeTabSet && this.getNodeById(window2.activeTabSet.getId())) {
      return window2.activeTabSet;
    } else {
      return void 0;
    }
  }
  /**
   * Get the currently maximized tabset node
   */
  getMaximizedTabset(windowId = Model.MAIN_WINDOW_ID) {
    return this.windows.get(windowId).maximizedTabSet;
  }
  /**
   * Gets the root RowNode of the model
   * @returns {RowNode}
   */
  getRoot(windowId = Model.MAIN_WINDOW_ID) {
    return this.windows.get(windowId).root;
  }
  isRootOrientationVertical() {
    return this.attributes.rootOrientationVertical;
  }
  isEnableRotateBorderIcons() {
    return this.attributes.enableRotateBorderIcons;
  }
  /**
   * Gets the
   * @returns {BorderSet|*}
   */
  getBorderSet() {
    return this.borders;
  }
  getwindowsMap() {
    return this.windows;
  }
  /**
   * Visits all the nodes in the model and calls the given function for each
   * @param fn a function that takes visited node and a integer level as parameters
   */
  visitNodes(fn) {
    this.borders.forEachNode(fn);
    for (const [_2, w2] of this.windows) {
      w2.root.forEachNode(fn, 0);
    }
  }
  visitWindowNodes(windowId, fn) {
    if (this.windows.has(windowId)) {
      if (windowId === Model.MAIN_WINDOW_ID) {
        this.borders.forEachNode(fn);
      }
      this.windows.get(windowId).visitNodes(fn);
    }
  }
  /**
   * Gets a node by its id
   * @param id the id to find
   */
  getNodeById(id2) {
    return this.idMap.get(id2);
  }
  /**
   * Finds the first/top left tab set of the given node.
   * @param node The top node you want to begin searching from, deafults to the root node
   * @returns The first Tab Set
   */
  getFirstTabSet(node = this.windows.get(Model.MAIN_WINDOW_ID).root) {
    const child = node.getChildren()[0];
    if (child instanceof TabSetNode) {
      return child;
    } else {
      return this.getFirstTabSet(child);
    }
  }
  /**
  * Loads the model from the given json object
  * @param json the json model to load
  * @returns {Model} a new Model object
  */
  static fromJson(json) {
    const model = new Model();
    Model.attributeDefinitions.fromJson(json.global, model.attributes);
    if (json.borders) {
      model.borders = BorderSet.fromJson(json.borders, model);
    }
    if (json.popouts) {
      let i = 0;
      let top = 100;
      let left = 100;
      for (const windowId in json.popouts) {
        const windowJson = json.popouts[windowId];
        const layoutWindow = LayoutWindow.fromJson(windowJson, model, windowId);
        model.windows.set(windowId, layoutWindow);
        if (!isOnScreen(layoutWindow.rect)) {
          layoutWindow.rect = new Rect(top + i * 50, left + i * 50, 600, 400);
          i++;
        }
      }
    }
    model.rootWindow.root = RowNode$1.fromJson(json.layout, model, model.getwindowsMap().get(Model.MAIN_WINDOW_ID));
    model.tidy();
    return model;
  }
  /**
   * Converts the model to a json object
   * @returns {IJsonModel} json object that represents this model
   */
  toJson() {
    const global2 = {};
    Model.attributeDefinitions.toJson(global2, this.attributes);
    this.visitNodes((node) => {
      node.fireEvent("save", {});
    });
    const windows = {};
    for (const [id2, window2] of this.windows) {
      if (id2 !== Model.MAIN_WINDOW_ID) {
        windows[id2] = window2.toJson();
      }
    }
    return {
      global: global2,
      borders: this.borders.toJson(),
      layout: this.rootWindow.root.toJson(),
      popouts: windows
    };
  }
  getSplitterSize() {
    return this.attributes.splitterSize;
  }
  getSplitterExtra() {
    return this.attributes.splitterExtra;
  }
  isEnableEdgeDock() {
    return this.attributes.enableEdgeDock;
  }
  isSplitterEnableHandle() {
    return this.attributes.splitterEnableHandle;
  }
  /**
   * Sets a function to allow/deny dropping a node
   * @param onAllowDrop function that takes the drag node and DropInfo and returns true if the drop is allowed
   */
  setOnAllowDrop(onAllowDrop) {
    this.onAllowDrop = onAllowDrop;
  }
  /**
   * set callback called when a new TabSet is created.
   * The tabNode can be undefined if it's the auto created first tabset in the root row (when the last
   * tab is deleted, the root tabset can be recreated)
   * @param onCreateTabSet
   */
  setOnCreateTabSet(onCreateTabSet) {
    this.onCreateTabSet = onCreateTabSet;
  }
  addChangeListener(listener) {
    this.changeListeners.push(listener);
  }
  removeChangeListener(listener) {
    const pos = this.changeListeners.findIndex((l2) => l2 === listener);
    if (pos !== -1) {
      this.changeListeners.splice(pos, 1);
    }
  }
  toString() {
    return JSON.stringify(this.toJson());
  }
  /***********************internal ********************************/
  /** @internal */
  removeEmptyWindows() {
    const emptyWindows = /* @__PURE__ */ new Set();
    for (const [windowId] of this.windows) {
      if (windowId !== Model.MAIN_WINDOW_ID) {
        let count = 0;
        this.visitWindowNodes(windowId, (node) => {
          if (node instanceof TabNode) {
            count++;
          }
        });
        if (count === 0) {
          emptyWindows.add(windowId);
        }
      }
    }
    for (const windowId of emptyWindows) {
      this.windows.delete(windowId);
    }
  }
  /** @internal */
  setActiveTabset(tabsetNode, windowId) {
    const window2 = this.windows.get(windowId);
    if (window2) {
      if (tabsetNode) {
        window2.activeTabSet = tabsetNode;
      } else {
        window2.activeTabSet = void 0;
      }
    }
  }
  /** @internal */
  setMaximizedTabset(tabsetNode, windowId) {
    const window2 = this.windows.get(windowId);
    if (window2) {
      if (tabsetNode) {
        window2.maximizedTabSet = tabsetNode;
      } else {
        window2.maximizedTabSet = void 0;
      }
    }
  }
  /** @internal */
  updateIdMap() {
    this.idMap.clear();
    this.visitNodes((node) => {
      this.idMap.set(node.getId(), node);
    });
  }
  /** @internal */
  addNode(node) {
    const id2 = node.getId();
    if (this.idMap.has(id2)) {
      throw new Error(`Error: each node must have a unique id, duplicate id:${node.getId()}`);
    }
    this.idMap.set(id2, node);
  }
  /** @internal */
  findDropTargetNode(windowId, dragNode, x2, y2) {
    let node = this.windows.get(windowId).root.findDropTargetNode(windowId, dragNode, x2, y2);
    if (node === void 0 && windowId === Model.MAIN_WINDOW_ID) {
      node = this.borders.findDropTargetNode(dragNode, x2, y2);
    }
    return node;
  }
  /** @internal */
  tidy() {
    for (const [_2, window2] of this.windows) {
      window2.root.tidy();
    }
  }
  /** @internal */
  updateAttrs(json) {
    Model.attributeDefinitions.update(json, this.attributes);
  }
  /** @internal */
  nextUniqueId() {
    return "#" + randomUUID$1();
  }
  /** @internal */
  getAttribute(name) {
    return this.attributes[name];
  }
  /** @internal */
  getOnAllowDrop() {
    return this.onAllowDrop;
  }
  /** @internal */
  getOnCreateTabSet() {
    return this.onCreateTabSet;
  }
  static toTypescriptInterfaces() {
    Model.attributeDefinitions.pairAttributes("RowNode", RowNode$1.getAttributeDefinitions());
    Model.attributeDefinitions.pairAttributes("TabSetNode", TabSetNode.getAttributeDefinitions());
    Model.attributeDefinitions.pairAttributes("TabNode", TabNode.getAttributeDefinitions());
    Model.attributeDefinitions.pairAttributes("BorderNode", BorderNode.getAttributeDefinitions());
    let sb2 = [];
    sb2.push(Model.attributeDefinitions.toTypescriptInterface("Global", void 0));
    sb2.push(RowNode$1.getAttributeDefinitions().toTypescriptInterface("Row", Model.attributeDefinitions));
    sb2.push(TabSetNode.getAttributeDefinitions().toTypescriptInterface("TabSet", Model.attributeDefinitions));
    sb2.push(TabNode.getAttributeDefinitions().toTypescriptInterface("Tab", Model.attributeDefinitions));
    sb2.push(BorderNode.getAttributeDefinitions().toTypescriptInterface("Border", Model.attributeDefinitions));
    console.log(sb2.join("\n"));
  }
  /** @internal */
  static createAttributeDefinitions() {
    const attributeDefinitions = new AttributeDefinitions();
    attributeDefinitions.add("enableEdgeDock", true).setType(Attribute.BOOLEAN).setDescription(`enable docking to the edges of the layout, this will show the edge indicators`);
    attributeDefinitions.add("rootOrientationVertical", false).setType(Attribute.BOOLEAN).setDescription(`the top level 'row' will layout horizontally by default, set this option true to make it layout vertically`);
    attributeDefinitions.add("enableRotateBorderIcons", true).setType(Attribute.BOOLEAN).setDescription(`boolean indicating if tab icons should rotate with the text in the left and right borders`);
    attributeDefinitions.add("splitterSize", 8).setType(Attribute.NUMBER).setDescription(`width in pixels of all splitters between tabsets/borders`);
    attributeDefinitions.add("splitterExtra", 0).setType(Attribute.NUMBER).setDescription(`additional width in pixels of the splitter hit test area`);
    attributeDefinitions.add("splitterEnableHandle", false).setType(Attribute.BOOLEAN).setDescription(`enable a small centralized handle on all splitters`);
    attributeDefinitions.add("tabEnableClose", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabCloseType", 1).setType("ICloseType");
    attributeDefinitions.add("tabEnablePopout", false).setType(Attribute.BOOLEAN).setAlias("tabEnableFloat");
    attributeDefinitions.add("tabEnablePopoutIcon", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabEnablePopoutOverlay", false).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabEnableDrag", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabEnableRename", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabContentClassName", void 0).setType(Attribute.STRING);
    attributeDefinitions.add("tabClassName", void 0).setType(Attribute.STRING);
    attributeDefinitions.add("tabIcon", void 0).setType(Attribute.STRING);
    attributeDefinitions.add("tabEnableRenderOnDemand", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabDragSpeed", 0.3).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabBorderWidth", -1).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabBorderHeight", -1).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabSetEnableDeleteWhenEmpty", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetEnableDrop", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetEnableDrag", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetEnableDivide", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetEnableMaximize", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetEnableClose", false).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetEnableSingleTabStretch", false).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetAutoSelectTab", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetEnableActiveIcon", false).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetClassNameTabStrip", void 0).setType(Attribute.STRING);
    attributeDefinitions.add("tabSetEnableTabStrip", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetEnableTabWrap", false).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("tabSetTabLocation", "top").setType("ITabLocation");
    attributeDefinitions.add("tabMinWidth", DefaultMin).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabMinHeight", DefaultMin).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabSetMinWidth", DefaultMin).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabSetMinHeight", DefaultMin).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabMaxWidth", DefaultMax).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabMaxHeight", DefaultMax).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabSetMaxWidth", DefaultMax).setType(Attribute.NUMBER);
    attributeDefinitions.add("tabSetMaxHeight", DefaultMax).setType(Attribute.NUMBER);
    attributeDefinitions.add("borderSize", 200).setType(Attribute.NUMBER);
    attributeDefinitions.add("borderMinSize", DefaultMin).setType(Attribute.NUMBER);
    attributeDefinitions.add("borderMaxSize", DefaultMax).setType(Attribute.NUMBER);
    attributeDefinitions.add("borderEnableDrop", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("borderAutoSelectTabWhenOpen", true).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("borderAutoSelectTabWhenClosed", false).setType(Attribute.BOOLEAN);
    attributeDefinitions.add("borderClassName", void 0).setType(Attribute.STRING);
    attributeDefinitions.add("borderEnableAutoHide", false).setType(Attribute.BOOLEAN);
    return attributeDefinitions;
  }
}
Model.MAIN_WINDOW_ID = "__main_window_id__";
Model.attributeDefinitions = Model.createAttributeDefinitions();
class BorderNode extends Node$1 {
  /** @internal */
  static fromJson(json, model) {
    const location = DockLocation.getByName(json.location);
    const border = new BorderNode(location, json, model);
    if (json.children) {
      border.children = json.children.map((jsonChild) => {
        const child = TabNode.fromJson(jsonChild, model);
        child.setParent(border);
        return child;
      });
    }
    return border;
  }
  /** @internal */
  constructor(location, json, model) {
    super(model);
    this.outerRect = Rect.empty();
    this.contentRect = Rect.empty();
    this.tabHeaderRect = Rect.empty();
    this.location = location;
    this.attributes.id = `border_${location.getName()}`;
    BorderNode.attributeDefinitions.fromJson(json, this.attributes);
    model.addNode(this);
  }
  getLocation() {
    return this.location;
  }
  getClassName() {
    return this.getAttr("className");
  }
  isHorizontal() {
    return this.location.orientation === Orientation.HORZ;
  }
  getSize() {
    const defaultSize = this.getAttr("size");
    const selected = this.getSelected();
    if (selected === -1) {
      return defaultSize;
    } else {
      const tabNode = this.children[selected];
      const tabBorderSize = this.isHorizontal() ? tabNode.getAttr("borderWidth") : tabNode.getAttr("borderHeight");
      if (tabBorderSize === -1) {
        return defaultSize;
      } else {
        return tabBorderSize;
      }
    }
  }
  getMinSize() {
    const selectedNode = this.getSelectedNode();
    let min2 = this.getAttr("minSize");
    if (selectedNode) {
      const nodeMin = this.isHorizontal() ? selectedNode.getMinWidth() : selectedNode.getMinHeight();
      min2 = Math.max(min2, nodeMin);
    }
    return min2;
  }
  getMaxSize() {
    const selectedNode = this.getSelectedNode();
    let max2 = this.getAttr("maxSize");
    if (selectedNode) {
      const nodeMax = this.isHorizontal() ? selectedNode.getMaxWidth() : selectedNode.getMaxHeight();
      max2 = Math.min(max2, nodeMax);
    }
    return max2;
  }
  getSelected() {
    return this.attributes.selected;
  }
  isAutoHide() {
    return this.getAttr("enableAutoHide");
  }
  getSelectedNode() {
    if (this.getSelected() !== -1) {
      return this.children[this.getSelected()];
    }
    return void 0;
  }
  getOrientation() {
    return this.location.getOrientation();
  }
  /**
   * Returns the config attribute that can be used to store node specific data that
   * WILL be saved to the json. The config attribute should be changed via the action Actions.updateNodeAttributes rather
   * than directly, for example:
   * this.state.model.doAction(
   *   FlexLayout.Actions.updateNodeAttributes(node.getId(), {config:myConfigObject}));
   */
  getConfig() {
    return this.attributes.config;
  }
  isMaximized() {
    return false;
  }
  isShowing() {
    return this.attributes.show;
  }
  toJson() {
    const json = {};
    BorderNode.attributeDefinitions.toJson(json, this.attributes);
    json.location = this.location.getName();
    json.children = this.children.map((child) => child.toJson());
    return json;
  }
  /** @internal */
  isAutoSelectTab(whenOpen) {
    if (whenOpen == null) {
      whenOpen = this.getSelected() !== -1;
    }
    if (whenOpen) {
      return this.getAttr("autoSelectTabWhenOpen");
    } else {
      return this.getAttr("autoSelectTabWhenClosed");
    }
  }
  /** @internal */
  setSelected(index2) {
    this.attributes.selected = index2;
  }
  /** @internal */
  getTabHeaderRect() {
    return this.tabHeaderRect;
  }
  /** @internal */
  setTabHeaderRect(r2) {
    this.tabHeaderRect = r2;
  }
  /** @internal */
  getOuterRect() {
    return this.outerRect;
  }
  /** @internal */
  setOuterRect(r2) {
    this.outerRect = r2;
  }
  /** @internal */
  getRect() {
    return this.tabHeaderRect;
  }
  /** @internal */
  getContentRect() {
    return this.contentRect;
  }
  /** @internal */
  setContentRect(r2) {
    this.contentRect = r2;
  }
  /** @internal */
  isEnableDrop() {
    return this.getAttr("enableDrop");
  }
  /** @internal */
  setSize(pos) {
    const selected = this.getSelected();
    if (selected === -1) {
      this.attributes.size = pos;
    } else {
      const tabNode = this.children[selected];
      const tabBorderSize = this.isHorizontal() ? tabNode.getAttr("borderWidth") : tabNode.getAttr("borderHeight");
      if (tabBorderSize === -1) {
        this.attributes.size = pos;
      } else {
        if (this.isHorizontal()) {
          tabNode.setBorderWidth(pos);
        } else {
          tabNode.setBorderHeight(pos);
        }
      }
    }
  }
  /** @internal */
  updateAttrs(json) {
    BorderNode.attributeDefinitions.update(json, this.attributes);
  }
  /** @internal */
  remove(node) {
    const removedIndex = this.removeChild(node);
    if (this.getSelected() !== -1) {
      adjustSelectedIndex(this, removedIndex);
    }
  }
  /** @internal */
  canDrop(dragNode, x2, y2) {
    if (!(dragNode instanceof TabNode)) {
      return void 0;
    }
    let dropInfo;
    const dockLocation = DockLocation.CENTER;
    if (this.tabHeaderRect.contains(x2, y2)) {
      if (this.location.orientation === Orientation.VERT) {
        if (this.children.length > 0) {
          let child = this.children[0];
          let childRect = child.getTabRect();
          const childY = childRect.y;
          const childHeight = childRect.height;
          let pos = this.tabHeaderRect.x;
          let childCenter = 0;
          for (let i = 0; i < this.children.length; i++) {
            child = this.children[i];
            childRect = child.getTabRect();
            childCenter = childRect.x + childRect.width / 2;
            if (x2 >= pos && x2 < childCenter) {
              const outlineRect = new Rect(childRect.x - 2, childY, 3, childHeight);
              dropInfo = new DropInfo(this, outlineRect, dockLocation, i, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
              break;
            }
            pos = childCenter;
          }
          if (dropInfo == null) {
            const outlineRect = new Rect(childRect.getRight() - 2, childY, 3, childHeight);
            dropInfo = new DropInfo(this, outlineRect, dockLocation, this.children.length, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
          }
        } else {
          const outlineRect = new Rect(this.tabHeaderRect.x + 1, this.tabHeaderRect.y + 2, 3, 18);
          dropInfo = new DropInfo(this, outlineRect, dockLocation, 0, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
        }
      } else {
        if (this.children.length > 0) {
          let child = this.children[0];
          let childRect = child.getTabRect();
          const childX = childRect.x;
          const childWidth = childRect.width;
          let pos = this.tabHeaderRect.y;
          let childCenter = 0;
          for (let i = 0; i < this.children.length; i++) {
            child = this.children[i];
            childRect = child.getTabRect();
            childCenter = childRect.y + childRect.height / 2;
            if (y2 >= pos && y2 < childCenter) {
              const outlineRect = new Rect(childX, childRect.y - 2, childWidth, 3);
              dropInfo = new DropInfo(this, outlineRect, dockLocation, i, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
              break;
            }
            pos = childCenter;
          }
          if (dropInfo == null) {
            const outlineRect = new Rect(childX, childRect.getBottom() - 2, childWidth, 3);
            dropInfo = new DropInfo(this, outlineRect, dockLocation, this.children.length, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
          }
        } else {
          const outlineRect = new Rect(this.tabHeaderRect.x + 2, this.tabHeaderRect.y + 1, 18, 3);
          dropInfo = new DropInfo(this, outlineRect, dockLocation, 0, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
        }
      }
      if (!dragNode.canDockInto(dragNode, dropInfo)) {
        return void 0;
      }
    } else if (this.getSelected() !== -1 && this.outerRect.contains(x2, y2)) {
      const outlineRect = this.outerRect;
      dropInfo = new DropInfo(this, outlineRect, dockLocation, -1, CLASSES.FLEXLAYOUT__OUTLINE_RECT);
      if (!dragNode.canDockInto(dragNode, dropInfo)) {
        return void 0;
      }
    }
    return dropInfo;
  }
  /** @internal */
  drop(dragNode, location, index2, select) {
    let fromIndex = 0;
    const dragParent = dragNode.getParent();
    if (dragParent !== void 0) {
      fromIndex = dragParent.removeChild(dragNode);
      if (dragParent !== this && dragParent instanceof BorderNode && dragParent.getSelected() === fromIndex) {
        dragParent.setSelected(-1);
      } else {
        adjustSelectedIndex(dragParent, fromIndex);
      }
    }
    if (dragNode instanceof TabNode && dragParent === this && fromIndex < index2 && index2 > 0) {
      index2--;
    }
    let insertPos = index2;
    if (insertPos === -1) {
      insertPos = this.children.length;
    }
    if (dragNode instanceof TabNode) {
      this.addChild(dragNode, insertPos);
    }
    if (select || select !== false && this.isAutoSelectTab()) {
      this.setSelected(insertPos);
    }
    this.model.tidy();
  }
  /** @internal */
  getSplitterBounds(index2, useMinSize = false) {
    const pBounds = [0, 0];
    const minSize = useMinSize ? this.getMinSize() : 0;
    const maxSize = useMinSize ? this.getMaxSize() : 99999;
    const rootRow = this.model.getRoot(Model.MAIN_WINDOW_ID);
    const innerRect = rootRow.getRect();
    const splitterSize = this.model.getSplitterSize();
    if (this.location === DockLocation.TOP) {
      pBounds[0] = this.tabHeaderRect.getBottom() + minSize;
      const maxPos = this.tabHeaderRect.getBottom() + maxSize;
      pBounds[1] = Math.max(pBounds[0], innerRect.getBottom() - rootRow.getMinHeight() - splitterSize);
      pBounds[1] = Math.min(pBounds[1], maxPos);
    } else if (this.location === DockLocation.LEFT) {
      pBounds[0] = this.tabHeaderRect.getRight() + minSize;
      const maxPos = this.tabHeaderRect.getRight() + maxSize;
      pBounds[1] = Math.max(pBounds[0], innerRect.getRight() - rootRow.getMinWidth() - splitterSize);
      pBounds[1] = Math.min(pBounds[1], maxPos);
    } else if (this.location === DockLocation.BOTTOM) {
      pBounds[1] = this.tabHeaderRect.y - minSize - splitterSize;
      const maxPos = this.tabHeaderRect.y - maxSize - splitterSize;
      pBounds[0] = Math.min(pBounds[1], innerRect.y + rootRow.getMinHeight());
      pBounds[0] = Math.max(pBounds[0], maxPos);
    } else if (this.location === DockLocation.RIGHT) {
      pBounds[1] = this.tabHeaderRect.x - minSize - splitterSize;
      const maxPos = this.tabHeaderRect.x - maxSize - splitterSize;
      pBounds[0] = Math.min(pBounds[1], innerRect.x + rootRow.getMinWidth());
      pBounds[0] = Math.max(pBounds[0], maxPos);
    }
    return pBounds;
  }
  /** @internal */
  calculateSplit(splitter, splitterPos) {
    const pBounds = this.getSplitterBounds(splitterPos);
    if (this.location === DockLocation.BOTTOM || this.location === DockLocation.RIGHT) {
      return Math.max(0, pBounds[1] - splitterPos);
    } else {
      return Math.max(0, splitterPos - pBounds[0]);
    }
  }
  /** @internal */
  getAttributeDefinitions() {
    return BorderNode.attributeDefinitions;
  }
  /** @internal */
  static getAttributeDefinitions() {
    return BorderNode.attributeDefinitions;
  }
  /** @internal */
  static createAttributeDefinitions() {
    const attributeDefinitions = new AttributeDefinitions();
    attributeDefinitions.add("type", BorderNode.TYPE, true).setType(Attribute.STRING).setFixed();
    attributeDefinitions.add("selected", -1).setType(Attribute.NUMBER).setDescription(`index of selected/visible tab in border; -1 means no tab selected`);
    attributeDefinitions.add("show", true).setType(Attribute.BOOLEAN).setDescription(`show/hide this border`);
    attributeDefinitions.add("config", void 0).setType("any").setDescription(`a place to hold json config used in your own code`);
    attributeDefinitions.addInherited("enableDrop", "borderEnableDrop").setType(Attribute.BOOLEAN).setDescription(`whether tabs can be dropped into this border`);
    attributeDefinitions.addInherited("className", "borderClassName").setType(Attribute.STRING).setDescription(`class applied to tab button`);
    attributeDefinitions.addInherited("autoSelectTabWhenOpen", "borderAutoSelectTabWhenOpen").setType(Attribute.BOOLEAN).setDescription(`whether to select new/moved tabs in border when the border is already open`);
    attributeDefinitions.addInherited("autoSelectTabWhenClosed", "borderAutoSelectTabWhenClosed").setType(Attribute.BOOLEAN).setDescription(`whether to select new/moved tabs in border when the border is currently closed`);
    attributeDefinitions.addInherited("size", "borderSize").setType(Attribute.NUMBER).setDescription(`size of the tab area when selected`);
    attributeDefinitions.addInherited("minSize", "borderMinSize").setType(Attribute.NUMBER).setDescription(`the minimum size of the tab area`);
    attributeDefinitions.addInherited("maxSize", "borderMaxSize").setType(Attribute.NUMBER).setDescription(`the maximum size of the tab area`);
    attributeDefinitions.addInherited("enableAutoHide", "borderEnableAutoHide").setType(Attribute.BOOLEAN).setDescription(`hide border if it has zero tabs`);
    return attributeDefinitions;
  }
}
BorderNode.TYPE = "border";
BorderNode.attributeDefinitions = BorderNode.createAttributeDefinitions();
const Splitter$1 = (props) => {
  const { layout, node, index: index2, horizontal } = props;
  const [dragging, setDragging] = reactExports.useState(false);
  const selfRef = reactExports.useRef(null);
  const extendedRef = reactExports.useRef(null);
  const pBounds = reactExports.useRef([]);
  const outlineDiv = reactExports.useRef(void 0);
  const handleDiv = reactExports.useRef(void 0);
  const dragStartX = reactExports.useRef(0);
  const dragStartY = reactExports.useRef(0);
  const initalSizes = reactExports.useRef({ initialSizes: [], sum: 0, startPosition: 0 });
  const size = node.getModel().getSplitterSize();
  let extra = node.getModel().getSplitterExtra();
  if (!isDesktop()) {
    extra = Math.max(30, extra + size) - size;
  }
  reactExports.useEffect(() => {
    var _a2, _b2;
    (_a2 = selfRef.current) === null || _a2 === void 0 ? void 0 : _a2.addEventListener("touchstart", onTouchStart, { passive: false });
    (_b2 = extendedRef.current) === null || _b2 === void 0 ? void 0 : _b2.addEventListener("touchstart", onTouchStart, { passive: false });
    return () => {
      var _a3, _b3;
      (_a3 = selfRef.current) === null || _a3 === void 0 ? void 0 : _a3.removeEventListener("touchstart", onTouchStart);
      (_b3 = extendedRef.current) === null || _b3 === void 0 ? void 0 : _b3.removeEventListener("touchstart", onTouchStart);
    };
  }, []);
  const onTouchStart = (event) => {
    event.preventDefault();
    event.stopImmediatePropagation();
  };
  const onPointerDown = (event) => {
    var _a2;
    event.stopPropagation();
    if (node instanceof RowNode$1) {
      initalSizes.current = node.getSplitterInitials(index2);
    }
    enablePointerOnIFrames(false, layout.getCurrentDocument());
    startDrag(event.currentTarget.ownerDocument, event, onDragMove, onDragEnd, onDragCancel);
    pBounds.current = node.getSplitterBounds(index2, true);
    const rootdiv = layout.getRootDiv();
    outlineDiv.current = layout.getCurrentDocument().createElement("div");
    outlineDiv.current.style.flexDirection = horizontal ? "row" : "column";
    outlineDiv.current.className = layout.getClassName(CLASSES.FLEXLAYOUT__SPLITTER_DRAG);
    outlineDiv.current.style.cursor = node.getOrientation() === Orientation.VERT ? "ns-resize" : "ew-resize";
    if (node.getModel().isSplitterEnableHandle()) {
      handleDiv.current = layout.getCurrentDocument().createElement("div");
      handleDiv.current.className = cm(CLASSES.FLEXLAYOUT__SPLITTER_HANDLE) + " " + (horizontal ? cm(CLASSES.FLEXLAYOUT__SPLITTER_HANDLE_HORZ) : cm(CLASSES.FLEXLAYOUT__SPLITTER_HANDLE_VERT));
      outlineDiv.current.appendChild(handleDiv.current);
    }
    const r2 = (_a2 = selfRef.current) === null || _a2 === void 0 ? void 0 : _a2.getBoundingClientRect();
    const rect = new Rect(r2.x - layout.getDomRect().x, r2.y - layout.getDomRect().y, r2.width, r2.height);
    dragStartX.current = event.clientX - r2.x;
    dragStartY.current = event.clientY - r2.y;
    rect.positionElement(outlineDiv.current);
    if (rootdiv) {
      rootdiv.appendChild(outlineDiv.current);
    }
    setDragging(true);
  };
  const onDragCancel = () => {
    const rootdiv = layout.getRootDiv();
    if (rootdiv && outlineDiv.current) {
      rootdiv.removeChild(outlineDiv.current);
    }
    outlineDiv.current = void 0;
    setDragging(false);
  };
  const onDragMove = (x2, y2) => {
    if (outlineDiv.current) {
      const clientRect = layout.getDomRect();
      if (!clientRect) {
        return;
      }
      if (node.getOrientation() === Orientation.VERT) {
        outlineDiv.current.style.top = getBoundPosition(y2 - clientRect.y - dragStartY.current) + "px";
      } else {
        outlineDiv.current.style.left = getBoundPosition(x2 - clientRect.x - dragStartX.current) + "px";
      }
      if (layout.isRealtimeResize()) {
        updateLayout();
      }
    }
  };
  const onDragEnd = () => {
    if (outlineDiv.current) {
      updateLayout();
      const rootdiv = layout.getRootDiv();
      if (rootdiv && outlineDiv.current) {
        rootdiv.removeChild(outlineDiv.current);
      }
      outlineDiv.current = void 0;
    }
    enablePointerOnIFrames(true, layout.getCurrentDocument());
    setDragging(false);
  };
  const updateLayout = (realtime) => {
    const redraw = () => {
      if (outlineDiv.current) {
        let value = 0;
        if (node.getOrientation() === Orientation.VERT) {
          value = outlineDiv.current.offsetTop;
        } else {
          value = outlineDiv.current.offsetLeft;
        }
        if (node instanceof BorderNode) {
          const pos = node.calculateSplit(node, value);
          layout.doAction(Actions.adjustBorderSplit(node.getId(), pos));
        } else {
          const init = initalSizes.current;
          const weights = node.calculateSplit(index2, value, init.initialSizes, init.sum, init.startPosition);
          layout.doAction(Actions.adjustWeights(node.getId(), weights));
        }
      }
    };
    redraw();
  };
  const getBoundPosition = (p2) => {
    const bounds = pBounds.current;
    let rtn = p2;
    if (p2 < bounds[0]) {
      rtn = bounds[0];
    }
    if (p2 > bounds[1]) {
      rtn = bounds[1];
    }
    return rtn;
  };
  const cm = layout.getClassName;
  const style2 = {
    cursor: horizontal ? "ew-resize" : "ns-resize",
    flexDirection: horizontal ? "column" : "row"
  };
  let className = cm(CLASSES.FLEXLAYOUT__SPLITTER) + " " + cm(CLASSES.FLEXLAYOUT__SPLITTER_ + node.getOrientation().getName());
  if (node instanceof BorderNode) {
    className += " " + cm(CLASSES.FLEXLAYOUT__SPLITTER_BORDER);
  } else {
    if (node.getModel().getMaximizedTabset(layout.getWindowId()) !== void 0) {
      style2.display = "none";
    }
  }
  if (horizontal) {
    style2.width = size + "px";
    style2.minWidth = size + "px";
  } else {
    style2.height = size + "px";
    style2.minHeight = size + "px";
  }
  let handle;
  if (!dragging && node.getModel().isSplitterEnableHandle()) {
    handle = reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__SPLITTER_HANDLE) + " " + (horizontal ? cm(CLASSES.FLEXLAYOUT__SPLITTER_HANDLE_HORZ) : cm(CLASSES.FLEXLAYOUT__SPLITTER_HANDLE_VERT)) });
  }
  if (extra === 0) {
    return reactExports.createElement("div", { className, style: style2, ref: selfRef, "data-layout-path": node.getPath() + "/s" + (index2 - 1), onPointerDown }, handle);
  } else {
    const style22 = {};
    if (node.getOrientation() === Orientation.HORZ) {
      style22.height = "100%";
      style22.width = size + extra + "px";
      style22.cursor = "ew-resize";
    } else {
      style22.height = size + extra + "px";
      style22.width = "100%";
      style22.cursor = "ns-resize";
    }
    const className2 = cm(CLASSES.FLEXLAYOUT__SPLITTER_EXTRA);
    return reactExports.createElement(
      "div",
      { className, style: style2, ref: selfRef, "data-layout-path": node.getPath() + "/s" + (index2 - 1), onPointerDown },
      reactExports.createElement("div", { style: style22, ref: extendedRef, className: className2, onPointerDown })
    );
  }
};
function BorderTab(props) {
  const { layout, border, show } = props;
  const selfRef = reactExports.useRef(null);
  reactExports.useLayoutEffect(() => {
    const outerRect = layout.getBoundingClientRect(selfRef.current);
    const contentRect = Rect.getContentRect(selfRef.current).relativeTo(layout.getDomRect());
    if (outerRect.width > 0) {
      border.setOuterRect(outerRect);
      if (!border.getContentRect().equals(contentRect)) {
        border.setContentRect(contentRect);
        layout.redrawInternal("border content rect");
      }
    }
  });
  let horizontal = true;
  const style2 = {};
  if (border.getOrientation() === Orientation.HORZ) {
    style2.width = border.getSize();
    style2.minWidth = border.getMinSize();
    style2.maxWidth = border.getMaxSize();
  } else {
    style2.height = border.getSize();
    style2.minHeight = border.getMinSize();
    style2.maxHeight = border.getMaxSize();
    horizontal = false;
  }
  style2.display = show ? "flex" : "none";
  const className = layout.getClassName(CLASSES.FLEXLAYOUT__BORDER_TAB_CONTENTS);
  if (border.getLocation() === DockLocation.LEFT || border.getLocation() === DockLocation.TOP) {
    return reactExports.createElement(
      reactExports.Fragment,
      null,
      reactExports.createElement("div", { ref: selfRef, style: style2, className }),
      show && reactExports.createElement(Splitter$1, { layout, node: border, index: 0, horizontal })
    );
  } else {
    return reactExports.createElement(
      reactExports.Fragment,
      null,
      show && reactExports.createElement(Splitter$1, { layout, node: border, index: 0, horizontal }),
      reactExports.createElement("div", { ref: selfRef, style: style2, className })
    );
  }
}
var ICloseType;
(function(ICloseType2) {
  ICloseType2[ICloseType2["Visible"] = 1] = "Visible";
  ICloseType2[ICloseType2["Always"] = 2] = "Always";
  ICloseType2[ICloseType2["Selected"] = 3] = "Selected";
})(ICloseType || (ICloseType = {}));
const BorderButton = (props) => {
  const { layout, node, selected, border, icons, path } = props;
  const selfRef = reactExports.useRef(null);
  const contentRef = reactExports.useRef(null);
  const onDragStart = (event) => {
    event.stopPropagation();
    layout.setDragNode(event.nativeEvent, node);
  };
  const onDragEnd = (event) => {
    event.stopPropagation();
    layout.clearDragMain();
  };
  const onAuxMouseClick = (event) => {
    if (isAuxMouseEvent(event)) {
      layout.auxMouseClick(node, event);
    }
  };
  const onContextMenu = (event) => {
    layout.showContextMenu(node, event);
  };
  const onClick = () => {
    layout.doAction(Actions.selectTab(node.getId()));
  };
  const isClosable = () => {
    const closeType = node.getCloseType();
    if (selected || closeType === ICloseType.Always) {
      return true;
    }
    if (closeType === ICloseType.Visible) {
      if (window.matchMedia && window.matchMedia("(hover: hover) and (pointer: fine)").matches) {
        return true;
      }
    }
    return false;
  };
  const onClose = (event) => {
    if (isClosable()) {
      layout.doAction(Actions.deleteTab(node.getId()));
    } else {
      onClick();
    }
  };
  const onClosePointerDown = (event) => {
    event.stopPropagation();
  };
  reactExports.useLayoutEffect(() => {
    node.setTabRect(layout.getBoundingClientRect(selfRef.current));
    if (layout.getEditingTab() === node) {
      contentRef.current.select();
    }
  });
  const onTextBoxPointerDown = (event) => {
    event.stopPropagation();
  };
  const onTextBoxKeyPress = (event) => {
    if (event.code === "Escape") {
      layout.setEditingTab(void 0);
    } else if (event.code === "Enter") {
      layout.setEditingTab(void 0);
      layout.doAction(Actions.renameTab(node.getId(), event.target.value));
    }
  };
  const cm = layout.getClassName;
  let classNames = cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON) + " " + cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON_ + border);
  if (selected) {
    classNames += " " + cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON__SELECTED);
  } else {
    classNames += " " + cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON__UNSELECTED);
  }
  if (node.getClassName() !== void 0) {
    classNames += " " + node.getClassName();
  }
  let iconAngle = 0;
  if (node.getModel().isEnableRotateBorderIcons() === false) {
    if (border === "left") {
      iconAngle = 90;
    } else if (border === "right") {
      iconAngle = -90;
    }
  }
  const renderState = getRenderStateEx(layout, node, iconAngle);
  let content = renderState.content ? reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON_CONTENT) }, renderState.content) : null;
  const leading = renderState.leading ? reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON_LEADING) }, renderState.leading) : null;
  if (layout.getEditingTab() === node) {
    content = reactExports.createElement("input", { ref: contentRef, className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_TEXTBOX), "data-layout-path": path + "/textbox", type: "text", autoFocus: true, defaultValue: node.getName(), onKeyDown: onTextBoxKeyPress, onPointerDown: onTextBoxPointerDown });
  }
  if (node.isEnableClose()) {
    const closeTitle = layout.i18nName(I18nLabel.Close_Tab);
    renderState.buttons.push(reactExports.createElement("div", { key: "close", "data-layout-path": path + "/button/close", title: closeTitle, className: cm(CLASSES.FLEXLAYOUT__BORDER_BUTTON_TRAILING), onPointerDown: onClosePointerDown, onClick: onClose }, typeof icons.close === "function" ? icons.close(node) : icons.close));
  }
  return reactExports.createElement(
    "div",
    { ref: selfRef, "data-layout-path": path, className: classNames, onClick, onAuxClick: onAuxMouseClick, onContextMenu, title: node.getHelpText(), draggable: true, onDragStart, onDragEnd },
    leading,
    content,
    renderState.buttons
  );
};
const TabButtonStamp = (props) => {
  const { layout, node } = props;
  const cm = layout.getClassName;
  let classNames = cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_STAMP);
  const renderState = getRenderStateEx(layout, node);
  let content = renderState.content ? reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_CONTENT) }, renderState.content) : node.getNameForOverflowMenu();
  const leading = renderState.leading ? reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_LEADING) }, renderState.leading) : null;
  return reactExports.createElement(
    "div",
    { className: classNames, title: node.getHelpText() },
    leading,
    content
  );
};
function showPopup(triggerElement, items, onSelect, layout) {
  var _a2;
  const layoutDiv = layout.getRootDiv();
  const classNameMapper = layout.getClassName;
  const currentDocument = triggerElement.ownerDocument;
  const triggerRect = triggerElement.getBoundingClientRect();
  const layoutRect = (_a2 = layoutDiv === null || layoutDiv === void 0 ? void 0 : layoutDiv.getBoundingClientRect()) !== null && _a2 !== void 0 ? _a2 : new DOMRect(0, 0, 100, 100);
  const elm = currentDocument.createElement("div");
  elm.className = classNameMapper(CLASSES.FLEXLAYOUT__POPUP_MENU_CONTAINER);
  if (triggerRect.left < layoutRect.left + layoutRect.width / 2) {
    elm.style.left = triggerRect.left - layoutRect.left + "px";
  } else {
    elm.style.right = layoutRect.right - triggerRect.right + "px";
  }
  if (triggerRect.top < layoutRect.top + layoutRect.height / 2) {
    elm.style.top = triggerRect.top - layoutRect.top + "px";
  } else {
    elm.style.bottom = layoutRect.bottom - triggerRect.bottom + "px";
  }
  layout.showOverlay(true);
  if (layoutDiv) {
    layoutDiv.appendChild(elm);
  }
  const onHide = () => {
    layout.hideControlInPortal();
    layout.showOverlay(false);
    if (layoutDiv) {
      layoutDiv.removeChild(elm);
    }
    elm.removeEventListener("pointerdown", onElementPointerDown);
    currentDocument.removeEventListener("pointerdown", onDocPointerDown);
  };
  const onElementPointerDown = (event) => {
    event.stopPropagation();
  };
  const onDocPointerDown = (_event) => {
    onHide();
  };
  elm.addEventListener("pointerdown", onElementPointerDown);
  currentDocument.addEventListener("pointerdown", onDocPointerDown);
  layout.showControlInPortal(reactExports.createElement(PopupMenu, { currentDocument, onSelect, onHide, items, classNameMapper, layout }), elm);
}
const PopupMenu = (props) => {
  const { items, onHide, onSelect, classNameMapper, layout } = props;
  const onItemClick = (item, event) => {
    onSelect(item);
    onHide();
    event.stopPropagation();
  };
  const onDragStart = (event, node) => {
    event.stopPropagation();
    layout.setDragNode(event.nativeEvent, node);
    setTimeout(() => {
      onHide();
    }, 0);
  };
  const onDragEnd = (event) => {
    layout.clearDragMain();
  };
  const itemElements = items.map((item, i) => reactExports.createElement(
    "div",
    { key: item.index, className: classNameMapper(CLASSES.FLEXLAYOUT__POPUP_MENU_ITEM), "data-layout-path": "/popup-menu/tb" + i, onClick: (event) => onItemClick(item, event), draggable: true, onDragStart: (e) => onDragStart(e, item.node), onDragEnd, title: item.node.getHelpText() },
    reactExports.createElement(TabButtonStamp, { node: item.node, layout })
  ));
  return reactExports.createElement("div", { className: classNameMapper(CLASSES.FLEXLAYOUT__POPUP_MENU), "data-layout-path": "/popup-menu" }, itemElements);
};
const useTabOverflow = (node, orientation, toolbarRef, stickyButtonsRef) => {
  const firstRender = reactExports.useRef(true);
  const tabsTruncated = reactExports.useRef(false);
  const lastRect = reactExports.useRef(Rect.empty());
  const selfRef = reactExports.useRef(null);
  const [position, setPosition] = reactExports.useState(0);
  const userControlledLeft = reactExports.useRef(false);
  const [hiddenTabs, setHiddenTabs] = reactExports.useState([]);
  const lastHiddenCount = reactExports.useRef(0);
  reactExports.useLayoutEffect(() => {
    userControlledLeft.current = false;
  }, [node.getSelectedNode(), node.getRect().width, node.getRect().height]);
  reactExports.useLayoutEffect(() => {
    const nodeRect = node instanceof TabSetNode ? node.getRect() : node.getTabHeaderRect();
    if (nodeRect.width > 0 && nodeRect.height > 0) {
      updateVisibleTabs();
    }
  });
  const instance = toolbarRef.current;
  reactExports.useEffect(() => {
    if (!instance) {
      return;
    }
    instance.addEventListener("wheel", onWheel, { passive: false });
    return () => {
      instance.removeEventListener("wheel", onWheel);
    };
  }, [instance]);
  const onWheel = (event) => {
    event.preventDefault();
  };
  const getNear = (rect) => {
    if (orientation === Orientation.HORZ) {
      return rect.x;
    } else {
      return rect.y;
    }
  };
  const getFar = (rect) => {
    if (orientation === Orientation.HORZ) {
      return rect.getRight();
    } else {
      return rect.getBottom();
    }
  };
  const getSize = (rect) => {
    if (orientation === Orientation.HORZ) {
      return rect.width;
    } else {
      return rect.height;
    }
  };
  const updateVisibleTabs = () => {
    const tabMargin = 2;
    if (firstRender.current === true) {
      tabsTruncated.current = false;
    }
    const nodeRect = node instanceof TabSetNode ? node.getRect() : node.getTabHeaderRect();
    let lastChild = node.getChildren()[node.getChildren().length - 1];
    const stickyButtonsSize = stickyButtonsRef.current === null ? 0 : getSize(stickyButtonsRef.current.getBoundingClientRect());
    if (firstRender.current === true || lastHiddenCount.current === 0 && hiddenTabs.length !== 0 || nodeRect.width !== lastRect.current.width || // incase rect changed between first render and second
    nodeRect.height !== lastRect.current.height) {
      lastHiddenCount.current = hiddenTabs.length;
      lastRect.current = nodeRect;
      const enabled = node instanceof TabSetNode ? node.isEnableTabStrip() === true : true;
      let endPos = getFar(nodeRect) - stickyButtonsSize;
      if (toolbarRef.current !== null) {
        endPos -= getSize(toolbarRef.current.getBoundingClientRect());
      }
      if (enabled && node.getChildren().length > 0) {
        if (hiddenTabs.length === 0 && position === 0 && getFar(lastChild.getTabRect()) + tabMargin < endPos) {
          return;
        }
        let shiftPos = 0;
        const selectedTab = node.getSelectedNode();
        if (selectedTab && !userControlledLeft.current) {
          const selectedRect = selectedTab.getTabRect();
          const selectedStart = getNear(selectedRect) - tabMargin;
          const selectedEnd = getFar(selectedRect) + tabMargin;
          if (getSize(selectedRect) + 2 * tabMargin >= endPos - getNear(nodeRect)) {
            shiftPos = getNear(nodeRect) - selectedStart;
          } else {
            if (selectedEnd > endPos || selectedStart < getNear(nodeRect)) {
              if (selectedStart < getNear(nodeRect)) {
                shiftPos = getNear(nodeRect) - selectedStart;
              }
              if (selectedEnd + shiftPos > endPos) {
                shiftPos = endPos - selectedEnd;
              }
            }
          }
        }
        const extraSpace = Math.max(0, endPos - (getFar(lastChild.getTabRect()) + tabMargin + shiftPos));
        const newPosition = Math.min(0, position + shiftPos + extraSpace);
        const diff2 = newPosition - position;
        const hidden = [];
        for (let i = 0; i < node.getChildren().length; i++) {
          const child = node.getChildren()[i];
          if (getNear(child.getTabRect()) + diff2 < getNear(nodeRect) || getFar(child.getTabRect()) + diff2 > endPos) {
            hidden.push({ node: child, index: i });
          }
        }
        tabsTruncated.current = hidden.length > 0;
        firstRender.current = false;
        setHiddenTabs(hidden);
        setPosition(newPosition);
      }
    } else {
      firstRender.current = true;
    }
  };
  const onMouseWheel = (event) => {
    let delta = 0;
    if (Math.abs(event.deltaX) > Math.abs(event.deltaY)) {
      delta = -event.deltaX;
    } else {
      delta = -event.deltaY;
    }
    if (event.deltaMode === 1) {
      delta *= 40;
    }
    setPosition(position + delta);
    userControlledLeft.current = true;
    event.stopPropagation();
  };
  return { selfRef, position, userControlledLeft, hiddenTabs, onMouseWheel, tabsTruncated: tabsTruncated.current };
};
const BorderTabSet = (props) => {
  const { border, layout, size } = props;
  const toolbarRef = reactExports.useRef(null);
  const overflowbuttonRef = reactExports.useRef(null);
  const stickyButtonsRef = reactExports.useRef(null);
  const icons = layout.getIcons();
  reactExports.useLayoutEffect(() => {
    border.setTabHeaderRect(Rect.getBoundingClientRect(selfRef.current).relativeTo(layout.getDomRect()));
  });
  const { selfRef, position, userControlledLeft, hiddenTabs, onMouseWheel, tabsTruncated } = useTabOverflow(border, Orientation.flip(border.getOrientation()), toolbarRef, stickyButtonsRef);
  const onAuxMouseClick = (event) => {
    if (isAuxMouseEvent(event)) {
      layout.auxMouseClick(border, event);
    }
  };
  const onContextMenu = (event) => {
    layout.showContextMenu(border, event);
  };
  const onInterceptPointerDown = (event) => {
    event.stopPropagation();
  };
  const onOverflowClick = (event) => {
    const callback2 = layout.getShowOverflowMenu();
    if (callback2 !== void 0) {
      callback2(border, event, hiddenTabs, onOverflowItemSelect);
    } else {
      const element = overflowbuttonRef.current;
      showPopup(element, hiddenTabs, onOverflowItemSelect, layout);
    }
    event.stopPropagation();
  };
  const onOverflowItemSelect = (item) => {
    layout.doAction(Actions.selectTab(item.node.getId()));
    userControlledLeft.current = false;
  };
  const onPopoutTab = (event) => {
    const selectedTabNode = border.getChildren()[border.getSelected()];
    if (selectedTabNode !== void 0) {
      layout.doAction(Actions.popoutTab(selectedTabNode.getId()));
    }
    event.stopPropagation();
  };
  const cm = layout.getClassName;
  const tabButtons = [];
  const layoutTab = (i) => {
    let isSelected = border.getSelected() === i;
    let child = border.getChildren()[i];
    tabButtons.push(reactExports.createElement(BorderButton, { layout, border: border.getLocation().getName(), node: child, path: border.getPath() + "/tb" + i, key: child.getId(), selected: isSelected, icons }));
    if (i < border.getChildren().length - 1) {
      tabButtons.push(reactExports.createElement("div", { key: "divider" + i, className: cm(CLASSES.FLEXLAYOUT__BORDER_TAB_DIVIDER) }));
    }
  };
  for (let i = 0; i < border.getChildren().length; i++) {
    layoutTab(i);
  }
  let borderClasses = cm(CLASSES.FLEXLAYOUT__BORDER) + " " + cm(CLASSES.FLEXLAYOUT__BORDER_ + border.getLocation().getName());
  if (border.getClassName() !== void 0) {
    borderClasses += " " + border.getClassName();
  }
  let buttons = [];
  let stickyButtons = [];
  const renderState = { buttons, stickyButtons, overflowPosition: void 0 };
  layout.customizeTabSet(border, renderState);
  buttons = renderState.buttons;
  if (renderState.overflowPosition === void 0) {
    renderState.overflowPosition = stickyButtons.length;
  }
  if (stickyButtons.length > 0) {
    if (tabsTruncated) {
      buttons = [...stickyButtons, ...buttons];
    } else {
      tabButtons.push(reactExports.createElement("div", { ref: stickyButtonsRef, key: "sticky_buttons_container", onPointerDown: onInterceptPointerDown, onDragStart: (e) => {
        e.preventDefault();
      }, className: cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_STICKY_BUTTONS_CONTAINER) }, stickyButtons));
    }
  }
  if (hiddenTabs.length > 0) {
    const overflowTitle = layout.i18nName(I18nLabel.Overflow_Menu_Tooltip);
    let overflowContent;
    if (typeof icons.more === "function") {
      overflowContent = icons.more(border, hiddenTabs);
    } else {
      overflowContent = reactExports.createElement(
        reactExports.Fragment,
        null,
        icons.more,
        reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_OVERFLOW_COUNT) }, hiddenTabs.length)
      );
    }
    buttons.splice(Math.min(renderState.overflowPosition, buttons.length), 0, reactExports.createElement("button", { key: "overflowbutton", ref: overflowbuttonRef, className: cm(CLASSES.FLEXLAYOUT__BORDER_TOOLBAR_BUTTON) + " " + cm(CLASSES.FLEXLAYOUT__BORDER_TOOLBAR_BUTTON_OVERFLOW) + " " + cm(CLASSES.FLEXLAYOUT__BORDER_TOOLBAR_BUTTON_OVERFLOW_ + border.getLocation().getName()), title: overflowTitle, onClick: onOverflowClick, onPointerDown: onInterceptPointerDown }, overflowContent));
  }
  const selectedIndex = border.getSelected();
  if (selectedIndex !== -1) {
    const selectedTabNode = border.getChildren()[selectedIndex];
    if (selectedTabNode !== void 0 && layout.isSupportsPopout() && selectedTabNode.isEnablePopout()) {
      const popoutTitle = layout.i18nName(I18nLabel.Popout_Tab);
      buttons.push(reactExports.createElement("button", { key: "popout", title: popoutTitle, className: cm(CLASSES.FLEXLAYOUT__BORDER_TOOLBAR_BUTTON) + " " + cm(CLASSES.FLEXLAYOUT__BORDER_TOOLBAR_BUTTON_FLOAT), onClick: onPopoutTab, onPointerDown: onInterceptPointerDown }, typeof icons.popout === "function" ? icons.popout(selectedTabNode) : icons.popout));
    }
  }
  const toolbar = reactExports.createElement("div", { key: "toolbar", ref: toolbarRef, className: cm(CLASSES.FLEXLAYOUT__BORDER_TOOLBAR) + " " + cm(CLASSES.FLEXLAYOUT__BORDER_TOOLBAR_ + border.getLocation().getName()) }, buttons);
  let innerStyle = {};
  let outerStyle = {};
  const borderHeight = size - 1;
  if (border.getLocation() === DockLocation.LEFT) {
    innerStyle = { right: "100%", top: position };
    outerStyle = { width: borderHeight };
  } else if (border.getLocation() === DockLocation.RIGHT) {
    innerStyle = { left: "100%", top: position };
    outerStyle = { width: borderHeight };
  } else {
    innerStyle = { left: position };
    outerStyle = { height: borderHeight };
  }
  return reactExports.createElement(
    "div",
    { ref: selfRef, style: {
      display: "flex",
      flexDirection: border.getOrientation() === Orientation.VERT ? "row" : "column"
    }, className: borderClasses, "data-layout-path": border.getPath(), onClick: onAuxMouseClick, onAuxClick: onAuxMouseClick, onContextMenu, onWheel: onMouseWheel },
    reactExports.createElement(
      "div",
      { style: outerStyle, className: cm(CLASSES.FLEXLAYOUT__BORDER_INNER) + " " + cm(CLASSES.FLEXLAYOUT__BORDER_INNER_ + border.getLocation().getName()) },
      reactExports.createElement("div", { style: innerStyle, className: cm(CLASSES.FLEXLAYOUT__BORDER_INNER_TAB_CONTAINER) + " " + cm(CLASSES.FLEXLAYOUT__BORDER_INNER_TAB_CONTAINER_ + border.getLocation().getName()) }, tabButtons)
    ),
    toolbar
  );
};
const DragContainer = (props) => {
  const { layout, node } = props;
  const selfRef = reactExports.useRef(null);
  reactExports.useEffect(() => {
    node.setTabStamp(selfRef.current);
  }, [node, selfRef.current]);
  const cm = layout.getClassName;
  let classNames = cm(CLASSES.FLEXLAYOUT__DRAG_RECT);
  return reactExports.createElement(
    "div",
    { ref: selfRef, className: classNames },
    reactExports.createElement(TabButtonStamp, { key: node.getId(), layout, node })
  );
};
class ErrorBoundary extends reactExports.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false };
  }
  static getDerivedStateFromError(error) {
    return { hasError: true };
  }
  componentDidCatch(error, errorInfo) {
    console.debug(error);
    console.debug(errorInfo);
  }
  render() {
    if (this.state.hasError) {
      return reactExports.createElement(
        "div",
        { className: CLASSES.FLEXLAYOUT__ERROR_BOUNDARY_CONTAINER },
        reactExports.createElement("div", { className: CLASSES.FLEXLAYOUT__ERROR_BOUNDARY_CONTENT }, this.props.message)
      );
    }
    return this.props.children;
  }
}
const PopoutWindow = (props) => {
  const { title, layout, layoutWindow, url, onCloseWindow, onSetWindow, children } = props;
  const popoutWindow = reactExports.useRef(null);
  const [content, setContent] = reactExports.useState(void 0);
  const styleMap = /* @__PURE__ */ new Map();
  reactExports.useLayoutEffect(() => {
    if (!popoutWindow.current) {
      const windowId = layoutWindow.windowId;
      const rect = layoutWindow.rect;
      popoutWindow.current = window.open(url, windowId, `left=${rect.x},top=${rect.y},width=${rect.width},height=${rect.height}`);
      if (popoutWindow.current) {
        layoutWindow.window = popoutWindow.current;
        onSetWindow(layoutWindow, popoutWindow.current);
        window.addEventListener("beforeunload", () => {
          if (popoutWindow.current) {
            const closedWindow = popoutWindow.current;
            popoutWindow.current = null;
            closedWindow.close();
          }
        });
        popoutWindow.current.addEventListener("load", () => {
          if (popoutWindow.current) {
            popoutWindow.current.focus();
            popoutWindow.current.resizeTo(rect.width, rect.height);
            popoutWindow.current.moveTo(rect.x, rect.y);
            const popoutDocument = popoutWindow.current.document;
            popoutDocument.title = title;
            const popoutContent = popoutDocument.createElement("div");
            popoutContent.className = CLASSES.FLEXLAYOUT__FLOATING_WINDOW_CONTENT;
            popoutDocument.body.appendChild(popoutContent);
            copyStyles(popoutDocument, styleMap).then(() => {
              setContent(popoutContent);
            });
            const observer = new MutationObserver((mutationsList) => handleStyleMutations(mutationsList, popoutDocument, styleMap));
            observer.observe(document.head, { childList: true });
            popoutWindow.current.addEventListener("beforeunload", () => {
              if (popoutWindow.current) {
                onCloseWindow(layoutWindow);
                popoutWindow.current = null;
                observer.disconnect();
              }
            });
          }
        });
      } else {
        console.warn(`Unable to open window ${url}`);
        onCloseWindow(layoutWindow);
      }
    }
    return () => {
      var _a2;
      if (!layout.getModel().getwindowsMap().has(layoutWindow.windowId)) {
        (_a2 = popoutWindow.current) === null || _a2 === void 0 ? void 0 : _a2.close();
        popoutWindow.current = null;
      }
    };
  }, []);
  if (content !== void 0) {
    return reactDomExports.createPortal(children, content);
  } else {
    return null;
  }
};
function handleStyleMutations(mutationsList, popoutDocument, styleMap) {
  for (const mutation of mutationsList) {
    if (mutation.type === "childList") {
      for (const addition of mutation.addedNodes) {
        if (addition instanceof HTMLLinkElement || addition instanceof HTMLStyleElement) {
          copyStyle(popoutDocument, addition, styleMap);
        }
      }
      for (const removal of mutation.removedNodes) {
        if (removal instanceof HTMLLinkElement || removal instanceof HTMLStyleElement) {
          const popoutStyle = styleMap.get(removal);
          if (popoutStyle) {
            popoutDocument.head.removeChild(popoutStyle);
          }
        }
      }
    }
  }
}
function copyStyles(popoutDoc, styleMap) {
  const promises = [];
  const styleElements = document.querySelectorAll('style, link[rel="stylesheet"]');
  for (const element of styleElements) {
    copyStyle(popoutDoc, element, styleMap, promises);
  }
  return Promise.all(promises);
}
function copyStyle(popoutDoc, element, styleMap, promises) {
  if (element instanceof HTMLLinkElement) {
    const linkElement = element.cloneNode(true);
    popoutDoc.head.appendChild(linkElement);
    styleMap.set(element, linkElement);
    if (promises) {
      promises.push(new Promise((resolve2) => {
        linkElement.onload = () => resolve2(true);
      }));
    }
  } else if (element instanceof HTMLStyleElement) {
    try {
      const styleElement = element.cloneNode(true);
      popoutDoc.head.appendChild(styleElement);
      styleMap.set(element, styleElement);
    } catch (e) {
    }
  }
}
const style = { width: "1em", height: "1em", display: "flex", alignItems: "center" };
const CloseIcon = () => {
  return reactExports.createElement(
    "svg",
    { xmlns: "http://www.w3.org/2000/svg", style, viewBox: "0 0 24 24" },
    reactExports.createElement("path", { fill: "none", d: "M0 0h24v24H0z" }),
    reactExports.createElement("path", { stroke: "var(--color-icon)", fill: "var(--color-icon)", d: "M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" })
  );
};
const MaximizeIcon = () => {
  return reactExports.createElement(
    "svg",
    { xmlns: "http://www.w3.org/2000/svg", style, viewBox: "0 0 24 24", fill: "var(--color-icon)" },
    reactExports.createElement("path", { d: "M0 0h24v24H0z", fill: "none" }),
    reactExports.createElement("path", { stroke: "var(--color-icon)", d: "M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z" })
  );
};
const OverflowIcon = () => {
  return reactExports.createElement(
    "svg",
    { xmlns: "http://www.w3.org/2000/svg", style, viewBox: "0 0 24 24", fill: "var(--color-icon)" },
    reactExports.createElement("path", { d: "M0 0h24v24H0z", fill: "none" }),
    reactExports.createElement("path", { stroke: "var(--color-icon)", d: "M7 10l5 5 5-5z" })
  );
};
const EdgeIcon = () => {
  return reactExports.createElement(
    "svg",
    { xmlns: "http://www.w3.org/2000/svg", style: { display: "block", width: 10, height: 10 }, preserveAspectRatio: "none", viewBox: "0 0 100 100" },
    reactExports.createElement("path", { fill: "var(--color-edge-icon)", stroke: "var(--color-edge-icon)", d: "M10 30 L90 30 l-40 40 Z" })
  );
};
const PopoutIcon = () => {
  return (
    // <svg xmlns="http://www.w3.org/2000/svg"  style={style}  viewBox="0 0 24 24" fill="var(--color-icon)"><path d="M0 0h24v24H0z" fill="none"/><path stroke="var(--color-icon)" d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5z"/></svg>
    // <svg xmlns="http://www.w3.org/2000/svg" style={style} fill="none" viewBox="0 0 24 24" stroke="var(--color-icon)" stroke-width="2">
    //     <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
    // </svg>
    reactExports.createElement(
      "svg",
      { xmlns: "http://www.w3.org/2000/svg", style, viewBox: "0 0 20 20", fill: "var(--color-icon)" },
      reactExports.createElement("path", { d: "M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z" }),
      reactExports.createElement("path", { d: "M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z" })
    )
  );
};
const RestoreIcon = () => {
  return reactExports.createElement(
    "svg",
    { xmlns: "http://www.w3.org/2000/svg", style, viewBox: "0 0 24 24", fill: "var(--color-icon)" },
    reactExports.createElement("path", { d: "M0 0h24v24H0z", fill: "none" }),
    reactExports.createElement("path", { stroke: "var(--color-icon)", d: "M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z" })
  );
};
const AsterickIcon = () => {
  return reactExports.createElement(
    "svg",
    { xmlns: "http://www.w3.org/2000/svg", style, height: "24px", viewBox: "0 -960 960 960", width: "24px" },
    reactExports.createElement("path", { fill: "var(--color-icon)", stroke: "var(--color-icon)", d: "M440-120v-264L254-197l-57-57 187-186H120v-80h264L197-706l57-57 186 187v-264h80v264l186-187 57 57-187 186h264v80H576l187 186-57 57-186-187v264h-80Z" })
  );
};
const Overlay = (props) => {
  const { layout, show } = props;
  return reactExports.createElement("div", { className: layout.getClassName(CLASSES.FLEXLAYOUT__LAYOUT_OVERLAY), style: {
    display: show ? "flex" : "none"
  } });
};
const TabButton = (props) => {
  const { layout, node, selected, path } = props;
  const selfRef = reactExports.useRef(null);
  const contentRef = reactExports.useRef(null);
  const icons = layout.getIcons();
  reactExports.useLayoutEffect(() => {
    node.setTabRect(layout.getBoundingClientRect(selfRef.current));
    if (layout.getEditingTab() === node) {
      contentRef.current.select();
    }
  });
  const onDragStart = (event) => {
    event.stopPropagation();
    layout.setDragNode(event.nativeEvent, node);
  };
  const onDragEnd = (event) => {
    layout.clearDragMain();
  };
  const onAuxMouseClick = (event) => {
    if (isAuxMouseEvent(event)) {
      layout.auxMouseClick(node, event);
    }
  };
  const onContextMenu = (event) => {
    layout.showContextMenu(node, event);
  };
  const onClick = () => {
    layout.doAction(Actions.selectTab(node.getId()));
  };
  const onDoubleClick = (event) => {
    if (node.isEnableRename()) {
      onRename();
      event.stopPropagation();
    }
  };
  const onRename = () => {
    layout.setEditingTab(node);
    layout.getCurrentDocument().body.addEventListener("pointerdown", onEndEdit);
  };
  const onEndEdit = (event) => {
    if (event.target !== contentRef.current) {
      layout.getCurrentDocument().body.removeEventListener("pointerdown", onEndEdit);
      layout.setEditingTab(void 0);
    }
  };
  const isClosable = () => {
    const closeType = node.getCloseType();
    if (selected || closeType === ICloseType.Always) {
      return true;
    }
    if (closeType === ICloseType.Visible) {
      if (window.matchMedia && window.matchMedia("(hover: hover) and (pointer: fine)").matches) {
        return true;
      }
    }
    return false;
  };
  const onClose = (event) => {
    if (isClosable()) {
      layout.doAction(Actions.deleteTab(node.getId()));
    } else {
      onClick();
    }
  };
  const onClosePointerDown = (event) => {
    event.stopPropagation();
  };
  const onTextBoxPointerDown = (event) => {
    event.stopPropagation();
  };
  const onTextBoxKeyPress = (event) => {
    if (event.code === "Escape") {
      layout.setEditingTab(void 0);
    } else if (event.code === "Enter") {
      layout.setEditingTab(void 0);
      layout.doAction(Actions.renameTab(node.getId(), event.target.value));
    }
  };
  const cm = layout.getClassName;
  const parentNode = node.getParent();
  const isStretch = parentNode.isEnableSingleTabStretch() && parentNode.getChildren().length === 1;
  let baseClassName = isStretch ? CLASSES.FLEXLAYOUT__TAB_BUTTON_STRETCH : CLASSES.FLEXLAYOUT__TAB_BUTTON;
  let classNames = cm(baseClassName);
  classNames += " " + cm(baseClassName + "_" + parentNode.getTabLocation());
  if (!isStretch) {
    if (selected) {
      classNames += " " + cm(baseClassName + "--selected");
    } else {
      classNames += " " + cm(baseClassName + "--unselected");
    }
  }
  if (node.getClassName() !== void 0) {
    classNames += " " + node.getClassName();
  }
  const renderState = getRenderStateEx(layout, node);
  let content = renderState.content ? reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_CONTENT) }, renderState.content) : null;
  const leading = renderState.leading ? reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_LEADING) }, renderState.leading) : null;
  if (layout.getEditingTab() === node) {
    content = reactExports.createElement("input", { ref: contentRef, className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_TEXTBOX), "data-layout-path": path + "/textbox", type: "text", autoFocus: true, defaultValue: node.getName(), onKeyDown: onTextBoxKeyPress, onPointerDown: onTextBoxPointerDown });
  }
  if (node.isEnableClose() && !isStretch) {
    const closeTitle = layout.i18nName(I18nLabel.Close_Tab);
    renderState.buttons.push(reactExports.createElement("div", { key: "close", "data-layout-path": path + "/button/close", title: closeTitle, className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_TRAILING), onPointerDown: onClosePointerDown, onClick: onClose }, typeof icons.close === "function" ? icons.close(node) : icons.close));
  }
  return reactExports.createElement(
    "div",
    { ref: selfRef, "data-layout-path": path, className: classNames, onClick, onAuxClick: onAuxMouseClick, onContextMenu, title: node.getHelpText(), draggable: true, onDragStart, onDragEnd, onDoubleClick },
    leading,
    content,
    renderState.buttons
  );
};
const TabSet = (props) => {
  const { node, layout } = props;
  const tabStripRef = reactExports.useRef(null);
  const tabStripInnerRef = reactExports.useRef(null);
  const contentRef = reactExports.useRef(null);
  const buttonBarRef = reactExports.useRef(null);
  const overflowbuttonRef = reactExports.useRef(null);
  const stickyButtonsRef = reactExports.useRef(null);
  const icons = layout.getIcons();
  reactExports.useEffect(() => {
    node.setRect(layout.getBoundingClientRect(selfRef.current));
    if (tabStripRef.current) {
      node.setTabStripRect(layout.getBoundingClientRect(tabStripRef.current));
    }
    const newContentRect = Rect.getContentRect(contentRef.current).relativeTo(layout.getDomRect());
    if (!node.getContentRect().equals(newContentRect)) {
      node.setContentRect(newContentRect);
      layout.redrawInternal("tabset content rect " + newContentRect);
    }
  });
  const { selfRef, position, userControlledLeft, hiddenTabs, onMouseWheel, tabsTruncated } = useTabOverflow(node, Orientation.HORZ, buttonBarRef, stickyButtonsRef);
  const onOverflowClick = (event) => {
    const callback2 = layout.getShowOverflowMenu();
    if (callback2 !== void 0) {
      callback2(node, event, hiddenTabs, onOverflowItemSelect);
    } else {
      const element = overflowbuttonRef.current;
      showPopup(element, hiddenTabs, onOverflowItemSelect, layout);
    }
    event.stopPropagation();
  };
  const onOverflowItemSelect = (item) => {
    layout.doAction(Actions.selectTab(item.node.getId()));
    userControlledLeft.current = false;
  };
  const onDragStart = (event) => {
    if (!layout.getEditingTab()) {
      event.stopPropagation();
      layout.setDragNode(event.nativeEvent, node);
    } else {
      event.preventDefault();
    }
  };
  const onPointerDown = (event) => {
    if (!isAuxMouseEvent(event)) {
      node.getName();
      layout.doAction(Actions.setActiveTabset(node.getId(), layout.getWindowId()));
    }
  };
  const onAuxMouseClick = (event) => {
    if (isAuxMouseEvent(event)) {
      layout.auxMouseClick(node, event);
    }
  };
  const onContextMenu = (event) => {
    layout.showContextMenu(node, event);
  };
  const onInterceptPointerDown = (event) => {
    event.stopPropagation();
  };
  const onMaximizeToggle = (event) => {
    if (node.canMaximize()) {
      layout.maximize(node);
    }
    event.stopPropagation();
  };
  const onClose = (event) => {
    layout.doAction(Actions.deleteTabset(node.getId()));
    event.stopPropagation();
  };
  const onCloseTab = (event) => {
    layout.doAction(Actions.deleteTab(node.getChildren()[0].getId()));
    event.stopPropagation();
  };
  const onPopoutTab = (event) => {
    if (selectedTabNode !== void 0) {
      layout.doAction(Actions.popoutTab(selectedTabNode.getId()));
    }
    event.stopPropagation();
  };
  const onDoubleClick = (event) => {
    if (node.canMaximize()) {
      layout.maximize(node);
    }
  };
  const cm = layout.getClassName;
  if (tabStripInnerRef.current !== null && tabStripInnerRef.current.scrollLeft !== 0) {
    tabStripInnerRef.current.scrollLeft = 0;
  }
  const selectedTabNode = node.getSelectedNode();
  const path = node.getPath();
  const tabs = [];
  if (node.isEnableTabStrip()) {
    for (let i = 0; i < node.getChildren().length; i++) {
      const child = node.getChildren()[i];
      let isSelected = node.getSelected() === i;
      tabs.push(reactExports.createElement(TabButton, { layout, node: child, path: path + "/tb" + i, key: child.getId(), selected: isSelected }));
      if (i < node.getChildren().length - 1) {
        tabs.push(reactExports.createElement("div", { key: "divider" + i, className: cm(CLASSES.FLEXLAYOUT__TABSET_TAB_DIVIDER) }));
      }
    }
  }
  let stickyButtons = [];
  let buttons = [];
  const renderState = { stickyButtons, buttons, overflowPosition: void 0 };
  layout.customizeTabSet(node, renderState);
  stickyButtons = renderState.stickyButtons;
  buttons = renderState.buttons;
  const isTabStretch = node.isEnableSingleTabStretch() && node.getChildren().length === 1;
  const showClose = isTabStretch && node.getChildren()[0].isEnableClose() || node.isEnableClose();
  if (renderState.overflowPosition === void 0) {
    renderState.overflowPosition = stickyButtons.length;
  }
  if (stickyButtons.length > 0) {
    if (!node.isEnableTabWrap() && (tabsTruncated || isTabStretch)) {
      buttons = [...stickyButtons, ...buttons];
    } else {
      tabs.push(reactExports.createElement("div", { ref: stickyButtonsRef, key: "sticky_buttons_container", onPointerDown: onInterceptPointerDown, onDragStart: (e) => {
        e.preventDefault();
      }, className: cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_STICKY_BUTTONS_CONTAINER) }, stickyButtons));
    }
  }
  if (!node.isEnableTabWrap()) {
    if (hiddenTabs.length > 0) {
      const overflowTitle = layout.i18nName(I18nLabel.Overflow_Menu_Tooltip);
      let overflowContent;
      if (typeof icons.more === "function") {
        overflowContent = icons.more(node, hiddenTabs);
      } else {
        overflowContent = reactExports.createElement(
          reactExports.Fragment,
          null,
          icons.more,
          reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_OVERFLOW_COUNT) }, hiddenTabs.length)
        );
      }
      buttons.splice(Math.min(renderState.overflowPosition, buttons.length), 0, reactExports.createElement("button", { key: "overflowbutton", "data-layout-path": path + "/button/overflow", ref: overflowbuttonRef, className: cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_BUTTON) + " " + cm(CLASSES.FLEXLAYOUT__TAB_BUTTON_OVERFLOW), title: overflowTitle, onClick: onOverflowClick, onPointerDown: onInterceptPointerDown }, overflowContent));
    }
  }
  if (selectedTabNode !== void 0 && layout.isSupportsPopout() && selectedTabNode.isEnablePopout() && selectedTabNode.isEnablePopoutIcon()) {
    const popoutTitle = layout.i18nName(I18nLabel.Popout_Tab);
    buttons.push(reactExports.createElement("button", { key: "popout", "data-layout-path": path + "/button/popout", title: popoutTitle, className: cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_BUTTON) + " " + cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_BUTTON_FLOAT), onClick: onPopoutTab, onPointerDown: onInterceptPointerDown }, typeof icons.popout === "function" ? icons.popout(selectedTabNode) : icons.popout));
  }
  if (node.canMaximize()) {
    const minTitle = layout.i18nName(I18nLabel.Restore);
    const maxTitle = layout.i18nName(I18nLabel.Maximize);
    buttons.push(reactExports.createElement("button", { key: "max", "data-layout-path": path + "/button/max", title: node.isMaximized() ? minTitle : maxTitle, className: cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_BUTTON) + " " + cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_BUTTON_ + (node.isMaximized() ? "max" : "min")), onClick: onMaximizeToggle, onPointerDown: onInterceptPointerDown }, node.isMaximized() ? typeof icons.restore === "function" ? icons.restore(node) : icons.restore : typeof icons.maximize === "function" ? icons.maximize(node) : icons.maximize));
  }
  if (!node.isMaximized() && showClose) {
    const title = isTabStretch ? layout.i18nName(I18nLabel.Close_Tab) : layout.i18nName(I18nLabel.Close_Tabset);
    buttons.push(reactExports.createElement("button", { key: "close", "data-layout-path": path + "/button/close", title, className: cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_BUTTON) + " " + cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_BUTTON_CLOSE), onClick: isTabStretch ? onCloseTab : onClose, onPointerDown: onInterceptPointerDown }, typeof icons.closeTabset === "function" ? icons.closeTabset(node) : icons.closeTabset));
  }
  if (node.isActive() && node.isEnableActiveIcon()) {
    const title = layout.i18nName(I18nLabel.Active_Tabset);
    buttons.push(reactExports.createElement("div", { key: "active", "data-layout-path": path + "/button/active", title, className: cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR_ICON) }, typeof icons.activeTabset === "function" ? icons.activeTabset(node) : icons.activeTabset));
  }
  const buttonbar = reactExports.createElement("div", { key: "buttonbar", ref: buttonBarRef, className: cm(CLASSES.FLEXLAYOUT__TAB_TOOLBAR), onPointerDown: onInterceptPointerDown, onDragStart: (e) => {
    e.preventDefault();
  } }, buttons);
  let tabStrip;
  let tabStripClasses = cm(CLASSES.FLEXLAYOUT__TABSET_TABBAR_OUTER);
  if (node.getClassNameTabStrip() !== void 0) {
    tabStripClasses += " " + node.getClassNameTabStrip();
  }
  tabStripClasses += " " + CLASSES.FLEXLAYOUT__TABSET_TABBAR_OUTER_ + node.getTabLocation();
  if (node.isActive()) {
    tabStripClasses += " " + cm(CLASSES.FLEXLAYOUT__TABSET_SELECTED);
  }
  if (node.isMaximized()) {
    tabStripClasses += " " + cm(CLASSES.FLEXLAYOUT__TABSET_MAXIMIZED);
  }
  if (isTabStretch) {
    const tabNode = node.getChildren()[0];
    if (tabNode.getTabSetClassName() !== void 0) {
      tabStripClasses += " " + tabNode.getTabSetClassName();
    }
  }
  if (node.isEnableTabWrap()) {
    if (node.isEnableTabStrip()) {
      tabStrip = reactExports.createElement(
        "div",
        { className: tabStripClasses, style: { flexWrap: "wrap", gap: "1px", marginTop: "2px" }, ref: tabStripRef, "data-layout-path": path + "/tabstrip", onPointerDown, onDoubleClick, onContextMenu, onClick: onAuxMouseClick, onAuxClick: onAuxMouseClick, draggable: true, onDragStart },
        tabs,
        reactExports.createElement("div", { style: { flexGrow: 1 } }),
        buttonbar
      );
    }
  } else {
    if (node.isEnableTabStrip()) {
      tabStrip = reactExports.createElement(
        "div",
        { className: tabStripClasses, ref: tabStripRef, "data-layout-path": path + "/tabstrip", onPointerDown, onDoubleClick, onContextMenu, onClick: onAuxMouseClick, onAuxClick: onAuxMouseClick, draggable: true, onWheel: onMouseWheel, onDragStart },
        reactExports.createElement(
          "div",
          { ref: tabStripInnerRef, className: cm(CLASSES.FLEXLAYOUT__TABSET_TABBAR_INNER) + " " + cm(CLASSES.FLEXLAYOUT__TABSET_TABBAR_INNER_ + node.getTabLocation()) },
          reactExports.createElement("div", { style: { left: position, width: isTabStretch ? "100%" : "10000px" }, className: cm(CLASSES.FLEXLAYOUT__TABSET_TABBAR_INNER_TAB_CONTAINER) + " " + cm(CLASSES.FLEXLAYOUT__TABSET_TABBAR_INNER_TAB_CONTAINER_ + node.getTabLocation()) }, tabs)
        ),
        buttonbar
      );
    }
  }
  var emptyTabset;
  if (node.getChildren().length === 0) {
    const placeHolderCallback = layout.getTabSetPlaceHolderCallback();
    if (placeHolderCallback) {
      emptyTabset = placeHolderCallback(node);
    }
  }
  let content = reactExports.createElement("div", { ref: contentRef, className: cm(CLASSES.FLEXLAYOUT__TABSET_CONTENT) }, emptyTabset);
  if (node.getTabLocation() === "top") {
    content = reactExports.createElement(
      reactExports.Fragment,
      null,
      tabStrip,
      content
    );
  } else {
    content = reactExports.createElement(
      reactExports.Fragment,
      null,
      content,
      tabStrip
    );
  }
  let style2 = {
    flexGrow: Math.max(1, node.getWeight() * 1e3),
    minWidth: node.getMinWidth(),
    minHeight: node.getMinHeight(),
    maxWidth: node.getMaxWidth(),
    maxHeight: node.getMaxHeight()
  };
  if (node.getModel().getMaximizedTabset(layout.getWindowId()) !== void 0 && !node.isMaximized()) {
    style2.display = "none";
  }
  const tabset = reactExports.createElement(
    "div",
    { ref: selfRef, className: cm(CLASSES.FLEXLAYOUT__TABSET_CONTAINER), style: style2 },
    reactExports.createElement("div", { className: cm(CLASSES.FLEXLAYOUT__TABSET), "data-layout-path": path }, content)
  );
  if (node.isMaximized()) {
    if (layout.getMainElement()) {
      return reactDomExports.createPortal(reactExports.createElement("div", { style: {
        position: "absolute",
        display: "flex",
        top: 0,
        left: 0,
        bottom: 0,
        right: 0
      } }, tabset), layout.getMainElement());
    } else {
      return tabset;
    }
  } else {
    return tabset;
  }
};
const Row = (props) => {
  const { layout, node } = props;
  const selfRef = reactExports.useRef(null);
  const horizontal = node.getOrientation() === Orientation.HORZ;
  reactExports.useLayoutEffect(() => {
    node.setRect(layout.getBoundingClientRect(selfRef.current));
  });
  const items = [];
  let i = 0;
  for (const child of node.getChildren()) {
    if (i > 0) {
      items.push(reactExports.createElement(Splitter$1, { key: "splitter" + i, layout, node, index: i, horizontal }));
    }
    if (child instanceof RowNode$1) {
      items.push(reactExports.createElement(Row, { key: child.getId(), layout, node: child }));
    } else if (child instanceof TabSetNode) {
      items.push(reactExports.createElement(TabSet, { key: child.getId(), layout, node: child }));
    }
    i++;
  }
  const style2 = {
    flexGrow: Math.max(1, node.getWeight() * 1e3),
    // NOTE:  flex-grow cannot have values < 1 otherwise will not fill parent, need to normalize 
    minWidth: node.getMinWidth(),
    minHeight: node.getMinHeight(),
    maxWidth: node.getMaxWidth(),
    maxHeight: node.getMaxHeight()
  };
  if (horizontal) {
    style2.flexDirection = "row";
  } else {
    style2.flexDirection = "column";
  }
  return reactExports.createElement("div", { ref: selfRef, className: layout.getClassName(CLASSES.FLEXLAYOUT__ROW), style: style2 }, items);
};
const Tab = (props) => {
  const { layout, selected, node, path } = props;
  const selfRef = reactExports.useRef(null);
  const firstSelect = reactExports.useRef(true);
  const parentNode = node.getParent();
  const rect = parentNode.getContentRect();
  reactExports.useLayoutEffect(() => {
    const element = node.getMoveableElement();
    selfRef.current.appendChild(element);
    node.setMoveableElement(element);
    const handleScroll = () => {
      node.saveScrollPosition();
    };
    element.addEventListener("scroll", handleScroll);
    selfRef.current.addEventListener("pointerdown", onPointerDown);
    return () => {
      element.removeEventListener("scroll", handleScroll);
      if (selfRef.current) {
        selfRef.current.removeEventListener("pointerdown", onPointerDown);
      }
      node.setVisible(false);
    };
  }, []);
  reactExports.useEffect(() => {
    if (node.isSelected()) {
      if (firstSelect.current) {
        node.restoreScrollPosition();
        firstSelect.current = false;
      }
    }
  });
  const onPointerDown = () => {
    const parent = node.getParent();
    if (parent instanceof TabSetNode) {
      if (!parent.isActive()) {
        layout.doAction(Actions.setActiveTabset(parent.getId(), layout.getWindowId()));
      }
    }
  };
  node.setRect(rect);
  const cm = layout.getClassName;
  const style2 = {};
  rect.styleWithPosition(style2);
  let overlay = null;
  if (selected) {
    node.setVisible(true);
    if (document.hidden && node.isEnablePopoutOverlay()) {
      const overlayStyle = {};
      rect.styleWithPosition(overlayStyle);
      overlay = reactExports.createElement("div", { style: overlayStyle, className: cm(CLASSES.FLEXLAYOUT__TAB_OVERLAY) });
    }
  } else {
    style2.display = "none";
    node.setVisible(false);
  }
  if (parentNode instanceof TabSetNode) {
    if (node.getModel().getMaximizedTabset(layout.getWindowId()) !== void 0) {
      if (parentNode.isMaximized()) {
        style2.zIndex = 10;
      } else {
        style2.display = "none";
      }
    }
  }
  let className = cm(CLASSES.FLEXLAYOUT__TAB);
  if (parentNode instanceof BorderNode) {
    className += " " + cm(CLASSES.FLEXLAYOUT__TAB_BORDER);
    className += " " + cm(CLASSES.FLEXLAYOUT__TAB_BORDER_ + parentNode.getLocation().getName());
  }
  if (node.getContentClassName() !== void 0) {
    className += " " + node.getContentClassName();
  }
  return reactExports.createElement(
    reactExports.Fragment,
    null,
    overlay,
    reactExports.createElement("div", { ref: selfRef, style: style2, className, "data-layout-path": path })
  );
};
const SizeTracker = reactExports.memo(({ children }) => {
  return reactExports.createElement(reactExports.Fragment, null, children);
}, (prevProps, nextProps) => {
  return prevProps.rect.equalSize(nextProps.rect) && prevProps.selected === nextProps.selected && prevProps.forceRevision === nextProps.forceRevision && prevProps.tabsRevision === nextProps.tabsRevision;
});
class Layout extends reactExports.Component {
  /** @internal */
  constructor(props) {
    super(props);
    this.selfRef = reactExports.createRef();
    this.revision = 0;
  }
  /** re-render the layout */
  redraw() {
    this.selfRef.current.redraw("parent " + this.revision);
  }
  /**
   * Adds a new tab to the given tabset
   * @param tabsetId the id of the tabset where the new tab will be added
   * @param json the json for the new tab node
   * @returns the added tab node or undefined
   */
  addTabToTabSet(tabsetId, json) {
    return this.selfRef.current.addTabToTabSet(tabsetId, json);
  }
  /**
   * Adds a new tab by dragging an item to the drop location, must be called from within an HTML
   * drag start handler. You can use the setDragComponent() method to set the drag image before calling this
   * method.
   * @param event the drag start event
   * @param json the json for the new tab node
   * @param onDrop a callback to call when the drag is complete
   */
  addTabWithDragAndDrop(event, json, onDrop) {
    this.selfRef.current.addTabWithDragAndDrop(event, json, onDrop);
  }
  /**
   * Move a tab/tabset using drag and drop, must be called from within an HTML
   * drag start handler
   * @param event the drag start event
   * @param node the tab or tabset to drag
   */
  moveTabWithDragAndDrop(event, node) {
    this.selfRef.current.moveTabWithDragAndDrop(event, node);
  }
  /**
   * Adds a new tab to the active tabset (if there is one)
   * @param json the json for the new tab node
   * @returns the added tab node or undefined
   */
  addTabToActiveTabSet(json) {
    return this.selfRef.current.addTabToActiveTabSet(json);
  }
  /**
   * Sets the drag image from a react component for a drag event
   * @param event the drag event
   * @param component the react component to be used for the drag image
   * @param x the x position of the drag cursor on the image
   * @param y the x position of the drag cursor on the image
   */
  setDragComponent(event, component, x2, y2) {
    this.selfRef.current.setDragComponent(event, component, x2, y2);
  }
  /** Get the root div element of the layout */
  getRootDiv() {
    return this.selfRef.current.getRootDiv();
  }
  /** @internal */
  render() {
    return reactExports.createElement(LayoutInternal, Object.assign({ ref: this.selfRef }, this.props, { renderRevision: this.revision++ }));
  }
}
class LayoutInternal extends reactExports.Component {
  // private renderCount: any;
  constructor(props) {
    super(props);
    this.moveableElementMap = /* @__PURE__ */ new Map();
    this.dragEnterCount = 0;
    this.dragging = false;
    this.updateLayoutMetrics = () => {
      if (this.findBorderBarSizeRef.current) {
        const borderBarSize = this.findBorderBarSizeRef.current.getBoundingClientRect().height;
        if (borderBarSize !== this.state.calculatedBorderBarSize) {
          this.setState({ calculatedBorderBarSize: borderBarSize });
        }
      }
    };
    this.onModelChange = (action) => {
      this.redrawInternal("model change");
      if (this.props.onModelChange) {
        this.props.onModelChange(this.props.model, action);
      }
    };
    this.updateRect = () => {
      const rect = this.getDomRect();
      if (!rect.equals(this.state.rect) && rect.width !== 0 && rect.height !== 0) {
        this.setState({ rect });
        if (this.windowId !== Model.MAIN_WINDOW_ID) {
          this.redrawInternal("rect updated");
        }
      }
    };
    this.getClassName = (defaultClassName) => {
      if (this.props.classNameMapper === void 0) {
        return defaultClassName;
      } else {
        return this.props.classNameMapper(defaultClassName);
      }
    };
    this.onCloseWindow = (windowLayout) => {
      this.doAction(Actions.closeWindow(windowLayout.windowId));
    };
    this.onSetWindow = (windowLayout, window2) => {
    };
    this.showControlInPortal = (control, element) => {
      const portal = reactDomExports.createPortal(control, element);
      this.setState({ portal });
    };
    this.hideControlInPortal = () => {
      this.setState({ portal: void 0 });
    };
    this.getIcons = () => {
      return this.icons;
    };
    this.setDragNode = (event, node) => {
      LayoutInternal.dragState = new DragState(this.mainLayout, DragSource.Internal, node, void 0, void 0);
      event.dataTransfer.setData("text/plain", "--flexlayout--");
      event.dataTransfer.effectAllowed = "copyMove";
      event.dataTransfer.dropEffect = "move";
      this.dragEnterCount = 0;
      if (node instanceof TabSetNode) {
        let rendered = false;
        let content = this.i18nName(I18nLabel.Move_Tabset);
        if (node.getChildren().length > 0) {
          content = this.i18nName(I18nLabel.Move_Tabs).replace("?", String(node.getChildren().length));
        }
        if (this.props.onRenderDragRect) {
          const dragComponent = this.props.onRenderDragRect(content, node, void 0);
          if (dragComponent) {
            this.setDragComponent(event, dragComponent, 10, 10);
            rendered = true;
          }
        }
        if (!rendered) {
          this.setDragComponent(event, content, 10, 10);
        }
      } else {
        const element = event.target;
        const rect = element.getBoundingClientRect();
        const offsetX = event.clientX - rect.left;
        const offsetY = event.clientY - rect.top;
        const parentNode = node === null || node === void 0 ? void 0 : node.getParent();
        const isInVerticalBorder = parentNode instanceof BorderNode && parentNode.getOrientation() === Orientation.HORZ;
        const x2 = isInVerticalBorder ? 10 : offsetX;
        const y2 = isInVerticalBorder ? 10 : offsetY;
        let rendered = false;
        if (this.props.onRenderDragRect) {
          const content = reactExports.createElement(TabButtonStamp, { key: node.getId(), layout: this, node });
          const dragComponent = this.props.onRenderDragRect(content, node, void 0);
          if (dragComponent) {
            this.setDragComponent(event, dragComponent, x2, y2);
            rendered = true;
          }
        }
        if (!rendered) {
          if (isSafari$1()) {
            this.setDragComponent(event, reactExports.createElement(TabButtonStamp, { node, layout: this }), x2, y2);
          } else {
            event.dataTransfer.setDragImage(node.getTabStamp(), x2, y2);
          }
        }
      }
    };
    this.onDragEnterRaw = (event) => {
      this.dragEnterCount++;
      if (this.dragEnterCount === 1) {
        this.onDragEnter(event);
      }
    };
    this.onDragLeaveRaw = (event) => {
      this.dragEnterCount--;
      if (this.dragEnterCount === 0) {
        this.onDragLeave(event);
      }
    };
    this.onDragEnter = (event) => {
      var _a2;
      if (!LayoutInternal.dragState && this.props.onExternalDrag) {
        const externalDrag = this.props.onExternalDrag(event);
        if (externalDrag) {
          const tempNode = TabNode.fromJson(externalDrag.json, this.props.model, false);
          LayoutInternal.dragState = new DragState(this.mainLayout, DragSource.External, tempNode, externalDrag.json, externalDrag.onDrop);
        }
      }
      if (LayoutInternal.dragState) {
        if (this.windowId !== Model.MAIN_WINDOW_ID && LayoutInternal.dragState.mainLayout === this.mainLayout) {
          LayoutInternal.dragState.mainLayout.setDraggingOverWindow(true);
        }
        if (LayoutInternal.dragState.mainLayout !== this.mainLayout) {
          return;
        }
        event.preventDefault();
        this.dropInfo = void 0;
        const rootdiv = this.selfRef.current;
        this.outlineDiv = this.currentDocument.createElement("div");
        this.outlineDiv.className = this.getClassName(CLASSES.FLEXLAYOUT__OUTLINE_RECT);
        this.outlineDiv.style.visibility = "hidden";
        const speed = this.props.model.getAttribute("tabDragSpeed");
        this.outlineDiv.style.transition = `top ${speed}s, left ${speed}s, width ${speed}s, height ${speed}s`;
        rootdiv.appendChild(this.outlineDiv);
        this.dragging = true;
        this.showOverlay(true);
        if (!this.isDraggingOverWindow && this.props.model.getMaximizedTabset(this.windowId) === void 0) {
          this.setState({ showEdges: this.props.model.isEnableEdgeDock() });
        }
        const clientRect = (_a2 = this.selfRef.current) === null || _a2 === void 0 ? void 0 : _a2.getBoundingClientRect();
        const r2 = new Rect(event.clientX - clientRect.left, event.clientY - clientRect.top, 1, 1);
        r2.positionElement(this.outlineDiv);
      }
    };
    this.onDragOver = (event) => {
      var _a2, _b2, _c;
      if (this.dragging && !this.isDraggingOverWindow) {
        event.preventDefault();
        const clientRect = (_a2 = this.selfRef.current) === null || _a2 === void 0 ? void 0 : _a2.getBoundingClientRect();
        const pos = {
          x: event.clientX - ((_b2 = clientRect === null || clientRect === void 0 ? void 0 : clientRect.left) !== null && _b2 !== void 0 ? _b2 : 0),
          y: event.clientY - ((_c = clientRect === null || clientRect === void 0 ? void 0 : clientRect.top) !== null && _c !== void 0 ? _c : 0)
        };
        this.checkForBorderToShow(pos.x, pos.y);
        let dropInfo = this.props.model.findDropTargetNode(this.windowId, LayoutInternal.dragState.dragNode, pos.x, pos.y);
        if (dropInfo) {
          this.dropInfo = dropInfo;
          if (this.outlineDiv) {
            this.outlineDiv.className = this.getClassName(dropInfo.className);
            dropInfo.rect.positionElement(this.outlineDiv);
            this.outlineDiv.style.visibility = "visible";
          }
        }
      }
    };
    this.onDragLeave = (event) => {
      if (this.dragging) {
        if (this.windowId !== Model.MAIN_WINDOW_ID) {
          LayoutInternal.dragState.mainLayout.setDraggingOverWindow(false);
        }
        this.clearDragLocal();
      }
    };
    this.onDrop = (event) => {
      if (this.dragging) {
        event.preventDefault();
        const dragState = LayoutInternal.dragState;
        if (this.dropInfo) {
          if (dragState.dragJson !== void 0) {
            const newNode = this.doAction(Actions.addNode(dragState.dragJson, this.dropInfo.node.getId(), this.dropInfo.location, this.dropInfo.index));
            if (dragState.fnNewNodeDropped !== void 0) {
              dragState.fnNewNodeDropped(newNode, event);
            }
          } else if (dragState.dragNode !== void 0) {
            this.doAction(Actions.moveNode(dragState.dragNode.getId(), this.dropInfo.node.getId(), this.dropInfo.location, this.dropInfo.index));
          }
        }
        this.mainLayout.clearDragMain();
      }
      this.dragEnterCount = 0;
    };
    this.orderedIds = [];
    this.selfRef = reactExports.createRef();
    this.moveablesRef = reactExports.createRef();
    this.mainRef = reactExports.createRef();
    this.findBorderBarSizeRef = reactExports.createRef();
    this.supportsPopout = props.supportsPopout !== void 0 ? props.supportsPopout : defaultSupportsPopout;
    this.popoutURL = props.popoutURL ? props.popoutURL : "popout.html";
    this.icons = Object.assign(Object.assign({}, defaultIcons), props.icons);
    this.windowId = props.windowId ? props.windowId : Model.MAIN_WINDOW_ID;
    this.mainLayout = this.props.mainLayout ? this.props.mainLayout : this;
    this.isDraggingOverWindow = false;
    this.layoutWindow = this.props.model.getwindowsMap().get(this.windowId);
    this.layoutWindow.layout = this;
    this.popoutWindowName = this.props.popoutWindowName || "Popout Window";
    this.state = {
      rect: Rect.empty(),
      editingTab: void 0,
      showEdges: false,
      showOverlay: false,
      calculatedBorderBarSize: 29,
      layoutRevision: 0,
      forceRevision: 0,
      showHiddenBorder: DockLocation.CENTER
    };
    this.isMainWindow = this.windowId === Model.MAIN_WINDOW_ID;
  }
  componentDidMount() {
    this.updateRect();
    this.currentDocument = this.selfRef.current.ownerDocument;
    this.currentWindow = this.currentDocument.defaultView;
    this.layoutWindow.window = this.currentWindow;
    this.layoutWindow.toScreenRectFunction = (r2) => this.getScreenRect(r2);
    this.resizeObserver = new ResizeObserver((entries) => {
      requestAnimationFrame(() => {
        this.updateRect();
      });
    });
    if (this.selfRef.current) {
      this.resizeObserver.observe(this.selfRef.current);
    }
    if (this.isMainWindow) {
      this.props.model.addChangeListener(this.onModelChange);
      this.updateLayoutMetrics();
    } else {
      this.currentWindow.addEventListener("resize", () => {
        this.updateRect();
      });
      const sourceElement = this.props.mainLayout.getRootDiv();
      const targetElement = this.selfRef.current;
      copyInlineStyles(sourceElement, targetElement);
      this.styleObserver = new MutationObserver(() => {
        const changed = copyInlineStyles(sourceElement, targetElement);
        if (changed) {
          this.redraw("mutation observer");
        }
      });
      this.styleObserver.observe(sourceElement, { attributeFilter: ["style"] });
    }
    document.addEventListener("visibilitychange", () => {
      for (const [_2, layoutWindow] of this.props.model.getwindowsMap()) {
        const layout = layoutWindow.layout;
        if (layout) {
          this.redraw("visibility change");
        }
      }
    });
  }
  componentDidUpdate() {
    this.currentDocument = this.selfRef.current.ownerDocument;
    this.currentWindow = this.currentDocument.defaultView;
    if (this.isMainWindow) {
      if (this.props.model !== this.previousModel) {
        if (this.previousModel !== void 0) {
          this.previousModel.removeChangeListener(this.onModelChange);
        }
        this.props.model.getwindowsMap().get(this.windowId).layout = this;
        this.props.model.addChangeListener(this.onModelChange);
        this.layoutWindow = this.props.model.getwindowsMap().get(this.windowId);
        this.layoutWindow.layout = this;
        this.layoutWindow.toScreenRectFunction = (r2) => this.getScreenRect(r2);
        this.previousModel = this.props.model;
        this.tidyMoveablesMap();
      }
      this.updateLayoutMetrics();
    }
  }
  componentWillUnmount() {
    var _a2, _b2;
    if (this.selfRef.current) {
      (_a2 = this.resizeObserver) === null || _a2 === void 0 ? void 0 : _a2.unobserve(this.selfRef.current);
    }
    (_b2 = this.styleObserver) === null || _b2 === void 0 ? void 0 : _b2.disconnect();
  }
  render() {
    if (!this.selfRef.current) {
      return reactExports.createElement(
        "div",
        { ref: this.selfRef, className: this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT) },
        reactExports.createElement("div", { ref: this.moveablesRef, key: "__moveables__", className: this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT_MOVEABLES) }),
        this.renderMetricsElements()
      );
    }
    const model = this.props.model;
    model.getRoot(this.windowId).calcMinMaxSize();
    model.getRoot(this.windowId).setPaths("");
    model.getBorderSet().setPaths();
    const inner = this.renderLayout();
    const outer = this.renderBorders(inner);
    const tabs = this.renderTabs();
    const reorderedTabs = this.reorderComponents(tabs, this.orderedIds);
    let floatingWindows = null;
    let tabMoveables = null;
    let tabStamps = null;
    let metricElements = null;
    if (this.isMainWindow) {
      floatingWindows = this.renderWindows();
      metricElements = this.renderMetricsElements();
      tabMoveables = this.renderTabMoveables();
      tabStamps = reactExports.createElement("div", { key: "__tabStamps__", className: this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT_TAB_STAMPS) }, this.renderTabStamps());
    }
    return reactExports.createElement(
      "div",
      { ref: this.selfRef, className: this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT), onDragEnter: this.onDragEnterRaw, onDragLeave: this.onDragLeaveRaw, onDragOver: this.onDragOver, onDrop: this.onDrop },
      reactExports.createElement("div", { ref: this.moveablesRef, key: "__moveables__", className: this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT_MOVEABLES) }),
      metricElements,
      reactExports.createElement(Overlay, { key: "__overlay__", layout: this, show: this.state.showOverlay }),
      outer,
      reorderedTabs,
      tabMoveables,
      tabStamps,
      this.state.portal,
      floatingWindows
    );
  }
  renderBorders(inner) {
    const classMain = this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT_MAIN);
    const borders = this.props.model.getBorderSet().getBorderMap();
    if (this.isMainWindow && borders.size > 0) {
      inner = reactExports.createElement("div", { className: classMain, ref: this.mainRef }, inner);
      const borderSetComponents = /* @__PURE__ */ new Map();
      const borderSetContentComponents = /* @__PURE__ */ new Map();
      for (const [_2, location] of DockLocation.values) {
        const border = borders.get(location);
        const showBorder = border && (!border.isAutoHide() || border.isAutoHide() && (border.getChildren().length > 0 || this.state.showHiddenBorder === location));
        if (showBorder) {
          borderSetComponents.set(location, reactExports.createElement(BorderTabSet, { layout: this, border, size: this.state.calculatedBorderBarSize }));
          borderSetContentComponents.set(location, reactExports.createElement(BorderTab, { layout: this, border, show: border.getSelected() !== -1 }));
        }
      }
      const classBorderOuter = this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT_BORDER_CONTAINER);
      const classBorderInner = this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT_BORDER_CONTAINER_INNER);
      if (this.props.model.getBorderSet().getLayoutHorizontal()) {
        const innerWithBorderTabs = reactExports.createElement(
          "div",
          { className: classBorderInner, style: { flexDirection: "column" } },
          borderSetContentComponents.get(DockLocation.TOP),
          reactExports.createElement(
            "div",
            { className: classBorderInner, style: { flexDirection: "row" } },
            borderSetContentComponents.get(DockLocation.LEFT),
            inner,
            borderSetContentComponents.get(DockLocation.RIGHT)
          ),
          borderSetContentComponents.get(DockLocation.BOTTOM)
        );
        return reactExports.createElement(
          "div",
          { className: classBorderOuter, style: { flexDirection: "column" } },
          borderSetComponents.get(DockLocation.TOP),
          reactExports.createElement(
            "div",
            { className: classBorderInner, style: { flexDirection: "row" } },
            borderSetComponents.get(DockLocation.LEFT),
            innerWithBorderTabs,
            borderSetComponents.get(DockLocation.RIGHT)
          ),
          borderSetComponents.get(DockLocation.BOTTOM)
        );
      } else {
        const innerWithBorderTabs = reactExports.createElement(
          "div",
          { className: classBorderInner, style: { flexDirection: "row" } },
          borderSetContentComponents.get(DockLocation.LEFT),
          reactExports.createElement(
            "div",
            { className: classBorderInner, style: { flexDirection: "column" } },
            borderSetContentComponents.get(DockLocation.TOP),
            inner,
            borderSetContentComponents.get(DockLocation.BOTTOM)
          ),
          borderSetContentComponents.get(DockLocation.RIGHT)
        );
        return reactExports.createElement(
          "div",
          { className: classBorderOuter, style: { flexDirection: "row" } },
          borderSetComponents.get(DockLocation.LEFT),
          reactExports.createElement(
            "div",
            { className: classBorderInner, style: { flexDirection: "column" } },
            borderSetComponents.get(DockLocation.TOP),
            innerWithBorderTabs,
            borderSetComponents.get(DockLocation.BOTTOM)
          ),
          borderSetComponents.get(DockLocation.RIGHT)
        );
      }
    } else {
      return reactExports.createElement("div", { className: classMain, ref: this.mainRef, style: { position: "absolute", top: 0, left: 0, bottom: 0, right: 0, display: "flex" } }, inner);
    }
  }
  renderLayout() {
    return reactExports.createElement(
      reactExports.Fragment,
      null,
      reactExports.createElement(Row, { key: "__row__", layout: this, node: this.props.model.getRoot(this.windowId) }),
      this.renderEdgeIndicators()
    );
  }
  renderEdgeIndicators() {
    const edges = [];
    const arrowIcon = this.icons.edgeArrow;
    if (this.state.showEdges) {
      const r2 = this.props.model.getRoot(this.windowId).getRect();
      const length = edgeRectLength;
      const width = edgeRectWidth;
      const offset2 = edgeRectLength / 2;
      const className = this.getClassName(CLASSES.FLEXLAYOUT__EDGE_RECT);
      const radius = 50;
      edges.push(reactExports.createElement(
        "div",
        { key: "North", style: { top: 0, left: r2.width / 2 - offset2, width: length, height: width, borderBottomLeftRadius: radius, borderBottomRightRadius: radius }, className: className + " " + this.getClassName(CLASSES.FLEXLAYOUT__EDGE_RECT_TOP) },
        reactExports.createElement("div", { style: { transform: "rotate(180deg)" } }, arrowIcon)
      ));
      edges.push(reactExports.createElement(
        "div",
        { key: "West", style: { top: r2.height / 2 - offset2, left: 0, width, height: length, borderTopRightRadius: radius, borderBottomRightRadius: radius }, className: className + " " + this.getClassName(CLASSES.FLEXLAYOUT__EDGE_RECT_LEFT) },
        reactExports.createElement("div", { style: { transform: "rotate(90deg)" } }, arrowIcon)
      ));
      edges.push(reactExports.createElement(
        "div",
        { key: "South", style: { top: r2.height - width, left: r2.width / 2 - offset2, width: length, height: width, borderTopLeftRadius: radius, borderTopRightRadius: radius }, className: className + " " + this.getClassName(CLASSES.FLEXLAYOUT__EDGE_RECT_BOTTOM) },
        reactExports.createElement("div", null, arrowIcon)
      ));
      edges.push(reactExports.createElement(
        "div",
        { key: "East", style: { top: r2.height / 2 - offset2, left: r2.width - width, width, height: length, borderTopLeftRadius: radius, borderBottomLeftRadius: radius }, className: className + " " + this.getClassName(CLASSES.FLEXLAYOUT__EDGE_RECT_RIGHT) },
        reactExports.createElement("div", { style: { transform: "rotate(-90deg)" } }, arrowIcon)
      ));
    }
    return edges;
  }
  renderWindows() {
    const floatingWindows = [];
    if (this.supportsPopout) {
      const windows = this.props.model.getwindowsMap();
      let i = 1;
      for (const [windowId, layoutWindow] of windows) {
        if (windowId !== Model.MAIN_WINDOW_ID) {
          floatingWindows.push(reactExports.createElement(
            PopoutWindow,
            { key: windowId, layout: this, title: this.popoutWindowName + " " + i, layoutWindow, url: this.popoutURL + "?id=" + windowId, onSetWindow: this.onSetWindow, onCloseWindow: this.onCloseWindow },
            reactExports.createElement(LayoutInternal, Object.assign({}, this.props, { windowId, mainLayout: this }))
          ));
          i++;
        }
      }
    }
    return floatingWindows;
  }
  renderTabMoveables() {
    const tabMoveables = [];
    this.props.model.visitNodes((node) => {
      if (node instanceof TabNode) {
        const child = node;
        const element = this.getMoveableElement(child.getId());
        child.setMoveableElement(element);
        const selected = child.isSelected();
        const rect = child.getParent().getContentRect();
        const renderTab = child.isRendered() || (selected || !child.isEnableRenderOnDemand()) && (rect.width > 0 && rect.height > 0);
        if (renderTab) {
          const key = child.getId() + (child.isEnableWindowReMount() ? child.getWindowId() : "");
          tabMoveables.push(reactDomExports.createPortal(reactExports.createElement(
            SizeTracker,
            { rect, selected: child.isSelected(), forceRevision: this.state.forceRevision, tabsRevision: this.props.renderRevision, key },
            reactExports.createElement(ErrorBoundary, { message: this.i18nName(I18nLabel.Error_rendering_component) }, this.props.factory(child))
          ), element, key));
          child.setRendered(renderTab);
        }
      }
    });
    return tabMoveables;
  }
  renderTabStamps() {
    const tabStamps = [];
    this.props.model.visitNodes((node) => {
      if (node instanceof TabNode) {
        const child = node;
        tabStamps.push(reactExports.createElement(DragContainer, { key: child.getId(), layout: this, node: child }));
      }
    });
    return tabStamps;
  }
  renderTabs() {
    const tabs = /* @__PURE__ */ new Map();
    this.props.model.visitWindowNodes(this.windowId, (node) => {
      if (node instanceof TabNode) {
        const child = node;
        const selected = child.isSelected();
        const path = child.getPath();
        const renderTab = child.isRendered() || selected || !child.isEnableRenderOnDemand();
        if (renderTab) {
          tabs.set(
            child.getId(),
            // <SizeTracker rect={rect} forceRevision={this.state.forceRevision} key={key}>
            reactExports.createElement(Tab, { key: child.getId(), layout: this, path, node: child, selected })
          );
        }
      }
    });
    return tabs;
  }
  renderMetricsElements() {
    return reactExports.createElement("div", { key: "findBorderBarSize", ref: this.findBorderBarSizeRef, className: this.getClassName(CLASSES.FLEXLAYOUT__BORDER_SIZER) }, "FindBorderBarSize");
  }
  checkForBorderToShow(x2, y2) {
    const r2 = this.getBoundingClientRect(this.mainRef.current);
    const c = r2.getCenter();
    const margin = edgeRectWidth;
    const offset2 = edgeRectLength / 2;
    let overEdge = false;
    if (this.props.model.isEnableEdgeDock() && this.state.showHiddenBorder === DockLocation.CENTER) {
      if (y2 > c.y - offset2 && y2 < c.y + offset2 || x2 > c.x - offset2 && x2 < c.x + offset2) {
        overEdge = true;
      }
    }
    let location = DockLocation.CENTER;
    if (!overEdge) {
      if (x2 <= r2.x + margin) {
        location = DockLocation.LEFT;
      } else if (x2 >= r2.getRight() - margin) {
        location = DockLocation.RIGHT;
      } else if (y2 <= r2.y + margin) {
        location = DockLocation.TOP;
      } else if (y2 >= r2.getBottom() - margin) {
        location = DockLocation.BOTTOM;
      }
    }
    if (location !== this.state.showHiddenBorder) {
      this.setState({ showHiddenBorder: location });
    }
  }
  tidyMoveablesMap() {
    const tabs = /* @__PURE__ */ new Map();
    this.props.model.visitNodes((node, _2) => {
      if (node instanceof TabNode) {
        tabs.set(node.getId(), node);
      }
    });
    for (const [nodeId, element] of this.moveableElementMap) {
      if (!tabs.has(nodeId)) {
        element.remove();
        this.moveableElementMap.delete(nodeId);
      }
    }
  }
  reorderComponents(components, ids) {
    const nextIds = [];
    const nextIdsSet = /* @__PURE__ */ new Set();
    let reordered = [];
    for (const id2 of ids) {
      if (components.get(id2)) {
        nextIds.push(id2);
        nextIdsSet.add(id2);
      }
    }
    ids.splice(0, ids.length, ...nextIds);
    for (const [id2, _2] of components) {
      if (!nextIdsSet.has(id2)) {
        ids.push(id2);
      }
    }
    reordered = ids.map((id2) => {
      return components.get(id2);
    });
    return reordered;
  }
  redraw(type) {
    this.mainLayout.setState((state, props) => {
      return { forceRevision: state.forceRevision + 1 };
    });
  }
  redrawInternal(type) {
    this.mainLayout.setState((state, props) => {
      return { layoutRevision: state.layoutRevision + 1 };
    });
  }
  doAction(action) {
    if (this.props.onAction !== void 0) {
      const outcome = this.props.onAction(action);
      if (outcome !== void 0) {
        return this.props.model.doAction(outcome);
      }
      return void 0;
    } else {
      return this.props.model.doAction(action);
    }
  }
  getBoundingClientRect(div) {
    const layoutRect = this.getDomRect();
    if (layoutRect) {
      return Rect.getBoundingClientRect(div).relativeTo(layoutRect);
    }
    return Rect.empty();
  }
  getMoveableContainer() {
    return this.moveablesRef.current;
  }
  getMoveableElement(id2) {
    let moveableElement = this.moveableElementMap.get(id2);
    if (moveableElement === void 0) {
      moveableElement = document.createElement("div");
      this.moveablesRef.current.appendChild(moveableElement);
      moveableElement.className = CLASSES.FLEXLAYOUT__TAB_MOVEABLE;
      this.moveableElementMap.set(id2, moveableElement);
    }
    return moveableElement;
  }
  getMainLayout() {
    return this.mainLayout;
  }
  getCurrentDocument() {
    return this.currentDocument;
  }
  getDomRect() {
    if (this.selfRef.current) {
      return Rect.fromDomRect(this.selfRef.current.getBoundingClientRect());
    } else {
      return Rect.empty();
    }
  }
  getWindowId() {
    return this.windowId;
  }
  getRootDiv() {
    return this.selfRef.current;
  }
  getMainElement() {
    return this.mainRef.current;
  }
  getFactory() {
    return this.props.factory;
  }
  isSupportsPopout() {
    return this.supportsPopout;
  }
  isRealtimeResize() {
    var _a2;
    return (_a2 = this.props.realtimeResize) !== null && _a2 !== void 0 ? _a2 : false;
  }
  getPopoutURL() {
    return this.popoutURL;
  }
  setEditingTab(tabNode) {
    this.setState({ editingTab: tabNode });
  }
  getEditingTab() {
    return this.state.editingTab;
  }
  getModel() {
    return this.props.model;
  }
  getScreenRect(inRect) {
    const rect = inRect.clone();
    const layoutRect = this.getDomRect();
    const navHeight = 60;
    const navWidth = 2;
    rect.x = this.currentWindow.screenX + this.currentWindow.scrollX + navWidth / 2 + layoutRect.x + rect.x;
    rect.y = this.currentWindow.screenY + this.currentWindow.scrollY + (navHeight - navWidth / 2) + layoutRect.y + rect.y;
    rect.height += navHeight;
    rect.width += navWidth;
    return rect;
  }
  addTabToTabSet(tabsetId, json) {
    const tabsetNode = this.props.model.getNodeById(tabsetId);
    if (tabsetNode !== void 0) {
      const node = this.doAction(Actions.addNode(json, tabsetId, DockLocation.CENTER, -1));
      return node;
    }
    return void 0;
  }
  addTabToActiveTabSet(json) {
    const tabsetNode = this.props.model.getActiveTabset(this.windowId);
    if (tabsetNode !== void 0) {
      const node = this.doAction(Actions.addNode(json, tabsetNode.getId(), DockLocation.CENTER, -1));
      return node;
    }
    return void 0;
  }
  maximize(tabsetNode) {
    this.doAction(Actions.maximizeToggle(tabsetNode.getId(), this.getWindowId()));
  }
  customizeTab(tabNode, renderValues) {
    if (this.props.onRenderTab) {
      this.props.onRenderTab(tabNode, renderValues);
    }
  }
  customizeTabSet(tabSetNode, renderValues) {
    if (this.props.onRenderTabSet) {
      this.props.onRenderTabSet(tabSetNode, renderValues);
    }
  }
  i18nName(id2, param) {
    let message;
    if (this.props.i18nMapper) {
      message = this.props.i18nMapper(id2, param);
    }
    if (message === void 0) {
      message = id2 + (param === void 0 ? "" : param);
    }
    return message;
  }
  getShowOverflowMenu() {
    return this.props.onShowOverflowMenu;
  }
  getTabSetPlaceHolderCallback() {
    return this.props.onTabSetPlaceHolder;
  }
  showContextMenu(node, event) {
    if (this.props.onContextMenu) {
      this.props.onContextMenu(node, event);
    }
  }
  auxMouseClick(node, event) {
    if (this.props.onAuxMouseClick) {
      this.props.onAuxMouseClick(node, event);
    }
  }
  showOverlay(show) {
    this.setState({ showOverlay: show });
    enablePointerOnIFrames(!show, this.currentDocument);
  }
  // *************************** Start Drag Drop *************************************
  addTabWithDragAndDrop(event, json, onDrop) {
    const tempNode = TabNode.fromJson(json, this.props.model, false);
    LayoutInternal.dragState = new DragState(this.mainLayout, DragSource.Add, tempNode, json, onDrop);
  }
  moveTabWithDragAndDrop(event, node) {
    this.setDragNode(event, node);
  }
  setDragComponent(event, component, x2, y2) {
    let dragElement = reactExports.createElement("div", { style: { position: "unset" }, className: this.getClassName(CLASSES.FLEXLAYOUT__LAYOUT) + " " + this.getClassName(CLASSES.FLEXLAYOUT__DRAG_RECT) }, component);
    const tempDiv = this.currentDocument.createElement("div");
    tempDiv.setAttribute("data-layout-path", "/drag-rectangle");
    tempDiv.style.position = "absolute";
    tempDiv.style.left = "-10000px";
    tempDiv.style.top = "-10000px";
    this.currentDocument.body.appendChild(tempDiv);
    createRoot(tempDiv).render(dragElement);
    event.dataTransfer.setDragImage(tempDiv, x2, y2);
    setTimeout(() => {
      this.currentDocument.body.removeChild(tempDiv);
    }, 0);
  }
  setDraggingOverWindow(overWindow) {
    if (this.isDraggingOverWindow !== overWindow) {
      if (this.outlineDiv) {
        this.outlineDiv.style.visibility = overWindow ? "hidden" : "visible";
      }
      if (overWindow) {
        this.setState({ showEdges: false });
      } else {
        if (this.props.model.getMaximizedTabset(this.windowId) === void 0) {
          this.setState({ showEdges: this.props.model.isEnableEdgeDock() });
        }
      }
      this.isDraggingOverWindow = overWindow;
    }
  }
  clearDragMain() {
    LayoutInternal.dragState = void 0;
    if (this.windowId === Model.MAIN_WINDOW_ID) {
      this.isDraggingOverWindow = false;
    }
    for (const [, layoutWindow] of this.props.model.getwindowsMap()) {
      layoutWindow.layout.clearDragLocal();
    }
  }
  clearDragLocal() {
    this.setState({ showEdges: false });
    this.showOverlay(false);
    this.dragEnterCount = 0;
    this.dragging = false;
    if (this.outlineDiv) {
      this.selfRef.current.removeChild(this.outlineDiv);
      this.outlineDiv = void 0;
    }
  }
}
LayoutInternal.dragState = void 0;
const defaultIcons = {
  close: reactExports.createElement(CloseIcon, null),
  closeTabset: reactExports.createElement(CloseIcon, null),
  popout: reactExports.createElement(PopoutIcon, null),
  maximize: reactExports.createElement(MaximizeIcon, null),
  restore: reactExports.createElement(RestoreIcon, null),
  more: reactExports.createElement(OverflowIcon, null),
  edgeArrow: reactExports.createElement(EdgeIcon, null),
  activeTabset: reactExports.createElement(AsterickIcon, null)
};
var DragSource;
(function(DragSource2) {
  DragSource2["Internal"] = "internal";
  DragSource2["External"] = "external";
  DragSource2["Add"] = "add";
})(DragSource || (DragSource = {}));
const defaultSupportsPopout = isDesktop();
const edgeRectLength = 100;
const edgeRectWidth = 10;
class DragState {
  constructor(mainLayout, dragSource, dragNode, dragJson, fnNewNodeDropped) {
    this.mainLayout = mainLayout;
    this.dragSource = dragSource;
    this.dragNode = dragNode;
    this.dragJson = dragJson;
    this.fnNewNodeDropped = fnNewNodeDropped;
  }
}
var main = {};
var agGridReact = {};
var agGridReactLegacy = {};
/**
          * @ag-grid-community/all-modules - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v30.0.6
          * @link https://www.ag-grid.com/
          * @license MIT
          */
function makeNull(value) {
  if (value == null || value === "") {
    return null;
  }
  return value;
}
function exists(value, allowEmptyString) {
  if (allowEmptyString === void 0) {
    allowEmptyString = false;
  }
  return value != null && (value !== "" || allowEmptyString);
}
function missing(value) {
  return !exists(value);
}
function missingOrEmpty(value) {
  return value == null || value.length === 0;
}
function toStringOrNull(value) {
  return value != null && typeof value.toString === "function" ? value.toString() : null;
}
function attrToNumber(value) {
  if (value === void 0) {
    return;
  }
  if (value === null || value === "") {
    return null;
  }
  if (typeof value === "number") {
    return isNaN(value) ? void 0 : value;
  }
  var valueParsed = parseInt(value, 10);
  return isNaN(valueParsed) ? void 0 : valueParsed;
}
function attrToBoolean(value) {
  if (value === void 0) {
    return;
  }
  if (value === null || value === "") {
    return false;
  }
  if (typeof value === "boolean") {
    return value;
  }
  return /true/i.test(value);
}
function attrToString(value) {
  if (value == null || value === "") {
    return;
  }
  return value;
}
function referenceCompare(left, right) {
  if (left == null && right == null) {
    return true;
  }
  if (left == null && right != null) {
    return false;
  }
  if (left != null && right == null) {
    return false;
  }
  return left === right;
}
function jsonEquals(val1, val2) {
  var val1Json = val1 ? JSON.stringify(val1) : null;
  var val2Json = val2 ? JSON.stringify(val2) : null;
  return val1Json === val2Json;
}
function defaultComparator(valueA, valueB, accentedCompare) {
  if (accentedCompare === void 0) {
    accentedCompare = false;
  }
  var valueAMissing = valueA == null;
  var valueBMissing = valueB == null;
  if (valueA && valueA.toNumber) {
    valueA = valueA.toNumber();
  }
  if (valueB && valueB.toNumber) {
    valueB = valueB.toNumber();
  }
  if (valueAMissing && valueBMissing) {
    return 0;
  }
  if (valueAMissing) {
    return -1;
  }
  if (valueBMissing) {
    return 1;
  }
  function doQuickCompare(a, b) {
    return a > b ? 1 : a < b ? -1 : 0;
  }
  if (typeof valueA !== "string") {
    return doQuickCompare(valueA, valueB);
  }
  if (!accentedCompare) {
    return doQuickCompare(valueA, valueB);
  }
  try {
    return valueA.localeCompare(valueB);
  } catch (e) {
    return doQuickCompare(valueA, valueB);
  }
}
function values(object) {
  if (object instanceof Set || object instanceof Map) {
    var arr_1 = [];
    object.forEach(function(value) {
      return arr_1.push(value);
    });
    return arr_1;
  }
  return Object.values(object);
}
var GenericUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  makeNull,
  exists,
  missing,
  missingOrEmpty,
  toStringOrNull,
  attrToNumber,
  attrToBoolean,
  attrToString,
  referenceCompare,
  jsonEquals,
  defaultComparator,
  values
});
var ColumnKeyCreator = (
  /** @class */
  function() {
    function ColumnKeyCreator2() {
      this.existingKeys = {};
    }
    ColumnKeyCreator2.prototype.addExistingKeys = function(keys2) {
      for (var i = 0; i < keys2.length; i++) {
        this.existingKeys[keys2[i]] = true;
      }
    };
    ColumnKeyCreator2.prototype.getUniqueKey = function(colId, colField) {
      colId = toStringOrNull(colId);
      var count = 0;
      while (true) {
        var idToTry = void 0;
        if (colId) {
          idToTry = colId;
          if (count !== 0) {
            idToTry += "_" + count;
          }
        } else if (colField) {
          idToTry = colField;
          if (count !== 0) {
            idToTry += "_" + count;
          }
        } else {
          idToTry = "" + count;
        }
        if (!this.existingKeys[idToTry]) {
          this.existingKeys[idToTry] = true;
          return idToTry;
        }
        count++;
      }
    };
    return ColumnKeyCreator2;
  }()
);
function iterateObject(object, callback2) {
  if (object == null) {
    return;
  }
  if (Array.isArray(object)) {
    object.forEach(function(value, index2) {
      return callback2("" + index2, value);
    });
  } else {
    Object.keys(object).forEach(function(key) {
      return callback2(key, object[key]);
    });
  }
}
function cloneObject(object) {
  var copy = {};
  var keys2 = Object.keys(object);
  for (var i = 0; i < keys2.length; i++) {
    var key = keys2[i];
    var value = object[key];
    copy[key] = value;
  }
  return copy;
}
function deepCloneObject(object) {
  return JSON.parse(JSON.stringify(object));
}
function deepCloneDefinition(object, keysToSkip) {
  if (!object) {
    return;
  }
  var obj = object;
  var res = {};
  Object.keys(obj).forEach(function(key) {
    if (keysToSkip && keysToSkip.indexOf(key) >= 0) {
      return;
    }
    var value = obj[key];
    var sourceIsSimpleObject = isNonNullObject(value) && value.constructor === Object;
    if (sourceIsSimpleObject) {
      res[key] = deepCloneDefinition(value);
    } else {
      res[key] = value;
    }
  });
  return res;
}
function getProperty(object, key) {
  return object[key];
}
function setProperty(object, key, value) {
  object[key] = value;
}
function copyPropertiesIfPresent(source, target) {
  var properties = [];
  for (var _i = 2; _i < arguments.length; _i++) {
    properties[_i - 2] = arguments[_i];
  }
  properties.forEach(function(p2) {
    return copyPropertyIfPresent(source, target, p2);
  });
}
function copyPropertyIfPresent(source, target, property, transform) {
  var value = getProperty(source, property);
  if (value !== void 0) {
    setProperty(target, property, transform ? transform(value) : value);
  }
}
function getAllKeysInObjects(objects) {
  var allValues = {};
  objects.filter(function(obj) {
    return obj != null;
  }).forEach(function(obj) {
    Object.keys(obj).forEach(function(key) {
      return allValues[key] = null;
    });
  });
  return Object.keys(allValues);
}
function getAllValuesInObject(obj) {
  if (!obj) {
    return [];
  }
  var anyObject = Object;
  if (typeof anyObject.values === "function") {
    return anyObject.values(obj);
  }
  var ret = [];
  for (var key in obj) {
    if (obj.hasOwnProperty(key) && obj.propertyIsEnumerable(key)) {
      ret.push(obj[key]);
    }
  }
  return ret;
}
function mergeDeep(dest, source, copyUndefined, makeCopyOfSimpleObjects) {
  if (copyUndefined === void 0) {
    copyUndefined = true;
  }
  if (makeCopyOfSimpleObjects === void 0) {
    makeCopyOfSimpleObjects = false;
  }
  if (!exists(source)) {
    return;
  }
  iterateObject(source, function(key, sourceValue) {
    var destValue = dest[key];
    if (destValue === sourceValue) {
      return;
    }
    if (makeCopyOfSimpleObjects) {
      var objectIsDueToBeCopied = destValue == null && sourceValue != null;
      if (objectIsDueToBeCopied) {
        var sourceIsSimpleObject = typeof sourceValue === "object" && sourceValue.constructor === Object;
        var dontCopy = sourceIsSimpleObject;
        if (dontCopy) {
          destValue = {};
          dest[key] = destValue;
        }
      }
    }
    if (isNonNullObject(sourceValue) && isNonNullObject(destValue) && !Array.isArray(destValue)) {
      mergeDeep(destValue, sourceValue, copyUndefined, makeCopyOfSimpleObjects);
    } else if (copyUndefined || sourceValue !== void 0) {
      dest[key] = sourceValue;
    }
  });
}
function missingOrEmptyObject(value) {
  return missing(value) || Object.keys(value).length === 0;
}
function get$3(source, expression, defaultValue) {
  if (source == null) {
    return defaultValue;
  }
  var keys2 = expression.split(".");
  var objectToRead = source;
  while (keys2.length > 1) {
    objectToRead = objectToRead[keys2.shift()];
    if (objectToRead == null) {
      return defaultValue;
    }
  }
  var value = objectToRead[keys2[0]];
  return value != null ? value : defaultValue;
}
function set$3(target, expression, value) {
  if (target == null) {
    return;
  }
  var keys2 = expression.split(".");
  var objectToUpdate = target;
  keys2.forEach(function(key, i) {
    if (!objectToUpdate[key]) {
      objectToUpdate[key] = {};
    }
    if (i < keys2.length - 1) {
      objectToUpdate = objectToUpdate[key];
    }
  });
  objectToUpdate[keys2[keys2.length - 1]] = value;
}
function getValueUsingField(data, field, fieldContainsDots) {
  if (!field || !data) {
    return;
  }
  if (!fieldContainsDots) {
    return data[field];
  }
  var fields = field.split(".");
  var currentObject = data;
  for (var i = 0; i < fields.length; i++) {
    if (currentObject == null) {
      return void 0;
    }
    currentObject = currentObject[fields[i]];
  }
  return currentObject;
}
function removeAllReferences(obj, objectName) {
  Object.keys(obj).forEach(function(key) {
    var value = obj[key];
    if (typeof value === "object") {
      obj[key] = void 0;
    }
  });
  var proto2 = Object.getPrototypeOf(obj);
  var properties = {};
  Object.keys(proto2).forEach(function(key) {
    var value = proto2[key];
    if (typeof value === "function") {
      var func = function() {
        console.warn("AG Grid: " + objectName + " function " + key + "() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed.");
      };
      properties[key] = { value: func, writable: true };
    }
  });
  Object.defineProperties(obj, properties);
}
function isNonNullObject(value) {
  return typeof value === "object" && value !== null;
}
var ObjectUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  iterateObject,
  cloneObject,
  deepCloneObject,
  deepCloneDefinition,
  getProperty,
  setProperty,
  copyPropertiesIfPresent,
  copyPropertyIfPresent,
  getAllKeysInObjects,
  getAllValuesInObject,
  mergeDeep,
  missingOrEmptyObject,
  get: get$3,
  set: set$3,
  getValueUsingField,
  removeAllReferences,
  isNonNullObject
});
var doOnceFlags = {};
function doOnce(func, key) {
  if (doOnceFlags[key]) {
    return;
  }
  func();
  doOnceFlags[key] = true;
}
function getFunctionName(funcConstructor) {
  if (funcConstructor.name) {
    return funcConstructor.name;
  }
  var matches = /function\s+([^\(]+)/.exec(funcConstructor.toString());
  return matches && matches.length === 2 ? matches[1].trim() : null;
}
function isFunction$2(val) {
  return !!(val && val.constructor && val.call && val.apply);
}
function executeInAWhile(funcs) {
  executeAfter(funcs, 400);
}
var executeNextVMTurnFuncs = [];
var executeNextVMTurnPending = false;
function executeNextVMTurn(func) {
  executeNextVMTurnFuncs.push(func);
  if (executeNextVMTurnPending) {
    return;
  }
  executeNextVMTurnPending = true;
  window.setTimeout(function() {
    var funcsCopy = executeNextVMTurnFuncs.slice();
    executeNextVMTurnFuncs.length = 0;
    executeNextVMTurnPending = false;
    funcsCopy.forEach(function(func2) {
      return func2();
    });
  }, 0);
}
function executeAfter(funcs, milliseconds2) {
  if (milliseconds2 === void 0) {
    milliseconds2 = 0;
  }
  if (funcs.length > 0) {
    window.setTimeout(function() {
      return funcs.forEach(function(func) {
        return func();
      });
    }, milliseconds2);
  }
}
function debounce$1(func, delay) {
  var timeout;
  return function() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
      args[_i] = arguments[_i];
    }
    var context = this;
    window.clearTimeout(timeout);
    timeout = window.setTimeout(function() {
      func.apply(context, args);
    }, delay);
  };
}
function throttle(func, wait) {
  var previousCall = 0;
  return function() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
      args[_i] = arguments[_i];
    }
    var context = this;
    var currentCall = (/* @__PURE__ */ new Date()).getTime();
    if (currentCall - previousCall < wait) {
      return;
    }
    previousCall = currentCall;
    func.apply(context, args);
  };
}
function waitUntil(condition, callback2, timeout, timeoutMessage) {
  if (timeout === void 0) {
    timeout = 100;
  }
  var timeStamp = (/* @__PURE__ */ new Date()).getTime();
  var interval = null;
  var executed = false;
  var internalCallback = function() {
    var reachedTimeout = (/* @__PURE__ */ new Date()).getTime() - timeStamp > timeout;
    if (condition() || reachedTimeout) {
      callback2();
      executed = true;
      if (interval != null) {
        window.clearInterval(interval);
        interval = null;
      }
      if (reachedTimeout && timeoutMessage) {
        console.warn(timeoutMessage);
      }
    }
  };
  internalCallback();
  if (!executed) {
    interval = window.setInterval(internalCallback, 10);
  }
}
function compose() {
  var fns = [];
  for (var _i = 0; _i < arguments.length; _i++) {
    fns[_i] = arguments[_i];
  }
  return function(arg) {
    return fns.reduce(function(composed, f2) {
      return f2(composed);
    }, arg);
  };
}
function callIfPresent(func) {
  if (func) {
    func();
  }
}
var noop$1 = function() {
  return;
};
var FunctionUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  doOnce,
  getFunctionName,
  isFunction: isFunction$2,
  executeInAWhile,
  executeNextVMTurn,
  executeAfter,
  debounce: debounce$1,
  throttle,
  waitUntil,
  compose,
  callIfPresent,
  noop: noop$1
});
var ModuleNames;
(function(ModuleNames2) {
  ModuleNames2["CommunityCoreModule"] = "@ag-grid-community/core";
  ModuleNames2["InfiniteRowModelModule"] = "@ag-grid-community/infinite-row-model";
  ModuleNames2["ClientSideRowModelModule"] = "@ag-grid-community/client-side-row-model";
  ModuleNames2["CsvExportModule"] = "@ag-grid-community/csv-export";
  ModuleNames2["EnterpriseCoreModule"] = "@ag-grid-enterprise/core";
  ModuleNames2["RowGroupingModule"] = "@ag-grid-enterprise/row-grouping";
  ModuleNames2["ColumnsToolPanelModule"] = "@ag-grid-enterprise/column-tool-panel";
  ModuleNames2["FiltersToolPanelModule"] = "@ag-grid-enterprise/filter-tool-panel";
  ModuleNames2["MenuModule"] = "@ag-grid-enterprise/menu";
  ModuleNames2["SetFilterModule"] = "@ag-grid-enterprise/set-filter";
  ModuleNames2["MultiFilterModule"] = "@ag-grid-enterprise/multi-filter";
  ModuleNames2["StatusBarModule"] = "@ag-grid-enterprise/status-bar";
  ModuleNames2["SideBarModule"] = "@ag-grid-enterprise/side-bar";
  ModuleNames2["RangeSelectionModule"] = "@ag-grid-enterprise/range-selection";
  ModuleNames2["MasterDetailModule"] = "@ag-grid-enterprise/master-detail";
  ModuleNames2["RichSelectModule"] = "@ag-grid-enterprise/rich-select";
  ModuleNames2["GridChartsModule"] = "@ag-grid-enterprise/charts";
  ModuleNames2["ViewportRowModelModule"] = "@ag-grid-enterprise/viewport-row-model";
  ModuleNames2["ServerSideRowModelModule"] = "@ag-grid-enterprise/server-side-row-model";
  ModuleNames2["ExcelExportModule"] = "@ag-grid-enterprise/excel-export";
  ModuleNames2["ClipboardModule"] = "@ag-grid-enterprise/clipboard";
  ModuleNames2["SparklinesModule"] = "@ag-grid-enterprise/sparklines";
  ModuleNames2["AngularModule"] = "@ag-grid-community/angular";
  ModuleNames2["ReactModule"] = "@ag-grid-community/react";
  ModuleNames2["VueModule"] = "@ag-grid-community/vue";
})(ModuleNames || (ModuleNames = {}));
var __read$x = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$r = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var ModuleRegistry = (
  /** @class */
  function() {
    function ModuleRegistry2() {
    }
    ModuleRegistry2.register = function(module2) {
      ModuleRegistry2.__register(module2, true, void 0);
    };
    ModuleRegistry2.registerModules = function(modules) {
      ModuleRegistry2.__registerModules(modules, true, void 0);
    };
    ModuleRegistry2.__register = function(module2, moduleBased, gridId) {
      ModuleRegistry2.runVersionChecks(module2);
      if (gridId !== void 0) {
        ModuleRegistry2.areGridScopedModules = true;
        if (ModuleRegistry2.gridModulesMap[gridId] === void 0) {
          ModuleRegistry2.gridModulesMap[gridId] = {};
        }
        ModuleRegistry2.gridModulesMap[gridId][module2.moduleName] = module2;
      } else {
        ModuleRegistry2.globalModulesMap[module2.moduleName] = module2;
      }
      ModuleRegistry2.setModuleBased(moduleBased);
    };
    ModuleRegistry2.__unRegisterGridModules = function(gridId) {
      delete ModuleRegistry2.gridModulesMap[gridId];
    };
    ModuleRegistry2.__registerModules = function(modules, moduleBased, gridId) {
      ModuleRegistry2.setModuleBased(moduleBased);
      if (!modules) {
        return;
      }
      modules.forEach(function(module2) {
        return ModuleRegistry2.__register(module2, moduleBased, gridId);
      });
    };
    ModuleRegistry2.isValidModuleVersion = function(module2) {
      var _a2 = __read$x(module2.version.split(".") || [], 2), moduleMajor = _a2[0], moduleMinor = _a2[1];
      var _b2 = __read$x(ModuleRegistry2.currentModuleVersion.split(".") || [], 2), currentModuleMajor = _b2[0], currentModuleMinor = _b2[1];
      return moduleMajor === currentModuleMajor && moduleMinor === currentModuleMinor;
    };
    ModuleRegistry2.runVersionChecks = function(module2) {
      if (!ModuleRegistry2.currentModuleVersion) {
        ModuleRegistry2.currentModuleVersion = module2.version;
      }
      if (!module2.version) {
        console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '" + module2.moduleName + "' is incompatible. Please update all modules to the same version.");
      } else if (!ModuleRegistry2.isValidModuleVersion(module2)) {
        console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '" + module2.moduleName + "' is version " + module2.version + " but the other modules are version " + this.currentModuleVersion + ". Please update all modules to the same version.");
      }
      if (module2.validate) {
        var result = module2.validate();
        if (!result.isValid) {
          var errorResult = result;
          console.error("AG Grid: " + errorResult.message);
        }
      }
    };
    ModuleRegistry2.setModuleBased = function(moduleBased) {
      if (ModuleRegistry2.moduleBased === void 0) {
        ModuleRegistry2.moduleBased = moduleBased;
      } else {
        if (ModuleRegistry2.moduleBased !== moduleBased) {
          doOnce(function() {
            console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms.");
            console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.");
          }, "ModulePackageCheck");
        }
      }
    };
    ModuleRegistry2.__setIsBundled = function() {
      ModuleRegistry2.isBundled = true;
    };
    ModuleRegistry2.__assertRegistered = function(moduleName, reason, gridId) {
      var _a2;
      if (this.__isRegistered(moduleName, gridId)) {
        return true;
      }
      var warningKey = reason + moduleName;
      var warningMessage;
      if (ModuleRegistry2.isBundled) {
        {
          warningMessage = "AG Grid: unable to use " + reason + ` as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:
        
        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>
        
For more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;
        }
      } else if (ModuleRegistry2.moduleBased || ModuleRegistry2.moduleBased === void 0) {
        var modName = (_a2 = Object.entries(ModuleNames).find(function(_a3) {
          var _b2 = __read$x(_a3, 2);
          _b2[0];
          var v2 = _b2[1];
          return v2 === moduleName;
        })) === null || _a2 === void 0 ? void 0 : _a2[0];
        warningMessage = "AG Grid: unable to use " + reason + " as the " + modName + " is not registered" + (ModuleRegistry2.areGridScopedModules ? " for gridId: " + gridId : "") + ". Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { " + modName + " } from '" + moduleName + "';\n    \n    ModuleRegistry.registerModules([ " + modName + " ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/";
      } else {
        warningMessage = "AG Grid: unable to use " + reason + " as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';\n            \nFor more info see: https://www.ag-grid.com/javascript-grid/packages/";
      }
      doOnce(function() {
        console.warn(warningMessage);
      }, warningKey);
      return false;
    };
    ModuleRegistry2.__isRegistered = function(moduleName, gridId) {
      var _a2;
      return !!ModuleRegistry2.globalModulesMap[moduleName] || !!((_a2 = ModuleRegistry2.gridModulesMap[gridId]) === null || _a2 === void 0 ? void 0 : _a2[moduleName]);
    };
    ModuleRegistry2.__getRegisteredModules = function(gridId) {
      return __spreadArray$r(__spreadArray$r([], __read$x(values(ModuleRegistry2.globalModulesMap))), __read$x(values(ModuleRegistry2.gridModulesMap[gridId] || {})));
    };
    ModuleRegistry2.__getGridRegisteredModules = function(gridId) {
      var _a2;
      return values((_a2 = ModuleRegistry2.gridModulesMap[gridId]) !== null && _a2 !== void 0 ? _a2 : {}) || [];
    };
    ModuleRegistry2.__isPackageBased = function() {
      return !ModuleRegistry2.moduleBased;
    };
    ModuleRegistry2.globalModulesMap = {};
    ModuleRegistry2.gridModulesMap = {};
    ModuleRegistry2.areGridScopedModules = false;
    return ModuleRegistry2;
  }()
);
var __read$w = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$q = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var Context = (
  /** @class */
  function() {
    function Context2(params, logger) {
      this.beanWrappers = {};
      this.destroyed = false;
      if (!params || !params.beanClasses) {
        return;
      }
      this.contextParams = params;
      this.logger = logger;
      this.logger.log(">> creating ag-Application Context");
      this.createBeans();
      var beanInstances = this.getBeanInstances();
      this.wireBeans(beanInstances);
      this.logger.log(">> ag-Application Context ready - component is alive");
    }
    Context2.prototype.getBeanInstances = function() {
      return values(this.beanWrappers).map(function(beanEntry) {
        return beanEntry.beanInstance;
      });
    };
    Context2.prototype.createBean = function(bean, afterPreCreateCallback) {
      if (!bean) {
        throw Error("Can't wire to bean since it is null");
      }
      this.wireBeans([bean], afterPreCreateCallback);
      return bean;
    };
    Context2.prototype.wireBeans = function(beanInstances, afterPreCreateCallback) {
      this.autoWireBeans(beanInstances);
      this.methodWireBeans(beanInstances);
      this.callLifeCycleMethods(beanInstances, "preConstructMethods");
      if (exists(afterPreCreateCallback)) {
        beanInstances.forEach(afterPreCreateCallback);
      }
      this.callLifeCycleMethods(beanInstances, "postConstructMethods");
    };
    Context2.prototype.createBeans = function() {
      var _this = this;
      this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this));
      iterateObject(this.beanWrappers, function(key, beanEntry) {
        var constructorParamsMeta;
        if (beanEntry.bean.__agBeanMetaData && beanEntry.bean.__agBeanMetaData.autowireMethods && beanEntry.bean.__agBeanMetaData.autowireMethods.agConstructor) {
          constructorParamsMeta = beanEntry.bean.__agBeanMetaData.autowireMethods.agConstructor;
        }
        var constructorParams = _this.getBeansForParameters(constructorParamsMeta, beanEntry.bean.name);
        var newInstance = new (beanEntry.bean.bind.apply(beanEntry.bean, __spreadArray$q([null], __read$w(constructorParams))))();
        beanEntry.beanInstance = newInstance;
      });
      var createdBeanNames = Object.keys(this.beanWrappers).join(", ");
      this.logger.log("created beans: " + createdBeanNames);
    };
    Context2.prototype.createBeanWrapper = function(BeanClass) {
      var metaData = BeanClass.__agBeanMetaData;
      if (!metaData) {
        var beanName = void 0;
        if (BeanClass.prototype.constructor) {
          beanName = getFunctionName(BeanClass.prototype.constructor);
        } else {
          beanName = "" + BeanClass;
        }
        console.error("Context item " + beanName + " is not a bean");
        return;
      }
      var beanEntry = {
        bean: BeanClass,
        beanInstance: null,
        beanName: metaData.beanName
      };
      this.beanWrappers[metaData.beanName] = beanEntry;
    };
    Context2.prototype.autoWireBeans = function(beanInstances) {
      var _this = this;
      beanInstances.forEach(function(beanInstance) {
        _this.forEachMetaDataInHierarchy(beanInstance, function(metaData, beanName) {
          var attributes = metaData.agClassAttributes;
          if (!attributes) {
            return;
          }
          attributes.forEach(function(attribute) {
            var otherBean = _this.lookupBeanInstance(beanName, attribute.beanName, attribute.optional);
            beanInstance[attribute.attributeName] = otherBean;
          });
        });
      });
    };
    Context2.prototype.methodWireBeans = function(beanInstances) {
      var _this = this;
      beanInstances.forEach(function(beanInstance) {
        _this.forEachMetaDataInHierarchy(beanInstance, function(metaData, beanName) {
          iterateObject(metaData.autowireMethods, function(methodName, wireParams) {
            if (methodName === "agConstructor") {
              return;
            }
            var initParams = _this.getBeansForParameters(wireParams, beanName);
            beanInstance[methodName].apply(beanInstance, initParams);
          });
        });
      });
    };
    Context2.prototype.forEachMetaDataInHierarchy = function(beanInstance, callback2) {
      var prototype = Object.getPrototypeOf(beanInstance);
      while (prototype != null) {
        var constructor = prototype.constructor;
        if (constructor.hasOwnProperty("__agBeanMetaData")) {
          var metaData = constructor.__agBeanMetaData;
          var beanName = this.getBeanName(constructor);
          callback2(metaData, beanName);
        }
        prototype = Object.getPrototypeOf(prototype);
      }
    };
    Context2.prototype.getBeanName = function(constructor) {
      if (constructor.__agBeanMetaData && constructor.__agBeanMetaData.beanName) {
        return constructor.__agBeanMetaData.beanName;
      }
      var constructorString = constructor.toString();
      var beanName = constructorString.substring(9, constructorString.indexOf("("));
      return beanName;
    };
    Context2.prototype.getBeansForParameters = function(parameters, beanName) {
      var _this = this;
      var beansList = [];
      if (parameters) {
        iterateObject(parameters, function(paramIndex, otherBeanName) {
          var otherBean = _this.lookupBeanInstance(beanName, otherBeanName);
          beansList[Number(paramIndex)] = otherBean;
        });
      }
      return beansList;
    };
    Context2.prototype.lookupBeanInstance = function(wiringBean, beanName, optional) {
      if (optional === void 0) {
        optional = false;
      }
      if (this.destroyed) {
        this.logger.log("AG Grid: bean reference " + beanName + " is used after the grid is destroyed!");
        return null;
      }
      if (beanName === "context") {
        return this;
      }
      if (this.contextParams.providedBeanInstances && this.contextParams.providedBeanInstances.hasOwnProperty(beanName)) {
        return this.contextParams.providedBeanInstances[beanName];
      }
      var beanEntry = this.beanWrappers[beanName];
      if (beanEntry) {
        return beanEntry.beanInstance;
      }
      if (!optional) {
        console.error("AG Grid: unable to find bean reference " + beanName + " while initialising " + wiringBean);
      }
      return null;
    };
    Context2.prototype.callLifeCycleMethods = function(beanInstances, lifeCycleMethod) {
      var _this = this;
      beanInstances.forEach(function(beanInstance) {
        return _this.callLifeCycleMethodsOnBean(beanInstance, lifeCycleMethod);
      });
    };
    Context2.prototype.callLifeCycleMethodsOnBean = function(beanInstance, lifeCycleMethod, methodToIgnore) {
      var allMethods = {};
      this.forEachMetaDataInHierarchy(beanInstance, function(metaData) {
        var methods = metaData[lifeCycleMethod];
        if (methods) {
          methods.forEach(function(methodName) {
            if (methodName != methodToIgnore) {
              allMethods[methodName] = true;
            }
          });
        }
      });
      var allMethodsList = Object.keys(allMethods);
      allMethodsList.forEach(function(methodName) {
        return beanInstance[methodName]();
      });
    };
    Context2.prototype.getBean = function(name) {
      return this.lookupBeanInstance("getBean", name, true);
    };
    Context2.prototype.destroy = function() {
      if (this.destroyed) {
        return;
      }
      this.logger.log(">> Shutting down ag-Application Context");
      var beanInstances = this.getBeanInstances();
      this.destroyBeans(beanInstances);
      this.contextParams.providedBeanInstances = null;
      ModuleRegistry.__unRegisterGridModules(this.contextParams.gridId);
      this.destroyed = true;
      this.logger.log(">> ag-Application Context shut down - component is dead");
    };
    Context2.prototype.destroyBean = function(bean) {
      if (!bean) {
        return;
      }
      this.destroyBeans([bean]);
    };
    Context2.prototype.destroyBeans = function(beans) {
      var _this = this;
      if (!beans) {
        return [];
      }
      beans.forEach(function(bean) {
        _this.callLifeCycleMethodsOnBean(bean, "preDestroyMethods", "destroy");
        var beanAny = bean;
        if (typeof beanAny.destroy === "function") {
          beanAny.destroy();
        }
      });
      return [];
    };
    Context2.prototype.isDestroyed = function() {
      return this.destroyed;
    };
    Context2.prototype.getGridId = function() {
      return this.contextParams.gridId;
    };
    return Context2;
  }()
);
function PreConstruct(target, methodName, descriptor) {
  var props = getOrCreateProps$1(target.constructor);
  if (!props.preConstructMethods) {
    props.preConstructMethods = [];
  }
  props.preConstructMethods.push(methodName);
}
function PostConstruct(target, methodName, descriptor) {
  var props = getOrCreateProps$1(target.constructor);
  if (!props.postConstructMethods) {
    props.postConstructMethods = [];
  }
  props.postConstructMethods.push(methodName);
}
function PreDestroy(target, methodName, descriptor) {
  var props = getOrCreateProps$1(target.constructor);
  if (!props.preDestroyMethods) {
    props.preDestroyMethods = [];
  }
  props.preDestroyMethods.push(methodName);
}
function Bean(beanName) {
  return function(classConstructor) {
    var props = getOrCreateProps$1(classConstructor);
    props.beanName = beanName;
  };
}
function Autowired(name) {
  return function(target, propertyKey, descriptor) {
    autowiredFunc(target, name, false, target, propertyKey, null);
  };
}
function Optional(name) {
  return function(target, propertyKey, descriptor) {
    autowiredFunc(target, name, true, target, propertyKey, null);
  };
}
function autowiredFunc(target, name, optional, classPrototype, methodOrAttributeName, index2) {
  if (name === null) {
    console.error("AG Grid: Autowired name should not be null");
    return;
  }
  if (typeof index2 === "number") {
    console.error("AG Grid: Autowired should be on an attribute");
    return;
  }
  var props = getOrCreateProps$1(target.constructor);
  if (!props.agClassAttributes) {
    props.agClassAttributes = [];
  }
  props.agClassAttributes.push({
    attributeName: methodOrAttributeName,
    beanName: name,
    optional
  });
}
function Qualifier(name) {
  return function(classPrototype, methodOrAttributeName, index2) {
    var constructor = typeof classPrototype == "function" ? classPrototype : classPrototype.constructor;
    var props;
    if (typeof index2 === "number") {
      var methodName = void 0;
      if (methodOrAttributeName) {
        props = getOrCreateProps$1(constructor);
        methodName = methodOrAttributeName;
      } else {
        props = getOrCreateProps$1(constructor);
        methodName = "agConstructor";
      }
      if (!props.autowireMethods) {
        props.autowireMethods = {};
      }
      if (!props.autowireMethods[methodName]) {
        props.autowireMethods[methodName] = {};
      }
      props.autowireMethods[methodName][index2] = name;
    }
  };
}
function getOrCreateProps$1(target) {
  if (!target.hasOwnProperty("__agBeanMetaData")) {
    target.__agBeanMetaData = {};
  }
  return target.__agBeanMetaData;
}
var __decorate$2E = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$a = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var EventService = (
  /** @class */
  function() {
    function EventService2() {
      this.allSyncListeners = /* @__PURE__ */ new Map();
      this.allAsyncListeners = /* @__PURE__ */ new Map();
      this.globalSyncListeners = /* @__PURE__ */ new Set();
      this.globalAsyncListeners = /* @__PURE__ */ new Set();
      this.asyncFunctionsQueue = [];
      this.scheduled = false;
      this.firedEvents = {};
    }
    EventService2.prototype.setBeans = function(loggerFactory, gridOptionsService, frameworkOverrides, globalEventListener) {
      if (globalEventListener === void 0) {
        globalEventListener = null;
      }
      this.frameworkOverrides = frameworkOverrides;
      this.gridOptionsService = gridOptionsService;
      if (globalEventListener) {
        var async = gridOptionsService.useAsyncEvents();
        this.addGlobalListener(globalEventListener, async);
      }
    };
    EventService2.prototype.getListeners = function(eventType, async, autoCreateListenerCollection) {
      var listenerMap = async ? this.allAsyncListeners : this.allSyncListeners;
      var listeners2 = listenerMap.get(eventType);
      if (!listeners2 && autoCreateListenerCollection) {
        listeners2 = /* @__PURE__ */ new Set();
        listenerMap.set(eventType, listeners2);
      }
      return listeners2;
    };
    EventService2.prototype.noRegisteredListenersExist = function() {
      return this.allSyncListeners.size === 0 && this.allAsyncListeners.size === 0 && this.globalSyncListeners.size === 0 && this.globalAsyncListeners.size === 0;
    };
    EventService2.prototype.addEventListener = function(eventType, listener, async) {
      if (async === void 0) {
        async = false;
      }
      this.getListeners(eventType, async, true).add(listener);
    };
    EventService2.prototype.removeEventListener = function(eventType, listener, async) {
      if (async === void 0) {
        async = false;
      }
      var listeners2 = this.getListeners(eventType, async, false);
      if (!listeners2) {
        return;
      }
      listeners2.delete(listener);
      if (listeners2.size === 0) {
        var listenerMap = async ? this.allAsyncListeners : this.allSyncListeners;
        listenerMap.delete(eventType);
      }
    };
    EventService2.prototype.addGlobalListener = function(listener, async) {
      if (async === void 0) {
        async = false;
      }
      (async ? this.globalAsyncListeners : this.globalSyncListeners).add(listener);
    };
    EventService2.prototype.removeGlobalListener = function(listener, async) {
      if (async === void 0) {
        async = false;
      }
      (async ? this.globalAsyncListeners : this.globalSyncListeners).delete(listener);
    };
    EventService2.prototype.dispatchEvent = function(event) {
      var agEvent = event;
      if (this.gridOptionsService) {
        var _a2 = this.gridOptionsService, api = _a2.api, columnApi = _a2.columnApi, context = _a2.context;
        agEvent.api = api;
        agEvent.columnApi = columnApi;
        agEvent.context = context;
      }
      this.dispatchToListeners(agEvent, true);
      this.dispatchToListeners(agEvent, false);
      this.firedEvents[agEvent.type] = true;
    };
    EventService2.prototype.dispatchEventOnce = function(event) {
      if (!this.firedEvents[event.type]) {
        this.dispatchEvent(event);
      }
    };
    EventService2.prototype.dispatchToListeners = function(event, async) {
      var _this = this;
      var eventType = event.type;
      if (async && "event" in event) {
        var browserEvent = event.event;
        if (browserEvent instanceof Event) {
          event.eventPath = browserEvent.composedPath();
        }
      }
      var processEventListeners = function(listeners3) {
        return listeners3.forEach(function(listener) {
          if (async) {
            _this.dispatchAsync(function() {
              return listener(event);
            });
          } else {
            listener(event);
          }
        });
      };
      var listeners2 = new Set(this.getListeners(eventType, async, false));
      if (listeners2) {
        processEventListeners(listeners2);
      }
      var globalListeners = new Set(async ? this.globalAsyncListeners : this.globalSyncListeners);
      globalListeners.forEach(function(listener) {
        if (async) {
          _this.dispatchAsync(function() {
            return _this.frameworkOverrides.dispatchEvent(eventType, function() {
              return listener(eventType, event);
            }, true);
          });
        } else {
          _this.frameworkOverrides.dispatchEvent(eventType, function() {
            return listener(eventType, event);
          }, true);
        }
      });
    };
    EventService2.prototype.dispatchAsync = function(func) {
      this.asyncFunctionsQueue.push(func);
      if (!this.scheduled) {
        window.setTimeout(this.flushAsyncQueue.bind(this), 0);
        this.scheduled = true;
      }
    };
    EventService2.prototype.flushAsyncQueue = function() {
      this.scheduled = false;
      var queueCopy = this.asyncFunctionsQueue.slice();
      this.asyncFunctionsQueue = [];
      queueCopy.forEach(function(func) {
        return func();
      });
    };
    __decorate$2E([
      __param$a(0, Qualifier("loggerFactory")),
      __param$a(1, Qualifier("gridOptionsService")),
      __param$a(2, Qualifier("frameworkOverrides")),
      __param$a(3, Qualifier("globalEventListener"))
    ], EventService2.prototype, "setBeans", null);
    EventService2 = __decorate$2E([
      Bean("eventService")
    ], EventService2);
    return EventService2;
  }()
);
var __decorate$2D = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$v = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$p = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var instanceIdSequence$4 = 0;
function getNextColInstanceId() {
  return instanceIdSequence$4++;
}
var Column = (
  /** @class */
  function() {
    function Column2(colDef, userProvidedColDef, colId, primary) {
      this.instanceId = getNextColInstanceId();
      this.autoHeaderHeight = null;
      this.moving = false;
      this.menuVisible = false;
      this.filterActive = false;
      this.eventService = new EventService();
      this.tooltipEnabled = false;
      this.rowGroupActive = false;
      this.pivotActive = false;
      this.aggregationActive = false;
      this.colDef = colDef;
      this.userProvidedColDef = userProvidedColDef;
      this.colId = colId;
      this.primary = primary;
      this.setState(colDef);
    }
    Column2.prototype.getInstanceId = function() {
      return this.instanceId;
    };
    Column2.prototype.setState = function(colDef) {
      if (colDef.sort !== void 0) {
        if (colDef.sort === "asc" || colDef.sort === "desc") {
          this.sort = colDef.sort;
        }
      } else {
        if (colDef.initialSort === "asc" || colDef.initialSort === "desc") {
          this.sort = colDef.initialSort;
        }
      }
      var sortIndex = attrToNumber(colDef.sortIndex);
      var initialSortIndex = attrToNumber(colDef.initialSortIndex);
      if (sortIndex !== void 0) {
        if (sortIndex !== null) {
          this.sortIndex = sortIndex;
        }
      } else {
        if (initialSortIndex !== null) {
          this.sortIndex = initialSortIndex;
        }
      }
      var hide = attrToBoolean(colDef.hide);
      var initialHide = attrToBoolean(colDef.initialHide);
      if (hide !== void 0) {
        this.visible = !hide;
      } else {
        this.visible = !initialHide;
      }
      if (colDef.pinned !== void 0) {
        this.setPinned(colDef.pinned);
      } else {
        this.setPinned(colDef.initialPinned);
      }
      var flex = attrToNumber(colDef.flex);
      var initialFlex = attrToNumber(colDef.initialFlex);
      if (flex !== void 0) {
        this.flex = flex;
      } else if (initialFlex !== void 0) {
        this.flex = initialFlex;
      }
    };
    Column2.prototype.setColDef = function(colDef, userProvidedColDef) {
      this.colDef = colDef;
      this.userProvidedColDef = userProvidedColDef;
      this.initMinAndMaxWidths();
      this.initDotNotation();
      this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged", "api"));
    };
    Column2.prototype.getUserProvidedColDef = function() {
      return this.userProvidedColDef;
    };
    Column2.prototype.setParent = function(parent) {
      this.parent = parent;
    };
    Column2.prototype.getParent = function() {
      return this.parent;
    };
    Column2.prototype.setOriginalParent = function(originalParent) {
      this.originalParent = originalParent;
    };
    Column2.prototype.getOriginalParent = function() {
      return this.originalParent;
    };
    Column2.prototype.initialise = function() {
      this.initMinAndMaxWidths();
      this.resetActualWidth("gridInitializing");
      this.initDotNotation();
      this.initTooltip();
      this.validate();
    };
    Column2.prototype.initDotNotation = function() {
      var suppressDotNotation = this.gridOptionsService.is("suppressFieldDotNotation");
      this.fieldContainsDots = exists(this.colDef.field) && this.colDef.field.indexOf(".") >= 0 && !suppressDotNotation;
      this.tooltipFieldContainsDots = exists(this.colDef.tooltipField) && this.colDef.tooltipField.indexOf(".") >= 0 && !suppressDotNotation;
    };
    Column2.prototype.initMinAndMaxWidths = function() {
      var colDef = this.colDef;
      this.minWidth = this.columnUtils.calculateColMinWidth(colDef);
      this.maxWidth = this.columnUtils.calculateColMaxWidth(colDef);
    };
    Column2.prototype.initTooltip = function() {
      this.tooltipEnabled = exists(this.colDef.tooltipField) || exists(this.colDef.tooltipValueGetter) || exists(this.colDef.tooltipComponent);
    };
    Column2.prototype.resetActualWidth = function(source) {
      if (source === void 0) {
        source = "api";
      }
      var initialWidth = this.columnUtils.calculateColInitialWidth(this.colDef);
      this.setActualWidth(initialWidth, source, true);
    };
    Column2.prototype.isEmptyGroup = function() {
      return false;
    };
    Column2.prototype.isRowGroupDisplayed = function(colId) {
      if (missing(this.colDef) || missing(this.colDef.showRowGroup)) {
        return false;
      }
      var showingAllGroups = this.colDef.showRowGroup === true;
      var showingThisGroup = this.colDef.showRowGroup === colId;
      return showingAllGroups || showingThisGroup;
    };
    Column2.prototype.isPrimary = function() {
      return this.primary;
    };
    Column2.prototype.isFilterAllowed = function() {
      var filterDefined = !!this.colDef.filter;
      return filterDefined;
    };
    Column2.prototype.isFieldContainsDots = function() {
      return this.fieldContainsDots;
    };
    Column2.prototype.isTooltipEnabled = function() {
      return this.tooltipEnabled;
    };
    Column2.prototype.isTooltipFieldContainsDots = function() {
      return this.tooltipFieldContainsDots;
    };
    Column2.prototype.validate = function() {
      var colDefAny = this.colDef;
      function warnOnce(msg, key, obj) {
        doOnce(function() {
          if (obj) {
            console.warn(msg, obj);
          } else {
            doOnce(function() {
              return console.warn(msg);
            }, key);
          }
        }, key);
      }
      var usingCSRM = this.gridOptionsService.isRowModelType("clientSide");
      if (usingCSRM && !ModuleRegistry.__isRegistered(ModuleNames.RowGroupingModule, this.gridOptionsService.getGridId())) {
        var rowGroupingItems = ["enableRowGroup", "rowGroup", "rowGroupIndex", "enablePivot", "enableValue", "pivot", "pivotIndex", "aggFunc"];
        var itemsUsed = rowGroupingItems.filter(function(x2) {
          return exists(colDefAny[x2]);
        });
        if (itemsUsed.length > 0) {
          ModuleRegistry.__assertRegistered(ModuleNames.RowGroupingModule, itemsUsed.map(function(i) {
            return "colDef." + i;
          }).join(", "), this.gridOptionsService.getGridId());
        }
      }
      if (this.colDef.cellEditor === "agRichSelect" || this.colDef.cellEditor === "agRichSelectCellEditor") {
        ModuleRegistry.__assertRegistered(ModuleNames.RichSelectModule, this.colDef.cellEditor, this.gridOptionsService.getGridId());
      }
      if (this.gridOptionsService.isTreeData()) {
        var itemsNotAllowedWithTreeData = ["rowGroup", "rowGroupIndex", "pivot", "pivotIndex"];
        var itemsUsed = itemsNotAllowedWithTreeData.filter(function(x2) {
          return exists(colDefAny[x2]);
        });
        if (itemsUsed.length > 0) {
          warnOnce("AG Grid: " + itemsUsed.join() + " is not possible when doing tree data, your column definition should not have " + itemsUsed.join(), "TreeDataCannotRowGroup");
        }
      }
      if (exists(colDefAny.menuTabs)) {
        if (Array.isArray(colDefAny.menuTabs)) {
          var communityMenuTabs_1 = ["filterMenuTab"];
          var enterpriseMenuTabs_1 = ["columnsMenuTab", "generalMenuTab"];
          var itemsUsed = enterpriseMenuTabs_1.filter(function(x2) {
            return colDefAny.menuTabs.includes(x2);
          });
          if (itemsUsed.length > 0) {
            ModuleRegistry.__assertRegistered(ModuleNames.MenuModule, "menuTab(s): " + itemsUsed.map(function(t2) {
              return "'" + t2 + "'";
            }).join(), this.gridOptionsService.getGridId());
          }
          colDefAny.menuTabs.forEach(function(tab) {
            if (!enterpriseMenuTabs_1.includes(tab) && !communityMenuTabs_1.includes(tab)) {
              warnOnce("AG Grid: '" + tab + "' is not valid for 'colDef.menuTabs'. Valid values are: " + __spreadArray$p(__spreadArray$p([], __read$v(communityMenuTabs_1)), __read$v(enterpriseMenuTabs_1)).map(function(t2) {
                return "'" + t2 + "'";
              }).join() + ".", "wrongValue_menuTabs_" + tab);
            }
          });
        } else {
          warnOnce("AG Grid: The typeof 'colDef.menuTabs' should be an array not:" + typeof colDefAny.menuTabs, "wrongType_menuTabs");
        }
      }
      if (exists(colDefAny.columnsMenuParams)) {
        ModuleRegistry.__assertRegistered(ModuleNames.MenuModule, "columnsMenuParams", this.gridOptionsService.getGridId());
      }
      if (exists(colDefAny.columnsMenuParams)) {
        ModuleRegistry.__assertRegistered(ModuleNames.ColumnsToolPanelModule, "columnsMenuParams", this.gridOptionsService.getGridId());
      }
      if (exists(this.colDef.width) && typeof this.colDef.width !== "number") {
        warnOnce("AG Grid: colDef.width should be a number, not " + typeof this.colDef.width, "ColumnCheck");
      }
      if (exists(colDefAny.columnGroupShow) && colDefAny.columnGroupShow !== "closed" && colDefAny.columnGroupShow !== "open") {
        warnOnce("AG Grid: '" + colDefAny.columnGroupShow + "' is not valid for columnGroupShow. Valid values are 'open', 'closed', undefined, null", "columnGroupShow_invalid");
      }
    };
    Column2.prototype.addEventListener = function(eventType, listener) {
      this.eventService.addEventListener(eventType, listener);
    };
    Column2.prototype.removeEventListener = function(eventType, listener) {
      this.eventService.removeEventListener(eventType, listener);
    };
    Column2.prototype.createColumnFunctionCallbackParams = function(rowNode) {
      return {
        node: rowNode,
        data: rowNode.data,
        column: this,
        colDef: this.colDef,
        context: this.gridOptionsService.context,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi
      };
    };
    Column2.prototype.isSuppressNavigable = function(rowNode) {
      if (typeof this.colDef.suppressNavigable === "boolean") {
        return this.colDef.suppressNavigable;
      }
      if (typeof this.colDef.suppressNavigable === "function") {
        var params = this.createColumnFunctionCallbackParams(rowNode);
        var userFunc = this.colDef.suppressNavigable;
        return userFunc(params);
      }
      return false;
    };
    Column2.prototype.isCellEditable = function(rowNode) {
      if (rowNode.group && !this.gridOptionsService.is("enableGroupEdit")) {
        return false;
      }
      return this.isColumnFunc(rowNode, this.colDef.editable);
    };
    Column2.prototype.isSuppressFillHandle = function() {
      return !!attrToBoolean(this.colDef.suppressFillHandle);
    };
    Column2.prototype.isAutoHeight = function() {
      return !!attrToBoolean(this.colDef.autoHeight);
    };
    Column2.prototype.isAutoHeaderHeight = function() {
      return !!attrToBoolean(this.colDef.autoHeaderHeight);
    };
    Column2.prototype.isRowDrag = function(rowNode) {
      return this.isColumnFunc(rowNode, this.colDef.rowDrag);
    };
    Column2.prototype.isDndSource = function(rowNode) {
      return this.isColumnFunc(rowNode, this.colDef.dndSource);
    };
    Column2.prototype.isCellCheckboxSelection = function(rowNode) {
      return this.isColumnFunc(rowNode, this.colDef.checkboxSelection);
    };
    Column2.prototype.isSuppressPaste = function(rowNode) {
      return this.isColumnFunc(rowNode, this.colDef ? this.colDef.suppressPaste : null);
    };
    Column2.prototype.isResizable = function() {
      return !!attrToBoolean(this.colDef.resizable);
    };
    Column2.prototype.isColumnFunc = function(rowNode, value) {
      if (typeof value === "boolean") {
        return value;
      }
      if (typeof value === "function") {
        var params = this.createColumnFunctionCallbackParams(rowNode);
        var editableFunc = value;
        return editableFunc(params);
      }
      return false;
    };
    Column2.prototype.setMoving = function(moving, source) {
      if (source === void 0) {
        source = "api";
      }
      this.moving = moving;
      this.eventService.dispatchEvent(this.createColumnEvent("movingChanged", source));
    };
    Column2.prototype.createColumnEvent = function(type, source) {
      return {
        type,
        column: this,
        columns: [this],
        source,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context
      };
    };
    Column2.prototype.isMoving = function() {
      return this.moving;
    };
    Column2.prototype.getSort = function() {
      return this.sort;
    };
    Column2.prototype.setSort = function(sort, source) {
      if (source === void 0) {
        source = "api";
      }
      if (this.sort !== sort) {
        this.sort = sort;
        this.eventService.dispatchEvent(this.createColumnEvent("sortChanged", source));
      }
      this.dispatchStateUpdatedEvent("sort");
    };
    Column2.prototype.setMenuVisible = function(visible, source) {
      if (source === void 0) {
        source = "api";
      }
      if (this.menuVisible !== visible) {
        this.menuVisible = visible;
        this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged", source));
      }
    };
    Column2.prototype.isMenuVisible = function() {
      return this.menuVisible;
    };
    Column2.prototype.isSortAscending = function() {
      return this.sort === "asc";
    };
    Column2.prototype.isSortDescending = function() {
      return this.sort === "desc";
    };
    Column2.prototype.isSortNone = function() {
      return missing(this.sort);
    };
    Column2.prototype.isSorting = function() {
      return exists(this.sort);
    };
    Column2.prototype.getSortIndex = function() {
      return this.sortIndex;
    };
    Column2.prototype.setSortIndex = function(sortOrder) {
      this.sortIndex = sortOrder;
      this.dispatchStateUpdatedEvent("sortIndex");
    };
    Column2.prototype.setAggFunc = function(aggFunc) {
      this.aggFunc = aggFunc;
      this.dispatchStateUpdatedEvent("aggFunc");
    };
    Column2.prototype.getAggFunc = function() {
      return this.aggFunc;
    };
    Column2.prototype.getLeft = function() {
      return this.left;
    };
    Column2.prototype.getOldLeft = function() {
      return this.oldLeft;
    };
    Column2.prototype.getRight = function() {
      return this.left + this.actualWidth;
    };
    Column2.prototype.setLeft = function(left, source) {
      if (source === void 0) {
        source = "api";
      }
      this.oldLeft = this.left;
      if (this.left !== left) {
        this.left = left;
        this.eventService.dispatchEvent(this.createColumnEvent("leftChanged", source));
      }
    };
    Column2.prototype.isFilterActive = function() {
      return this.filterActive;
    };
    Column2.prototype.setFilterActive = function(active, source, additionalEventAttributes) {
      if (source === void 0) {
        source = "api";
      }
      if (this.filterActive !== active) {
        this.filterActive = active;
        this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged", source));
      }
      var filterChangedEvent = this.createColumnEvent("filterChanged", source);
      if (additionalEventAttributes) {
        mergeDeep(filterChangedEvent, additionalEventAttributes);
      }
      this.eventService.dispatchEvent(filterChangedEvent);
    };
    Column2.prototype.isHovered = function() {
      return this.columnHoverService.isHovered(this);
    };
    Column2.prototype.setPinned = function(pinned) {
      if (pinned === true || pinned === "left") {
        this.pinned = "left";
      } else if (pinned === "right") {
        this.pinned = "right";
      } else {
        this.pinned = null;
      }
      this.dispatchStateUpdatedEvent("pinned");
    };
    Column2.prototype.setFirstRightPinned = function(firstRightPinned, source) {
      if (source === void 0) {
        source = "api";
      }
      if (this.firstRightPinned !== firstRightPinned) {
        this.firstRightPinned = firstRightPinned;
        this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged", source));
      }
    };
    Column2.prototype.setLastLeftPinned = function(lastLeftPinned, source) {
      if (source === void 0) {
        source = "api";
      }
      if (this.lastLeftPinned !== lastLeftPinned) {
        this.lastLeftPinned = lastLeftPinned;
        this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged", source));
      }
    };
    Column2.prototype.isFirstRightPinned = function() {
      return this.firstRightPinned;
    };
    Column2.prototype.isLastLeftPinned = function() {
      return this.lastLeftPinned;
    };
    Column2.prototype.isPinned = function() {
      return this.pinned === "left" || this.pinned === "right";
    };
    Column2.prototype.isPinnedLeft = function() {
      return this.pinned === "left";
    };
    Column2.prototype.isPinnedRight = function() {
      return this.pinned === "right";
    };
    Column2.prototype.getPinned = function() {
      return this.pinned;
    };
    Column2.prototype.setVisible = function(visible, source) {
      if (source === void 0) {
        source = "api";
      }
      var newValue = visible === true;
      if (this.visible !== newValue) {
        this.visible = newValue;
        this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged", source));
      }
      this.dispatchStateUpdatedEvent("hide");
    };
    Column2.prototype.isVisible = function() {
      return this.visible;
    };
    Column2.prototype.isSpanHeaderHeight = function() {
      var colDef = this.getColDef();
      return !colDef.suppressSpanHeaderHeight && !colDef.autoHeaderHeight;
    };
    Column2.prototype.getColDef = function() {
      return this.colDef;
    };
    Column2.prototype.getColumnGroupShow = function() {
      return this.colDef.columnGroupShow;
    };
    Column2.prototype.getColId = function() {
      return this.colId;
    };
    Column2.prototype.getId = function() {
      return this.colId;
    };
    Column2.prototype.getUniqueId = function() {
      return this.colId;
    };
    Column2.prototype.getDefinition = function() {
      return this.colDef;
    };
    Column2.prototype.getActualWidth = function() {
      return this.actualWidth;
    };
    Column2.prototype.getAutoHeaderHeight = function() {
      return this.autoHeaderHeight;
    };
    Column2.prototype.setAutoHeaderHeight = function(height) {
      var changed = height !== this.autoHeaderHeight;
      this.autoHeaderHeight = height;
      return changed;
    };
    Column2.prototype.createBaseColDefParams = function(rowNode) {
      var params = {
        node: rowNode,
        data: rowNode.data,
        colDef: this.colDef,
        column: this,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context
      };
      return params;
    };
    Column2.prototype.getColSpan = function(rowNode) {
      if (missing(this.colDef.colSpan)) {
        return 1;
      }
      var params = this.createBaseColDefParams(rowNode);
      var colSpan = this.colDef.colSpan(params);
      return Math.max(colSpan, 1);
    };
    Column2.prototype.getRowSpan = function(rowNode) {
      if (missing(this.colDef.rowSpan)) {
        return 1;
      }
      var params = this.createBaseColDefParams(rowNode);
      var rowSpan = this.colDef.rowSpan(params);
      return Math.max(rowSpan, 1);
    };
    Column2.prototype.setActualWidth = function(actualWidth, source, silent) {
      if (source === void 0) {
        source = "api";
      }
      if (silent === void 0) {
        silent = false;
      }
      if (this.minWidth != null) {
        actualWidth = Math.max(actualWidth, this.minWidth);
      }
      if (this.maxWidth != null) {
        actualWidth = Math.min(actualWidth, this.maxWidth);
      }
      if (this.actualWidth !== actualWidth) {
        this.actualWidth = actualWidth;
        if (this.flex && source !== "flex" && source !== "gridInitializing") {
          this.flex = null;
        }
        if (!silent) {
          this.fireColumnWidthChangedEvent(source);
        }
      }
      this.dispatchStateUpdatedEvent("width");
    };
    Column2.prototype.fireColumnWidthChangedEvent = function(source) {
      this.eventService.dispatchEvent(this.createColumnEvent("widthChanged", source));
    };
    Column2.prototype.isGreaterThanMax = function(width) {
      if (this.maxWidth != null) {
        return width > this.maxWidth;
      }
      return false;
    };
    Column2.prototype.getMinWidth = function() {
      return this.minWidth;
    };
    Column2.prototype.getMaxWidth = function() {
      return this.maxWidth;
    };
    Column2.prototype.getFlex = function() {
      return this.flex || 0;
    };
    Column2.prototype.setFlex = function(flex) {
      if (this.flex !== flex) {
        this.flex = flex;
      }
      this.dispatchStateUpdatedEvent("flex");
    };
    Column2.prototype.setMinimum = function(source) {
      if (source === void 0) {
        source = "api";
      }
      if (exists(this.minWidth)) {
        this.setActualWidth(this.minWidth, source);
      }
    };
    Column2.prototype.setRowGroupActive = function(rowGroup, source) {
      if (source === void 0) {
        source = "api";
      }
      if (this.rowGroupActive !== rowGroup) {
        this.rowGroupActive = rowGroup;
        this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged", source));
      }
      this.dispatchStateUpdatedEvent("rowGroup");
    };
    Column2.prototype.isRowGroupActive = function() {
      return this.rowGroupActive;
    };
    Column2.prototype.setPivotActive = function(pivot, source) {
      if (source === void 0) {
        source = "api";
      }
      if (this.pivotActive !== pivot) {
        this.pivotActive = pivot;
        this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged", source));
      }
      this.dispatchStateUpdatedEvent("pivot");
    };
    Column2.prototype.isPivotActive = function() {
      return this.pivotActive;
    };
    Column2.prototype.isAnyFunctionActive = function() {
      return this.isPivotActive() || this.isRowGroupActive() || this.isValueActive();
    };
    Column2.prototype.isAnyFunctionAllowed = function() {
      return this.isAllowPivot() || this.isAllowRowGroup() || this.isAllowValue();
    };
    Column2.prototype.setValueActive = function(value, source) {
      if (source === void 0) {
        source = "api";
      }
      if (this.aggregationActive !== value) {
        this.aggregationActive = value;
        this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged", source));
      }
    };
    Column2.prototype.isValueActive = function() {
      return this.aggregationActive;
    };
    Column2.prototype.isAllowPivot = function() {
      return this.colDef.enablePivot === true;
    };
    Column2.prototype.isAllowValue = function() {
      return this.colDef.enableValue === true;
    };
    Column2.prototype.isAllowRowGroup = function() {
      return this.colDef.enableRowGroup === true;
    };
    Column2.prototype.getMenuTabs = function(defaultValues) {
      var menuTabs = this.getColDef().menuTabs;
      if (menuTabs == null) {
        menuTabs = defaultValues;
      }
      return menuTabs;
    };
    Column2.prototype.dispatchStateUpdatedEvent = function(key) {
      this.eventService.dispatchEvent({
        type: Column2.EVENT_STATE_UPDATED,
        key
      });
    };
    Column2.EVENT_MOVING_CHANGED = "movingChanged";
    Column2.EVENT_LEFT_CHANGED = "leftChanged";
    Column2.EVENT_WIDTH_CHANGED = "widthChanged";
    Column2.EVENT_LAST_LEFT_PINNED_CHANGED = "lastLeftPinnedChanged";
    Column2.EVENT_FIRST_RIGHT_PINNED_CHANGED = "firstRightPinnedChanged";
    Column2.EVENT_VISIBLE_CHANGED = "visibleChanged";
    Column2.EVENT_FILTER_CHANGED = "filterChanged";
    Column2.EVENT_FILTER_ACTIVE_CHANGED = "filterActiveChanged";
    Column2.EVENT_SORT_CHANGED = "sortChanged";
    Column2.EVENT_COL_DEF_CHANGED = "colDefChanged";
    Column2.EVENT_MENU_VISIBLE_CHANGED = "menuVisibleChanged";
    Column2.EVENT_ROW_GROUP_CHANGED = "columnRowGroupChanged";
    Column2.EVENT_PIVOT_CHANGED = "columnPivotChanged";
    Column2.EVENT_VALUE_CHANGED = "columnValueChanged";
    Column2.EVENT_STATE_UPDATED = "columnStateUpdated";
    __decorate$2D([
      Autowired("gridOptionsService")
    ], Column2.prototype, "gridOptionsService", void 0);
    __decorate$2D([
      Autowired("columnUtils")
    ], Column2.prototype, "columnUtils", void 0);
    __decorate$2D([
      Autowired("columnHoverService")
    ], Column2.prototype, "columnHoverService", void 0);
    __decorate$2D([
      PostConstruct
    ], Column2.prototype, "initialise", null);
    return Column2;
  }()
);
var __decorate$2C = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ProvidedColumnGroup = (
  /** @class */
  function() {
    function ProvidedColumnGroup2(colGroupDef, groupId, padding, level) {
      this.localEventService = new EventService();
      this.expandable = false;
      this.instanceId = getNextColInstanceId();
      this.expandableListenerRemoveCallback = null;
      this.colGroupDef = colGroupDef;
      this.groupId = groupId;
      this.expanded = !!colGroupDef && !!colGroupDef.openByDefault;
      this.padding = padding;
      this.level = level;
    }
    ProvidedColumnGroup2.prototype.destroy = function() {
      if (this.expandableListenerRemoveCallback) {
        this.reset(null, void 0);
      }
    };
    ProvidedColumnGroup2.prototype.reset = function(colGroupDef, level) {
      this.colGroupDef = colGroupDef;
      this.level = level;
      this.originalParent = null;
      if (this.expandableListenerRemoveCallback) {
        this.expandableListenerRemoveCallback();
      }
      this.children = void 0;
      this.expandable = void 0;
    };
    ProvidedColumnGroup2.prototype.getInstanceId = function() {
      return this.instanceId;
    };
    ProvidedColumnGroup2.prototype.setOriginalParent = function(originalParent) {
      this.originalParent = originalParent;
    };
    ProvidedColumnGroup2.prototype.getOriginalParent = function() {
      return this.originalParent;
    };
    ProvidedColumnGroup2.prototype.getLevel = function() {
      return this.level;
    };
    ProvidedColumnGroup2.prototype.isVisible = function() {
      if (this.children) {
        return this.children.some(function(child) {
          return child.isVisible();
        });
      }
      return false;
    };
    ProvidedColumnGroup2.prototype.isPadding = function() {
      return this.padding;
    };
    ProvidedColumnGroup2.prototype.setExpanded = function(expanded) {
      this.expanded = expanded === void 0 ? false : expanded;
      var event = {
        type: ProvidedColumnGroup2.EVENT_EXPANDED_CHANGED
      };
      this.localEventService.dispatchEvent(event);
    };
    ProvidedColumnGroup2.prototype.isExpandable = function() {
      return this.expandable;
    };
    ProvidedColumnGroup2.prototype.isExpanded = function() {
      return this.expanded;
    };
    ProvidedColumnGroup2.prototype.getGroupId = function() {
      return this.groupId;
    };
    ProvidedColumnGroup2.prototype.getId = function() {
      return this.getGroupId();
    };
    ProvidedColumnGroup2.prototype.setChildren = function(children) {
      this.children = children;
    };
    ProvidedColumnGroup2.prototype.getChildren = function() {
      return this.children;
    };
    ProvidedColumnGroup2.prototype.getColGroupDef = function() {
      return this.colGroupDef;
    };
    ProvidedColumnGroup2.prototype.getLeafColumns = function() {
      var result = [];
      this.addLeafColumns(result);
      return result;
    };
    ProvidedColumnGroup2.prototype.addLeafColumns = function(leafColumns) {
      if (!this.children) {
        return;
      }
      this.children.forEach(function(child) {
        if (child instanceof Column) {
          leafColumns.push(child);
        } else if (child instanceof ProvidedColumnGroup2) {
          child.addLeafColumns(leafColumns);
        }
      });
    };
    ProvidedColumnGroup2.prototype.getColumnGroupShow = function() {
      var colGroupDef = this.colGroupDef;
      if (!colGroupDef) {
        return;
      }
      return colGroupDef.columnGroupShow;
    };
    ProvidedColumnGroup2.prototype.setupExpandable = function() {
      var _this = this;
      this.setExpandable();
      if (this.expandableListenerRemoveCallback) {
        this.expandableListenerRemoveCallback();
      }
      var listener = this.onColumnVisibilityChanged.bind(this);
      this.getLeafColumns().forEach(function(col) {
        return col.addEventListener("visibleChanged", listener);
      });
      this.expandableListenerRemoveCallback = function() {
        _this.getLeafColumns().forEach(function(col) {
          return col.removeEventListener("visibleChanged", listener);
        });
        _this.expandableListenerRemoveCallback = null;
      };
    };
    ProvidedColumnGroup2.prototype.setExpandable = function() {
      if (this.isPadding()) {
        return;
      }
      var atLeastOneShowingWhenOpen = false;
      var atLeastOneShowingWhenClosed = false;
      var atLeastOneChangeable = false;
      var children = this.findChildrenRemovingPadding();
      for (var i = 0, j = children.length; i < j; i++) {
        var abstractColumn = children[i];
        if (!abstractColumn.isVisible()) {
          continue;
        }
        var headerGroupShow = abstractColumn.getColumnGroupShow();
        if (headerGroupShow === "open") {
          atLeastOneShowingWhenOpen = true;
          atLeastOneChangeable = true;
        } else if (headerGroupShow === "closed") {
          atLeastOneShowingWhenClosed = true;
          atLeastOneChangeable = true;
        } else {
          atLeastOneShowingWhenOpen = true;
          atLeastOneShowingWhenClosed = true;
        }
      }
      var expandable = atLeastOneShowingWhenOpen && atLeastOneShowingWhenClosed && atLeastOneChangeable;
      if (this.expandable !== expandable) {
        this.expandable = expandable;
        var event_1 = {
          type: ProvidedColumnGroup2.EVENT_EXPANDABLE_CHANGED
        };
        this.localEventService.dispatchEvent(event_1);
      }
    };
    ProvidedColumnGroup2.prototype.findChildrenRemovingPadding = function() {
      var res = [];
      var process = function(items) {
        items.forEach(function(item) {
          var skipBecausePadding = item instanceof ProvidedColumnGroup2 && item.isPadding();
          if (skipBecausePadding) {
            process(item.children);
          } else {
            res.push(item);
          }
        });
      };
      process(this.children);
      return res;
    };
    ProvidedColumnGroup2.prototype.onColumnVisibilityChanged = function() {
      this.setExpandable();
    };
    ProvidedColumnGroup2.prototype.addEventListener = function(eventType, listener) {
      this.localEventService.addEventListener(eventType, listener);
    };
    ProvidedColumnGroup2.prototype.removeEventListener = function(eventType, listener) {
      this.localEventService.removeEventListener(eventType, listener);
    };
    ProvidedColumnGroup2.EVENT_EXPANDED_CHANGED = "expandedChanged";
    ProvidedColumnGroup2.EVENT_EXPANDABLE_CHANGED = "expandableChanged";
    __decorate$2C([
      PreDestroy
    ], ProvidedColumnGroup2.prototype, "destroy", null);
    return ProvidedColumnGroup2;
  }()
);
var DefaultColumnTypes = {
  numericColumn: {
    headerClass: "ag-right-aligned-header",
    cellClass: "ag-right-aligned-cell"
  },
  rightAligned: {
    headerClass: "ag-right-aligned-header",
    cellClass: "ag-right-aligned-cell"
  }
};
function firstExistingValue() {
  var values2 = [];
  for (var _i = 0; _i < arguments.length; _i++) {
    values2[_i] = arguments[_i];
  }
  for (var i = 0; i < values2.length; i++) {
    var value = values2[i];
    if (exists(value)) {
      return value;
    }
  }
  return null;
}
function existsAndNotEmpty(value) {
  return value != null && value.length > 0;
}
function last(arr) {
  if (!arr || !arr.length) {
    return;
  }
  return arr[arr.length - 1];
}
function areEqual(a, b, comparator) {
  if (a == null && b == null) {
    return true;
  }
  return a != null && b != null && a.length === b.length && a.every(function(value, index2) {
    return comparator ? comparator(value, b[index2]) : b[index2] === value;
  });
}
function shallowCompare(arr1, arr2) {
  return areEqual(arr1, arr2);
}
function sortNumerically(array) {
  return array.sort(function(a, b) {
    return a - b;
  });
}
function removeRepeatsFromArray(array, object) {
  if (!array) {
    return;
  }
  for (var index2 = array.length - 2; index2 >= 0; index2--) {
    var thisOneMatches = array[index2] === object;
    var nextOneMatches = array[index2 + 1] === object;
    if (thisOneMatches && nextOneMatches) {
      array.splice(index2 + 1, 1);
    }
  }
}
function removeFromArray(array, object) {
  var index2 = array.indexOf(object);
  if (index2 >= 0) {
    array.splice(index2, 1);
  }
}
function removeAllFromArray(array, toRemove) {
  toRemove.forEach(function(item) {
    return removeFromArray(array, item);
  });
}
function insertIntoArray(array, object, toIndex) {
  array.splice(toIndex, 0, object);
}
function insertArrayIntoArray(dest, src, toIndex) {
  if (dest == null || src == null) {
    return;
  }
  for (var i = src.length - 1; i >= 0; i--) {
    var item = src[i];
    insertIntoArray(dest, item, toIndex);
  }
}
function moveInArray(array, objectsToMove, toIndex) {
  removeAllFromArray(array, objectsToMove);
  objectsToMove.slice().reverse().forEach(function(obj) {
    return insertIntoArray(array, obj, toIndex);
  });
}
function includes(array, value) {
  return array.indexOf(value) > -1;
}
function flatten(arrayOfArrays) {
  return [].concat.apply([], arrayOfArrays);
}
function pushAll(target, source) {
  if (source == null || target == null) {
    return;
  }
  source.forEach(function(value) {
    return target.push(value);
  });
}
function toStrings(array) {
  return array.map(toStringOrNull);
}
function forEachReverse(list, action) {
  if (list == null) {
    return;
  }
  for (var i = list.length - 1; i >= 0; i--) {
    action(list[i], i);
  }
}
var ArrayUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  firstExistingValue,
  existsAndNotEmpty,
  last,
  areEqual,
  shallowCompare,
  sortNumerically,
  removeRepeatsFromArray,
  removeFromArray,
  removeAllFromArray,
  insertIntoArray,
  insertArrayIntoArray,
  moveInArray,
  includes,
  flatten,
  pushAll,
  toStrings,
  forEachReverse
});
var AG_GRID_STOP_PROPAGATION = "__ag_Grid_Stop_Propagation";
var PASSIVE_EVENTS$1 = ["touchstart", "touchend", "touchmove", "touchcancel", "scroll"];
var supports = {};
function stopPropagationForAgGrid(event) {
  event[AG_GRID_STOP_PROPAGATION] = true;
}
function isStopPropagationForAgGrid(event) {
  return event[AG_GRID_STOP_PROPAGATION] === true;
}
var isEventSupported = function() {
  var tags = {
    select: "input",
    change: "input",
    submit: "form",
    reset: "form",
    error: "img",
    load: "img",
    abort: "img"
  };
  var eventChecker = function(eventName) {
    if (typeof supports[eventName] === "boolean") {
      return supports[eventName];
    }
    var el2 = document.createElement(tags[eventName] || "div");
    eventName = "on" + eventName;
    return supports[eventName] = eventName in el2;
  };
  return eventChecker;
}();
function getCtrlForEventTarget(gridOptionsService, eventTarget, type) {
  var sourceElement = eventTarget;
  while (sourceElement) {
    var renderedComp = gridOptionsService.getDomData(sourceElement, type);
    if (renderedComp) {
      return renderedComp;
    }
    sourceElement = sourceElement.parentElement;
  }
  return null;
}
function isElementInEventPath(element, event) {
  if (!event || !element) {
    return false;
  }
  return getEventPath(event).indexOf(element) >= 0;
}
function createEventPath(event) {
  var res = [];
  var pointer = event.target;
  while (pointer) {
    res.push(pointer);
    pointer = pointer.parentElement;
  }
  return res;
}
function getEventPath(event) {
  var eventNoType = event;
  if (eventNoType.path) {
    return eventNoType.path;
  }
  if (eventNoType.composedPath) {
    return eventNoType.composedPath();
  }
  return createEventPath(eventNoType);
}
function addSafePassiveEventListener(frameworkOverrides, eElement, event, listener) {
  var isPassive = includes(PASSIVE_EVENTS$1, event);
  var options = isPassive ? { passive: true } : void 0;
  if (frameworkOverrides && frameworkOverrides.addEventListener) {
    frameworkOverrides.addEventListener(eElement, event, listener, options);
  }
}
var EventUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  stopPropagationForAgGrid,
  isStopPropagationForAgGrid,
  isEventSupported,
  getCtrlForEventTarget,
  isElementInEventPath,
  createEventPath,
  getEventPath,
  addSafePassiveEventListener
});
var __decorate$2B = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var BeanStub = (
  /** @class */
  function() {
    function BeanStub2() {
      var _this = this;
      this.destroyFunctions = [];
      this.destroyed = false;
      this.__v_skip = true;
      this.isAlive = function() {
        return !_this.destroyed;
      };
    }
    BeanStub2.prototype.getFrameworkOverrides = function() {
      return this.frameworkOverrides;
    };
    BeanStub2.prototype.getContext = function() {
      return this.context;
    };
    BeanStub2.prototype.destroy = function() {
      this.destroyFunctions.forEach(function(func) {
        return func();
      });
      this.destroyFunctions.length = 0;
      this.destroyed = true;
      this.dispatchEvent({ type: BeanStub2.EVENT_DESTROYED });
    };
    BeanStub2.prototype.addEventListener = function(eventType, listener) {
      if (!this.localEventService) {
        this.localEventService = new EventService();
      }
      this.localEventService.addEventListener(eventType, listener);
    };
    BeanStub2.prototype.removeEventListener = function(eventType, listener) {
      if (this.localEventService) {
        this.localEventService.removeEventListener(eventType, listener);
      }
    };
    BeanStub2.prototype.dispatchEventAsync = function(event) {
      var _this = this;
      window.setTimeout(function() {
        return _this.dispatchEvent(event);
      }, 0);
    };
    BeanStub2.prototype.dispatchEvent = function(event) {
      if (this.localEventService) {
        this.localEventService.dispatchEvent(event);
      }
    };
    BeanStub2.prototype.addManagedListener = function(object, event, listener) {
      var _this = this;
      if (this.destroyed) {
        return;
      }
      if (object instanceof HTMLElement) {
        addSafePassiveEventListener(this.getFrameworkOverrides(), object, event, listener);
      } else {
        object.addEventListener(event, listener);
      }
      var destroyFunc = function() {
        object.removeEventListener(event, listener);
        _this.destroyFunctions = _this.destroyFunctions.filter(function(fn) {
          return fn !== destroyFunc;
        });
        return null;
      };
      this.destroyFunctions.push(destroyFunc);
      return destroyFunc;
    };
    BeanStub2.prototype.addManagedPropertyListener = function(event, listener) {
      var _this = this;
      if (this.destroyed) {
        return;
      }
      this.gridOptionsService.addEventListener(event, listener);
      var destroyFunc = function() {
        _this.gridOptionsService.removeEventListener(event, listener);
        _this.destroyFunctions = _this.destroyFunctions.filter(function(fn) {
          return fn !== destroyFunc;
        });
        return null;
      };
      this.destroyFunctions.push(destroyFunc);
      return destroyFunc;
    };
    BeanStub2.prototype.addDestroyFunc = function(func) {
      if (this.isAlive()) {
        this.destroyFunctions.push(func);
      } else {
        func();
      }
    };
    BeanStub2.prototype.createManagedBean = function(bean, context) {
      var res = this.createBean(bean, context);
      this.addDestroyFunc(this.destroyBean.bind(this, bean, context));
      return res;
    };
    BeanStub2.prototype.createBean = function(bean, context, afterPreCreateCallback) {
      return (context || this.getContext()).createBean(bean, afterPreCreateCallback);
    };
    BeanStub2.prototype.destroyBean = function(bean, context) {
      return (context || this.getContext()).destroyBean(bean);
    };
    BeanStub2.prototype.destroyBeans = function(beans, context) {
      var _this = this;
      if (beans) {
        beans.forEach(function(bean) {
          return _this.destroyBean(bean, context);
        });
      }
      return [];
    };
    BeanStub2.EVENT_DESTROYED = "destroyed";
    __decorate$2B([
      Autowired("frameworkOverrides")
    ], BeanStub2.prototype, "frameworkOverrides", void 0);
    __decorate$2B([
      Autowired("context")
    ], BeanStub2.prototype, "context", void 0);
    __decorate$2B([
      Autowired("eventService")
    ], BeanStub2.prototype, "eventService", void 0);
    __decorate$2B([
      Autowired("gridOptionsService")
    ], BeanStub2.prototype, "gridOptionsService", void 0);
    __decorate$2B([
      Autowired("localeService")
    ], BeanStub2.prototype, "localeService", void 0);
    __decorate$2B([
      Autowired("environment")
    ], BeanStub2.prototype, "environment", void 0);
    __decorate$2B([
      PreDestroy
    ], BeanStub2.prototype, "destroy", null);
    return BeanStub2;
  }()
);
var __extends$2$ = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2A = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$9 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var ColumnFactory = (
  /** @class */
  function(_super) {
    __extends$2$(ColumnFactory2, _super);
    function ColumnFactory2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ColumnFactory2.prototype.setBeans = function(loggerFactory) {
      this.logger = loggerFactory.create("ColumnFactory");
    };
    ColumnFactory2.prototype.createColumnTree = function(defs, primaryColumns, existingTree) {
      var columnKeyCreator = new ColumnKeyCreator();
      var _a2 = this.extractExistingTreeData(existingTree), existingCols = _a2.existingCols, existingGroups = _a2.existingGroups, existingColKeys = _a2.existingColKeys;
      columnKeyCreator.addExistingKeys(existingColKeys);
      var unbalancedTree = this.recursivelyCreateColumns(defs, 0, primaryColumns, existingCols, columnKeyCreator, existingGroups);
      var treeDept = this.findMaxDept(unbalancedTree, 0);
      this.logger.log("Number of levels for grouped columns is " + treeDept);
      var columnTree = this.balanceColumnTree(unbalancedTree, 0, treeDept, columnKeyCreator);
      var deptFirstCallback = function(child, parent) {
        if (child instanceof ProvidedColumnGroup) {
          child.setupExpandable();
        }
        child.setOriginalParent(parent);
      };
      this.columnUtils.depthFirstOriginalTreeSearch(null, columnTree, deptFirstCallback);
      return {
        columnTree,
        treeDept
      };
    };
    ColumnFactory2.prototype.extractExistingTreeData = function(existingTree) {
      var existingCols = [];
      var existingGroups = [];
      var existingColKeys = [];
      if (existingTree) {
        this.columnUtils.depthFirstOriginalTreeSearch(null, existingTree, function(item) {
          if (item instanceof ProvidedColumnGroup) {
            var group = item;
            existingGroups.push(group);
          } else {
            var col = item;
            existingColKeys.push(col.getId());
            existingCols.push(col);
          }
        });
      }
      return { existingCols, existingGroups, existingColKeys };
    };
    ColumnFactory2.prototype.createForAutoGroups = function(autoGroupCols, gridBalancedTree) {
      var _this = this;
      return autoGroupCols.map(function(col) {
        return _this.createAutoGroupTreeItem(gridBalancedTree, col);
      });
    };
    ColumnFactory2.prototype.createAutoGroupTreeItem = function(balancedColumnTree, column) {
      var dept = this.findDepth(balancedColumnTree);
      var nextChild = column;
      for (var i = dept - 1; i >= 0; i--) {
        var autoGroup = new ProvidedColumnGroup(null, "FAKE_PATH_" + column.getId() + "}_" + i, true, i);
        this.createBean(autoGroup);
        autoGroup.setChildren([nextChild]);
        nextChild.setOriginalParent(autoGroup);
        nextChild = autoGroup;
      }
      return nextChild;
    };
    ColumnFactory2.prototype.findDepth = function(balancedColumnTree) {
      var dept = 0;
      var pointer = balancedColumnTree;
      while (pointer && pointer[0] && pointer[0] instanceof ProvidedColumnGroup) {
        dept++;
        pointer = pointer[0].getChildren();
      }
      return dept;
    };
    ColumnFactory2.prototype.balanceColumnTree = function(unbalancedTree, currentDept, columnDept, columnKeyCreator) {
      var result = [];
      for (var i = 0; i < unbalancedTree.length; i++) {
        var child = unbalancedTree[i];
        if (child instanceof ProvidedColumnGroup) {
          var originalGroup = child;
          var newChildren = this.balanceColumnTree(originalGroup.getChildren(), currentDept + 1, columnDept, columnKeyCreator);
          originalGroup.setChildren(newChildren);
          result.push(originalGroup);
        } else {
          var firstPaddedGroup = void 0;
          var currentPaddedGroup = void 0;
          for (var j = columnDept - 1; j >= currentDept; j--) {
            var newColId = columnKeyCreator.getUniqueKey(null, null);
            var colGroupDefMerged = this.createMergedColGroupDef(null);
            var paddedGroup = new ProvidedColumnGroup(colGroupDefMerged, newColId, true, currentDept);
            this.createBean(paddedGroup);
            if (currentPaddedGroup) {
              currentPaddedGroup.setChildren([paddedGroup]);
            }
            currentPaddedGroup = paddedGroup;
            if (!firstPaddedGroup) {
              firstPaddedGroup = currentPaddedGroup;
            }
          }
          if (firstPaddedGroup && currentPaddedGroup) {
            result.push(firstPaddedGroup);
            var hasGroups = unbalancedTree.some(function(leaf) {
              return leaf instanceof ProvidedColumnGroup;
            });
            if (hasGroups) {
              currentPaddedGroup.setChildren([child]);
              continue;
            } else {
              currentPaddedGroup.setChildren(unbalancedTree);
              break;
            }
          }
          result.push(child);
        }
      }
      return result;
    };
    ColumnFactory2.prototype.findMaxDept = function(treeChildren, dept) {
      var maxDeptThisLevel = dept;
      for (var i = 0; i < treeChildren.length; i++) {
        var abstractColumn = treeChildren[i];
        if (abstractColumn instanceof ProvidedColumnGroup) {
          var originalGroup = abstractColumn;
          var newDept = this.findMaxDept(originalGroup.getChildren(), dept + 1);
          if (maxDeptThisLevel < newDept) {
            maxDeptThisLevel = newDept;
          }
        }
      }
      return maxDeptThisLevel;
    };
    ColumnFactory2.prototype.recursivelyCreateColumns = function(defs, level, primaryColumns, existingColsCopy, columnKeyCreator, existingGroups) {
      var _this = this;
      return (defs || []).map(function(def) {
        if (_this.isColumnGroup(def)) {
          return _this.createColumnGroup(primaryColumns, def, level, existingColsCopy, columnKeyCreator, existingGroups);
        } else {
          return _this.createColumn(primaryColumns, def, existingColsCopy, columnKeyCreator);
        }
      });
    };
    ColumnFactory2.prototype.createColumnGroup = function(primaryColumns, colGroupDef, level, existingColumns, columnKeyCreator, existingGroups) {
      var colGroupDefMerged = this.createMergedColGroupDef(colGroupDef);
      var groupId = columnKeyCreator.getUniqueKey(colGroupDefMerged.groupId || null, null);
      var providedGroup = new ProvidedColumnGroup(colGroupDefMerged, groupId, false, level);
      this.createBean(providedGroup);
      var existingGroup = this.findExistingGroup(colGroupDef, existingGroups);
      if (existingGroup) {
        removeFromArray(existingGroups, existingGroup);
      }
      if (existingGroup && existingGroup.isExpanded()) {
        providedGroup.setExpanded(true);
      }
      var children = this.recursivelyCreateColumns(colGroupDefMerged.children, level + 1, primaryColumns, existingColumns, columnKeyCreator, existingGroups);
      providedGroup.setChildren(children);
      return providedGroup;
    };
    ColumnFactory2.prototype.createMergedColGroupDef = function(colGroupDef) {
      var colGroupDefMerged = {};
      Object.assign(colGroupDefMerged, this.gridOptionsService.get("defaultColGroupDef"));
      Object.assign(colGroupDefMerged, colGroupDef);
      return colGroupDefMerged;
    };
    ColumnFactory2.prototype.createColumn = function(primaryColumns, colDef, existingColsCopy, columnKeyCreator) {
      var column = this.findExistingColumn(colDef, existingColsCopy);
      if (existingColsCopy && column) {
        removeFromArray(existingColsCopy, column);
      }
      if (!column) {
        var colId = columnKeyCreator.getUniqueKey(colDef.colId, colDef.field);
        var colDefMerged = this.mergeColDefs(colDef, colId);
        column = new Column(colDefMerged, colDef, colId, primaryColumns);
        this.context.createBean(column);
      } else {
        var colDefMerged = this.mergeColDefs(colDef, column.getColId());
        column.setColDef(colDefMerged, colDef);
        this.applyColumnState(column, colDefMerged);
      }
      this.dataTypeService.addColumnListeners(column);
      return column;
    };
    ColumnFactory2.prototype.applyColumnState = function(column, colDef) {
      var flex = attrToNumber(colDef.flex);
      if (flex !== void 0) {
        column.setFlex(flex);
      }
      var noFlexThisCol = column.getFlex() <= 0;
      if (noFlexThisCol) {
        var width = attrToNumber(colDef.width);
        if (width != null) {
          column.setActualWidth(width);
        } else {
          var widthBeforeUpdate = column.getActualWidth();
          column.setActualWidth(widthBeforeUpdate);
        }
      }
      if (colDef.sort !== void 0) {
        if (colDef.sort == "asc" || colDef.sort == "desc") {
          column.setSort(colDef.sort);
        } else {
          column.setSort(void 0);
        }
      }
      var sortIndex = attrToNumber(colDef.sortIndex);
      if (sortIndex !== void 0) {
        column.setSortIndex(sortIndex);
      }
      var hide = attrToBoolean(colDef.hide);
      if (hide !== void 0) {
        column.setVisible(!hide);
      }
      if (colDef.pinned !== void 0) {
        column.setPinned(colDef.pinned);
      }
    };
    ColumnFactory2.prototype.findExistingColumn = function(newColDef, existingColsCopy) {
      return (existingColsCopy || []).find(function(existingCol) {
        var existingColDef = existingCol.getUserProvidedColDef();
        if (!existingColDef) {
          return false;
        }
        var newHasId = newColDef.colId != null;
        var newHasField = newColDef.field != null;
        if (newHasId) {
          return existingCol.getId() === newColDef.colId;
        }
        if (newHasField) {
          return existingColDef.field === newColDef.field;
        }
        if (existingColDef === newColDef) {
          return true;
        }
        return false;
      });
    };
    ColumnFactory2.prototype.findExistingGroup = function(newGroupDef, existingGroups) {
      return existingGroups.find(function(existingGroup) {
        var existingDef = existingGroup.getColGroupDef();
        if (!existingDef) {
          return false;
        }
        var newHasId = newGroupDef.groupId != null;
        if (newHasId) {
          return existingGroup.getId() === newGroupDef.groupId;
        }
        return false;
      });
    };
    ColumnFactory2.prototype.mergeColDefs = function(colDef, colId) {
      var colDefMerged = {};
      var defaultColDef = this.gridOptionsService.get("defaultColDef");
      mergeDeep(colDefMerged, defaultColDef, false, true);
      var columnType = this.dataTypeService.updateColDefAndGetColumnType(colDefMerged, colDef, colId);
      if (columnType) {
        this.assignColumnTypes(columnType, colDefMerged);
      }
      mergeDeep(colDefMerged, colDef, false, true);
      var autoGroupColDef = this.gridOptionsService.get("autoGroupColumnDef");
      var isSortingCoupled = this.gridOptionsService.isColumnsSortingCoupledToGroup();
      if (colDef.rowGroup && autoGroupColDef && isSortingCoupled) {
        mergeDeep(colDefMerged, { sort: autoGroupColDef.sort, initialSort: autoGroupColDef.initialSort }, false, true);
      }
      this.dataTypeService.validateColDef(colDefMerged);
      return colDefMerged;
    };
    ColumnFactory2.prototype.assignColumnTypes = function(typeKeys, colDefMerged) {
      if (!typeKeys.length) {
        return;
      }
      var allColumnTypes = Object.assign({}, DefaultColumnTypes);
      var userTypes = this.gridOptionsService.get("columnTypes") || {};
      iterateObject(userTypes, function(key, value) {
        if (key in allColumnTypes) {
          console.warn("AG Grid: the column type '" + key + "' is a default column type and cannot be overridden.");
        } else {
          allColumnTypes[key] = value;
        }
      });
      typeKeys.forEach(function(t2) {
        var typeColDef = allColumnTypes[t2.trim()];
        if (typeColDef) {
          mergeDeep(colDefMerged, typeColDef, false, true);
        } else {
          console.warn("AG Grid: colDef.type '" + t2 + "' does not correspond to defined gridOptions.columnTypes");
        }
      });
    };
    ColumnFactory2.prototype.isColumnGroup = function(abstractColDef) {
      return abstractColDef.children !== void 0;
    };
    __decorate$2A([
      Autowired("columnUtils")
    ], ColumnFactory2.prototype, "columnUtils", void 0);
    __decorate$2A([
      Autowired("dataTypeService")
    ], ColumnFactory2.prototype, "dataTypeService", void 0);
    __decorate$2A([
      __param$9(0, Qualifier("loggerFactory"))
    ], ColumnFactory2.prototype, "setBeans", null);
    ColumnFactory2 = __decorate$2A([
      Bean("columnFactory")
    ], ColumnFactory2);
    return ColumnFactory2;
  }(BeanStub)
);
var __decorate$2z = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ColumnGroup = (
  /** @class */
  function() {
    function ColumnGroup2(providedColumnGroup, groupId, partId, pinned) {
      this.displayedChildren = [];
      this.localEventService = new EventService();
      this.groupId = groupId;
      this.partId = partId;
      this.providedColumnGroup = providedColumnGroup;
      this.pinned = pinned;
    }
    ColumnGroup2.createUniqueId = function(groupId, instanceId) {
      return groupId + "_" + instanceId;
    };
    ColumnGroup2.prototype.reset = function() {
      this.parent = null;
      this.children = null;
      this.displayedChildren = null;
    };
    ColumnGroup2.prototype.getParent = function() {
      return this.parent;
    };
    ColumnGroup2.prototype.setParent = function(parent) {
      this.parent = parent;
    };
    ColumnGroup2.prototype.getUniqueId = function() {
      return ColumnGroup2.createUniqueId(this.groupId, this.partId);
    };
    ColumnGroup2.prototype.isEmptyGroup = function() {
      return this.displayedChildren.length === 0;
    };
    ColumnGroup2.prototype.isMoving = function() {
      var allLeafColumns = this.getProvidedColumnGroup().getLeafColumns();
      if (!allLeafColumns || allLeafColumns.length === 0) {
        return false;
      }
      return allLeafColumns.every(function(col) {
        return col.isMoving();
      });
    };
    ColumnGroup2.prototype.checkLeft = function() {
      this.displayedChildren.forEach(function(child) {
        if (child instanceof ColumnGroup2) {
          child.checkLeft();
        }
      });
      if (this.displayedChildren.length > 0) {
        if (this.gridOptionsService.is("enableRtl")) {
          var lastChild = last(this.displayedChildren);
          var lastChildLeft = lastChild.getLeft();
          this.setLeft(lastChildLeft);
        } else {
          var firstChildLeft = this.displayedChildren[0].getLeft();
          this.setLeft(firstChildLeft);
        }
      } else {
        this.setLeft(null);
      }
    };
    ColumnGroup2.prototype.getLeft = function() {
      return this.left;
    };
    ColumnGroup2.prototype.getOldLeft = function() {
      return this.oldLeft;
    };
    ColumnGroup2.prototype.setLeft = function(left) {
      this.oldLeft = left;
      if (this.left !== left) {
        this.left = left;
        this.localEventService.dispatchEvent(this.createAgEvent(ColumnGroup2.EVENT_LEFT_CHANGED));
      }
    };
    ColumnGroup2.prototype.getPinned = function() {
      return this.pinned;
    };
    ColumnGroup2.prototype.createAgEvent = function(type) {
      return { type };
    };
    ColumnGroup2.prototype.addEventListener = function(eventType, listener) {
      this.localEventService.addEventListener(eventType, listener);
    };
    ColumnGroup2.prototype.removeEventListener = function(eventType, listener) {
      this.localEventService.removeEventListener(eventType, listener);
    };
    ColumnGroup2.prototype.getGroupId = function() {
      return this.groupId;
    };
    ColumnGroup2.prototype.getPartId = function() {
      return this.partId;
    };
    ColumnGroup2.prototype.isChildInThisGroupDeepSearch = function(wantedChild) {
      var result = false;
      this.children.forEach(function(foundChild) {
        if (wantedChild === foundChild) {
          result = true;
        }
        if (foundChild instanceof ColumnGroup2) {
          if (foundChild.isChildInThisGroupDeepSearch(wantedChild)) {
            result = true;
          }
        }
      });
      return result;
    };
    ColumnGroup2.prototype.getActualWidth = function() {
      var groupActualWidth = 0;
      if (this.displayedChildren) {
        this.displayedChildren.forEach(function(child) {
          groupActualWidth += child.getActualWidth();
        });
      }
      return groupActualWidth;
    };
    ColumnGroup2.prototype.isResizable = function() {
      if (!this.displayedChildren) {
        return false;
      }
      var result = false;
      this.displayedChildren.forEach(function(child) {
        if (child.isResizable()) {
          result = true;
        }
      });
      return result;
    };
    ColumnGroup2.prototype.getMinWidth = function() {
      var result = 0;
      this.displayedChildren.forEach(function(groupChild) {
        result += groupChild.getMinWidth() || 0;
      });
      return result;
    };
    ColumnGroup2.prototype.addChild = function(child) {
      if (!this.children) {
        this.children = [];
      }
      this.children.push(child);
    };
    ColumnGroup2.prototype.getDisplayedChildren = function() {
      return this.displayedChildren;
    };
    ColumnGroup2.prototype.getLeafColumns = function() {
      var result = [];
      this.addLeafColumns(result);
      return result;
    };
    ColumnGroup2.prototype.getDisplayedLeafColumns = function() {
      var result = [];
      this.addDisplayedLeafColumns(result);
      return result;
    };
    ColumnGroup2.prototype.getDefinition = function() {
      return this.providedColumnGroup.getColGroupDef();
    };
    ColumnGroup2.prototype.getColGroupDef = function() {
      return this.providedColumnGroup.getColGroupDef();
    };
    ColumnGroup2.prototype.isPadding = function() {
      return this.providedColumnGroup.isPadding();
    };
    ColumnGroup2.prototype.isExpandable = function() {
      return this.providedColumnGroup.isExpandable();
    };
    ColumnGroup2.prototype.isExpanded = function() {
      return this.providedColumnGroup.isExpanded();
    };
    ColumnGroup2.prototype.setExpanded = function(expanded) {
      this.providedColumnGroup.setExpanded(expanded);
    };
    ColumnGroup2.prototype.addDisplayedLeafColumns = function(leafColumns) {
      this.displayedChildren.forEach(function(child) {
        if (child instanceof Column) {
          leafColumns.push(child);
        } else if (child instanceof ColumnGroup2) {
          child.addDisplayedLeafColumns(leafColumns);
        }
      });
    };
    ColumnGroup2.prototype.addLeafColumns = function(leafColumns) {
      this.children.forEach(function(child) {
        if (child instanceof Column) {
          leafColumns.push(child);
        } else if (child instanceof ColumnGroup2) {
          child.addLeafColumns(leafColumns);
        }
      });
    };
    ColumnGroup2.prototype.getChildren = function() {
      return this.children;
    };
    ColumnGroup2.prototype.getColumnGroupShow = function() {
      return this.providedColumnGroup.getColumnGroupShow();
    };
    ColumnGroup2.prototype.getProvidedColumnGroup = function() {
      return this.providedColumnGroup;
    };
    ColumnGroup2.prototype.getPaddingLevel = function() {
      var parent = this.getParent();
      if (!this.isPadding() || !parent || !parent.isPadding()) {
        return 0;
      }
      return 1 + parent.getPaddingLevel();
    };
    ColumnGroup2.prototype.calculateDisplayedColumns = function() {
      var _this = this;
      this.displayedChildren = [];
      var parentWithExpansion = this;
      while (parentWithExpansion != null && parentWithExpansion.isPadding()) {
        parentWithExpansion = parentWithExpansion.getParent();
      }
      var isExpandable = parentWithExpansion ? parentWithExpansion.providedColumnGroup.isExpandable() : false;
      if (!isExpandable) {
        this.displayedChildren = this.children;
        this.localEventService.dispatchEvent(this.createAgEvent(ColumnGroup2.EVENT_DISPLAYED_CHILDREN_CHANGED));
        return;
      }
      this.children.forEach(function(child) {
        var emptyGroup = child instanceof ColumnGroup2 && (!child.displayedChildren || !child.displayedChildren.length);
        if (emptyGroup) {
          return;
        }
        var headerGroupShow = child.getColumnGroupShow();
        switch (headerGroupShow) {
          case "open":
            if (parentWithExpansion.providedColumnGroup.isExpanded()) {
              _this.displayedChildren.push(child);
            }
            break;
          case "closed":
            if (!parentWithExpansion.providedColumnGroup.isExpanded()) {
              _this.displayedChildren.push(child);
            }
            break;
          default:
            _this.displayedChildren.push(child);
            break;
        }
      });
      this.localEventService.dispatchEvent(this.createAgEvent(ColumnGroup2.EVENT_DISPLAYED_CHILDREN_CHANGED));
    };
    ColumnGroup2.EVENT_LEFT_CHANGED = "leftChanged";
    ColumnGroup2.EVENT_DISPLAYED_CHILDREN_CHANGED = "displayedChildrenChanged";
    __decorate$2z([
      Autowired("gridOptionsService")
    ], ColumnGroup2.prototype, "gridOptionsService", void 0);
    return ColumnGroup2;
  }()
);
var Events = (
  /** @class */
  function() {
    function Events2() {
    }
    Events2.EVENT_COLUMN_EVERYTHING_CHANGED = "columnEverythingChanged";
    Events2.EVENT_NEW_COLUMNS_LOADED = "newColumnsLoaded";
    Events2.EVENT_COLUMN_PIVOT_MODE_CHANGED = "columnPivotModeChanged";
    Events2.EVENT_COLUMN_ROW_GROUP_CHANGED = "columnRowGroupChanged";
    Events2.EVENT_EXPAND_COLLAPSE_ALL = "expandOrCollapseAll";
    Events2.EVENT_COLUMN_PIVOT_CHANGED = "columnPivotChanged";
    Events2.EVENT_GRID_COLUMNS_CHANGED = "gridColumnsChanged";
    Events2.EVENT_COLUMN_VALUE_CHANGED = "columnValueChanged";
    Events2.EVENT_COLUMN_MOVED = "columnMoved";
    Events2.EVENT_COLUMN_VISIBLE = "columnVisible";
    Events2.EVENT_COLUMN_PINNED = "columnPinned";
    Events2.EVENT_COLUMN_GROUP_OPENED = "columnGroupOpened";
    Events2.EVENT_COLUMN_RESIZED = "columnResized";
    Events2.EVENT_DISPLAYED_COLUMNS_CHANGED = "displayedColumnsChanged";
    Events2.EVENT_VIRTUAL_COLUMNS_CHANGED = "virtualColumnsChanged";
    Events2.EVENT_ASYNC_TRANSACTIONS_FLUSHED = "asyncTransactionsFlushed";
    Events2.EVENT_ROW_GROUP_OPENED = "rowGroupOpened";
    Events2.EVENT_ROW_DATA_CHANGED = "rowDataChanged";
    Events2.EVENT_ROW_DATA_UPDATED = "rowDataUpdated";
    Events2.EVENT_PINNED_ROW_DATA_CHANGED = "pinnedRowDataChanged";
    Events2.EVENT_RANGE_SELECTION_CHANGED = "rangeSelectionChanged";
    Events2.EVENT_CHART_CREATED = "chartCreated";
    Events2.EVENT_CHART_RANGE_SELECTION_CHANGED = "chartRangeSelectionChanged";
    Events2.EVENT_CHART_OPTIONS_CHANGED = "chartOptionsChanged";
    Events2.EVENT_CHART_DESTROYED = "chartDestroyed";
    Events2.EVENT_TOOL_PANEL_VISIBLE_CHANGED = "toolPanelVisibleChanged";
    Events2.EVENT_TOOL_PANEL_SIZE_CHANGED = "toolPanelSizeChanged";
    Events2.EVENT_COLUMN_PANEL_ITEM_DRAG_START = "columnPanelItemDragStart";
    Events2.EVENT_COLUMN_PANEL_ITEM_DRAG_END = "columnPanelItemDragEnd";
    Events2.EVENT_MODEL_UPDATED = "modelUpdated";
    Events2.EVENT_CUT_START = "cutStart";
    Events2.EVENT_CUT_END = "cutEnd";
    Events2.EVENT_PASTE_START = "pasteStart";
    Events2.EVENT_PASTE_END = "pasteEnd";
    Events2.EVENT_FILL_START = "fillStart";
    Events2.EVENT_FILL_END = "fillEnd";
    Events2.EVENT_RANGE_DELETE_START = "rangeDeleteStart";
    Events2.EVENT_RANGE_DELETE_END = "rangeDeleteEnd";
    Events2.EVENT_UNDO_STARTED = "undoStarted";
    Events2.EVENT_UNDO_ENDED = "undoEnded";
    Events2.EVENT_REDO_STARTED = "redoStarted";
    Events2.EVENT_REDO_ENDED = "redoEnded";
    Events2.EVENT_KEY_SHORTCUT_CHANGED_CELL_START = "keyShortcutChangedCellStart";
    Events2.EVENT_KEY_SHORTCUT_CHANGED_CELL_END = "keyShortcutChangedCellEnd";
    Events2.EVENT_CELL_CLICKED = "cellClicked";
    Events2.EVENT_CELL_DOUBLE_CLICKED = "cellDoubleClicked";
    Events2.EVENT_CELL_MOUSE_DOWN = "cellMouseDown";
    Events2.EVENT_CELL_CONTEXT_MENU = "cellContextMenu";
    Events2.EVENT_CELL_VALUE_CHANGED = "cellValueChanged";
    Events2.EVENT_CELL_EDIT_REQUEST = "cellEditRequest";
    Events2.EVENT_ROW_VALUE_CHANGED = "rowValueChanged";
    Events2.EVENT_CELL_FOCUSED = "cellFocused";
    Events2.EVENT_CELL_FOCUS_CLEARED = "cellFocusCleared";
    Events2.EVENT_FULL_WIDTH_ROW_FOCUSED = "fullWidthRowFocused";
    Events2.EVENT_ROW_SELECTED = "rowSelected";
    Events2.EVENT_SELECTION_CHANGED = "selectionChanged";
    Events2.EVENT_CELL_KEY_DOWN = "cellKeyDown";
    Events2.EVENT_CELL_MOUSE_OVER = "cellMouseOver";
    Events2.EVENT_CELL_MOUSE_OUT = "cellMouseOut";
    Events2.EVENT_FILTER_CHANGED = "filterChanged";
    Events2.EVENT_FILTER_MODIFIED = "filterModified";
    Events2.EVENT_FILTER_OPENED = "filterOpened";
    Events2.EVENT_SORT_CHANGED = "sortChanged";
    Events2.EVENT_VIRTUAL_ROW_REMOVED = "virtualRowRemoved";
    Events2.EVENT_ROW_CLICKED = "rowClicked";
    Events2.EVENT_ROW_DOUBLE_CLICKED = "rowDoubleClicked";
    Events2.EVENT_GRID_READY = "gridReady";
    Events2.EVENT_GRID_SIZE_CHANGED = "gridSizeChanged";
    Events2.EVENT_VIEWPORT_CHANGED = "viewportChanged";
    Events2.EVENT_SCROLLBAR_WIDTH_CHANGED = "scrollbarWidthChanged";
    Events2.EVENT_FIRST_DATA_RENDERED = "firstDataRendered";
    Events2.EVENT_DRAG_STARTED = "dragStarted";
    Events2.EVENT_DRAG_STOPPED = "dragStopped";
    Events2.EVENT_CHECKBOX_CHANGED = "checkboxChanged";
    Events2.EVENT_ROW_EDITING_STARTED = "rowEditingStarted";
    Events2.EVENT_ROW_EDITING_STOPPED = "rowEditingStopped";
    Events2.EVENT_CELL_EDITING_STARTED = "cellEditingStarted";
    Events2.EVENT_CELL_EDITING_STOPPED = "cellEditingStopped";
    Events2.EVENT_BODY_SCROLL = "bodyScroll";
    Events2.EVENT_BODY_SCROLL_END = "bodyScrollEnd";
    Events2.EVENT_HEIGHT_SCALE_CHANGED = "heightScaleChanged";
    Events2.EVENT_PAGINATION_CHANGED = "paginationChanged";
    Events2.EVENT_COMPONENT_STATE_CHANGED = "componentStateChanged";
    Events2.EVENT_STORE_REFRESHED = "storeRefreshed";
    Events2.EVENT_BODY_HEIGHT_CHANGED = "bodyHeightChanged";
    Events2.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED = "displayedColumnsWidthChanged";
    Events2.EVENT_SCROLL_VISIBILITY_CHANGED = "scrollVisibilityChanged";
    Events2.EVENT_COLUMN_HOVER_CHANGED = "columnHoverChanged";
    Events2.EVENT_FLASH_CELLS = "flashCells";
    Events2.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED = "paginationPixelOffsetChanged";
    Events2.EVENT_DISPLAYED_ROWS_CHANGED = "displayedRowsChanged";
    Events2.EVENT_LEFT_PINNED_WIDTH_CHANGED = "leftPinnedWidthChanged";
    Events2.EVENT_RIGHT_PINNED_WIDTH_CHANGED = "rightPinnedWidthChanged";
    Events2.EVENT_ROW_CONTAINER_HEIGHT_CHANGED = "rowContainerHeightChanged";
    Events2.EVENT_HEADER_HEIGHT_CHANGED = "headerHeightChanged";
    Events2.EVENT_COLUMN_HEADER_HEIGHT_CHANGED = "columnHeaderHeightChanged";
    Events2.EVENT_ROW_DRAG_ENTER = "rowDragEnter";
    Events2.EVENT_ROW_DRAG_MOVE = "rowDragMove";
    Events2.EVENT_ROW_DRAG_LEAVE = "rowDragLeave";
    Events2.EVENT_ROW_DRAG_END = "rowDragEnd";
    Events2.EVENT_GRID_STYLES_CHANGED = "gridStylesChanged";
    Events2.EVENT_POPUP_TO_FRONT = "popupToFront";
    Events2.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST = "columnRowGroupChangeRequest";
    Events2.EVENT_COLUMN_PIVOT_CHANGE_REQUEST = "columnPivotChangeRequest";
    Events2.EVENT_COLUMN_VALUE_CHANGE_REQUEST = "columnValueChangeRequest";
    Events2.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST = "columnAggFuncChangeRequest";
    Events2.EVENT_KEYBOARD_FOCUS = "keyboardFocus";
    Events2.EVENT_MOUSE_FOCUS = "mouseFocus";
    Events2.EVENT_STORE_UPDATED = "storeUpdated";
    Events2.EVENT_FILTER_DESTROYED = "filterDestroyed";
    Events2.EVENT_ROW_DATA_UPDATE_STARTED = "rowDataUpdateStarted";
    return Events2;
  }()
);
var GroupInstanceIdCreator = (
  /** @class */
  function() {
    function GroupInstanceIdCreator2() {
      this.existingIds = {};
    }
    GroupInstanceIdCreator2.prototype.getInstanceIdForKey = function(key) {
      var lastResult = this.existingIds[key];
      var result;
      if (typeof lastResult !== "number") {
        result = 0;
      } else {
        result = lastResult + 1;
      }
      this.existingIds[key] = result;
      return result;
    };
    return GroupInstanceIdCreator2;
  }()
);
var __extends$2_ = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2y = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GROUP_AUTO_COLUMN_ID = "ag-Grid-AutoColumn";
var AutoGroupColService = (
  /** @class */
  function(_super) {
    __extends$2_(AutoGroupColService2, _super);
    function AutoGroupColService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    AutoGroupColService2.prototype.createAutoGroupColumns = function(existingCols, rowGroupColumns) {
      var _this = this;
      var groupAutoColumns = [];
      var doingTreeData = this.gridOptionsService.isTreeData();
      var doingMultiAutoColumn = this.gridOptionsService.isGroupMultiAutoColumn();
      if (doingTreeData && doingMultiAutoColumn) {
        console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data');
        doingMultiAutoColumn = false;
      }
      if (doingMultiAutoColumn) {
        rowGroupColumns.forEach(function(rowGroupCol, index2) {
          groupAutoColumns.push(_this.createOneAutoGroupColumn(existingCols, rowGroupCol, index2));
        });
      } else {
        groupAutoColumns.push(this.createOneAutoGroupColumn(existingCols));
      }
      return groupAutoColumns;
    };
    AutoGroupColService2.prototype.createOneAutoGroupColumn = function(existingCols, rowGroupCol, index2) {
      var defaultAutoColDef = this.generateDefaultColDef(rowGroupCol);
      var colId;
      if (rowGroupCol) {
        colId = GROUP_AUTO_COLUMN_ID + "-" + rowGroupCol.getId();
      } else {
        colId = GROUP_AUTO_COLUMN_ID;
      }
      var userAutoColDef = this.gridOptionsService.get("autoGroupColumnDef");
      mergeDeep(defaultAutoColDef, userAutoColDef);
      defaultAutoColDef = this.columnFactory.mergeColDefs(defaultAutoColDef, colId);
      defaultAutoColDef.colId = colId;
      if (!this.gridOptionsService.isTreeData()) {
        var noFieldOrValueGetter = missing(defaultAutoColDef.field) && missing(defaultAutoColDef.valueGetter) && missing(defaultAutoColDef.filterValueGetter) && defaultAutoColDef.filter !== "agGroupColumnFilter";
        if (noFieldOrValueGetter) {
          defaultAutoColDef.filter = false;
        }
      }
      if (index2 && index2 > 0) {
        defaultAutoColDef.headerCheckboxSelection = false;
      }
      var existingCol = existingCols.find(function(col) {
        return col.getId() == colId;
      });
      var isSortingCoupled = this.gridOptionsService.isColumnsSortingCoupledToGroup();
      if (existingCol) {
        if (isSortingCoupled) {
          defaultAutoColDef.sort = void 0;
          defaultAutoColDef.sortIndex = void 0;
        }
        existingCol.setColDef(defaultAutoColDef, null);
        this.columnFactory.applyColumnState(existingCol, defaultAutoColDef);
        return existingCol;
      }
      if (isSortingCoupled && (defaultAutoColDef.sort || defaultAutoColDef.initialSort || "sortIndex" in defaultAutoColDef) && !defaultAutoColDef.field) {
        defaultAutoColDef.sort = null;
        defaultAutoColDef.sortIndex = null;
        defaultAutoColDef.initialSort = null;
      }
      var newCol = new Column(defaultAutoColDef, null, colId, true);
      this.context.createBean(newCol);
      return newCol;
    };
    AutoGroupColService2.prototype.generateDefaultColDef = function(rowGroupCol) {
      var userDef = this.gridOptionsService.get("autoGroupColumnDef");
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      var res = {
        headerName: localeTextFunc("group", "Group")
      };
      var userHasProvidedGroupCellRenderer = userDef && (userDef.cellRenderer || userDef.cellRendererSelector);
      if (!userHasProvidedGroupCellRenderer) {
        res.cellRenderer = "agGroupCellRenderer";
      }
      if (rowGroupCol) {
        var colDef = rowGroupCol.getColDef();
        Object.assign(res, {
          // cellRendererParams.groupKey: colDefToCopy.field;
          headerName: this.columnModel.getDisplayNameForColumn(rowGroupCol, "header"),
          headerValueGetter: colDef.headerValueGetter
        });
        if (colDef.cellRenderer) {
          Object.assign(res, {
            cellRendererParams: {
              innerRenderer: colDef.cellRenderer,
              innerRendererParams: colDef.cellRendererParams
            }
          });
        }
        res.showRowGroup = rowGroupCol.getColId();
      } else {
        res.showRowGroup = true;
      }
      return res;
    };
    __decorate$2y([
      Autowired("columnModel")
    ], AutoGroupColService2.prototype, "columnModel", void 0);
    __decorate$2y([
      Autowired("columnFactory")
    ], AutoGroupColService2.prototype, "columnFactory", void 0);
    AutoGroupColService2 = __decorate$2y([
      Bean("autoGroupColService")
    ], AutoGroupColService2);
    return AutoGroupColService2;
  }(BeanStub)
);
var reUnescapedHtml = /[&<>"']/g;
var HTML_ESCAPES = {
  "&": "&amp;",
  "<": "&lt;",
  ">": "&gt;",
  '"': "&quot;",
  "'": "&#39;"
};
function utf8_encode(s2) {
  var stringFromCharCode = String.fromCharCode;
  function ucs2decode(string) {
    var output = [];
    if (!string) {
      return [];
    }
    var len = string.length;
    var counter2 = 0;
    var value;
    var extra;
    while (counter2 < len) {
      value = string.charCodeAt(counter2++);
      if (value >= 55296 && value <= 56319 && counter2 < len) {
        extra = string.charCodeAt(counter2++);
        if ((extra & 64512) == 56320) {
          output.push(((value & 1023) << 10) + (extra & 1023) + 65536);
        } else {
          output.push(value);
          counter2--;
        }
      } else {
        output.push(value);
      }
    }
    return output;
  }
  function checkScalarValue(point) {
    if (point >= 55296 && point <= 57343) {
      throw Error("Lone surrogate U+" + point.toString(16).toUpperCase() + " is not a scalar value");
    }
  }
  function createByte(point, shift) {
    return stringFromCharCode(point >> shift & 63 | 128);
  }
  function encodeCodePoint(point) {
    if (point >= 0 && point <= 31 && point !== 10) {
      var convertedCode = point.toString(16).toUpperCase();
      var paddedCode = convertedCode.padStart(4, "0");
      return "_x" + paddedCode + "_";
    }
    if ((point & 4294967168) == 0) {
      return stringFromCharCode(point);
    }
    var symbol = "";
    if ((point & 4294965248) == 0) {
      symbol = stringFromCharCode(point >> 6 & 31 | 192);
    } else if ((point & 4294901760) == 0) {
      checkScalarValue(point);
      symbol = stringFromCharCode(point >> 12 & 15 | 224);
      symbol += createByte(point, 6);
    } else if ((point & 4292870144) == 0) {
      symbol = stringFromCharCode(point >> 18 & 7 | 240);
      symbol += createByte(point, 12);
      symbol += createByte(point, 6);
    }
    symbol += stringFromCharCode(point & 63 | 128);
    return symbol;
  }
  var codePoints = ucs2decode(s2);
  var length = codePoints.length;
  var index2 = -1;
  var codePoint;
  var byteString = "";
  while (++index2 < length) {
    codePoint = codePoints[index2];
    byteString += encodeCodePoint(codePoint);
  }
  return byteString;
}
function capitalise(str) {
  return str[0].toUpperCase() + str.substr(1).toLowerCase();
}
function escapeString(toEscape, skipEscapingHtmlChars) {
  if (toEscape == null) {
    return null;
  }
  var stringResult = toEscape.toString().toString();
  if (skipEscapingHtmlChars) {
    return stringResult;
  }
  return stringResult.replace(reUnescapedHtml, function(chr) {
    return HTML_ESCAPES[chr];
  });
}
function camelCaseToHumanText(camelCase) {
  if (!camelCase || camelCase == null) {
    return null;
  }
  var rex = /([a-z])([A-Z])/g;
  var rexCaps = /([A-Z]+)([A-Z])([a-z])/g;
  var words = camelCase.replace(rex, "$1 $2").replace(rexCaps, "$1 $2$3").replace(/\./g, " ").split(" ");
  return words.map(function(word) {
    return word.substring(0, 1).toUpperCase() + (word.length > 1 ? word.substring(1, word.length) : "");
  }).join(" ");
}
function camelCaseToHyphenated(camelCase) {
  return camelCase.replace(/[A-Z]/g, function(s2) {
    return "-" + s2.toLocaleLowerCase();
  });
}
var StringUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  utf8_encode,
  capitalise,
  escapeString,
  camelCaseToHumanText,
  camelCaseToHyphenated
});
function convertToMap(arr) {
  var map2 = /* @__PURE__ */ new Map();
  arr.forEach(function(pair) {
    return map2.set(pair[0], pair[1]);
  });
  return map2;
}
function mapById(arr, callback2) {
  var map2 = /* @__PURE__ */ new Map();
  arr.forEach(function(item) {
    return map2.set(callback2(item), item);
  });
  return map2;
}
function keys$1(map2) {
  var arr = [];
  map2.forEach(function(_2, key) {
    return arr.push(key);
  });
  return arr;
}
var MapUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  convertToMap,
  mapById,
  keys: keys$1
});
var ColDefUtil = (
  /** @class */
  function() {
    function ColDefUtil2() {
    }
    ColDefUtil2.ColDefPropertyMap = {
      headerName: void 0,
      columnGroupShow: void 0,
      headerClass: void 0,
      toolPanelClass: void 0,
      headerValueGetter: void 0,
      pivotKeys: void 0,
      groupId: void 0,
      colId: void 0,
      sort: void 0,
      initialSort: void 0,
      field: void 0,
      type: void 0,
      cellDataType: void 0,
      tooltipComponent: void 0,
      tooltipField: void 0,
      headerTooltip: void 0,
      cellClass: void 0,
      showRowGroup: void 0,
      filter: void 0,
      initialAggFunc: void 0,
      defaultAggFunc: void 0,
      aggFunc: void 0,
      pinned: void 0,
      initialPinned: void 0,
      chartDataType: void 0,
      cellEditorPopupPosition: void 0,
      headerGroupComponent: void 0,
      headerGroupComponentParams: void 0,
      cellStyle: void 0,
      cellRenderer: void 0,
      cellRendererParams: void 0,
      cellEditor: void 0,
      cellEditorParams: void 0,
      filterParams: void 0,
      pivotValueColumn: void 0,
      headerComponent: void 0,
      headerComponentParams: void 0,
      floatingFilterComponent: void 0,
      floatingFilterComponentParams: void 0,
      tooltipComponentParams: void 0,
      refData: void 0,
      columnsMenuParams: void 0,
      children: void 0,
      sortingOrder: void 0,
      allowedAggFuncs: void 0,
      menuTabs: void 0,
      pivotTotalColumnIds: void 0,
      cellClassRules: void 0,
      icons: void 0,
      sortIndex: void 0,
      initialSortIndex: void 0,
      flex: void 0,
      initialFlex: void 0,
      width: void 0,
      initialWidth: void 0,
      minWidth: void 0,
      maxWidth: void 0,
      rowGroupIndex: void 0,
      initialRowGroupIndex: void 0,
      pivotIndex: void 0,
      initialPivotIndex: void 0,
      suppressCellFlash: void 0,
      suppressColumnsToolPanel: void 0,
      suppressFiltersToolPanel: void 0,
      openByDefault: void 0,
      marryChildren: void 0,
      suppressStickyLabel: void 0,
      hide: void 0,
      initialHide: void 0,
      rowGroup: void 0,
      initialRowGroup: void 0,
      pivot: void 0,
      initialPivot: void 0,
      checkboxSelection: void 0,
      showDisabledCheckboxes: void 0,
      headerCheckboxSelection: void 0,
      headerCheckboxSelectionFilteredOnly: void 0,
      headerCheckboxSelectionCurrentPageOnly: void 0,
      suppressMenu: void 0,
      suppressMovable: void 0,
      lockPosition: void 0,
      lockVisible: void 0,
      lockPinned: void 0,
      unSortIcon: void 0,
      suppressSizeToFit: void 0,
      suppressAutoSize: void 0,
      enableRowGroup: void 0,
      enablePivot: void 0,
      enableValue: void 0,
      editable: void 0,
      suppressPaste: void 0,
      suppressNavigable: void 0,
      enableCellChangeFlash: void 0,
      rowDrag: void 0,
      dndSource: void 0,
      autoHeight: void 0,
      wrapText: void 0,
      sortable: void 0,
      resizable: void 0,
      singleClickEdit: void 0,
      floatingFilter: void 0,
      cellEditorPopup: void 0,
      suppressFillHandle: void 0,
      wrapHeaderText: void 0,
      autoHeaderHeight: void 0,
      dndSourceOnRowDrag: void 0,
      valueGetter: void 0,
      valueSetter: void 0,
      filterValueGetter: void 0,
      keyCreator: void 0,
      valueFormatter: void 0,
      valueParser: void 0,
      comparator: void 0,
      equals: void 0,
      pivotComparator: void 0,
      suppressKeyboardEvent: void 0,
      suppressHeaderKeyboardEvent: void 0,
      colSpan: void 0,
      rowSpan: void 0,
      getQuickFilterText: void 0,
      onCellValueChanged: void 0,
      onCellClicked: void 0,
      onCellDoubleClicked: void 0,
      onCellContextMenu: void 0,
      rowDragText: void 0,
      tooltipValueGetter: void 0,
      cellRendererSelector: void 0,
      cellEditorSelector: void 0,
      suppressSpanHeaderHeight: void 0,
      useValueFormatterForExport: void 0,
      useValueParserForImport: void 0
    };
    ColDefUtil2.ALL_PROPERTIES = Object.keys(ColDefUtil2.ColDefPropertyMap);
    return ColDefUtil2;
  }()
);
var __read$u = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$o = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var PropertyKeys = (
  /** @class */
  function() {
    function PropertyKeys2() {
    }
    PropertyKeys2.STRING_PROPERTIES = [
      "rowSelection",
      "overlayLoadingTemplate",
      "overlayNoRowsTemplate",
      "gridId",
      "quickFilterText",
      "rowModelType",
      "editType",
      "domLayout",
      "clipboardDelimiter",
      "rowGroupPanelShow",
      "multiSortKey",
      "pivotColumnGroupTotals",
      "pivotRowTotals",
      "pivotPanelShow",
      "fillHandleDirection",
      "serverSideStoreType",
      "groupDisplayType",
      "treeDataDisplayType",
      "colResizeDefault"
    ];
    PropertyKeys2.OBJECT_PROPERTIES = [
      "components",
      "rowStyle",
      "context",
      "autoGroupColumnDef",
      "localeText",
      "icons",
      "datasource",
      "serverSideDatasource",
      "viewportDatasource",
      "groupRowRendererParams",
      "aggFuncs",
      "fullWidthCellRendererParams",
      "defaultColGroupDef",
      "defaultColDef",
      "defaultCsvExportParams",
      "defaultExcelExportParams",
      "columnTypes",
      "rowClassRules",
      "detailCellRendererParams",
      "loadingCellRendererParams",
      "loadingOverlayComponentParams",
      "noRowsOverlayComponentParams",
      "popupParent",
      "statusBar",
      "sideBar",
      "chartThemeOverrides",
      "customChartThemes",
      "chartToolPanelsDef",
      "dataTypeDefinitions"
    ];
    PropertyKeys2.ARRAY_PROPERTIES = [
      "sortingOrder",
      "alignedGrids",
      "rowData",
      "columnDefs",
      "excelStyles",
      "pinnedTopRowData",
      "pinnedBottomRowData",
      "chartThemes",
      "rowClass"
    ];
    PropertyKeys2.NUMBER_PROPERTIES = [
      "rowHeight",
      "detailRowHeight",
      "rowBuffer",
      "headerHeight",
      "groupHeaderHeight",
      "floatingFiltersHeight",
      "pivotHeaderHeight",
      "pivotGroupHeaderHeight",
      "groupDefaultExpanded",
      "viewportRowModelPageSize",
      "viewportRowModelBufferSize",
      "autoSizePadding",
      "maxBlocksInCache",
      "maxConcurrentDatasourceRequests",
      "tooltipShowDelay",
      "tooltipHideDelay",
      "cacheOverflowSize",
      "paginationPageSize",
      "cacheBlockSize",
      "infiniteInitialRowCount",
      "serverSideInitialRowCount",
      "scrollbarWidth",
      "asyncTransactionWaitMillis",
      "blockLoadDebounceMillis",
      "keepDetailRowsCount",
      "undoRedoCellEditingLimit",
      "cellFlashDelay",
      "cellFadeDelay",
      "tabIndex"
    ];
    PropertyKeys2.BOOLEAN_PROPERTIES = [
      "suppressMakeColumnVisibleAfterUnGroup",
      "suppressRowClickSelection",
      "suppressCellFocus",
      "suppressHorizontalScroll",
      "alwaysShowHorizontalScroll",
      "alwaysShowVerticalScroll",
      "debug",
      "enableBrowserTooltips",
      "enableCellExpressions",
      "groupSelectsChildren",
      "groupIncludeFooter",
      "groupIncludeTotalFooter",
      "groupSuppressBlankHeader",
      "suppressMenuHide",
      "suppressRowDeselection",
      "unSortIcon",
      "suppressMultiSort",
      "alwaysMultiSort",
      "singleClickEdit",
      "suppressLoadingOverlay",
      "suppressNoRowsOverlay",
      "suppressAutoSize",
      "skipHeaderOnAutoSize",
      "suppressParentsInRowNodes",
      "suppressColumnMoveAnimation",
      "suppressMovableColumns",
      "suppressFieldDotNotation",
      "enableRangeSelection",
      "enableRangeHandle",
      "enableFillHandle",
      "suppressClearOnFillReduction",
      "deltaSort",
      "suppressTouch",
      "suppressAsyncEvents",
      "allowContextMenuWithControlKey",
      "suppressContextMenu",
      "rememberGroupStateWhenNewData",
      "enableCellChangeFlash",
      "suppressDragLeaveHidesColumns",
      "suppressRowGroupHidesColumns",
      "suppressMiddleClickScrolls",
      "suppressPreventDefaultOnMouseWheel",
      "suppressCopyRowsToClipboard",
      "copyHeadersToClipboard",
      "copyGroupHeadersToClipboard",
      "pivotMode",
      "suppressAggFuncInHeader",
      "suppressColumnVirtualisation",
      "alwaysAggregateAtRootLevel",
      "suppressAggAtRootLevel",
      "suppressFocusAfterRefresh",
      "functionsPassive",
      "functionsReadOnly",
      "animateRows",
      "groupSelectsFiltered",
      "groupRemoveSingleChildren",
      "groupRemoveLowestSingleChildren",
      "enableRtl",
      "suppressClickEdit",
      "rowDragEntireRow",
      "rowDragManaged",
      "suppressRowDrag",
      "suppressMoveWhenRowDragging",
      "rowDragMultiRow",
      "enableGroupEdit",
      "embedFullWidthRows",
      "suppressPaginationPanel",
      "groupHideOpenParents",
      "groupAllowUnbalanced",
      "pagination",
      "paginationAutoPageSize",
      "suppressScrollOnNewData",
      "suppressScrollWhenPopupsAreOpen",
      "purgeClosedRowNodes",
      "cacheQuickFilter",
      "includeHiddenColumnsInQuickFilter",
      "excludeHiddenColumnsFromQuickFilter",
      "ensureDomOrder",
      "accentedSort",
      "suppressChangeDetection",
      "valueCache",
      "valueCacheNeverExpires",
      "aggregateOnlyChangedColumns",
      "suppressAnimationFrame",
      "suppressExcelExport",
      "suppressCsvExport",
      "treeData",
      "masterDetail",
      "suppressMultiRangeSelection",
      "enterMovesDown",
      "enterMovesDownAfterEdit",
      "enterNavigatesVerticallyAfterEdit",
      "enterNavigatesVertically",
      "suppressPropertyNamesCheck",
      "rowMultiSelectWithClick",
      "suppressRowHoverHighlight",
      "suppressRowTransform",
      "suppressClipboardPaste",
      "suppressLastEmptyLineOnPaste",
      "enableCharts",
      "enableChartToolPanelsButton",
      "suppressChartToolPanelsButton",
      "suppressMaintainUnsortedOrder",
      "enableCellTextSelection",
      "suppressBrowserResizeObserver",
      "suppressMaxRenderedRowRestriction",
      "excludeChildrenWhenTreeDataFiltering",
      "tooltipMouseTrack",
      "keepDetailRows",
      "paginateChildRows",
      "preventDefaultOnContextMenu",
      "undoRedoCellEditing",
      "allowDragFromColumnsToolPanel",
      "pivotSuppressAutoColumn",
      "suppressExpandablePivotGroups",
      "debounceVerticalScrollbar",
      "detailRowAutoHeight",
      "serverSideFilteringAlwaysResets",
      "serverSideFilterAllLevels",
      "serverSideSortingAlwaysResets",
      "serverSideSortAllLevels",
      "serverSideOnlyRefreshFilteredGroups",
      "serverSideSortOnServer",
      "serverSideFilterOnServer",
      "suppressAggFilteredOnly",
      "showOpenedGroup",
      "suppressClipboardApi",
      "suppressModelUpdateAfterUpdateTransaction",
      "stopEditingWhenCellsLoseFocus",
      "maintainColumnOrder",
      "groupMaintainOrder",
      "columnHoverHighlight",
      "suppressReactUi",
      "readOnlyEdit",
      "suppressRowVirtualisation",
      "enableCellEditingOnBackspace",
      "resetRowDataOnUpdate",
      "removePivotHeaderRowWhenSingleValueColumn",
      "suppressCopySingleCellRanges",
      "suppressGroupRowsSticky",
      "suppressServerSideInfiniteScroll",
      "rowGroupPanelSuppressSort",
      "allowShowChangeAfterFilter",
      "suppressCutToClipboard"
    ];
    PropertyKeys2.FUNCTIONAL_PROPERTIES = [
      "doesExternalFilterPass",
      "processSecondaryColDef",
      "processSecondaryColGroupDef",
      "processPivotResultColDef",
      "processPivotResultColGroupDef",
      "getBusinessKeyForNode",
      "isRowSelectable",
      "rowDragText",
      "groupRowRenderer",
      "fullWidthCellRenderer",
      "loadingCellRenderer",
      "loadingOverlayComponent",
      "noRowsOverlayComponent",
      "detailCellRenderer"
    ];
    PropertyKeys2.CALLBACK_PROPERTIES = [
      "getLocaleText",
      "isExternalFilterPresent",
      "getRowHeight",
      "getRowClass",
      "getRowStyle",
      "getContextMenuItems",
      "getMainMenuItems",
      "processRowPostCreate",
      "processCellForClipboard",
      "getGroupRowAgg",
      "isFullWidthRow",
      "sendToClipboard",
      "navigateToNextHeader",
      "tabToNextHeader",
      "navigateToNextCell",
      "tabToNextCell",
      "processCellFromClipboard",
      "getDocument",
      "postProcessPopup",
      "getChildCount",
      "getDataPath",
      "isRowMaster",
      "postSortRows",
      "processHeaderForClipboard",
      "processGroupHeaderForClipboard",
      "paginationNumberFormatter",
      "processDataFromClipboard",
      "getServerSideGroupKey",
      "isServerSideGroup",
      "createChartContainer",
      "getChartToolbarItems",
      "fillOperation",
      "isApplyServerSideTransaction",
      "getServerSideStoreParams",
      "getServerSideGroupLevelParams",
      "isServerSideGroupOpenByDefault",
      "isGroupOpenByDefault",
      "initialGroupOrderComparator",
      "loadingCellRendererSelector",
      "getRowId",
      "groupAggFiltering"
    ];
    PropertyKeys2.FUNCTION_PROPERTIES = __spreadArray$o(__spreadArray$o([], __read$u(PropertyKeys2.FUNCTIONAL_PROPERTIES)), __read$u(PropertyKeys2.CALLBACK_PROPERTIES));
    PropertyKeys2.ALL_PROPERTIES = __spreadArray$o(__spreadArray$o(__spreadArray$o(__spreadArray$o(__spreadArray$o(__spreadArray$o([], __read$u(PropertyKeys2.ARRAY_PROPERTIES)), __read$u(PropertyKeys2.OBJECT_PROPERTIES)), __read$u(PropertyKeys2.STRING_PROPERTIES)), __read$u(PropertyKeys2.NUMBER_PROPERTIES)), __read$u(PropertyKeys2.FUNCTION_PROPERTIES)), __read$u(PropertyKeys2.BOOLEAN_PROPERTIES));
    return PropertyKeys2;
  }()
);
var __assign$l = function() {
  __assign$l = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$l.apply(this, arguments);
};
var __read$t = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$n = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var ComponentUtil = (
  /** @class */
  function() {
    function ComponentUtil2() {
    }
    ComponentUtil2.getCallbackForEvent = function(eventName) {
      if (!eventName || eventName.length < 2) {
        return eventName;
      }
      return "on" + eventName[0].toUpperCase() + eventName.substr(1);
    };
    ComponentUtil2.getCoercionLookup = function() {
      var coercionLookup = {};
      __spreadArray$n(__spreadArray$n(__spreadArray$n(__spreadArray$n(__spreadArray$n([], __read$t(ComponentUtil2.ARRAY_PROPERTIES)), __read$t(ComponentUtil2.OBJECT_PROPERTIES)), __read$t(ComponentUtil2.STRING_PROPERTIES)), __read$t(ComponentUtil2.FUNCTION_PROPERTIES)), __read$t(ComponentUtil2.EVENT_CALLBACKS)).forEach(function(key) {
        return coercionLookup[key] = "none";
      });
      ComponentUtil2.BOOLEAN_PROPERTIES.forEach(function(key) {
        return coercionLookup[key] = "boolean";
      });
      ComponentUtil2.NUMBER_PROPERTIES.forEach(function(key) {
        return coercionLookup[key] = "number";
      });
      return coercionLookup;
    };
    ComponentUtil2.getValue = function(key, rawValue) {
      var coercionStep = ComponentUtil2.coercionLookup[key];
      if (coercionStep) {
        var newValue = rawValue;
        switch (coercionStep) {
          case "number": {
            newValue = ComponentUtil2.toNumber(rawValue);
            break;
          }
          case "boolean": {
            newValue = ComponentUtil2.toBoolean(rawValue);
            break;
          }
          case "none": {
            if (key === "groupAggFiltering" && typeof rawValue !== "function") {
              newValue = ComponentUtil2.toBoolean(rawValue);
            }
            break;
          }
        }
        return newValue;
      }
      return void 0;
    };
    ComponentUtil2.getGridOptionKeys = function(component, isVue) {
      return isVue ? Object.keys(ComponentUtil2.coercionLookup) : Object.keys(component);
    };
    ComponentUtil2.copyAttributesToGridOptions = function(gridOptions, component, isVue) {
      if (isVue === void 0) {
        isVue = false;
      }
      if (typeof gridOptions !== "object") {
        gridOptions = {};
      }
      var pGridOptions = gridOptions;
      var keys2 = ComponentUtil2.getGridOptionKeys(component, isVue);
      keys2.forEach(function(key) {
        var value = component[key];
        if (typeof value !== "undefined") {
          var coercedValue = ComponentUtil2.getValue(key, value);
          if (coercedValue !== void 0) {
            pGridOptions[key] = coercedValue;
          }
        }
      });
      return gridOptions;
    };
    ComponentUtil2.processOnChange = function(changes, api) {
      if (!changes || Object.keys(changes).length === 0) {
        return;
      }
      var changesToApply = __assign$l({}, changes);
      if (changesToApply.columnTypes) {
        api.setColumnTypes(changesToApply.columnTypes.currentValue, "gridOptionsChanged");
        delete changesToApply.columnTypes;
      }
      if (changesToApply.autoGroupColumnDef) {
        api.setAutoGroupColumnDef(changesToApply.autoGroupColumnDef.currentValue, "gridOptionsChanged");
        delete changesToApply.autoGroupColumnDef;
      }
      if (changesToApply.defaultColDef) {
        api.setDefaultColDef(changesToApply.defaultColDef.currentValue, "gridOptionsChanged");
        delete changesToApply.defaultColDef;
      }
      if (changesToApply.columnDefs) {
        api.setColumnDefs(changesToApply.columnDefs.currentValue, "gridOptionsChanged");
        delete changesToApply.columnDefs;
      }
      Object.keys(changesToApply).forEach(function(key) {
        var gridKey = key;
        var coercedValue = ComponentUtil2.getValue(gridKey, changesToApply[gridKey].currentValue);
        api.__setProperty(gridKey, coercedValue);
      });
      var event = {
        type: Events.EVENT_COMPONENT_STATE_CHANGED
      };
      iterateObject(changes, function(key, value) {
        event[key] = value;
      });
      api.dispatchEvent(event);
    };
    ComponentUtil2.toBoolean = function(value) {
      if (typeof value === "boolean") {
        return value;
      }
      if (typeof value === "string") {
        return value.toUpperCase() === "TRUE" || value == "";
      }
      return false;
    };
    ComponentUtil2.toNumber = function(value) {
      if (typeof value === "number") {
        return value;
      }
      if (typeof value === "string") {
        return Number(value);
      }
    };
    ComponentUtil2.EVENTS = values(Events);
    ComponentUtil2.EXCLUDED_INTERNAL_EVENTS = [
      Events.EVENT_SCROLLBAR_WIDTH_CHANGED,
      Events.EVENT_CHECKBOX_CHANGED,
      Events.EVENT_HEIGHT_SCALE_CHANGED,
      Events.EVENT_BODY_HEIGHT_CHANGED,
      Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,
      Events.EVENT_SCROLL_VISIBILITY_CHANGED,
      Events.EVENT_COLUMN_HOVER_CHANGED,
      Events.EVENT_FLASH_CELLS,
      Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,
      Events.EVENT_DISPLAYED_ROWS_CHANGED,
      Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,
      Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,
      Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,
      Events.EVENT_POPUP_TO_FRONT,
      Events.EVENT_KEYBOARD_FOCUS,
      Events.EVENT_MOUSE_FOCUS,
      Events.EVENT_STORE_UPDATED,
      Events.EVENT_COLUMN_PANEL_ITEM_DRAG_START,
      Events.EVENT_COLUMN_PANEL_ITEM_DRAG_END,
      Events.EVENT_FILL_START,
      Events.EVENT_FILL_END,
      Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,
      Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,
      Events.EVENT_FULL_WIDTH_ROW_FOCUSED,
      Events.EVENT_HEADER_HEIGHT_CHANGED,
      Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,
      Events.EVENT_CELL_FOCUS_CLEARED,
      Events.EVENT_GRID_STYLES_CHANGED,
      Events.EVENT_FILTER_DESTROYED,
      Events.EVENT_ROW_DATA_UPDATE_STARTED
    ];
    ComponentUtil2.PUBLIC_EVENTS = ComponentUtil2.EVENTS.filter(function(e) {
      return !includes(ComponentUtil2.EXCLUDED_INTERNAL_EVENTS, e);
    });
    ComponentUtil2.EVENT_CALLBACKS = ComponentUtil2.EVENTS.map(function(event) {
      return ComponentUtil2.getCallbackForEvent(event);
    });
    ComponentUtil2.STRING_PROPERTIES = PropertyKeys.STRING_PROPERTIES;
    ComponentUtil2.OBJECT_PROPERTIES = PropertyKeys.OBJECT_PROPERTIES;
    ComponentUtil2.ARRAY_PROPERTIES = PropertyKeys.ARRAY_PROPERTIES;
    ComponentUtil2.NUMBER_PROPERTIES = PropertyKeys.NUMBER_PROPERTIES;
    ComponentUtil2.BOOLEAN_PROPERTIES = PropertyKeys.BOOLEAN_PROPERTIES;
    ComponentUtil2.FUNCTION_PROPERTIES = PropertyKeys.FUNCTION_PROPERTIES;
    ComponentUtil2.ALL_PROPERTIES = PropertyKeys.ALL_PROPERTIES;
    ComponentUtil2.ALL_PROPERTIES_SET = new Set(PropertyKeys.ALL_PROPERTIES);
    ComponentUtil2.coercionLookup = ComponentUtil2.getCoercionLookup();
    return ComponentUtil2;
  }()
);
function fuzzyCheckStrings(inputValues, validValues, allSuggestions) {
  var fuzzyMatches = {};
  var invalidInputs = inputValues.filter(function(inputValue) {
    return !validValues.some(function(validValue) {
      return validValue === inputValue;
    });
  });
  if (invalidInputs.length > 0) {
    invalidInputs.forEach(function(invalidInput) {
      return fuzzyMatches[invalidInput] = fuzzySuggestions(invalidInput, allSuggestions);
    });
  }
  return fuzzyMatches;
}
function fuzzySuggestions(inputValue, allSuggestions, hideIrrelevant, filterByPercentageOfBestMatch) {
  var thisSuggestions = allSuggestions.map(function(text) {
    return {
      value: text,
      relevance: stringWeightedDistances(inputValue.toLowerCase(), text.toLocaleLowerCase())
    };
  });
  thisSuggestions.sort(function(a, b) {
    return b.relevance - a.relevance;
  });
  if (hideIrrelevant) {
    thisSuggestions = thisSuggestions.filter(function(suggestion) {
      return suggestion.relevance !== 0;
    });
  }
  if (filterByPercentageOfBestMatch && filterByPercentageOfBestMatch > 0) {
    var bestMatch = thisSuggestions[0].relevance;
    var limit_1 = bestMatch * filterByPercentageOfBestMatch;
    thisSuggestions = thisSuggestions.filter(function(suggestion) {
      return limit_1 - suggestion.relevance < 0;
    });
  }
  return thisSuggestions.map(function(suggestion) {
    return suggestion.value;
  });
}
function stringWeightedDistances(str1, str2) {
  var a = str1.replace(/\s/g, "");
  var b = str2.replace(/\s/g, "");
  var weight = 0;
  var lastIndex = -1;
  for (var i = 0; i < a.length; i++) {
    var idx = b.indexOf(a[i], lastIndex + 1);
    if (idx === -1) {
      continue;
    }
    lastIndex = idx;
    weight += 100 - lastIndex * 100 / 1e4 * 100;
  }
  return weight;
}
var FuzzyMatchUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  fuzzyCheckStrings,
  fuzzySuggestions
});
var __decorate$2x = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$s = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$m = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
function logDeprecation(version2, oldProp, newProp, message) {
  var newPropMsg = newProp ? "Please use '" + newProp + "' instead. " : "";
  doOnce(function() {
    return console.warn("AG Grid: since v" + version2 + ", '" + oldProp + "' is deprecated. " + newPropMsg + (message !== null && message !== void 0 ? message : ""));
  }, "Deprecated_" + oldProp);
}
var VUE_FRAMEWORK_PROPS = ["__ob__", "__v_skip", "__metadata__"];
var GridOptionsValidator = (
  /** @class */
  function() {
    function GridOptionsValidator2() {
      this.deprecatedProperties = {
        rememberGroupStateWhenNewData: { version: "24", message: "Now that transaction updates are possible and they keep group state, this feature is no longer needed." },
        serverSideFilteringAlwaysResets: { version: "28.0", newProp: "serverSideOnlyRefreshFilteredGroups", copyToNewProp: true },
        serverSideSortingAlwaysResets: { version: "28.0", newProp: "serverSideSortAllLevels", copyToNewProp: true },
        suppressReactUi: { version: "28", message: "The legacy React rendering engine is deprecated and will be removed in the next major version of the grid." },
        processSecondaryColDef: { version: "28", newProp: "processPivotResultColDef", copyToNewProp: true },
        processSecondaryColGroupDef: { version: "28", newProp: "processPivotResultColGroupDef", copyToNewProp: true },
        getServerSideStoreParams: { version: "28", newProp: "getServerSideGroupLevelParams", copyToNewProp: true },
        serverSideInfiniteScroll: { version: "29", message: "Infinite Scrolling is now the default behaviour. This can be suppressed with `suppressServerSideInfiniteScroll`." },
        enableChartToolPanelsButton: { version: "29", message: "The Chart Tool Panels button is now enabled by default. To hide the Chart Tool Panels button and display the hamburger button instead, set suppressChartToolPanelsButton=true." },
        functionsPassive: { version: "29.2" },
        onColumnRowGroupChangeRequest: { version: "29.2" },
        onColumnPivotChangeRequest: { version: "29.2" },
        onColumnValueChangeRequest: { version: "29.2" },
        onColumnAggFuncChangeRequest: { version: "29.2" },
        serverSideFilterAllLevels: { version: "30", message: "All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`." },
        suppressAggAtRootLevel: { version: "30", message: "The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`." },
        excludeHiddenColumnsFromQuickFilter: { version: "30", message: "Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`." },
        enterMovesDown: { version: "30", newProp: "enterNavigatesVertically", copyToNewProp: true },
        enterMovesDownAfterEdit: { version: "30", newProp: "enterNavigatesVerticallyAfterEdit", copyToNewProp: true }
      };
    }
    GridOptionsValidator2.prototype.pickOneWarning = function(prop1, prop2) {
      console.warn("AG Grid: " + prop1 + " and " + prop2 + " do not work with each other, you need to pick one.");
    };
    GridOptionsValidator2.prototype.init = function() {
      var _this = this;
      this.checkForDeprecated();
      this.checkForViolations();
      if (this.gridOptions.suppressPropertyNamesCheck !== true) {
        this.checkGridOptionsProperties();
        this.checkColumnDefProperties();
      }
      this.checkColumnDefViolations();
      if (this.gridOptionsService.is("groupSelectsChildren") && this.gridOptionsService.is("suppressParentsInRowNodes")) {
        console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work");
      }
      if (this.gridOptionsService.is("groupSelectsChildren")) {
        if (this.gridOptionsService.get("rowSelection") !== "multiple") {
          console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense");
        }
      }
      if (this.gridOptionsService.is("groupRemoveSingleChildren") && this.gridOptionsService.is("groupHideOpenParents")) {
        this.pickOneWarning("groupRemoveSingleChildren", "groupHideOpenParents");
      }
      if (this.gridOptionsService.isRowModelType("serverSide")) {
        var msg = function(prop, alt) {
          return "AG Grid: '" + prop + "' is not supported on the Server-Side Row Model." + (alt ? " Please use " + alt + " instead." : "");
        };
        if (this.gridOptionsService.exists("groupDefaultExpanded")) {
          console.warn(msg("groupDefaultExpanded", "isServerSideGroupOpenByDefault callback"));
        }
        if (this.gridOptionsService.exists("groupIncludeFooter") && this.gridOptionsService.is("suppressServerSideInfiniteScroll")) {
          console.warn(msg("groupIncludeFooter"));
        }
        if (this.gridOptionsService.exists("groupIncludeTotalFooter")) {
          console.warn(msg("groupIncludeTotalFooter"));
        }
      }
      if (this.gridOptionsService.is("enableRangeSelection")) {
        ModuleRegistry.__assertRegistered(ModuleNames.RangeSelectionModule, "enableRangeSelection", this.gridOptionsService.getGridId());
      } else if (this.gridOptionsService.is("enableRangeHandle") || this.gridOptionsService.is("enableFillHandle")) {
        console.warn("AG Grid: 'enableRangeHandle' or 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");
      }
      var validateRegistered = function(prop, module2) {
        return _this.gridOptionsService.exists(prop) && ModuleRegistry.__assertRegistered(module2, prop, _this.gridOptionsService.getGridId());
      };
      validateRegistered("sideBar", ModuleNames.SideBarModule);
      validateRegistered("statusBar", ModuleNames.StatusBarModule);
      validateRegistered("enableCharts", ModuleNames.GridChartsModule);
      validateRegistered("getMainMenuItems", ModuleNames.MenuModule);
      validateRegistered("getContextMenuItems", ModuleNames.MenuModule);
      validateRegistered("allowContextMenuWithControlKey", ModuleNames.MenuModule);
    };
    GridOptionsValidator2.prototype.checkColumnDefProperties = function() {
      var _this = this;
      if (this.gridOptions.columnDefs == null) {
        return;
      }
      var validProperties = ColDefUtil.ALL_PROPERTIES;
      var validateColDef = function(colDef, propertyName) {
        var userProperties = Object.getOwnPropertyNames(colDef);
        _this.checkProperties(userProperties, __spreadArray$m(__spreadArray$m([], __read$s(validProperties)), __read$s(VUE_FRAMEWORK_PROPS)), validProperties, propertyName, "https://www.ag-grid.com/javascript-data-grid/column-properties/");
        if (colDef.children) {
          colDef.children.forEach(function(child) {
            return validateColDef(child, "columnDefs.children");
          });
        }
      };
      this.gridOptions.columnDefs.forEach(function(colDef) {
        return validateColDef(colDef, "columnDefs");
      });
      if (this.gridOptions.defaultColDef) {
        validateColDef(this.gridOptions.defaultColDef, "defaultColDef");
      }
    };
    GridOptionsValidator2.prototype.checkColumnDefViolations = function() {
      var _a2;
      var rowModel = (_a2 = this.gridOptionsService.get("rowModelType")) !== null && _a2 !== void 0 ? _a2 : "clientSide";
      var unsupportedPropertiesMap = {
        infinite: ["headerCheckboxSelection", "headerCheckboxSelectionFilteredOnly", "headerCheckboxSelectionCurrentPageOnly"],
        viewport: ["headerCheckboxSelection", "headerCheckboxSelectionFilteredOnly", "headerCheckboxSelectionCurrentPageOnly"],
        serverSide: ["headerCheckboxSelectionFilteredOnly", "headerCheckboxSelectionCurrentPageOnly"],
        clientSide: []
      };
      var unsupportedProperties = unsupportedPropertiesMap[rowModel];
      if (!(unsupportedProperties === null || unsupportedProperties === void 0 ? void 0 : unsupportedProperties.length)) {
        return;
      }
      var validateColDef = function(colDef) {
        unsupportedProperties.forEach(function(property) {
          if (property in colDef && !!colDef[property]) {
            console.warn("AG Grid: Column property " + property + " is not supported with the row model type " + rowModel + ".");
          }
        });
      };
      if (this.gridOptions.columnDefs != null) {
        this.gridOptions.columnDefs.forEach(function(colDef) {
          return validateColDef(colDef);
        });
      }
      if (this.gridOptions.autoGroupColumnDef != null) {
        validateColDef(this.gridOptions.autoGroupColumnDef);
      }
      if (this.gridOptions.defaultColDef != null) {
        validateColDef(this.gridOptions.defaultColDef);
      }
    };
    GridOptionsValidator2.prototype.checkGridOptionsProperties = function() {
      var userProperties = Object.getOwnPropertyNames(this.gridOptions);
      var validProperties = __spreadArray$m(__spreadArray$m([], __read$s(PropertyKeys.ALL_PROPERTIES)), __read$s(ComponentUtil.EVENT_CALLBACKS));
      var validPropertiesAndExceptions = __spreadArray$m(__spreadArray$m(__spreadArray$m(__spreadArray$m([], __read$s(validProperties)), ["api", "columnApi"]), __read$s(VUE_FRAMEWORK_PROPS)), __read$s(Object.keys(this.deprecatedProperties)));
      this.checkProperties(userProperties, validPropertiesAndExceptions, validProperties, "gridOptions", "https://www.ag-grid.com/javascript-data-grid/grid-options/");
    };
    GridOptionsValidator2.prototype.checkProperties = function(userProperties, validPropertiesAndExceptions, validProperties, containerName, docsUrl) {
      var invalidProperties = fuzzyCheckStrings(userProperties, validPropertiesAndExceptions, validProperties);
      iterateObject(invalidProperties, function(key, value) {
        doOnce(function() {
          return console.warn("AG Grid: invalid " + containerName + " property '" + key + "' did you mean any of these: " + value.slice(0, 8).join(", "));
        }, "invalidProperty" + containerName + key);
      });
      if (Object.keys(invalidProperties).length > 0) {
        doOnce(function() {
          return console.warn("AG Grid: to see all the valid " + containerName + " properties please check: " + docsUrl);
        }, "invalidProperties" + containerName + docsUrl);
      }
    };
    GridOptionsValidator2.prototype.checkForDeprecated = function() {
      var options = this.gridOptions;
      Object.entries(this.deprecatedProperties).forEach(function(_a2) {
        var _b2;
        var _c = __read$s(_a2, 2), oldProp = _c[0], details = _c[1];
        var oldPropValue = options[oldProp];
        if (oldPropValue) {
          logDeprecation(details.version, oldProp, details.newProp, details.message);
          if (details.copyToNewProp && details.newProp && options[details.newProp] == null) {
            options[details.newProp] = (_b2 = details.newPropValue) !== null && _b2 !== void 0 ? _b2 : oldPropValue;
          }
        }
      });
      if (options.serverSideStoreType) {
        console.warn("AG Grid: since v29.0, `serverSideStoreType` has been replaced by `suppressServerSideInfiniteScroll`. Set to false to use Partial Store, and true to use Full Store.");
        options.suppressServerSideInfiniteScroll = options.serverSideStoreType !== "partial";
      }
    };
    GridOptionsValidator2.prototype.checkForViolations = function() {
      if (this.gridOptionsService.is("treeData")) {
        this.treeDataViolations();
      }
    };
    GridOptionsValidator2.prototype.treeDataViolations = function() {
      if (this.gridOptionsService.isRowModelType("clientSide")) {
        if (!this.gridOptionsService.exists("getDataPath")) {
          console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data.");
        }
      }
      if (this.gridOptionsService.isRowModelType("serverSide")) {
        if (!this.gridOptionsService.exists("isServerSideGroup")) {
          console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data.");
        }
        if (!this.gridOptionsService.exists("getServerSideGroupKey")) {
          console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data.");
        }
      }
    };
    __decorate$2x([
      Autowired("gridOptions")
    ], GridOptionsValidator2.prototype, "gridOptions", void 0);
    __decorate$2x([
      Autowired("gridOptionsService")
    ], GridOptionsValidator2.prototype, "gridOptionsService", void 0);
    __decorate$2x([
      PostConstruct
    ], GridOptionsValidator2.prototype, "init", null);
    GridOptionsValidator2 = __decorate$2x([
      Bean("gridOptionsValidator")
    ], GridOptionsValidator2);
    return GridOptionsValidator2;
  }()
);
function matchesGroupDisplayType(toMatch, supplied) {
  var groupDisplayTypeValues = ["groupRows", "multipleColumns", "custom", "singleColumn"];
  if (groupDisplayTypeValues.indexOf(supplied) < 0) {
    console.warn("AG Grid: '" + supplied + "' is not a valid groupDisplayType value - possible values are: '" + groupDisplayTypeValues.join("', '") + "'");
    return false;
  }
  return supplied === toMatch;
}
function matchesTreeDataDisplayType(toMatch, supplied) {
  var treeDataDisplayTypeValues = ["auto", "custom"];
  if (treeDataDisplayTypeValues.indexOf(supplied) < 0) {
    console.warn("AG Grid: '" + supplied + "' is not a valid treeDataDisplayType value - possible values are: '" + treeDataDisplayTypeValues.join("', '") + "'");
    return false;
  }
  return supplied === toMatch;
}
var __extends$2Z = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2w = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$8 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var __rest = function(s2, e) {
  var t2 = {};
  for (var p2 in s2)
    if (Object.prototype.hasOwnProperty.call(s2, p2) && e.indexOf(p2) < 0)
      t2[p2] = s2[p2];
  if (s2 != null && typeof Object.getOwnPropertySymbols === "function")
    for (var i = 0, p2 = Object.getOwnPropertySymbols(s2); i < p2.length; i++) {
      if (e.indexOf(p2[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s2, p2[i]))
        t2[p2[i]] = s2[p2[i]];
    }
  return t2;
};
var __values$6 = function(o) {
  var s2 = typeof Symbol === "function" && Symbol.iterator, m2 = s2 && o[s2], i = 0;
  if (m2)
    return m2.call(o);
  if (o && typeof o.length === "number")
    return {
      next: function() {
        if (o && i >= o.length)
          o = void 0;
        return { value: o && o[i++], done: !o };
      }
    };
  throw new TypeError(s2 ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __read$r = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$l = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var ColumnModel = (
  /** @class */
  function(_super) {
    __extends$2Z(ColumnModel2, _super);
    function ColumnModel2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.primaryHeaderRowCount = 0;
      _this.secondaryHeaderRowCount = 0;
      _this.gridHeaderRowCount = 0;
      _this.displayedColumnsLeft = [];
      _this.displayedColumnsRight = [];
      _this.displayedColumnsCenter = [];
      _this.displayedColumns = [];
      _this.displayedColumnsAndGroupsMap = {};
      _this.viewportColumns = [];
      _this.viewportColumnsHash = "";
      _this.headerViewportColumns = [];
      _this.viewportColumnsCenter = [];
      _this.headerViewportColumnsCenter = [];
      _this.autoHeightActiveAtLeastOnce = false;
      _this.rowGroupColumns = [];
      _this.valueColumns = [];
      _this.pivotColumns = [];
      _this.ready = false;
      _this.autoGroupsNeedBuilding = false;
      _this.forceRecreateAutoGroups = false;
      _this.pivotMode = false;
      _this.bodyWidth = 0;
      _this.leftWidth = 0;
      _this.rightWidth = 0;
      _this.bodyWidthDirty = true;
      _this.shouldQueueResizeOperations = false;
      _this.resizeOperationQueue = [];
      return _this;
    }
    ColumnModel2.prototype.init = function() {
      var _this = this;
      this.suppressColumnVirtualisation = this.gridOptionsService.is("suppressColumnVirtualisation");
      var pivotMode = this.gridOptionsService.is("pivotMode");
      if (this.isPivotSettingAllowed(pivotMode)) {
        this.pivotMode = pivotMode;
      }
      this.usingTreeData = this.gridOptionsService.isTreeData();
      this.addManagedPropertyListener("groupDisplayType", function() {
        return _this.onAutoGroupColumnDefChanged();
      });
      this.addManagedPropertyListener("autoGroupColumnDef", function() {
        return _this.onAutoGroupColumnDefChanged();
      });
      this.addManagedPropertyListener("defaultColDef", function(params) {
        return _this.onSharedColDefChanged(params.source);
      });
      this.addManagedPropertyListener("columnTypes", function(params) {
        return _this.onSharedColDefChanged(params.source);
      });
    };
    ColumnModel2.prototype.onAutoGroupColumnDefChanged = function() {
      if (!this.columnDefs) {
        return;
      }
      this.autoGroupsNeedBuilding = true;
      this.forceRecreateAutoGroups = true;
      this.updateGridColumns();
      this.updateDisplayedColumns("gridOptionsChanged");
    };
    ColumnModel2.prototype.onSharedColDefChanged = function(source) {
      if (source === void 0) {
        source = "api";
      }
      this.forceRecreateAutoGroups = true;
      this.createColumnsFromColumnDefs(true, source);
    };
    ColumnModel2.prototype.setColumnDefs = function(columnDefs, source) {
      if (source === void 0) {
        source = "api";
      }
      var colsPreviouslyExisted = !!this.columnDefs;
      this.columnDefs = columnDefs;
      this.createColumnsFromColumnDefs(colsPreviouslyExisted, source);
    };
    ColumnModel2.prototype.recreateColumnDefs = function(source) {
      if (source === void 0) {
        source = "api";
      }
      this.onSharedColDefChanged(source);
    };
    ColumnModel2.prototype.destroyOldColumns = function(oldTree, newTree) {
      var oldObjectsById = {};
      if (!oldTree) {
        return;
      }
      this.columnUtils.depthFirstOriginalTreeSearch(null, oldTree, function(child) {
        oldObjectsById[child.getInstanceId()] = child;
      });
      if (newTree) {
        this.columnUtils.depthFirstOriginalTreeSearch(null, newTree, function(child) {
          oldObjectsById[child.getInstanceId()] = null;
        });
      }
      var colsToDestroy = Object.values(oldObjectsById).filter(function(item) {
        return item != null;
      });
      this.destroyBeans(colsToDestroy);
    };
    ColumnModel2.prototype.destroyColumns = function() {
      this.destroyOldColumns(this.primaryColumnTree);
      this.destroyOldColumns(this.secondaryBalancedTree);
      this.destroyOldColumns(this.groupAutoColsBalancedTree);
    };
    ColumnModel2.prototype.createColumnsFromColumnDefs = function(colsPreviouslyExisted, source) {
      var _this = this;
      if (source === void 0) {
        source = "api";
      }
      var dispatchEventsFunc = colsPreviouslyExisted ? this.compareColumnStatesAndDispatchEvents(source) : void 0;
      this.valueCache.expire();
      this.autoGroupsNeedBuilding = true;
      var oldPrimaryColumns = this.primaryColumns;
      var oldPrimaryTree = this.primaryColumnTree;
      var balancedTreeResult = this.columnFactory.createColumnTree(this.columnDefs, true, oldPrimaryTree);
      this.destroyOldColumns(this.primaryColumnTree, balancedTreeResult.columnTree);
      this.primaryColumnTree = balancedTreeResult.columnTree;
      this.primaryHeaderRowCount = balancedTreeResult.treeDept + 1;
      this.primaryColumns = this.getColumnsFromTree(this.primaryColumnTree);
      this.primaryColumnsMap = {};
      this.primaryColumns.forEach(function(col) {
        return _this.primaryColumnsMap[col.getId()] = col;
      });
      this.extractRowGroupColumns(source, oldPrimaryColumns);
      this.extractPivotColumns(source, oldPrimaryColumns);
      this.extractValueColumns(source, oldPrimaryColumns);
      this.ready = true;
      var gridColsNotProcessed = this.gridColsArePrimary === void 0;
      var processGridCols = this.gridColsArePrimary || gridColsNotProcessed;
      if (processGridCols) {
        this.updateGridColumns();
        if (colsPreviouslyExisted && !this.gridOptionsService.is("maintainColumnOrder")) {
          this.orderGridColumnsLikePrimary();
        }
        this.updateDisplayedColumns(source);
        this.checkViewportColumns();
      }
      this.dispatchEverythingChanged(source);
      if (dispatchEventsFunc) {
        dispatchEventsFunc();
      }
      this.dispatchNewColumnsLoaded();
    };
    ColumnModel2.prototype.dispatchNewColumnsLoaded = function() {
      var newColumnsLoadedEvent = {
        type: Events.EVENT_NEW_COLUMNS_LOADED
      };
      this.eventService.dispatchEvent(newColumnsLoadedEvent);
    };
    ColumnModel2.prototype.dispatchEverythingChanged = function(source) {
      if (source === void 0) {
        source = "api";
      }
      var eventEverythingChanged = {
        type: Events.EVENT_COLUMN_EVERYTHING_CHANGED,
        source
      };
      this.eventService.dispatchEvent(eventEverythingChanged);
    };
    ColumnModel2.prototype.orderGridColumnsLikePrimary = function() {
      var _this = this;
      var primaryColumns = this.primaryColumns;
      if (!primaryColumns) {
        return;
      }
      this.gridColumns.sort(function(colA, colB) {
        var primaryIndexA = primaryColumns.indexOf(colA);
        var primaryIndexB = primaryColumns.indexOf(colB);
        var indexAPresent = primaryIndexA >= 0;
        var indexBPresent = primaryIndexB >= 0;
        if (indexAPresent && indexBPresent) {
          return primaryIndexA - primaryIndexB;
        }
        if (indexAPresent) {
          return 1;
        }
        if (indexBPresent) {
          return -1;
        }
        var gridIndexA = _this.gridColumns.indexOf(colA);
        var gridIndexB = _this.gridColumns.indexOf(colB);
        return gridIndexA - gridIndexB;
      });
      this.gridColumns = this.placeLockedColumns(this.gridColumns);
    };
    ColumnModel2.prototype.getAllDisplayedAutoHeightCols = function() {
      return this.displayedAutoHeightCols;
    };
    ColumnModel2.prototype.setViewport = function() {
      if (this.gridOptionsService.is("enableRtl")) {
        this.viewportLeft = this.bodyWidth - this.scrollPosition - this.scrollWidth;
        this.viewportRight = this.bodyWidth - this.scrollPosition;
      } else {
        this.viewportLeft = this.scrollPosition;
        this.viewportRight = this.scrollWidth + this.scrollPosition;
      }
    };
    ColumnModel2.prototype.getDisplayedColumnsStartingAt = function(column) {
      var currentColumn = column;
      var columns = [];
      while (currentColumn != null) {
        columns.push(currentColumn);
        currentColumn = this.getDisplayedColAfter(currentColumn);
      }
      return columns;
    };
    ColumnModel2.prototype.checkViewportColumns = function() {
      if (this.displayedColumnsCenter == null) {
        return;
      }
      var viewportColumnsChanged = this.extractViewport();
      if (!viewportColumnsChanged) {
        return;
      }
      var event = {
        type: Events.EVENT_VIRTUAL_COLUMNS_CHANGED
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.setViewportPosition = function(scrollWidth, scrollPosition) {
      if (scrollWidth !== this.scrollWidth || scrollPosition !== this.scrollPosition || this.bodyWidthDirty) {
        this.scrollWidth = scrollWidth;
        this.scrollPosition = scrollPosition;
        this.bodyWidthDirty = true;
        this.setViewport();
        if (this.ready) {
          this.checkViewportColumns();
        }
      }
    };
    ColumnModel2.prototype.isPivotMode = function() {
      return this.pivotMode;
    };
    ColumnModel2.prototype.isPivotSettingAllowed = function(pivot) {
      if (pivot && this.gridOptionsService.isTreeData()) {
        console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'");
        return false;
      }
      return true;
    };
    ColumnModel2.prototype.setPivotMode = function(pivotMode, source) {
      if (source === void 0) {
        source = "api";
      }
      if (pivotMode === this.pivotMode || !this.isPivotSettingAllowed(this.pivotMode)) {
        return;
      }
      this.pivotMode = pivotMode;
      this.autoGroupsNeedBuilding = true;
      this.updateGridColumns();
      this.updateDisplayedColumns(source);
      var event = {
        type: Events.EVENT_COLUMN_PIVOT_MODE_CHANGED
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.getSecondaryPivotColumn = function(pivotKeys, valueColKey) {
      if (missing(this.secondaryColumns)) {
        return null;
      }
      var valueColumnToFind = this.getPrimaryColumn(valueColKey);
      var foundColumn = null;
      this.secondaryColumns.forEach(function(column) {
        var thisPivotKeys = column.getColDef().pivotKeys;
        var pivotValueColumn = column.getColDef().pivotValueColumn;
        var pivotKeyMatches = areEqual(thisPivotKeys, pivotKeys);
        var pivotValueMatches = pivotValueColumn === valueColumnToFind;
        if (pivotKeyMatches && pivotValueMatches) {
          foundColumn = column;
        }
      });
      return foundColumn;
    };
    ColumnModel2.prototype.setBeans = function(loggerFactory) {
      this.logger = loggerFactory.create("columnModel");
    };
    ColumnModel2.prototype.setFirstRightAndLastLeftPinned = function(source) {
      var lastLeft;
      var firstRight;
      if (this.gridOptionsService.is("enableRtl")) {
        lastLeft = this.displayedColumnsLeft ? this.displayedColumnsLeft[0] : null;
        firstRight = this.displayedColumnsRight ? last(this.displayedColumnsRight) : null;
      } else {
        lastLeft = this.displayedColumnsLeft ? last(this.displayedColumnsLeft) : null;
        firstRight = this.displayedColumnsRight ? this.displayedColumnsRight[0] : null;
      }
      this.gridColumns.forEach(function(column) {
        column.setLastLeftPinned(column === lastLeft, source);
        column.setFirstRightPinned(column === firstRight, source);
      });
    };
    ColumnModel2.prototype.autoSizeColumns = function(params) {
      var _this = this;
      if (this.shouldQueueResizeOperations) {
        this.resizeOperationQueue.push(function() {
          return _this.autoSizeColumns(params);
        });
        return;
      }
      var columns = params.columns, skipHeader = params.skipHeader, skipHeaderGroups = params.skipHeaderGroups, stopAtGroup = params.stopAtGroup, _a2 = params.source, source = _a2 === void 0 ? "api" : _a2;
      this.animationFrameService.flushAllFrames();
      var columnsAutosized = [];
      var changesThisTimeAround = -1;
      var shouldSkipHeader = skipHeader != null ? skipHeader : this.gridOptionsService.is("skipHeaderOnAutoSize");
      var shouldSkipHeaderGroups = skipHeaderGroups != null ? skipHeaderGroups : shouldSkipHeader;
      while (changesThisTimeAround !== 0) {
        changesThisTimeAround = 0;
        this.actionOnGridColumns(columns, function(column) {
          if (columnsAutosized.indexOf(column) >= 0) {
            return false;
          }
          var preferredWidth = _this.autoWidthCalculator.getPreferredWidthForColumn(column, shouldSkipHeader);
          if (preferredWidth > 0) {
            var newWidth = _this.normaliseColumnWidth(column, preferredWidth);
            column.setActualWidth(newWidth, source);
            columnsAutosized.push(column);
            changesThisTimeAround++;
          }
          return true;
        }, source);
      }
      if (!shouldSkipHeaderGroups) {
        this.autoSizeColumnGroupsByColumns(columns, source, stopAtGroup);
      }
      this.dispatchColumnResizedEvent(columnsAutosized, true, "autosizeColumns");
    };
    ColumnModel2.prototype.dispatchColumnResizedEvent = function(columns, finished, source, flexColumns) {
      if (flexColumns === void 0) {
        flexColumns = null;
      }
      if (columns && columns.length) {
        var event_1 = {
          type: Events.EVENT_COLUMN_RESIZED,
          columns,
          column: columns.length === 1 ? columns[0] : null,
          flexColumns,
          finished,
          source
        };
        this.eventService.dispatchEvent(event_1);
      }
    };
    ColumnModel2.prototype.dispatchColumnChangedEvent = function(type, columns, source) {
      var event = {
        type,
        columns,
        column: columns && columns.length == 1 ? columns[0] : null,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.dispatchColumnMovedEvent = function(params) {
      var movedColumns = params.movedColumns, source = params.source, toIndex = params.toIndex, finished = params.finished;
      var event = {
        type: Events.EVENT_COLUMN_MOVED,
        columns: movedColumns,
        column: movedColumns && movedColumns.length === 1 ? movedColumns[0] : null,
        toIndex,
        finished,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.dispatchColumnPinnedEvent = function(changedColumns, source) {
      if (!changedColumns.length) {
        return;
      }
      var column = changedColumns.length === 1 ? changedColumns[0] : null;
      var pinned = this.getCommonValue(changedColumns, function(col) {
        return col.getPinned();
      });
      var event = {
        type: Events.EVENT_COLUMN_PINNED,
        // mistake in typing, 'undefined' should be allowed, as 'null' means 'not pinned'
        pinned: pinned != null ? pinned : null,
        columns: changedColumns,
        column,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.dispatchColumnVisibleEvent = function(changedColumns, source) {
      if (!changedColumns.length) {
        return;
      }
      var column = changedColumns.length === 1 ? changedColumns[0] : null;
      var visible = this.getCommonValue(changedColumns, function(col) {
        return col.isVisible();
      });
      var event = {
        type: Events.EVENT_COLUMN_VISIBLE,
        visible,
        columns: changedColumns,
        column,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.autoSizeColumn = function(key, skipHeader, source) {
      if (source === void 0) {
        source = "api";
      }
      if (key) {
        this.autoSizeColumns({ columns: [key], skipHeader, skipHeaderGroups: true, source });
      }
    };
    ColumnModel2.prototype.autoSizeColumnGroupsByColumns = function(keys2, source, stopAtGroup) {
      var e_1, _a2, e_2, _b2;
      var columnGroups = /* @__PURE__ */ new Set();
      var columns = this.getGridColumns(keys2);
      columns.forEach(function(col) {
        var parent = col.getParent();
        while (parent && parent != stopAtGroup) {
          if (!parent.isPadding()) {
            columnGroups.add(parent);
          }
          parent = parent.getParent();
        }
      });
      var headerGroupCtrl;
      var resizedColumns = [];
      try {
        for (var columnGroups_1 = __values$6(columnGroups), columnGroups_1_1 = columnGroups_1.next(); !columnGroups_1_1.done; columnGroups_1_1 = columnGroups_1.next()) {
          var columnGroup = columnGroups_1_1.value;
          try {
            for (var _c = (e_2 = void 0, __values$6(this.ctrlsService.getHeaderRowContainerCtrls())), _d = _c.next(); !_d.done; _d = _c.next()) {
              var headerContainerCtrl = _d.value;
              headerGroupCtrl = headerContainerCtrl.getHeaderCtrlForColumn(columnGroup);
              if (headerGroupCtrl) {
                break;
              }
            }
          } catch (e_2_1) {
            e_2 = { error: e_2_1 };
          } finally {
            try {
              if (_d && !_d.done && (_b2 = _c.return))
                _b2.call(_c);
            } finally {
              if (e_2)
                throw e_2.error;
            }
          }
          if (headerGroupCtrl) {
            headerGroupCtrl.resizeLeafColumnsToFit(source);
          }
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (columnGroups_1_1 && !columnGroups_1_1.done && (_a2 = columnGroups_1.return))
            _a2.call(columnGroups_1);
        } finally {
          if (e_1)
            throw e_1.error;
        }
      }
      return resizedColumns;
    };
    ColumnModel2.prototype.autoSizeAllColumns = function(skipHeader, source) {
      var _this = this;
      if (source === void 0) {
        source = "api";
      }
      if (this.shouldQueueResizeOperations) {
        this.resizeOperationQueue.push(function() {
          return _this.autoSizeAllColumns(skipHeader, source);
        });
        return;
      }
      var allDisplayedColumns = this.getAllDisplayedColumns();
      this.autoSizeColumns({ columns: allDisplayedColumns, skipHeader, source });
    };
    ColumnModel2.prototype.getColumnsFromTree = function(rootColumns) {
      var result = [];
      var recursiveFindColumns = function(childColumns) {
        for (var i = 0; i < childColumns.length; i++) {
          var child = childColumns[i];
          if (child instanceof Column) {
            result.push(child);
          } else if (child instanceof ProvidedColumnGroup) {
            recursiveFindColumns(child.getChildren());
          }
        }
      };
      recursiveFindColumns(rootColumns);
      return result;
    };
    ColumnModel2.prototype.getAllDisplayedTrees = function() {
      if (this.displayedTreeLeft && this.displayedTreeRight && this.displayedTreeCentre) {
        return this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight);
      }
      return null;
    };
    ColumnModel2.prototype.getPrimaryColumnTree = function() {
      return this.primaryColumnTree;
    };
    ColumnModel2.prototype.getHeaderRowCount = function() {
      return this.gridHeaderRowCount;
    };
    ColumnModel2.prototype.getDisplayedTreeLeft = function() {
      return this.displayedTreeLeft;
    };
    ColumnModel2.prototype.getDisplayedTreeRight = function() {
      return this.displayedTreeRight;
    };
    ColumnModel2.prototype.getDisplayedTreeCentre = function() {
      return this.displayedTreeCentre;
    };
    ColumnModel2.prototype.isColumnDisplayed = function(column) {
      return this.getAllDisplayedColumns().indexOf(column) >= 0;
    };
    ColumnModel2.prototype.getAllDisplayedColumns = function() {
      return this.displayedColumns;
    };
    ColumnModel2.prototype.getViewportColumns = function() {
      return this.viewportColumns;
    };
    ColumnModel2.prototype.getDisplayedLeftColumnsForRow = function(rowNode) {
      if (!this.colSpanActive) {
        return this.displayedColumnsLeft;
      }
      return this.getDisplayedColumnsForRow(rowNode, this.displayedColumnsLeft);
    };
    ColumnModel2.prototype.getDisplayedRightColumnsForRow = function(rowNode) {
      if (!this.colSpanActive) {
        return this.displayedColumnsRight;
      }
      return this.getDisplayedColumnsForRow(rowNode, this.displayedColumnsRight);
    };
    ColumnModel2.prototype.isColSpanActive = function() {
      return this.colSpanActive;
    };
    ColumnModel2.prototype.getDisplayedColumnsForRow = function(rowNode, displayedColumns, filterCallback, emptySpaceBeforeColumn) {
      var result = [];
      var lastConsideredCol = null;
      var _loop_1 = function(i2) {
        var col = displayedColumns[i2];
        var maxAllowedColSpan = displayedColumns.length - i2;
        var colSpan = Math.min(col.getColSpan(rowNode), maxAllowedColSpan);
        var columnsToCheckFilter = [col];
        if (colSpan > 1) {
          var colsToRemove = colSpan - 1;
          for (var j = 1; j <= colsToRemove; j++) {
            columnsToCheckFilter.push(displayedColumns[i2 + j]);
          }
          i2 += colsToRemove;
        }
        var filterPasses;
        if (filterCallback) {
          filterPasses = false;
          columnsToCheckFilter.forEach(function(colForFilter) {
            if (filterCallback(colForFilter)) {
              filterPasses = true;
            }
          });
        } else {
          filterPasses = true;
        }
        if (filterPasses) {
          if (result.length === 0 && lastConsideredCol) {
            var gapBeforeColumn = emptySpaceBeforeColumn ? emptySpaceBeforeColumn(col) : false;
            if (gapBeforeColumn) {
              result.push(lastConsideredCol);
            }
          }
          result.push(col);
        }
        lastConsideredCol = col;
        out_i_1 = i2;
      };
      var out_i_1;
      for (var i = 0; i < displayedColumns.length; i++) {
        _loop_1(i);
        i = out_i_1;
      }
      return result;
    };
    ColumnModel2.prototype.getViewportCenterColumnsForRow = function(rowNode) {
      var _this = this;
      if (!this.colSpanActive) {
        return this.viewportColumnsCenter;
      }
      var emptySpaceBeforeColumn = function(col) {
        var left = col.getLeft();
        return exists(left) && left > _this.viewportLeft;
      };
      var filterCallback = this.suppressColumnVirtualisation ? null : this.isColumnInRowViewport.bind(this);
      return this.getDisplayedColumnsForRow(rowNode, this.displayedColumnsCenter, filterCallback, emptySpaceBeforeColumn);
    };
    ColumnModel2.prototype.getAriaColumnIndex = function(col) {
      return this.getAllGridColumns().indexOf(col) + 1;
    };
    ColumnModel2.prototype.isColumnInHeaderViewport = function(col) {
      if (col.isAutoHeaderHeight()) {
        return true;
      }
      return this.isColumnInRowViewport(col);
    };
    ColumnModel2.prototype.isColumnInRowViewport = function(col) {
      if (col.isAutoHeight()) {
        return true;
      }
      var columnLeft = col.getLeft() || 0;
      var columnRight = columnLeft + col.getActualWidth();
      var leftBounds = this.viewportLeft - 200;
      var rightBounds = this.viewportRight + 200;
      var columnToMuchLeft = columnLeft < leftBounds && columnRight < leftBounds;
      var columnToMuchRight = columnLeft > rightBounds && columnRight > rightBounds;
      return !columnToMuchLeft && !columnToMuchRight;
    };
    ColumnModel2.prototype.getDisplayedColumnsLeftWidth = function() {
      return this.getWidthOfColsInList(this.displayedColumnsLeft);
    };
    ColumnModel2.prototype.getDisplayedColumnsRightWidth = function() {
      return this.getWidthOfColsInList(this.displayedColumnsRight);
    };
    ColumnModel2.prototype.updatePrimaryColumnList = function(keys2, masterList, actionIsAdd, columnCallback, eventType, source) {
      var _this = this;
      if (source === void 0) {
        source = "api";
      }
      if (!keys2 || missingOrEmpty(keys2)) {
        return;
      }
      var atLeastOne = false;
      keys2.forEach(function(key) {
        var columnToAdd = _this.getPrimaryColumn(key);
        if (!columnToAdd) {
          return;
        }
        if (actionIsAdd) {
          if (masterList.indexOf(columnToAdd) >= 0) {
            return;
          }
          masterList.push(columnToAdd);
        } else {
          if (masterList.indexOf(columnToAdd) < 0) {
            return;
          }
          removeFromArray(masterList, columnToAdd);
        }
        columnCallback(columnToAdd);
        atLeastOne = true;
      });
      if (!atLeastOne) {
        return;
      }
      if (this.autoGroupsNeedBuilding) {
        this.updateGridColumns();
      }
      this.updateDisplayedColumns(source);
      var event = {
        type: eventType,
        columns: masterList,
        column: masterList.length === 1 ? masterList[0] : null,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.setRowGroupColumns = function(colKeys, source) {
      if (source === void 0) {
        source = "api";
      }
      this.autoGroupsNeedBuilding = true;
      this.setPrimaryColumnList(colKeys, this.rowGroupColumns, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.setRowGroupActive.bind(this), source);
    };
    ColumnModel2.prototype.setRowGroupActive = function(active, column, source) {
      if (active === column.isRowGroupActive()) {
        return;
      }
      column.setRowGroupActive(active, source);
      if (active && !this.gridOptionsService.is("suppressRowGroupHidesColumns")) {
        this.setColumnVisible(column, false, source);
      }
      if (!active && !this.gridOptionsService.is("suppressMakeColumnVisibleAfterUnGroup")) {
        this.setColumnVisible(column, true, source);
      }
    };
    ColumnModel2.prototype.addRowGroupColumn = function(key, source) {
      if (source === void 0) {
        source = "api";
      }
      if (key) {
        this.addRowGroupColumns([key], source);
      }
    };
    ColumnModel2.prototype.addRowGroupColumns = function(keys2, source) {
      if (source === void 0) {
        source = "api";
      }
      this.autoGroupsNeedBuilding = true;
      this.updatePrimaryColumnList(keys2, this.rowGroupColumns, true, this.setRowGroupActive.bind(this, true), Events.EVENT_COLUMN_ROW_GROUP_CHANGED, source);
    };
    ColumnModel2.prototype.removeRowGroupColumns = function(keys2, source) {
      if (source === void 0) {
        source = "api";
      }
      this.autoGroupsNeedBuilding = true;
      this.updatePrimaryColumnList(keys2, this.rowGroupColumns, false, this.setRowGroupActive.bind(this, false), Events.EVENT_COLUMN_ROW_GROUP_CHANGED, source);
    };
    ColumnModel2.prototype.removeRowGroupColumn = function(key, source) {
      if (source === void 0) {
        source = "api";
      }
      if (key) {
        this.removeRowGroupColumns([key], source);
      }
    };
    ColumnModel2.prototype.addPivotColumns = function(keys2, source) {
      if (source === void 0) {
        source = "api";
      }
      this.updatePrimaryColumnList(keys2, this.pivotColumns, true, function(column) {
        return column.setPivotActive(true, source);
      }, Events.EVENT_COLUMN_PIVOT_CHANGED, source);
    };
    ColumnModel2.prototype.setPivotColumns = function(colKeys, source) {
      if (source === void 0) {
        source = "api";
      }
      this.setPrimaryColumnList(colKeys, this.pivotColumns, Events.EVENT_COLUMN_PIVOT_CHANGED, function(added, column) {
        column.setPivotActive(added, source);
      }, source);
    };
    ColumnModel2.prototype.addPivotColumn = function(key, source) {
      if (source === void 0) {
        source = "api";
      }
      this.addPivotColumns([key], source);
    };
    ColumnModel2.prototype.removePivotColumns = function(keys2, source) {
      if (source === void 0) {
        source = "api";
      }
      this.updatePrimaryColumnList(keys2, this.pivotColumns, false, function(column) {
        return column.setPivotActive(false, source);
      }, Events.EVENT_COLUMN_PIVOT_CHANGED, source);
    };
    ColumnModel2.prototype.removePivotColumn = function(key, source) {
      if (source === void 0) {
        source = "api";
      }
      this.removePivotColumns([key], source);
    };
    ColumnModel2.prototype.setPrimaryColumnList = function(colKeys, masterList, eventName, columnCallback, source) {
      var _this = this;
      masterList.length = 0;
      if (exists(colKeys)) {
        colKeys.forEach(function(key) {
          var column = _this.getPrimaryColumn(key);
          if (column) {
            masterList.push(column);
          }
        });
      }
      (this.primaryColumns || []).forEach(function(column) {
        var added = masterList.indexOf(column) >= 0;
        columnCallback(added, column);
      });
      if (this.autoGroupsNeedBuilding) {
        this.updateGridColumns();
      }
      this.updateDisplayedColumns(source);
      this.dispatchColumnChangedEvent(eventName, masterList, source);
    };
    ColumnModel2.prototype.setValueColumns = function(colKeys, source) {
      if (source === void 0) {
        source = "api";
      }
      this.setPrimaryColumnList(colKeys, this.valueColumns, Events.EVENT_COLUMN_VALUE_CHANGED, this.setValueActive.bind(this), source);
    };
    ColumnModel2.prototype.setValueActive = function(active, column, source) {
      if (active === column.isValueActive()) {
        return;
      }
      column.setValueActive(active, source);
      if (active && !column.getAggFunc()) {
        var initialAggFunc = this.aggFuncService.getDefaultAggFunc(column);
        column.setAggFunc(initialAggFunc);
      }
    };
    ColumnModel2.prototype.addValueColumns = function(keys2, source) {
      if (source === void 0) {
        source = "api";
      }
      this.updatePrimaryColumnList(keys2, this.valueColumns, true, this.setValueActive.bind(this, true), Events.EVENT_COLUMN_VALUE_CHANGED, source);
    };
    ColumnModel2.prototype.addValueColumn = function(colKey, source) {
      if (source === void 0) {
        source = "api";
      }
      if (colKey) {
        this.addValueColumns([colKey], source);
      }
    };
    ColumnModel2.prototype.removeValueColumn = function(colKey, source) {
      if (source === void 0) {
        source = "api";
      }
      this.removeValueColumns([colKey], source);
    };
    ColumnModel2.prototype.removeValueColumns = function(keys2, source) {
      if (source === void 0) {
        source = "api";
      }
      this.updatePrimaryColumnList(keys2, this.valueColumns, false, this.setValueActive.bind(this, false), Events.EVENT_COLUMN_VALUE_CHANGED, source);
    };
    ColumnModel2.prototype.normaliseColumnWidth = function(column, newWidth) {
      var minWidth = column.getMinWidth();
      if (exists(minWidth) && newWidth < minWidth) {
        newWidth = minWidth;
      }
      var maxWidth = column.getMaxWidth();
      if (exists(maxWidth) && column.isGreaterThanMax(newWidth)) {
        newWidth = maxWidth;
      }
      return newWidth;
    };
    ColumnModel2.prototype.getPrimaryOrGridColumn = function(key) {
      var column = this.getPrimaryColumn(key);
      return column || this.getGridColumn(key);
    };
    ColumnModel2.prototype.setColumnWidths = function(columnWidths, shiftKey, finished, source) {
      var _this = this;
      if (source === void 0) {
        source = "api";
      }
      var sets = [];
      columnWidths.forEach(function(columnWidth) {
        var col = _this.getPrimaryOrGridColumn(columnWidth.key);
        if (!col) {
          return;
        }
        sets.push({
          width: columnWidth.newWidth,
          ratios: [1],
          columns: [col]
        });
        var defaultIsShift = _this.gridOptionsService.get("colResizeDefault") === "shift";
        if (defaultIsShift) {
          shiftKey = !shiftKey;
        }
        if (shiftKey) {
          var otherCol = _this.getDisplayedColAfter(col);
          if (!otherCol) {
            return;
          }
          var widthDiff = col.getActualWidth() - columnWidth.newWidth;
          var otherColWidth = otherCol.getActualWidth() + widthDiff;
          sets.push({
            width: otherColWidth,
            ratios: [1],
            columns: [otherCol]
          });
        }
      });
      if (sets.length === 0) {
        return;
      }
      this.resizeColumnSets({
        resizeSets: sets,
        finished,
        source
      });
    };
    ColumnModel2.prototype.checkMinAndMaxWidthsForSet = function(columnResizeSet) {
      var columns = columnResizeSet.columns, width = columnResizeSet.width;
      var minWidthAccumulated = 0;
      var maxWidthAccumulated = 0;
      var maxWidthActive = true;
      columns.forEach(function(col) {
        var minWidth = col.getMinWidth();
        minWidthAccumulated += minWidth || 0;
        var maxWidth = col.getMaxWidth();
        if (exists(maxWidth) && maxWidth > 0) {
          maxWidthAccumulated += maxWidth;
        } else {
          maxWidthActive = false;
        }
      });
      var minWidthPasses = width >= minWidthAccumulated;
      var maxWidthPasses = !maxWidthActive || width <= maxWidthAccumulated;
      return minWidthPasses && maxWidthPasses;
    };
    ColumnModel2.prototype.resizeColumnSets = function(params) {
      var _this = this;
      var resizeSets = params.resizeSets, finished = params.finished, source = params.source;
      var passMinMaxCheck = !resizeSets || resizeSets.every(function(columnResizeSet) {
        return _this.checkMinAndMaxWidthsForSet(columnResizeSet);
      });
      if (!passMinMaxCheck) {
        if (finished) {
          var columns = resizeSets && resizeSets.length > 0 ? resizeSets[0].columns : null;
          this.dispatchColumnResizedEvent(columns, finished, source);
        }
        return;
      }
      var changedCols = [];
      var allResizedCols = [];
      resizeSets.forEach(function(set2) {
        var width = set2.width, columns2 = set2.columns, ratios = set2.ratios;
        var newWidths = {};
        var finishedCols = {};
        columns2.forEach(function(col) {
          return allResizedCols.push(col);
        });
        var finishedColsGrew = true;
        var loopCount = 0;
        var _loop_2 = function() {
          loopCount++;
          if (loopCount > 1e3) {
            console.error("AG Grid: infinite loop in resizeColumnSets");
            return "break";
          }
          finishedColsGrew = false;
          var subsetCols = [];
          var subsetRatioTotal = 0;
          var pixelsToDistribute = width;
          columns2.forEach(function(col, index2) {
            var thisColFinished = finishedCols[col.getId()];
            if (thisColFinished) {
              pixelsToDistribute -= newWidths[col.getId()];
            } else {
              subsetCols.push(col);
              var ratioThisCol = ratios[index2];
              subsetRatioTotal += ratioThisCol;
            }
          });
          var ratioScale = 1 / subsetRatioTotal;
          subsetCols.forEach(function(col, index2) {
            var lastCol = index2 === subsetCols.length - 1;
            var colNewWidth;
            if (lastCol) {
              colNewWidth = pixelsToDistribute;
            } else {
              colNewWidth = Math.round(ratios[index2] * width * ratioScale);
              pixelsToDistribute -= colNewWidth;
            }
            var minWidth = col.getMinWidth();
            var maxWidth = col.getMaxWidth();
            if (exists(minWidth) && colNewWidth < minWidth) {
              colNewWidth = minWidth;
              finishedCols[col.getId()] = true;
              finishedColsGrew = true;
            } else if (exists(maxWidth) && maxWidth > 0 && colNewWidth > maxWidth) {
              colNewWidth = maxWidth;
              finishedCols[col.getId()] = true;
              finishedColsGrew = true;
            }
            newWidths[col.getId()] = colNewWidth;
          });
        };
        while (finishedColsGrew) {
          var state_1 = _loop_2();
          if (state_1 === "break")
            break;
        }
        columns2.forEach(function(col) {
          var newWidth = newWidths[col.getId()];
          var actualWidth = col.getActualWidth();
          if (actualWidth !== newWidth) {
            col.setActualWidth(newWidth, source);
            changedCols.push(col);
          }
        });
      });
      var atLeastOneColChanged = changedCols.length > 0;
      var flexedCols = [];
      if (atLeastOneColChanged) {
        flexedCols = this.refreshFlexedColumns({ resizingCols: allResizedCols, skipSetLeft: true });
        this.setLeftValues(source);
        this.updateBodyWidths();
        this.checkViewportColumns();
      }
      var colsForEvent = allResizedCols.concat(flexedCols);
      if (atLeastOneColChanged || finished) {
        this.dispatchColumnResizedEvent(colsForEvent, finished, source, flexedCols);
      }
    };
    ColumnModel2.prototype.setColumnAggFunc = function(key, aggFunc, source) {
      if (source === void 0) {
        source = "api";
      }
      if (!key) {
        return;
      }
      var column = this.getPrimaryColumn(key);
      if (!column) {
        return;
      }
      column.setAggFunc(aggFunc);
      this.dispatchColumnChangedEvent(Events.EVENT_COLUMN_VALUE_CHANGED, [column], source);
    };
    ColumnModel2.prototype.moveRowGroupColumn = function(fromIndex, toIndex, source) {
      if (source === void 0) {
        source = "api";
      }
      var column = this.rowGroupColumns[fromIndex];
      this.rowGroupColumns.splice(fromIndex, 1);
      this.rowGroupColumns.splice(toIndex, 0, column);
      var event = {
        type: Events.EVENT_COLUMN_ROW_GROUP_CHANGED,
        columns: this.rowGroupColumns,
        column: this.rowGroupColumns.length === 1 ? this.rowGroupColumns[0] : null,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.moveColumns = function(columnsToMoveKeys, toIndex, source, finished) {
      if (source === void 0) {
        source = "api";
      }
      if (finished === void 0) {
        finished = true;
      }
      this.columnAnimationService.start();
      if (toIndex > this.gridColumns.length - columnsToMoveKeys.length) {
        console.warn("AG Grid: tried to insert columns in invalid location, toIndex = " + toIndex);
        console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");
        return;
      }
      var movedColumns = this.getGridColumns(columnsToMoveKeys);
      var failedRules = !this.doesMovePassRules(movedColumns, toIndex);
      if (failedRules) {
        return;
      }
      moveInArray(this.gridColumns, movedColumns, toIndex);
      this.updateDisplayedColumns(source);
      this.dispatchColumnMovedEvent({ movedColumns, source, toIndex, finished });
      this.columnAnimationService.finish();
    };
    ColumnModel2.prototype.doesMovePassRules = function(columnsToMove, toIndex) {
      var proposedColumnOrder = this.getProposedColumnOrder(columnsToMove, toIndex);
      return this.doesOrderPassRules(proposedColumnOrder);
    };
    ColumnModel2.prototype.doesOrderPassRules = function(gridOrder) {
      if (!this.doesMovePassMarryChildren(gridOrder)) {
        return false;
      }
      if (!this.doesMovePassLockedPositions(gridOrder)) {
        return false;
      }
      return true;
    };
    ColumnModel2.prototype.getProposedColumnOrder = function(columnsToMove, toIndex) {
      var proposedColumnOrder = this.gridColumns.slice();
      moveInArray(proposedColumnOrder, columnsToMove, toIndex);
      return proposedColumnOrder;
    };
    ColumnModel2.prototype.sortColumnsLikeGridColumns = function(cols) {
      var _this = this;
      if (!cols || cols.length <= 1) {
        return;
      }
      var notAllColsInGridColumns = cols.filter(function(c) {
        return _this.gridColumns.indexOf(c) < 0;
      }).length > 0;
      if (notAllColsInGridColumns) {
        return;
      }
      cols.sort(function(a, b) {
        var indexA = _this.gridColumns.indexOf(a);
        var indexB = _this.gridColumns.indexOf(b);
        return indexA - indexB;
      });
    };
    ColumnModel2.prototype.doesMovePassLockedPositions = function(proposedColumnOrder) {
      var lastPlacement = 0;
      var rulePassed = true;
      var lockPositionToPlacement = function(position) {
        if (!position) {
          return 1;
        }
        if (position === true) {
          return 0;
        }
        return position === "left" ? 0 : 2;
      };
      proposedColumnOrder.forEach(function(col) {
        var placement = lockPositionToPlacement(col.getColDef().lockPosition);
        if (placement < lastPlacement) {
          rulePassed = false;
        }
        lastPlacement = placement;
      });
      return rulePassed;
    };
    ColumnModel2.prototype.doesMovePassMarryChildren = function(allColumnsCopy) {
      var rulePassed = true;
      this.columnUtils.depthFirstOriginalTreeSearch(null, this.gridBalancedTree, function(child) {
        if (!(child instanceof ProvidedColumnGroup)) {
          return;
        }
        var columnGroup = child;
        var colGroupDef = columnGroup.getColGroupDef();
        var marryChildren = colGroupDef && colGroupDef.marryChildren;
        if (!marryChildren) {
          return;
        }
        var newIndexes = [];
        columnGroup.getLeafColumns().forEach(function(col) {
          var newColIndex = allColumnsCopy.indexOf(col);
          newIndexes.push(newColIndex);
        });
        var maxIndex = Math.max.apply(Math, newIndexes);
        var minIndex = Math.min.apply(Math, newIndexes);
        var spread = maxIndex - minIndex;
        var maxSpread = columnGroup.getLeafColumns().length - 1;
        if (spread > maxSpread) {
          rulePassed = false;
        }
      });
      return rulePassed;
    };
    ColumnModel2.prototype.moveColumn = function(key, toIndex, source) {
      if (source === void 0) {
        source = "api";
      }
      this.moveColumns([key], toIndex, source);
    };
    ColumnModel2.prototype.moveColumnByIndex = function(fromIndex, toIndex, source) {
      if (source === void 0) {
        source = "api";
      }
      var column = this.gridColumns[fromIndex];
      this.moveColumn(column, toIndex, source);
    };
    ColumnModel2.prototype.getColumnDefs = function() {
      var _this = this;
      if (!this.primaryColumns) {
        return;
      }
      var cols = this.primaryColumns.slice();
      if (this.gridColsArePrimary) {
        cols.sort(function(a, b) {
          return _this.gridColumns.indexOf(a) - _this.gridColumns.indexOf(b);
        });
      } else if (this.lastPrimaryOrder) {
        cols.sort(function(a, b) {
          return _this.lastPrimaryOrder.indexOf(a) - _this.lastPrimaryOrder.indexOf(b);
        });
      }
      return this.columnDefFactory.buildColumnDefs(cols, this.rowGroupColumns, this.pivotColumns);
    };
    ColumnModel2.prototype.getBodyContainerWidth = function() {
      return this.bodyWidth;
    };
    ColumnModel2.prototype.getContainerWidth = function(pinned) {
      switch (pinned) {
        case "left":
          return this.leftWidth;
        case "right":
          return this.rightWidth;
        default:
          return this.bodyWidth;
      }
    };
    ColumnModel2.prototype.updateBodyWidths = function() {
      var newBodyWidth = this.getWidthOfColsInList(this.displayedColumnsCenter);
      var newLeftWidth = this.getWidthOfColsInList(this.displayedColumnsLeft);
      var newRightWidth = this.getWidthOfColsInList(this.displayedColumnsRight);
      this.bodyWidthDirty = this.bodyWidth !== newBodyWidth;
      var atLeastOneChanged = this.bodyWidth !== newBodyWidth || this.leftWidth !== newLeftWidth || this.rightWidth !== newRightWidth;
      if (atLeastOneChanged) {
        this.bodyWidth = newBodyWidth;
        this.leftWidth = newLeftWidth;
        this.rightWidth = newRightWidth;
        var event_2 = {
          type: Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED
        };
        this.eventService.dispatchEvent(event_2);
      }
    };
    ColumnModel2.prototype.getValueColumns = function() {
      return this.valueColumns ? this.valueColumns : [];
    };
    ColumnModel2.prototype.getPivotColumns = function() {
      return this.pivotColumns ? this.pivotColumns : [];
    };
    ColumnModel2.prototype.isPivotActive = function() {
      return this.pivotColumns && this.pivotColumns.length > 0 && this.pivotMode;
    };
    ColumnModel2.prototype.getRowGroupColumns = function() {
      return this.rowGroupColumns ? this.rowGroupColumns : [];
    };
    ColumnModel2.prototype.getDisplayedCenterColumns = function() {
      return this.displayedColumnsCenter;
    };
    ColumnModel2.prototype.getDisplayedLeftColumns = function() {
      return this.displayedColumnsLeft;
    };
    ColumnModel2.prototype.getDisplayedRightColumns = function() {
      return this.displayedColumnsRight;
    };
    ColumnModel2.prototype.getDisplayedColumns = function(type) {
      switch (type) {
        case "left":
          return this.getDisplayedLeftColumns();
        case "right":
          return this.getDisplayedRightColumns();
        default:
          return this.getDisplayedCenterColumns();
      }
    };
    ColumnModel2.prototype.getAllPrimaryColumns = function() {
      return this.primaryColumns ? this.primaryColumns.slice() : null;
    };
    ColumnModel2.prototype.getSecondaryColumns = function() {
      return this.secondaryColumns ? this.secondaryColumns.slice() : null;
    };
    ColumnModel2.prototype.getAllColumnsForQuickFilter = function() {
      return this.columnsForQuickFilter;
    };
    ColumnModel2.prototype.getAllGridColumns = function() {
      return this.gridColumns;
    };
    ColumnModel2.prototype.isEmpty = function() {
      return missingOrEmpty(this.gridColumns);
    };
    ColumnModel2.prototype.isRowGroupEmpty = function() {
      return missingOrEmpty(this.rowGroupColumns);
    };
    ColumnModel2.prototype.setColumnVisible = function(key, visible, source) {
      if (source === void 0) {
        source = "api";
      }
      this.setColumnsVisible([key], visible, source);
    };
    ColumnModel2.prototype.setColumnsVisible = function(keys2, visible, source) {
      if (visible === void 0) {
        visible = false;
      }
      if (source === void 0) {
        source = "api";
      }
      this.applyColumnState({
        state: keys2.map(function(key) {
          return {
            colId: typeof key === "string" ? key : key.getColId(),
            hide: !visible
          };
        })
      }, source);
    };
    ColumnModel2.prototype.setColumnPinned = function(key, pinned, source) {
      if (source === void 0) {
        source = "api";
      }
      if (key) {
        this.setColumnsPinned([key], pinned, source);
      }
    };
    ColumnModel2.prototype.setColumnsPinned = function(keys2, pinned, source) {
      if (source === void 0) {
        source = "api";
      }
      if (this.gridOptionsService.isDomLayout("print")) {
        console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'");
        return;
      }
      this.columnAnimationService.start();
      var actualPinned;
      if (pinned === true || pinned === "left") {
        actualPinned = "left";
      } else if (pinned === "right") {
        actualPinned = "right";
      } else {
        actualPinned = null;
      }
      this.actionOnGridColumns(keys2, function(col) {
        if (col.getPinned() !== actualPinned) {
          col.setPinned(actualPinned);
          return true;
        }
        return false;
      }, source, function() {
        var event = {
          type: Events.EVENT_COLUMN_PINNED,
          pinned: actualPinned,
          column: null,
          columns: null,
          source
        };
        return event;
      });
      this.columnAnimationService.finish();
    };
    ColumnModel2.prototype.actionOnGridColumns = function(keys2, action, source, createEvent) {
      var _this = this;
      if (missingOrEmpty(keys2)) {
        return;
      }
      var updatedColumns = [];
      keys2.forEach(function(key) {
        var column = _this.getGridColumn(key);
        if (!column) {
          return;
        }
        var resultOfAction = action(column);
        if (resultOfAction !== false) {
          updatedColumns.push(column);
        }
      });
      if (!updatedColumns.length) {
        return;
      }
      this.updateDisplayedColumns(source);
      if (exists(createEvent) && createEvent) {
        var event_3 = createEvent();
        event_3.columns = updatedColumns;
        event_3.column = updatedColumns.length === 1 ? updatedColumns[0] : null;
        this.eventService.dispatchEvent(event_3);
      }
    };
    ColumnModel2.prototype.getDisplayedColBefore = function(col) {
      var allDisplayedColumns = this.getAllDisplayedColumns();
      var oldIndex = allDisplayedColumns.indexOf(col);
      if (oldIndex > 0) {
        return allDisplayedColumns[oldIndex - 1];
      }
      return null;
    };
    ColumnModel2.prototype.getDisplayedColAfter = function(col) {
      var allDisplayedColumns = this.getAllDisplayedColumns();
      var oldIndex = allDisplayedColumns.indexOf(col);
      if (oldIndex < allDisplayedColumns.length - 1) {
        return allDisplayedColumns[oldIndex + 1];
      }
      return null;
    };
    ColumnModel2.prototype.getDisplayedGroupAfter = function(columnGroup) {
      return this.getDisplayedGroupAtDirection(columnGroup, "After");
    };
    ColumnModel2.prototype.getDisplayedGroupBefore = function(columnGroup) {
      return this.getDisplayedGroupAtDirection(columnGroup, "Before");
    };
    ColumnModel2.prototype.getDisplayedGroupAtDirection = function(columnGroup, direction) {
      var requiredLevel = columnGroup.getProvidedColumnGroup().getLevel() + columnGroup.getPaddingLevel();
      var colGroupLeafColumns = columnGroup.getDisplayedLeafColumns();
      var col = direction === "After" ? last(colGroupLeafColumns) : colGroupLeafColumns[0];
      var getDisplayColMethod = "getDisplayedCol" + direction;
      while (true) {
        var column = this[getDisplayColMethod](col);
        if (!column) {
          return null;
        }
        var groupPointer = this.getColumnGroupAtLevel(column, requiredLevel);
        if (groupPointer !== columnGroup) {
          return groupPointer;
        }
      }
    };
    ColumnModel2.prototype.getColumnGroupAtLevel = function(column, level) {
      var groupPointer = column.getParent();
      var originalGroupLevel;
      var groupPointerLevel;
      while (true) {
        var groupPointerProvidedColumnGroup = groupPointer.getProvidedColumnGroup();
        originalGroupLevel = groupPointerProvidedColumnGroup.getLevel();
        groupPointerLevel = groupPointer.getPaddingLevel();
        if (originalGroupLevel + groupPointerLevel <= level) {
          break;
        }
        groupPointer = groupPointer.getParent();
      }
      return groupPointer;
    };
    ColumnModel2.prototype.isPinningLeft = function() {
      return this.displayedColumnsLeft.length > 0;
    };
    ColumnModel2.prototype.isPinningRight = function() {
      return this.displayedColumnsRight.length > 0;
    };
    ColumnModel2.prototype.getPrimaryAndSecondaryAndAutoColumns = function() {
      var _a2;
      return (_a2 = []).concat.apply(_a2, [
        this.primaryColumns || [],
        this.groupAutoColumns || [],
        this.secondaryColumns || []
      ]);
    };
    ColumnModel2.prototype.createStateItemFromColumn = function(column) {
      var rowGroupIndex = column.isRowGroupActive() ? this.rowGroupColumns.indexOf(column) : null;
      var pivotIndex = column.isPivotActive() ? this.pivotColumns.indexOf(column) : null;
      var aggFunc = column.isValueActive() ? column.getAggFunc() : null;
      var sort = column.getSort() != null ? column.getSort() : null;
      var sortIndex = column.getSortIndex() != null ? column.getSortIndex() : null;
      var flex = column.getFlex() != null && column.getFlex() > 0 ? column.getFlex() : null;
      var res = {
        colId: column.getColId(),
        width: column.getActualWidth(),
        hide: !column.isVisible(),
        pinned: column.getPinned(),
        sort,
        sortIndex,
        aggFunc,
        rowGroup: column.isRowGroupActive(),
        rowGroupIndex,
        pivot: column.isPivotActive(),
        pivotIndex,
        flex
      };
      return res;
    };
    ColumnModel2.prototype.getColumnState = function() {
      if (missing(this.primaryColumns) || !this.isAlive()) {
        return [];
      }
      var colsForState = this.getPrimaryAndSecondaryAndAutoColumns();
      var res = colsForState.map(this.createStateItemFromColumn.bind(this));
      this.orderColumnStateList(res);
      return res;
    };
    ColumnModel2.prototype.orderColumnStateList = function(columnStateList) {
      var colIdToGridIndexMap = convertToMap(this.gridColumns.map(function(col, index2) {
        return [col.getColId(), index2];
      }));
      columnStateList.sort(function(itemA, itemB) {
        var posA = colIdToGridIndexMap.has(itemA.colId) ? colIdToGridIndexMap.get(itemA.colId) : -1;
        var posB = colIdToGridIndexMap.has(itemB.colId) ? colIdToGridIndexMap.get(itemB.colId) : -1;
        return posA - posB;
      });
    };
    ColumnModel2.prototype.resetColumnState = function(source) {
      var _this = this;
      if (source === void 0) {
        source = "api";
      }
      var primaryColumns = this.getColumnsFromTree(this.primaryColumnTree);
      var columnStates = [];
      var letRowGroupIndex = 1e3;
      var letPivotIndex = 1e3;
      var colsToProcess = [];
      if (this.groupAutoColumns) {
        colsToProcess = colsToProcess.concat(this.groupAutoColumns);
      }
      if (primaryColumns) {
        colsToProcess = colsToProcess.concat(primaryColumns);
      }
      colsToProcess.forEach(function(column) {
        var stateItem = _this.getColumnStateFromColDef(column);
        if (missing(stateItem.rowGroupIndex) && stateItem.rowGroup) {
          stateItem.rowGroupIndex = letRowGroupIndex++;
        }
        if (missing(stateItem.pivotIndex) && stateItem.pivot) {
          stateItem.pivotIndex = letPivotIndex++;
        }
        columnStates.push(stateItem);
      });
      this.applyColumnState({ state: columnStates, applyOrder: true }, source);
    };
    ColumnModel2.prototype.getColumnStateFromColDef = function(column) {
      var getValueOrNull = function(a, b) {
        return a != null ? a : b != null ? b : null;
      };
      var colDef = column.getColDef();
      var sort = getValueOrNull(colDef.sort, colDef.initialSort);
      var sortIndex = getValueOrNull(colDef.sortIndex, colDef.initialSortIndex);
      var hide = getValueOrNull(colDef.hide, colDef.initialHide);
      var pinned = getValueOrNull(colDef.pinned, colDef.initialPinned);
      var width = getValueOrNull(colDef.width, colDef.initialWidth);
      var flex = getValueOrNull(colDef.flex, colDef.initialFlex);
      var rowGroupIndex = getValueOrNull(colDef.rowGroupIndex, colDef.initialRowGroupIndex);
      var rowGroup = getValueOrNull(colDef.rowGroup, colDef.initialRowGroup);
      if (rowGroupIndex == null && (rowGroup == null || rowGroup == false)) {
        rowGroupIndex = null;
        rowGroup = null;
      }
      var pivotIndex = getValueOrNull(colDef.pivotIndex, colDef.initialPivotIndex);
      var pivot = getValueOrNull(colDef.pivot, colDef.initialPivot);
      if (pivotIndex == null && (pivot == null || pivot == false)) {
        pivotIndex = null;
        pivot = null;
      }
      var aggFunc = getValueOrNull(colDef.aggFunc, colDef.initialAggFunc);
      return {
        colId: column.getColId(),
        sort,
        sortIndex,
        hide,
        pinned,
        width,
        flex,
        rowGroup,
        rowGroupIndex,
        pivot,
        pivotIndex,
        aggFunc
      };
    };
    ColumnModel2.prototype.applyColumnState = function(params, source) {
      var _this = this;
      if (missingOrEmpty(this.primaryColumns)) {
        return false;
      }
      if (params && params.state && !params.state.forEach) {
        console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.");
        return false;
      }
      var applyStates = function(states, existingColumns, getById) {
        var dispatchEventsFunc = _this.compareColumnStatesAndDispatchEvents(source);
        _this.autoGroupsNeedBuilding = true;
        var columnsWithNoState = existingColumns.slice();
        var rowGroupIndexes = {};
        var pivotIndexes = {};
        var autoGroupColumnStates = [];
        var unmatchedAndAutoStates2 = [];
        var unmatchedCount2 = 0;
        var previousRowGroupCols = _this.rowGroupColumns.slice();
        var previousPivotCols = _this.pivotColumns.slice();
        states.forEach(function(state) {
          var colId = state.colId || "";
          var isAutoGroupColumn = colId.startsWith(GROUP_AUTO_COLUMN_ID);
          if (isAutoGroupColumn) {
            autoGroupColumnStates.push(state);
            unmatchedAndAutoStates2.push(state);
            return;
          }
          var column = getById(colId);
          if (!column) {
            unmatchedAndAutoStates2.push(state);
            unmatchedCount2 += 1;
          } else {
            _this.syncColumnWithStateItem(column, state, params.defaultState, rowGroupIndexes, pivotIndexes, false, source);
            removeFromArray(columnsWithNoState, column);
          }
        });
        var applyDefaultsFunc = function(col) {
          return _this.syncColumnWithStateItem(col, null, params.defaultState, rowGroupIndexes, pivotIndexes, false, source);
        };
        columnsWithNoState.forEach(applyDefaultsFunc);
        var comparator = function(indexes, oldList, colA, colB) {
          var indexA = indexes[colA.getId()];
          var indexB = indexes[colB.getId()];
          var aHasIndex = indexA != null;
          var bHasIndex = indexB != null;
          if (aHasIndex && bHasIndex) {
            return indexA - indexB;
          }
          if (aHasIndex) {
            return -1;
          }
          if (bHasIndex) {
            return 1;
          }
          var oldIndexA = oldList.indexOf(colA);
          var oldIndexB = oldList.indexOf(colB);
          var aHasOldIndex = oldIndexA >= 0;
          var bHasOldIndex = oldIndexB >= 0;
          if (aHasOldIndex && bHasOldIndex) {
            return oldIndexA - oldIndexB;
          }
          if (aHasOldIndex) {
            return -1;
          }
          return 1;
        };
        _this.rowGroupColumns.sort(comparator.bind(_this, rowGroupIndexes, previousRowGroupCols));
        _this.pivotColumns.sort(comparator.bind(_this, pivotIndexes, previousPivotCols));
        _this.updateGridColumns();
        var autoGroupColsCopy = _this.groupAutoColumns ? _this.groupAutoColumns.slice() : [];
        autoGroupColumnStates.forEach(function(stateItem) {
          var autoCol = _this.getAutoColumn(stateItem.colId);
          removeFromArray(autoGroupColsCopy, autoCol);
          _this.syncColumnWithStateItem(autoCol, stateItem, params.defaultState, null, null, true, source);
        });
        autoGroupColsCopy.forEach(applyDefaultsFunc);
        _this.applyOrderAfterApplyState(params);
        _this.updateDisplayedColumns(source);
        _this.dispatchEverythingChanged(source);
        dispatchEventsFunc();
        return { unmatchedAndAutoStates: unmatchedAndAutoStates2, unmatchedCount: unmatchedCount2 };
      };
      this.columnAnimationService.start();
      var _a2 = applyStates(params.state || [], this.primaryColumns || [], function(id2) {
        return _this.getPrimaryColumn(id2);
      }), unmatchedAndAutoStates = _a2.unmatchedAndAutoStates, unmatchedCount = _a2.unmatchedCount;
      if (unmatchedAndAutoStates.length > 0 || exists(params.defaultState)) {
        unmatchedCount = applyStates(unmatchedAndAutoStates, this.secondaryColumns || [], function(id2) {
          return _this.getSecondaryColumn(id2);
        }).unmatchedCount;
      }
      this.columnAnimationService.finish();
      return unmatchedCount === 0;
    };
    ColumnModel2.prototype.applyOrderAfterApplyState = function(params) {
      var _this = this;
      if (!params.applyOrder || !params.state) {
        return;
      }
      var newOrder = [];
      var processedColIds = {};
      params.state.forEach(function(item) {
        if (!item.colId || processedColIds[item.colId]) {
          return;
        }
        var col = _this.gridColumnsMap[item.colId];
        if (col) {
          newOrder.push(col);
          processedColIds[item.colId] = true;
        }
      });
      var autoGroupInsertIndex = 0;
      this.gridColumns.forEach(function(col) {
        var colId = col.getColId();
        var alreadyProcessed = processedColIds[colId] != null;
        if (alreadyProcessed) {
          return;
        }
        var isAutoGroupCol = colId.startsWith(GROUP_AUTO_COLUMN_ID);
        if (isAutoGroupCol) {
          insertIntoArray(newOrder, col, autoGroupInsertIndex++);
        } else {
          newOrder.push(col);
        }
      });
      newOrder = this.placeLockedColumns(newOrder);
      if (!this.doesMovePassMarryChildren(newOrder)) {
        console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.");
        return;
      }
      this.gridColumns = newOrder;
    };
    ColumnModel2.prototype.compareColumnStatesAndDispatchEvents = function(source) {
      var _this = this;
      var startState = {
        rowGroupColumns: this.rowGroupColumns.slice(),
        pivotColumns: this.pivotColumns.slice(),
        valueColumns: this.valueColumns.slice()
      };
      var columnStateBefore = this.getColumnState();
      var columnStateBeforeMap = {};
      columnStateBefore.forEach(function(col) {
        columnStateBeforeMap[col.colId] = col;
      });
      return function() {
        var colsForState = _this.getPrimaryAndSecondaryAndAutoColumns();
        var dispatchWhenListsDifferent = function(eventType, colsBefore, colsAfter, idMapper) {
          var beforeList = colsBefore.map(idMapper);
          var afterList = colsAfter.map(idMapper);
          var unchanged = areEqual(beforeList, afterList);
          if (unchanged) {
            return;
          }
          var event = {
            type: eventType,
            columns: colsAfter,
            column: colsAfter.length === 1 ? colsAfter[0] : null,
            source
          };
          _this.eventService.dispatchEvent(event);
        };
        var getChangedColumns = function(changedPredicate) {
          var changedColumns = [];
          colsForState.forEach(function(column) {
            var colStateBefore = columnStateBeforeMap[column.getColId()];
            if (colStateBefore && changedPredicate(colStateBefore, column)) {
              changedColumns.push(column);
            }
          });
          return changedColumns;
        };
        var columnIdMapper = function(c) {
          return c.getColId();
        };
        dispatchWhenListsDifferent(Events.EVENT_COLUMN_ROW_GROUP_CHANGED, startState.rowGroupColumns, _this.rowGroupColumns, columnIdMapper);
        dispatchWhenListsDifferent(Events.EVENT_COLUMN_PIVOT_CHANGED, startState.pivotColumns, _this.pivotColumns, columnIdMapper);
        var valueChangePredicate = function(cs, c) {
          var oldActive = cs.aggFunc != null;
          var activeChanged = oldActive != c.isValueActive();
          var aggFuncChanged = oldActive && cs.aggFunc != c.getAggFunc();
          return activeChanged || aggFuncChanged;
        };
        var changedValues = getChangedColumns(valueChangePredicate);
        if (changedValues.length > 0) {
          _this.dispatchColumnChangedEvent(Events.EVENT_COLUMN_VALUE_CHANGED, _this.valueColumns, source);
        }
        var resizeChangePredicate = function(cs, c) {
          return cs.width != c.getActualWidth();
        };
        _this.dispatchColumnResizedEvent(getChangedColumns(resizeChangePredicate), true, source);
        var pinnedChangePredicate = function(cs, c) {
          return cs.pinned != c.getPinned();
        };
        _this.dispatchColumnPinnedEvent(getChangedColumns(pinnedChangePredicate), source);
        var visibilityChangePredicate = function(cs, c) {
          return cs.hide == c.isVisible();
        };
        _this.dispatchColumnVisibleEvent(getChangedColumns(visibilityChangePredicate), source);
        var sortChangePredicate = function(cs, c) {
          return cs.sort != c.getSort() || cs.sortIndex != c.getSortIndex();
        };
        if (getChangedColumns(sortChangePredicate).length > 0) {
          _this.sortController.dispatchSortChangedEvents(source);
        }
        _this.normaliseColumnMovedEventForColumnState(columnStateBefore, source);
      };
    };
    ColumnModel2.prototype.getCommonValue = function(cols, valueGetter) {
      if (!cols || cols.length == 0) {
        return void 0;
      }
      var firstValue = valueGetter(cols[0]);
      for (var i = 1; i < cols.length; i++) {
        if (firstValue !== valueGetter(cols[i])) {
          return void 0;
        }
      }
      return firstValue;
    };
    ColumnModel2.prototype.normaliseColumnMovedEventForColumnState = function(colStateBefore, source) {
      var _this = this;
      var colStateAfter = this.getColumnState();
      var colStateAfterMapped = {};
      colStateAfter.forEach(function(s2) {
        return colStateAfterMapped[s2.colId] = s2;
      });
      var colsIntersectIds = {};
      colStateBefore.forEach(function(s2) {
        if (colStateAfterMapped[s2.colId]) {
          colsIntersectIds[s2.colId] = true;
        }
      });
      var beforeFiltered = colStateBefore.filter(function(c) {
        return colsIntersectIds[c.colId];
      });
      var afterFiltered = colStateAfter.filter(function(c) {
        return colsIntersectIds[c.colId];
      });
      var movedColumns = [];
      afterFiltered.forEach(function(csAfter, index2) {
        var csBefore = beforeFiltered && beforeFiltered[index2];
        if (csBefore && csBefore.colId !== csAfter.colId) {
          var gridCol = _this.getGridColumn(csBefore.colId);
          if (gridCol) {
            movedColumns.push(gridCol);
          }
        }
      });
      if (!movedColumns.length) {
        return;
      }
      this.dispatchColumnMovedEvent({ movedColumns, source, finished: true });
    };
    ColumnModel2.prototype.syncColumnWithStateItem = function(column, stateItem, defaultState, rowGroupIndexes, pivotIndexes, autoCol, source) {
      if (!column) {
        return;
      }
      var getValue = function(key1, key2) {
        var obj = { value1: void 0, value2: void 0 };
        var calculated = false;
        if (stateItem) {
          if (stateItem[key1] !== void 0) {
            obj.value1 = stateItem[key1];
            calculated = true;
          }
          if (exists(key2) && stateItem[key2] !== void 0) {
            obj.value2 = stateItem[key2];
            calculated = true;
          }
        }
        if (!calculated && defaultState) {
          if (defaultState[key1] !== void 0) {
            obj.value1 = defaultState[key1];
          }
          if (exists(key2) && defaultState[key2] !== void 0) {
            obj.value2 = defaultState[key2];
          }
        }
        return obj;
      };
      var hide = getValue("hide").value1;
      if (hide !== void 0) {
        column.setVisible(!hide, source);
      }
      var pinned = getValue("pinned").value1;
      if (pinned !== void 0) {
        column.setPinned(pinned);
      }
      var minColWidth = this.columnUtils.calculateColMinWidth(column.getColDef());
      var flex = getValue("flex").value1;
      if (flex !== void 0) {
        column.setFlex(flex);
      }
      var noFlexThisCol = column.getFlex() <= 0;
      if (noFlexThisCol) {
        var width = getValue("width").value1;
        if (width != null) {
          if (minColWidth != null && width >= minColWidth) {
            column.setActualWidth(width, source);
          }
        }
      }
      var sort = getValue("sort").value1;
      if (sort !== void 0) {
        if (sort === "desc" || sort === "asc") {
          column.setSort(sort, source);
        } else {
          column.setSort(void 0, source);
        }
      }
      var sortIndex = getValue("sortIndex").value1;
      if (sortIndex !== void 0) {
        column.setSortIndex(sortIndex);
      }
      if (autoCol || !column.isPrimary()) {
        return;
      }
      var aggFunc = getValue("aggFunc").value1;
      if (aggFunc !== void 0) {
        if (typeof aggFunc === "string") {
          column.setAggFunc(aggFunc);
          if (!column.isValueActive()) {
            column.setValueActive(true, source);
            this.valueColumns.push(column);
          }
        } else {
          if (exists(aggFunc)) {
            console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.");
          }
          if (column.isValueActive()) {
            column.setValueActive(false, source);
            removeFromArray(this.valueColumns, column);
          }
        }
      }
      var _a2 = getValue("rowGroup", "rowGroupIndex"), rowGroup = _a2.value1, rowGroupIndex = _a2.value2;
      if (rowGroup !== void 0 || rowGroupIndex !== void 0) {
        if (typeof rowGroupIndex === "number" || rowGroup) {
          if (!column.isRowGroupActive()) {
            column.setRowGroupActive(true, source);
            this.rowGroupColumns.push(column);
          }
          if (rowGroupIndexes && typeof rowGroupIndex === "number") {
            rowGroupIndexes[column.getId()] = rowGroupIndex;
          }
        } else {
          if (column.isRowGroupActive()) {
            column.setRowGroupActive(false, source);
            removeFromArray(this.rowGroupColumns, column);
          }
        }
      }
      var _b2 = getValue("pivot", "pivotIndex"), pivot = _b2.value1, pivotIndex = _b2.value2;
      if (pivot !== void 0 || pivotIndex !== void 0) {
        if (typeof pivotIndex === "number" || pivot) {
          if (!column.isPivotActive()) {
            column.setPivotActive(true, source);
            this.pivotColumns.push(column);
          }
          if (pivotIndexes && typeof pivotIndex === "number") {
            pivotIndexes[column.getId()] = pivotIndex;
          }
        } else {
          if (column.isPivotActive()) {
            column.setPivotActive(false, source);
            removeFromArray(this.pivotColumns, column);
          }
        }
      }
    };
    ColumnModel2.prototype.getGridColumns = function(keys2) {
      return this.getColumns(keys2, this.getGridColumn.bind(this));
    };
    ColumnModel2.prototype.getColumns = function(keys2, columnLookupCallback) {
      var foundColumns = [];
      if (keys2) {
        keys2.forEach(function(key) {
          var column = columnLookupCallback(key);
          if (column) {
            foundColumns.push(column);
          }
        });
      }
      return foundColumns;
    };
    ColumnModel2.prototype.getColumnWithValidation = function(key) {
      if (key == null) {
        return null;
      }
      var column = this.getGridColumn(key);
      if (!column) {
        console.warn("AG Grid: could not find column " + key);
      }
      return column;
    };
    ColumnModel2.prototype.getPrimaryColumn = function(key) {
      if (!this.primaryColumns) {
        return null;
      }
      return this.getColumn(key, this.primaryColumns, this.primaryColumnsMap);
    };
    ColumnModel2.prototype.getGridColumn = function(key) {
      return this.getColumn(key, this.gridColumns, this.gridColumnsMap);
    };
    ColumnModel2.prototype.getSecondaryColumn = function(key) {
      if (!this.secondaryColumns) {
        return null;
      }
      return this.getColumn(key, this.secondaryColumns, this.secondaryColumnsMap);
    };
    ColumnModel2.prototype.getColumn = function(key, columnList, columnMap) {
      if (!key) {
        return null;
      }
      if (typeof key == "string" && columnMap[key]) {
        return columnMap[key];
      }
      for (var i = 0; i < columnList.length; i++) {
        if (this.columnsMatch(columnList[i], key)) {
          return columnList[i];
        }
      }
      return this.getAutoColumn(key);
    };
    ColumnModel2.prototype.getSourceColumnsForGroupColumn = function(groupCol) {
      var sourceColumnId = groupCol.getColDef().showRowGroup;
      if (!sourceColumnId) {
        return null;
      }
      if (sourceColumnId === true) {
        return this.rowGroupColumns.slice(0);
      }
      var column = this.getPrimaryColumn(sourceColumnId);
      return column ? [column] : null;
    };
    ColumnModel2.prototype.getAutoColumn = function(key) {
      var _this = this;
      if (!this.groupAutoColumns || !exists(this.groupAutoColumns) || missing(this.groupAutoColumns)) {
        return null;
      }
      return this.groupAutoColumns.find(function(groupCol) {
        return _this.columnsMatch(groupCol, key);
      }) || null;
    };
    ColumnModel2.prototype.columnsMatch = function(column, key) {
      var columnMatches = column === key;
      var colDefMatches = column.getColDef() === key;
      var idMatches = column.getColId() == key;
      return columnMatches || colDefMatches || idMatches;
    };
    ColumnModel2.prototype.getDisplayNameForColumn = function(column, location, includeAggFunc) {
      if (includeAggFunc === void 0) {
        includeAggFunc = false;
      }
      if (!column) {
        return null;
      }
      var headerName = this.getHeaderName(column.getColDef(), column, null, null, location);
      if (includeAggFunc) {
        return this.wrapHeaderNameWithAggFunc(column, headerName);
      }
      return headerName;
    };
    ColumnModel2.prototype.getDisplayNameForProvidedColumnGroup = function(columnGroup, providedColumnGroup, location) {
      var colGroupDef = providedColumnGroup ? providedColumnGroup.getColGroupDef() : null;
      if (colGroupDef) {
        return this.getHeaderName(colGroupDef, null, columnGroup, providedColumnGroup, location);
      }
      return null;
    };
    ColumnModel2.prototype.getDisplayNameForColumnGroup = function(columnGroup, location) {
      return this.getDisplayNameForProvidedColumnGroup(columnGroup, columnGroup.getProvidedColumnGroup(), location);
    };
    ColumnModel2.prototype.getHeaderName = function(colDef, column, columnGroup, providedColumnGroup, location) {
      var headerValueGetter = colDef.headerValueGetter;
      if (headerValueGetter) {
        var params = {
          colDef,
          column,
          columnGroup,
          providedColumnGroup,
          location,
          api: this.gridOptionsService.api,
          columnApi: this.gridOptionsService.columnApi,
          context: this.gridOptionsService.context
        };
        if (typeof headerValueGetter === "function") {
          return headerValueGetter(params);
        } else if (typeof headerValueGetter === "string") {
          return this.expressionService.evaluate(headerValueGetter, params);
        }
        console.warn("AG Grid: headerValueGetter must be a function or a string");
        return "";
      } else if (colDef.headerName != null) {
        return colDef.headerName;
      } else if (colDef.field) {
        return camelCaseToHumanText(colDef.field);
      }
      return "";
    };
    ColumnModel2.prototype.wrapHeaderNameWithAggFunc = function(column, headerName) {
      if (this.gridOptionsService.is("suppressAggFuncInHeader")) {
        return headerName;
      }
      var pivotValueColumn = column.getColDef().pivotValueColumn;
      var pivotActiveOnThisColumn = exists(pivotValueColumn);
      var aggFunc = null;
      var aggFuncFound;
      if (pivotActiveOnThisColumn) {
        var isCollapsedHeaderEnabled = this.gridOptionsService.is("removePivotHeaderRowWhenSingleValueColumn") && this.valueColumns.length === 1;
        var isTotalColumn = column.getColDef().pivotTotalColumnIds !== void 0;
        if (isCollapsedHeaderEnabled && !isTotalColumn) {
          return headerName;
        }
        aggFunc = pivotValueColumn ? pivotValueColumn.getAggFunc() : null;
        aggFuncFound = true;
      } else {
        var measureActive = column.isValueActive();
        var aggregationPresent = this.pivotMode || !this.isRowGroupEmpty();
        if (measureActive && aggregationPresent) {
          aggFunc = column.getAggFunc();
          aggFuncFound = true;
        } else {
          aggFuncFound = false;
        }
      }
      if (aggFuncFound) {
        var aggFuncString = typeof aggFunc === "string" ? aggFunc : "func";
        var localeTextFunc = this.localeService.getLocaleTextFunc();
        var aggFuncStringTranslated = localeTextFunc(aggFuncString, aggFuncString);
        return aggFuncStringTranslated + "(" + headerName + ")";
      }
      return headerName;
    };
    ColumnModel2.prototype.getColumnGroup = function(colId, partId) {
      if (!colId) {
        return null;
      }
      if (colId instanceof ColumnGroup) {
        return colId;
      }
      var allColumnGroups = this.getAllDisplayedTrees();
      var checkPartId = typeof partId === "number";
      var result = null;
      this.columnUtils.depthFirstAllColumnTreeSearch(allColumnGroups, function(child) {
        if (child instanceof ColumnGroup) {
          var columnGroup = child;
          var matched = void 0;
          if (checkPartId) {
            matched = colId === columnGroup.getGroupId() && partId === columnGroup.getPartId();
          } else {
            matched = colId === columnGroup.getGroupId();
          }
          if (matched) {
            result = columnGroup;
          }
        }
      });
      return result;
    };
    ColumnModel2.prototype.isReady = function() {
      return this.ready;
    };
    ColumnModel2.prototype.extractValueColumns = function(source, oldPrimaryColumns) {
      this.valueColumns = this.extractColumns(
        oldPrimaryColumns,
        this.valueColumns,
        function(col, flag) {
          return col.setValueActive(flag, source);
        },
        // aggFunc doesn't have index variant, cos order of value cols doesn't matter, so always return null
        function() {
          return void 0;
        },
        function() {
          return void 0;
        },
        // aggFunc is a string, so return it's existence
        function(colDef) {
          var aggFunc = colDef.aggFunc;
          if (aggFunc === null || aggFunc === "") {
            return null;
          }
          if (aggFunc === void 0) {
            return;
          }
          return !!aggFunc;
        },
        function(colDef) {
          return colDef.initialAggFunc != null && colDef.initialAggFunc != "";
        }
      );
      this.valueColumns.forEach(function(col) {
        var colDef = col.getColDef();
        if (colDef.aggFunc != null && colDef.aggFunc != "") {
          col.setAggFunc(colDef.aggFunc);
        } else {
          if (!col.getAggFunc()) {
            col.setAggFunc(colDef.initialAggFunc);
          }
        }
      });
    };
    ColumnModel2.prototype.extractRowGroupColumns = function(source, oldPrimaryColumns) {
      this.rowGroupColumns = this.extractColumns(oldPrimaryColumns, this.rowGroupColumns, function(col, flag) {
        return col.setRowGroupActive(flag, source);
      }, function(colDef) {
        return colDef.rowGroupIndex;
      }, function(colDef) {
        return colDef.initialRowGroupIndex;
      }, function(colDef) {
        return colDef.rowGroup;
      }, function(colDef) {
        return colDef.initialRowGroup;
      });
    };
    ColumnModel2.prototype.extractColumns = function(oldPrimaryColumns, previousCols, setFlagFunc, getIndexFunc, getInitialIndexFunc, getValueFunc, getInitialValueFunc) {
      if (oldPrimaryColumns === void 0) {
        oldPrimaryColumns = [];
      }
      if (previousCols === void 0) {
        previousCols = [];
      }
      var colsWithIndex = [];
      var colsWithValue = [];
      (this.primaryColumns || []).forEach(function(col) {
        var colIsNew = oldPrimaryColumns.indexOf(col) < 0;
        var colDef = col.getColDef();
        var value = attrToBoolean(getValueFunc(colDef));
        var initialValue = attrToBoolean(getInitialValueFunc(colDef));
        var index2 = attrToNumber(getIndexFunc(colDef));
        var initialIndex = attrToNumber(getInitialIndexFunc(colDef));
        var include;
        var valuePresent = value !== void 0;
        var indexPresent = index2 !== void 0;
        var initialValuePresent = initialValue !== void 0;
        var initialIndexPresent = initialIndex !== void 0;
        if (valuePresent) {
          include = value;
        } else if (indexPresent) {
          if (index2 === null) {
            include = false;
          } else {
            include = index2 >= 0;
          }
        } else {
          if (colIsNew) {
            if (initialValuePresent) {
              include = initialValue;
            } else if (initialIndexPresent) {
              include = initialIndex != null && initialIndex >= 0;
            } else {
              include = false;
            }
          } else {
            include = previousCols.indexOf(col) >= 0;
          }
        }
        if (include) {
          var useIndex = colIsNew ? index2 != null || initialIndex != null : index2 != null;
          useIndex ? colsWithIndex.push(col) : colsWithValue.push(col);
        }
      });
      var getIndexForCol = function(col) {
        var index2 = getIndexFunc(col.getColDef());
        var defaultIndex = getInitialIndexFunc(col.getColDef());
        return index2 != null ? index2 : defaultIndex;
      };
      colsWithIndex.sort(function(colA, colB) {
        var indexA = getIndexForCol(colA);
        var indexB = getIndexForCol(colB);
        if (indexA === indexB) {
          return 0;
        }
        if (indexA < indexB) {
          return -1;
        }
        return 1;
      });
      var res = [].concat(colsWithIndex);
      previousCols.forEach(function(col) {
        if (colsWithValue.indexOf(col) >= 0) {
          res.push(col);
        }
      });
      colsWithValue.forEach(function(col) {
        if (res.indexOf(col) < 0) {
          res.push(col);
        }
      });
      previousCols.forEach(function(col) {
        if (res.indexOf(col) < 0) {
          setFlagFunc(col, false);
        }
      });
      res.forEach(function(col) {
        if (previousCols.indexOf(col) < 0) {
          setFlagFunc(col, true);
        }
      });
      return res;
    };
    ColumnModel2.prototype.extractPivotColumns = function(source, oldPrimaryColumns) {
      this.pivotColumns = this.extractColumns(oldPrimaryColumns, this.pivotColumns, function(col, flag) {
        return col.setPivotActive(flag, source);
      }, function(colDef) {
        return colDef.pivotIndex;
      }, function(colDef) {
        return colDef.initialPivotIndex;
      }, function(colDef) {
        return colDef.pivot;
      }, function(colDef) {
        return colDef.initialPivot;
      });
    };
    ColumnModel2.prototype.resetColumnGroupState = function(source) {
      if (source === void 0) {
        source = "api";
      }
      var stateItems = [];
      this.columnUtils.depthFirstOriginalTreeSearch(null, this.primaryColumnTree, function(child) {
        if (child instanceof ProvidedColumnGroup) {
          var colGroupDef = child.getColGroupDef();
          var groupState = {
            groupId: child.getGroupId(),
            open: !colGroupDef ? void 0 : colGroupDef.openByDefault
          };
          stateItems.push(groupState);
        }
      });
      this.setColumnGroupState(stateItems, source);
    };
    ColumnModel2.prototype.getColumnGroupState = function() {
      var columnGroupState = [];
      this.columnUtils.depthFirstOriginalTreeSearch(null, this.gridBalancedTree, function(node) {
        if (node instanceof ProvidedColumnGroup) {
          columnGroupState.push({
            groupId: node.getGroupId(),
            open: node.isExpanded()
          });
        }
      });
      return columnGroupState;
    };
    ColumnModel2.prototype.setColumnGroupState = function(stateItems, source) {
      var _this = this;
      if (source === void 0) {
        source = "api";
      }
      this.columnAnimationService.start();
      var impactedGroups = [];
      stateItems.forEach(function(stateItem) {
        var groupKey = stateItem.groupId;
        var newValue = stateItem.open;
        var providedColumnGroup = _this.getProvidedColumnGroup(groupKey);
        if (!providedColumnGroup) {
          return;
        }
        if (providedColumnGroup.isExpanded() === newValue) {
          return;
        }
        _this.logger.log("columnGroupOpened(" + providedColumnGroup.getGroupId() + "," + newValue + ")");
        providedColumnGroup.setExpanded(newValue);
        impactedGroups.push(providedColumnGroup);
      });
      this.updateGroupsAndDisplayedColumns(source);
      this.setFirstRightAndLastLeftPinned(source);
      impactedGroups.forEach(function(providedColumnGroup) {
        var event = {
          type: Events.EVENT_COLUMN_GROUP_OPENED,
          columnGroup: providedColumnGroup
        };
        _this.eventService.dispatchEvent(event);
      });
      this.columnAnimationService.finish();
    };
    ColumnModel2.prototype.setColumnGroupOpened = function(key, newValue, source) {
      if (source === void 0) {
        source = "api";
      }
      var keyAsString;
      if (key instanceof ProvidedColumnGroup) {
        keyAsString = key.getId();
      } else {
        keyAsString = key || "";
      }
      this.setColumnGroupState([{ groupId: keyAsString, open: newValue }], source);
    };
    ColumnModel2.prototype.getProvidedColumnGroup = function(key) {
      if (typeof key !== "string") {
        console.error("AG Grid: group key must be a string");
      }
      var res = null;
      this.columnUtils.depthFirstOriginalTreeSearch(null, this.gridBalancedTree, function(node) {
        if (node instanceof ProvidedColumnGroup) {
          if (node.getId() === key) {
            res = node;
          }
        }
      });
      return res;
    };
    ColumnModel2.prototype.calculateColumnsForDisplay = function() {
      var _this = this;
      var columnsForDisplay;
      if (this.pivotMode && missing(this.secondaryColumns)) {
        columnsForDisplay = this.gridColumns.filter(function(column) {
          var isAutoGroupCol = _this.groupAutoColumns && includes(_this.groupAutoColumns, column);
          var isValueCol = _this.valueColumns && includes(_this.valueColumns, column);
          return isAutoGroupCol || isValueCol;
        });
      } else {
        columnsForDisplay = this.gridColumns.filter(function(column) {
          var isAutoGroupCol = _this.groupAutoColumns && includes(_this.groupAutoColumns, column);
          return isAutoGroupCol || column.isVisible();
        });
      }
      return columnsForDisplay;
    };
    ColumnModel2.prototype.checkColSpanActiveInCols = function(columns) {
      var result = false;
      columns.forEach(function(col) {
        if (exists(col.getColDef().colSpan)) {
          result = true;
        }
      });
      return result;
    };
    ColumnModel2.prototype.calculateColumnsForGroupDisplay = function() {
      var _this = this;
      this.groupDisplayColumns = [];
      this.groupDisplayColumnsMap = {};
      var checkFunc = function(col) {
        var colDef = col.getColDef();
        var underlyingColumn = colDef.showRowGroup;
        if (colDef && exists(underlyingColumn)) {
          _this.groupDisplayColumns.push(col);
          if (typeof underlyingColumn === "string") {
            _this.groupDisplayColumnsMap[underlyingColumn] = col;
          } else if (underlyingColumn === true) {
            _this.getRowGroupColumns().forEach(function(rowGroupCol) {
              _this.groupDisplayColumnsMap[rowGroupCol.getId()] = col;
            });
          }
        }
      };
      this.gridColumns.forEach(checkFunc);
    };
    ColumnModel2.prototype.getGroupDisplayColumns = function() {
      return this.groupDisplayColumns;
    };
    ColumnModel2.prototype.getGroupDisplayColumnForGroup = function(rowGroupColumnId) {
      return this.groupDisplayColumnsMap[rowGroupColumnId];
    };
    ColumnModel2.prototype.updateDisplayedColumns = function(source) {
      var columnsForDisplay = this.calculateColumnsForDisplay();
      this.buildDisplayedTrees(columnsForDisplay);
      this.updateGroupsAndDisplayedColumns(source);
      this.setFirstRightAndLastLeftPinned(source);
    };
    ColumnModel2.prototype.isSecondaryColumnsPresent = function() {
      return exists(this.secondaryColumns);
    };
    ColumnModel2.prototype.setSecondaryColumns = function(colDefs, source) {
      var _this = this;
      if (source === void 0) {
        source = "api";
      }
      var newColsPresent = colDefs && colDefs.length > 0;
      if (!newColsPresent && missing(this.secondaryColumns)) {
        return;
      }
      if (newColsPresent) {
        this.processSecondaryColumnDefinitions(colDefs);
        var balancedTreeResult = this.columnFactory.createColumnTree(colDefs, false, this.secondaryBalancedTree || this.previousSecondaryColumns || void 0);
        this.destroyOldColumns(this.secondaryBalancedTree, balancedTreeResult.columnTree);
        this.secondaryBalancedTree = balancedTreeResult.columnTree;
        this.secondaryHeaderRowCount = balancedTreeResult.treeDept + 1;
        this.secondaryColumns = this.getColumnsFromTree(this.secondaryBalancedTree);
        this.secondaryColumnsMap = {};
        this.secondaryColumns.forEach(function(col) {
          return _this.secondaryColumnsMap[col.getId()] = col;
        });
        this.previousSecondaryColumns = null;
      } else {
        this.previousSecondaryColumns = this.secondaryBalancedTree;
        this.secondaryBalancedTree = null;
        this.secondaryHeaderRowCount = -1;
        this.secondaryColumns = null;
        this.secondaryColumnsMap = {};
      }
      this.updateGridColumns();
      this.updateDisplayedColumns(source);
    };
    ColumnModel2.prototype.processSecondaryColumnDefinitions = function(colDefs) {
      var columnCallback = this.gridOptionsService.get("processPivotResultColDef") || this.gridOptionsService.get("processSecondaryColDef");
      var groupCallback = this.gridOptionsService.get("processPivotResultColGroupDef") || this.gridOptionsService.get("processSecondaryColGroupDef");
      if (!columnCallback && !groupCallback) {
        return void 0;
      }
      var searchForColDefs = function(colDefs2) {
        colDefs2.forEach(function(abstractColDef) {
          var isGroup = exists(abstractColDef.children);
          if (isGroup) {
            var colGroupDef = abstractColDef;
            if (groupCallback) {
              groupCallback(colGroupDef);
            }
            searchForColDefs(colGroupDef.children);
          } else {
            var colDef = abstractColDef;
            if (columnCallback) {
              columnCallback(colDef);
            }
          }
        });
      };
      if (colDefs) {
        searchForColDefs(colDefs);
      }
    };
    ColumnModel2.prototype.updateGridColumns = function() {
      var _this = this;
      var prevGridCols = this.gridBalancedTree;
      if (this.gridColsArePrimary) {
        this.lastPrimaryOrder = this.gridColumns;
      } else {
        this.lastSecondaryOrder = this.gridColumns;
      }
      var sortOrderToRecover;
      if (this.secondaryColumns && this.secondaryBalancedTree) {
        var hasSameColumns = this.secondaryColumns.every(function(col) {
          return _this.gridColumnsMap[col.getColId()] !== void 0;
        });
        this.gridBalancedTree = this.secondaryBalancedTree.slice();
        this.gridHeaderRowCount = this.secondaryHeaderRowCount;
        this.gridColumns = this.secondaryColumns.slice();
        this.gridColsArePrimary = false;
        if (hasSameColumns) {
          sortOrderToRecover = this.lastSecondaryOrder;
        }
      } else if (this.primaryColumns) {
        this.gridBalancedTree = this.primaryColumnTree.slice();
        this.gridHeaderRowCount = this.primaryHeaderRowCount;
        this.gridColumns = this.primaryColumns.slice();
        this.gridColsArePrimary = true;
        sortOrderToRecover = this.lastPrimaryOrder;
      }
      var areAutoColsChanged = this.createGroupAutoColumnsIfNeeded();
      if (areAutoColsChanged && sortOrderToRecover) {
        var groupAutoColsMap_1 = convertToMap(this.groupAutoColumns.map(function(col) {
          return [col, true];
        }));
        sortOrderToRecover = sortOrderToRecover.filter(function(col) {
          return !groupAutoColsMap_1.has(col);
        });
        sortOrderToRecover = __spreadArray$l(__spreadArray$l([], __read$r(this.groupAutoColumns)), __read$r(sortOrderToRecover));
      }
      this.addAutoGroupToGridColumns();
      this.orderGridColsLike(sortOrderToRecover);
      this.gridColumns = this.placeLockedColumns(this.gridColumns);
      this.calculateColumnsForGroupDisplay();
      this.refreshQuickFilterColumns();
      this.clearDisplayedAndViewportColumns();
      this.colSpanActive = this.checkColSpanActiveInCols(this.gridColumns);
      this.gridColumnsMap = {};
      this.gridColumns.forEach(function(col) {
        return _this.gridColumnsMap[col.getId()] = col;
      });
      this.setAutoHeightActive();
      if (!areEqual(prevGridCols, this.gridBalancedTree)) {
        var event_4 = {
          type: Events.EVENT_GRID_COLUMNS_CHANGED
        };
        this.eventService.dispatchEvent(event_4);
      }
    };
    ColumnModel2.prototype.setAutoHeightActive = function() {
      this.autoHeightActive = this.gridColumns.filter(function(col) {
        return col.isAutoHeight();
      }).length > 0;
      if (this.autoHeightActive) {
        this.autoHeightActiveAtLeastOnce = true;
        var supportedRowModel = this.gridOptionsService.isRowModelType("clientSide") || this.gridOptionsService.isRowModelType("serverSide");
        if (!supportedRowModel) {
          var message_1 = "AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.";
          doOnce(function() {
            return console.warn(message_1);
          }, "autoHeightActive.wrongRowModel");
        }
      }
    };
    ColumnModel2.prototype.orderGridColsLike = function(colsOrder) {
      if (missing(colsOrder)) {
        return;
      }
      var lastOrderMapped = convertToMap(colsOrder.map(function(col, index2) {
        return [col, index2];
      }));
      var noColsFound = true;
      this.gridColumns.forEach(function(col) {
        if (lastOrderMapped.has(col)) {
          noColsFound = false;
        }
      });
      if (noColsFound) {
        return;
      }
      var gridColsMap = convertToMap(this.gridColumns.map(function(col) {
        return [col, true];
      }));
      var oldColsOrdered = colsOrder.filter(function(col) {
        return gridColsMap.has(col);
      });
      var oldColsMap = convertToMap(oldColsOrdered.map(function(col) {
        return [col, true];
      }));
      var newColsOrdered = this.gridColumns.filter(function(col) {
        return !oldColsMap.has(col);
      });
      var newGridColumns = oldColsOrdered.slice();
      newColsOrdered.forEach(function(newCol) {
        var parent = newCol.getOriginalParent();
        if (!parent) {
          newGridColumns.push(newCol);
          return;
        }
        var siblings = [];
        while (!siblings.length && parent) {
          var leafCols = parent.getLeafColumns();
          leafCols.forEach(function(leafCol) {
            var presentInNewGriColumns = newGridColumns.indexOf(leafCol) >= 0;
            var noYetInSiblings = siblings.indexOf(leafCol) < 0;
            if (presentInNewGriColumns && noYetInSiblings) {
              siblings.push(leafCol);
            }
          });
          parent = parent.getOriginalParent();
        }
        if (!siblings.length) {
          newGridColumns.push(newCol);
          return;
        }
        var indexes = siblings.map(function(col) {
          return newGridColumns.indexOf(col);
        });
        var lastIndex = Math.max.apply(Math, __spreadArray$l([], __read$r(indexes)));
        insertIntoArray(newGridColumns, newCol, lastIndex + 1);
      });
      this.gridColumns = newGridColumns;
    };
    ColumnModel2.prototype.isPrimaryColumnGroupsPresent = function() {
      return this.primaryHeaderRowCount > 1;
    };
    ColumnModel2.prototype.refreshQuickFilterColumns = function() {
      var _a2;
      var columnsForQuickFilter = (_a2 = this.isPivotMode() ? this.secondaryColumns : this.primaryColumns) !== null && _a2 !== void 0 ? _a2 : [];
      if (this.groupAutoColumns) {
        columnsForQuickFilter = columnsForQuickFilter.concat(this.groupAutoColumns);
      }
      this.columnsForQuickFilter = this.gridOptionsService.is("includeHiddenColumnsInQuickFilter") ? columnsForQuickFilter : columnsForQuickFilter.filter(function(col) {
        return col.isVisible() || col.isRowGroupActive();
      });
    };
    ColumnModel2.prototype.placeLockedColumns = function(cols) {
      var left = [];
      var normal = [];
      var right = [];
      cols.forEach(function(col) {
        var position = col.getColDef().lockPosition;
        if (position === "right") {
          right.push(col);
        } else if (position === "left" || position === true) {
          left.push(col);
        } else {
          normal.push(col);
        }
      });
      return __spreadArray$l(__spreadArray$l(__spreadArray$l([], __read$r(left)), __read$r(normal)), __read$r(right));
    };
    ColumnModel2.prototype.addAutoGroupToGridColumns = function() {
      if (missing(this.groupAutoColumns)) {
        this.destroyOldColumns(this.groupAutoColsBalancedTree);
        this.groupAutoColsBalancedTree = null;
        return;
      }
      this.gridColumns = this.groupAutoColumns ? this.groupAutoColumns.concat(this.gridColumns) : this.gridColumns;
      var newAutoColsTree = this.columnFactory.createForAutoGroups(this.groupAutoColumns, this.gridBalancedTree);
      this.destroyOldColumns(this.groupAutoColsBalancedTree, newAutoColsTree);
      this.groupAutoColsBalancedTree = newAutoColsTree;
      this.gridBalancedTree = newAutoColsTree.concat(this.gridBalancedTree);
    };
    ColumnModel2.prototype.clearDisplayedAndViewportColumns = function() {
      this.viewportRowLeft = {};
      this.viewportRowRight = {};
      this.viewportRowCenter = {};
      this.displayedColumnsLeft = [];
      this.displayedColumnsRight = [];
      this.displayedColumnsCenter = [];
      this.displayedColumns = [];
      this.viewportColumns = [];
      this.headerViewportColumns = [];
      this.viewportColumnsHash = "";
    };
    ColumnModel2.prototype.updateGroupsAndDisplayedColumns = function(source) {
      this.updateOpenClosedVisibilityInColumnGroups();
      this.deriveDisplayedColumns(source);
      this.refreshFlexedColumns();
      this.extractViewport();
      this.updateBodyWidths();
      var event = {
        type: Events.EVENT_DISPLAYED_COLUMNS_CHANGED
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnModel2.prototype.deriveDisplayedColumns = function(source) {
      this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft, this.displayedColumnsLeft);
      this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre, this.displayedColumnsCenter);
      this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight, this.displayedColumnsRight);
      this.joinDisplayedColumns();
      this.setLeftValues(source);
      this.displayedAutoHeightCols = this.displayedColumns.filter(function(col) {
        return col.isAutoHeight();
      });
    };
    ColumnModel2.prototype.isAutoRowHeightActive = function() {
      return this.autoHeightActive;
    };
    ColumnModel2.prototype.wasAutoRowHeightEverActive = function() {
      return this.autoHeightActiveAtLeastOnce;
    };
    ColumnModel2.prototype.joinDisplayedColumns = function() {
      if (this.gridOptionsService.is("enableRtl")) {
        this.displayedColumns = this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft);
      } else {
        this.displayedColumns = this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight);
      }
    };
    ColumnModel2.prototype.setLeftValues = function(source) {
      this.setLeftValuesOfColumns(source);
      this.setLeftValuesOfGroups();
    };
    ColumnModel2.prototype.setLeftValuesOfColumns = function(source) {
      var _this = this;
      if (!this.primaryColumns) {
        return;
      }
      var allColumns = this.primaryColumns.slice(0);
      var doingRtl = this.gridOptionsService.is("enableRtl");
      [
        this.displayedColumnsLeft,
        this.displayedColumnsRight,
        this.displayedColumnsCenter
      ].forEach(function(columns) {
        if (doingRtl) {
          var left_1 = _this.getWidthOfColsInList(columns);
          columns.forEach(function(column) {
            left_1 -= column.getActualWidth();
            column.setLeft(left_1, source);
          });
        } else {
          var left_2 = 0;
          columns.forEach(function(column) {
            column.setLeft(left_2, source);
            left_2 += column.getActualWidth();
          });
        }
        removeAllFromArray(allColumns, columns);
      });
      allColumns.forEach(function(column) {
        column.setLeft(null, source);
      });
    };
    ColumnModel2.prototype.setLeftValuesOfGroups = function() {
      [
        this.displayedTreeLeft,
        this.displayedTreeRight,
        this.displayedTreeCentre
      ].forEach(function(columns) {
        columns.forEach(function(column) {
          if (column instanceof ColumnGroup) {
            var columnGroup = column;
            columnGroup.checkLeft();
          }
        });
      });
    };
    ColumnModel2.prototype.derivedDisplayedColumnsFromDisplayedTree = function(tree, columns) {
      columns.length = 0;
      this.columnUtils.depthFirstDisplayedColumnTreeSearch(tree, function(child) {
        if (child instanceof Column) {
          columns.push(child);
        }
      });
    };
    ColumnModel2.prototype.extractViewportColumns = function() {
      if (this.suppressColumnVirtualisation) {
        this.viewportColumnsCenter = this.displayedColumnsCenter;
        this.headerViewportColumnsCenter = this.displayedColumnsCenter;
      } else {
        this.viewportColumnsCenter = this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this));
        this.headerViewportColumnsCenter = this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this));
      }
      this.viewportColumns = this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight);
      this.headerViewportColumns = this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight);
    };
    ColumnModel2.prototype.getVirtualHeaderGroupRow = function(type, dept) {
      var result;
      switch (type) {
        case "left":
          result = this.viewportRowLeft[dept];
          break;
        case "right":
          result = this.viewportRowRight[dept];
          break;
        default:
          result = this.viewportRowCenter[dept];
          break;
      }
      if (missing(result)) {
        result = [];
      }
      return result;
    };
    ColumnModel2.prototype.calculateHeaderRows = function() {
      this.viewportRowLeft = {};
      this.viewportRowRight = {};
      this.viewportRowCenter = {};
      var virtualColIds = {};
      this.headerViewportColumns.forEach(function(col) {
        return virtualColIds[col.getId()] = true;
      });
      var testGroup = function(children, result, dept) {
        var returnValue = false;
        for (var i = 0; i < children.length; i++) {
          var child = children[i];
          var addThisItem = false;
          if (child instanceof Column) {
            addThisItem = virtualColIds[child.getId()] === true;
          } else {
            var columnGroup = child;
            var displayedChildren = columnGroup.getDisplayedChildren();
            if (displayedChildren) {
              addThisItem = testGroup(displayedChildren, result, dept + 1);
            }
          }
          if (addThisItem) {
            returnValue = true;
            if (!result[dept]) {
              result[dept] = [];
            }
            result[dept].push(child);
          }
        }
        return returnValue;
      };
      testGroup(this.displayedTreeLeft, this.viewportRowLeft, 0);
      testGroup(this.displayedTreeRight, this.viewportRowRight, 0);
      testGroup(this.displayedTreeCentre, this.viewportRowCenter, 0);
    };
    ColumnModel2.prototype.extractViewport = function() {
      var hashColumn = function(c) {
        return c.getId() + "-" + (c.getPinned() || "normal");
      };
      this.extractViewportColumns();
      var newHash = this.viewportColumns.map(hashColumn).join("#");
      var changed = this.viewportColumnsHash !== newHash;
      if (changed) {
        this.viewportColumnsHash = newHash;
        this.calculateHeaderRows();
      }
      return changed;
    };
    ColumnModel2.prototype.refreshFlexedColumns = function(params) {
      var _this = this;
      if (params === void 0) {
        params = {};
      }
      var source = params.source ? params.source : "flex";
      if (params.viewportWidth != null) {
        this.flexViewportWidth = params.viewportWidth;
      }
      if (!this.flexViewportWidth) {
        return [];
      }
      var flexAfterDisplayIndex = -1;
      if (params.resizingCols) {
        params.resizingCols.forEach(function(col2) {
          var indexOfCol = _this.displayedColumnsCenter.indexOf(col2);
          if (flexAfterDisplayIndex < indexOfCol) {
            flexAfterDisplayIndex = indexOfCol;
          }
        });
      }
      var isColFlex = function(col2) {
        var afterResizingCols = _this.displayedColumnsCenter.indexOf(col2) > flexAfterDisplayIndex;
        return col2.getFlex() && afterResizingCols;
      };
      var knownWidthColumns = this.displayedColumnsCenter.filter(function(col2) {
        return !isColFlex(col2);
      });
      var flexingColumns = this.displayedColumnsCenter.filter(function(col2) {
        return isColFlex(col2);
      });
      var changedColumns = [];
      if (!flexingColumns.length) {
        return [];
      }
      var flexingColumnSizes = [];
      var spaceForFlexingColumns;
      outer:
        while (true) {
          var totalFlex = flexingColumns.reduce(function(count, col2) {
            return count + col2.getFlex();
          }, 0);
          spaceForFlexingColumns = this.flexViewportWidth - this.getWidthOfColsInList(knownWidthColumns);
          for (var i = 0; i < flexingColumns.length; i++) {
            var col = flexingColumns[i];
            var widthByFlexRule = spaceForFlexingColumns * col.getFlex() / totalFlex;
            var constrainedWidth = 0;
            var minWidth = col.getMinWidth();
            var maxWidth = col.getMaxWidth();
            if (exists(minWidth) && widthByFlexRule < minWidth) {
              constrainedWidth = minWidth;
            } else if (exists(maxWidth) && widthByFlexRule > maxWidth) {
              constrainedWidth = maxWidth;
            }
            if (constrainedWidth) {
              col.setActualWidth(constrainedWidth, source);
              removeFromArray(flexingColumns, col);
              changedColumns.push(col);
              knownWidthColumns.push(col);
              continue outer;
            }
            flexingColumnSizes[i] = Math.round(widthByFlexRule);
          }
          break;
        }
      var remainingSpace = spaceForFlexingColumns;
      flexingColumns.forEach(function(col2, i2) {
        col2.setActualWidth(Math.min(flexingColumnSizes[i2], remainingSpace), source);
        changedColumns.push(col2);
        remainingSpace -= flexingColumnSizes[i2];
      });
      if (!params.skipSetLeft) {
        this.setLeftValues(source);
      }
      if (params.updateBodyWidths) {
        this.updateBodyWidths();
      }
      if (params.fireResizedEvent) {
        this.dispatchColumnResizedEvent(changedColumns, true, source, flexingColumns);
      }
      return flexingColumns;
    };
    ColumnModel2.prototype.sizeColumnsToFit = function(gridWidth, source, silent, params) {
      var _this = this;
      var _a2, _b2, _c, _d, _e;
      if (source === void 0) {
        source = "sizeColumnsToFit";
      }
      if (this.shouldQueueResizeOperations) {
        this.resizeOperationQueue.push(function() {
          return _this.sizeColumnsToFit(gridWidth, source, silent, params);
        });
        return;
      }
      var limitsMap = {};
      if (params) {
        (_a2 = params === null || params === void 0 ? void 0 : params.columnLimits) === null || _a2 === void 0 ? void 0 : _a2.forEach(function(_a3) {
          var key = _a3.key, dimensions = __rest(_a3, ["key"]);
          limitsMap[typeof key === "string" ? key : key.getColId()] = dimensions;
        });
      }
      var allDisplayedColumns = this.getAllDisplayedColumns();
      var doColumnsAlreadyFit = gridWidth === this.getWidthOfColsInList(allDisplayedColumns);
      if (gridWidth <= 0 || !allDisplayedColumns.length || doColumnsAlreadyFit) {
        return;
      }
      var colsToSpread = [];
      var colsToNotSpread = [];
      allDisplayedColumns.forEach(function(column2) {
        if (column2.getColDef().suppressSizeToFit === true) {
          colsToNotSpread.push(column2);
        } else {
          colsToSpread.push(column2);
        }
      });
      var colsToDispatchEventFor = colsToSpread.slice(0);
      var finishedResizing = false;
      var moveToNotSpread = function(column2) {
        removeFromArray(colsToSpread, column2);
        colsToNotSpread.push(column2);
      };
      colsToSpread.forEach(function(column2) {
        return column2.resetActualWidth(source);
      });
      while (!finishedResizing) {
        finishedResizing = true;
        var availablePixels = gridWidth - this.getWidthOfColsInList(colsToNotSpread);
        if (availablePixels <= 0) {
          colsToSpread.forEach(function(column2) {
            var _a3, _b3;
            var widthOverride2 = (_b3 = (_a3 = limitsMap === null || limitsMap === void 0 ? void 0 : limitsMap[column2.getId()]) === null || _a3 === void 0 ? void 0 : _a3.minWidth) !== null && _b3 !== void 0 ? _b3 : params === null || params === void 0 ? void 0 : params.defaultMinWidth;
            if (typeof widthOverride2 === "number") {
              column2.setActualWidth(widthOverride2);
              return;
            }
            column2.setMinimum(source);
          });
        } else {
          var scale = availablePixels / this.getWidthOfColsInList(colsToSpread);
          var pixelsForLastCol = availablePixels;
          for (var i = colsToSpread.length - 1; i >= 0; i--) {
            var column = colsToSpread[i];
            var widthOverride = limitsMap === null || limitsMap === void 0 ? void 0 : limitsMap[column.getId()];
            var minOverride = (_b2 = widthOverride === null || widthOverride === void 0 ? void 0 : widthOverride.minWidth) !== null && _b2 !== void 0 ? _b2 : params === null || params === void 0 ? void 0 : params.defaultMinWidth;
            var maxOverride = (_c = widthOverride === null || widthOverride === void 0 ? void 0 : widthOverride.maxWidth) !== null && _c !== void 0 ? _c : params === null || params === void 0 ? void 0 : params.defaultMaxWidth;
            var colMinWidth = (_d = column.getMinWidth()) !== null && _d !== void 0 ? _d : 0;
            var colMaxWidth = (_e = column.getMaxWidth()) !== null && _e !== void 0 ? _e : Number.MAX_VALUE;
            var minWidth = typeof minOverride === "number" && minOverride > colMinWidth ? minOverride : column.getMinWidth();
            var maxWidth = typeof maxOverride === "number" && maxOverride < colMaxWidth ? maxOverride : column.getMaxWidth();
            var newWidth = Math.round(column.getActualWidth() * scale);
            if (exists(minWidth) && newWidth < minWidth) {
              newWidth = minWidth;
              moveToNotSpread(column);
              finishedResizing = false;
            } else if (exists(maxWidth) && newWidth > maxWidth) {
              newWidth = maxWidth;
              moveToNotSpread(column);
              finishedResizing = false;
            } else if (i === 0) {
              newWidth = pixelsForLastCol;
            }
            column.setActualWidth(newWidth, source, true);
            pixelsForLastCol -= newWidth;
          }
        }
      }
      colsToDispatchEventFor.forEach(function(col) {
        col.fireColumnWidthChangedEvent(source);
      });
      this.setLeftValues(source);
      this.updateBodyWidths();
      if (silent) {
        return;
      }
      this.dispatchColumnResizedEvent(colsToDispatchEventFor, true, source);
    };
    ColumnModel2.prototype.buildDisplayedTrees = function(visibleColumns) {
      var leftVisibleColumns = [];
      var rightVisibleColumns = [];
      var centerVisibleColumns = [];
      visibleColumns.forEach(function(column) {
        switch (column.getPinned()) {
          case "left":
            leftVisibleColumns.push(column);
            break;
          case "right":
            rightVisibleColumns.push(column);
            break;
          default:
            centerVisibleColumns.push(column);
            break;
        }
      });
      var groupInstanceIdCreator = new GroupInstanceIdCreator();
      this.displayedTreeLeft = this.displayedGroupCreator.createDisplayedGroups(leftVisibleColumns, this.gridBalancedTree, groupInstanceIdCreator, "left", this.displayedTreeLeft);
      this.displayedTreeRight = this.displayedGroupCreator.createDisplayedGroups(rightVisibleColumns, this.gridBalancedTree, groupInstanceIdCreator, "right", this.displayedTreeRight);
      this.displayedTreeCentre = this.displayedGroupCreator.createDisplayedGroups(centerVisibleColumns, this.gridBalancedTree, groupInstanceIdCreator, null, this.displayedTreeCentre);
      this.updateDisplayedMap();
    };
    ColumnModel2.prototype.updateDisplayedMap = function() {
      var _this = this;
      this.displayedColumnsAndGroupsMap = {};
      var func = function(child) {
        _this.displayedColumnsAndGroupsMap[child.getUniqueId()] = child;
      };
      this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre, func);
      this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft, func);
      this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight, func);
    };
    ColumnModel2.prototype.isDisplayed = function(item) {
      var fromMap = this.displayedColumnsAndGroupsMap[item.getUniqueId()];
      return fromMap === item;
    };
    ColumnModel2.prototype.updateOpenClosedVisibilityInColumnGroups = function() {
      var allColumnGroups = this.getAllDisplayedTrees();
      this.columnUtils.depthFirstAllColumnTreeSearch(allColumnGroups, function(child) {
        if (child instanceof ColumnGroup) {
          var columnGroup = child;
          columnGroup.calculateDisplayedColumns();
        }
      });
    };
    ColumnModel2.prototype.getGroupAutoColumns = function() {
      return this.groupAutoColumns;
    };
    ColumnModel2.prototype.createGroupAutoColumnsIfNeeded = function() {
      var forceRecreateAutoGroups = this.forceRecreateAutoGroups;
      this.forceRecreateAutoGroups = false;
      if (!this.autoGroupsNeedBuilding) {
        return false;
      }
      this.autoGroupsNeedBuilding = false;
      var groupFullWidthRow = this.gridOptionsService.isGroupUseEntireRow(this.pivotMode);
      var suppressAutoColumn = this.pivotMode ? this.gridOptionsService.is("pivotSuppressAutoColumn") : this.isGroupSuppressAutoColumn();
      var groupingActive = this.rowGroupColumns.length > 0 || this.usingTreeData;
      var needAutoColumns = groupingActive && !suppressAutoColumn && !groupFullWidthRow;
      if (needAutoColumns) {
        var existingCols = this.groupAutoColumns || [];
        var newAutoGroupCols = this.autoGroupColService.createAutoGroupColumns(existingCols, this.rowGroupColumns);
        var autoColsDifferent = !this.autoColsEqual(newAutoGroupCols, this.groupAutoColumns);
        if (autoColsDifferent || forceRecreateAutoGroups) {
          this.groupAutoColumns = newAutoGroupCols;
          return true;
        }
      } else {
        this.groupAutoColumns = null;
      }
      return false;
    };
    ColumnModel2.prototype.isGroupSuppressAutoColumn = function() {
      var groupDisplayType = this.gridOptionsService.get("groupDisplayType");
      var isCustomRowGroups = groupDisplayType ? matchesGroupDisplayType("custom", groupDisplayType) : false;
      if (isCustomRowGroups) {
        return true;
      }
      var treeDataDisplayType = this.gridOptionsService.get("treeDataDisplayType");
      return treeDataDisplayType ? matchesTreeDataDisplayType("custom", treeDataDisplayType) : false;
    };
    ColumnModel2.prototype.autoColsEqual = function(colsA, colsB) {
      return areEqual(colsA, colsB, function(a, b) {
        return a.getColId() === b.getColId();
      });
    };
    ColumnModel2.prototype.getWidthOfColsInList = function(columnList) {
      return columnList.reduce(function(width, col) {
        return width + col.getActualWidth();
      }, 0);
    };
    ColumnModel2.prototype.getGridBalancedTree = function() {
      return this.gridBalancedTree;
    };
    ColumnModel2.prototype.hasFloatingFilters = function() {
      if (!this.gridColumns) {
        return false;
      }
      var res = this.gridColumns.some(function(col) {
        return col.getColDef().floatingFilter;
      });
      return res;
    };
    ColumnModel2.prototype.getFirstDisplayedColumn = function() {
      var isRtl = this.gridOptionsService.is("enableRtl");
      var queryOrder = [
        "getDisplayedLeftColumns",
        "getDisplayedCenterColumns",
        "getDisplayedRightColumns"
      ];
      if (isRtl) {
        queryOrder.reverse();
      }
      for (var i = 0; i < queryOrder.length; i++) {
        var container = this[queryOrder[i]]();
        if (container.length) {
          return isRtl ? last(container) : container[0];
        }
      }
      return null;
    };
    ColumnModel2.prototype.setColumnHeaderHeight = function(col, height) {
      var changed = col.setAutoHeaderHeight(height);
      if (changed) {
        var event_5 = {
          type: Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,
          column: col,
          columns: [col],
          source: "autosizeColumnHeaderHeight"
        };
        this.eventService.dispatchEvent(event_5);
      }
    };
    ColumnModel2.prototype.getColumnGroupHeaderRowHeight = function() {
      if (this.isPivotMode()) {
        return this.getPivotGroupHeaderHeight();
      }
      return this.getGroupHeaderHeight();
    };
    ColumnModel2.prototype.getColumnHeaderRowHeight = function() {
      var defaultHeight = this.isPivotMode() ? this.getPivotHeaderHeight() : this.getHeaderHeight();
      var displayedHeights = this.getAllDisplayedColumns().filter(function(col) {
        return col.isAutoHeaderHeight();
      }).map(function(col) {
        return col.getAutoHeaderHeight() || 0;
      });
      return Math.max.apply(Math, __spreadArray$l([defaultHeight], __read$r(displayedHeights)));
    };
    ColumnModel2.prototype.getHeaderHeight = function() {
      var _a2;
      return (_a2 = this.gridOptionsService.getNum("headerHeight")) !== null && _a2 !== void 0 ? _a2 : this.environment.getFromTheme(25, "headerHeight");
    };
    ColumnModel2.prototype.getFloatingFiltersHeight = function() {
      var _a2;
      return (_a2 = this.gridOptionsService.getNum("floatingFiltersHeight")) !== null && _a2 !== void 0 ? _a2 : this.getHeaderHeight();
    };
    ColumnModel2.prototype.getGroupHeaderHeight = function() {
      var _a2;
      return (_a2 = this.gridOptionsService.getNum("groupHeaderHeight")) !== null && _a2 !== void 0 ? _a2 : this.getHeaderHeight();
    };
    ColumnModel2.prototype.getPivotHeaderHeight = function() {
      var _a2;
      return (_a2 = this.gridOptionsService.getNum("pivotHeaderHeight")) !== null && _a2 !== void 0 ? _a2 : this.getHeaderHeight();
    };
    ColumnModel2.prototype.getPivotGroupHeaderHeight = function() {
      var _a2;
      return (_a2 = this.gridOptionsService.getNum("pivotGroupHeaderHeight")) !== null && _a2 !== void 0 ? _a2 : this.getGroupHeaderHeight();
    };
    ColumnModel2.prototype.queueResizeOperations = function() {
      this.shouldQueueResizeOperations = true;
    };
    ColumnModel2.prototype.processResizeOperations = function() {
      this.shouldQueueResizeOperations = false;
      this.resizeOperationQueue.forEach(function(resizeOperation) {
        return resizeOperation();
      });
      this.resizeOperationQueue = [];
    };
    ColumnModel2.prototype.resetColumnDefIntoColumn = function(column) {
      var userColDef = column.getUserProvidedColDef();
      if (!userColDef) {
        return false;
      }
      var newColDef = this.columnFactory.mergeColDefs(userColDef, column.getColId());
      column.setColDef(newColDef, userColDef);
      return true;
    };
    ColumnModel2.prototype.generateColumnStateForRowGroupAndPivotIndexes = function(updatedRowGroupColumnState, updatedPivotColumnState) {
      var _this = this;
      var existingColumnStateUpdates = {};
      var orderColumns = function(updatedColumnState, colList, enableProp, initialEnableProp, indexProp, initialIndexProp) {
        if (!colList.length || !_this.primaryColumns) {
          return [];
        }
        var updatedColIdArray = Object.keys(updatedColumnState);
        var updatedColIds = new Set(updatedColIdArray);
        var newColIds = new Set(updatedColIdArray);
        var allColIds = new Set(colList.map(function(column) {
          var colId2 = column.getColId();
          newColIds.delete(colId2);
          return colId2;
        }).concat(updatedColIdArray));
        var colIdsInOriginalOrder = [];
        var originalOrderMap = {};
        var orderIndex = 0;
        for (var i = 0; i < _this.primaryColumns.length; i++) {
          var colId = _this.primaryColumns[i].getColId();
          if (allColIds.has(colId)) {
            colIdsInOriginalOrder.push(colId);
            originalOrderMap[colId] = orderIndex++;
          }
        }
        var index2 = 1e3;
        var hasAddedNewCols = false;
        var lastIndex = 0;
        var processPrecedingNewCols = function(colId2) {
          var originalOrderIndex = originalOrderMap[colId2];
          for (var i2 = lastIndex; i2 < originalOrderIndex; i2++) {
            var newColId = colIdsInOriginalOrder[i2];
            if (newColIds.has(newColId)) {
              updatedColumnState[newColId][indexProp] = index2++;
              newColIds.delete(newColId);
            }
          }
          lastIndex = originalOrderIndex;
        };
        colList.forEach(function(column) {
          var colId2 = column.getColId();
          if (updatedColIds.has(colId2)) {
            processPrecedingNewCols(colId2);
            updatedColumnState[colId2][indexProp] = index2++;
          } else {
            var colDef = column.getColDef();
            var missingIndex = colDef[indexProp] === null || colDef[indexProp] === void 0 && colDef[initialIndexProp] == null;
            if (missingIndex) {
              if (!hasAddedNewCols) {
                var propEnabled = colDef[enableProp] || colDef[enableProp] === void 0 && colDef[initialEnableProp];
                if (propEnabled) {
                  processPrecedingNewCols(colId2);
                } else {
                  newColIds.forEach(function(newColId) {
                    updatedColumnState[newColId][indexProp] = index2 + originalOrderMap[newColId];
                  });
                  index2 += colIdsInOriginalOrder.length;
                  hasAddedNewCols = true;
                }
              }
              if (!existingColumnStateUpdates[colId2]) {
                existingColumnStateUpdates[colId2] = { colId: colId2 };
              }
              existingColumnStateUpdates[colId2][indexProp] = index2++;
            }
          }
        });
      };
      orderColumns(updatedRowGroupColumnState, this.rowGroupColumns, "rowGroup", "initialRowGroup", "rowGroupIndex", "initialRowGroupIndex");
      orderColumns(updatedPivotColumnState, this.pivotColumns, "pivot", "initialPivot", "pivotIndex", "initialPivotIndex");
      return Object.values(existingColumnStateUpdates);
    };
    __decorate$2w([
      Autowired("expressionService")
    ], ColumnModel2.prototype, "expressionService", void 0);
    __decorate$2w([
      Autowired("columnFactory")
    ], ColumnModel2.prototype, "columnFactory", void 0);
    __decorate$2w([
      Autowired("displayedGroupCreator")
    ], ColumnModel2.prototype, "displayedGroupCreator", void 0);
    __decorate$2w([
      Autowired("ctrlsService")
    ], ColumnModel2.prototype, "ctrlsService", void 0);
    __decorate$2w([
      Autowired("autoWidthCalculator")
    ], ColumnModel2.prototype, "autoWidthCalculator", void 0);
    __decorate$2w([
      Autowired("columnUtils")
    ], ColumnModel2.prototype, "columnUtils", void 0);
    __decorate$2w([
      Autowired("columnAnimationService")
    ], ColumnModel2.prototype, "columnAnimationService", void 0);
    __decorate$2w([
      Autowired("autoGroupColService")
    ], ColumnModel2.prototype, "autoGroupColService", void 0);
    __decorate$2w([
      Optional("aggFuncService")
    ], ColumnModel2.prototype, "aggFuncService", void 0);
    __decorate$2w([
      Optional("valueCache")
    ], ColumnModel2.prototype, "valueCache", void 0);
    __decorate$2w([
      Optional("animationFrameService")
    ], ColumnModel2.prototype, "animationFrameService", void 0);
    __decorate$2w([
      Autowired("sortController")
    ], ColumnModel2.prototype, "sortController", void 0);
    __decorate$2w([
      Autowired("columnDefFactory")
    ], ColumnModel2.prototype, "columnDefFactory", void 0);
    __decorate$2w([
      PostConstruct
    ], ColumnModel2.prototype, "init", null);
    __decorate$2w([
      PreDestroy
    ], ColumnModel2.prototype, "destroyColumns", null);
    __decorate$2w([
      __param$8(0, Qualifier("loggerFactory"))
    ], ColumnModel2.prototype, "setBeans", null);
    ColumnModel2 = __decorate$2w([
      Bean("columnModel")
    ], ColumnModel2);
    return ColumnModel2;
  }(BeanStub)
);
var __extends$2Y = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2v = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ColumnUtils = (
  /** @class */
  function(_super) {
    __extends$2Y(ColumnUtils2, _super);
    function ColumnUtils2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ColumnUtils2.prototype.calculateColMinWidth = function(colDef) {
      return colDef.minWidth != null ? colDef.minWidth : this.environment.getMinColWidth();
    };
    ColumnUtils2.prototype.calculateColMaxWidth = function(colDef) {
      return colDef.maxWidth != null ? colDef.maxWidth : Number.MAX_SAFE_INTEGER;
    };
    ColumnUtils2.prototype.calculateColInitialWidth = function(colDef) {
      var minColWidth = this.calculateColMinWidth(colDef);
      var maxColWidth = this.calculateColMaxWidth(colDef);
      var width;
      var colDefWidth = attrToNumber(colDef.width);
      var colDefInitialWidth = attrToNumber(colDef.initialWidth);
      if (colDefWidth != null) {
        width = colDefWidth;
      } else if (colDefInitialWidth != null) {
        width = colDefInitialWidth;
      } else {
        width = 200;
      }
      return Math.max(Math.min(width, maxColWidth), minColWidth);
    };
    ColumnUtils2.prototype.getOriginalPathForColumn = function(column, originalBalancedTree) {
      var result = [];
      var found = false;
      var recursePath = function(balancedColumnTree, dept) {
        for (var i = 0; i < balancedColumnTree.length; i++) {
          if (found) {
            return;
          }
          var node = balancedColumnTree[i];
          if (node instanceof ProvidedColumnGroup) {
            var nextNode = node;
            recursePath(nextNode.getChildren(), dept + 1);
            result[dept] = node;
          } else if (node === column) {
            found = true;
          }
        }
      };
      recursePath(originalBalancedTree, 0);
      return found ? result : null;
    };
    ColumnUtils2.prototype.depthFirstOriginalTreeSearch = function(parent, tree, callback2) {
      var _this = this;
      if (!tree) {
        return;
      }
      tree.forEach(function(child) {
        if (child instanceof ProvidedColumnGroup) {
          _this.depthFirstOriginalTreeSearch(child, child.getChildren(), callback2);
        }
        callback2(child, parent);
      });
    };
    ColumnUtils2.prototype.depthFirstAllColumnTreeSearch = function(tree, callback2) {
      var _this = this;
      if (!tree) {
        return;
      }
      tree.forEach(function(child) {
        if (child instanceof ColumnGroup) {
          _this.depthFirstAllColumnTreeSearch(child.getChildren(), callback2);
        }
        callback2(child);
      });
    };
    ColumnUtils2.prototype.depthFirstDisplayedColumnTreeSearch = function(tree, callback2) {
      var _this = this;
      if (!tree) {
        return;
      }
      tree.forEach(function(child) {
        if (child instanceof ColumnGroup) {
          _this.depthFirstDisplayedColumnTreeSearch(child.getDisplayedChildren(), callback2);
        }
        callback2(child);
      });
    };
    ColumnUtils2 = __decorate$2v([
      Bean("columnUtils")
    ], ColumnUtils2);
    return ColumnUtils2;
  }(BeanStub)
);
var __extends$2X = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2u = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DisplayedGroupCreator = (
  /** @class */
  function(_super) {
    __extends$2X(DisplayedGroupCreator2, _super);
    function DisplayedGroupCreator2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    DisplayedGroupCreator2.prototype.createDisplayedGroups = function(sortedVisibleColumns, balancedColumnTree, groupInstanceIdCreator, pinned, oldDisplayedGroups) {
      var _this = this;
      var result = [];
      var previousRealPath;
      var previousOriginalPath;
      var oldColumnsMapped = this.mapOldGroupsById(oldDisplayedGroups);
      sortedVisibleColumns.forEach(function(currentColumn) {
        var currentOriginalPath = _this.getOriginalPathForColumn(balancedColumnTree, currentColumn);
        var currentRealPath = [];
        var firstColumn = !previousOriginalPath;
        for (var i = 0; i < currentOriginalPath.length; i++) {
          if (firstColumn || currentOriginalPath[i] !== previousOriginalPath[i]) {
            var newGroup = _this.createColumnGroup(currentOriginalPath[i], groupInstanceIdCreator, oldColumnsMapped, pinned);
            currentRealPath[i] = newGroup;
            if (i == 0) {
              result.push(newGroup);
            } else {
              currentRealPath[i - 1].addChild(newGroup);
            }
          } else {
            currentRealPath[i] = previousRealPath[i];
          }
        }
        var noColumnGroups = currentRealPath.length === 0;
        if (noColumnGroups) {
          result.push(currentColumn);
        } else {
          var leafGroup = last(currentRealPath);
          leafGroup.addChild(currentColumn);
        }
        previousRealPath = currentRealPath;
        previousOriginalPath = currentOriginalPath;
      });
      this.setupParentsIntoColumns(result, null);
      return result;
    };
    DisplayedGroupCreator2.prototype.createColumnGroup = function(providedGroup, groupInstanceIdCreator, oldColumnsMapped, pinned) {
      var groupId = providedGroup.getGroupId();
      var instanceId = groupInstanceIdCreator.getInstanceIdForKey(groupId);
      var uniqueId = ColumnGroup.createUniqueId(groupId, instanceId);
      var columnGroup = oldColumnsMapped[uniqueId];
      if (columnGroup && columnGroup.getProvidedColumnGroup() !== providedGroup) {
        columnGroup = null;
      }
      if (exists(columnGroup)) {
        columnGroup.reset();
      } else {
        columnGroup = new ColumnGroup(providedGroup, groupId, instanceId, pinned);
        this.context.createBean(columnGroup);
      }
      return columnGroup;
    };
    DisplayedGroupCreator2.prototype.mapOldGroupsById = function(displayedGroups) {
      var result = {};
      var recursive = function(columnsOrGroups) {
        columnsOrGroups.forEach(function(columnOrGroup) {
          if (columnOrGroup instanceof ColumnGroup) {
            var columnGroup = columnOrGroup;
            result[columnOrGroup.getUniqueId()] = columnGroup;
            recursive(columnGroup.getChildren());
          }
        });
      };
      if (displayedGroups) {
        recursive(displayedGroups);
      }
      return result;
    };
    DisplayedGroupCreator2.prototype.setupParentsIntoColumns = function(columnsOrGroups, parent) {
      var _this = this;
      columnsOrGroups.forEach(function(columnsOrGroup) {
        columnsOrGroup.setParent(parent);
        if (columnsOrGroup instanceof ColumnGroup) {
          var columnGroup = columnsOrGroup;
          _this.setupParentsIntoColumns(columnGroup.getChildren(), columnGroup);
        }
      });
    };
    DisplayedGroupCreator2.prototype.getOriginalPathForColumn = function(balancedColumnTree, column) {
      var result = [];
      var found = false;
      var recursePath = function(columnTree, dept) {
        for (var i = 0; i < columnTree.length; i++) {
          if (found) {
            return;
          }
          var node = columnTree[i];
          if (node instanceof ProvidedColumnGroup) {
            recursePath(node.getChildren(), dept + 1);
            result[dept] = node;
          } else if (node === column) {
            found = true;
          }
        }
      };
      recursePath(balancedColumnTree, 0);
      if (found) {
        return result;
      }
      console.warn("AG Grid: could not get path");
      return null;
    };
    DisplayedGroupCreator2 = __decorate$2u([
      Bean("displayedGroupCreator")
    ], DisplayedGroupCreator2);
    return DisplayedGroupCreator2;
  }(BeanStub)
);
var __extends$2W = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2t = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgStackComponentsRegistry = (
  /** @class */
  function(_super) {
    __extends$2W(AgStackComponentsRegistry2, _super);
    function AgStackComponentsRegistry2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.componentsMappedByName = {};
      return _this;
    }
    AgStackComponentsRegistry2.prototype.setupComponents = function(components) {
      var _this = this;
      if (components) {
        components.forEach(function(componentMeta) {
          return _this.addComponent(componentMeta);
        });
      }
    };
    AgStackComponentsRegistry2.prototype.addComponent = function(componentMeta) {
      var classEscaped = componentMeta.componentName.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
      var classUpperCase = classEscaped.toUpperCase();
      this.componentsMappedByName[classUpperCase] = componentMeta.componentClass;
    };
    AgStackComponentsRegistry2.prototype.getComponentClass = function(htmlTag) {
      return this.componentsMappedByName[htmlTag];
    };
    AgStackComponentsRegistry2 = __decorate$2t([
      Bean("agStackComponentsRegistry")
    ], AgStackComponentsRegistry2);
    return AgStackComponentsRegistry2;
  }(BeanStub)
);
function toggleAriaAttribute(element, attribute, value) {
  if (value == null || value == "") {
    removeAriaAttribute(element, attribute);
  } else {
    setAriaAttribute(element, attribute, value);
  }
}
function setAriaAttribute(element, attribute, value) {
  element.setAttribute(ariaAttributeName(attribute), value.toString());
}
function removeAriaAttribute(element, attribute) {
  element.removeAttribute(ariaAttributeName(attribute));
}
function ariaAttributeName(attribute) {
  return "aria-" + attribute;
}
function setAriaRole(element, role) {
  if (role) {
    element.setAttribute("role", role);
  } else {
    element.removeAttribute("role");
  }
}
function getAriaSortState(sortDirection) {
  var sort;
  if (sortDirection === "asc") {
    sort = "ascending";
  } else if (sortDirection === "desc") {
    sort = "descending";
  } else if (sortDirection === "mixed") {
    sort = "other";
  } else {
    sort = "none";
  }
  return sort;
}
function getAriaLevel(element) {
  return parseInt(element.getAttribute("aria-level"), 10);
}
function getAriaPosInSet(element) {
  return parseInt(element.getAttribute("aria-posinset"), 10);
}
function getAriaDescribedBy(element) {
  return element.getAttribute("aria-describedby") || "";
}
function setAriaLabel(element, label) {
  toggleAriaAttribute(element, "label", label);
}
function setAriaLabelledBy(element, labelledBy) {
  toggleAriaAttribute(element, "labelledby", labelledBy);
}
function setAriaDescription(element, description) {
  toggleAriaAttribute(element, "description", description);
}
function setAriaDescribedBy(element, describedby) {
  toggleAriaAttribute(element, "describedby", describedby);
}
function setAriaLive(element, live) {
  toggleAriaAttribute(element, "live", live);
}
function setAriaLevel(element, level) {
  toggleAriaAttribute(element, "level", level);
}
function setAriaDisabled(element, disabled) {
  toggleAriaAttribute(element, "disabled", disabled);
}
function setAriaHidden(element, hidden) {
  toggleAriaAttribute(element, "hidden", hidden);
}
function setAriaExpanded(element, expanded) {
  setAriaAttribute(element, "expanded", expanded);
}
function removeAriaExpanded(element) {
  removeAriaAttribute(element, "expanded");
}
function setAriaSetSize(element, setsize) {
  setAriaAttribute(element, "setsize", setsize);
}
function setAriaPosInSet(element, position) {
  setAriaAttribute(element, "posinset", position);
}
function setAriaMultiSelectable(element, multiSelectable) {
  setAriaAttribute(element, "multiselectable", multiSelectable);
}
function setAriaRowCount(element, rowCount) {
  setAriaAttribute(element, "rowcount", rowCount);
}
function setAriaRowIndex(element, rowIndex) {
  setAriaAttribute(element, "rowindex", rowIndex);
}
function setAriaColCount(element, colCount) {
  setAriaAttribute(element, "colcount", colCount);
}
function setAriaColIndex(element, colIndex) {
  setAriaAttribute(element, "colindex", colIndex);
}
function setAriaColSpan(element, colSpan) {
  setAriaAttribute(element, "colspan", colSpan);
}
function setAriaSort(element, sort) {
  setAriaAttribute(element, "sort", sort);
}
function removeAriaSort(element) {
  removeAriaAttribute(element, "sort");
}
function setAriaSelected(element, selected) {
  toggleAriaAttribute(element, "selected", selected);
}
function setAriaChecked(element, checked) {
  setAriaAttribute(element, "checked", checked === void 0 ? "mixed" : checked);
}
function setAriaControls(controllerElement, controlledElement) {
  toggleAriaAttribute(controllerElement, "controls", controlledElement.id);
  setAriaLabelledBy(controlledElement, controllerElement.id);
}
function getAriaCheckboxStateName(translate, state) {
  return state === void 0 ? translate("ariaIndeterminate", "indeterminate") : state === true ? translate("ariaChecked", "checked") : translate("ariaUnchecked", "unchecked");
}
var AriaUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  setAriaRole,
  getAriaSortState,
  getAriaLevel,
  getAriaPosInSet,
  getAriaDescribedBy,
  setAriaLabel,
  setAriaLabelledBy,
  setAriaDescription,
  setAriaDescribedBy,
  setAriaLive,
  setAriaLevel,
  setAriaDisabled,
  setAriaHidden,
  setAriaExpanded,
  removeAriaExpanded,
  setAriaSetSize,
  setAriaPosInSet,
  setAriaMultiSelectable,
  setAriaRowCount,
  setAriaRowIndex,
  setAriaColCount,
  setAriaColIndex,
  setAriaColSpan,
  setAriaSort,
  removeAriaSort,
  setAriaSelected,
  setAriaChecked,
  setAriaControls,
  getAriaCheckboxStateName
});
var isSafari;
var safariVersion;
var isChrome;
var isFirefox;
var isMacOs;
var isIOS;
var invisibleScrollbar;
var browserScrollbarWidth;
function isBrowserSafari() {
  if (isSafari === void 0) {
    isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
  }
  return isSafari;
}
function getSafariVersion() {
  if (safariVersion === void 0) {
    if (isBrowserSafari()) {
      var versionMatch = navigator.userAgent.match(/version\/(\d+)/i);
      if (versionMatch) {
        safariVersion = versionMatch[1] != null ? parseFloat(versionMatch[1]) : 0;
      }
    } else {
      safariVersion = 0;
    }
  }
  return safariVersion;
}
function isBrowserChrome() {
  if (isChrome === void 0) {
    var win = window;
    isChrome = !!win.chrome && (!!win.chrome.webstore || !!win.chrome.runtime) || /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);
  }
  return isChrome;
}
function isBrowserFirefox() {
  if (isFirefox === void 0) {
    isFirefox = /(firefox)/i.test(navigator.userAgent);
  }
  return isFirefox;
}
function isMacOsUserAgent() {
  if (isMacOs === void 0) {
    isMacOs = /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);
  }
  return isMacOs;
}
function isIOSUserAgent() {
  if (isIOS === void 0) {
    isIOS = /iPad|iPhone|iPod/.test(navigator.platform) || // eslint-disable-next-line
    navigator.platform === "MacIntel" && navigator.maxTouchPoints > 1;
  }
  return isIOS;
}
function browserSupportsPreventScroll() {
  return !isBrowserSafari() || getSafariVersion() >= 15;
}
function getTabIndex(el2) {
  if (!el2) {
    return null;
  }
  var numberTabIndex = el2.tabIndex;
  var tabIndex = el2.getAttribute("tabIndex");
  if (numberTabIndex === -1 && (tabIndex === null || tabIndex === "" && !isBrowserFirefox())) {
    return null;
  }
  return numberTabIndex.toString();
}
function getMaxDivHeight() {
  if (!document.body) {
    return -1;
  }
  var res = 1e6;
  var testUpTo = navigator.userAgent.toLowerCase().match(/firefox/) ? 6e6 : 1e9;
  var div = document.createElement("div");
  document.body.appendChild(div);
  while (true) {
    var test = res * 2;
    div.style.height = test + "px";
    if (test > testUpTo || div.clientHeight !== test) {
      break;
    } else {
      res = test;
    }
  }
  document.body.removeChild(div);
  return res;
}
function getBodyWidth() {
  var _a2, _b2, _c;
  return (_b2 = (_a2 = document.body) === null || _a2 === void 0 ? void 0 : _a2.clientWidth) !== null && _b2 !== void 0 ? _b2 : window.innerHeight || ((_c = document.documentElement) === null || _c === void 0 ? void 0 : _c.clientWidth) || -1;
}
function getBodyHeight() {
  var _a2, _b2, _c;
  return (_b2 = (_a2 = document.body) === null || _a2 === void 0 ? void 0 : _a2.clientHeight) !== null && _b2 !== void 0 ? _b2 : window.innerHeight || ((_c = document.documentElement) === null || _c === void 0 ? void 0 : _c.clientHeight) || -1;
}
function getScrollbarWidth() {
  if (browserScrollbarWidth == null) {
    initScrollbarWidthAndVisibility();
  }
  return browserScrollbarWidth;
}
function initScrollbarWidthAndVisibility() {
  var body = document.body;
  var div = document.createElement("div");
  div.style.width = div.style.height = "100px";
  div.style.opacity = "0";
  div.style.overflow = "scroll";
  div.style.msOverflowStyle = "scrollbar";
  div.style.position = "absolute";
  body.appendChild(div);
  var width = div.offsetWidth - div.clientWidth;
  if (width === 0 && div.clientWidth === 0) {
    width = null;
  }
  if (div.parentNode) {
    div.parentNode.removeChild(div);
  }
  if (width != null) {
    browserScrollbarWidth = width;
    invisibleScrollbar = width === 0;
  }
}
function isInvisibleScrollbar() {
  if (invisibleScrollbar == null) {
    initScrollbarWidthAndVisibility();
  }
  return invisibleScrollbar;
}
var BrowserUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  isBrowserSafari,
  getSafariVersion,
  isBrowserChrome,
  isBrowserFirefox,
  isMacOsUserAgent,
  isIOSUserAgent,
  browserSupportsPreventScroll,
  getTabIndex,
  getMaxDivHeight,
  getBodyWidth,
  getBodyHeight,
  getScrollbarWidth,
  isInvisibleScrollbar
});
function padStartWidthZeros(value, totalStringSize) {
  return value.toString().padStart(totalStringSize, "0");
}
function createArrayOfNumbers(first, last2) {
  var result = [];
  for (var i = first; i <= last2; i++) {
    result.push(i);
  }
  return result;
}
function cleanNumber(value) {
  if (typeof value === "string") {
    value = parseInt(value, 10);
  }
  if (typeof value === "number") {
    return Math.floor(value);
  }
  return null;
}
function decToHex(number, bytes) {
  var hex2 = "";
  for (var i = 0; i < bytes; i++) {
    hex2 += String.fromCharCode(number & 255);
    number >>>= 8;
  }
  return hex2;
}
function formatNumberTwoDecimalPlacesAndCommas(value, thousandSeparator, decimalSeparator) {
  if (typeof value !== "number") {
    return "";
  }
  return formatNumberCommas(Math.round(value * 100) / 100, thousandSeparator, decimalSeparator);
}
function formatNumberCommas(value, thousandSeparator, decimalSeparator) {
  if (typeof value !== "number") {
    return "";
  }
  return value.toString().replace(".", decimalSeparator).replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1" + thousandSeparator);
}
function sum(values2) {
  return values2 == null ? null : values2.reduce(function(total, value) {
    return total + value;
  }, 0);
}
function zeroOrGreater(value, defaultValue) {
  if (value >= 0) {
    return value;
  }
  return defaultValue;
}
function oneOrGreater(value, defaultValue) {
  var valueNumber = parseInt(value, 10);
  if (!isNaN(valueNumber) && isFinite(valueNumber) && valueNumber > 0) {
    return valueNumber;
  }
  return defaultValue;
}
var NumberUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  padStartWidthZeros,
  createArrayOfNumbers,
  cleanNumber,
  decToHex,
  formatNumberTwoDecimalPlacesAndCommas,
  formatNumberCommas,
  sum,
  zeroOrGreater,
  oneOrGreater
});
var __read$q = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
function serialiseDate(date, includeTime, separator) {
  if (includeTime === void 0) {
    includeTime = true;
  }
  if (separator === void 0) {
    separator = "-";
  }
  if (!date) {
    return null;
  }
  var serialised = [date.getFullYear(), date.getMonth() + 1, date.getDate()].map(function(part) {
    return padStartWidthZeros(part, 2);
  }).join(separator);
  if (includeTime) {
    serialised += " " + [date.getHours(), date.getMinutes(), date.getSeconds()].map(function(part) {
      return padStartWidthZeros(part, 2);
    }).join(":");
  }
  return serialised;
}
var calculateOrdinal = function(value) {
  if (value > 3 && value < 21) {
    return "th";
  }
  var remainder = value % 10;
  switch (remainder) {
    case 1:
      return "st";
    case 2:
      return "nd";
    case 3:
      return "rd";
  }
  return "th";
};
function dateToFormattedString(date, format2) {
  if (format2 === void 0) {
    format2 = "YYYY-MM-DD";
  }
  var fullYear = padStartWidthZeros(date.getFullYear(), 4);
  var months2 = [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December"
  ];
  var days2 = [
    "Sunday",
    "Monday",
    "Tuesday",
    "Wednesday",
    "Thursday",
    "Friday",
    "Saturday"
  ];
  var replace = {
    YYYY: function() {
      return fullYear.slice(fullYear.length - 4, fullYear.length);
    },
    YY: function() {
      return fullYear.slice(fullYear.length - 2, fullYear.length);
    },
    Y: function() {
      return "" + date.getFullYear();
    },
    MMMM: function() {
      return months2[date.getMonth()];
    },
    MMM: function() {
      return months2[date.getMonth()].slice(0, 3);
    },
    MM: function() {
      return padStartWidthZeros(date.getMonth() + 1, 2);
    },
    Mo: function() {
      return "" + (date.getMonth() + 1) + calculateOrdinal(date.getMonth() + 1);
    },
    M: function() {
      return "" + (date.getMonth() + 1);
    },
    Do: function() {
      return "" + date.getDate() + calculateOrdinal(date.getDate());
    },
    DD: function() {
      return padStartWidthZeros(date.getDate(), 2);
    },
    D: function() {
      return "" + date.getDate();
    },
    dddd: function() {
      return days2[date.getDay()];
    },
    ddd: function() {
      return days2[date.getDay()].slice(0, 3);
    },
    dd: function() {
      return days2[date.getDay()].slice(0, 2);
    },
    do: function() {
      return "" + date.getDay() + calculateOrdinal(date.getDay());
    },
    d: function() {
      return "" + date.getDay();
    }
  };
  var regexp = new RegExp(Object.keys(replace).join("|"), "g");
  return format2.replace(regexp, function(match) {
    if (match in replace) {
      return replace[match]();
    }
    return match;
  });
}
function parseDateTimeFromString(value) {
  if (!value) {
    return null;
  }
  var _a2 = __read$q(value.split(" "), 2), dateStr = _a2[0], timeStr = _a2[1];
  if (!dateStr) {
    return null;
  }
  var fields = dateStr.split("-").map(function(f2) {
    return parseInt(f2, 10);
  });
  if (fields.filter(function(f2) {
    return !isNaN(f2);
  }).length !== 3) {
    return null;
  }
  var _b2 = __read$q(fields, 3), year = _b2[0], month = _b2[1], day = _b2[2];
  var date = new Date(year, month - 1, day);
  if (date.getFullYear() !== year || date.getMonth() !== month - 1 || date.getDate() !== day) {
    return null;
  }
  if (!timeStr || timeStr === "00:00:00") {
    return date;
  }
  var _c = __read$q(timeStr.split(":").map(function(part) {
    return parseInt(part, 10);
  }), 3), hours2 = _c[0], minutes2 = _c[1], seconds2 = _c[2];
  if (hours2 >= 0 && hours2 < 24) {
    date.setHours(hours2);
  }
  if (minutes2 >= 0 && minutes2 < 60) {
    date.setMinutes(minutes2);
  }
  if (seconds2 >= 0 && seconds2 < 60) {
    date.setSeconds(seconds2);
  }
  return date;
}
var DateUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  serialiseDate,
  dateToFormattedString,
  parseDateTimeFromString
});
var __values$5 = function(o) {
  var s2 = typeof Symbol === "function" && Symbol.iterator, m2 = s2 && o[s2], i = 0;
  if (m2)
    return m2.call(o);
  if (o && typeof o.length === "number")
    return {
      next: function() {
        if (o && i >= o.length)
          o = void 0;
        return { value: o && o[i++], done: !o };
      }
    };
  throw new TypeError(s2 ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __read$p = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var rtlNegativeScroll;
function radioCssClass(element, elementClass, otherElementClass) {
  var parent = element.parentElement;
  var sibling = parent && parent.firstChild;
  while (sibling) {
    if (elementClass) {
      sibling.classList.toggle(elementClass, sibling === element);
    }
    if (otherElementClass) {
      sibling.classList.toggle(otherElementClass, sibling !== element);
    }
    sibling = sibling.nextSibling;
  }
}
var FOCUSABLE_SELECTOR = "[tabindex], input, select, button, textarea, [href]";
var FOCUSABLE_EXCLUDE = ".ag-hidden, .ag-hidden *, [disabled], .ag-disabled:not(.ag-button), .ag-disabled *";
function isFocusableFormField(element) {
  var matches = Element.prototype.matches || Element.prototype.msMatchesSelector;
  var inputSelector = "input, select, button, textarea";
  var isFocusable = matches.call(element, inputSelector);
  var isNotFocusable = matches.call(element, FOCUSABLE_EXCLUDE);
  var isElementVisible = isVisible(element);
  var focusable = isFocusable && !isNotFocusable && isElementVisible;
  return focusable;
}
function setDisplayed(element, displayed, options) {
  if (options === void 0) {
    options = {};
  }
  var skipAriaHidden = options.skipAriaHidden;
  element.classList.toggle("ag-hidden", !displayed);
  if (!skipAriaHidden) {
    setAriaHidden(element, !displayed);
  }
}
function setVisible(element, visible, options) {
  if (options === void 0) {
    options = {};
  }
  var skipAriaHidden = options.skipAriaHidden;
  element.classList.toggle("ag-invisible", !visible);
  if (!skipAriaHidden) {
    setAriaHidden(element, !visible);
  }
}
function setDisabled(element, disabled) {
  var attributeName = "disabled";
  var addOrRemoveDisabledAttribute = disabled ? function(e) {
    return e.setAttribute(attributeName, "");
  } : function(e) {
    return e.removeAttribute(attributeName);
  };
  addOrRemoveDisabledAttribute(element);
  nodeListForEach(element.querySelectorAll("input"), function(input) {
    return addOrRemoveDisabledAttribute(input);
  });
}
function isElementChildOfClass(element, cls, maxNest) {
  var counter2 = 0;
  while (element) {
    if (element.classList.contains(cls)) {
      return true;
    }
    element = element.parentElement;
    if (typeof maxNest == "number") {
      if (++counter2 > maxNest) {
        break;
      }
    } else if (element === maxNest) {
      break;
    }
  }
  return false;
}
function getElementSize(el2) {
  var _a2 = window.getComputedStyle(el2), height = _a2.height, width = _a2.width, borderTopWidth = _a2.borderTopWidth, borderRightWidth = _a2.borderRightWidth, borderBottomWidth = _a2.borderBottomWidth, borderLeftWidth = _a2.borderLeftWidth, paddingTop = _a2.paddingTop, paddingRight = _a2.paddingRight, paddingBottom = _a2.paddingBottom, paddingLeft = _a2.paddingLeft, marginTop = _a2.marginTop, marginRight = _a2.marginRight, marginBottom = _a2.marginBottom, marginLeft = _a2.marginLeft, boxSizing = _a2.boxSizing;
  return {
    height: parseFloat(height),
    width: parseFloat(width),
    borderTopWidth: parseFloat(borderTopWidth),
    borderRightWidth: parseFloat(borderRightWidth),
    borderBottomWidth: parseFloat(borderBottomWidth),
    borderLeftWidth: parseFloat(borderLeftWidth),
    paddingTop: parseFloat(paddingTop),
    paddingRight: parseFloat(paddingRight),
    paddingBottom: parseFloat(paddingBottom),
    paddingLeft: parseFloat(paddingLeft),
    marginTop: parseFloat(marginTop),
    marginRight: parseFloat(marginRight),
    marginBottom: parseFloat(marginBottom),
    marginLeft: parseFloat(marginLeft),
    boxSizing
  };
}
function getInnerHeight(el2) {
  var size = getElementSize(el2);
  if (size.boxSizing === "border-box") {
    return size.height - size.paddingTop - size.paddingBottom;
  }
  return size.height;
}
function getInnerWidth(el2) {
  var size = getElementSize(el2);
  if (size.boxSizing === "border-box") {
    return size.width - size.paddingLeft - size.paddingRight;
  }
  return size.width;
}
function getAbsoluteHeight(el2) {
  var size = getElementSize(el2);
  var marginRight = size.marginBottom + size.marginTop;
  return Math.ceil(el2.offsetHeight + marginRight);
}
function getAbsoluteWidth(el2) {
  var size = getElementSize(el2);
  var marginWidth = size.marginLeft + size.marginRight;
  return Math.ceil(el2.offsetWidth + marginWidth);
}
function getElementRectWithOffset(el2) {
  var offsetElementRect = el2.getBoundingClientRect();
  var _a2 = getElementSize(el2), borderTopWidth = _a2.borderTopWidth, borderLeftWidth = _a2.borderLeftWidth, borderRightWidth = _a2.borderRightWidth, borderBottomWidth = _a2.borderBottomWidth;
  return {
    top: offsetElementRect.top + (borderTopWidth || 0),
    left: offsetElementRect.left + (borderLeftWidth || 0),
    right: offsetElementRect.right + (borderRightWidth || 0),
    bottom: offsetElementRect.bottom + (borderBottomWidth || 0)
  };
}
function isRtlNegativeScroll() {
  if (typeof rtlNegativeScroll === "boolean") {
    return rtlNegativeScroll;
  }
  var template = document.createElement("div");
  template.style.direction = "rtl";
  template.style.width = "1px";
  template.style.height = "1px";
  template.style.position = "fixed";
  template.style.top = "0px";
  template.style.overflow = "hidden";
  template.dir = "rtl";
  template.innerHTML = /* html */
  '<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>';
  document.body.appendChild(template);
  template.scrollLeft = 1;
  rtlNegativeScroll = Math.floor(template.scrollLeft) === 0;
  document.body.removeChild(template);
  return rtlNegativeScroll;
}
function getScrollLeft(element, rtl) {
  var scrollLeft = element.scrollLeft;
  if (rtl) {
    scrollLeft = Math.abs(scrollLeft);
    if (isBrowserChrome() && !isRtlNegativeScroll()) {
      scrollLeft = element.scrollWidth - element.clientWidth - scrollLeft;
    }
  }
  return scrollLeft;
}
function setScrollLeft(element, value, rtl) {
  if (rtl) {
    if (isRtlNegativeScroll()) {
      value *= -1;
    } else if (isBrowserSafari() || isBrowserChrome()) {
      value = element.scrollWidth - element.clientWidth - value;
    }
  }
  element.scrollLeft = value;
}
function clearElement(el2) {
  while (el2 && el2.firstChild) {
    el2.removeChild(el2.firstChild);
  }
}
function removeElement(parent, cssSelector) {
  removeFromParent(parent.querySelector(cssSelector));
}
function removeFromParent(node) {
  if (node && node.parentNode) {
    node.parentNode.removeChild(node);
  }
}
function isVisible(element) {
  return element.offsetParent !== null;
}
function loadTemplate(template) {
  var tempDiv = document.createElement("div");
  tempDiv.innerHTML = (template || "").trim();
  return tempDiv.firstChild;
}
function appendHtml(eContainer, htmlTemplate) {
  if (eContainer.lastChild) {
    eContainer.insertAdjacentHTML("afterbegin", htmlTemplate);
  } else {
    eContainer.innerHTML = htmlTemplate;
  }
}
function getElementAttribute(element, attributeName) {
  if (element.attributes && element.attributes[attributeName]) {
    var attribute = element.attributes[attributeName];
    return attribute.value;
  }
  return null;
}
function offsetHeight(element) {
  return element && element.clientHeight ? element.clientHeight : 0;
}
function offsetWidth(element) {
  return element && element.clientWidth ? element.clientWidth : 0;
}
function ensureDomOrder(eContainer, eChild, eChildBefore) {
  if (eChildBefore && eChildBefore.nextSibling === eChild) {
    return;
  }
  var focusedEl = document.activeElement;
  var eChildHasFocus = eChild.contains(focusedEl);
  if (eChildBefore) {
    if (eChildBefore.nextSibling) {
      eContainer.insertBefore(eChild, eChildBefore.nextSibling);
    } else {
      eContainer.appendChild(eChild);
    }
  } else {
    if (eContainer.firstChild && eContainer.firstChild !== eChild) {
      eContainer.insertAdjacentElement("afterbegin", eChild);
    }
  }
  if (eChildHasFocus && focusedEl && browserSupportsPreventScroll()) {
    focusedEl.focus({ preventScroll: true });
  }
}
function setDomChildOrder(eContainer, orderedChildren) {
  for (var i = 0; i < orderedChildren.length; i++) {
    var correctCellAtIndex = orderedChildren[i];
    var actualCellAtIndex = eContainer.children[i];
    if (actualCellAtIndex !== correctCellAtIndex) {
      eContainer.insertBefore(correctCellAtIndex, actualCellAtIndex);
    }
  }
}
function insertWithDomOrder(eContainer, eToInsert, eChildBefore) {
  if (eChildBefore) {
    eChildBefore.insertAdjacentElement("afterend", eToInsert);
  } else {
    if (eContainer.firstChild) {
      eContainer.insertAdjacentElement("afterbegin", eToInsert);
    } else {
      eContainer.appendChild(eToInsert);
    }
  }
}
function prependDC(parent, documentFragment) {
  if (exists(parent.firstChild)) {
    parent.insertBefore(documentFragment, parent.firstChild);
  } else {
    parent.appendChild(documentFragment);
  }
}
function addStylesToElement(eElement, styles) {
  var e_1, _a2;
  if (!styles) {
    return;
  }
  try {
    for (var _b2 = __values$5(Object.entries(styles)), _c = _b2.next(); !_c.done; _c = _b2.next()) {
      var _d = __read$p(_c.value, 2), key = _d[0], value = _d[1];
      if (!key || !key.length || value == null) {
        continue;
      }
      var parsedKey = camelCaseToHyphenated(key);
      var valueAsString = value.toString();
      var parsedValue = valueAsString.replace(/\s*!important/g, "");
      var priority = parsedValue.length != valueAsString.length ? "important" : void 0;
      eElement.style.setProperty(parsedKey, parsedValue, priority);
    }
  } catch (e_1_1) {
    e_1 = { error: e_1_1 };
  } finally {
    try {
      if (_c && !_c.done && (_a2 = _b2.return))
        _a2.call(_b2);
    } finally {
      if (e_1)
        throw e_1.error;
    }
  }
}
function isHorizontalScrollShowing(element) {
  return element.clientWidth < element.scrollWidth;
}
function isVerticalScrollShowing(element) {
  return element.clientHeight < element.scrollHeight;
}
function setElementWidth(element, width) {
  if (width === "flex") {
    element.style.removeProperty("width");
    element.style.removeProperty("minWidth");
    element.style.removeProperty("maxWidth");
    element.style.flex = "1 1 auto";
  } else {
    setFixedWidth(element, width);
  }
}
function setFixedWidth(element, width) {
  width = formatSize(width);
  element.style.width = width.toString();
  element.style.maxWidth = width.toString();
  element.style.minWidth = width.toString();
}
function setElementHeight(element, height) {
  if (height === "flex") {
    element.style.removeProperty("height");
    element.style.removeProperty("minHeight");
    element.style.removeProperty("maxHeight");
    element.style.flex = "1 1 auto";
  } else {
    setFixedHeight(element, height);
  }
}
function setFixedHeight(element, height) {
  height = formatSize(height);
  element.style.height = height.toString();
  element.style.maxHeight = height.toString();
  element.style.minHeight = height.toString();
}
function formatSize(size) {
  if (typeof size === "number") {
    return size + "px";
  }
  return size;
}
function isNodeOrElement(o) {
  return o instanceof Node || o instanceof HTMLElement;
}
function copyNodeList(nodeList) {
  if (nodeList == null) {
    return [];
  }
  var result = [];
  nodeListForEach(nodeList, function(node) {
    return result.push(node);
  });
  return result;
}
function iterateNamedNodeMap(map2, callback2) {
  if (!map2) {
    return;
  }
  for (var i = 0; i < map2.length; i++) {
    var attr = map2[i];
    callback2(attr.name, attr.value);
  }
}
function addOrRemoveAttribute(element, name, value) {
  if (value == null) {
    element.removeAttribute(name);
  } else {
    element.setAttribute(name, value.toString());
  }
}
function nodeListForEach(nodeList, action) {
  if (nodeList == null) {
    return;
  }
  for (var i = 0; i < nodeList.length; i++) {
    action(nodeList[i]);
  }
}
var DomUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  radioCssClass,
  FOCUSABLE_SELECTOR,
  FOCUSABLE_EXCLUDE,
  isFocusableFormField,
  setDisplayed,
  setVisible,
  setDisabled,
  isElementChildOfClass,
  getElementSize,
  getInnerHeight,
  getInnerWidth,
  getAbsoluteHeight,
  getAbsoluteWidth,
  getElementRectWithOffset,
  isRtlNegativeScroll,
  getScrollLeft,
  setScrollLeft,
  clearElement,
  removeElement,
  removeFromParent,
  isVisible,
  loadTemplate,
  appendHtml,
  getElementAttribute,
  offsetHeight,
  offsetWidth,
  ensureDomOrder,
  setDomChildOrder,
  insertWithDomOrder,
  prependDC,
  addStylesToElement,
  isHorizontalScrollShowing,
  isVerticalScrollShowing,
  setElementWidth,
  setFixedWidth,
  setElementHeight,
  setFixedHeight,
  formatSize,
  isNodeOrElement,
  copyNodeList,
  iterateNamedNodeMap,
  addOrRemoveAttribute,
  nodeListForEach
});
var iconNameClassMap = {
  // header column group shown when expanded (click to contract)
  columnGroupOpened: "expanded",
  // header column group shown when contracted (click to expand)
  columnGroupClosed: "contracted",
  // tool panel column group contracted (click to expand)
  columnSelectClosed: "tree-closed",
  // tool panel column group expanded (click to contract)
  columnSelectOpen: "tree-open",
  // column tool panel header expand/collapse all button, shown when some children are expanded and
  //     others are collapsed
  columnSelectIndeterminate: "tree-indeterminate",
  // shown on ghost icon while dragging column to the side of the grid to pin
  columnMovePin: "pin",
  // shown on ghost icon while dragging over part of the page that is not a drop zone
  columnMoveHide: "eye-slash",
  // shown on ghost icon while dragging columns to reorder
  columnMoveMove: "arrows",
  // animating icon shown when dragging a column to the right of the grid causes horizontal scrolling
  columnMoveLeft: "left",
  // animating icon shown when dragging a column to the left of the grid causes horizontal scrolling
  columnMoveRight: "right",
  // shown on ghost icon while dragging over Row Groups drop zone
  columnMoveGroup: "group",
  // shown on ghost icon while dragging over Values drop zone
  columnMoveValue: "aggregation",
  // shown on ghost icon while dragging over pivot drop zone
  columnMovePivot: "pivot",
  // shown on ghost icon while dragging over drop zone that doesn't support it, e.g.
  //     string column over aggregation drop zone
  dropNotAllowed: "not-allowed",
  // shown on row group when contracted (click to expand)
  groupContracted: "tree-closed",
  // shown on row group when expanded (click to contract)
  groupExpanded: "tree-open",
  // set filter tree list group contracted (click to expand)
  setFilterGroupClosed: "tree-closed",
  // set filter tree list group expanded (click to contract)
  setFilterGroupOpen: "tree-open",
  // set filter tree list expand/collapse all button, shown when some children are expanded and
  //     others are collapsed
  setFilterGroupIndeterminate: "tree-indeterminate",
  // context menu chart item
  chart: "chart",
  // chart window title bar
  close: "cross",
  // X (remove) on column 'pill' after adding it to a drop zone list
  cancel: "cancel",
  // indicates the currently active pin state in the "Pin column" sub-menu of the column menu
  check: "tick",
  // "go to first" button in pagination controls
  first: "first",
  // "go to previous" button in pagination controls
  previous: "previous",
  // "go to next" button in pagination controls
  next: "next",
  // "go to last" button in pagination controls
  last: "last",
  // shown on top right of chart when chart is linked to range data (click to unlink)
  linked: "linked",
  // shown on top right of chart when chart is not linked to range data (click to link)
  unlinked: "unlinked",
  // "Choose colour" button on chart settings tab
  colorPicker: "color-picker",
  // rotating spinner shown by the loading cell renderer
  groupLoading: "loading",
  // button to launch enterprise column menu
  menu: "menu",
  // filter tool panel tab
  filter: "filter",
  // column tool panel tab
  columns: "columns",
  // button in chart regular size window title bar (click to maximise)
  maximize: "maximize",
  // button in chart maximised window title bar (click to make regular size)
  minimize: "minimize",
  // "Pin column" item in column header menu
  menuPin: "pin",
  // "Value aggregation" column menu item (shown on numeric columns when grouping is active)"
  menuValue: "aggregation",
  // "Group by {column-name}" item in column header menu
  menuAddRowGroup: "group",
  // "Un-Group by {column-name}" item in column header menu
  menuRemoveRowGroup: "group",
  // context menu copy item
  clipboardCopy: "copy",
  // context menu cut item
  clipboardCut: "cut",
  // context menu paste item
  clipboardPaste: "paste",
  // identifies the pivot drop zone
  pivotPanel: "pivot",
  // "Row groups" drop zone in column tool panel
  rowGroupPanel: "group",
  // columns tool panel Values drop zone
  valuePanel: "aggregation",
  // drag handle used to pick up draggable columns
  columnDrag: "grip",
  // drag handle used to pick up draggable rows
  rowDrag: "grip",
  // context menu export item
  save: "save",
  // csv export
  csvExport: "csv",
  // excel export,
  excelExport: "excel",
  // icon on dropdown editors
  smallDown: "small-down",
  // version of small-right used in RTL mode
  smallLeft: "small-left",
  // separater between column 'pills' when you add multiple columns to the header drop zone
  smallRight: "small-right",
  smallUp: "small-up",
  // show on column header when column is sorted ascending
  sortAscending: "asc",
  // show on column header when column is sorted descending
  sortDescending: "desc",
  // show on column header when column has no sort, only when enabled with gridOptions.unSortIcon=true
  sortUnSort: "none"
};
function createIcon(iconName, gridOptionsService, column) {
  var iconContents = createIconNoSpan(iconName, gridOptionsService, column);
  if (iconContents) {
    var className = iconContents.className;
    if (typeof className === "string" && className.indexOf("ag-icon") > -1 || typeof className === "object" && className["ag-icon"]) {
      return iconContents;
    }
  }
  var eResult = document.createElement("span");
  eResult.appendChild(iconContents);
  return eResult;
}
function createIconNoSpan(iconName, gridOptionsService, column, forceCreate) {
  var userProvidedIcon = null;
  var icons = column && column.getColDef().icons;
  if (icons) {
    userProvidedIcon = icons[iconName];
  }
  if (gridOptionsService && !userProvidedIcon) {
    var optionsIcons = gridOptionsService.get("icons");
    if (optionsIcons) {
      userProvidedIcon = optionsIcons[iconName];
    }
  }
  if (userProvidedIcon) {
    var rendererResult = void 0;
    if (typeof userProvidedIcon === "function") {
      rendererResult = userProvidedIcon();
    } else if (typeof userProvidedIcon === "string") {
      rendererResult = userProvidedIcon;
    } else {
      throw new Error("icon from grid options needs to be a string or a function");
    }
    if (typeof rendererResult === "string") {
      return loadTemplate(rendererResult);
    }
    if (isNodeOrElement(rendererResult)) {
      return rendererResult;
    }
    console.warn("AG Grid: iconRenderer should return back a string or a dom object");
  } else {
    var span = document.createElement("span");
    var cssClass = iconNameClassMap[iconName];
    if (!cssClass) {
      if (!forceCreate) {
        console.warn("AG Grid: Did not find icon " + iconName);
        cssClass = "";
      } else {
        cssClass = iconName;
      }
    }
    span.setAttribute("class", "ag-icon ag-icon-" + cssClass);
    span.setAttribute("unselectable", "on");
    setAriaRole(span, "presentation");
    return span;
  }
}
var IconUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  iconNameClassMap,
  createIcon,
  createIconNoSpan
});
var KeyCode = (
  /** @class */
  function() {
    function KeyCode2() {
    }
    KeyCode2.BACKSPACE = "Backspace";
    KeyCode2.TAB = "Tab";
    KeyCode2.ENTER = "Enter";
    KeyCode2.ESCAPE = "Escape";
    KeyCode2.SPACE = " ";
    KeyCode2.LEFT = "ArrowLeft";
    KeyCode2.UP = "ArrowUp";
    KeyCode2.RIGHT = "ArrowRight";
    KeyCode2.DOWN = "ArrowDown";
    KeyCode2.DELETE = "Delete";
    KeyCode2.F2 = "F2";
    KeyCode2.PAGE_UP = "PageUp";
    KeyCode2.PAGE_DOWN = "PageDown";
    KeyCode2.PAGE_HOME = "Home";
    KeyCode2.PAGE_END = "End";
    KeyCode2.A = "KeyA";
    KeyCode2.C = "KeyC";
    KeyCode2.D = "KeyD";
    KeyCode2.V = "KeyV";
    KeyCode2.X = "KeyX";
    KeyCode2.Y = "KeyY";
    KeyCode2.Z = "KeyZ";
    return KeyCode2;
  }()
);
var A_KEYCODE = 65;
var C_KEYCODE = 67;
var V_KEYCODE = 86;
var D_KEYCODE = 68;
var Z_KEYCODE = 90;
var Y_KEYCODE = 89;
function isEventFromPrintableCharacter(event) {
  if (event.altKey || event.ctrlKey || event.metaKey) {
    return false;
  }
  var printableCharacter = event.key.length === 1;
  return printableCharacter;
}
function isUserSuppressingKeyboardEvent(gridOptionsService, keyboardEvent, rowNode, column, editing) {
  var colDefFunc = column ? column.getColDef().suppressKeyboardEvent : void 0;
  if (!colDefFunc) {
    return false;
  }
  var params = {
    event: keyboardEvent,
    editing,
    column,
    api: gridOptionsService.api,
    node: rowNode,
    data: rowNode.data,
    colDef: column.getColDef(),
    context: gridOptionsService.context,
    columnApi: gridOptionsService.columnApi
  };
  if (colDefFunc) {
    var colDefFuncResult = colDefFunc(params);
    if (colDefFuncResult) {
      return true;
    }
  }
  return false;
}
function isUserSuppressingHeaderKeyboardEvent(gridOptionsService, keyboardEvent, headerRowIndex, column) {
  var colDef = column.getDefinition();
  var colDefFunc = colDef && colDef.suppressHeaderKeyboardEvent;
  if (!exists(colDefFunc)) {
    return false;
  }
  var params = {
    api: gridOptionsService.api,
    columnApi: gridOptionsService.columnApi,
    context: gridOptionsService.context,
    colDef,
    column,
    headerRowIndex,
    event: keyboardEvent
  };
  return !!colDefFunc(params);
}
function normaliseQwertyAzerty(keyboardEvent) {
  var keyCode = keyboardEvent.keyCode;
  var code;
  switch (keyCode) {
    case A_KEYCODE:
      code = KeyCode.A;
      break;
    case C_KEYCODE:
      code = KeyCode.C;
      break;
    case V_KEYCODE:
      code = KeyCode.V;
      break;
    case D_KEYCODE:
      code = KeyCode.D;
      break;
    case Z_KEYCODE:
      code = KeyCode.Z;
      break;
    case Y_KEYCODE:
      code = KeyCode.Y;
      break;
    default:
      code = keyboardEvent.code;
  }
  return code;
}
function isDeleteKey(key, alwaysReturnFalseOnBackspace) {
  if (alwaysReturnFalseOnBackspace === void 0) {
    alwaysReturnFalseOnBackspace = false;
  }
  if (key === KeyCode.DELETE) {
    return true;
  }
  if (!alwaysReturnFalseOnBackspace && key === KeyCode.BACKSPACE) {
    return isMacOsUserAgent();
  }
  return false;
}
var KeyboardUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  isEventFromPrintableCharacter,
  isUserSuppressingKeyboardEvent,
  isUserSuppressingHeaderKeyboardEvent,
  normaliseQwertyAzerty,
  isDeleteKey
});
function areEventsNear(e1, e2, pixelCount) {
  if (pixelCount === 0) {
    return false;
  }
  var diffX = Math.abs(e1.clientX - e2.clientX);
  var diffY = Math.abs(e1.clientY - e2.clientY);
  return Math.max(diffX, diffY) <= pixelCount;
}
var MouseUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  areEventsNear
});
function sortRowNodesByOrder(rowNodes, rowNodeOrder) {
  if (!rowNodes) {
    return false;
  }
  var comparator = function(nodeA, nodeB) {
    var positionA = rowNodeOrder[nodeA.id];
    var positionB = rowNodeOrder[nodeB.id];
    var aHasIndex = positionA !== void 0;
    var bHasIndex = positionB !== void 0;
    var bothNodesAreUserNodes = aHasIndex && bHasIndex;
    var bothNodesAreFillerNodes = !aHasIndex && !bHasIndex;
    if (bothNodesAreUserNodes) {
      return positionA - positionB;
    }
    if (bothNodesAreFillerNodes) {
      return nodeA.__objectId - nodeB.__objectId;
    }
    if (aHasIndex) {
      return 1;
    }
    return -1;
  };
  var rowNodeA;
  var rowNodeB;
  var atLeastOneOutOfOrder = false;
  for (var i = 0; i < rowNodes.length - 1; i++) {
    rowNodeA = rowNodes[i];
    rowNodeB = rowNodes[i + 1];
    if (comparator(rowNodeA, rowNodeB) > 0) {
      atLeastOneOutOfOrder = true;
      break;
    }
  }
  if (atLeastOneOutOfOrder) {
    rowNodes.sort(comparator);
    return true;
  }
  return false;
}
function traverseNodesWithKey(nodes, callback2) {
  var keyParts = [];
  recursiveSearchNodes(nodes);
  function recursiveSearchNodes(currentNodes) {
    if (!currentNodes) {
      return;
    }
    currentNodes.forEach(function(node) {
      if (node.group || node.hasChildren()) {
        keyParts.push(node.key);
        var key = keyParts.join("|");
        callback2(node, key);
        recursiveSearchNodes(node.childrenAfterGroup);
        keyParts.pop();
      }
    });
  }
}
var RowNodeUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  sortRowNodesByOrder,
  traverseNodesWithKey
});
function convertToSet(list) {
  var set2 = /* @__PURE__ */ new Set();
  list.forEach(function(x2) {
    return set2.add(x2);
  });
  return set2;
}
var SetUtils = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  convertToSet
});
var __assign$k = function() {
  __assign$k = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$k.apply(this, arguments);
};
var utils$1 = __assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k(__assign$k({}, AriaUtils), ArrayUtils), BrowserUtils), DateUtils), DomUtils), EventUtils), FunctionUtils), FuzzyMatchUtils), GenericUtils), IconUtils), KeyboardUtils), MapUtils), MouseUtils), NumberUtils), ObjectUtils), RowNodeUtils), SetUtils), StringUtils);
var _ = utils$1;
var NumberSequence = (
  /** @class */
  function() {
    function NumberSequence2(initValue, step) {
      if (initValue === void 0) {
        initValue = 0;
      }
      if (step === void 0) {
        step = 1;
      }
      this.nextValue = initValue;
      this.step = step;
    }
    NumberSequence2.prototype.next = function() {
      var valToReturn = this.nextValue;
      this.nextValue += this.step;
      return valToReturn;
    };
    NumberSequence2.prototype.peek = function() {
      return this.nextValue;
    };
    NumberSequence2.prototype.skip = function(count) {
      this.nextValue += count;
    };
    return NumberSequence2;
  }()
);
var AgPromiseStatus;
(function(AgPromiseStatus2) {
  AgPromiseStatus2[AgPromiseStatus2["IN_PROGRESS"] = 0] = "IN_PROGRESS";
  AgPromiseStatus2[AgPromiseStatus2["RESOLVED"] = 1] = "RESOLVED";
})(AgPromiseStatus || (AgPromiseStatus = {}));
var AgPromise = (
  /** @class */
  function() {
    function AgPromise2(callback2) {
      var _this = this;
      this.status = AgPromiseStatus.IN_PROGRESS;
      this.resolution = null;
      this.waiters = [];
      callback2(function(value) {
        return _this.onDone(value);
      }, function(params) {
        return _this.onReject(params);
      });
    }
    AgPromise2.all = function(promises) {
      return new AgPromise2(function(resolve2) {
        var remainingToResolve = promises.length;
        var combinedValues = new Array(remainingToResolve);
        promises.forEach(function(promise, index2) {
          promise.then(function(value) {
            combinedValues[index2] = value;
            remainingToResolve--;
            if (remainingToResolve === 0) {
              resolve2(combinedValues);
            }
          });
        });
      });
    };
    AgPromise2.resolve = function(value) {
      if (value === void 0) {
        value = null;
      }
      return new AgPromise2(function(resolve2) {
        return resolve2(value);
      });
    };
    AgPromise2.prototype.then = function(func) {
      var _this = this;
      return new AgPromise2(function(resolve2) {
        if (_this.status === AgPromiseStatus.RESOLVED) {
          resolve2(func(_this.resolution));
        } else {
          _this.waiters.push(function(value) {
            return resolve2(func(value));
          });
        }
      });
    };
    AgPromise2.prototype.resolveNow = function(ifNotResolvedValue, ifResolved) {
      return this.status === AgPromiseStatus.RESOLVED ? ifResolved(this.resolution) : ifNotResolvedValue;
    };
    AgPromise2.prototype.onDone = function(value) {
      this.status = AgPromiseStatus.RESOLVED;
      this.resolution = value;
      this.waiters.forEach(function(waiter) {
        return waiter(value);
      });
    };
    AgPromise2.prototype.onReject = function(params) {
      console.warn("TBI");
    };
    return AgPromise2;
  }()
);
var Timer = (
  /** @class */
  function() {
    function Timer2() {
      this.timestamp = (/* @__PURE__ */ new Date()).getTime();
    }
    Timer2.prototype.print = function(msg) {
      var duration = (/* @__PURE__ */ new Date()).getTime() - this.timestamp;
      console.info(msg + " = " + duration);
      this.timestamp = (/* @__PURE__ */ new Date()).getTime();
    };
    return Timer2;
  }()
);
var __extends$2V = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$j = function() {
  __assign$j = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$j.apply(this, arguments);
};
var __decorate$2s = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var TooltipStates;
(function(TooltipStates2) {
  TooltipStates2[TooltipStates2["NOTHING"] = 0] = "NOTHING";
  TooltipStates2[TooltipStates2["WAITING_TO_SHOW"] = 1] = "WAITING_TO_SHOW";
  TooltipStates2[TooltipStates2["SHOWING"] = 2] = "SHOWING";
})(TooltipStates || (TooltipStates = {}));
var CustomTooltipFeature = (
  /** @class */
  function(_super) {
    __extends$2V(CustomTooltipFeature2, _super);
    function CustomTooltipFeature2(parentComp) {
      var _this = _super.call(this) || this;
      _this.DEFAULT_SHOW_TOOLTIP_DELAY = 2e3;
      _this.DEFAULT_HIDE_TOOLTIP_DELAY = 1e4;
      _this.SHOW_QUICK_TOOLTIP_DIFF = 1e3;
      _this.FADE_OUT_TOOLTIP_TIMEOUT = 1e3;
      _this.state = TooltipStates.NOTHING;
      _this.tooltipInstanceCount = 0;
      _this.tooltipMouseTrack = false;
      _this.parentComp = parentComp;
      return _this;
    }
    CustomTooltipFeature2.prototype.postConstruct = function() {
      this.tooltipShowDelay = this.getTooltipDelay("show") || this.DEFAULT_SHOW_TOOLTIP_DELAY;
      this.tooltipHideDelay = this.getTooltipDelay("hide") || this.DEFAULT_HIDE_TOOLTIP_DELAY;
      this.tooltipMouseTrack = this.gridOptionsService.is("tooltipMouseTrack");
      var el2 = this.parentComp.getGui();
      this.addManagedListener(el2, "mouseenter", this.onMouseEnter.bind(this));
      this.addManagedListener(el2, "mouseleave", this.onMouseLeave.bind(this));
      this.addManagedListener(el2, "mousemove", this.onMouseMove.bind(this));
      this.addManagedListener(el2, "mousedown", this.onMouseDown.bind(this));
      this.addManagedListener(el2, "keydown", this.onKeyDown.bind(this));
    };
    CustomTooltipFeature2.prototype.destroy = function() {
      this.setToDoNothing();
      _super.prototype.destroy.call(this);
    };
    CustomTooltipFeature2.prototype.onMouseEnter = function(e) {
      if (isIOSUserAgent()) {
        return;
      }
      if (this.state != TooltipStates.NOTHING) {
        return;
      }
      var delay = this.isLastTooltipHiddenRecently() ? 200 : this.tooltipShowDelay;
      this.showTooltipTimeoutId = window.setTimeout(this.showTooltip.bind(this), delay);
      this.lastMouseEvent = e;
      this.state = TooltipStates.WAITING_TO_SHOW;
    };
    CustomTooltipFeature2.prototype.onMouseLeave = function() {
      this.setToDoNothing();
    };
    CustomTooltipFeature2.prototype.onKeyDown = function() {
      this.setToDoNothing();
    };
    CustomTooltipFeature2.prototype.setToDoNothing = function() {
      if (this.state === TooltipStates.SHOWING) {
        this.hideTooltip();
      }
      this.clearTimeouts();
      this.state = TooltipStates.NOTHING;
    };
    CustomTooltipFeature2.prototype.onMouseMove = function(e) {
      this.lastMouseEvent = e;
      if (this.tooltipMouseTrack && this.state === TooltipStates.SHOWING && this.tooltipComp) {
        this.positionTooltipUnderLastMouseEvent();
      }
    };
    CustomTooltipFeature2.prototype.onMouseDown = function() {
      this.setToDoNothing();
    };
    CustomTooltipFeature2.prototype.getTooltipDelay = function(type) {
      var tooltipShowDelay = this.gridOptionsService.getNum("tooltipShowDelay");
      var tooltipHideDelay = this.gridOptionsService.getNum("tooltipHideDelay");
      var delay = type === "show" ? tooltipShowDelay : tooltipHideDelay;
      var capitalisedType = capitalise(type);
      if (exists(delay)) {
        if (delay < 0) {
          doOnce(function() {
            return console.warn("AG Grid: tooltip" + capitalisedType + "Delay should not be lower than 0");
          }, "tooltip" + capitalisedType + "DelayWarn");
        }
        return Math.max(200, delay);
      }
      return null;
    };
    CustomTooltipFeature2.prototype.hideTooltip = function() {
      if (this.tooltipComp) {
        this.destroyTooltipComp();
        CustomTooltipFeature2.lastTooltipHideTime = (/* @__PURE__ */ new Date()).getTime();
      }
      this.state = TooltipStates.NOTHING;
    };
    CustomTooltipFeature2.prototype.destroyTooltipComp = function() {
      var _this = this;
      this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");
      var tooltipPopupDestroyFunc = this.tooltipPopupDestroyFunc;
      var tooltipComp = this.tooltipComp;
      window.setTimeout(function() {
        tooltipPopupDestroyFunc();
        _this.getContext().destroyBean(tooltipComp);
      }, this.FADE_OUT_TOOLTIP_TIMEOUT);
      this.tooltipPopupDestroyFunc = void 0;
      this.tooltipComp = void 0;
    };
    CustomTooltipFeature2.prototype.isLastTooltipHiddenRecently = function() {
      var now2 = (/* @__PURE__ */ new Date()).getTime();
      var then = CustomTooltipFeature2.lastTooltipHideTime;
      return now2 - then < this.SHOW_QUICK_TOOLTIP_DIFF;
    };
    CustomTooltipFeature2.prototype.showTooltip = function() {
      var params = __assign$j({}, this.parentComp.getTooltipParams());
      if (!exists(params.value)) {
        this.setToDoNothing();
        return;
      }
      this.state = TooltipStates.SHOWING;
      this.tooltipInstanceCount++;
      var callback2 = this.newTooltipComponentCallback.bind(this, this.tooltipInstanceCount);
      var userDetails = this.userComponentFactory.getTooltipCompDetails(params);
      userDetails.newAgStackInstance().then(callback2);
    };
    CustomTooltipFeature2.prototype.newTooltipComponentCallback = function(tooltipInstanceCopy, tooltipComp) {
      var compNoLongerNeeded = this.state !== TooltipStates.SHOWING || this.tooltipInstanceCount !== tooltipInstanceCopy;
      if (compNoLongerNeeded) {
        this.getContext().destroyBean(tooltipComp);
        return;
      }
      var eGui = tooltipComp.getGui();
      this.tooltipComp = tooltipComp;
      if (!eGui.classList.contains("ag-tooltip")) {
        eGui.classList.add("ag-tooltip-custom");
      }
      var translate = this.localeService.getLocaleTextFunc();
      var addPopupRes = this.popupService.addPopup({
        eChild: eGui,
        ariaLabel: translate("ariaLabelTooltip", "Tooltip")
      });
      if (addPopupRes) {
        this.tooltipPopupDestroyFunc = addPopupRes.hideFunc;
      }
      this.positionTooltipUnderLastMouseEvent();
      this.hideTooltipTimeoutId = window.setTimeout(this.hideTooltip.bind(this), this.tooltipHideDelay);
    };
    CustomTooltipFeature2.prototype.positionTooltipUnderLastMouseEvent = function() {
      this.popupService.positionPopupUnderMouseEvent({
        type: "tooltip",
        mouseEvent: this.lastMouseEvent,
        ePopup: this.tooltipComp.getGui(),
        nudgeY: 18,
        skipObserver: this.tooltipMouseTrack
      });
    };
    CustomTooltipFeature2.prototype.clearTimeouts = function() {
      if (this.showTooltipTimeoutId) {
        window.clearTimeout(this.showTooltipTimeoutId);
        this.showTooltipTimeoutId = void 0;
      }
      if (this.hideTooltipTimeoutId) {
        window.clearTimeout(this.hideTooltipTimeoutId);
        this.hideTooltipTimeoutId = void 0;
      }
    };
    __decorate$2s([
      Autowired("popupService")
    ], CustomTooltipFeature2.prototype, "popupService", void 0);
    __decorate$2s([
      Autowired("userComponentFactory")
    ], CustomTooltipFeature2.prototype, "userComponentFactory", void 0);
    __decorate$2s([
      PostConstruct
    ], CustomTooltipFeature2.prototype, "postConstruct", null);
    return CustomTooltipFeature2;
  }(BeanStub)
);
var CssClassManager = (
  /** @class */
  function() {
    function CssClassManager2(getGui) {
      this.cssClassStates = {};
      this.getGui = getGui;
    }
    CssClassManager2.prototype.addCssClass = function(className) {
      var _this = this;
      var list = (className || "").split(" ");
      if (list.length > 1) {
        list.forEach(function(cls) {
          return _this.addCssClass(cls);
        });
        return;
      }
      var updateNeeded = this.cssClassStates[className] !== true;
      if (updateNeeded && className.length) {
        var eGui = this.getGui();
        if (eGui) {
          eGui.classList.add(className);
        }
        this.cssClassStates[className] = true;
      }
    };
    CssClassManager2.prototype.removeCssClass = function(className) {
      var _this = this;
      var list = (className || "").split(" ");
      if (list.length > 1) {
        list.forEach(function(cls) {
          return _this.removeCssClass(cls);
        });
        return;
      }
      var updateNeeded = this.cssClassStates[className] !== false;
      if (updateNeeded && className.length) {
        var eGui = this.getGui();
        if (eGui) {
          eGui.classList.remove(className);
        }
        this.cssClassStates[className] = false;
      }
    };
    CssClassManager2.prototype.containsCssClass = function(className) {
      var eGui = this.getGui();
      if (!eGui) {
        return false;
      }
      return eGui.classList.contains(className);
    };
    CssClassManager2.prototype.addOrRemoveCssClass = function(className, addOrRemove) {
      var _this = this;
      if (!className) {
        return;
      }
      if (className.indexOf(" ") >= 0) {
        var list = (className || "").split(" ");
        if (list.length > 1) {
          list.forEach(function(cls) {
            return _this.addOrRemoveCssClass(cls, addOrRemove);
          });
          return;
        }
      }
      var updateNeeded = this.cssClassStates[className] !== addOrRemove;
      if (updateNeeded && className.length) {
        var eGui = this.getGui();
        if (eGui) {
          eGui.classList.toggle(className, addOrRemove);
        }
        this.cssClassStates[className] = addOrRemove;
      }
    };
    return CssClassManager2;
  }()
);
var __extends$2U = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2r = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var compIdSequence = new NumberSequence();
var Component = (
  /** @class */
  function(_super) {
    __extends$2U(Component2, _super);
    function Component2(template) {
      var _this = _super.call(this) || this;
      _this.displayed = true;
      _this.visible = true;
      _this.compId = compIdSequence.next();
      _this.cssClassManager = new CssClassManager(function() {
        return _this.eGui;
      });
      if (template) {
        _this.setTemplate(template);
      }
      return _this;
    }
    Component2.prototype.preConstructOnComponent = function() {
      this.usingBrowserTooltips = this.gridOptionsService.is("enableBrowserTooltips");
    };
    Component2.prototype.getCompId = function() {
      return this.compId;
    };
    Component2.prototype.getTooltipParams = function() {
      return {
        value: this.tooltipText,
        location: "UNKNOWN"
      };
    };
    Component2.prototype.setTooltip = function(newTooltipText) {
      var _this = this;
      var removeTooltip = function() {
        if (_this.usingBrowserTooltips) {
          _this.getGui().removeAttribute("title");
        } else {
          _this.tooltipFeature = _this.destroyBean(_this.tooltipFeature);
        }
      };
      var addTooltip = function() {
        if (_this.usingBrowserTooltips) {
          _this.getGui().setAttribute("title", _this.tooltipText);
        } else {
          _this.tooltipFeature = _this.createBean(new CustomTooltipFeature(_this));
        }
      };
      if (this.tooltipText != newTooltipText) {
        if (this.tooltipText) {
          removeTooltip();
        }
        if (newTooltipText != null) {
          this.tooltipText = newTooltipText;
          if (this.tooltipText) {
            addTooltip();
          }
        }
      }
    };
    Component2.prototype.createChildComponentsFromTags = function(parentNode, paramsMap) {
      var _this = this;
      var childNodeList = copyNodeList(parentNode.childNodes);
      childNodeList.forEach(function(childNode) {
        if (!(childNode instanceof HTMLElement)) {
          return;
        }
        var childComp = _this.createComponentFromElement(childNode, function(childComp2) {
          var childGui = childComp2.getGui();
          if (childGui) {
            _this.copyAttributesFromNode(childNode, childComp2.getGui());
          }
        }, paramsMap);
        if (childComp) {
          if (childComp.addItems && childNode.children.length) {
            _this.createChildComponentsFromTags(childNode, paramsMap);
            var items = Array.prototype.slice.call(childNode.children);
            childComp.addItems(items);
          }
          _this.swapComponentForNode(childComp, parentNode, childNode);
        } else if (childNode.childNodes) {
          _this.createChildComponentsFromTags(childNode, paramsMap);
        }
      });
    };
    Component2.prototype.createComponentFromElement = function(element, afterPreCreateCallback, paramsMap) {
      var key = element.nodeName;
      var componentParams = paramsMap ? paramsMap[element.getAttribute("ref")] : void 0;
      var ComponentClass = this.agStackComponentsRegistry.getComponentClass(key);
      if (ComponentClass) {
        Component2.elementGettingCreated = element;
        var newComponent = new ComponentClass(componentParams);
        newComponent.setParentComponent(this);
        this.createBean(newComponent, null, afterPreCreateCallback);
        return newComponent;
      }
      return null;
    };
    Component2.prototype.copyAttributesFromNode = function(source, dest) {
      iterateNamedNodeMap(source.attributes, function(name, value) {
        return dest.setAttribute(name, value);
      });
    };
    Component2.prototype.swapComponentForNode = function(newComponent, parentNode, childNode) {
      var eComponent = newComponent.getGui();
      parentNode.replaceChild(eComponent, childNode);
      parentNode.insertBefore(document.createComment(childNode.nodeName), eComponent);
      this.addDestroyFunc(this.destroyBean.bind(this, newComponent));
      this.swapInComponentForQuerySelectors(newComponent, childNode);
    };
    Component2.prototype.swapInComponentForQuerySelectors = function(newComponent, childNode) {
      var thisNoType = this;
      this.iterateOverQuerySelectors(function(querySelector) {
        if (thisNoType[querySelector.attributeName] === childNode) {
          thisNoType[querySelector.attributeName] = newComponent;
        }
      });
    };
    Component2.prototype.iterateOverQuerySelectors = function(action) {
      var thisPrototype = Object.getPrototypeOf(this);
      while (thisPrototype != null) {
        var metaData = thisPrototype.__agComponentMetaData;
        var currentProtoName = getFunctionName(thisPrototype.constructor);
        if (metaData && metaData[currentProtoName] && metaData[currentProtoName].querySelectors) {
          metaData[currentProtoName].querySelectors.forEach(function(querySelector) {
            return action(querySelector);
          });
        }
        thisPrototype = Object.getPrototypeOf(thisPrototype);
      }
    };
    Component2.prototype.activateTabIndex = function(elements2) {
      var tabIndex = this.gridOptionsService.getNum("tabIndex") || 0;
      if (!elements2) {
        elements2 = [];
      }
      if (!elements2.length) {
        elements2.push(this.getGui());
      }
      elements2.forEach(function(el2) {
        return el2.setAttribute("tabindex", tabIndex.toString());
      });
    };
    Component2.prototype.setTemplate = function(template, paramsMap) {
      var eGui = loadTemplate(template);
      this.setTemplateFromElement(eGui, paramsMap);
    };
    Component2.prototype.setTemplateFromElement = function(element, paramsMap) {
      this.eGui = element;
      this.eGui.__agComponent = this;
      this.wireQuerySelectors();
      if (!!this.getContext()) {
        this.createChildComponentsFromTags(this.getGui(), paramsMap);
      }
    };
    Component2.prototype.createChildComponentsPreConstruct = function() {
      if (!!this.getGui()) {
        this.createChildComponentsFromTags(this.getGui());
      }
    };
    Component2.prototype.wireQuerySelectors = function() {
      var _this = this;
      if (!this.eGui) {
        return;
      }
      var thisNoType = this;
      this.iterateOverQuerySelectors(function(querySelector) {
        var setResult = function(result) {
          return thisNoType[querySelector.attributeName] = result;
        };
        var topLevelRefMatch = querySelector.refSelector && _this.getAttribute("ref") === querySelector.refSelector;
        if (topLevelRefMatch) {
          setResult(_this.eGui);
        } else {
          var resultOfQuery = _this.eGui.querySelector(querySelector.querySelector);
          if (resultOfQuery) {
            setResult(resultOfQuery.__agComponent || resultOfQuery);
          }
        }
      });
    };
    Component2.prototype.getGui = function() {
      return this.eGui;
    };
    Component2.prototype.getFocusableElement = function() {
      return this.eGui;
    };
    Component2.prototype.setParentComponent = function(component) {
      this.parentComponent = component;
    };
    Component2.prototype.getParentComponent = function() {
      return this.parentComponent;
    };
    Component2.prototype.setGui = function(eGui) {
      this.eGui = eGui;
    };
    Component2.prototype.queryForHtmlElement = function(cssSelector) {
      return this.eGui.querySelector(cssSelector);
    };
    Component2.prototype.queryForHtmlInputElement = function(cssSelector) {
      return this.eGui.querySelector(cssSelector);
    };
    Component2.prototype.appendChild = function(newChild, container) {
      if (newChild == null) {
        return;
      }
      if (!container) {
        container = this.eGui;
      }
      if (isNodeOrElement(newChild)) {
        container.appendChild(newChild);
      } else {
        var childComponent = newChild;
        container.appendChild(childComponent.getGui());
      }
    };
    Component2.prototype.isDisplayed = function() {
      return this.displayed;
    };
    Component2.prototype.setVisible = function(visible, options) {
      if (options === void 0) {
        options = {};
      }
      if (visible !== this.visible) {
        this.visible = visible;
        var skipAriaHidden = options.skipAriaHidden;
        setVisible(this.eGui, visible, { skipAriaHidden });
      }
    };
    Component2.prototype.setDisplayed = function(displayed, options) {
      if (options === void 0) {
        options = {};
      }
      if (displayed !== this.displayed) {
        this.displayed = displayed;
        var skipAriaHidden = options.skipAriaHidden;
        setDisplayed(this.eGui, displayed, { skipAriaHidden });
        var event_1 = {
          type: Component2.EVENT_DISPLAYED_CHANGED,
          visible: this.displayed
        };
        this.dispatchEvent(event_1);
      }
    };
    Component2.prototype.destroy = function() {
      if (this.tooltipFeature) {
        this.tooltipFeature = this.destroyBean(this.tooltipFeature);
      }
      if (this.parentComponent) {
        this.parentComponent = void 0;
      }
      var eGui = this.eGui;
      if (eGui && eGui.__agComponent) {
        eGui.__agComponent = void 0;
      }
      _super.prototype.destroy.call(this);
    };
    Component2.prototype.addGuiEventListener = function(event, listener, options) {
      var _this = this;
      this.eGui.addEventListener(event, listener, options);
      this.addDestroyFunc(function() {
        return _this.eGui.removeEventListener(event, listener);
      });
    };
    Component2.prototype.addCssClass = function(className) {
      this.cssClassManager.addCssClass(className);
    };
    Component2.prototype.removeCssClass = function(className) {
      this.cssClassManager.removeCssClass(className);
    };
    Component2.prototype.containsCssClass = function(className) {
      return this.cssClassManager.containsCssClass(className);
    };
    Component2.prototype.addOrRemoveCssClass = function(className, addOrRemove) {
      this.cssClassManager.addOrRemoveCssClass(className, addOrRemove);
    };
    Component2.prototype.getAttribute = function(key) {
      var eGui = this.eGui;
      return eGui ? eGui.getAttribute(key) : null;
    };
    Component2.prototype.getRefElement = function(refName) {
      return this.queryForHtmlElement('[ref="' + refName + '"]');
    };
    Component2.EVENT_DISPLAYED_CHANGED = "displayedChanged";
    __decorate$2r([
      Autowired("agStackComponentsRegistry")
    ], Component2.prototype, "agStackComponentsRegistry", void 0);
    __decorate$2r([
      PreConstruct
    ], Component2.prototype, "preConstructOnComponent", null);
    __decorate$2r([
      PreConstruct
    ], Component2.prototype, "createChildComponentsPreConstruct", null);
    return Component2;
  }(BeanStub)
);
function QuerySelector(selector) {
  return querySelectorFunc.bind(this, selector, void 0);
}
function RefSelector(ref) {
  return querySelectorFunc.bind(this, "[ref=" + ref + "]", ref);
}
function querySelectorFunc(selector, refSelector, classPrototype, methodOrAttributeName, index2) {
  if (selector === null) {
    console.error("AG Grid: QuerySelector selector should not be null");
    return;
  }
  if (typeof index2 === "number") {
    console.error("AG Grid: QuerySelector should be on an attribute");
    return;
  }
  addToObjectProps(classPrototype, "querySelectors", {
    attributeName: methodOrAttributeName,
    querySelector: selector,
    refSelector
  });
}
function addToObjectProps(target, key, value) {
  var props = getOrCreateProps(target, getFunctionName(target.constructor));
  if (!props[key]) {
    props[key] = [];
  }
  props[key].push(value);
}
function getOrCreateProps(target, instanceName) {
  if (!target.__agComponentMetaData) {
    target.__agComponentMetaData = {};
  }
  if (!target.__agComponentMetaData[instanceName]) {
    target.__agComponentMetaData[instanceName] = {};
  }
  return target.__agComponentMetaData[instanceName];
}
var __extends$2T = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2q = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ReadOnlyFloatingFilter = (
  /** @class */
  function(_super) {
    __extends$2T(ReadOnlyFloatingFilter2, _super);
    function ReadOnlyFloatingFilter2() {
      return _super.call(
        this,
        /* html */
        '\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>'
      ) || this;
    }
    ReadOnlyFloatingFilter2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    ReadOnlyFloatingFilter2.prototype.init = function(params) {
      this.params = params;
      var displayName = this.columnModel.getDisplayNameForColumn(params.column, "header", true);
      var translate = this.localeService.getLocaleTextFunc();
      this.eFloatingFilterText.setDisabled(true).setInputAriaLabel(displayName + " " + translate("ariaFilterInput", "Filter Input"));
    };
    ReadOnlyFloatingFilter2.prototype.onParentModelChanged = function(parentModel) {
      var _this = this;
      if (!parentModel) {
        this.eFloatingFilterText.setValue("");
        return;
      }
      this.params.parentFilterInstance(function(filterInstance) {
        if (filterInstance.getModelAsString) {
          var modelAsString = filterInstance.getModelAsString(parentModel);
          _this.eFloatingFilterText.setValue(modelAsString);
        }
      });
    };
    __decorate$2q([
      RefSelector("eFloatingFilterText")
    ], ReadOnlyFloatingFilter2.prototype, "eFloatingFilterText", void 0);
    __decorate$2q([
      Autowired("columnModel")
    ], ReadOnlyFloatingFilter2.prototype, "columnModel", void 0);
    return ReadOnlyFloatingFilter2;
  }(Component)
);
var DateCompWrapper = (
  /** @class */
  function() {
    function DateCompWrapper2(context, userComponentFactory, dateComponentParams, eParent) {
      var _this = this;
      this.alive = true;
      this.context = context;
      this.eParent = eParent;
      var compDetails = userComponentFactory.getDateCompDetails(dateComponentParams);
      var promise = compDetails.newAgStackInstance();
      promise.then(function(dateComp) {
        if (!_this.alive) {
          context.destroyBean(dateComp);
          return;
        }
        _this.dateComp = dateComp;
        if (!dateComp) {
          return;
        }
        eParent.appendChild(dateComp.getGui());
        if (dateComp.afterGuiAttached) {
          dateComp.afterGuiAttached();
        }
        if (_this.tempValue) {
          dateComp.setDate(_this.tempValue);
        }
        if (_this.disabled != null) {
          _this.setDateCompDisabled(_this.disabled);
        }
      });
    }
    DateCompWrapper2.prototype.destroy = function() {
      this.alive = false;
      this.dateComp = this.context.destroyBean(this.dateComp);
    };
    DateCompWrapper2.prototype.getDate = function() {
      return this.dateComp ? this.dateComp.getDate() : this.tempValue;
    };
    DateCompWrapper2.prototype.setDate = function(value) {
      if (this.dateComp) {
        this.dateComp.setDate(value);
      } else {
        this.tempValue = value;
      }
    };
    DateCompWrapper2.prototype.setDisabled = function(disabled) {
      if (this.dateComp) {
        this.setDateCompDisabled(disabled);
      } else {
        this.disabled = disabled;
      }
    };
    DateCompWrapper2.prototype.setDisplayed = function(displayed) {
      setDisplayed(this.eParent, displayed);
    };
    DateCompWrapper2.prototype.setInputPlaceholder = function(placeholder) {
      if (this.dateComp && this.dateComp.setInputPlaceholder) {
        this.dateComp.setInputPlaceholder(placeholder);
      }
    };
    DateCompWrapper2.prototype.setInputAriaLabel = function(label) {
      if (this.dateComp && this.dateComp.setInputAriaLabel) {
        this.dateComp.setInputAriaLabel(label);
      }
    };
    DateCompWrapper2.prototype.afterGuiAttached = function(params) {
      if (this.dateComp && typeof this.dateComp.afterGuiAttached === "function") {
        this.dateComp.afterGuiAttached(params);
      }
    };
    DateCompWrapper2.prototype.setDateCompDisabled = function(disabled) {
      if (this.dateComp == null) {
        return;
      }
      if (this.dateComp.setDisabled == null) {
        return;
      }
      this.dateComp.setDisabled(disabled);
    };
    return DateCompWrapper2;
  }()
);
var OptionsFactory = (
  /** @class */
  function() {
    function OptionsFactory2() {
      this.customFilterOptions = {};
    }
    OptionsFactory2.prototype.init = function(params, defaultOptions) {
      this.filterOptions = params.filterOptions || defaultOptions;
      this.mapCustomOptions();
      this.selectDefaultItem(params);
    };
    OptionsFactory2.prototype.getFilterOptions = function() {
      return this.filterOptions;
    };
    OptionsFactory2.prototype.mapCustomOptions = function() {
      var _this = this;
      if (!this.filterOptions) {
        return;
      }
      this.filterOptions.forEach(function(filterOption) {
        if (typeof filterOption === "string") {
          return;
        }
        var requiredProperties = [["displayKey"], ["displayName"], ["predicate", "test"]];
        var propertyCheck = function(keys2) {
          if (!keys2.some(function(key) {
            return filterOption[key] != null;
          })) {
            console.warn("AG Grid: ignoring FilterOptionDef as it doesn't contain one of '" + keys2 + "'");
            return false;
          }
          return true;
        };
        if (!requiredProperties.every(propertyCheck)) {
          _this.filterOptions = _this.filterOptions.filter(function(v2) {
            return v2 === filterOption;
          }) || [];
          return;
        }
        _this.customFilterOptions[filterOption.displayKey] = filterOption;
      });
    };
    OptionsFactory2.prototype.selectDefaultItem = function(params) {
      if (params.defaultOption) {
        this.defaultOption = params.defaultOption;
      } else if (this.filterOptions.length >= 1) {
        var firstFilterOption = this.filterOptions[0];
        if (typeof firstFilterOption === "string") {
          this.defaultOption = firstFilterOption;
        } else if (firstFilterOption.displayKey) {
          this.defaultOption = firstFilterOption.displayKey;
        } else {
          console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'");
        }
      } else {
        console.warn("AG Grid: no filter options for filter");
      }
    };
    OptionsFactory2.prototype.getDefaultOption = function() {
      return this.defaultOption;
    };
    OptionsFactory2.prototype.getCustomOption = function(name) {
      return this.customFilterOptions[name];
    };
    return OptionsFactory2;
  }()
);
var DEFAULT_FILTER_LOCALE_TEXT = {
  applyFilter: "Apply",
  clearFilter: "Clear",
  resetFilter: "Reset",
  cancelFilter: "Cancel",
  textFilter: "Text Filter",
  numberFilter: "Number Filter",
  dateFilter: "Date Filter",
  setFilter: "Set Filter",
  filterOoo: "Filter...",
  empty: "Choose One",
  equals: "Equals",
  notEqual: "Not equal",
  lessThan: "Less than",
  greaterThan: "Greater than",
  inRange: "In range",
  inRangeStart: "From",
  inRangeEnd: "To",
  lessThanOrEqual: "Less than or equals",
  greaterThanOrEqual: "Greater than or equals",
  contains: "Contains",
  notContains: "Not contains",
  startsWith: "Starts with",
  endsWith: "Ends with",
  blank: "Blank",
  notBlank: "Not blank",
  andCondition: "AND",
  orCondition: "OR",
  dateFormatOoo: "yyyy-mm-dd"
};
var __extends$2S = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$i = function() {
  __assign$i = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$i.apply(this, arguments);
};
var __decorate$2p = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ManagedFocusFeature = (
  /** @class */
  function(_super) {
    __extends$2S(ManagedFocusFeature2, _super);
    function ManagedFocusFeature2(eFocusableElement, callbacks) {
      if (callbacks === void 0) {
        callbacks = {};
      }
      var _this = _super.call(this) || this;
      _this.eFocusableElement = eFocusableElement;
      _this.callbacks = callbacks;
      _this.callbacks = __assign$i({ shouldStopEventPropagation: function() {
        return false;
      }, onTabKeyDown: function(e) {
        if (e.defaultPrevented) {
          return;
        }
        var nextRoot = _this.focusService.findNextFocusableElement(_this.eFocusableElement, false, e.shiftKey);
        if (!nextRoot) {
          return;
        }
        nextRoot.focus();
        e.preventDefault();
      } }, callbacks);
      return _this;
    }
    ManagedFocusFeature2.prototype.postConstruct = function() {
      this.eFocusableElement.classList.add(ManagedFocusFeature2.FOCUS_MANAGED_CLASS);
      this.addKeyDownListeners(this.eFocusableElement);
      if (this.callbacks.onFocusIn) {
        this.addManagedListener(this.eFocusableElement, "focusin", this.callbacks.onFocusIn);
      }
      if (this.callbacks.onFocusOut) {
        this.addManagedListener(this.eFocusableElement, "focusout", this.callbacks.onFocusOut);
      }
    };
    ManagedFocusFeature2.prototype.addKeyDownListeners = function(eGui) {
      var _this = this;
      this.addManagedListener(eGui, "keydown", function(e) {
        if (e.defaultPrevented || isStopPropagationForAgGrid(e)) {
          return;
        }
        if (_this.callbacks.shouldStopEventPropagation(e)) {
          stopPropagationForAgGrid(e);
          return;
        }
        if (e.key === KeyCode.TAB) {
          _this.callbacks.onTabKeyDown(e);
        } else if (_this.callbacks.handleKeyDown) {
          _this.callbacks.handleKeyDown(e);
        }
      });
    };
    ManagedFocusFeature2.FOCUS_MANAGED_CLASS = "ag-focus-managed";
    __decorate$2p([
      Autowired("focusService")
    ], ManagedFocusFeature2.prototype, "focusService", void 0);
    __decorate$2p([
      PostConstruct
    ], ManagedFocusFeature2.prototype, "postConstruct", null);
    return ManagedFocusFeature2;
  }(BeanStub)
);
var __extends$2R = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2o = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var RESIZE_CONTAINER_STYLE = "ag-resizer-wrapper";
var RESIZE_TEMPLATE = (
  /* html */
  '<div class="' + RESIZE_CONTAINER_STYLE + '">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>'
);
var PositionableFeature = (
  /** @class */
  function(_super) {
    __extends$2R(PositionableFeature2, _super);
    function PositionableFeature2(element, config) {
      var _this = _super.call(this) || this;
      _this.element = element;
      _this.dragStartPosition = {
        x: 0,
        y: 0
      };
      _this.position = {
        x: 0,
        y: 0
      };
      _this.lastSize = {
        width: -1,
        height: -1
      };
      _this.positioned = false;
      _this.resizersAdded = false;
      _this.resizeListeners = [];
      _this.boundaryEl = null;
      _this.isResizing = false;
      _this.isMoving = false;
      _this.resizable = {};
      _this.movable = false;
      _this.currentResizer = null;
      _this.config = Object.assign({}, { popup: false }, config);
      return _this;
    }
    PositionableFeature2.prototype.center = function() {
      var _a2 = this.offsetParent, clientHeight = _a2.clientHeight, clientWidth = _a2.clientWidth;
      var x2 = clientWidth / 2 - this.getWidth() / 2;
      var y2 = clientHeight / 2 - this.getHeight() / 2;
      this.offsetElement(x2, y2);
    };
    PositionableFeature2.prototype.initialisePosition = function() {
      if (this.positioned) {
        return;
      }
      var _a2 = this.config, centered = _a2.centered, forcePopupParentAsOffsetParent = _a2.forcePopupParentAsOffsetParent, minWidth = _a2.minWidth, width = _a2.width, minHeight = _a2.minHeight, height = _a2.height, x2 = _a2.x, y2 = _a2.y;
      if (!this.offsetParent) {
        this.setOffsetParent();
      }
      var computedMinHeight = 0;
      var computedMinWidth = 0;
      var isVisible2 = !!this.element.offsetParent;
      if (isVisible2) {
        var boundaryEl = this.findBoundaryElement();
        var offsetParentComputedStyles = window.getComputedStyle(boundaryEl);
        if (offsetParentComputedStyles.minWidth != null) {
          var paddingWidth = boundaryEl.offsetWidth - this.element.offsetWidth;
          computedMinWidth = parseInt(offsetParentComputedStyles.minWidth, 10) - paddingWidth;
        }
        if (offsetParentComputedStyles.minHeight != null) {
          var paddingHeight = boundaryEl.offsetHeight - this.element.offsetHeight;
          computedMinHeight = parseInt(offsetParentComputedStyles.minHeight, 10) - paddingHeight;
        }
      }
      this.minHeight = minHeight || computedMinHeight;
      this.minWidth = minWidth || computedMinWidth;
      if (width) {
        this.setWidth(width);
      }
      if (height) {
        this.setHeight(height);
      }
      if (!width || !height) {
        this.refreshSize();
      }
      if (centered) {
        this.center();
      } else if (x2 || y2) {
        this.offsetElement(x2, y2);
      } else if (isVisible2 && forcePopupParentAsOffsetParent) {
        var boundaryEl = this.boundaryEl;
        var initialisedDuringPositioning = true;
        if (!boundaryEl) {
          boundaryEl = this.findBoundaryElement();
          initialisedDuringPositioning = false;
        }
        if (boundaryEl) {
          var top_1 = parseFloat(boundaryEl.style.top);
          var left = parseFloat(boundaryEl.style.left);
          if (initialisedDuringPositioning) {
            this.offsetElement(isNaN(left) ? 0 : left, isNaN(top_1) ? 0 : top_1);
          } else {
            this.setPosition(left, top_1);
          }
        }
      }
      this.positioned = !!this.offsetParent;
    };
    PositionableFeature2.prototype.isPositioned = function() {
      return this.positioned;
    };
    PositionableFeature2.prototype.getPosition = function() {
      return this.position;
    };
    PositionableFeature2.prototype.setMovable = function(movable, moveElement) {
      if (!this.config.popup || movable === this.movable) {
        return;
      }
      this.movable = movable;
      var params = this.moveElementDragListener || {
        eElement: moveElement,
        onDragStart: this.onMoveStart.bind(this),
        onDragging: this.onMove.bind(this),
        onDragStop: this.onMoveEnd.bind(this)
      };
      if (movable) {
        this.dragService.addDragSource(params);
        this.moveElementDragListener = params;
      } else {
        this.dragService.removeDragSource(params);
        this.moveElementDragListener = void 0;
      }
    };
    PositionableFeature2.prototype.setResizable = function(resizable) {
      var _this = this;
      this.clearResizeListeners();
      if (resizable) {
        this.addResizers();
      } else {
        this.removeResizers();
      }
      if (typeof resizable === "boolean") {
        if (resizable === false) {
          return;
        }
        resizable = {
          topLeft: resizable,
          top: resizable,
          topRight: resizable,
          right: resizable,
          bottomRight: resizable,
          bottom: resizable,
          bottomLeft: resizable,
          left: resizable
        };
      }
      Object.keys(resizable).forEach(function(side) {
        var resizableStructure = resizable;
        var isSideResizable = !!resizableStructure[side];
        var resizerEl = _this.getResizerElement(side);
        var params = {
          dragStartPixels: 0,
          eElement: resizerEl,
          onDragStart: function(e) {
            return _this.onResizeStart(e, side);
          },
          onDragging: _this.onResize.bind(_this),
          onDragStop: function(e) {
            return _this.onResizeEnd(e, side);
          }
        };
        if (isSideResizable || !_this.isAlive() && !isSideResizable) {
          if (isSideResizable) {
            _this.dragService.addDragSource(params);
            _this.resizeListeners.push(params);
            resizerEl.style.pointerEvents = "all";
          } else {
            resizerEl.style.pointerEvents = "none";
          }
          _this.resizable[side] = isSideResizable;
        }
      });
    };
    PositionableFeature2.prototype.removeSizeFromEl = function() {
      this.element.style.removeProperty("height");
      this.element.style.removeProperty("width");
      this.element.style.removeProperty("flex");
    };
    PositionableFeature2.prototype.restoreLastSize = function() {
      this.element.style.flex = "0 0 auto";
      var _a2 = this.lastSize, height = _a2.height, width = _a2.width;
      if (width !== -1) {
        this.element.style.width = width + "px";
      }
      if (height !== -1) {
        this.element.style.height = height + "px";
      }
    };
    PositionableFeature2.prototype.getHeight = function() {
      return this.element.offsetHeight;
    };
    PositionableFeature2.prototype.setHeight = function(height) {
      var popup = this.config.popup;
      var eGui = this.element;
      var isPercent = false;
      if (typeof height === "string" && height.indexOf("%") !== -1) {
        setFixedHeight(eGui, height);
        height = getAbsoluteHeight(eGui);
        isPercent = true;
      } else {
        height = Math.max(this.minHeight, height);
        if (this.positioned) {
          var availableHeight = this.getAvailableHeight();
          if (availableHeight && height > availableHeight) {
            height = availableHeight;
          }
        }
      }
      if (this.getHeight() === height) {
        return;
      }
      if (!isPercent) {
        if (popup) {
          setFixedHeight(eGui, height);
        } else {
          eGui.style.height = height + "px";
          eGui.style.flex = "0 0 auto";
          this.lastSize.height = typeof height === "number" ? height : parseFloat(height);
        }
      } else {
        eGui.style.maxHeight = "unset";
        eGui.style.minHeight = "unset";
      }
    };
    PositionableFeature2.prototype.getAvailableHeight = function() {
      var _a2 = this.config, popup = _a2.popup, forcePopupParentAsOffsetParent = _a2.forcePopupParentAsOffsetParent;
      if (!this.positioned) {
        this.initialisePosition();
      }
      var clientHeight = this.offsetParent.clientHeight;
      if (!clientHeight) {
        return null;
      }
      var elRect = this.element.getBoundingClientRect();
      var offsetParentRect = this.offsetParent.getBoundingClientRect();
      var yPosition = popup ? this.position.y : elRect.top;
      var parentTop = popup ? 0 : offsetParentRect.top;
      var additionalHeight = 0;
      if (forcePopupParentAsOffsetParent) {
        var parentEl = this.element.parentElement;
        if (parentEl) {
          var bottom = parentEl.getBoundingClientRect().bottom;
          additionalHeight = bottom - elRect.bottom;
        }
      }
      var availableHeight = clientHeight + parentTop - yPosition - additionalHeight;
      return availableHeight;
    };
    PositionableFeature2.prototype.getWidth = function() {
      return this.element.offsetWidth;
    };
    PositionableFeature2.prototype.setWidth = function(width) {
      var eGui = this.element;
      var popup = this.config.popup;
      var isPercent = false;
      if (typeof width === "string" && width.indexOf("%") !== -1) {
        setFixedWidth(eGui, width);
        width = getAbsoluteWidth(eGui);
        isPercent = true;
      } else if (this.positioned) {
        width = Math.max(this.minWidth, width);
        var clientWidth = this.offsetParent.clientWidth;
        var xPosition = popup ? this.position.x : this.element.getBoundingClientRect().left;
        if (clientWidth && width + xPosition > clientWidth) {
          width = clientWidth - xPosition;
        }
      }
      if (this.getWidth() === width) {
        return;
      }
      if (!isPercent) {
        if (this.config.popup) {
          setFixedWidth(eGui, width);
        } else {
          eGui.style.width = width + "px";
          eGui.style.flex = " unset";
          this.lastSize.width = typeof width === "number" ? width : parseFloat(width);
        }
      } else {
        eGui.style.maxWidth = "unset";
        eGui.style.minWidth = "unset";
      }
    };
    PositionableFeature2.prototype.offsetElement = function(x2, y2) {
      if (x2 === void 0) {
        x2 = 0;
      }
      if (y2 === void 0) {
        y2 = 0;
      }
      var forcePopupParentAsOffsetParent = this.config.forcePopupParentAsOffsetParent;
      var ePopup = forcePopupParentAsOffsetParent ? this.boundaryEl : this.element;
      if (!ePopup) {
        return;
      }
      this.popupService.positionPopup({
        ePopup,
        keepWithinBounds: true,
        skipObserver: this.movable || this.isResizable(),
        updatePosition: function() {
          return { x: x2, y: y2 };
        }
      });
      this.setPosition(parseFloat(ePopup.style.left), parseFloat(ePopup.style.top));
    };
    PositionableFeature2.prototype.constrainSizeToAvailableHeight = function(constrain) {
      var _this = this;
      if (!this.config.forcePopupParentAsOffsetParent) {
        return;
      }
      var applyMaxHeightToElement = function() {
        var availableHeight = _this.getAvailableHeight();
        _this.element.style.setProperty("max-height", availableHeight + "px");
      };
      if (constrain) {
        this.resizeObserverSubscriber = this.resizeObserverService.observeResize(this.popupService.getPopupParent(), applyMaxHeightToElement);
      } else {
        this.element.style.removeProperty("max-height");
        if (this.resizeObserverSubscriber) {
          this.resizeObserverSubscriber();
          this.resizeObserverSubscriber = void 0;
        }
      }
    };
    PositionableFeature2.prototype.setPosition = function(x2, y2) {
      this.position.x = x2;
      this.position.y = y2;
    };
    PositionableFeature2.prototype.updateDragStartPosition = function(x2, y2) {
      this.dragStartPosition = { x: x2, y: y2 };
    };
    PositionableFeature2.prototype.calculateMouseMovement = function(params) {
      var e = params.e, isLeft = params.isLeft, isTop = params.isTop, anywhereWithin = params.anywhereWithin, topBuffer = params.topBuffer;
      var xDiff = e.clientX - this.dragStartPosition.x;
      var yDiff = e.clientY - this.dragStartPosition.y;
      var movementX = this.shouldSkipX(e, !!isLeft, !!anywhereWithin, xDiff) ? 0 : xDiff;
      var movementY = this.shouldSkipY(e, !!isTop, topBuffer, yDiff) ? 0 : yDiff;
      return { movementX, movementY };
    };
    PositionableFeature2.prototype.shouldSkipX = function(e, isLeft, anywhereWithin, diff2) {
      var elRect = this.element.getBoundingClientRect();
      var parentRect = this.offsetParent.getBoundingClientRect();
      var boundaryElRect = this.boundaryEl.getBoundingClientRect();
      var xPosition = this.config.popup ? this.position.x : elRect.left;
      var skipX = xPosition <= 0 && parentRect.left >= e.clientX || parentRect.right <= e.clientX && parentRect.right <= boundaryElRect.right;
      if (skipX) {
        return true;
      }
      if (isLeft) {
        skipX = // skip if we are moving to the left and the cursor
        // is positioned to the right of the left side anchor
        diff2 < 0 && e.clientX > xPosition + parentRect.left || // skip if we are moving to the right and the cursor
        // is positioned to the left of the dialog
        diff2 > 0 && e.clientX < xPosition + parentRect.left;
      } else {
        if (anywhereWithin) {
          skipX = diff2 < 0 && e.clientX > boundaryElRect.right || diff2 > 0 && e.clientX < xPosition + parentRect.left;
        } else {
          skipX = // if the movement is bound to the right side of the dialog
          // we skip if we are moving to the left and the cursor
          // is to the right of the dialog
          diff2 < 0 && e.clientX > boundaryElRect.right || // or skip if we are moving to the right and the cursor
          // is to the left of the right side anchor
          diff2 > 0 && e.clientX < boundaryElRect.right;
        }
      }
      return skipX;
    };
    PositionableFeature2.prototype.shouldSkipY = function(e, isTop, topBuffer, diff2) {
      if (topBuffer === void 0) {
        topBuffer = 0;
      }
      var elRect = this.element.getBoundingClientRect();
      var parentRect = this.offsetParent.getBoundingClientRect();
      var boundaryElRect = this.boundaryEl.getBoundingClientRect();
      var yPosition = this.config.popup ? this.position.y : elRect.top;
      var skipY = yPosition <= 0 && parentRect.top >= e.clientY || parentRect.bottom <= e.clientY && parentRect.bottom <= boundaryElRect.bottom;
      if (skipY) {
        return true;
      }
      if (isTop) {
        skipY = // skip if we are moving to towards top and the cursor is
        // below the top anchor + topBuffer
        // note: topBuffer is used when moving the dialog using the title bar
        diff2 < 0 && e.clientY > yPosition + parentRect.top + topBuffer || // skip if we are moving to the bottom and the cursor is
        // above the top anchor
        diff2 > 0 && e.clientY < yPosition + parentRect.top;
      } else {
        skipY = // skip if we are moving towards the top and the cursor
        // is below the bottom anchor
        diff2 < 0 && e.clientY > boundaryElRect.bottom || // skip if we are moving towards the bottom and the cursor
        // is above the bottom anchor
        diff2 > 0 && e.clientY < boundaryElRect.bottom;
      }
      return skipY;
    };
    PositionableFeature2.prototype.createResizeMap = function() {
      var eGui = this.element;
      this.resizerMap = {
        topLeft: { element: eGui.querySelector("[ref=eTopLeftResizer]") },
        top: { element: eGui.querySelector("[ref=eTopResizer]") },
        topRight: { element: eGui.querySelector("[ref=eTopRightResizer]") },
        right: { element: eGui.querySelector("[ref=eRightResizer]") },
        bottomRight: { element: eGui.querySelector("[ref=eBottomRightResizer]") },
        bottom: { element: eGui.querySelector("[ref=eBottomResizer]") },
        bottomLeft: { element: eGui.querySelector("[ref=eBottomLeftResizer]") },
        left: { element: eGui.querySelector("[ref=eLeftResizer]") }
      };
    };
    PositionableFeature2.prototype.addResizers = function() {
      if (this.resizersAdded) {
        return;
      }
      var eGui = this.element;
      if (!eGui) {
        return;
      }
      var parser = new DOMParser();
      var resizers = parser.parseFromString(RESIZE_TEMPLATE, "text/html").body;
      eGui.appendChild(resizers.firstChild);
      this.createResizeMap();
      this.resizersAdded = true;
    };
    PositionableFeature2.prototype.removeResizers = function() {
      this.resizerMap = void 0;
      var resizerEl = this.element.querySelector("." + RESIZE_CONTAINER_STYLE);
      if (resizerEl) {
        this.element.removeChild(resizerEl);
      }
      this.resizersAdded = false;
    };
    PositionableFeature2.prototype.getResizerElement = function(side) {
      return this.resizerMap[side].element;
    };
    PositionableFeature2.prototype.onResizeStart = function(e, side) {
      this.boundaryEl = this.findBoundaryElement();
      if (!this.positioned) {
        this.initialisePosition();
      }
      this.currentResizer = {
        isTop: !!side.match(/top/i),
        isRight: !!side.match(/right/i),
        isBottom: !!side.match(/bottom/i),
        isLeft: !!side.match(/left/i)
      };
      this.element.classList.add("ag-resizing");
      this.resizerMap[side].element.classList.add("ag-active");
      var _a2 = this.config, popup = _a2.popup, forcePopupParentAsOffsetParent = _a2.forcePopupParentAsOffsetParent;
      if (!popup && !forcePopupParentAsOffsetParent) {
        this.applySizeToSiblings(this.currentResizer.isBottom || this.currentResizer.isTop);
      }
      this.isResizing = true;
      this.updateDragStartPosition(e.clientX, e.clientY);
    };
    PositionableFeature2.prototype.getSiblings = function() {
      var element = this.element;
      var parent = element.parentElement;
      if (!parent) {
        return null;
      }
      return Array.prototype.slice.call(parent.children).filter(function(el2) {
        return !el2.classList.contains("ag-hidden");
      });
    };
    PositionableFeature2.prototype.getMinSizeOfSiblings = function() {
      var siblings = this.getSiblings() || [];
      var height = 0;
      var width = 0;
      for (var i = 0; i < siblings.length; i++) {
        var currentEl = siblings[i];
        var isFlex = !!currentEl.style.flex && currentEl.style.flex !== "0 0 auto";
        if (currentEl === this.element) {
          continue;
        }
        var nextHeight = this.minHeight || 0;
        var nextWidth = this.minWidth || 0;
        if (isFlex) {
          var computedStyle = window.getComputedStyle(currentEl);
          if (computedStyle.minHeight) {
            nextHeight = parseInt(computedStyle.minHeight, 10);
          }
          if (computedStyle.minWidth) {
            nextWidth = parseInt(computedStyle.minWidth, 10);
          }
        } else {
          nextHeight = currentEl.offsetHeight;
          nextWidth = currentEl.offsetWidth;
        }
        height += nextHeight;
        width += nextWidth;
      }
      return { height, width };
    };
    PositionableFeature2.prototype.applySizeToSiblings = function(vertical) {
      var containerToFlex = null;
      var siblings = this.getSiblings();
      if (!siblings) {
        return;
      }
      for (var i = 0; i < siblings.length; i++) {
        var el2 = siblings[i];
        if (el2 === containerToFlex) {
          continue;
        }
        if (vertical) {
          el2.style.height = el2.offsetHeight + "px";
        } else {
          el2.style.width = el2.offsetWidth + "px";
        }
        el2.style.flex = "0 0 auto";
        if (el2 === this.element) {
          containerToFlex = siblings[i + 1];
        }
      }
      if (containerToFlex) {
        containerToFlex.style.removeProperty("height");
        containerToFlex.style.removeProperty("min-height");
        containerToFlex.style.removeProperty("max-height");
        containerToFlex.style.flex = "1 1 auto";
      }
    };
    PositionableFeature2.prototype.isResizable = function() {
      return Object.values(this.resizable).some(function(value) {
        return value;
      });
    };
    PositionableFeature2.prototype.onResize = function(e) {
      if (!this.isResizing || !this.currentResizer) {
        return;
      }
      var _a2 = this.config, popup = _a2.popup, forcePopupParentAsOffsetParent = _a2.forcePopupParentAsOffsetParent;
      var _b2 = this.currentResizer, isTop = _b2.isTop, isRight = _b2.isRight, isBottom = _b2.isBottom, isLeft = _b2.isLeft;
      var isHorizontal = isRight || isLeft;
      var isVertical = isBottom || isTop;
      var _c = this.calculateMouseMovement({ e, isLeft, isTop }), movementX = _c.movementX, movementY = _c.movementY;
      var xPosition = this.position.x;
      var yPosition = this.position.y;
      var offsetLeft = 0;
      var offsetTop = 0;
      if (isHorizontal && movementX) {
        var direction = isLeft ? -1 : 1;
        var oldWidth = this.getWidth();
        var newWidth = oldWidth + movementX * direction;
        var skipWidth = false;
        if (isLeft) {
          offsetLeft = oldWidth - newWidth;
          if (xPosition + offsetLeft <= 0 || newWidth <= this.minWidth) {
            skipWidth = true;
            offsetLeft = 0;
          }
        }
        if (!skipWidth) {
          this.setWidth(newWidth);
        }
      }
      if (isVertical && movementY) {
        var direction = isTop ? -1 : 1;
        var oldHeight = this.getHeight();
        var newHeight = oldHeight + movementY * direction;
        var skipHeight = false;
        if (isTop) {
          offsetTop = oldHeight - newHeight;
          if (yPosition + offsetTop <= 0 || newHeight <= this.minHeight) {
            skipHeight = true;
            offsetTop = 0;
          }
        } else {
          if (!this.config.popup && !this.config.forcePopupParentAsOffsetParent && oldHeight < newHeight && this.getMinSizeOfSiblings().height + newHeight > this.element.parentElement.offsetHeight) {
            skipHeight = true;
          }
        }
        if (!skipHeight) {
          this.setHeight(newHeight);
        }
      }
      this.updateDragStartPosition(e.clientX, e.clientY);
      if ((popup || forcePopupParentAsOffsetParent) && offsetLeft || offsetTop) {
        this.offsetElement(xPosition + offsetLeft, yPosition + offsetTop);
      }
    };
    PositionableFeature2.prototype.onResizeEnd = function(e, side) {
      this.isResizing = false;
      this.currentResizer = null;
      this.boundaryEl = null;
      var params = {
        type: "resize",
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi
      };
      this.element.classList.remove("ag-resizing");
      this.resizerMap[side].element.classList.remove("ag-active");
      this.dispatchEvent(params);
    };
    PositionableFeature2.prototype.refreshSize = function() {
      var eGui = this.element;
      if (this.config.popup) {
        if (!this.config.width) {
          this.setWidth(eGui.offsetWidth);
        }
        if (!this.config.height) {
          this.setHeight(eGui.offsetHeight);
        }
      }
    };
    PositionableFeature2.prototype.onMoveStart = function(e) {
      this.boundaryEl = this.findBoundaryElement();
      if (!this.positioned) {
        this.initialisePosition();
      }
      this.isMoving = true;
      this.element.classList.add("ag-moving");
      this.updateDragStartPosition(e.clientX, e.clientY);
    };
    PositionableFeature2.prototype.onMove = function(e) {
      if (!this.isMoving) {
        return;
      }
      var _a2 = this.position, x2 = _a2.x, y2 = _a2.y;
      var topBuffer;
      if (this.config.calculateTopBuffer) {
        topBuffer = this.config.calculateTopBuffer();
      }
      var _b2 = this.calculateMouseMovement({
        e,
        isTop: true,
        anywhereWithin: true,
        topBuffer
      }), movementX = _b2.movementX, movementY = _b2.movementY;
      this.offsetElement(x2 + movementX, y2 + movementY);
      this.updateDragStartPosition(e.clientX, e.clientY);
    };
    PositionableFeature2.prototype.onMoveEnd = function() {
      this.isMoving = false;
      this.boundaryEl = null;
      this.element.classList.remove("ag-moving");
    };
    PositionableFeature2.prototype.setOffsetParent = function() {
      if (this.config.forcePopupParentAsOffsetParent) {
        this.offsetParent = this.popupService.getPopupParent();
      } else {
        this.offsetParent = this.element.offsetParent;
      }
    };
    PositionableFeature2.prototype.findBoundaryElement = function() {
      var el2 = this.element;
      while (el2) {
        if (window.getComputedStyle(el2).position !== "static") {
          return el2;
        }
        el2 = el2.parentElement;
      }
      return this.element;
    };
    PositionableFeature2.prototype.clearResizeListeners = function() {
      while (this.resizeListeners.length) {
        var params = this.resizeListeners.pop();
        this.dragService.removeDragSource(params);
      }
    };
    PositionableFeature2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
      if (this.moveElementDragListener) {
        this.dragService.removeDragSource(this.moveElementDragListener);
      }
      this.constrainSizeToAvailableHeight(false);
      this.clearResizeListeners();
      this.removeResizers();
    };
    __decorate$2o([
      Autowired("popupService")
    ], PositionableFeature2.prototype, "popupService", void 0);
    __decorate$2o([
      Autowired("resizeObserverService")
    ], PositionableFeature2.prototype, "resizeObserverService", void 0);
    __decorate$2o([
      Autowired("dragService")
    ], PositionableFeature2.prototype, "dragService", void 0);
    return PositionableFeature2;
  }(BeanStub)
);
var __extends$2Q = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2n = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ProvidedFilter = (
  /** @class */
  function(_super) {
    __extends$2Q(ProvidedFilter2, _super);
    function ProvidedFilter2(filterNameKey) {
      var _this = _super.call(this) || this;
      _this.filterNameKey = filterNameKey;
      _this.applyActive = false;
      _this.hidePopup = null;
      _this.debouncePending = false;
      _this.appliedModel = null;
      return _this;
    }
    ProvidedFilter2.prototype.postConstruct = function() {
      this.resetTemplate();
      this.createManagedBean(new ManagedFocusFeature(this.getFocusableElement(), {
        handleKeyDown: this.handleKeyDown.bind(this)
      }));
      this.positionableFeature = new PositionableFeature(this.getPositionableElement(), {
        forcePopupParentAsOffsetParent: true
      });
      this.createBean(this.positionableFeature);
    };
    ProvidedFilter2.prototype.handleKeyDown = function(e) {
    };
    ProvidedFilter2.prototype.getFilterTitle = function() {
      return this.translate(this.filterNameKey);
    };
    ProvidedFilter2.prototype.isFilterActive = function() {
      return !!this.appliedModel;
    };
    ProvidedFilter2.prototype.resetTemplate = function(paramsMap) {
      var eGui = this.getGui();
      if (eGui) {
        eGui.removeEventListener("submit", this.onFormSubmit);
      }
      var templateString = (
        /* html */
        '\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-' + this.getCssIdentifier() + '-body-wrapper" ref="eFilterBody">\n                    ' + this.createBodyTemplate() + "\n                </div>\n            </form>"
      );
      this.setTemplate(templateString, paramsMap);
      eGui = this.getGui();
      if (eGui) {
        eGui.addEventListener("submit", this.onFormSubmit);
      }
    };
    ProvidedFilter2.prototype.isReadOnly = function() {
      return !!this.providedFilterParams.readOnly;
    };
    ProvidedFilter2.prototype.init = function(params) {
      var _this = this;
      this.setParams(params);
      this.resetUiToDefaults(true).then(function() {
        _this.updateUiVisibility();
        _this.setupOnBtApplyDebounce();
      });
    };
    ProvidedFilter2.prototype.setParams = function(params) {
      this.providedFilterParams = params;
      this.applyActive = ProvidedFilter2.isUseApplyButton(params);
      this.createButtonPanel();
    };
    ProvidedFilter2.prototype.createButtonPanel = function() {
      var _this = this;
      var buttons = this.providedFilterParams.buttons;
      if (!buttons || buttons.length < 1 || this.isReadOnly()) {
        return;
      }
      var eButtonsPanel = document.createElement("div");
      eButtonsPanel.classList.add("ag-filter-apply-panel");
      var addButton = function(type) {
        var text;
        var clickListener;
        switch (type) {
          case "apply":
            text = _this.translate("applyFilter");
            clickListener = function(e) {
              return _this.onBtApply(false, false, e);
            };
            break;
          case "clear":
            text = _this.translate("clearFilter");
            clickListener = function() {
              return _this.onBtClear();
            };
            break;
          case "reset":
            text = _this.translate("resetFilter");
            clickListener = function() {
              return _this.onBtReset();
            };
            break;
          case "cancel":
            text = _this.translate("cancelFilter");
            clickListener = function(e) {
              _this.onBtCancel(e);
            };
            break;
          default:
            console.warn("AG Grid: Unknown button type specified");
            return;
        }
        var buttonType = type === "apply" ? "submit" : "button";
        var button = loadTemplate(
          /* html */
          '<button\n                    type="' + buttonType + '"\n                    ref="' + type + 'FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >' + text + "\n                </button>"
        );
        eButtonsPanel.appendChild(button);
        _this.addManagedListener(button, "click", clickListener);
      };
      convertToSet(buttons).forEach(function(type) {
        return addButton(type);
      });
      this.getGui().appendChild(eButtonsPanel);
    };
    ProvidedFilter2.prototype.getDefaultDebounceMs = function() {
      return 0;
    };
    ProvidedFilter2.prototype.setupOnBtApplyDebounce = function() {
      var _this = this;
      var debounceMs = ProvidedFilter2.getDebounceMs(this.providedFilterParams, this.getDefaultDebounceMs());
      var debounceFunc = debounce$1(this.checkApplyDebounce.bind(this), debounceMs);
      this.onBtApplyDebounce = function() {
        _this.debouncePending = true;
        debounceFunc();
      };
    };
    ProvidedFilter2.prototype.checkApplyDebounce = function() {
      if (this.debouncePending) {
        this.debouncePending = false;
        this.onBtApply();
      }
    };
    ProvidedFilter2.prototype.getModel = function() {
      return this.appliedModel ? this.appliedModel : null;
    };
    ProvidedFilter2.prototype.setModel = function(model) {
      var _this = this;
      var promise = model != null ? this.setModelIntoUi(model) : this.resetUiToDefaults();
      return promise.then(function() {
        _this.updateUiVisibility();
        _this.applyModel("api");
      });
    };
    ProvidedFilter2.prototype.onBtCancel = function(e) {
      var _this = this;
      this.resetUiToActiveModel(this.getModel(), function() {
        _this.handleCancelEnd(e);
      });
    };
    ProvidedFilter2.prototype.handleCancelEnd = function(e) {
      if (this.providedFilterParams.closeOnApply) {
        this.close(e);
      }
    };
    ProvidedFilter2.prototype.resetUiToActiveModel = function(currentModel, afterUiUpdatedFunc) {
      var _this = this;
      var afterAppliedFunc = function() {
        _this.onUiChanged(false, "prevent");
        afterUiUpdatedFunc === null || afterUiUpdatedFunc === void 0 ? void 0 : afterUiUpdatedFunc();
      };
      if (currentModel != null) {
        this.setModelIntoUi(currentModel).then(afterAppliedFunc);
      } else {
        this.resetUiToDefaults().then(afterAppliedFunc);
      }
    };
    ProvidedFilter2.prototype.onBtClear = function() {
      var _this = this;
      this.resetUiToDefaults().then(function() {
        return _this.onUiChanged();
      });
    };
    ProvidedFilter2.prototype.onBtReset = function() {
      this.onBtClear();
      this.onBtApply();
    };
    ProvidedFilter2.prototype.applyModel = function(source) {
      var newModel = this.getModelFromUi();
      if (!this.isModelValid(newModel)) {
        return false;
      }
      var previousModel = this.appliedModel;
      this.appliedModel = newModel;
      return !this.areModelsEqual(previousModel, newModel);
    };
    ProvidedFilter2.prototype.isModelValid = function(model) {
      return true;
    };
    ProvidedFilter2.prototype.onFormSubmit = function(e) {
      e.preventDefault();
    };
    ProvidedFilter2.prototype.onBtApply = function(afterFloatingFilter, afterDataChange, e) {
      if (afterFloatingFilter === void 0) {
        afterFloatingFilter = false;
      }
      if (afterDataChange === void 0) {
        afterDataChange = false;
      }
      if (e) {
        e.preventDefault();
      }
      if (this.applyModel(afterDataChange ? "rowDataUpdated" : "ui")) {
        this.providedFilterParams.filterChangedCallback({ afterFloatingFilter, afterDataChange });
      }
      var closeOnApply = this.providedFilterParams.closeOnApply;
      if (closeOnApply && this.applyActive && !afterFloatingFilter && !afterDataChange) {
        this.close(e);
      }
    };
    ProvidedFilter2.prototype.onNewRowsLoaded = function() {
    };
    ProvidedFilter2.prototype.close = function(e) {
      if (!this.hidePopup) {
        return;
      }
      var keyboardEvent = e;
      var key = keyboardEvent && keyboardEvent.key;
      var params;
      if (key === "Enter" || key === "Space") {
        params = { keyboardEvent };
      }
      this.hidePopup(params);
      this.hidePopup = null;
    };
    ProvidedFilter2.prototype.onUiChanged = function(fromFloatingFilter, apply) {
      if (fromFloatingFilter === void 0) {
        fromFloatingFilter = false;
      }
      this.updateUiVisibility();
      this.providedFilterParams.filterModifiedCallback();
      if (this.applyActive && !this.isReadOnly()) {
        var isValid2 = this.isModelValid(this.getModelFromUi());
        setDisabled(this.getRefElement("applyFilterButton"), !isValid2);
      }
      if (fromFloatingFilter && !apply || apply === "immediately") {
        this.onBtApply(fromFloatingFilter);
      } else if (!this.applyActive && !apply || apply === "debounce") {
        this.onBtApplyDebounce();
      }
    };
    ProvidedFilter2.prototype.afterGuiAttached = function(params) {
      if (params) {
        this.hidePopup = params.hidePopup;
      }
      this.refreshFilterResizer(params === null || params === void 0 ? void 0 : params.container);
    };
    ProvidedFilter2.prototype.refreshFilterResizer = function(containerType) {
      if (!this.positionableFeature || containerType === "toolPanel") {
        return;
      }
      var isFloatingFilter = containerType === "floatingFilter";
      var _a2 = this, positionableFeature = _a2.positionableFeature, gridOptionsService = _a2.gridOptionsService;
      if (isFloatingFilter) {
        positionableFeature.restoreLastSize();
        positionableFeature.setResizable(gridOptionsService.is("enableRtl") ? { bottom: true, bottomLeft: true, left: true } : { bottom: true, bottomRight: true, right: true });
      } else {
        this.positionableFeature.removeSizeFromEl();
        this.positionableFeature.setResizable(false);
      }
      this.positionableFeature.constrainSizeToAvailableHeight(true);
    };
    ProvidedFilter2.prototype.afterGuiDetached = function() {
      this.checkApplyDebounce();
      if (this.positionableFeature) {
        this.positionableFeature.constrainSizeToAvailableHeight(false);
      }
    };
    ProvidedFilter2.getDebounceMs = function(params, debounceDefault) {
      if (ProvidedFilter2.isUseApplyButton(params)) {
        if (params.debounceMs != null) {
          console.warn("AG Grid: debounceMs is ignored when apply button is present");
        }
        return 0;
      }
      return params.debounceMs != null ? params.debounceMs : debounceDefault;
    };
    ProvidedFilter2.isUseApplyButton = function(params) {
      return !!params.buttons && params.buttons.indexOf("apply") >= 0;
    };
    ProvidedFilter2.prototype.destroy = function() {
      var eGui = this.getGui();
      if (eGui) {
        eGui.removeEventListener("submit", this.onFormSubmit);
      }
      this.hidePopup = null;
      if (this.positionableFeature) {
        this.positionableFeature = this.destroyBean(this.positionableFeature);
      }
      _super.prototype.destroy.call(this);
    };
    ProvidedFilter2.prototype.translate = function(key) {
      var translate = this.localeService.getLocaleTextFunc();
      return translate(key, DEFAULT_FILTER_LOCALE_TEXT[key]);
    };
    ProvidedFilter2.prototype.getCellValue = function(rowNode) {
      var _a2 = this.providedFilterParams, api = _a2.api, colDef = _a2.colDef, column = _a2.column, columnApi = _a2.columnApi, context = _a2.context;
      return this.providedFilterParams.valueGetter({
        api,
        colDef,
        column,
        columnApi,
        context,
        data: rowNode.data,
        getValue: function(field) {
          return rowNode.data[field];
        },
        node: rowNode
      });
    };
    ProvidedFilter2.prototype.getPositionableElement = function() {
      return this.eFilterBody;
    };
    __decorate$2n([
      Autowired("rowModel")
    ], ProvidedFilter2.prototype, "rowModel", void 0);
    __decorate$2n([
      RefSelector("eFilterBody")
    ], ProvidedFilter2.prototype, "eFilterBody", void 0);
    __decorate$2n([
      PostConstruct
    ], ProvidedFilter2.prototype, "postConstruct", null);
    return ProvidedFilter2;
  }(Component)
);
var __extends$2P = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2m = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgAbstractLabel = (
  /** @class */
  function(_super) {
    __extends$2P(AgAbstractLabel2, _super);
    function AgAbstractLabel2(config, template) {
      var _this = _super.call(this, template) || this;
      _this.labelSeparator = "";
      _this.labelAlignment = "left";
      _this.disabled = false;
      _this.label = "";
      _this.config = config || {};
      return _this;
    }
    AgAbstractLabel2.prototype.postConstruct = function() {
      this.addCssClass("ag-labeled");
      this.eLabel.classList.add("ag-label");
      var _a2 = this.config, labelSeparator = _a2.labelSeparator, label = _a2.label, labelWidth = _a2.labelWidth, labelAlignment = _a2.labelAlignment;
      if (labelSeparator != null) {
        this.setLabelSeparator(labelSeparator);
      }
      if (label != null) {
        this.setLabel(label);
      }
      if (labelWidth != null) {
        this.setLabelWidth(labelWidth);
      }
      this.setLabelAlignment(labelAlignment || this.labelAlignment);
      this.refreshLabel();
    };
    AgAbstractLabel2.prototype.refreshLabel = function() {
      clearElement(this.eLabel);
      if (typeof this.label === "string") {
        this.eLabel.innerText = this.label + this.labelSeparator;
      } else if (this.label) {
        this.eLabel.appendChild(this.label);
      }
      if (this.label === "") {
        setDisplayed(this.eLabel, false);
        setAriaRole(this.eLabel, "presentation");
      } else {
        setDisplayed(this.eLabel, true);
        setAriaRole(this.eLabel, null);
      }
    };
    AgAbstractLabel2.prototype.setLabelSeparator = function(labelSeparator) {
      if (this.labelSeparator === labelSeparator) {
        return this;
      }
      this.labelSeparator = labelSeparator;
      if (this.label != null) {
        this.refreshLabel();
      }
      return this;
    };
    AgAbstractLabel2.prototype.getLabelId = function() {
      this.eLabel.id = this.eLabel.id || "ag-" + this.getCompId() + "-label";
      return this.eLabel.id;
    };
    AgAbstractLabel2.prototype.getLabel = function() {
      return this.label;
    };
    AgAbstractLabel2.prototype.setLabel = function(label) {
      if (this.label === label) {
        return this;
      }
      this.label = label;
      this.refreshLabel();
      return this;
    };
    AgAbstractLabel2.prototype.setLabelAlignment = function(alignment) {
      var eGui = this.getGui();
      var eGuiClassList = eGui.classList;
      eGuiClassList.toggle("ag-label-align-left", alignment === "left");
      eGuiClassList.toggle("ag-label-align-right", alignment === "right");
      eGuiClassList.toggle("ag-label-align-top", alignment === "top");
      return this;
    };
    AgAbstractLabel2.prototype.setLabelEllipsis = function(hasEllipsis) {
      this.eLabel.classList.toggle("ag-label-ellipsis", hasEllipsis);
      return this;
    };
    AgAbstractLabel2.prototype.setLabelWidth = function(width) {
      if (this.label == null) {
        return this;
      }
      setElementWidth(this.eLabel, width);
      return this;
    };
    AgAbstractLabel2.prototype.setDisabled = function(disabled) {
      disabled = !!disabled;
      var element = this.getGui();
      setDisabled(element, disabled);
      element.classList.toggle("ag-disabled", disabled);
      this.disabled = disabled;
      return this;
    };
    AgAbstractLabel2.prototype.isDisabled = function() {
      return !!this.disabled;
    };
    __decorate$2m([
      PostConstruct
    ], AgAbstractLabel2.prototype, "postConstruct", null);
    return AgAbstractLabel2;
  }(Component)
);
var __extends$2O = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgAbstractField = (
  /** @class */
  function(_super) {
    __extends$2O(AgAbstractField2, _super);
    function AgAbstractField2(config, template, className) {
      var _this = _super.call(this, config, template) || this;
      _this.className = className;
      return _this;
    }
    AgAbstractField2.prototype.postConstruct = function() {
      _super.prototype.postConstruct.call(this);
      if (this.className) {
        this.addCssClass(this.className);
      }
    };
    AgAbstractField2.prototype.onValueChange = function(callbackFn) {
      var _this = this;
      this.addManagedListener(this, AgAbstractField2.EVENT_CHANGED, function() {
        return callbackFn(_this.getValue());
      });
      return this;
    };
    AgAbstractField2.prototype.getWidth = function() {
      return this.getGui().clientWidth;
    };
    AgAbstractField2.prototype.setWidth = function(width) {
      setFixedWidth(this.getGui(), width);
      return this;
    };
    AgAbstractField2.prototype.getPreviousValue = function() {
      return this.previousValue;
    };
    AgAbstractField2.prototype.getValue = function() {
      return this.value;
    };
    AgAbstractField2.prototype.setValue = function(value, silent) {
      if (this.value === value) {
        return this;
      }
      this.previousValue = this.value;
      this.value = value;
      if (!silent) {
        this.dispatchEvent({ type: AgAbstractField2.EVENT_CHANGED });
      }
      return this;
    };
    AgAbstractField2.EVENT_CHANGED = "valueChange";
    return AgAbstractField2;
  }(AgAbstractLabel)
);
var __extends$2N = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2l = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgPickerField = (
  /** @class */
  function(_super) {
    __extends$2N(AgPickerField2, _super);
    function AgPickerField2(config, className, pickerIcon, ariaRole) {
      var _this = _super.call(
        this,
        config,
        /* html */
        '<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper"\n                    tabIndex="-1"\n                    aria-expanded="false"\n                    ' + (ariaRole ? 'role="' + ariaRole + '"' : "") + '\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',
        className
      ) || this;
      _this.pickerIcon = pickerIcon;
      _this.isPickerDisplayed = false;
      _this.isDestroyingPicker = false;
      _this.skipClick = false;
      return _this;
    }
    AgPickerField2.prototype.postConstruct = function() {
      var _this = this;
      _super.prototype.postConstruct.call(this);
      var displayId = "ag-" + this.getCompId() + "-display";
      this.eDisplayField.setAttribute("id", displayId);
      setAriaDescribedBy(this.eWrapper, displayId);
      var clickHandler = function() {
        if (_this.skipClick) {
          _this.skipClick = false;
          return;
        }
        if (_this.isDisabled()) {
          return;
        }
        _this.pickerComponent = _this.showPicker();
      };
      var eGui = this.getGui();
      this.addManagedListener(eGui, "mousedown", function(e) {
        if (!_this.skipClick && _this.pickerComponent && _this.pickerComponent.isAlive() && isVisible(_this.pickerComponent.getGui()) && eGui.contains(e.target)) {
          _this.skipClick = true;
        }
      });
      this.addManagedListener(eGui, "keydown", function(e) {
        switch (e.key) {
          case KeyCode.UP:
          case KeyCode.DOWN:
          case KeyCode.ENTER:
          case KeyCode.SPACE:
            clickHandler();
          case KeyCode.ESCAPE:
            if (_this.isPickerDisplayed) {
              e.preventDefault();
            }
            break;
        }
      });
      this.addManagedListener(this.eWrapper, "click", clickHandler);
      this.addManagedListener(this.eLabel, "click", clickHandler);
      if (this.pickerIcon) {
        var icon = createIconNoSpan(this.pickerIcon, this.gridOptionsService);
        if (icon) {
          this.eIcon.appendChild(icon);
        }
      }
    };
    AgPickerField2.prototype.refreshLabel = function() {
      if (exists(this.getLabel())) {
        setAriaLabelledBy(this.eWrapper, this.getLabelId());
      } else {
        this.eWrapper.removeAttribute("aria-labelledby");
      }
      _super.prototype.refreshLabel.call(this);
    };
    AgPickerField2.prototype.setAriaLabel = function(label) {
      setAriaLabel(this.eWrapper, label);
      return this;
    };
    AgPickerField2.prototype.setInputWidth = function(width) {
      setElementWidth(this.eWrapper, width);
      return this;
    };
    AgPickerField2.prototype.getFocusableElement = function() {
      return this.eWrapper;
    };
    __decorate$2l([
      RefSelector("eLabel")
    ], AgPickerField2.prototype, "eLabel", void 0);
    __decorate$2l([
      RefSelector("eWrapper")
    ], AgPickerField2.prototype, "eWrapper", void 0);
    __decorate$2l([
      RefSelector("eDisplayField")
    ], AgPickerField2.prototype, "eDisplayField", void 0);
    __decorate$2l([
      RefSelector("eIcon")
    ], AgPickerField2.prototype, "eIcon", void 0);
    return AgPickerField2;
  }(AgAbstractField)
);
var __extends$2M = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2k = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgList = (
  /** @class */
  function(_super) {
    __extends$2M(AgList2, _super);
    function AgList2(cssIdentifier) {
      if (cssIdentifier === void 0) {
        cssIdentifier = "default";
      }
      var _this = _super.call(
        this,
        /* html */
        '<div class="ag-list ag-' + cssIdentifier + '-list" role="listbox"></div>'
      ) || this;
      _this.cssIdentifier = cssIdentifier;
      _this.options = [];
      _this.itemEls = [];
      return _this;
    }
    AgList2.prototype.init = function() {
      this.addManagedListener(this.getGui(), "keydown", this.handleKeyDown.bind(this));
    };
    AgList2.prototype.handleKeyDown = function(e) {
      var key = e.key;
      switch (key) {
        case KeyCode.ENTER:
          if (!this.highlightedEl) {
            this.setValue(this.getValue());
          } else {
            var pos = this.itemEls.indexOf(this.highlightedEl);
            this.setValueByIndex(pos);
          }
          break;
        case KeyCode.DOWN:
        case KeyCode.UP:
          var isDown = key === KeyCode.DOWN;
          var itemToHighlight = void 0;
          e.preventDefault();
          if (!this.highlightedEl) {
            itemToHighlight = this.itemEls[isDown ? 0 : this.itemEls.length - 1];
          } else {
            var currentIdx = this.itemEls.indexOf(this.highlightedEl);
            var nextPos = currentIdx + (isDown ? 1 : -1);
            nextPos = Math.min(Math.max(nextPos, 0), this.itemEls.length - 1);
            itemToHighlight = this.itemEls[nextPos];
          }
          this.highlightItem(itemToHighlight);
          break;
      }
    };
    AgList2.prototype.addOptions = function(listOptions) {
      var _this = this;
      listOptions.forEach(function(listOption) {
        return _this.addOption(listOption);
      });
      return this;
    };
    AgList2.prototype.addOption = function(listOption) {
      var value = listOption.value, text = listOption.text;
      var sanitisedText = escapeString(text || value);
      this.options.push({ value, text: sanitisedText });
      this.renderOption(value, sanitisedText);
      this.updateIndices();
      return this;
    };
    AgList2.prototype.updateIndices = function() {
      var options = this.getGui().querySelectorAll(".ag-list-item");
      options.forEach(function(option, idx) {
        setAriaPosInSet(option, idx + 1);
        setAriaSetSize(option, options.length);
      });
    };
    AgList2.prototype.renderOption = function(value, text) {
      var _this = this;
      var itemEl = document.createElement("div");
      setAriaRole(itemEl, "option");
      itemEl.classList.add("ag-list-item", "ag-" + this.cssIdentifier + "-list-item");
      itemEl.innerHTML = "<span>" + text + "</span>";
      itemEl.tabIndex = -1;
      this.itemEls.push(itemEl);
      this.addManagedListener(itemEl, "mouseover", function() {
        return _this.highlightItem(itemEl);
      });
      this.addManagedListener(itemEl, "mouseleave", function() {
        return _this.clearHighlighted();
      });
      this.addManagedListener(itemEl, "click", function() {
        return _this.setValue(value);
      });
      this.getGui().appendChild(itemEl);
    };
    AgList2.prototype.setValue = function(value, silent) {
      if (this.value === value) {
        this.fireItemSelected();
        return this;
      }
      if (value == null) {
        this.reset();
        return this;
      }
      var idx = this.options.findIndex(function(option2) {
        return option2.value === value;
      });
      if (idx !== -1) {
        var option = this.options[idx];
        this.value = option.value;
        this.displayValue = option.text != null ? option.text : option.value;
        this.highlightItem(this.itemEls[idx]);
        if (!silent) {
          this.fireChangeEvent();
        }
      }
      return this;
    };
    AgList2.prototype.setValueByIndex = function(idx) {
      return this.setValue(this.options[idx].value);
    };
    AgList2.prototype.getValue = function() {
      return this.value;
    };
    AgList2.prototype.getDisplayValue = function() {
      return this.displayValue;
    };
    AgList2.prototype.refreshHighlighted = function() {
      var _this = this;
      this.clearHighlighted();
      var idx = this.options.findIndex(function(option) {
        return option.value === _this.value;
      });
      if (idx !== -1) {
        this.highlightItem(this.itemEls[idx]);
      }
    };
    AgList2.prototype.reset = function() {
      this.value = null;
      this.displayValue = null;
      this.clearHighlighted();
      this.fireChangeEvent();
    };
    AgList2.prototype.highlightItem = function(el2) {
      if (!el2.offsetParent) {
        return;
      }
      this.clearHighlighted();
      this.highlightedEl = el2;
      this.highlightedEl.classList.add(AgList2.ACTIVE_CLASS);
      setAriaSelected(this.highlightedEl, true);
      this.highlightedEl.focus();
    };
    AgList2.prototype.clearHighlighted = function() {
      if (!this.highlightedEl || !this.highlightedEl.offsetParent) {
        return;
      }
      this.highlightedEl.classList.remove(AgList2.ACTIVE_CLASS);
      setAriaSelected(this.highlightedEl, false);
      this.highlightedEl = null;
    };
    AgList2.prototype.fireChangeEvent = function() {
      this.dispatchEvent({ type: AgAbstractField.EVENT_CHANGED });
      this.fireItemSelected();
    };
    AgList2.prototype.fireItemSelected = function() {
      this.dispatchEvent({ type: AgList2.EVENT_ITEM_SELECTED });
    };
    AgList2.EVENT_ITEM_SELECTED = "selectedItem";
    AgList2.ACTIVE_CLASS = "ag-active-item";
    __decorate$2k([
      PostConstruct
    ], AgList2.prototype, "init", null);
    return AgList2;
  }(Component)
);
var __extends$2L = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2j = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgSelect = (
  /** @class */
  function(_super) {
    __extends$2L(AgSelect2, _super);
    function AgSelect2(config) {
      return _super.call(this, config, "ag-select", "smallDown", "listbox") || this;
    }
    AgSelect2.prototype.init = function() {
      var _this = this;
      this.listComponent = this.createBean(new AgList("select"));
      this.listComponent.setParentComponent(this);
      this.eWrapper.tabIndex = 0;
      this.listComponent.addManagedListener(this.listComponent, AgList.EVENT_ITEM_SELECTED, function() {
        if (_this.hideList) {
          _this.hideList();
        }
        _this.dispatchEvent({ type: AgSelect2.EVENT_ITEM_SELECTED });
      });
      this.listComponent.addManagedListener(this.listComponent, AgAbstractField.EVENT_CHANGED, function() {
        _this.setValue(_this.listComponent.getValue(), false, true);
        if (_this.hideList) {
          _this.hideList();
        }
      });
    };
    AgSelect2.prototype.showPicker = function() {
      var _this = this;
      var listGui = this.listComponent.getGui();
      var eDocument = this.gridOptionsService.getDocument();
      var destroyMouseWheelFunc = this.addManagedListener(eDocument.body, "wheel", function(e) {
        if (!listGui.contains(e.target) && _this.hideList) {
          _this.hideList();
        }
      });
      var destroyFocusOutFunc = this.addManagedListener(listGui, "focusout", function(e) {
        if (!listGui.contains(e.relatedTarget) && _this.hideList) {
          _this.hideList();
        }
      });
      var translate = this.localeService.getLocaleTextFunc();
      var addPopupRes = this.popupService.addPopup({
        modal: true,
        eChild: listGui,
        closeOnEsc: true,
        closedCallback: function() {
          _this.hideList = null;
          _this.isPickerDisplayed = false;
          destroyFocusOutFunc();
          destroyMouseWheelFunc();
          if (_this.isAlive()) {
            setAriaExpanded(_this.eWrapper, false);
            _this.getFocusableElement().focus();
          }
        },
        ariaLabel: translate("ariaLabelSelectField", "Select Field")
      });
      if (addPopupRes) {
        this.hideList = addPopupRes.hideFunc;
      }
      this.isPickerDisplayed = true;
      setElementWidth(listGui, getAbsoluteWidth(this.eWrapper));
      setAriaExpanded(this.eWrapper, true);
      listGui.style.maxHeight = getInnerHeight(this.popupService.getPopupParent()) + "px";
      listGui.style.position = "absolute";
      this.popupService.positionPopupByComponent({
        type: "ag-list",
        eventSource: this.eWrapper,
        ePopup: listGui,
        position: "under",
        keepWithinBounds: true
      });
      this.listComponent.refreshHighlighted();
      return this.listComponent;
    };
    AgSelect2.prototype.addOptions = function(options) {
      var _this = this;
      options.forEach(function(option) {
        return _this.addOption(option);
      });
      return this;
    };
    AgSelect2.prototype.addOption = function(option) {
      this.listComponent.addOption(option);
      return this;
    };
    AgSelect2.prototype.setValue = function(value, silent, fromPicker) {
      if (this.value === value) {
        return this;
      }
      if (!fromPicker) {
        this.listComponent.setValue(value, true);
      }
      var newValue = this.listComponent.getValue();
      if (newValue === this.getValue()) {
        return this;
      }
      this.eDisplayField.innerHTML = this.listComponent.getDisplayValue();
      return _super.prototype.setValue.call(this, value, silent);
    };
    AgSelect2.prototype.destroy = function() {
      if (this.hideList) {
        this.hideList();
      }
      this.destroyBean(this.listComponent);
      _super.prototype.destroy.call(this);
    };
    AgSelect2.EVENT_ITEM_SELECTED = "selectedItem";
    __decorate$2j([
      Autowired("popupService")
    ], AgSelect2.prototype, "popupService", void 0);
    __decorate$2j([
      PostConstruct
    ], AgSelect2.prototype, "init", null);
    return AgSelect2;
  }(AgPickerField)
);
var __extends$2K = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2i = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgAbstractInputField = (
  /** @class */
  function(_super) {
    __extends$2K(AgAbstractInputField2, _super);
    function AgAbstractInputField2(config, className, inputType, displayFieldTag) {
      if (inputType === void 0) {
        inputType = "text";
      }
      if (displayFieldTag === void 0) {
        displayFieldTag = "input";
      }
      var _this = _super.call(
        this,
        config,
        /* html */
        '\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <' + displayFieldTag + ' ref="eInput" class="ag-input-field-input"></' + displayFieldTag + ">\n                </div>\n            </div>",
        className
      ) || this;
      _this.inputType = inputType;
      _this.displayFieldTag = displayFieldTag;
      return _this;
    }
    AgAbstractInputField2.prototype.postConstruct = function() {
      _super.prototype.postConstruct.call(this);
      this.setInputType();
      this.eLabel.classList.add(this.className + "-label");
      this.eWrapper.classList.add(this.className + "-input-wrapper");
      this.eInput.classList.add(this.className + "-input");
      this.addCssClass("ag-input-field");
      this.eInput.id = this.eInput.id || "ag-" + this.getCompId() + "-input";
      var _a2 = this.config, width = _a2.width, value = _a2.value;
      if (width != null) {
        this.setWidth(width);
      }
      if (value != null) {
        this.setValue(value);
      }
      this.addInputListeners();
      this.activateTabIndex([this.eInput]);
    };
    AgAbstractInputField2.prototype.refreshLabel = function() {
      if (exists(this.getLabel())) {
        setAriaLabelledBy(this.eInput, this.getLabelId());
      } else {
        this.eInput.removeAttribute("aria-labelledby");
      }
      _super.prototype.refreshLabel.call(this);
    };
    AgAbstractInputField2.prototype.addInputListeners = function() {
      var _this = this;
      this.addManagedListener(this.eInput, "input", function(e) {
        return _this.setValue(e.target.value);
      });
    };
    AgAbstractInputField2.prototype.setInputType = function() {
      if (this.displayFieldTag === "input") {
        this.eInput.setAttribute("type", this.inputType);
      }
    };
    AgAbstractInputField2.prototype.getInputElement = function() {
      return this.eInput;
    };
    AgAbstractInputField2.prototype.setInputWidth = function(width) {
      setElementWidth(this.eWrapper, width);
      return this;
    };
    AgAbstractInputField2.prototype.setInputName = function(name) {
      this.getInputElement().setAttribute("name", name);
      return this;
    };
    AgAbstractInputField2.prototype.getFocusableElement = function() {
      return this.eInput;
    };
    AgAbstractInputField2.prototype.setMaxLength = function(length) {
      var eInput = this.eInput;
      eInput.maxLength = length;
      return this;
    };
    AgAbstractInputField2.prototype.setInputPlaceholder = function(placeholder) {
      addOrRemoveAttribute(this.eInput, "placeholder", placeholder);
      return this;
    };
    AgAbstractInputField2.prototype.setInputAriaLabel = function(label) {
      setAriaLabel(this.eInput, label);
      return this;
    };
    AgAbstractInputField2.prototype.setDisabled = function(disabled) {
      setDisabled(this.eInput, disabled);
      return _super.prototype.setDisabled.call(this, disabled);
    };
    __decorate$2i([
      RefSelector("eLabel")
    ], AgAbstractInputField2.prototype, "eLabel", void 0);
    __decorate$2i([
      RefSelector("eWrapper")
    ], AgAbstractInputField2.prototype, "eWrapper", void 0);
    __decorate$2i([
      RefSelector("eInput")
    ], AgAbstractInputField2.prototype, "eInput", void 0);
    return AgAbstractInputField2;
  }(AgAbstractField)
);
var __extends$2J = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgCheckbox = (
  /** @class */
  function(_super) {
    __extends$2J(AgCheckbox2, _super);
    function AgCheckbox2(config, className, inputType) {
      if (className === void 0) {
        className = "ag-checkbox";
      }
      if (inputType === void 0) {
        inputType = "checkbox";
      }
      var _this = _super.call(this, config, className, inputType) || this;
      _this.labelAlignment = "right";
      _this.selected = false;
      _this.readOnly = false;
      _this.passive = false;
      return _this;
    }
    AgCheckbox2.prototype.addInputListeners = function() {
      this.addManagedListener(this.eInput, "click", this.onCheckboxClick.bind(this));
      this.addManagedListener(this.eLabel, "click", this.toggle.bind(this));
    };
    AgCheckbox2.prototype.getNextValue = function() {
      return this.selected === void 0 ? true : !this.selected;
    };
    AgCheckbox2.prototype.setPassive = function(passive) {
      this.passive = passive;
    };
    AgCheckbox2.prototype.isReadOnly = function() {
      return this.readOnly;
    };
    AgCheckbox2.prototype.setReadOnly = function(readOnly) {
      this.eWrapper.classList.toggle("ag-disabled", readOnly);
      this.eInput.disabled = readOnly;
      this.readOnly = readOnly;
    };
    AgCheckbox2.prototype.setDisabled = function(disabled) {
      this.eWrapper.classList.toggle("ag-disabled", disabled);
      return _super.prototype.setDisabled.call(this, disabled);
    };
    AgCheckbox2.prototype.toggle = function() {
      if (this.eInput.disabled) {
        return;
      }
      var previousValue = this.isSelected();
      var nextValue = this.getNextValue();
      if (this.passive) {
        this.dispatchChange(nextValue, previousValue);
      } else {
        this.setValue(nextValue);
      }
    };
    AgCheckbox2.prototype.getValue = function() {
      return this.isSelected();
    };
    AgCheckbox2.prototype.setValue = function(value, silent) {
      this.refreshSelectedClass(value);
      this.setSelected(value, silent);
      return this;
    };
    AgCheckbox2.prototype.setName = function(name) {
      var input = this.getInputElement();
      input.name = name;
      return this;
    };
    AgCheckbox2.prototype.isSelected = function() {
      return this.selected;
    };
    AgCheckbox2.prototype.setSelected = function(selected, silent) {
      if (this.isSelected() === selected) {
        return;
      }
      this.previousValue = this.isSelected();
      selected = this.selected = typeof selected === "boolean" ? selected : void 0;
      this.eInput.checked = selected;
      this.eInput.indeterminate = selected === void 0;
      if (!silent) {
        this.dispatchChange(this.selected, this.previousValue);
      }
    };
    AgCheckbox2.prototype.dispatchChange = function(selected, previousValue, event) {
      this.dispatchEvent({ type: AgCheckbox2.EVENT_CHANGED, selected, previousValue, event });
      var input = this.getInputElement();
      var checkboxChangedEvent = {
        type: Events.EVENT_CHECKBOX_CHANGED,
        id: input.id,
        name: input.name,
        selected,
        previousValue
      };
      this.eventService.dispatchEvent(checkboxChangedEvent);
    };
    AgCheckbox2.prototype.onCheckboxClick = function(e) {
      if (this.passive || this.eInput.disabled) {
        return;
      }
      var previousValue = this.isSelected();
      var selected = this.selected = e.target.checked;
      this.refreshSelectedClass(selected);
      this.dispatchChange(selected, previousValue, e);
    };
    AgCheckbox2.prototype.refreshSelectedClass = function(value) {
      this.eWrapper.classList.toggle("ag-checked", value === true);
      this.eWrapper.classList.toggle("ag-indeterminate", value == null);
    };
    return AgCheckbox2;
  }(AgAbstractInputField)
);
var __extends$2I = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgRadioButton = (
  /** @class */
  function(_super) {
    __extends$2I(AgRadioButton2, _super);
    function AgRadioButton2(config) {
      return _super.call(this, config, "ag-radio-button", "radio") || this;
    }
    AgRadioButton2.prototype.isSelected = function() {
      return this.eInput.checked;
    };
    AgRadioButton2.prototype.toggle = function() {
      if (this.eInput.disabled) {
        return;
      }
      if (!this.isSelected()) {
        this.setValue(true);
      }
    };
    AgRadioButton2.prototype.addInputListeners = function() {
      _super.prototype.addInputListeners.call(this);
      this.addManagedListener(this.eventService, Events.EVENT_CHECKBOX_CHANGED, this.onChange.bind(this));
    };
    AgRadioButton2.prototype.onChange = function(event) {
      if (event.selected && event.name && this.eInput.name && this.eInput.name === event.name && event.id && this.eInput.id !== event.id) {
        this.setValue(false, true);
      }
    };
    return AgRadioButton2;
  }(AgCheckbox)
);
var __extends$2H = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __read$o = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$k = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var SimpleFilterModelFormatter = (
  /** @class */
  function() {
    function SimpleFilterModelFormatter2(localeService, optionsFactory) {
      this.localeService = localeService;
      this.optionsFactory = optionsFactory;
    }
    SimpleFilterModelFormatter2.prototype.getModelAsString = function(model) {
      var _this = this;
      if (!model) {
        return null;
      }
      var isCombined = model.operator != null;
      var translate = this.localeService.getLocaleTextFunc();
      if (isCombined) {
        var combinedModel = model;
        var conditions = combinedModel.conditions;
        if (!conditions) {
          var condition1 = combinedModel.condition1, condition2 = combinedModel.condition2;
          conditions = [condition1, condition2];
        }
        var customOptions = conditions.map(function(condition3) {
          return _this.getModelAsString(condition3);
        });
        var joinOperatorTranslateKey = combinedModel.operator === "AND" ? "andCondition" : "orCondition";
        return customOptions.join(" " + translate(joinOperatorTranslateKey, DEFAULT_FILTER_LOCALE_TEXT[joinOperatorTranslateKey]) + " ");
      } else if (model.type === SimpleFilter.BLANK || model.type === SimpleFilter.NOT_BLANK) {
        return translate(model.type, model.type);
      } else {
        var condition = model;
        var customOption = this.optionsFactory.getCustomOption(condition.type);
        var _a2 = customOption || {}, displayKey = _a2.displayKey, displayName = _a2.displayName, numberOfInputs = _a2.numberOfInputs;
        if (displayKey && displayName && numberOfInputs === 0) {
          translate(displayKey, displayName);
          return displayName;
        }
        return this.conditionToString(condition, customOption);
      }
    };
    return SimpleFilterModelFormatter2;
  }()
);
var SimpleFilter = (
  /** @class */
  function(_super) {
    __extends$2H(SimpleFilter2, _super);
    function SimpleFilter2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.eTypes = [];
      _this.eJoinOperatorPanels = [];
      _this.eJoinOperatorsAnd = [];
      _this.eJoinOperatorsOr = [];
      _this.eConditionBodies = [];
      _this.listener = function() {
        return _this.onUiChanged();
      };
      _this.lastUiCompletePosition = null;
      _this.joinOperatorId = 0;
      return _this;
    }
    SimpleFilter2.prototype.getNumberOfInputs = function(type) {
      var customOpts = this.optionsFactory.getCustomOption(type);
      if (customOpts) {
        var numberOfInputs = customOpts.numberOfInputs;
        return numberOfInputs != null ? numberOfInputs : 1;
      }
      var zeroInputTypes = [
        SimpleFilter2.EMPTY,
        SimpleFilter2.NOT_BLANK,
        SimpleFilter2.BLANK
      ];
      if (type && zeroInputTypes.indexOf(type) >= 0) {
        return 0;
      } else if (type === SimpleFilter2.IN_RANGE) {
        return 2;
      }
      return 1;
    };
    SimpleFilter2.prototype.onFloatingFilterChanged = function(type, value) {
      this.setTypeFromFloatingFilter(type);
      this.setValueFromFloatingFilter(value);
      this.onUiChanged(true);
    };
    SimpleFilter2.prototype.setTypeFromFloatingFilter = function(type) {
      var _this = this;
      this.eTypes.forEach(function(eType, position) {
        if (position === 0) {
          eType.setValue(type, true);
        } else {
          eType.setValue(_this.optionsFactory.getDefaultOption(), true);
        }
      });
    };
    SimpleFilter2.prototype.getModelFromUi = function() {
      var conditions = this.getUiCompleteConditions();
      if (conditions.length === 0) {
        return null;
      }
      if (this.maxNumConditions > 1 && conditions.length > 1) {
        return {
          filterType: this.getFilterType(),
          operator: this.getJoinOperator(),
          condition1: conditions[0],
          condition2: conditions[1],
          conditions
        };
      }
      return conditions[0];
    };
    SimpleFilter2.prototype.getConditionTypes = function() {
      return this.eTypes.map(function(eType) {
        return eType.getValue();
      });
    };
    SimpleFilter2.prototype.getConditionType = function(position) {
      return this.eTypes[position].getValue();
    };
    SimpleFilter2.prototype.getJoinOperator = function() {
      if (this.eJoinOperatorsOr.length === 0) {
        return this.defaultJoinOperator;
      }
      return this.eJoinOperatorsOr[0].getValue() === true ? "OR" : "AND";
    };
    SimpleFilter2.prototype.areModelsEqual = function(a, b) {
      var _this = this;
      if (!a && !b) {
        return true;
      }
      if (!a && b || a && !b) {
        return false;
      }
      var aIsSimple = !a.operator;
      var bIsSimple = !b.operator;
      var oneSimpleOneCombined = !aIsSimple && bIsSimple || aIsSimple && !bIsSimple;
      if (oneSimpleOneCombined) {
        return false;
      }
      var res;
      if (aIsSimple) {
        var aSimple = a;
        var bSimple = b;
        res = this.areSimpleModelsEqual(aSimple, bSimple);
      } else {
        var aCombined = a;
        var bCombined = b;
        res = aCombined.operator === bCombined.operator && areEqual(aCombined.conditions, bCombined.conditions, function(aModel, bModel) {
          return _this.areSimpleModelsEqual(aModel, bModel);
        });
      }
      return res;
    };
    SimpleFilter2.prototype.setModelIntoUi = function(model) {
      var _this = this;
      var isCombined = model.operator;
      if (isCombined) {
        var combinedModel = model;
        if (!combinedModel.conditions) {
          combinedModel.conditions = [
            combinedModel.condition1,
            combinedModel.condition2
          ];
        }
        var numConditions = this.validateAndUpdateConditions(combinedModel.conditions);
        var numPrevConditions = this.getNumConditions();
        if (numConditions < numPrevConditions) {
          this.removeConditionsAndOperators(numConditions);
        } else if (numConditions > numPrevConditions) {
          for (var i = numPrevConditions; i < numConditions; i++) {
            this.createJoinOperatorPanel();
            this.createOption();
          }
        }
        var orChecked_1 = combinedModel.operator === "OR";
        this.eJoinOperatorsAnd.forEach(function(eJoinOperatorAnd) {
          return eJoinOperatorAnd.setValue(!orChecked_1, true);
        });
        this.eJoinOperatorsOr.forEach(function(eJoinOperatorOr) {
          return eJoinOperatorOr.setValue(orChecked_1, true);
        });
        combinedModel.conditions.forEach(function(condition, position) {
          _this.eTypes[position].setValue(condition.type, true);
          _this.setConditionIntoUi(condition, position);
        });
      } else {
        var simpleModel = model;
        if (this.getNumConditions() > 1) {
          this.removeConditionsAndOperators(1);
        }
        this.eTypes[0].setValue(simpleModel.type, true);
        this.setConditionIntoUi(simpleModel, 0);
      }
      this.lastUiCompletePosition = this.getNumConditions() - 1;
      this.createMissingConditionsAndOperators();
      this.onUiChanged();
      return AgPromise.resolve();
    };
    SimpleFilter2.prototype.validateAndUpdateConditions = function(conditions) {
      var numConditions = conditions.length;
      if (numConditions > this.maxNumConditions) {
        conditions.splice(this.maxNumConditions);
        doOnce(function() {
          return console.warn('AG Grid: Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.');
        }, "simpleFilterSetModelMaxNumConditions");
        numConditions = this.maxNumConditions;
      }
      return numConditions;
    };
    SimpleFilter2.prototype.doesFilterPass = function(params) {
      var _this = this;
      var _a2;
      var model = this.getModel();
      if (model == null) {
        return true;
      }
      var operator = model.operator;
      var models = [];
      if (operator) {
        var combinedModel = model;
        models.push.apply(models, __spreadArray$k([], __read$o((_a2 = combinedModel.conditions) !== null && _a2 !== void 0 ? _a2 : [])));
      } else {
        models.push(model);
      }
      var combineFunction = operator && operator === "OR" ? "some" : "every";
      return models[combineFunction](function(m2) {
        return _this.individualConditionPasses(params, m2);
      });
    };
    SimpleFilter2.prototype.setParams = function(params) {
      _super.prototype.setParams.call(this, params);
      this.setNumConditions(params);
      this.defaultJoinOperator = this.getDefaultJoinOperator(params.defaultJoinOperator);
      this.filterPlaceholder = params.filterPlaceholder;
      this.optionsFactory = new OptionsFactory();
      this.optionsFactory.init(params, this.getDefaultFilterOptions());
      this.createFilterListOptions();
      this.createOption();
      this.createMissingConditionsAndOperators();
    };
    SimpleFilter2.prototype.setNumConditions = function(params) {
      var _a2, _b2;
      if (params.suppressAndOrCondition != null) {
        doOnce(function() {
          return console.warn('AG Grid: Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.');
        }, "simpleFilterSuppressAndOrCondition");
      }
      if (params.alwaysShowBothConditions != null) {
        doOnce(function() {
          return console.warn('AG Grid: Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.');
        }, "simpleFilterAlwaysShowBothConditions");
      }
      this.maxNumConditions = (_a2 = params.maxNumConditions) !== null && _a2 !== void 0 ? _a2 : params.suppressAndOrCondition ? 1 : 2;
      if (this.maxNumConditions < 1) {
        doOnce(function() {
          return console.warn('AG Grid: "filterParams.maxNumConditions" must be greater than or equal to zero.');
        }, "simpleFilterMaxNumConditions");
        this.maxNumConditions = 1;
      }
      this.numAlwaysVisibleConditions = (_b2 = params.numAlwaysVisibleConditions) !== null && _b2 !== void 0 ? _b2 : params.alwaysShowBothConditions ? 2 : 1;
      if (this.numAlwaysVisibleConditions < 1) {
        doOnce(function() {
          return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.');
        }, "simpleFilterNumAlwaysVisibleConditions");
        this.numAlwaysVisibleConditions = 1;
      }
      if (this.numAlwaysVisibleConditions > this.maxNumConditions) {
        doOnce(function() {
          return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".');
        }, "simpleFilterNumAlwaysVisibleGreaterThanMaxNumConditions");
        this.numAlwaysVisibleConditions = this.maxNumConditions;
      }
    };
    SimpleFilter2.prototype.createOption = function() {
      var _this = this;
      var eType = this.createManagedBean(new AgSelect());
      this.eTypes.push(eType);
      eType.addCssClass("ag-filter-select");
      this.eFilterBody.appendChild(eType.getGui());
      var eConditionBody = this.createValueElement();
      this.eConditionBodies.push(eConditionBody);
      this.eFilterBody.appendChild(eConditionBody);
      this.putOptionsIntoDropdown(eType);
      this.resetType(eType);
      var position = this.getNumConditions() - 1;
      this.forEachPositionInput(position, function(element) {
        return _this.resetInput(element);
      });
      this.addChangedListeners(eType, position);
    };
    SimpleFilter2.prototype.createJoinOperatorPanel = function() {
      var eJoinOperatorPanel = document.createElement("div");
      this.eJoinOperatorPanels.push(eJoinOperatorPanel);
      eJoinOperatorPanel.classList.add("ag-filter-condition");
      var eJoinOperatorAnd = this.createJoinOperator(this.eJoinOperatorsAnd, eJoinOperatorPanel, "and");
      var eJoinOperatorOr = this.createJoinOperator(this.eJoinOperatorsOr, eJoinOperatorPanel, "or");
      this.eFilterBody.appendChild(eJoinOperatorPanel);
      var index2 = this.eJoinOperatorPanels.length - 1;
      var uniqueGroupId = this.joinOperatorId++;
      this.resetJoinOperatorAnd(eJoinOperatorAnd, index2, uniqueGroupId);
      this.resetJoinOperatorOr(eJoinOperatorOr, index2, uniqueGroupId);
      if (!this.isReadOnly()) {
        eJoinOperatorAnd.onValueChange(this.listener);
        eJoinOperatorOr.onValueChange(this.listener);
      }
    };
    SimpleFilter2.prototype.createJoinOperator = function(eJoinOperators, eJoinOperatorPanel, andOr) {
      var eJoinOperator = this.createManagedBean(new AgRadioButton());
      eJoinOperators.push(eJoinOperator);
      eJoinOperator.addCssClass("ag-filter-condition-operator");
      eJoinOperator.addCssClass("ag-filter-condition-operator-" + andOr);
      eJoinOperatorPanel.appendChild(eJoinOperator.getGui());
      return eJoinOperator;
    };
    SimpleFilter2.prototype.getDefaultJoinOperator = function(defaultJoinOperator) {
      return defaultJoinOperator === "AND" || defaultJoinOperator === "OR" ? defaultJoinOperator : "AND";
    };
    SimpleFilter2.prototype.createFilterListOptions = function() {
      var _this = this;
      var filterOptions = this.optionsFactory.getFilterOptions();
      this.filterListOptions = filterOptions.map(function(option) {
        return typeof option === "string" ? _this.createBoilerplateListOption(option) : _this.createCustomListOption(option);
      });
    };
    SimpleFilter2.prototype.putOptionsIntoDropdown = function(eType) {
      this.filterListOptions.forEach(function(listOption) {
        eType.addOption(listOption);
      });
      eType.setDisabled(this.filterListOptions.length <= 1);
    };
    SimpleFilter2.prototype.createBoilerplateListOption = function(option) {
      return { value: option, text: this.translate(option) };
    };
    SimpleFilter2.prototype.createCustomListOption = function(option) {
      var displayKey = option.displayKey;
      var customOption = this.optionsFactory.getCustomOption(option.displayKey);
      return {
        value: displayKey,
        text: customOption ? this.localeService.getLocaleTextFunc()(customOption.displayKey, customOption.displayName) : this.translate(displayKey)
      };
    };
    SimpleFilter2.prototype.isAllowTwoConditions = function() {
      return this.maxNumConditions >= 2;
    };
    SimpleFilter2.prototype.createBodyTemplate = function() {
      return "";
    };
    SimpleFilter2.prototype.getCssIdentifier = function() {
      return "simple-filter";
    };
    SimpleFilter2.prototype.updateUiVisibility = function() {
      var joinOperator = this.getJoinOperator();
      this.updateNumConditions();
      this.updateConditionStatusesAndValues(this.lastUiCompletePosition, joinOperator);
    };
    SimpleFilter2.prototype.updateNumConditions = function() {
      var _a2;
      var lastUiCompletePosition = -1;
      var areAllConditionsUiComplete = true;
      for (var position = 0; position < this.getNumConditions(); position++) {
        if (this.isConditionUiComplete(position)) {
          lastUiCompletePosition = position;
        } else {
          areAllConditionsUiComplete = false;
        }
      }
      if (this.shouldAddNewConditionAtEnd(areAllConditionsUiComplete)) {
        this.createJoinOperatorPanel();
        this.createOption();
      } else {
        var activePosition = (_a2 = this.lastUiCompletePosition) !== null && _a2 !== void 0 ? _a2 : this.getNumConditions() - 2;
        if (lastUiCompletePosition < activePosition) {
          this.removeConditionsAndOperators(activePosition + 1);
          var removeStartPosition = lastUiCompletePosition + 1;
          var numConditionsToRemove = activePosition - removeStartPosition;
          if (numConditionsToRemove > 0) {
            this.removeConditionsAndOperators(removeStartPosition, numConditionsToRemove);
          }
          this.createMissingConditionsAndOperators();
        }
      }
      this.lastUiCompletePosition = lastUiCompletePosition;
    };
    SimpleFilter2.prototype.updateConditionStatusesAndValues = function(lastUiCompletePosition, joinOperator) {
      var _this = this;
      this.eTypes.forEach(function(eType, position) {
        var disabled = _this.isConditionDisabled(position, lastUiCompletePosition);
        eType.setDisabled(disabled || _this.filterListOptions.length <= 1);
        if (position === 1) {
          setDisabled(_this.eJoinOperatorPanels[0], disabled);
          _this.eJoinOperatorsAnd[0].setDisabled(disabled);
          _this.eJoinOperatorsOr[0].setDisabled(disabled);
        }
      });
      this.eConditionBodies.forEach(function(element, index2) {
        setDisplayed(element, _this.isConditionBodyVisible(index2));
      });
      var orChecked = (joinOperator !== null && joinOperator !== void 0 ? joinOperator : this.getJoinOperator()) === "OR";
      this.eJoinOperatorsAnd.forEach(function(eJoinOperatorAnd, index2) {
        eJoinOperatorAnd.setValue(!orChecked, true);
      });
      this.eJoinOperatorsOr.forEach(function(eJoinOperatorOr, index2) {
        eJoinOperatorOr.setValue(orChecked, true);
      });
      this.forEachInput(function(element, index2, position, numberOfInputs) {
        _this.setElementDisplayed(element, index2 < numberOfInputs);
        _this.setElementDisabled(element, _this.isConditionDisabled(position, lastUiCompletePosition));
      });
      this.resetPlaceholder();
    };
    SimpleFilter2.prototype.shouldAddNewConditionAtEnd = function(areAllConditionsUiComplete) {
      return areAllConditionsUiComplete && this.getNumConditions() < this.maxNumConditions && !this.isReadOnly();
    };
    SimpleFilter2.prototype.removeConditionsAndOperators = function(startPosition, deleteCount) {
      if (startPosition >= this.getNumConditions()) {
        return;
      }
      this.removeComponents(this.eTypes, startPosition, deleteCount);
      this.removeElements(this.eConditionBodies, startPosition, deleteCount);
      this.removeValueElements(startPosition, deleteCount);
      var joinOperatorIndex = Math.max(startPosition - 1, 0);
      this.removeElements(this.eJoinOperatorPanels, joinOperatorIndex, deleteCount);
      this.removeComponents(this.eJoinOperatorsAnd, joinOperatorIndex, deleteCount);
      this.removeComponents(this.eJoinOperatorsOr, joinOperatorIndex, deleteCount);
    };
    SimpleFilter2.prototype.removeElements = function(elements2, startPosition, deleteCount) {
      var removedElements = this.removeItems(elements2, startPosition, deleteCount);
      removedElements.forEach(function(element) {
        return removeFromParent(element);
      });
    };
    SimpleFilter2.prototype.removeComponents = function(components, startPosition, deleteCount) {
      var _this = this;
      var removedComponents = this.removeItems(components, startPosition, deleteCount);
      removedComponents.forEach(function(comp) {
        removeFromParent(comp.getGui());
        _this.destroyBean(comp);
      });
    };
    SimpleFilter2.prototype.removeItems = function(items, startPosition, deleteCount) {
      return deleteCount == null ? items.splice(startPosition) : items.splice(startPosition, deleteCount);
    };
    SimpleFilter2.prototype.afterGuiAttached = function(params) {
      _super.prototype.afterGuiAttached.call(this, params);
      this.resetPlaceholder();
      if (!params || !params.suppressFocus && !this.isReadOnly()) {
        var firstInput = this.getInputs(0)[0];
        if (!firstInput) {
          return;
        }
        if (firstInput instanceof AgAbstractInputField) {
          firstInput.getInputElement().focus();
        }
      }
    };
    SimpleFilter2.prototype.afterGuiDetached = function() {
      _super.prototype.afterGuiDetached.call(this);
      var appliedModel = this.getModel();
      if (!this.areModelsEqual(appliedModel, this.getModelFromUi()) || this.hasInvalidInputs()) {
        this.resetUiToActiveModel(appliedModel);
      }
      var lastUiCompletePosition = -1;
      var updatedLastUiCompletePosition = -1;
      var conditionsRemoved = false;
      var joinOperator = this.getJoinOperator();
      for (var position = this.getNumConditions() - 1; position >= 0; position--) {
        if (this.isConditionUiComplete(position)) {
          if (lastUiCompletePosition === -1) {
            lastUiCompletePosition = position;
            updatedLastUiCompletePosition = position;
          }
        } else {
          var shouldRemovePositionAtEnd = position >= this.numAlwaysVisibleConditions && !this.isConditionUiComplete(position - 1);
          var positionBeforeLastUiCompletePosition = position < lastUiCompletePosition;
          if (shouldRemovePositionAtEnd || positionBeforeLastUiCompletePosition) {
            this.removeConditionsAndOperators(position, 1);
            conditionsRemoved = true;
            if (positionBeforeLastUiCompletePosition) {
              updatedLastUiCompletePosition--;
            }
          }
        }
      }
      var shouldUpdateConditionStatusesAndValues = false;
      if (this.getNumConditions() < this.numAlwaysVisibleConditions) {
        this.createMissingConditionsAndOperators();
        shouldUpdateConditionStatusesAndValues = true;
      }
      if (this.shouldAddNewConditionAtEnd(updatedLastUiCompletePosition === this.getNumConditions() - 1)) {
        this.createJoinOperatorPanel();
        this.createOption();
        shouldUpdateConditionStatusesAndValues = true;
      }
      if (shouldUpdateConditionStatusesAndValues) {
        this.updateConditionStatusesAndValues(updatedLastUiCompletePosition, joinOperator);
      }
      if (conditionsRemoved) {
        this.updateJoinOperatorsDisabled();
      }
      this.lastUiCompletePosition = updatedLastUiCompletePosition;
    };
    SimpleFilter2.prototype.getPlaceholderText = function(defaultPlaceholder, position) {
      var placeholder = this.translate(defaultPlaceholder);
      if (isFunction$2(this.filterPlaceholder)) {
        var filterPlaceholderFn = this.filterPlaceholder;
        var filterOptionKey = this.eTypes[position].getValue();
        var filterOption = this.translate(filterOptionKey);
        placeholder = filterPlaceholderFn({
          filterOptionKey,
          filterOption,
          placeholder
        });
      } else if (typeof this.filterPlaceholder === "string") {
        placeholder = this.filterPlaceholder;
      }
      return placeholder;
    };
    SimpleFilter2.prototype.resetPlaceholder = function() {
      var _this = this;
      var globalTranslate = this.localeService.getLocaleTextFunc();
      this.forEachInput(function(element, index2, position, numberOfInputs) {
        if (!(element instanceof AgAbstractInputField)) {
          return;
        }
        var placeholder = index2 === 0 && numberOfInputs > 1 ? "inRangeStart" : index2 === 0 ? "filterOoo" : "inRangeEnd";
        var ariaLabel = index2 === 0 && numberOfInputs > 1 ? globalTranslate("ariaFilterFromValue", "Filter from value") : index2 === 0 ? globalTranslate("ariaFilterValue", "Filter Value") : globalTranslate("ariaFilterToValue", "Filter to Value");
        element.setInputPlaceholder(_this.getPlaceholderText(placeholder, position));
        element.setInputAriaLabel(ariaLabel);
      });
    };
    SimpleFilter2.prototype.setElementValue = function(element, value) {
      if (element instanceof AgAbstractInputField) {
        element.setValue(value != null ? String(value) : null, true);
      }
    };
    SimpleFilter2.prototype.setElementDisplayed = function(element, displayed) {
      if (element instanceof Component) {
        setDisplayed(element.getGui(), displayed);
      }
    };
    SimpleFilter2.prototype.setElementDisabled = function(element, disabled) {
      if (element instanceof Component) {
        setDisabled(element.getGui(), disabled);
      }
    };
    SimpleFilter2.prototype.attachElementOnChange = function(element, listener) {
      if (element instanceof AgAbstractInputField) {
        element.onValueChange(listener);
      }
    };
    SimpleFilter2.prototype.forEachInput = function(cb2) {
      var _this = this;
      this.getConditionTypes().forEach(function(type, position) {
        _this.forEachPositionTypeInput(position, type, cb2);
      });
    };
    SimpleFilter2.prototype.forEachPositionInput = function(position, cb2) {
      var type = this.getConditionType(position);
      this.forEachPositionTypeInput(position, type, cb2);
    };
    SimpleFilter2.prototype.forEachPositionTypeInput = function(position, type, cb2) {
      var numberOfInputs = this.getNumberOfInputs(type);
      var inputs = this.getInputs(position);
      for (var index2 = 0; index2 < inputs.length; index2++) {
        var input = inputs[index2];
        if (input != null) {
          cb2(input, index2, position, numberOfInputs);
        }
      }
    };
    SimpleFilter2.prototype.isConditionDisabled = function(position, lastUiCompletePosition) {
      if (this.isReadOnly()) {
        return true;
      }
      if (position === 0) {
        return false;
      }
      return position > lastUiCompletePosition + 1;
    };
    SimpleFilter2.prototype.isConditionBodyVisible = function(position) {
      var type = this.getConditionType(position);
      var numberOfInputs = this.getNumberOfInputs(type);
      return numberOfInputs > 0;
    };
    SimpleFilter2.prototype.isConditionUiComplete = function(position) {
      if (position >= this.getNumConditions()) {
        return false;
      }
      var type = this.getConditionType(position);
      if (type === SimpleFilter2.EMPTY) {
        return false;
      }
      if (this.getValues(position).some(function(v2) {
        return v2 == null;
      })) {
        return false;
      }
      return true;
    };
    SimpleFilter2.prototype.getNumConditions = function() {
      return this.eTypes.length;
    };
    SimpleFilter2.prototype.getUiCompleteConditions = function() {
      var conditions = [];
      for (var position = 0; position < this.getNumConditions(); position++) {
        if (this.isConditionUiComplete(position)) {
          conditions.push(this.createCondition(position));
        }
      }
      return conditions;
    };
    SimpleFilter2.prototype.createMissingConditionsAndOperators = function() {
      if (this.isReadOnly()) {
        return;
      }
      for (var i = this.getNumConditions(); i < this.numAlwaysVisibleConditions; i++) {
        this.createJoinOperatorPanel();
        this.createOption();
      }
    };
    SimpleFilter2.prototype.resetUiToDefaults = function(silent) {
      var _this = this;
      this.removeConditionsAndOperators(this.isReadOnly() ? 1 : this.numAlwaysVisibleConditions);
      this.eTypes.forEach(function(eType) {
        return _this.resetType(eType);
      });
      this.eJoinOperatorsAnd.forEach(function(eJoinOperatorAnd, index2) {
        return _this.resetJoinOperatorAnd(eJoinOperatorAnd, index2, _this.joinOperatorId + index2);
      });
      this.eJoinOperatorsOr.forEach(function(eJoinOperatorOr, index2) {
        return _this.resetJoinOperatorOr(eJoinOperatorOr, index2, _this.joinOperatorId + index2);
      });
      this.joinOperatorId++;
      this.forEachInput(function(element) {
        return _this.resetInput(element);
      });
      this.resetPlaceholder();
      this.createMissingConditionsAndOperators();
      this.lastUiCompletePosition = null;
      if (!silent) {
        this.onUiChanged();
      }
      return AgPromise.resolve();
    };
    SimpleFilter2.prototype.resetType = function(eType) {
      var translate = this.localeService.getLocaleTextFunc();
      var filteringLabel = translate("ariaFilteringOperator", "Filtering operator");
      eType.setValue(this.optionsFactory.getDefaultOption(), true).setAriaLabel(filteringLabel).setDisabled(this.isReadOnly() || this.filterListOptions.length <= 1);
    };
    SimpleFilter2.prototype.resetJoinOperatorAnd = function(eJoinOperatorAnd, index2, uniqueGroupId) {
      this.resetJoinOperator(eJoinOperatorAnd, index2, this.isDefaultOperator("AND"), this.translate("andCondition"), uniqueGroupId);
    };
    SimpleFilter2.prototype.resetJoinOperatorOr = function(eJoinOperatorOr, index2, uniqueGroupId) {
      this.resetJoinOperator(eJoinOperatorOr, index2, this.isDefaultOperator("OR"), this.translate("orCondition"), uniqueGroupId);
    };
    SimpleFilter2.prototype.resetJoinOperator = function(eJoinOperator, index2, value, label, uniqueGroupId) {
      this.updateJoinOperatorDisabled(eJoinOperator.setValue(value, true).setName("ag-simple-filter-and-or-" + this.getCompId() + "-" + uniqueGroupId).setLabel(label), index2);
    };
    SimpleFilter2.prototype.updateJoinOperatorsDisabled = function() {
      var _this = this;
      this.eJoinOperatorsAnd.forEach(function(eJoinOperator, index2) {
        return _this.updateJoinOperatorDisabled(eJoinOperator, index2);
      });
      this.eJoinOperatorsOr.forEach(function(eJoinOperator, index2) {
        return _this.updateJoinOperatorDisabled(eJoinOperator, index2);
      });
    };
    SimpleFilter2.prototype.updateJoinOperatorDisabled = function(eJoinOperator, index2) {
      eJoinOperator.setDisabled(this.isReadOnly() || index2 > 0);
    };
    SimpleFilter2.prototype.resetInput = function(element) {
      this.setElementValue(element, null);
      this.setElementDisabled(element, this.isReadOnly());
    };
    SimpleFilter2.prototype.setConditionIntoUi = function(model, position) {
      var _this = this;
      var values2 = this.mapValuesFromModel(model);
      this.forEachInput(function(element, index2, elPosition, _2) {
        if (elPosition !== position) {
          return;
        }
        _this.setElementValue(element, values2[index2] != null ? values2[index2] : null);
      });
    };
    SimpleFilter2.prototype.setValueFromFloatingFilter = function(value) {
      var _this = this;
      this.forEachInput(function(element, index2, position, _2) {
        _this.setElementValue(element, index2 === 0 && position === 0 ? value : null);
      });
    };
    SimpleFilter2.prototype.isDefaultOperator = function(operator) {
      return operator === this.defaultJoinOperator;
    };
    SimpleFilter2.prototype.addChangedListeners = function(eType, position) {
      var _this = this;
      if (this.isReadOnly()) {
        return;
      }
      eType.onValueChange(this.listener);
      this.forEachPositionInput(position, function(element) {
        _this.attachElementOnChange(element, _this.listener);
      });
    };
    SimpleFilter2.prototype.individualConditionPasses = function(params, filterModel) {
      var cellValue = this.getCellValue(params.node);
      var values2 = this.mapValuesFromModel(filterModel);
      var customFilterOption = this.optionsFactory.getCustomOption(filterModel.type);
      var customFilterResult = this.evaluateCustomFilter(customFilterOption, values2, cellValue);
      if (customFilterResult != null) {
        return customFilterResult;
      }
      if (cellValue == null) {
        return this.evaluateNullValue(filterModel.type);
      }
      return this.evaluateNonNullValue(values2, cellValue, filterModel, params);
    };
    SimpleFilter2.prototype.evaluateCustomFilter = function(customFilterOption, values2, cellValue) {
      if (customFilterOption == null) {
        return;
      }
      var predicate = customFilterOption.predicate;
      if (predicate != null && !values2.some(function(v2) {
        return v2 == null;
      })) {
        return predicate(values2, cellValue);
      }
      return;
    };
    SimpleFilter2.prototype.isBlank = function(cellValue) {
      return cellValue == null || typeof cellValue === "string" && cellValue.trim().length === 0;
    };
    SimpleFilter2.prototype.hasInvalidInputs = function() {
      return false;
    };
    SimpleFilter2.EMPTY = "empty";
    SimpleFilter2.BLANK = "blank";
    SimpleFilter2.NOT_BLANK = "notBlank";
    SimpleFilter2.EQUALS = "equals";
    SimpleFilter2.NOT_EQUAL = "notEqual";
    SimpleFilter2.LESS_THAN = "lessThan";
    SimpleFilter2.LESS_THAN_OR_EQUAL = "lessThanOrEqual";
    SimpleFilter2.GREATER_THAN = "greaterThan";
    SimpleFilter2.GREATER_THAN_OR_EQUAL = "greaterThanOrEqual";
    SimpleFilter2.IN_RANGE = "inRange";
    SimpleFilter2.CONTAINS = "contains";
    SimpleFilter2.NOT_CONTAINS = "notContains";
    SimpleFilter2.STARTS_WITH = "startsWith";
    SimpleFilter2.ENDS_WITH = "endsWith";
    return SimpleFilter2;
  }(ProvidedFilter)
);
var __extends$2G = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var ScalarFilter = (
  /** @class */
  function(_super) {
    __extends$2G(ScalarFilter2, _super);
    function ScalarFilter2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ScalarFilter2.prototype.setParams = function(params) {
      _super.prototype.setParams.call(this, params);
      this.scalarFilterParams = params;
    };
    ScalarFilter2.prototype.evaluateNullValue = function(filterType) {
      switch (filterType) {
        case ScalarFilter2.EQUALS:
        case ScalarFilter2.NOT_EQUAL:
          if (this.scalarFilterParams.includeBlanksInEquals) {
            return true;
          }
          break;
        case ScalarFilter2.GREATER_THAN:
        case ScalarFilter2.GREATER_THAN_OR_EQUAL:
          if (this.scalarFilterParams.includeBlanksInGreaterThan) {
            return true;
          }
          break;
        case ScalarFilter2.LESS_THAN:
        case ScalarFilter2.LESS_THAN_OR_EQUAL:
          if (this.scalarFilterParams.includeBlanksInLessThan) {
            return true;
          }
          break;
        case ScalarFilter2.IN_RANGE:
          if (this.scalarFilterParams.includeBlanksInRange) {
            return true;
          }
          break;
        case ScalarFilter2.BLANK:
          return true;
        case ScalarFilter2.NOT_BLANK:
          return false;
      }
      return false;
    };
    ScalarFilter2.prototype.evaluateNonNullValue = function(values2, cellValue, filterModel) {
      var comparator = this.comparator();
      var compareResult = values2[0] != null ? comparator(values2[0], cellValue) : 0;
      switch (filterModel.type) {
        case ScalarFilter2.EQUALS:
          return compareResult === 0;
        case ScalarFilter2.NOT_EQUAL:
          return compareResult !== 0;
        case ScalarFilter2.GREATER_THAN:
          return compareResult > 0;
        case ScalarFilter2.GREATER_THAN_OR_EQUAL:
          return compareResult >= 0;
        case ScalarFilter2.LESS_THAN:
          return compareResult < 0;
        case ScalarFilter2.LESS_THAN_OR_EQUAL:
          return compareResult <= 0;
        case ScalarFilter2.IN_RANGE: {
          var compareToResult = comparator(values2[1], cellValue);
          return this.scalarFilterParams.inRangeInclusive ? compareResult >= 0 && compareToResult <= 0 : compareResult > 0 && compareToResult < 0;
        }
        case ScalarFilter2.BLANK:
          return this.isBlank(cellValue);
        case ScalarFilter2.NOT_BLANK:
          return !this.isBlank(cellValue);
        default:
          console.warn('AG Grid: Unexpected type of filter "' + filterModel.type + '", it looks like the filter was configured with incorrect Filter Options');
          return true;
      }
    };
    return ScalarFilter2;
  }(SimpleFilter)
);
var __extends$2F = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$h = function() {
  __assign$h = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$h.apply(this, arguments);
};
var __decorate$2h = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DEFAULT_MIN_YEAR = 1e3;
var DEFAULT_MAX_YEAR = Infinity;
var DateFilterModelFormatter = (
  /** @class */
  function(_super) {
    __extends$2F(DateFilterModelFormatter2, _super);
    function DateFilterModelFormatter2(dateFilterParams, localeService, optionsFactory) {
      var _this = _super.call(this, localeService, optionsFactory) || this;
      _this.dateFilterParams = dateFilterParams;
      return _this;
    }
    DateFilterModelFormatter2.prototype.conditionToString = function(condition, options) {
      var type = condition.type;
      var numberOfInputs = (options || {}).numberOfInputs;
      var isRange = type == SimpleFilter.IN_RANGE || numberOfInputs === 2;
      var dateFrom = parseDateTimeFromString(condition.dateFrom);
      var dateTo = parseDateTimeFromString(condition.dateTo);
      var format2 = this.dateFilterParams.inRangeFloatingFilterDateFormat;
      if (isRange) {
        var formattedFrom = dateFrom !== null ? dateToFormattedString(dateFrom, format2) : "null";
        var formattedTo = dateTo !== null ? dateToFormattedString(dateTo, format2) : "null";
        return formattedFrom + "-" + formattedTo;
      }
      if (dateFrom != null) {
        return dateToFormattedString(dateFrom, format2);
      }
      return "" + type;
    };
    return DateFilterModelFormatter2;
  }(SimpleFilterModelFormatter)
);
var DateFilter = (
  /** @class */
  function(_super) {
    __extends$2F(DateFilter2, _super);
    function DateFilter2() {
      var _this = _super.call(this, "dateFilter") || this;
      _this.eConditionPanelsFrom = [];
      _this.eConditionPanelsTo = [];
      _this.dateConditionFromComps = [];
      _this.dateConditionToComps = [];
      _this.minValidYear = DEFAULT_MIN_YEAR;
      _this.maxValidYear = DEFAULT_MAX_YEAR;
      return _this;
    }
    DateFilter2.prototype.afterGuiAttached = function(params) {
      _super.prototype.afterGuiAttached.call(this, params);
      this.dateConditionFromComps[0].afterGuiAttached(params);
    };
    DateFilter2.prototype.mapValuesFromModel = function(filterModel) {
      var _a2 = filterModel || {}, dateFrom = _a2.dateFrom, dateTo = _a2.dateTo, type = _a2.type;
      return [
        dateFrom && parseDateTimeFromString(dateFrom) || null,
        dateTo && parseDateTimeFromString(dateTo) || null
      ].slice(0, this.getNumberOfInputs(type));
    };
    DateFilter2.prototype.comparator = function() {
      return this.dateFilterParams.comparator ? this.dateFilterParams.comparator : this.defaultComparator.bind(this);
    };
    DateFilter2.prototype.defaultComparator = function(filterDate, cellValue) {
      var cellAsDate = cellValue;
      if (cellValue == null || cellAsDate < filterDate) {
        return -1;
      }
      if (cellAsDate > filterDate) {
        return 1;
      }
      return 0;
    };
    DateFilter2.prototype.setParams = function(params) {
      this.dateFilterParams = params;
      _super.prototype.setParams.call(this, params);
      var yearParser = function(param, fallback) {
        if (params[param] != null) {
          if (!isNaN(params[param])) {
            return params[param] == null ? fallback : Number(params[param]);
          } else {
            console.warn("AG Grid: DateFilter " + param + " is not a number");
          }
        }
        return fallback;
      };
      this.minValidYear = yearParser("minValidYear", DEFAULT_MIN_YEAR);
      this.maxValidYear = yearParser("maxValidYear", DEFAULT_MAX_YEAR);
      if (this.minValidYear > this.maxValidYear) {
        console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear");
      }
      this.filterModelFormatter = new DateFilterModelFormatter(this.dateFilterParams, this.localeService, this.optionsFactory);
    };
    DateFilter2.prototype.createDateCompWrapper = function(element) {
      var _this = this;
      var dateCompWrapper = new DateCompWrapper(this.getContext(), this.userComponentFactory, {
        onDateChanged: function() {
          return _this.onUiChanged();
        },
        filterParams: this.dateFilterParams
      }, element);
      this.addDestroyFunc(function() {
        return dateCompWrapper.destroy();
      });
      return dateCompWrapper;
    };
    DateFilter2.prototype.setElementValue = function(element, value) {
      element.setDate(value);
    };
    DateFilter2.prototype.setElementDisplayed = function(element, displayed) {
      element.setDisplayed(displayed);
    };
    DateFilter2.prototype.setElementDisabled = function(element, disabled) {
      element.setDisabled(disabled);
    };
    DateFilter2.prototype.getDefaultFilterOptions = function() {
      return DateFilter2.DEFAULT_FILTER_OPTIONS;
    };
    DateFilter2.prototype.createValueElement = function() {
      var eCondition = document.createElement("div");
      eCondition.classList.add("ag-filter-body");
      this.createFromToElement(eCondition, this.eConditionPanelsFrom, this.dateConditionFromComps, "from");
      this.createFromToElement(eCondition, this.eConditionPanelsTo, this.dateConditionToComps, "to");
      return eCondition;
    };
    DateFilter2.prototype.createFromToElement = function(eCondition, eConditionPanels, dateConditionComps, fromTo) {
      var eConditionPanel = document.createElement("div");
      eConditionPanel.classList.add("ag-filter-" + fromTo);
      eConditionPanel.classList.add("ag-filter-date-" + fromTo);
      eConditionPanels.push(eConditionPanel);
      eCondition.appendChild(eConditionPanel);
      dateConditionComps.push(this.createDateCompWrapper(eConditionPanel));
    };
    DateFilter2.prototype.removeValueElements = function(startPosition, deleteCount) {
      this.removeDateComps(this.dateConditionFromComps, startPosition, deleteCount);
      this.removeDateComps(this.dateConditionToComps, startPosition, deleteCount);
      this.removeItems(this.eConditionPanelsFrom, startPosition, deleteCount);
      this.removeItems(this.eConditionPanelsTo, startPosition, deleteCount);
    };
    DateFilter2.prototype.removeDateComps = function(components, startPosition, deleteCount) {
      var removedComponents = this.removeItems(components, startPosition, deleteCount);
      removedComponents.forEach(function(comp) {
        return comp.destroy();
      });
    };
    DateFilter2.prototype.isConditionUiComplete = function(position) {
      var _this = this;
      if (!_super.prototype.isConditionUiComplete.call(this, position)) {
        return false;
      }
      var isValidDate = function(value) {
        return value != null && value.getUTCFullYear() >= _this.minValidYear && value.getUTCFullYear() <= _this.maxValidYear;
      };
      var valid = true;
      this.forEachInput(function(element, index2, elPosition, numberOfInputs) {
        if (elPosition !== position || !valid || index2 >= numberOfInputs) {
          return;
        }
        valid = valid && isValidDate(element.getDate());
      });
      return valid;
    };
    DateFilter2.prototype.areSimpleModelsEqual = function(aSimple, bSimple) {
      return aSimple.dateFrom === bSimple.dateFrom && aSimple.dateTo === bSimple.dateTo && aSimple.type === bSimple.type;
    };
    DateFilter2.prototype.getFilterType = function() {
      return "date";
    };
    DateFilter2.prototype.createCondition = function(position) {
      var type = this.getConditionType(position);
      var model = {};
      var values2 = this.getValues(position);
      if (values2.length > 0) {
        model.dateFrom = serialiseDate(values2[0]);
      }
      if (values2.length > 1) {
        model.dateTo = serialiseDate(values2[1]);
      }
      return __assign$h({ dateFrom: null, dateTo: null, filterType: this.getFilterType(), type }, model);
    };
    DateFilter2.prototype.resetPlaceholder = function() {
      var globalTranslate = this.localeService.getLocaleTextFunc();
      var placeholder = this.translate("dateFormatOoo");
      var ariaLabel = globalTranslate("ariaFilterValue", "Filter Value");
      this.forEachInput(function(element) {
        element.setInputPlaceholder(placeholder);
        element.setInputAriaLabel(ariaLabel);
      });
    };
    DateFilter2.prototype.getInputs = function(position) {
      if (position >= this.dateConditionFromComps.length) {
        return [null, null];
      }
      return [this.dateConditionFromComps[position], this.dateConditionToComps[position]];
    };
    DateFilter2.prototype.getValues = function(position) {
      var result = [];
      this.forEachPositionInput(position, function(element, index2, _elPosition, numberOfInputs) {
        if (index2 < numberOfInputs) {
          result.push(element.getDate());
        }
      });
      return result;
    };
    DateFilter2.prototype.getModelAsString = function(model) {
      var _a2;
      return (_a2 = this.filterModelFormatter.getModelAsString(model)) !== null && _a2 !== void 0 ? _a2 : "";
    };
    DateFilter2.DEFAULT_FILTER_OPTIONS = [
      ScalarFilter.EQUALS,
      ScalarFilter.GREATER_THAN,
      ScalarFilter.LESS_THAN,
      ScalarFilter.NOT_EQUAL,
      ScalarFilter.IN_RANGE,
      ScalarFilter.BLANK,
      ScalarFilter.NOT_BLANK
    ];
    __decorate$2h([
      Autowired("userComponentFactory")
    ], DateFilter2.prototype, "userComponentFactory", void 0);
    return DateFilter2;
  }(ScalarFilter)
);
var __extends$2E = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var SimpleFloatingFilter = (
  /** @class */
  function(_super) {
    __extends$2E(SimpleFloatingFilter2, _super);
    function SimpleFloatingFilter2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    SimpleFloatingFilter2.prototype.getDefaultDebounceMs = function() {
      return 0;
    };
    SimpleFloatingFilter2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    SimpleFloatingFilter2.prototype.isEventFromFloatingFilter = function(event) {
      return event && event.afterFloatingFilter;
    };
    SimpleFloatingFilter2.prototype.isEventFromDataChange = function(event) {
      return event === null || event === void 0 ? void 0 : event.afterDataChange;
    };
    SimpleFloatingFilter2.prototype.getLastType = function() {
      return this.lastType;
    };
    SimpleFloatingFilter2.prototype.isReadOnly = function() {
      return this.readOnly;
    };
    SimpleFloatingFilter2.prototype.setLastTypeFromModel = function(model) {
      if (!model) {
        this.lastType = this.optionsFactory.getDefaultOption();
        return;
      }
      var isCombined = model.operator;
      var condition;
      if (isCombined) {
        var combinedModel = model;
        condition = combinedModel.conditions[0];
      } else {
        condition = model;
      }
      this.lastType = condition.type;
    };
    SimpleFloatingFilter2.prototype.canWeEditAfterModelFromParentFilter = function(model) {
      if (!model) {
        return this.isTypeEditable(this.lastType);
      }
      var isCombined = model.operator;
      if (isCombined) {
        return false;
      }
      var simpleModel = model;
      return this.isTypeEditable(simpleModel.type);
    };
    SimpleFloatingFilter2.prototype.init = function(params) {
      this.optionsFactory = new OptionsFactory();
      this.optionsFactory.init(params.filterParams, this.getDefaultFilterOptions());
      this.lastType = this.optionsFactory.getDefaultOption();
      this.readOnly = !!params.filterParams.readOnly;
      var editable = this.isTypeEditable(this.lastType);
      this.setEditable(editable);
    };
    SimpleFloatingFilter2.prototype.doesFilterHaveSingleInput = function(filterType) {
      var customFilterOption = this.optionsFactory.getCustomOption(filterType);
      var numberOfInputs = (customFilterOption || {}).numberOfInputs;
      return numberOfInputs == null || numberOfInputs == 1;
    };
    SimpleFloatingFilter2.prototype.isTypeEditable = function(type) {
      var uneditableTypes = [
        SimpleFilter.IN_RANGE,
        SimpleFilter.EMPTY,
        SimpleFilter.BLANK,
        SimpleFilter.NOT_BLANK
      ];
      return !!type && !this.isReadOnly() && this.doesFilterHaveSingleInput(type) && uneditableTypes.indexOf(type) < 0;
    };
    return SimpleFloatingFilter2;
  }(Component)
);
var __extends$2D = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2g = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DateFloatingFilter = (
  /** @class */
  function(_super) {
    __extends$2D(DateFloatingFilter2, _super);
    function DateFloatingFilter2() {
      return _super.call(
        this,
        /* html */
        '\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>'
      ) || this;
    }
    DateFloatingFilter2.prototype.getDefaultFilterOptions = function() {
      return DateFilter.DEFAULT_FILTER_OPTIONS;
    };
    DateFloatingFilter2.prototype.init = function(params) {
      _super.prototype.init.call(this, params);
      this.params = params;
      this.filterParams = params.filterParams;
      this.createDateComponent();
      var translate = this.localeService.getLocaleTextFunc();
      this.eReadOnlyText.setDisabled(true).setInputAriaLabel(translate("ariaDateFilterInput", "Date Filter Input"));
      this.filterModelFormatter = new DateFilterModelFormatter(this.filterParams, this.localeService, this.optionsFactory);
    };
    DateFloatingFilter2.prototype.setEditable = function(editable) {
      setDisplayed(this.eDateWrapper, editable);
      setDisplayed(this.eReadOnlyText.getGui(), !editable);
    };
    DateFloatingFilter2.prototype.onParentModelChanged = function(model, event) {
      if (this.isEventFromFloatingFilter(event) || this.isEventFromDataChange(event)) {
        return;
      }
      _super.prototype.setLastTypeFromModel.call(this, model);
      var allowEditing = !this.isReadOnly() && this.canWeEditAfterModelFromParentFilter(model);
      this.setEditable(allowEditing);
      if (allowEditing) {
        if (model) {
          var dateModel = model;
          this.dateComp.setDate(parseDateTimeFromString(dateModel.dateFrom));
        } else {
          this.dateComp.setDate(null);
        }
        this.eReadOnlyText.setValue("");
      } else {
        this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(model));
        this.dateComp.setDate(null);
      }
    };
    DateFloatingFilter2.prototype.onDateChanged = function() {
      var _this = this;
      var filterValueDate = this.dateComp.getDate();
      var filterValueText = serialiseDate(filterValueDate);
      this.params.parentFilterInstance(function(filterInstance) {
        if (filterInstance) {
          var date = parseDateTimeFromString(filterValueText);
          filterInstance.onFloatingFilterChanged(_this.getLastType() || null, date);
        }
      });
    };
    DateFloatingFilter2.prototype.createDateComponent = function() {
      var _this = this;
      var debounceMs = ProvidedFilter.getDebounceMs(this.params.filterParams, this.getDefaultDebounceMs());
      var dateComponentParams = {
        onDateChanged: debounce$1(this.onDateChanged.bind(this), debounceMs),
        filterParams: this.params.column.getColDef().filterParams
      };
      this.dateComp = new DateCompWrapper(this.getContext(), this.userComponentFactory, dateComponentParams, this.eDateWrapper);
      this.addDestroyFunc(function() {
        return _this.dateComp.destroy();
      });
    };
    DateFloatingFilter2.prototype.getFilterModelFormatter = function() {
      return this.filterModelFormatter;
    };
    __decorate$2g([
      Autowired("userComponentFactory")
    ], DateFloatingFilter2.prototype, "userComponentFactory", void 0);
    __decorate$2g([
      RefSelector("eReadOnlyText")
    ], DateFloatingFilter2.prototype, "eReadOnlyText", void 0);
    __decorate$2g([
      RefSelector("eDateWrapper")
    ], DateFloatingFilter2.prototype, "eDateWrapper", void 0);
    return DateFloatingFilter2;
  }(SimpleFloatingFilter)
);
var __extends$2C = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2f = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DefaultDateComponent = (
  /** @class */
  function(_super) {
    __extends$2C(DefaultDateComponent2, _super);
    function DefaultDateComponent2() {
      return _super.call(
        this,
        /* html */
        '\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>'
      ) || this;
    }
    DefaultDateComponent2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    DefaultDateComponent2.prototype.init = function(params) {
      var _this = this;
      var eDocument = this.gridOptionsService.getDocument();
      var inputElement = this.eDateInput.getInputElement();
      var shouldUseBrowserDatePicker = this.shouldUseBrowserDatePicker(params);
      if (shouldUseBrowserDatePicker) {
        inputElement.type = "date";
      }
      var usingSafariDatePicker = shouldUseBrowserDatePicker && isBrowserSafari();
      this.addManagedListener(inputElement, "mousedown", function() {
        if (_this.eDateInput.isDisabled() || usingSafariDatePicker) {
          return;
        }
        inputElement.focus();
      });
      this.addManagedListener(inputElement, "input", function(e) {
        if (e.target !== eDocument.activeElement) {
          return;
        }
        if (_this.eDateInput.isDisabled()) {
          return;
        }
        params.onDateChanged();
      });
      var _a2 = params.filterParams || {}, minValidYear = _a2.minValidYear, maxValidYear = _a2.maxValidYear;
      if (minValidYear) {
        inputElement.min = minValidYear + "-01-01";
      }
      if (maxValidYear) {
        inputElement.max = maxValidYear + "-12-31";
      }
    };
    DefaultDateComponent2.prototype.getDate = function() {
      return parseDateTimeFromString(this.eDateInput.getValue());
    };
    DefaultDateComponent2.prototype.setDate = function(date) {
      this.eDateInput.setValue(serialiseDate(date, false));
    };
    DefaultDateComponent2.prototype.setInputPlaceholder = function(placeholder) {
      this.eDateInput.setInputPlaceholder(placeholder);
    };
    DefaultDateComponent2.prototype.setDisabled = function(disabled) {
      this.eDateInput.setDisabled(disabled);
    };
    DefaultDateComponent2.prototype.afterGuiAttached = function(params) {
      if (!params || !params.suppressFocus) {
        this.eDateInput.getInputElement().focus();
      }
    };
    DefaultDateComponent2.prototype.shouldUseBrowserDatePicker = function(params) {
      if (params.filterParams && params.filterParams.browserDatePicker != null) {
        return params.filterParams.browserDatePicker;
      }
      return isBrowserChrome() || isBrowserFirefox() || isBrowserSafari() && getSafariVersion() >= 14.1;
    };
    __decorate$2f([
      RefSelector("eDateInput")
    ], DefaultDateComponent2.prototype, "eDateInput", void 0);
    return DefaultDateComponent2;
  }(Component)
);
var __extends$2B = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgInputTextField = (
  /** @class */
  function(_super) {
    __extends$2B(AgInputTextField2, _super);
    function AgInputTextField2(config, className, inputType) {
      if (className === void 0) {
        className = "ag-text-field";
      }
      if (inputType === void 0) {
        inputType = "text";
      }
      return _super.call(this, config, className, inputType) || this;
    }
    AgInputTextField2.prototype.postConstruct = function() {
      _super.prototype.postConstruct.call(this);
      if (this.config.allowedCharPattern) {
        this.preventDisallowedCharacters();
      }
    };
    AgInputTextField2.prototype.setValue = function(value, silent) {
      var ret = _super.prototype.setValue.call(this, value, silent);
      if (this.eInput.value !== value) {
        this.eInput.value = exists(value) ? value : "";
      }
      return ret;
    };
    AgInputTextField2.prototype.setStartValue = function(value) {
      this.setValue(value, true);
    };
    AgInputTextField2.prototype.preventDisallowedCharacters = function() {
      var pattern = new RegExp("[" + this.config.allowedCharPattern + "]");
      var preventCharacters = function(event) {
        if (!isEventFromPrintableCharacter(event)) {
          return;
        }
        if (event.key && !pattern.test(event.key)) {
          event.preventDefault();
        }
      };
      this.addManagedListener(this.eInput, "keydown", preventCharacters);
      this.addManagedListener(this.eInput, "paste", function(e) {
        var _a2;
        var text = (_a2 = e.clipboardData) === null || _a2 === void 0 ? void 0 : _a2.getData("text");
        if (text && text.split("").some(function(c) {
          return !pattern.test(c);
        })) {
          e.preventDefault();
        }
      });
    };
    return AgInputTextField2;
  }(AgAbstractInputField)
);
var __extends$2A = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgInputNumberField = (
  /** @class */
  function(_super) {
    __extends$2A(AgInputNumberField2, _super);
    function AgInputNumberField2(config) {
      return _super.call(this, config, "ag-number-field", "number") || this;
    }
    AgInputNumberField2.prototype.postConstruct = function() {
      var _this = this;
      _super.prototype.postConstruct.call(this);
      this.addManagedListener(this.eInput, "blur", function() {
        var floatedValue = parseFloat(_this.eInput.value);
        var value = isNaN(floatedValue) ? "" : _this.normalizeValue(floatedValue.toString());
        if (_this.value !== value) {
          _this.setValue(value);
        }
      });
      this.addManagedListener(this.eInput, "wheel", this.onWheel.bind(this));
      this.eInput.step = "any";
    };
    AgInputNumberField2.prototype.onWheel = function(e) {
      if (document.activeElement === this.eInput) {
        e.preventDefault();
      }
    };
    AgInputNumberField2.prototype.normalizeValue = function(value) {
      if (value === "") {
        return "";
      }
      if (this.precision != null) {
        value = this.adjustPrecision(value);
      }
      var val = parseFloat(value);
      if (this.min != null && val < this.min) {
        value = this.min.toString();
      } else if (this.max != null && val > this.max) {
        value = this.max.toString();
      }
      return value;
    };
    AgInputNumberField2.prototype.adjustPrecision = function(value, isScientificNotation) {
      if (this.precision == null) {
        return value;
      }
      if (isScientificNotation) {
        var floatString = parseFloat(value).toFixed(this.precision);
        return parseFloat(floatString).toString();
      }
      var parts = String(value).split(".");
      if (parts.length > 1) {
        if (parts[1].length <= this.precision) {
          return value;
        } else if (this.precision > 0) {
          return parts[0] + "." + parts[1].slice(0, this.precision);
        }
      }
      return parts[0];
    };
    AgInputNumberField2.prototype.setMin = function(min2) {
      if (this.min === min2) {
        return this;
      }
      this.min = min2;
      addOrRemoveAttribute(this.eInput, "min", min2);
      return this;
    };
    AgInputNumberField2.prototype.setMax = function(max2) {
      if (this.max === max2) {
        return this;
      }
      this.max = max2;
      addOrRemoveAttribute(this.eInput, "max", max2);
      return this;
    };
    AgInputNumberField2.prototype.setPrecision = function(precision) {
      this.precision = precision;
      return this;
    };
    AgInputNumberField2.prototype.setStep = function(step) {
      if (this.step === step) {
        return this;
      }
      this.step = step;
      addOrRemoveAttribute(this.eInput, "step", step);
      return this;
    };
    AgInputNumberField2.prototype.setValue = function(value, silent) {
      var _this = this;
      return this.setValueOrInputValue(function(v2) {
        return _super.prototype.setValue.call(_this, v2, silent);
      }, function() {
        return _this;
      }, value);
    };
    AgInputNumberField2.prototype.setStartValue = function(value) {
      var _this = this;
      return this.setValueOrInputValue(function(v2) {
        return _super.prototype.setValue.call(_this, v2, true);
      }, function(v2) {
        _this.eInput.value = v2;
      }, value);
    };
    AgInputNumberField2.prototype.setValueOrInputValue = function(setValueFunc, setInputValueOnlyFunc, value) {
      if (exists(value)) {
        var setInputValueOnly = this.isScientificNotation(value);
        if (setInputValueOnly && this.eInput.validity.valid) {
          return setValueFunc(value);
        }
        if (!setInputValueOnly) {
          value = this.adjustPrecision(value);
          var normalizedValue = this.normalizeValue(value);
          setInputValueOnly = value != normalizedValue;
        }
        if (setInputValueOnly) {
          return setInputValueOnlyFunc(value);
        }
      }
      return setValueFunc(value);
    };
    AgInputNumberField2.prototype.getValue = function() {
      if (!this.eInput.validity.valid) {
        return void 0;
      }
      var inputValue = this.eInput.value;
      if (this.isScientificNotation(inputValue)) {
        return this.adjustPrecision(inputValue, true);
      }
      return _super.prototype.getValue.call(this);
    };
    AgInputNumberField2.prototype.isScientificNotation = function(value) {
      return typeof value === "string" && value.includes("e");
    };
    return AgInputNumberField2;
  }(AgInputTextField)
);
var __extends$2z = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var NumberFilterModelFormatter = (
  /** @class */
  function(_super) {
    __extends$2z(NumberFilterModelFormatter2, _super);
    function NumberFilterModelFormatter2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    NumberFilterModelFormatter2.prototype.conditionToString = function(condition, options) {
      var numberOfInputs = (options || {}).numberOfInputs;
      var isRange = condition.type == SimpleFilter.IN_RANGE || numberOfInputs === 2;
      if (isRange) {
        return condition.filter + "-" + condition.filterTo;
      }
      if (condition.filter != null) {
        return "" + condition.filter;
      }
      return "" + condition.type;
    };
    return NumberFilterModelFormatter2;
  }(SimpleFilterModelFormatter)
);
function getAllowedCharPattern(filterParams) {
  var allowedCharPattern = (filterParams !== null && filterParams !== void 0 ? filterParams : {}).allowedCharPattern;
  return allowedCharPattern !== null && allowedCharPattern !== void 0 ? allowedCharPattern : null;
}
var NumberFilter = (
  /** @class */
  function(_super) {
    __extends$2z(NumberFilter2, _super);
    function NumberFilter2() {
      var _this = _super.call(this, "numberFilter") || this;
      _this.eValuesFrom = [];
      _this.eValuesTo = [];
      return _this;
    }
    NumberFilter2.prototype.mapValuesFromModel = function(filterModel) {
      var _a2 = filterModel || {}, filter = _a2.filter, filterTo = _a2.filterTo, type = _a2.type;
      return [
        this.processValue(filter),
        this.processValue(filterTo)
      ].slice(0, this.getNumberOfInputs(type));
    };
    NumberFilter2.prototype.getDefaultDebounceMs = function() {
      return 500;
    };
    NumberFilter2.prototype.comparator = function() {
      return function(left, right) {
        if (left === right) {
          return 0;
        }
        return left < right ? 1 : -1;
      };
    };
    NumberFilter2.prototype.setParams = function(params) {
      this.numberFilterParams = params;
      _super.prototype.setParams.call(this, params);
      this.filterModelFormatter = new NumberFilterModelFormatter(this.localeService, this.optionsFactory);
    };
    NumberFilter2.prototype.getDefaultFilterOptions = function() {
      return NumberFilter2.DEFAULT_FILTER_OPTIONS;
    };
    NumberFilter2.prototype.createValueElement = function() {
      var allowedCharPattern = getAllowedCharPattern(this.numberFilterParams);
      var eCondition = document.createElement("div");
      eCondition.classList.add("ag-filter-body");
      setAriaRole(eCondition, "presentation");
      this.createFromToElement(eCondition, this.eValuesFrom, "from", allowedCharPattern);
      this.createFromToElement(eCondition, this.eValuesTo, "to", allowedCharPattern);
      return eCondition;
    };
    NumberFilter2.prototype.createFromToElement = function(eCondition, eValues, fromTo, allowedCharPattern) {
      var eValue = this.createManagedBean(allowedCharPattern ? new AgInputTextField({ allowedCharPattern }) : new AgInputNumberField());
      eValue.addCssClass("ag-filter-" + fromTo);
      eValue.addCssClass("ag-filter-filter");
      eValues.push(eValue);
      eCondition.appendChild(eValue.getGui());
    };
    NumberFilter2.prototype.removeValueElements = function(startPosition, deleteCount) {
      this.removeComponents(this.eValuesFrom, startPosition, deleteCount);
      this.removeComponents(this.eValuesTo, startPosition, deleteCount);
    };
    NumberFilter2.prototype.getValues = function(position) {
      var _this = this;
      var result = [];
      this.forEachPositionInput(position, function(element, index2, _elPosition, numberOfInputs) {
        if (index2 < numberOfInputs) {
          result.push(_this.processValue(_this.stringToFloat(element.getValue())));
        }
      });
      return result;
    };
    NumberFilter2.prototype.areSimpleModelsEqual = function(aSimple, bSimple) {
      return aSimple.filter === bSimple.filter && aSimple.filterTo === bSimple.filterTo && aSimple.type === bSimple.type;
    };
    NumberFilter2.prototype.getFilterType = function() {
      return "number";
    };
    NumberFilter2.prototype.processValue = function(value) {
      if (value == null) {
        return null;
      }
      return isNaN(value) ? null : value;
    };
    NumberFilter2.prototype.stringToFloat = function(value) {
      if (typeof value === "number") {
        return value;
      }
      var filterText = makeNull(value);
      if (filterText != null && filterText.trim() === "") {
        filterText = null;
      }
      if (this.numberFilterParams.numberParser) {
        return this.numberFilterParams.numberParser(filterText);
      }
      return filterText == null || filterText.trim() === "-" ? null : parseFloat(filterText);
    };
    NumberFilter2.prototype.createCondition = function(position) {
      var type = this.getConditionType(position);
      var model = {
        filterType: this.getFilterType(),
        type
      };
      var values2 = this.getValues(position);
      if (values2.length > 0) {
        model.filter = values2[0];
      }
      if (values2.length > 1) {
        model.filterTo = values2[1];
      }
      return model;
    };
    NumberFilter2.prototype.getInputs = function(position) {
      if (position >= this.eValuesFrom.length) {
        return [null, null];
      }
      return [this.eValuesFrom[position], this.eValuesTo[position]];
    };
    NumberFilter2.prototype.getModelAsString = function(model) {
      var _a2;
      return (_a2 = this.filterModelFormatter.getModelAsString(model)) !== null && _a2 !== void 0 ? _a2 : "";
    };
    NumberFilter2.prototype.hasInvalidInputs = function() {
      var invalidInputs = false;
      this.forEachInput(function(element) {
        if (!element.getInputElement().validity.valid) {
          invalidInputs = true;
          return;
        }
      });
      return invalidInputs;
    };
    NumberFilter2.DEFAULT_FILTER_OPTIONS = [
      ScalarFilter.EQUALS,
      ScalarFilter.NOT_EQUAL,
      ScalarFilter.LESS_THAN,
      ScalarFilter.LESS_THAN_OR_EQUAL,
      ScalarFilter.GREATER_THAN,
      ScalarFilter.GREATER_THAN_OR_EQUAL,
      ScalarFilter.IN_RANGE,
      ScalarFilter.BLANK,
      ScalarFilter.NOT_BLANK
    ];
    return NumberFilter2;
  }(ScalarFilter)
);
var __extends$2y = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$g = function() {
  __assign$g = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$g.apply(this, arguments);
};
var TextFilterModelFormatter = (
  /** @class */
  function(_super) {
    __extends$2y(TextFilterModelFormatter2, _super);
    function TextFilterModelFormatter2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    TextFilterModelFormatter2.prototype.conditionToString = function(condition, options) {
      var numberOfInputs = (options || {}).numberOfInputs;
      var isRange = condition.type == SimpleFilter.IN_RANGE || numberOfInputs === 2;
      if (isRange) {
        return condition.filter + "-" + condition.filterTo;
      }
      if (condition.filter != null) {
        return "" + condition.filter;
      }
      return "" + condition.type;
    };
    return TextFilterModelFormatter2;
  }(SimpleFilterModelFormatter)
);
var TextFilter = (
  /** @class */
  function(_super) {
    __extends$2y(TextFilter2, _super);
    function TextFilter2() {
      var _this = _super.call(this, "textFilter") || this;
      _this.eValuesFrom = [];
      _this.eValuesTo = [];
      return _this;
    }
    TextFilter2.trimInput = function(value) {
      var trimmedInput = value && value.trim();
      return trimmedInput === "" ? value : trimmedInput;
    };
    TextFilter2.prototype.getDefaultDebounceMs = function() {
      return 500;
    };
    TextFilter2.prototype.setParams = function(params) {
      this.textFilterParams = params;
      _super.prototype.setParams.call(this, params);
      this.matcher = this.getTextMatcher();
      this.formatter = this.textFilterParams.textFormatter || (this.textFilterParams.caseSensitive ? TextFilter2.DEFAULT_FORMATTER : TextFilter2.DEFAULT_LOWERCASE_FORMATTER);
      this.filterModelFormatter = new TextFilterModelFormatter(this.localeService, this.optionsFactory);
    };
    TextFilter2.prototype.getTextMatcher = function() {
      var legacyComparator = this.textFilterParams.textCustomComparator;
      if (legacyComparator) {
        _.doOnce(function() {
          return console.warn("AG Grid - textCustomComparator is deprecated, use textMatcher instead.");
        }, "textCustomComparator.deprecated");
        return function(_a2) {
          var filterOption = _a2.filterOption, value = _a2.value, filterText = _a2.filterText;
          return legacyComparator(filterOption, value, filterText);
        };
      }
      return this.textFilterParams.textMatcher || TextFilter2.DEFAULT_MATCHER;
    };
    TextFilter2.prototype.createCondition = function(position) {
      var type = this.getConditionType(position);
      var model = {
        filterType: this.getFilterType(),
        type
      };
      var values2 = this.getValues(position);
      if (values2.length > 0) {
        model.filter = values2[0];
      }
      if (values2.length > 1) {
        model.filterTo = values2[1];
      }
      return model;
    };
    TextFilter2.prototype.getFilterType = function() {
      return "text";
    };
    TextFilter2.prototype.areSimpleModelsEqual = function(aSimple, bSimple) {
      return aSimple.filter === bSimple.filter && aSimple.filterTo === bSimple.filterTo && aSimple.type === bSimple.type;
    };
    TextFilter2.prototype.getInputs = function(position) {
      if (position >= this.eValuesFrom.length) {
        return [null, null];
      }
      return [this.eValuesFrom[position], this.eValuesTo[position]];
    };
    TextFilter2.prototype.getValues = function(position) {
      var _this = this;
      var result = [];
      this.forEachPositionInput(position, function(element, index2, _elPosition, numberOfInputs) {
        if (index2 < numberOfInputs) {
          var value = makeNull(element.getValue());
          var cleanValue = (_this.textFilterParams.trimInput ? TextFilter2.trimInput(value) : value) || null;
          result.push(cleanValue);
          element.setValue(cleanValue, true);
        }
      });
      return result;
    };
    TextFilter2.prototype.getDefaultFilterOptions = function() {
      return TextFilter2.DEFAULT_FILTER_OPTIONS;
    };
    TextFilter2.prototype.createValueElement = function() {
      var eCondition = document.createElement("div");
      eCondition.classList.add("ag-filter-body");
      setAriaRole(eCondition, "presentation");
      this.createFromToElement(eCondition, this.eValuesFrom, "from");
      this.createFromToElement(eCondition, this.eValuesTo, "to");
      return eCondition;
    };
    TextFilter2.prototype.createFromToElement = function(eCondition, eValues, fromTo) {
      var eValue = this.createManagedBean(new AgInputTextField());
      eValue.addCssClass("ag-filter-" + fromTo);
      eValue.addCssClass("ag-filter-filter");
      eValues.push(eValue);
      eCondition.appendChild(eValue.getGui());
    };
    TextFilter2.prototype.removeValueElements = function(startPosition, deleteCount) {
      this.removeComponents(this.eValuesFrom, startPosition, deleteCount);
      this.removeComponents(this.eValuesTo, startPosition, deleteCount);
    };
    TextFilter2.prototype.mapValuesFromModel = function(filterModel) {
      var _a2 = filterModel || {}, filter = _a2.filter, filterTo = _a2.filterTo, type = _a2.type;
      return [
        filter || null,
        filterTo || null
      ].slice(0, this.getNumberOfInputs(type));
    };
    TextFilter2.prototype.evaluateNullValue = function(filterType) {
      var filterTypesAllowNulls = [
        SimpleFilter.NOT_EQUAL,
        SimpleFilter.NOT_CONTAINS,
        SimpleFilter.BLANK
      ];
      return filterType ? filterTypesAllowNulls.indexOf(filterType) >= 0 : false;
    };
    TextFilter2.prototype.evaluateNonNullValue = function(values2, cellValue, filterModel, params) {
      var _this = this;
      var formattedValues = values2.map(function(v2) {
        return _this.formatter(v2);
      }) || [];
      var cellValueFormatted = this.formatter(cellValue);
      var _a2 = this.textFilterParams, api = _a2.api, colDef = _a2.colDef, column = _a2.column, columnApi = _a2.columnApi, context = _a2.context, textFormatter = _a2.textFormatter;
      if (filterModel.type === SimpleFilter.BLANK) {
        return this.isBlank(cellValue);
      } else if (filterModel.type === SimpleFilter.NOT_BLANK) {
        return !this.isBlank(cellValue);
      }
      var matcherParams = {
        api,
        colDef,
        column,
        columnApi,
        context,
        node: params.node,
        data: params.data,
        filterOption: filterModel.type,
        value: cellValueFormatted,
        textFormatter
      };
      return formattedValues.some(function(v2) {
        return _this.matcher(__assign$g(__assign$g({}, matcherParams), { filterText: v2 }));
      });
    };
    TextFilter2.prototype.getModelAsString = function(model) {
      var _a2;
      return (_a2 = this.filterModelFormatter.getModelAsString(model)) !== null && _a2 !== void 0 ? _a2 : "";
    };
    TextFilter2.DEFAULT_FILTER_OPTIONS = [
      SimpleFilter.CONTAINS,
      SimpleFilter.NOT_CONTAINS,
      SimpleFilter.EQUALS,
      SimpleFilter.NOT_EQUAL,
      SimpleFilter.STARTS_WITH,
      SimpleFilter.ENDS_WITH,
      SimpleFilter.BLANK,
      SimpleFilter.NOT_BLANK
    ];
    TextFilter2.DEFAULT_FORMATTER = function(from2) {
      return from2;
    };
    TextFilter2.DEFAULT_LOWERCASE_FORMATTER = function(from2) {
      return from2 == null ? null : from2.toString().toLowerCase();
    };
    TextFilter2.DEFAULT_MATCHER = function(_a2) {
      var filterOption = _a2.filterOption, value = _a2.value, filterText = _a2.filterText;
      if (filterText == null) {
        return false;
      }
      switch (filterOption) {
        case TextFilter2.CONTAINS:
          return value.indexOf(filterText) >= 0;
        case TextFilter2.NOT_CONTAINS:
          return value.indexOf(filterText) < 0;
        case TextFilter2.EQUALS:
          return value === filterText;
        case TextFilter2.NOT_EQUAL:
          return value != filterText;
        case TextFilter2.STARTS_WITH:
          return value.indexOf(filterText) === 0;
        case TextFilter2.ENDS_WITH:
          var index2 = value.lastIndexOf(filterText);
          return index2 >= 0 && index2 === value.length - filterText.length;
        default:
          return false;
      }
    };
    return TextFilter2;
  }(SimpleFilter)
);
var __extends$2x = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2e = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var FloatingFilterTextInputService = (
  /** @class */
  function(_super) {
    __extends$2x(FloatingFilterTextInputService2, _super);
    function FloatingFilterTextInputService2(params) {
      var _this = _super.call(this) || this;
      _this.params = params;
      return _this;
    }
    FloatingFilterTextInputService2.prototype.setupGui = function(parentElement) {
      this.eFloatingFilterTextInput = this.createManagedBean(new AgInputTextField(this.params.config));
      this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel);
      parentElement.appendChild(this.eFloatingFilterTextInput.getGui());
    };
    FloatingFilterTextInputService2.prototype.setEditable = function(editable) {
      this.eFloatingFilterTextInput.setDisabled(!editable);
    };
    FloatingFilterTextInputService2.prototype.getValue = function() {
      return this.eFloatingFilterTextInput.getValue();
    };
    FloatingFilterTextInputService2.prototype.setValue = function(value, silent) {
      this.eFloatingFilterTextInput.setValue(value, silent);
    };
    FloatingFilterTextInputService2.prototype.addValueChangedListener = function(listener) {
      var inputGui = this.eFloatingFilterTextInput.getGui();
      this.addManagedListener(inputGui, "input", listener);
      this.addManagedListener(inputGui, "keydown", listener);
    };
    return FloatingFilterTextInputService2;
  }(BeanStub)
);
var TextInputFloatingFilter = (
  /** @class */
  function(_super) {
    __extends$2x(TextInputFloatingFilter2, _super);
    function TextInputFloatingFilter2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    TextInputFloatingFilter2.prototype.postConstruct = function() {
      this.setTemplate(
        /* html */
        '\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        '
      );
    };
    TextInputFloatingFilter2.prototype.getDefaultDebounceMs = function() {
      return 500;
    };
    TextInputFloatingFilter2.prototype.onParentModelChanged = function(model, event) {
      if (this.isEventFromFloatingFilter(event) || this.isEventFromDataChange(event)) {
        return;
      }
      this.setLastTypeFromModel(model);
      this.setEditable(this.canWeEditAfterModelFromParentFilter(model));
      this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(model));
    };
    TextInputFloatingFilter2.prototype.init = function(params) {
      this.params = params;
      var displayName = this.columnModel.getDisplayNameForColumn(params.column, "header", true);
      var translate = this.localeService.getLocaleTextFunc();
      var ariaLabel = displayName + " " + translate("ariaFilterInput", "Filter Input");
      this.floatingFilterInputService = this.createFloatingFilterInputService(ariaLabel);
      this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer);
      _super.prototype.init.call(this, params);
      this.applyActive = ProvidedFilter.isUseApplyButton(this.params.filterParams);
      if (!this.isReadOnly()) {
        var debounceMs = ProvidedFilter.getDebounceMs(this.params.filterParams, this.getDefaultDebounceMs());
        var toDebounce = debounce$1(this.syncUpWithParentFilter.bind(this), debounceMs);
        this.floatingFilterInputService.addValueChangedListener(toDebounce);
      }
    };
    TextInputFloatingFilter2.prototype.syncUpWithParentFilter = function(e) {
      var _this = this;
      var isEnterKey = e.key === KeyCode.ENTER;
      if (this.applyActive && !isEnterKey) {
        return;
      }
      var value = this.floatingFilterInputService.getValue();
      if (this.params.filterParams.trimInput) {
        value = TextFilter.trimInput(value);
        this.floatingFilterInputService.setValue(value, true);
      }
      this.params.parentFilterInstance(function(filterInstance) {
        if (filterInstance) {
          filterInstance.onFloatingFilterChanged(_this.getLastType() || null, value || null);
        }
      });
    };
    TextInputFloatingFilter2.prototype.setEditable = function(editable) {
      this.floatingFilterInputService.setEditable(editable);
    };
    __decorate$2e([
      Autowired("columnModel")
    ], TextInputFloatingFilter2.prototype, "columnModel", void 0);
    __decorate$2e([
      RefSelector("eFloatingFilterInputContainer")
    ], TextInputFloatingFilter2.prototype, "eFloatingFilterInputContainer", void 0);
    __decorate$2e([
      PostConstruct
    ], TextInputFloatingFilter2.prototype, "postConstruct", null);
    return TextInputFloatingFilter2;
  }(SimpleFloatingFilter)
);
var __extends$2w = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var FloatingFilterNumberInputService = (
  /** @class */
  function(_super) {
    __extends$2w(FloatingFilterNumberInputService2, _super);
    function FloatingFilterNumberInputService2(params) {
      var _this = _super.call(this) || this;
      _this.params = params;
      _this.numberInputActive = true;
      return _this;
    }
    FloatingFilterNumberInputService2.prototype.setupGui = function(parentElement) {
      this.eFloatingFilterNumberInput = this.createManagedBean(new AgInputNumberField());
      this.eFloatingFilterTextInput = this.createManagedBean(new AgInputTextField());
      this.eFloatingFilterTextInput.setDisabled(true);
      this.eFloatingFilterNumberInput.setInputAriaLabel(this.params.ariaLabel);
      this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel);
      parentElement.appendChild(this.eFloatingFilterNumberInput.getGui());
      parentElement.appendChild(this.eFloatingFilterTextInput.getGui());
    };
    FloatingFilterNumberInputService2.prototype.setEditable = function(editable) {
      this.numberInputActive = editable;
      this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive);
      this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive);
    };
    FloatingFilterNumberInputService2.prototype.getValue = function() {
      return this.getActiveInputElement().getValue();
    };
    FloatingFilterNumberInputService2.prototype.setValue = function(value, silent) {
      this.getActiveInputElement().setValue(value, silent);
    };
    FloatingFilterNumberInputService2.prototype.getActiveInputElement = function() {
      return this.numberInputActive ? this.eFloatingFilterNumberInput : this.eFloatingFilterTextInput;
    };
    FloatingFilterNumberInputService2.prototype.addValueChangedListener = function(listener) {
      this.setupListeners(this.eFloatingFilterNumberInput.getGui(), listener);
      this.setupListeners(this.eFloatingFilterTextInput.getGui(), listener);
    };
    FloatingFilterNumberInputService2.prototype.setupListeners = function(element, listener) {
      this.addManagedListener(element, "input", listener);
      this.addManagedListener(element, "keydown", listener);
    };
    return FloatingFilterNumberInputService2;
  }(BeanStub)
);
var NumberFloatingFilter = (
  /** @class */
  function(_super) {
    __extends$2w(NumberFloatingFilter2, _super);
    function NumberFloatingFilter2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    NumberFloatingFilter2.prototype.init = function(params) {
      _super.prototype.init.call(this, params);
      this.filterModelFormatter = new NumberFilterModelFormatter(this.localeService, this.optionsFactory);
    };
    NumberFloatingFilter2.prototype.getDefaultFilterOptions = function() {
      return NumberFilter.DEFAULT_FILTER_OPTIONS;
    };
    NumberFloatingFilter2.prototype.getFilterModelFormatter = function() {
      return this.filterModelFormatter;
    };
    NumberFloatingFilter2.prototype.createFloatingFilterInputService = function(ariaLabel) {
      var allowedCharPattern = getAllowedCharPattern(this.params.filterParams);
      if (allowedCharPattern) {
        return this.createManagedBean(new FloatingFilterTextInputService({
          config: { allowedCharPattern },
          ariaLabel
        }));
      }
      return this.createManagedBean(new FloatingFilterNumberInputService({ ariaLabel }));
    };
    return NumberFloatingFilter2;
  }(TextInputFloatingFilter)
);
var __extends$2v = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var TextFloatingFilter = (
  /** @class */
  function(_super) {
    __extends$2v(TextFloatingFilter2, _super);
    function TextFloatingFilter2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    TextFloatingFilter2.prototype.init = function(params) {
      _super.prototype.init.call(this, params);
      this.filterModelFormatter = new TextFilterModelFormatter(this.localeService, this.optionsFactory);
    };
    TextFloatingFilter2.prototype.getDefaultFilterOptions = function() {
      return TextFilter.DEFAULT_FILTER_OPTIONS;
    };
    TextFloatingFilter2.prototype.getFilterModelFormatter = function() {
      return this.filterModelFormatter;
    };
    TextFloatingFilter2.prototype.createFloatingFilterInputService = function(ariaLabel) {
      return this.createManagedBean(new FloatingFilterTextInputService({
        ariaLabel
      }));
    };
    return TextFloatingFilter2;
  }(TextInputFloatingFilter)
);
var TouchListener = (
  /** @class */
  function() {
    function TouchListener2(eElement, preventMouseClick) {
      var _this = this;
      if (preventMouseClick === void 0) {
        preventMouseClick = false;
      }
      this.destroyFuncs = [];
      this.touching = false;
      this.eventService = new EventService();
      this.eElement = eElement;
      this.preventMouseClick = preventMouseClick;
      var startListener = this.onTouchStart.bind(this);
      var moveListener = this.onTouchMove.bind(this);
      var endListener = this.onTouchEnd.bind(this);
      this.eElement.addEventListener("touchstart", startListener, { passive: true });
      this.eElement.addEventListener("touchmove", moveListener, { passive: true });
      this.eElement.addEventListener("touchend", endListener, { passive: false });
      this.destroyFuncs.push(function() {
        _this.eElement.removeEventListener("touchstart", startListener, { passive: true });
        _this.eElement.removeEventListener("touchmove", moveListener, { passive: true });
        _this.eElement.removeEventListener("touchend", endListener, { passive: false });
      });
    }
    TouchListener2.prototype.getActiveTouch = function(touchList) {
      for (var i = 0; i < touchList.length; i++) {
        var matches = touchList[i].identifier === this.touchStart.identifier;
        if (matches) {
          return touchList[i];
        }
      }
      return null;
    };
    TouchListener2.prototype.addEventListener = function(eventType, listener) {
      this.eventService.addEventListener(eventType, listener);
    };
    TouchListener2.prototype.removeEventListener = function(eventType, listener) {
      this.eventService.removeEventListener(eventType, listener);
    };
    TouchListener2.prototype.onTouchStart = function(touchEvent) {
      var _this = this;
      if (this.touching) {
        return;
      }
      this.touchStart = touchEvent.touches[0];
      this.touching = true;
      this.moved = false;
      var touchStartCopy = this.touchStart;
      window.setTimeout(function() {
        var touchesMatch = _this.touchStart === touchStartCopy;
        if (_this.touching && touchesMatch && !_this.moved) {
          _this.moved = true;
          var event_1 = {
            type: TouchListener2.EVENT_LONG_TAP,
            touchStart: _this.touchStart,
            touchEvent
          };
          _this.eventService.dispatchEvent(event_1);
        }
      }, 500);
    };
    TouchListener2.prototype.onTouchMove = function(touchEvent) {
      if (!this.touching) {
        return;
      }
      var touch = this.getActiveTouch(touchEvent.touches);
      if (!touch) {
        return;
      }
      var eventIsFarAway = !areEventsNear(touch, this.touchStart, 4);
      if (eventIsFarAway) {
        this.moved = true;
      }
    };
    TouchListener2.prototype.onTouchEnd = function(touchEvent) {
      if (!this.touching) {
        return;
      }
      if (!this.moved) {
        var event_2 = {
          type: TouchListener2.EVENT_TAP,
          touchStart: this.touchStart
        };
        this.eventService.dispatchEvent(event_2);
        this.checkForDoubleTap();
      }
      if (this.preventMouseClick && touchEvent.cancelable) {
        touchEvent.preventDefault();
      }
      this.touching = false;
    };
    TouchListener2.prototype.checkForDoubleTap = function() {
      var now2 = (/* @__PURE__ */ new Date()).getTime();
      if (this.lastTapTime && this.lastTapTime > 0) {
        var interval = now2 - this.lastTapTime;
        if (interval > TouchListener2.DOUBLE_TAP_MILLIS) {
          var event_3 = {
            type: TouchListener2.EVENT_DOUBLE_TAP,
            touchStart: this.touchStart
          };
          this.eventService.dispatchEvent(event_3);
          this.lastTapTime = null;
        } else {
          this.lastTapTime = now2;
        }
      } else {
        this.lastTapTime = now2;
      }
    };
    TouchListener2.prototype.destroy = function() {
      this.destroyFuncs.forEach(function(func) {
        return func();
      });
    };
    TouchListener2.EVENT_TAP = "tap";
    TouchListener2.EVENT_DOUBLE_TAP = "doubleTap";
    TouchListener2.EVENT_LONG_TAP = "longTap";
    TouchListener2.DOUBLE_TAP_MILLIS = 500;
    return TouchListener2;
  }()
);
var __extends$2u = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2d = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SortIndicatorComp = (
  /** @class */
  function(_super) {
    __extends$2u(SortIndicatorComp2, _super);
    function SortIndicatorComp2(skipTemplate) {
      var _this = _super.call(this) || this;
      if (!skipTemplate) {
        _this.setTemplate(SortIndicatorComp2.TEMPLATE);
      }
      return _this;
    }
    SortIndicatorComp2.prototype.attachCustomElements = function(eSortOrder, eSortAsc, eSortDesc, eSortMixed, eSortNone) {
      this.eSortOrder = eSortOrder;
      this.eSortAsc = eSortAsc;
      this.eSortDesc = eSortDesc;
      this.eSortMixed = eSortMixed;
      this.eSortNone = eSortNone;
    };
    SortIndicatorComp2.prototype.setupSort = function(column, suppressOrder) {
      var _this = this;
      if (suppressOrder === void 0) {
        suppressOrder = false;
      }
      this.column = column;
      this.suppressOrder = suppressOrder;
      this.setupMultiSortIndicator();
      var canSort = !!this.column.getColDef().sortable;
      if (!canSort) {
        return;
      }
      this.addInIcon("sortAscending", this.eSortAsc, column);
      this.addInIcon("sortDescending", this.eSortDesc, column);
      this.addInIcon("sortUnSort", this.eSortNone, column);
      this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, function() {
        return _this.onSortChanged();
      });
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, function() {
        return _this.onSortChanged();
      });
      this.onSortChanged();
    };
    SortIndicatorComp2.prototype.addInIcon = function(iconName, eParent, column) {
      if (eParent == null) {
        return;
      }
      var eIcon = createIconNoSpan(iconName, this.gridOptionsService, column);
      if (eIcon) {
        eParent.appendChild(eIcon);
      }
    };
    SortIndicatorComp2.prototype.onSortChanged = function() {
      this.updateIcons();
      if (!this.suppressOrder) {
        this.updateSortOrder();
      }
    };
    SortIndicatorComp2.prototype.updateIcons = function() {
      var sortDirection = this.sortController.getDisplaySortForColumn(this.column);
      if (this.eSortAsc) {
        var isAscending = sortDirection === "asc";
        setDisplayed(this.eSortAsc, isAscending, { skipAriaHidden: true });
      }
      if (this.eSortDesc) {
        var isDescending = sortDirection === "desc";
        setDisplayed(this.eSortDesc, isDescending, { skipAriaHidden: true });
      }
      if (this.eSortNone) {
        var alwaysHideNoSort = !this.column.getColDef().unSortIcon && !this.gridOptionsService.is("unSortIcon");
        var isNone = sortDirection === null || sortDirection === void 0;
        setDisplayed(this.eSortNone, !alwaysHideNoSort && isNone, { skipAriaHidden: true });
      }
    };
    SortIndicatorComp2.prototype.setupMultiSortIndicator = function() {
      var _this = this;
      this.addInIcon("sortUnSort", this.eSortMixed, this.column);
      var isColumnShowingRowGroup = this.column.getColDef().showRowGroup;
      var areGroupsCoupled = this.gridOptionsService.isColumnsSortingCoupledToGroup();
      if (areGroupsCoupled && isColumnShowingRowGroup) {
        this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, function() {
          return _this.updateMultiSortIndicator();
        });
        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, function() {
          return _this.updateMultiSortIndicator();
        });
        this.updateMultiSortIndicator();
      }
    };
    SortIndicatorComp2.prototype.updateMultiSortIndicator = function() {
      if (this.eSortMixed) {
        var isMixedSort = this.sortController.getDisplaySortForColumn(this.column) === "mixed";
        setDisplayed(this.eSortMixed, isMixedSort, { skipAriaHidden: true });
      }
    };
    SortIndicatorComp2.prototype.updateSortOrder = function() {
      var _this = this;
      var _a2;
      if (!this.eSortOrder) {
        return;
      }
      var allColumnsWithSorting = this.sortController.getColumnsWithSortingOrdered();
      var indexThisCol = (_a2 = this.sortController.getDisplaySortIndexForColumn(this.column)) !== null && _a2 !== void 0 ? _a2 : -1;
      var moreThanOneColSorting = allColumnsWithSorting.some(function(col) {
        var _a3;
        return (_a3 = _this.sortController.getDisplaySortIndexForColumn(col)) !== null && _a3 !== void 0 ? _a3 : -1 >= 1;
      });
      var showIndex = indexThisCol >= 0 && moreThanOneColSorting;
      setDisplayed(this.eSortOrder, showIndex, { skipAriaHidden: true });
      if (indexThisCol >= 0) {
        this.eSortOrder.innerHTML = (indexThisCol + 1).toString();
      } else {
        clearElement(this.eSortOrder);
      }
    };
    SortIndicatorComp2.TEMPLATE = '<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>';
    __decorate$2d([
      RefSelector("eSortOrder")
    ], SortIndicatorComp2.prototype, "eSortOrder", void 0);
    __decorate$2d([
      RefSelector("eSortAsc")
    ], SortIndicatorComp2.prototype, "eSortAsc", void 0);
    __decorate$2d([
      RefSelector("eSortDesc")
    ], SortIndicatorComp2.prototype, "eSortDesc", void 0);
    __decorate$2d([
      RefSelector("eSortMixed")
    ], SortIndicatorComp2.prototype, "eSortMixed", void 0);
    __decorate$2d([
      RefSelector("eSortNone")
    ], SortIndicatorComp2.prototype, "eSortNone", void 0);
    __decorate$2d([
      Autowired("columnModel")
    ], SortIndicatorComp2.prototype, "columnModel", void 0);
    __decorate$2d([
      Autowired("sortController")
    ], SortIndicatorComp2.prototype, "sortController", void 0);
    return SortIndicatorComp2;
  }(Component)
);
var __extends$2t = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2c = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderComp = (
  /** @class */
  function(_super) {
    __extends$2t(HeaderComp2, _super);
    function HeaderComp2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.lastMovingChanged = 0;
      return _this;
    }
    HeaderComp2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    HeaderComp2.prototype.refresh = function(params) {
      this.params = params;
      if (this.workOutTemplate() != this.currentTemplate) {
        return false;
      }
      if (this.workOutShowMenu() != this.currentShowMenu) {
        return false;
      }
      if (this.workOutSort() != this.currentSort) {
        return false;
      }
      this.setDisplayName(params);
      return true;
    };
    HeaderComp2.prototype.workOutTemplate = function() {
      var template = firstExistingValue(this.params.template, HeaderComp2.TEMPLATE);
      template = template && template.trim ? template.trim() : template;
      return template;
    };
    HeaderComp2.prototype.init = function(params) {
      this.params = params;
      this.currentTemplate = this.workOutTemplate();
      this.setTemplate(this.currentTemplate);
      this.setupTap();
      this.setupIcons(params.column);
      this.setMenu();
      this.setupSort();
      this.setupFilterIcon();
      this.setDisplayName(params);
    };
    HeaderComp2.prototype.setDisplayName = function(params) {
      if (this.currentDisplayName != params.displayName) {
        this.currentDisplayName = params.displayName;
        var displayNameSanitised = escapeString(this.currentDisplayName);
        if (this.eText) {
          this.eText.innerHTML = displayNameSanitised;
        }
      }
    };
    HeaderComp2.prototype.setupIcons = function(column) {
      this.addInIcon("menu", this.eMenu, column);
      this.addInIcon("filter", this.eFilter, column);
    };
    HeaderComp2.prototype.addInIcon = function(iconName, eParent, column) {
      if (eParent == null) {
        return;
      }
      var eIcon = createIconNoSpan(iconName, this.gridOptionsService, column);
      if (eIcon) {
        eParent.appendChild(eIcon);
      }
    };
    HeaderComp2.prototype.setupTap = function() {
      var _this = this;
      var gridOptionsService = this.gridOptionsService;
      if (gridOptionsService.is("suppressTouch")) {
        return;
      }
      var touchListener = new TouchListener(this.getGui(), true);
      var suppressMenuHide = gridOptionsService.is("suppressMenuHide");
      var tapMenuButton = suppressMenuHide && exists(this.eMenu);
      var menuTouchListener = tapMenuButton ? new TouchListener(this.eMenu, true) : touchListener;
      if (this.params.enableMenu) {
        var eventType = tapMenuButton ? "EVENT_TAP" : "EVENT_LONG_TAP";
        var showMenuFn = function(event) {
          gridOptionsService.api.showColumnMenuAfterMouseClick(_this.params.column, event.touchStart);
        };
        this.addManagedListener(menuTouchListener, TouchListener[eventType], showMenuFn);
      }
      if (this.params.enableSorting) {
        var tapListener = function(event) {
          var target = event.touchStart.target;
          if (suppressMenuHide && _this.eMenu.contains(target)) {
            return;
          }
          _this.sortController.progressSort(_this.params.column, false, "uiColumnSorted");
        };
        this.addManagedListener(touchListener, TouchListener.EVENT_TAP, tapListener);
      }
      this.addDestroyFunc(function() {
        return touchListener.destroy();
      });
      if (tapMenuButton) {
        this.addDestroyFunc(function() {
          return menuTouchListener.destroy();
        });
      }
    };
    HeaderComp2.prototype.workOutShowMenu = function() {
      var menuHides = !this.gridOptionsService.is("suppressMenuHide");
      var onIpadAndMenuHides = isIOSUserAgent() && menuHides;
      var showMenu = this.params.enableMenu && !onIpadAndMenuHides;
      return showMenu;
    };
    HeaderComp2.prototype.setMenu = function() {
      var _this = this;
      if (!this.eMenu) {
        return;
      }
      this.currentShowMenu = this.workOutShowMenu();
      if (!this.currentShowMenu) {
        removeFromParent(this.eMenu);
        return;
      }
      var suppressMenuHide = this.gridOptionsService.is("suppressMenuHide");
      this.addManagedListener(this.eMenu, "click", function() {
        return _this.showMenu(_this.eMenu);
      });
      this.eMenu.classList.toggle("ag-header-menu-always-show", suppressMenuHide);
    };
    HeaderComp2.prototype.showMenu = function(eventSource) {
      if (!eventSource) {
        eventSource = this.eMenu;
      }
      this.menuFactory.showMenuAfterButtonClick(this.params.column, eventSource, "columnMenu");
    };
    HeaderComp2.prototype.workOutSort = function() {
      return this.params.enableSorting;
    };
    HeaderComp2.prototype.setupSort = function() {
      var _this = this;
      this.currentSort = this.params.enableSorting;
      if (!this.eSortIndicator) {
        this.eSortIndicator = this.context.createBean(new SortIndicatorComp(true));
        this.eSortIndicator.attachCustomElements(this.eSortOrder, this.eSortAsc, this.eSortDesc, this.eSortMixed, this.eSortNone);
      }
      this.eSortIndicator.setupSort(this.params.column);
      if (!this.currentSort) {
        return;
      }
      var sortUsingCtrl = this.gridOptionsService.get("multiSortKey") === "ctrl";
      this.addManagedListener(this.params.column, Column.EVENT_MOVING_CHANGED, function() {
        _this.lastMovingChanged = (/* @__PURE__ */ new Date()).getTime();
      });
      if (this.eLabel) {
        this.addManagedListener(this.eLabel, "click", function(event) {
          var moving = _this.params.column.isMoving();
          var nowTime = (/* @__PURE__ */ new Date()).getTime();
          var movedRecently = nowTime - _this.lastMovingChanged < 50;
          var columnMoving = moving || movedRecently;
          if (!columnMoving) {
            var multiSort = sortUsingCtrl ? event.ctrlKey || event.metaKey : event.shiftKey;
            _this.params.progressSort(multiSort);
          }
        });
      }
      var onSortingChanged = function() {
        _this.addOrRemoveCssClass("ag-header-cell-sorted-asc", _this.params.column.isSortAscending());
        _this.addOrRemoveCssClass("ag-header-cell-sorted-desc", _this.params.column.isSortDescending());
        _this.addOrRemoveCssClass("ag-header-cell-sorted-none", _this.params.column.isSortNone());
        if (_this.params.column.getColDef().showRowGroup) {
          var sourceColumns = _this.columnModel.getSourceColumnsForGroupColumn(_this.params.column);
          var sortDirectionsMatch = sourceColumns === null || sourceColumns === void 0 ? void 0 : sourceColumns.every(function(sourceCol) {
            return _this.params.column.getSort() == sourceCol.getSort();
          });
          var isMultiSorting = !sortDirectionsMatch;
          _this.addOrRemoveCssClass("ag-header-cell-sorted-mixed", isMultiSorting);
        }
      };
      this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, onSortingChanged);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, onSortingChanged);
    };
    HeaderComp2.prototype.setupFilterIcon = function() {
      if (!this.eFilter) {
        return;
      }
      this.addManagedListener(this.params.column, Column.EVENT_FILTER_CHANGED, this.onFilterChanged.bind(this));
      this.onFilterChanged();
    };
    HeaderComp2.prototype.onFilterChanged = function() {
      var filterPresent = this.params.column.isFilterActive();
      setDisplayed(this.eFilter, filterPresent, { skipAriaHidden: true });
    };
    HeaderComp2.TEMPLATE = '<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>';
    __decorate$2c([
      Autowired("sortController")
    ], HeaderComp2.prototype, "sortController", void 0);
    __decorate$2c([
      Autowired("menuFactory")
    ], HeaderComp2.prototype, "menuFactory", void 0);
    __decorate$2c([
      Autowired("columnModel")
    ], HeaderComp2.prototype, "columnModel", void 0);
    __decorate$2c([
      RefSelector("eFilter")
    ], HeaderComp2.prototype, "eFilter", void 0);
    __decorate$2c([
      RefSelector("eSortIndicator")
    ], HeaderComp2.prototype, "eSortIndicator", void 0);
    __decorate$2c([
      RefSelector("eMenu")
    ], HeaderComp2.prototype, "eMenu", void 0);
    __decorate$2c([
      RefSelector("eLabel")
    ], HeaderComp2.prototype, "eLabel", void 0);
    __decorate$2c([
      RefSelector("eText")
    ], HeaderComp2.prototype, "eText", void 0);
    __decorate$2c([
      RefSelector("eSortOrder")
    ], HeaderComp2.prototype, "eSortOrder", void 0);
    __decorate$2c([
      RefSelector("eSortAsc")
    ], HeaderComp2.prototype, "eSortAsc", void 0);
    __decorate$2c([
      RefSelector("eSortDesc")
    ], HeaderComp2.prototype, "eSortDesc", void 0);
    __decorate$2c([
      RefSelector("eSortMixed")
    ], HeaderComp2.prototype, "eSortMixed", void 0);
    __decorate$2c([
      RefSelector("eSortNone")
    ], HeaderComp2.prototype, "eSortNone", void 0);
    return HeaderComp2;
  }(Component)
);
var __extends$2s = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2b = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderGroupComp = (
  /** @class */
  function(_super) {
    __extends$2s(HeaderGroupComp2, _super);
    function HeaderGroupComp2() {
      return _super.call(this, HeaderGroupComp2.TEMPLATE) || this;
    }
    HeaderGroupComp2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    HeaderGroupComp2.prototype.init = function(params) {
      this.params = params;
      this.checkWarnings();
      this.setupLabel();
      this.addGroupExpandIcon();
      this.setupExpandIcons();
    };
    HeaderGroupComp2.prototype.checkWarnings = function() {
      var paramsAny = this.params;
      if (paramsAny.template) {
        var message_1 = "AG Grid: A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)";
        doOnce(function() {
          return console.warn(message_1);
        }, "HeaderGroupComp.templateNotSupported");
      }
    };
    HeaderGroupComp2.prototype.setupExpandIcons = function() {
      var _this = this;
      this.addInIcon("columnGroupOpened", "agOpened");
      this.addInIcon("columnGroupClosed", "agClosed");
      var expandAction = function(event) {
        if (isStopPropagationForAgGrid(event)) {
          return;
        }
        var newExpandedValue = !_this.params.columnGroup.isExpanded();
        _this.columnModel.setColumnGroupOpened(_this.params.columnGroup.getProvidedColumnGroup(), newExpandedValue, "uiColumnExpanded");
      };
      this.addTouchAndClickListeners(this.eCloseIcon, expandAction);
      this.addTouchAndClickListeners(this.eOpenIcon, expandAction);
      var stopPropagationAction = function(event) {
        stopPropagationForAgGrid(event);
      };
      this.addManagedListener(this.eCloseIcon, "dblclick", stopPropagationAction);
      this.addManagedListener(this.eOpenIcon, "dblclick", stopPropagationAction);
      this.addManagedListener(this.getGui(), "dblclick", expandAction);
      this.updateIconVisibility();
      var providedColumnGroup = this.params.columnGroup.getProvidedColumnGroup();
      this.addManagedListener(providedColumnGroup, ProvidedColumnGroup.EVENT_EXPANDED_CHANGED, this.updateIconVisibility.bind(this));
      this.addManagedListener(providedColumnGroup, ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED, this.updateIconVisibility.bind(this));
    };
    HeaderGroupComp2.prototype.addTouchAndClickListeners = function(eElement, action) {
      var touchListener = new TouchListener(eElement, true);
      this.addManagedListener(touchListener, TouchListener.EVENT_TAP, action);
      this.addDestroyFunc(function() {
        return touchListener.destroy();
      });
      this.addManagedListener(eElement, "click", action);
    };
    HeaderGroupComp2.prototype.updateIconVisibility = function() {
      var columnGroup = this.params.columnGroup;
      if (columnGroup.isExpandable()) {
        var expanded = this.params.columnGroup.isExpanded();
        setDisplayed(this.eOpenIcon, expanded);
        setDisplayed(this.eCloseIcon, !expanded);
      } else {
        setDisplayed(this.eOpenIcon, false);
        setDisplayed(this.eCloseIcon, false);
      }
    };
    HeaderGroupComp2.prototype.addInIcon = function(iconName, refName) {
      var eIcon = createIconNoSpan(iconName, this.gridOptionsService, null);
      if (eIcon) {
        this.getRefElement(refName).appendChild(eIcon);
      }
    };
    HeaderGroupComp2.prototype.addGroupExpandIcon = function() {
      if (!this.params.columnGroup.isExpandable()) {
        setDisplayed(this.eOpenIcon, false);
        setDisplayed(this.eCloseIcon, false);
        return;
      }
    };
    HeaderGroupComp2.prototype.setupLabel = function() {
      var _a2;
      var _b2 = this.params, displayName = _b2.displayName, columnGroup = _b2.columnGroup;
      if (exists(displayName)) {
        var displayNameSanitised = escapeString(displayName);
        this.getRefElement("agLabel").innerHTML = displayNameSanitised;
      }
      this.addOrRemoveCssClass("ag-sticky-label", !((_a2 = columnGroup.getColGroupDef()) === null || _a2 === void 0 ? void 0 : _a2.suppressStickyLabel));
    };
    HeaderGroupComp2.TEMPLATE = '<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>';
    __decorate$2b([
      Autowired("columnModel")
    ], HeaderGroupComp2.prototype, "columnModel", void 0);
    __decorate$2b([
      RefSelector("agOpened")
    ], HeaderGroupComp2.prototype, "eOpenIcon", void 0);
    __decorate$2b([
      RefSelector("agClosed")
    ], HeaderGroupComp2.prototype, "eCloseIcon", void 0);
    return HeaderGroupComp2;
  }(Component)
);
var __extends$2r = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var PopupComponent = (
  /** @class */
  function(_super) {
    __extends$2r(PopupComponent2, _super);
    function PopupComponent2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    PopupComponent2.prototype.isPopup = function() {
      return true;
    };
    PopupComponent2.prototype.setParentComponent = function(container) {
      container.addCssClass("ag-has-popup");
      _super.prototype.setParentComponent.call(this, container);
    };
    PopupComponent2.prototype.destroy = function() {
      var parentComp = this.parentComponent;
      var hasParent = parentComp && parentComp.isAlive();
      if (hasParent) {
        parentComp.getGui().classList.remove("ag-has-popup");
      }
      _super.prototype.destroy.call(this);
    };
    return PopupComponent2;
  }(Component)
);
var __extends$2q = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2a = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var LargeTextCellEditor = (
  /** @class */
  function(_super) {
    __extends$2q(LargeTextCellEditor2, _super);
    function LargeTextCellEditor2() {
      return _super.call(this, LargeTextCellEditor2.TEMPLATE) || this;
    }
    LargeTextCellEditor2.prototype.init = function(params) {
      this.params = params;
      this.focusAfterAttached = params.cellStartedEdit;
      this.eTextArea.setMaxLength(params.maxLength || 200).setCols(params.cols || 60).setRows(params.rows || 10);
      if (exists(params.value, true)) {
        this.eTextArea.setValue(params.value.toString(), true);
      }
      this.addGuiEventListener("keydown", this.onKeyDown.bind(this));
      this.activateTabIndex();
    };
    LargeTextCellEditor2.prototype.onKeyDown = function(event) {
      var key = event.key;
      if (key === KeyCode.LEFT || key === KeyCode.UP || key === KeyCode.RIGHT || key === KeyCode.DOWN || event.shiftKey && key === KeyCode.ENTER) {
        event.stopPropagation();
      }
    };
    LargeTextCellEditor2.prototype.afterGuiAttached = function() {
      var translate = this.localeService.getLocaleTextFunc();
      this.eTextArea.setInputAriaLabel(translate("ariaInputEditor", "Input Editor"));
      if (this.focusAfterAttached) {
        this.eTextArea.getFocusableElement().focus();
      }
    };
    LargeTextCellEditor2.prototype.getValue = function() {
      var value = this.eTextArea.getValue();
      if (!exists(value) && !exists(this.params.value)) {
        return this.params.value;
      }
      return this.params.parseValue(value);
    };
    LargeTextCellEditor2.TEMPLATE = '<div class="ag-large-text">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>';
    __decorate$2a([
      RefSelector("eTextArea")
    ], LargeTextCellEditor2.prototype, "eTextArea", void 0);
    return LargeTextCellEditor2;
  }(PopupComponent)
);
var __extends$2p = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$29 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SelectCellEditor = (
  /** @class */
  function(_super) {
    __extends$2p(SelectCellEditor2, _super);
    function SelectCellEditor2() {
      var _this = _super.call(this, '<div class="ag-cell-edit-wrapper"><ag-select class="ag-cell-editor" ref="eSelect"></ag-select></div>') || this;
      _this.startedByEnter = false;
      return _this;
    }
    SelectCellEditor2.prototype.init = function(params) {
      var _this = this;
      this.focusAfterAttached = params.cellStartedEdit;
      if (missing(params.values)) {
        console.warn("AG Grid: no values found for select cellEditor");
        return;
      }
      this.startedByEnter = params.eventKey != null ? params.eventKey === KeyCode.ENTER : false;
      var hasValue = false;
      params.values.forEach(function(value) {
        var option = { value };
        var valueFormatted = _this.valueFormatterService.formatValue(params.column, null, value);
        var valueFormattedExits = valueFormatted !== null && valueFormatted !== void 0;
        option.text = valueFormattedExits ? valueFormatted : value;
        _this.eSelect.addOption(option);
        hasValue = hasValue || params.value === value;
      });
      if (hasValue) {
        this.eSelect.setValue(params.value, true);
      } else if (params.values.length) {
        this.eSelect.setValue(params.values[0], true);
      }
      if (this.gridOptionsService.get("editType") !== "fullRow") {
        this.addManagedListener(this.eSelect, AgSelect.EVENT_ITEM_SELECTED, function() {
          return params.stopEditing();
        });
      }
    };
    SelectCellEditor2.prototype.afterGuiAttached = function() {
      if (this.focusAfterAttached) {
        this.eSelect.getFocusableElement().focus();
      }
      if (this.startedByEnter) {
        this.eSelect.showPicker();
      }
    };
    SelectCellEditor2.prototype.focusIn = function() {
      this.eSelect.getFocusableElement().focus();
    };
    SelectCellEditor2.prototype.getValue = function() {
      return this.eSelect.getValue();
    };
    SelectCellEditor2.prototype.isPopup = function() {
      return false;
    };
    __decorate$29([
      Autowired("valueFormatterService")
    ], SelectCellEditor2.prototype, "valueFormatterService", void 0);
    __decorate$29([
      RefSelector("eSelect")
    ], SelectCellEditor2.prototype, "eSelect", void 0);
    return SelectCellEditor2;
  }(PopupComponent)
);
var __extends$2o = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$28 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SimpleCellEditor = (
  /** @class */
  function(_super) {
    __extends$2o(SimpleCellEditor2, _super);
    function SimpleCellEditor2(cellEditorInput) {
      var _this = _super.call(
        this,
        /* html */
        '\n            <div class="ag-cell-edit-wrapper">\n                ' + cellEditorInput.getTemplate() + "\n            </div>"
      ) || this;
      _this.cellEditorInput = cellEditorInput;
      return _this;
    }
    SimpleCellEditor2.prototype.init = function(params) {
      this.params = params;
      var eInput = this.eInput;
      this.cellEditorInput.init(eInput, params);
      var startValue;
      if (params.cellStartedEdit) {
        this.focusAfterAttached = true;
        var eventKey = params.eventKey;
        if (eventKey === KeyCode.BACKSPACE || params.eventKey === KeyCode.DELETE) {
          startValue = "";
        } else if (eventKey && eventKey.length === 1) {
          startValue = eventKey;
        } else {
          startValue = this.cellEditorInput.getStartValue();
          if (eventKey !== KeyCode.F2) {
            this.highlightAllOnFocus = true;
          }
        }
      } else {
        this.focusAfterAttached = false;
        startValue = this.cellEditorInput.getStartValue();
      }
      if (startValue != null) {
        eInput.setStartValue(startValue);
      }
      this.addManagedListener(eInput.getGui(), "keydown", function(event) {
        var key = event.key;
        if (key === KeyCode.PAGE_UP || key === KeyCode.PAGE_DOWN) {
          event.preventDefault();
        }
      });
    };
    SimpleCellEditor2.prototype.afterGuiAttached = function() {
      var _a2, _b2;
      var translate = this.localeService.getLocaleTextFunc();
      var eInput = this.eInput;
      eInput.setInputAriaLabel(translate("ariaInputEditor", "Input Editor"));
      if (!this.focusAfterAttached) {
        return;
      }
      if (!isBrowserSafari()) {
        eInput.getFocusableElement().focus();
      }
      var inputEl = eInput.getInputElement();
      if (this.highlightAllOnFocus) {
        inputEl.select();
      } else {
        (_b2 = (_a2 = this.cellEditorInput).setCaret) === null || _b2 === void 0 ? void 0 : _b2.call(_a2);
      }
    };
    SimpleCellEditor2.prototype.focusIn = function() {
      var eInput = this.eInput;
      var focusEl = eInput.getFocusableElement();
      var inputEl = eInput.getInputElement();
      focusEl.focus();
      inputEl.select();
    };
    SimpleCellEditor2.prototype.getValue = function() {
      return this.cellEditorInput.getValue();
    };
    SimpleCellEditor2.prototype.isPopup = function() {
      return false;
    };
    __decorate$28([
      RefSelector("eInput")
    ], SimpleCellEditor2.prototype, "eInput", void 0);
    return SimpleCellEditor2;
  }(PopupComponent)
);
var __extends$2n = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var TextCellEditorInput = (
  /** @class */
  function() {
    function TextCellEditorInput2() {
    }
    TextCellEditorInput2.prototype.getTemplate = function() {
      return (
        /* html */
        '<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'
      );
    };
    TextCellEditorInput2.prototype.init = function(eInput, params) {
      this.eInput = eInput;
      this.params = params;
      if (params.maxLength != null) {
        eInput.setMaxLength(params.maxLength);
      }
    };
    TextCellEditorInput2.prototype.getValue = function() {
      var value = this.eInput.getValue();
      if (!exists(value) && !exists(this.params.value)) {
        return this.params.value;
      }
      return this.params.parseValue(value);
    };
    TextCellEditorInput2.prototype.getStartValue = function() {
      var formatValue = this.params.useFormatter || this.params.column.getColDef().refData;
      return formatValue ? this.params.formatValue(this.params.value) : this.params.value;
    };
    TextCellEditorInput2.prototype.setCaret = function() {
      var value = this.eInput.getValue();
      var len = exists(value) && value.length || 0;
      if (len) {
        this.eInput.getInputElement().setSelectionRange(len, len);
      }
    };
    return TextCellEditorInput2;
  }()
);
var TextCellEditor = (
  /** @class */
  function(_super) {
    __extends$2n(TextCellEditor2, _super);
    function TextCellEditor2() {
      return _super.call(this, new TextCellEditorInput()) || this;
    }
    return TextCellEditor2;
  }(SimpleCellEditor)
);
var __extends$2m = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$27 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ARROW_UP = "↑";
var ARROW_DOWN = "↓";
var AnimateShowChangeCellRenderer = (
  /** @class */
  function(_super) {
    __extends$2m(AnimateShowChangeCellRenderer2, _super);
    function AnimateShowChangeCellRenderer2() {
      var _this = _super.call(this, AnimateShowChangeCellRenderer2.TEMPLATE) || this;
      _this.refreshCount = 0;
      return _this;
    }
    AnimateShowChangeCellRenderer2.prototype.init = function(params) {
      this.eValue = this.queryForHtmlElement(".ag-value-change-value");
      this.eDelta = this.queryForHtmlElement(".ag-value-change-delta");
      this.refresh(params);
    };
    AnimateShowChangeCellRenderer2.prototype.showDelta = function(params, delta) {
      var absDelta = Math.abs(delta);
      var valueFormatted = params.formatValue(absDelta);
      var valueToUse = exists(valueFormatted) ? valueFormatted : absDelta;
      var deltaUp = delta >= 0;
      if (deltaUp) {
        this.eDelta.innerHTML = ARROW_UP + valueToUse;
      } else {
        this.eDelta.innerHTML = ARROW_DOWN + valueToUse;
      }
      this.eDelta.classList.toggle("ag-value-change-delta-up", deltaUp);
      this.eDelta.classList.toggle("ag-value-change-delta-down", !deltaUp);
    };
    AnimateShowChangeCellRenderer2.prototype.setTimerToRemoveDelta = function() {
      var _this = this;
      this.refreshCount++;
      var refreshCountCopy = this.refreshCount;
      window.setTimeout(function() {
        if (refreshCountCopy === _this.refreshCount) {
          _this.hideDeltaValue();
        }
      }, 2e3);
    };
    AnimateShowChangeCellRenderer2.prototype.hideDeltaValue = function() {
      this.eValue.classList.remove("ag-value-change-value-highlight");
      clearElement(this.eDelta);
    };
    AnimateShowChangeCellRenderer2.prototype.refresh = function(params) {
      var value = params.value;
      if (value === this.lastValue) {
        return false;
      }
      if (exists(params.valueFormatted)) {
        this.eValue.innerHTML = params.valueFormatted;
      } else if (exists(params.value)) {
        this.eValue.innerHTML = value;
      } else {
        clearElement(this.eValue);
      }
      if (this.filterManager.isSuppressFlashingCellsBecauseFiltering()) {
        return false;
      }
      if (typeof value === "number" && typeof this.lastValue === "number") {
        var delta = value - this.lastValue;
        this.showDelta(params, delta);
      }
      if (this.lastValue) {
        this.eValue.classList.add("ag-value-change-value-highlight");
      }
      this.setTimerToRemoveDelta();
      this.lastValue = value;
      return true;
    };
    AnimateShowChangeCellRenderer2.TEMPLATE = '<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>';
    __decorate$27([
      Autowired("filterManager")
    ], AnimateShowChangeCellRenderer2.prototype, "filterManager", void 0);
    return AnimateShowChangeCellRenderer2;
  }(Component)
);
var __extends$2l = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$26 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AnimateSlideCellRenderer = (
  /** @class */
  function(_super) {
    __extends$2l(AnimateSlideCellRenderer2, _super);
    function AnimateSlideCellRenderer2() {
      var _this = _super.call(this, AnimateSlideCellRenderer2.TEMPLATE) || this;
      _this.refreshCount = 0;
      _this.eCurrent = _this.queryForHtmlElement(".ag-value-slide-current");
      return _this;
    }
    AnimateSlideCellRenderer2.prototype.init = function(params) {
      this.refresh(params);
    };
    AnimateSlideCellRenderer2.prototype.addSlideAnimation = function() {
      var _this = this;
      this.refreshCount++;
      var refreshCountCopy = this.refreshCount;
      if (this.ePrevious) {
        this.getGui().removeChild(this.ePrevious);
      }
      this.ePrevious = loadTemplate('<span class="ag-value-slide-previous ag-value-slide-out"></span>');
      this.ePrevious.innerHTML = this.eCurrent.innerHTML;
      this.getGui().insertBefore(this.ePrevious, this.eCurrent);
      window.setTimeout(function() {
        if (refreshCountCopy !== _this.refreshCount) {
          return;
        }
        _this.ePrevious.classList.add("ag-value-slide-out-end");
      }, 50);
      window.setTimeout(function() {
        if (refreshCountCopy !== _this.refreshCount) {
          return;
        }
        _this.getGui().removeChild(_this.ePrevious);
        _this.ePrevious = null;
      }, 3e3);
    };
    AnimateSlideCellRenderer2.prototype.refresh = function(params) {
      var value = params.value;
      if (missing(value)) {
        value = "";
      }
      if (value === this.lastValue) {
        return false;
      }
      if (this.filterManager.isSuppressFlashingCellsBecauseFiltering()) {
        return false;
      }
      this.addSlideAnimation();
      this.lastValue = value;
      if (exists(params.valueFormatted)) {
        this.eCurrent.innerHTML = params.valueFormatted;
      } else if (exists(params.value)) {
        this.eCurrent.innerHTML = value;
      } else {
        clearElement(this.eCurrent);
      }
      return true;
    };
    AnimateSlideCellRenderer2.TEMPLATE = '<span>\n            <span class="ag-value-slide-current"></span>\n        </span>';
    __decorate$26([
      Autowired("filterManager")
    ], AnimateSlideCellRenderer2.prototype, "filterManager", void 0);
    return AnimateSlideCellRenderer2;
  }(Component)
);
var __assign$f = function() {
  __assign$f = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$f.apply(this, arguments);
};
var RowNode2 = (
  /** @class */
  function() {
    function RowNode3(beans) {
      this.rowIndex = null;
      this.key = null;
      this.childrenMapped = {};
      this.displayed = false;
      this.rowTop = null;
      this.oldRowTop = null;
      this.selectable = true;
      this.__objectId = RowNode3.OBJECT_ID_SEQUENCE++;
      this.__autoHeights = {};
      this.alreadyRendered = false;
      this.highlighted = null;
      this.hovered = false;
      this.selected = false;
      this.beans = beans;
    }
    RowNode3.prototype.setData = function(data) {
      this.setDataCommon(data, false);
    };
    RowNode3.prototype.updateData = function(data) {
      this.setDataCommon(data, true);
    };
    RowNode3.prototype.setDataCommon = function(data, update) {
      var oldData = this.data;
      this.data = data;
      this.beans.valueCache.onDataChanged();
      this.updateDataOnDetailNode();
      this.checkRowSelectable();
      this.resetQuickFilterAggregateText();
      var event = this.createDataChangedEvent(data, oldData, update);
      this.dispatchLocalEvent(event);
    };
    RowNode3.prototype.updateDataOnDetailNode = function() {
      if (this.detailNode) {
        this.detailNode.data = this.data;
      }
    };
    RowNode3.prototype.createDataChangedEvent = function(newData, oldData, update) {
      return {
        type: RowNode3.EVENT_DATA_CHANGED,
        node: this,
        oldData,
        newData,
        update
      };
    };
    RowNode3.prototype.createLocalRowEvent = function(type) {
      return {
        type,
        node: this
      };
    };
    RowNode3.prototype.getRowIndexString = function() {
      if (this.rowPinned === "top") {
        return "t-" + this.rowIndex;
      }
      if (this.rowPinned === "bottom") {
        return "b-" + this.rowIndex;
      }
      return this.rowIndex.toString();
    };
    RowNode3.prototype.createDaemonNode = function() {
      var oldNode = new RowNode3(this.beans);
      oldNode.id = this.id;
      oldNode.data = this.data;
      oldNode.__daemon = true;
      oldNode.selected = this.selected;
      oldNode.level = this.level;
      return oldNode;
    };
    RowNode3.prototype.setDataAndId = function(data, id2) {
      var oldNode = exists(this.id) ? this.createDaemonNode() : null;
      var oldData = this.data;
      this.data = data;
      this.updateDataOnDetailNode();
      this.setId(id2);
      this.beans.selectionService.syncInRowNode(this, oldNode);
      this.checkRowSelectable();
      var event = this.createDataChangedEvent(data, oldData, false);
      this.dispatchLocalEvent(event);
    };
    RowNode3.prototype.checkRowSelectable = function() {
      var isRowSelectableFunc = this.beans.gridOptionsService.get("isRowSelectable");
      this.setRowSelectable(isRowSelectableFunc ? isRowSelectableFunc(this) : true);
    };
    RowNode3.prototype.setRowSelectable = function(newVal) {
      if (this.selectable !== newVal) {
        this.selectable = newVal;
        if (this.eventService) {
          this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_SELECTABLE_CHANGED));
        }
        var isGroupSelectsChildren = this.beans.gridOptionsService.is("groupSelectsChildren");
        if (isGroupSelectsChildren) {
          var selected = this.calculateSelectedFromChildren();
          this.setSelectedParams({
            newValue: selected !== null && selected !== void 0 ? selected : false,
            source: "selectableChanged"
          });
        }
      }
    };
    RowNode3.prototype.setId = function(id2) {
      var getRowIdFunc = this.beans.gridOptionsService.getCallback("getRowId");
      if (getRowIdFunc) {
        if (this.data) {
          var parentKeys = this.getGroupKeys(true);
          this.id = getRowIdFunc({
            data: this.data,
            parentKeys: parentKeys.length > 0 ? parentKeys : void 0,
            level: this.level
          });
          if (this.id !== null && typeof this.id === "string" && this.id.startsWith(RowNode3.ID_PREFIX_ROW_GROUP)) {
            console.error("AG Grid: Row IDs cannot start with " + RowNode3.ID_PREFIX_ROW_GROUP + ", this is a reserved prefix for AG Grid's row grouping feature.");
          }
          if (this.id !== null && typeof this.id !== "string") {
            this.id = "" + this.id;
          }
        } else {
          this.id = void 0;
        }
      } else {
        this.id = id2;
      }
    };
    RowNode3.prototype.getGroupKeys = function(excludeSelf) {
      if (excludeSelf === void 0) {
        excludeSelf = false;
      }
      var keys2 = [];
      var pointer = this;
      if (excludeSelf) {
        pointer = pointer.parent;
      }
      while (pointer && pointer.level >= 0) {
        keys2.push(pointer.key);
        pointer = pointer.parent;
      }
      keys2.reverse();
      return keys2;
    };
    RowNode3.prototype.isPixelInRange = function(pixel) {
      if (!exists(this.rowTop) || !exists(this.rowHeight)) {
        return false;
      }
      return pixel >= this.rowTop && pixel < this.rowTop + this.rowHeight;
    };
    RowNode3.prototype.setFirstChild = function(firstChild) {
      if (this.firstChild === firstChild) {
        return;
      }
      this.firstChild = firstChild;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_FIRST_CHILD_CHANGED));
      }
    };
    RowNode3.prototype.setLastChild = function(lastChild) {
      if (this.lastChild === lastChild) {
        return;
      }
      this.lastChild = lastChild;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_LAST_CHILD_CHANGED));
      }
    };
    RowNode3.prototype.setChildIndex = function(childIndex) {
      if (this.childIndex === childIndex) {
        return;
      }
      this.childIndex = childIndex;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_CHILD_INDEX_CHANGED));
      }
    };
    RowNode3.prototype.setRowTop = function(rowTop) {
      this.oldRowTop = this.rowTop;
      if (this.rowTop === rowTop) {
        return;
      }
      this.rowTop = rowTop;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_TOP_CHANGED));
      }
      this.setDisplayed(rowTop !== null);
    };
    RowNode3.prototype.clearRowTopAndRowIndex = function() {
      this.oldRowTop = null;
      this.setRowTop(null);
      this.setRowIndex(null);
    };
    RowNode3.prototype.setDisplayed = function(displayed) {
      if (this.displayed === displayed) {
        return;
      }
      this.displayed = displayed;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_DISPLAYED_CHANGED));
      }
    };
    RowNode3.prototype.setDragging = function(dragging) {
      if (this.dragging === dragging) {
        return;
      }
      this.dragging = dragging;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_DRAGGING_CHANGED));
      }
    };
    RowNode3.prototype.setHighlighted = function(highlighted) {
      if (highlighted === this.highlighted) {
        return;
      }
      this.highlighted = highlighted;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_HIGHLIGHT_CHANGED));
      }
    };
    RowNode3.prototype.setHovered = function(hovered) {
      if (this.hovered === hovered) {
        return;
      }
      this.hovered = hovered;
    };
    RowNode3.prototype.isHovered = function() {
      return this.hovered;
    };
    RowNode3.prototype.setAllChildrenCount = function(allChildrenCount) {
      if (this.allChildrenCount === allChildrenCount) {
        return;
      }
      this.allChildrenCount = allChildrenCount;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_ALL_CHILDREN_COUNT_CHANGED));
      }
    };
    RowNode3.prototype.setMaster = function(master) {
      if (this.master === master) {
        return;
      }
      if (this.master && !master) {
        this.expanded = false;
      }
      this.master = master;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_MASTER_CHANGED));
      }
    };
    RowNode3.prototype.setGroup = function(group) {
      if (this.group === group) {
        return;
      }
      if (this.group && !group) {
        this.expanded = false;
      }
      this.group = group;
      this.updateHasChildren();
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_GROUP_CHANGED));
      }
    };
    RowNode3.prototype.setRowHeight = function(rowHeight, estimated) {
      if (estimated === void 0) {
        estimated = false;
      }
      this.rowHeight = rowHeight;
      this.rowHeightEstimated = estimated;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_HEIGHT_CHANGED));
      }
    };
    RowNode3.prototype.setRowAutoHeight = function(cellHeight, column) {
      if (!this.__autoHeights) {
        this.__autoHeights = {};
      }
      this.__autoHeights[column.getId()] = cellHeight;
      if (cellHeight != null) {
        if (this.checkAutoHeightsDebounced == null) {
          this.checkAutoHeightsDebounced = debounce$1(this.checkAutoHeights.bind(this), 1);
        }
        this.checkAutoHeightsDebounced();
      }
    };
    RowNode3.prototype.checkAutoHeights = function() {
      var _this = this;
      var notAllPresent = false;
      var nonePresent = true;
      var newRowHeight = 0;
      var autoHeights = this.__autoHeights;
      if (autoHeights == null) {
        return;
      }
      var displayedAutoHeightCols = this.beans.columnModel.getAllDisplayedAutoHeightCols();
      displayedAutoHeightCols.forEach(function(col) {
        var cellHeight = autoHeights[col.getId()];
        if (cellHeight == null) {
          if (_this.beans.columnModel.isColSpanActive()) {
            var activeColsForRow = [];
            switch (col.getPinned()) {
              case "left":
                activeColsForRow = _this.beans.columnModel.getDisplayedLeftColumnsForRow(_this);
                break;
              case "right":
                activeColsForRow = _this.beans.columnModel.getDisplayedRightColumnsForRow(_this);
                break;
              case null:
                activeColsForRow = _this.beans.columnModel.getViewportCenterColumnsForRow(_this);
                break;
            }
            if (activeColsForRow.includes(col)) {
              notAllPresent = true;
              return;
            }
            cellHeight = -1;
          } else {
            notAllPresent = true;
            return;
          }
        } else {
          nonePresent = false;
        }
        if (cellHeight > newRowHeight) {
          newRowHeight = cellHeight;
        }
      });
      if (notAllPresent) {
        return;
      }
      if (nonePresent || newRowHeight < 10) {
        newRowHeight = this.beans.gridOptionsService.getRowHeightForNode(this).height;
      }
      if (newRowHeight == this.rowHeight) {
        return;
      }
      this.setRowHeight(newRowHeight);
      var rowModel = this.beans.rowModel;
      if (rowModel.onRowHeightChangedDebounced) {
        rowModel.onRowHeightChangedDebounced();
      }
    };
    RowNode3.prototype.setRowIndex = function(rowIndex) {
      if (this.rowIndex === rowIndex) {
        return;
      }
      this.rowIndex = rowIndex;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_ROW_INDEX_CHANGED));
      }
    };
    RowNode3.prototype.setUiLevel = function(uiLevel) {
      if (this.uiLevel === uiLevel) {
        return;
      }
      this.uiLevel = uiLevel;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_UI_LEVEL_CHANGED));
      }
    };
    RowNode3.prototype.setExpanded = function(expanded, e) {
      if (this.expanded === expanded) {
        return;
      }
      this.expanded = expanded;
      if (this.eventService) {
        this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_EXPANDED_CHANGED));
      }
      var event = Object.assign({}, this.createGlobalRowEvent(Events.EVENT_ROW_GROUP_OPENED), {
        expanded,
        event: e || null
      });
      this.beans.rowNodeEventThrottle.dispatchExpanded(event);
      if (this.beans.gridOptionsService.is("groupIncludeFooter")) {
        this.beans.rowRenderer.refreshCells({ rowNodes: [this] });
      }
    };
    RowNode3.prototype.createGlobalRowEvent = function(type) {
      return {
        type,
        node: this,
        data: this.data,
        rowIndex: this.rowIndex,
        rowPinned: this.rowPinned,
        context: this.beans.gridOptionsService.context,
        api: this.beans.gridOptionsService.api,
        columnApi: this.beans.gridOptionsService.columnApi
      };
    };
    RowNode3.prototype.dispatchLocalEvent = function(event) {
      if (this.eventService) {
        this.eventService.dispatchEvent(event);
      }
    };
    RowNode3.prototype.setDataValue = function(colKey, newValue, eventSource) {
      var _this = this;
      var getColumnFromKey = function() {
        var _a2;
        if (typeof colKey !== "string") {
          return colKey;
        }
        return (_a2 = _this.beans.columnModel.getGridColumn(colKey)) !== null && _a2 !== void 0 ? _a2 : _this.beans.columnModel.getPrimaryColumn(colKey);
      };
      var column = getColumnFromKey();
      var oldValue = this.getValueFromValueService(column);
      if (this.beans.gridOptionsService.is("readOnlyEdit")) {
        this.dispatchEventForSaveValueReadOnly(column, oldValue, newValue, eventSource);
        return false;
      }
      var valueChanged = this.beans.valueService.setValue(this, column, newValue, eventSource);
      this.dispatchCellChangedEvent(column, newValue, oldValue);
      this.checkRowSelectable();
      return valueChanged;
    };
    RowNode3.prototype.getValueFromValueService = function(column) {
      var lockedClosedGroup = this.leafGroup && this.beans.columnModel.isPivotMode();
      var isOpenGroup = this.group && this.expanded && !this.footer && !lockedClosedGroup;
      var groupFootersEnabled = this.beans.gridOptionsService.is("groupIncludeFooter");
      var groupAlwaysShowAggData = this.beans.gridOptionsService.is("groupSuppressBlankHeader");
      var ignoreAggData = isOpenGroup && groupFootersEnabled && !groupAlwaysShowAggData;
      var value = this.beans.valueService.getValue(column, this, false, ignoreAggData);
      return value;
    };
    RowNode3.prototype.dispatchEventForSaveValueReadOnly = function(column, oldValue, newValue, eventSource) {
      var event = {
        type: Events.EVENT_CELL_EDIT_REQUEST,
        event: null,
        rowIndex: this.rowIndex,
        rowPinned: this.rowPinned,
        column,
        colDef: column.getColDef(),
        context: this.beans.gridOptionsService.context,
        api: this.beans.gridOptionsService.api,
        columnApi: this.beans.gridOptionsService.columnApi,
        data: this.data,
        node: this,
        oldValue,
        newValue,
        value: newValue,
        source: eventSource
      };
      this.beans.eventService.dispatchEvent(event);
    };
    RowNode3.prototype.setGroupValue = function(colKey, newValue) {
      var column = this.beans.columnModel.getGridColumn(colKey);
      if (missing(this.groupData)) {
        this.groupData = {};
      }
      var columnId = column.getColId();
      var oldValue = this.groupData[columnId];
      if (oldValue === newValue) {
        return;
      }
      this.groupData[columnId] = newValue;
      this.dispatchCellChangedEvent(column, newValue, oldValue);
    };
    RowNode3.prototype.setAggData = function(newAggData) {
      var _this = this;
      var colIds = getAllKeysInObjects([this.aggData, newAggData]);
      var oldAggData = this.aggData;
      this.aggData = newAggData;
      if (this.eventService) {
        colIds.forEach(function(colId) {
          var column = _this.beans.columnModel.getGridColumn(colId);
          var value = _this.aggData ? _this.aggData[colId] : void 0;
          var oldValue = oldAggData ? oldAggData[colId] : void 0;
          _this.dispatchCellChangedEvent(column, value, oldValue);
        });
      }
    };
    RowNode3.prototype.updateHasChildren = function() {
      var newValue = this.group && !this.footer || this.childrenAfterGroup && this.childrenAfterGroup.length > 0;
      var isSsrm = this.beans.gridOptionsService.isRowModelType("serverSide");
      if (isSsrm) {
        var isTreeData = this.beans.gridOptionsService.isTreeData();
        var isGroupFunc = this.beans.gridOptionsService.get("isServerSideGroup");
        newValue = !this.stub && !this.footer && (isTreeData ? !!isGroupFunc && isGroupFunc(this.data) : !!this.group);
      }
      if (newValue !== this.__hasChildren) {
        this.__hasChildren = !!newValue;
        if (this.eventService) {
          this.eventService.dispatchEvent(this.createLocalRowEvent(RowNode3.EVENT_HAS_CHILDREN_CHANGED));
        }
      }
    };
    RowNode3.prototype.hasChildren = function() {
      if (this.__hasChildren == null) {
        this.updateHasChildren();
      }
      return this.__hasChildren;
    };
    RowNode3.prototype.isEmptyRowGroupNode = function() {
      return this.group && missingOrEmpty(this.childrenAfterGroup);
    };
    RowNode3.prototype.dispatchCellChangedEvent = function(column, newValue, oldValue) {
      var cellChangedEvent = {
        type: RowNode3.EVENT_CELL_CHANGED,
        node: this,
        column,
        newValue,
        oldValue
      };
      this.dispatchLocalEvent(cellChangedEvent);
    };
    RowNode3.prototype.resetQuickFilterAggregateText = function() {
      this.quickFilterAggregateText = null;
    };
    RowNode3.prototype.isExpandable = function() {
      return this.hasChildren() && !this.footer || this.master ? true : false;
    };
    RowNode3.prototype.isSelected = function() {
      if (this.footer) {
        return this.sibling.isSelected();
      }
      return this.selected;
    };
    RowNode3.prototype.depthFirstSearch = function(callback2) {
      if (this.childrenAfterGroup) {
        this.childrenAfterGroup.forEach(function(child) {
          return child.depthFirstSearch(callback2);
        });
      }
      callback2(this);
    };
    RowNode3.prototype.calculateSelectedFromChildren = function() {
      var _a2;
      var atLeastOneSelected = false;
      var atLeastOneDeSelected = false;
      var atLeastOneMixed = false;
      if (!((_a2 = this.childrenAfterGroup) === null || _a2 === void 0 ? void 0 : _a2.length)) {
        return this.selectable ? this.selected : null;
      }
      for (var i = 0; i < this.childrenAfterGroup.length; i++) {
        var child = this.childrenAfterGroup[i];
        var childState = child.isSelected();
        if (!child.selectable) {
          var selectable = child.calculateSelectedFromChildren();
          if (selectable === null) {
            continue;
          }
          childState = selectable;
        }
        switch (childState) {
          case true:
            atLeastOneSelected = true;
            break;
          case false:
            atLeastOneDeSelected = true;
            break;
          default:
            atLeastOneMixed = true;
            break;
        }
      }
      if (atLeastOneMixed || atLeastOneSelected && atLeastOneDeSelected) {
        return void 0;
      }
      if (atLeastOneSelected) {
        return true;
      }
      if (atLeastOneDeSelected) {
        return false;
      }
      if (!this.selectable) {
        return null;
      }
      return this.selected;
    };
    RowNode3.prototype.setSelectedInitialValue = function(selected) {
      this.selected = selected;
    };
    RowNode3.prototype.selectThisNode = function(newValue, e, source) {
      if (source === void 0) {
        source = "api";
      }
      var selectionNotAllowed = !this.selectable && newValue;
      var selectionNotChanged = this.selected === newValue;
      if (selectionNotAllowed || selectionNotChanged) {
        return false;
      }
      this.selected = newValue;
      if (this.eventService) {
        this.dispatchLocalEvent(this.createLocalRowEvent(RowNode3.EVENT_ROW_SELECTED));
      }
      var event = __assign$f(__assign$f({}, this.createGlobalRowEvent(Events.EVENT_ROW_SELECTED)), { event: e || null, source });
      this.beans.eventService.dispatchEvent(event);
      return true;
    };
    RowNode3.prototype.setSelected = function(newValue, clearSelection, source) {
      if (clearSelection === void 0) {
        clearSelection = false;
      }
      if (source === void 0) {
        source = "api";
      }
      if (typeof source === "boolean") {
        console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.");
        return;
      }
      this.setSelectedParams({
        newValue,
        clearSelection,
        rangeSelect: false,
        source
      });
    };
    RowNode3.prototype.setSelectedParams = function(params) {
      if (this.rowPinned) {
        console.warn("AG Grid: cannot select pinned rows");
        return 0;
      }
      if (this.id === void 0) {
        console.warn("AG Grid: cannot select node until id for node is known");
        return 0;
      }
      return this.beans.selectionService.setNodesSelected(__assign$f(__assign$f({}, params), { nodes: [this.footer ? this.sibling : this] }));
    };
    RowNode3.prototype.isRowPinned = function() {
      return this.rowPinned === "top" || this.rowPinned === "bottom";
    };
    RowNode3.prototype.isParentOfNode = function(potentialParent) {
      var parentNode = this.parent;
      while (parentNode) {
        if (parentNode === potentialParent) {
          return true;
        }
        parentNode = parentNode.parent;
      }
      return false;
    };
    RowNode3.prototype.addEventListener = function(eventType, listener) {
      if (!this.eventService) {
        this.eventService = new EventService();
      }
      this.eventService.addEventListener(eventType, listener);
    };
    RowNode3.prototype.removeEventListener = function(eventType, listener) {
      if (!this.eventService) {
        return;
      }
      this.eventService.removeEventListener(eventType, listener);
      if (this.eventService.noRegisteredListenersExist()) {
        this.eventService = null;
      }
    };
    RowNode3.prototype.onMouseEnter = function() {
      this.dispatchLocalEvent(this.createLocalRowEvent(RowNode3.EVENT_MOUSE_ENTER));
    };
    RowNode3.prototype.onMouseLeave = function() {
      this.dispatchLocalEvent(this.createLocalRowEvent(RowNode3.EVENT_MOUSE_LEAVE));
    };
    RowNode3.prototype.getFirstChildOfFirstChild = function(rowGroupColumn) {
      var currentRowNode = this;
      var isCandidate = true;
      var foundFirstChildPath = false;
      var nodeToSwapIn = null;
      while (isCandidate && !foundFirstChildPath) {
        var parentRowNode = currentRowNode.parent;
        var firstChild = exists(parentRowNode) && currentRowNode.firstChild;
        if (firstChild) {
          if (parentRowNode.rowGroupColumn === rowGroupColumn) {
            foundFirstChildPath = true;
            nodeToSwapIn = parentRowNode;
          }
        } else {
          isCandidate = false;
        }
        currentRowNode = parentRowNode;
      }
      return foundFirstChildPath ? nodeToSwapIn : null;
    };
    RowNode3.prototype.isFullWidthCell = function() {
      var isFullWidthCellFunc = this.beans.gridOptionsService.getCallback("isFullWidthRow");
      return isFullWidthCellFunc ? isFullWidthCellFunc({ rowNode: this }) : false;
    };
    RowNode3.prototype.getRoute = function() {
      if (this.key == null) {
        return;
      }
      var res = [];
      var pointer = this;
      while (pointer.key != null) {
        res.push(pointer.key);
        pointer = pointer.parent;
      }
      return res.reverse();
    };
    RowNode3.prototype.createFooter = function() {
      var _this = this;
      if (this.sibling) {
        return;
      }
      var footerNode = new RowNode3(this.beans);
      Object.keys(this).forEach(function(key) {
        footerNode[key] = _this[key];
      });
      footerNode.footer = true;
      footerNode.setRowTop(null);
      footerNode.setRowIndex(null);
      footerNode.oldRowTop = null;
      footerNode.id = "rowGroupFooter_" + this.id;
      footerNode.sibling = this;
      this.sibling = footerNode;
    };
    RowNode3.ID_PREFIX_ROW_GROUP = "row-group-";
    RowNode3.ID_PREFIX_TOP_PINNED = "t-";
    RowNode3.ID_PREFIX_BOTTOM_PINNED = "b-";
    RowNode3.OBJECT_ID_SEQUENCE = 0;
    RowNode3.EVENT_ROW_SELECTED = "rowSelected";
    RowNode3.EVENT_DATA_CHANGED = "dataChanged";
    RowNode3.EVENT_CELL_CHANGED = "cellChanged";
    RowNode3.EVENT_ALL_CHILDREN_COUNT_CHANGED = "allChildrenCountChanged";
    RowNode3.EVENT_MASTER_CHANGED = "masterChanged";
    RowNode3.EVENT_GROUP_CHANGED = "groupChanged";
    RowNode3.EVENT_MOUSE_ENTER = "mouseEnter";
    RowNode3.EVENT_MOUSE_LEAVE = "mouseLeave";
    RowNode3.EVENT_HEIGHT_CHANGED = "heightChanged";
    RowNode3.EVENT_TOP_CHANGED = "topChanged";
    RowNode3.EVENT_DISPLAYED_CHANGED = "displayedChanged";
    RowNode3.EVENT_FIRST_CHILD_CHANGED = "firstChildChanged";
    RowNode3.EVENT_LAST_CHILD_CHANGED = "lastChildChanged";
    RowNode3.EVENT_CHILD_INDEX_CHANGED = "childIndexChanged";
    RowNode3.EVENT_ROW_INDEX_CHANGED = "rowIndexChanged";
    RowNode3.EVENT_EXPANDED_CHANGED = "expandedChanged";
    RowNode3.EVENT_HAS_CHILDREN_CHANGED = "hasChildrenChanged";
    RowNode3.EVENT_SELECTABLE_CHANGED = "selectableChanged";
    RowNode3.EVENT_UI_LEVEL_CHANGED = "uiLevelChanged";
    RowNode3.EVENT_HIGHLIGHT_CHANGED = "rowHighlightChanged";
    RowNode3.EVENT_DRAGGING_CHANGED = "draggingChanged";
    return RowNode3;
  }()
);
var __extends$2k = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$e = function() {
  __assign$e = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$e.apply(this, arguments);
};
var __decorate$25 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var CheckboxSelectionComponent = (
  /** @class */
  function(_super) {
    __extends$2k(CheckboxSelectionComponent2, _super);
    function CheckboxSelectionComponent2() {
      return _super.call(
        this,
        /* html*/
        '\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>'
      ) || this;
    }
    CheckboxSelectionComponent2.prototype.postConstruct = function() {
      this.eCheckbox.setPassive(true);
      setAriaLive(this.eCheckbox.getInputElement(), "polite");
    };
    CheckboxSelectionComponent2.prototype.getCheckboxId = function() {
      return this.eCheckbox.getInputElement().id;
    };
    CheckboxSelectionComponent2.prototype.onDataChanged = function() {
      this.onSelectionChanged();
    };
    CheckboxSelectionComponent2.prototype.onSelectableChanged = function() {
      this.showOrHideSelect();
    };
    CheckboxSelectionComponent2.prototype.onSelectionChanged = function() {
      var translate = this.localeService.getLocaleTextFunc();
      var state = this.rowNode.isSelected();
      var stateName = getAriaCheckboxStateName(translate, state);
      var ariaLabel = translate("ariaRowToggleSelection", "Press Space to toggle row selection");
      this.eCheckbox.setValue(state, true);
      this.eCheckbox.setInputAriaLabel(ariaLabel + " (" + stateName + ")");
    };
    CheckboxSelectionComponent2.prototype.onClicked = function(newValue, groupSelectsFiltered, event) {
      return this.rowNode.setSelectedParams({ newValue, rangeSelect: event.shiftKey, groupSelectsFiltered, event, source: "checkboxSelected" });
    };
    CheckboxSelectionComponent2.prototype.init = function(params) {
      var _this = this;
      this.rowNode = params.rowNode;
      this.column = params.column;
      this.overrides = params.overrides;
      this.onSelectionChanged();
      this.addManagedListener(this.eCheckbox.getInputElement(), "dblclick", function(event) {
        stopPropagationForAgGrid(event);
      });
      this.addManagedListener(this.eCheckbox.getInputElement(), "click", function(event) {
        stopPropagationForAgGrid(event);
        var groupSelectsFiltered = _this.gridOptionsService.is("groupSelectsFiltered");
        var isSelected = _this.eCheckbox.getValue();
        if (_this.shouldHandleIndeterminateState(isSelected, groupSelectsFiltered)) {
          var result = _this.onClicked(true, groupSelectsFiltered, event || {});
          if (result === 0) {
            _this.onClicked(false, groupSelectsFiltered, event);
          }
        } else if (isSelected) {
          _this.onClicked(false, groupSelectsFiltered, event);
        } else {
          _this.onClicked(true, groupSelectsFiltered, event || {});
        }
      });
      this.addManagedListener(this.rowNode, RowNode2.EVENT_ROW_SELECTED, this.onSelectionChanged.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_DATA_CHANGED, this.onDataChanged.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_SELECTABLE_CHANGED, this.onSelectableChanged.bind(this));
      var isRowSelectableFunc = this.gridOptionsService.get("isRowSelectable");
      var checkboxVisibleIsDynamic = isRowSelectableFunc || typeof this.getIsVisible() === "function";
      if (checkboxVisibleIsDynamic) {
        var showOrHideSelectListener = this.showOrHideSelect.bind(this);
        this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, showOrHideSelectListener);
        this.addManagedListener(this.rowNode, RowNode2.EVENT_DATA_CHANGED, showOrHideSelectListener);
        this.addManagedListener(this.rowNode, RowNode2.EVENT_CELL_CHANGED, showOrHideSelectListener);
        this.showOrHideSelect();
      }
      this.eCheckbox.getInputElement().setAttribute("tabindex", "-1");
    };
    CheckboxSelectionComponent2.prototype.shouldHandleIndeterminateState = function(isSelected, groupSelectsFiltered) {
      return groupSelectsFiltered && (this.eCheckbox.getPreviousValue() === void 0 || isSelected === void 0) && this.gridOptionsService.isRowModelType("clientSide");
    };
    CheckboxSelectionComponent2.prototype.showOrHideSelect = function() {
      var _a2, _b2, _c, _d;
      var selectable = this.rowNode.selectable;
      var isVisible2 = this.getIsVisible();
      if (selectable) {
        if (typeof isVisible2 === "function") {
          var extraParams = (_a2 = this.overrides) === null || _a2 === void 0 ? void 0 : _a2.callbackParams;
          var params = (_b2 = this.column) === null || _b2 === void 0 ? void 0 : _b2.createColumnFunctionCallbackParams(this.rowNode);
          selectable = params ? isVisible2(__assign$e(__assign$e({}, extraParams), params)) : false;
        } else {
          selectable = isVisible2 !== null && isVisible2 !== void 0 ? isVisible2 : false;
        }
      }
      var disableInsteadOfHide = (_c = this.column) === null || _c === void 0 ? void 0 : _c.getColDef().showDisabledCheckboxes;
      if (disableInsteadOfHide) {
        this.eCheckbox.setDisabled(!selectable);
        this.setVisible(true);
        this.setDisplayed(true);
        return;
      }
      if ((_d = this.overrides) === null || _d === void 0 ? void 0 : _d.removeHidden) {
        this.setDisplayed(selectable);
        return;
      }
      this.setVisible(selectable);
    };
    CheckboxSelectionComponent2.prototype.getIsVisible = function() {
      var _a2, _b2;
      if (this.overrides) {
        return this.overrides.isVisible;
      }
      return (_b2 = (_a2 = this.column) === null || _a2 === void 0 ? void 0 : _a2.getColDef()) === null || _b2 === void 0 ? void 0 : _b2.checkboxSelection;
    };
    __decorate$25([
      RefSelector("eCheckbox")
    ], CheckboxSelectionComponent2.prototype, "eCheckbox", void 0);
    __decorate$25([
      PostConstruct
    ], CheckboxSelectionComponent2.prototype, "postConstruct", null);
    return CheckboxSelectionComponent2;
  }(Component)
);
var __extends$2j = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$24 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __values$4 = function(o) {
  var s2 = typeof Symbol === "function" && Symbol.iterator, m2 = s2 && o[s2], i = 0;
  if (m2)
    return m2.call(o);
  if (o && typeof o.length === "number")
    return {
      next: function() {
        if (o && i >= o.length)
          o = void 0;
        return { value: o && o[i++], done: !o };
      }
    };
  throw new TypeError(s2 ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var DragSourceType;
(function(DragSourceType2) {
  DragSourceType2[DragSourceType2["ToolPanel"] = 0] = "ToolPanel";
  DragSourceType2[DragSourceType2["HeaderCell"] = 1] = "HeaderCell";
  DragSourceType2[DragSourceType2["RowDrag"] = 2] = "RowDrag";
  DragSourceType2[DragSourceType2["ChartPanel"] = 3] = "ChartPanel";
})(DragSourceType || (DragSourceType = {}));
var VerticalDirection;
(function(VerticalDirection2) {
  VerticalDirection2[VerticalDirection2["Up"] = 0] = "Up";
  VerticalDirection2[VerticalDirection2["Down"] = 1] = "Down";
})(VerticalDirection || (VerticalDirection = {}));
var HorizontalDirection;
(function(HorizontalDirection2) {
  HorizontalDirection2[HorizontalDirection2["Left"] = 0] = "Left";
  HorizontalDirection2[HorizontalDirection2["Right"] = 1] = "Right";
})(HorizontalDirection || (HorizontalDirection = {}));
var DragAndDropService = (
  /** @class */
  function(_super) {
    __extends$2j(DragAndDropService2, _super);
    function DragAndDropService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.dragSourceAndParamsList = [];
      _this.dropTargets = [];
      return _this;
    }
    DragAndDropService_1 = DragAndDropService2;
    DragAndDropService2.prototype.init = function() {
      this.ePinnedIcon = createIcon("columnMovePin", this.gridOptionsService, null);
      this.eHideIcon = createIcon("columnMoveHide", this.gridOptionsService, null);
      this.eMoveIcon = createIcon("columnMoveMove", this.gridOptionsService, null);
      this.eLeftIcon = createIcon("columnMoveLeft", this.gridOptionsService, null);
      this.eRightIcon = createIcon("columnMoveRight", this.gridOptionsService, null);
      this.eGroupIcon = createIcon("columnMoveGroup", this.gridOptionsService, null);
      this.eAggregateIcon = createIcon("columnMoveValue", this.gridOptionsService, null);
      this.ePivotIcon = createIcon("columnMovePivot", this.gridOptionsService, null);
      this.eDropNotAllowedIcon = createIcon("dropNotAllowed", this.gridOptionsService, null);
    };
    DragAndDropService2.prototype.addDragSource = function(dragSource, allowTouch) {
      if (allowTouch === void 0) {
        allowTouch = false;
      }
      var params = {
        eElement: dragSource.eElement,
        dragStartPixels: dragSource.dragStartPixels,
        onDragStart: this.onDragStart.bind(this, dragSource),
        onDragStop: this.onDragStop.bind(this),
        onDragging: this.onDragging.bind(this),
        includeTouch: allowTouch
      };
      this.dragSourceAndParamsList.push({ params, dragSource });
      this.dragService.addDragSource(params);
    };
    DragAndDropService2.prototype.removeDragSource = function(dragSource) {
      var sourceAndParams = this.dragSourceAndParamsList.find(function(item) {
        return item.dragSource === dragSource;
      });
      if (sourceAndParams) {
        this.dragService.removeDragSource(sourceAndParams.params);
        removeFromArray(this.dragSourceAndParamsList, sourceAndParams);
      }
    };
    DragAndDropService2.prototype.clearDragSourceParamsList = function() {
      var _this = this;
      this.dragSourceAndParamsList.forEach(function(sourceAndParams) {
        return _this.dragService.removeDragSource(sourceAndParams.params);
      });
      this.dragSourceAndParamsList.length = 0;
      this.dropTargets.length = 0;
    };
    DragAndDropService2.prototype.nudge = function() {
      if (this.dragging) {
        this.onDragging(this.eventLastTime, true);
      }
    };
    DragAndDropService2.prototype.onDragStart = function(dragSource, mouseEvent) {
      this.dragging = true;
      this.dragSource = dragSource;
      this.eventLastTime = mouseEvent;
      this.dragItem = this.dragSource.getDragItem();
      this.lastDropTarget = this.dragSource.dragSourceDropTarget;
      if (this.dragSource.onDragStarted) {
        this.dragSource.onDragStarted();
      }
      this.createGhost();
    };
    DragAndDropService2.prototype.onDragStop = function(mouseEvent) {
      this.eventLastTime = null;
      this.dragging = false;
      if (this.dragSource.onDragStopped) {
        this.dragSource.onDragStopped();
      }
      if (this.lastDropTarget && this.lastDropTarget.onDragStop) {
        var draggingEvent = this.createDropTargetEvent(this.lastDropTarget, mouseEvent, null, null, false);
        this.lastDropTarget.onDragStop(draggingEvent);
      }
      this.lastDropTarget = null;
      this.dragItem = null;
      this.removeGhost();
    };
    DragAndDropService2.prototype.onDragging = function(mouseEvent, fromNudge) {
      var _this = this;
      var _a2, _b2, _c, _d;
      var hDirection = this.getHorizontalDirection(mouseEvent);
      var vDirection = this.getVerticalDirection(mouseEvent);
      this.eventLastTime = mouseEvent;
      this.positionGhost(mouseEvent);
      var validDropTargets = this.dropTargets.filter(function(target) {
        return _this.isMouseOnDropTarget(mouseEvent, target);
      });
      var dropTarget = this.findCurrentDropTarget(mouseEvent, validDropTargets);
      if (dropTarget !== this.lastDropTarget) {
        this.leaveLastTargetIfExists(mouseEvent, hDirection, vDirection, fromNudge);
        if (this.lastDropTarget !== null && dropTarget === null) {
          (_b2 = (_a2 = this.dragSource).onGridExit) === null || _b2 === void 0 ? void 0 : _b2.call(_a2, this.dragItem);
        }
        if (this.lastDropTarget === null && dropTarget !== null) {
          (_d = (_c = this.dragSource).onGridEnter) === null || _d === void 0 ? void 0 : _d.call(_c, this.dragItem);
        }
        this.enterDragTargetIfExists(dropTarget, mouseEvent, hDirection, vDirection, fromNudge);
        this.lastDropTarget = dropTarget;
      } else if (dropTarget && dropTarget.onDragging) {
        var draggingEvent = this.createDropTargetEvent(dropTarget, mouseEvent, hDirection, vDirection, fromNudge);
        dropTarget.onDragging(draggingEvent);
      }
    };
    DragAndDropService2.prototype.getAllContainersFromDropTarget = function(dropTarget) {
      var secondaryContainers = dropTarget.getSecondaryContainers ? dropTarget.getSecondaryContainers() : null;
      var containers = [[dropTarget.getContainer()]];
      return secondaryContainers ? containers.concat(secondaryContainers) : containers;
    };
    DragAndDropService2.prototype.allContainersIntersect = function(mouseEvent, containers) {
      var e_1, _a2;
      try {
        for (var containers_1 = __values$4(containers), containers_1_1 = containers_1.next(); !containers_1_1.done; containers_1_1 = containers_1.next()) {
          var container = containers_1_1.value;
          var rect = container.getBoundingClientRect();
          if (rect.width === 0 || rect.height === 0) {
            return false;
          }
          var horizontalFit = mouseEvent.clientX >= rect.left && mouseEvent.clientX < rect.right;
          var verticalFit = mouseEvent.clientY >= rect.top && mouseEvent.clientY < rect.bottom;
          if (!horizontalFit || !verticalFit) {
            return false;
          }
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (containers_1_1 && !containers_1_1.done && (_a2 = containers_1.return))
            _a2.call(containers_1);
        } finally {
          if (e_1)
            throw e_1.error;
        }
      }
      return true;
    };
    DragAndDropService2.prototype.isMouseOnDropTarget = function(mouseEvent, dropTarget) {
      var e_2, _a2;
      var allContainersFromDropTarget = this.getAllContainersFromDropTarget(dropTarget);
      var mouseOverTarget = false;
      try {
        for (var allContainersFromDropTarget_1 = __values$4(allContainersFromDropTarget), allContainersFromDropTarget_1_1 = allContainersFromDropTarget_1.next(); !allContainersFromDropTarget_1_1.done; allContainersFromDropTarget_1_1 = allContainersFromDropTarget_1.next()) {
          var currentContainers = allContainersFromDropTarget_1_1.value;
          if (this.allContainersIntersect(mouseEvent, currentContainers)) {
            mouseOverTarget = true;
            break;
          }
        }
      } catch (e_2_1) {
        e_2 = { error: e_2_1 };
      } finally {
        try {
          if (allContainersFromDropTarget_1_1 && !allContainersFromDropTarget_1_1.done && (_a2 = allContainersFromDropTarget_1.return))
            _a2.call(allContainersFromDropTarget_1);
        } finally {
          if (e_2)
            throw e_2.error;
        }
      }
      if (dropTarget.targetContainsSource && !dropTarget.getContainer().contains(this.dragSource.eElement)) {
        return false;
      }
      return mouseOverTarget && dropTarget.isInterestedIn(this.dragSource.type, this.dragSource.eElement);
    };
    DragAndDropService2.prototype.findCurrentDropTarget = function(mouseEvent, validDropTargets) {
      var e_3, _a2, e_4, _b2;
      var len = validDropTargets.length;
      if (len === 0) {
        return null;
      }
      if (len === 1) {
        return validDropTargets[0];
      }
      var rootNode = this.gridOptionsService.getRootNode();
      var elementStack = rootNode.elementsFromPoint(mouseEvent.clientX, mouseEvent.clientY);
      try {
        for (var elementStack_1 = __values$4(elementStack), elementStack_1_1 = elementStack_1.next(); !elementStack_1_1.done; elementStack_1_1 = elementStack_1.next()) {
          var el2 = elementStack_1_1.value;
          try {
            for (var validDropTargets_1 = (e_4 = void 0, __values$4(validDropTargets)), validDropTargets_1_1 = validDropTargets_1.next(); !validDropTargets_1_1.done; validDropTargets_1_1 = validDropTargets_1.next()) {
              var dropTarget = validDropTargets_1_1.value;
              var containers = flatten(this.getAllContainersFromDropTarget(dropTarget));
              if (containers.indexOf(el2) !== -1) {
                return dropTarget;
              }
            }
          } catch (e_4_1) {
            e_4 = { error: e_4_1 };
          } finally {
            try {
              if (validDropTargets_1_1 && !validDropTargets_1_1.done && (_b2 = validDropTargets_1.return))
                _b2.call(validDropTargets_1);
            } finally {
              if (e_4)
                throw e_4.error;
            }
          }
        }
      } catch (e_3_1) {
        e_3 = { error: e_3_1 };
      } finally {
        try {
          if (elementStack_1_1 && !elementStack_1_1.done && (_a2 = elementStack_1.return))
            _a2.call(elementStack_1);
        } finally {
          if (e_3)
            throw e_3.error;
        }
      }
      return null;
    };
    DragAndDropService2.prototype.enterDragTargetIfExists = function(dropTarget, mouseEvent, hDirection, vDirection, fromNudge) {
      if (!dropTarget) {
        return;
      }
      if (dropTarget.onDragEnter) {
        var dragEnterEvent = this.createDropTargetEvent(dropTarget, mouseEvent, hDirection, vDirection, fromNudge);
        dropTarget.onDragEnter(dragEnterEvent);
      }
      this.setGhostIcon(dropTarget.getIconName ? dropTarget.getIconName() : null);
    };
    DragAndDropService2.prototype.leaveLastTargetIfExists = function(mouseEvent, hDirection, vDirection, fromNudge) {
      if (!this.lastDropTarget) {
        return;
      }
      if (this.lastDropTarget.onDragLeave) {
        var dragLeaveEvent = this.createDropTargetEvent(this.lastDropTarget, mouseEvent, hDirection, vDirection, fromNudge);
        this.lastDropTarget.onDragLeave(dragLeaveEvent);
      }
      this.setGhostIcon(null);
    };
    DragAndDropService2.prototype.addDropTarget = function(dropTarget) {
      this.dropTargets.push(dropTarget);
    };
    DragAndDropService2.prototype.removeDropTarget = function(dropTarget) {
      this.dropTargets = this.dropTargets.filter(function(target) {
        return target.getContainer() !== dropTarget.getContainer();
      });
    };
    DragAndDropService2.prototype.hasExternalDropZones = function() {
      return this.dropTargets.some(function(zones) {
        return zones.external;
      });
    };
    DragAndDropService2.prototype.findExternalZone = function(params) {
      var externalTargets = this.dropTargets.filter(function(target) {
        return target.external;
      });
      return externalTargets.find(function(zone) {
        return zone.getContainer() === params.getContainer();
      }) || null;
    };
    DragAndDropService2.prototype.getHorizontalDirection = function(event) {
      var clientX = this.eventLastTime && this.eventLastTime.clientX;
      var eClientX = event.clientX;
      if (clientX === eClientX) {
        return null;
      }
      return clientX > eClientX ? HorizontalDirection.Left : HorizontalDirection.Right;
    };
    DragAndDropService2.prototype.getVerticalDirection = function(event) {
      var clientY = this.eventLastTime && this.eventLastTime.clientY;
      var eClientY = event.clientY;
      if (clientY === eClientY) {
        return null;
      }
      return clientY > eClientY ? VerticalDirection.Up : VerticalDirection.Down;
    };
    DragAndDropService2.prototype.createDropTargetEvent = function(dropTarget, event, hDirection, vDirection, fromNudge) {
      var dropZoneTarget = dropTarget.getContainer();
      var rect = dropZoneTarget.getBoundingClientRect();
      var _a2 = this, api = _a2.gridApi, columnApi = _a2.columnApi, dragItem = _a2.dragItem, dragSource = _a2.dragSource;
      var x2 = event.clientX - rect.left;
      var y2 = event.clientY - rect.top;
      return { event, x: x2, y: y2, vDirection, hDirection, dragSource, fromNudge, dragItem, api, columnApi, dropZoneTarget };
    };
    DragAndDropService2.prototype.positionGhost = function(event) {
      var ghost = this.eGhost;
      if (!ghost) {
        return;
      }
      var ghostRect = ghost.getBoundingClientRect();
      var ghostHeight = ghostRect.height;
      var browserWidth = getBodyWidth() - 2;
      var browserHeight = getBodyHeight() - 2;
      var offsetParentSize = getElementRectWithOffset(ghost.offsetParent);
      var clientY = event.clientY, clientX = event.clientX;
      var top = clientY - offsetParentSize.top - ghostHeight / 2;
      var left = clientX - offsetParentSize.left - 10;
      var eDocument = this.gridOptionsService.getDocument();
      var win = eDocument.defaultView || window;
      var windowScrollY = win.pageYOffset || eDocument.documentElement.scrollTop;
      var windowScrollX = win.pageXOffset || eDocument.documentElement.scrollLeft;
      if (browserWidth > 0 && left + ghost.clientWidth > browserWidth + windowScrollX) {
        left = browserWidth + windowScrollX - ghost.clientWidth;
      }
      if (left < 0) {
        left = 0;
      }
      if (browserHeight > 0 && top + ghost.clientHeight > browserHeight + windowScrollY) {
        top = browserHeight + windowScrollY - ghost.clientHeight;
      }
      if (top < 0) {
        top = 0;
      }
      ghost.style.left = left + "px";
      ghost.style.top = top + "px";
    };
    DragAndDropService2.prototype.removeGhost = function() {
      if (this.eGhost && this.eGhostParent) {
        this.eGhostParent.removeChild(this.eGhost);
      }
      this.eGhost = null;
    };
    DragAndDropService2.prototype.createGhost = function() {
      this.eGhost = loadTemplate(DragAndDropService_1.GHOST_TEMPLATE);
      this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);
      var theme3 = this.environment.getTheme().theme;
      if (theme3) {
        this.eGhost.classList.add(theme3);
      }
      this.eGhostIcon = this.eGhost.querySelector(".ag-dnd-ghost-icon");
      this.setGhostIcon(null);
      var eText = this.eGhost.querySelector(".ag-dnd-ghost-label");
      var dragItemName = this.dragSource.dragItemName;
      if (isFunction$2(dragItemName)) {
        dragItemName = dragItemName();
      }
      eText.innerHTML = escapeString(dragItemName) || "";
      this.eGhost.style.height = "25px";
      this.eGhost.style.top = "20px";
      this.eGhost.style.left = "20px";
      var eDocument = this.gridOptionsService.getDocument();
      var targetEl = null;
      try {
        targetEl = eDocument.fullscreenElement;
      } catch (e) {
      } finally {
        if (!targetEl) {
          var rootNode = this.gridOptionsService.getRootNode();
          var body = rootNode.querySelector("body");
          if (body) {
            targetEl = body;
          } else if (rootNode instanceof ShadowRoot) {
            targetEl = rootNode;
          } else {
            targetEl = rootNode === null || rootNode === void 0 ? void 0 : rootNode.documentElement;
          }
        }
      }
      this.eGhostParent = targetEl;
      if (!this.eGhostParent) {
        console.warn("AG Grid: could not find document body, it is needed for dragging columns");
      } else {
        this.eGhostParent.appendChild(this.eGhost);
      }
    };
    DragAndDropService2.prototype.setGhostIcon = function(iconName, shake) {
      if (shake === void 0) {
        shake = false;
      }
      clearElement(this.eGhostIcon);
      var eIcon = null;
      if (!iconName) {
        iconName = this.dragSource.defaultIconName || DragAndDropService_1.ICON_NOT_ALLOWED;
      }
      switch (iconName) {
        case DragAndDropService_1.ICON_PINNED:
          eIcon = this.ePinnedIcon;
          break;
        case DragAndDropService_1.ICON_MOVE:
          eIcon = this.eMoveIcon;
          break;
        case DragAndDropService_1.ICON_LEFT:
          eIcon = this.eLeftIcon;
          break;
        case DragAndDropService_1.ICON_RIGHT:
          eIcon = this.eRightIcon;
          break;
        case DragAndDropService_1.ICON_GROUP:
          eIcon = this.eGroupIcon;
          break;
        case DragAndDropService_1.ICON_AGGREGATE:
          eIcon = this.eAggregateIcon;
          break;
        case DragAndDropService_1.ICON_PIVOT:
          eIcon = this.ePivotIcon;
          break;
        case DragAndDropService_1.ICON_NOT_ALLOWED:
          eIcon = this.eDropNotAllowedIcon;
          break;
        case DragAndDropService_1.ICON_HIDE:
          eIcon = this.eHideIcon;
          break;
      }
      this.eGhostIcon.classList.toggle("ag-shake-left-to-right", shake);
      if (eIcon === this.eHideIcon && this.gridOptionsService.is("suppressDragLeaveHidesColumns")) {
        return;
      }
      if (eIcon) {
        this.eGhostIcon.appendChild(eIcon);
      }
    };
    var DragAndDropService_1;
    DragAndDropService2.ICON_PINNED = "pinned";
    DragAndDropService2.ICON_MOVE = "move";
    DragAndDropService2.ICON_LEFT = "left";
    DragAndDropService2.ICON_RIGHT = "right";
    DragAndDropService2.ICON_GROUP = "group";
    DragAndDropService2.ICON_AGGREGATE = "aggregate";
    DragAndDropService2.ICON_PIVOT = "pivot";
    DragAndDropService2.ICON_NOT_ALLOWED = "notAllowed";
    DragAndDropService2.ICON_HIDE = "hide";
    DragAndDropService2.GHOST_TEMPLATE = '<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>';
    __decorate$24([
      Autowired("dragService")
    ], DragAndDropService2.prototype, "dragService", void 0);
    __decorate$24([
      Autowired("mouseEventService")
    ], DragAndDropService2.prototype, "mouseEventService", void 0);
    __decorate$24([
      Autowired("columnApi")
    ], DragAndDropService2.prototype, "columnApi", void 0);
    __decorate$24([
      Autowired("gridApi")
    ], DragAndDropService2.prototype, "gridApi", void 0);
    __decorate$24([
      PostConstruct
    ], DragAndDropService2.prototype, "init", null);
    __decorate$24([
      PreDestroy
    ], DragAndDropService2.prototype, "clearDragSourceParamsList", null);
    DragAndDropService2 = DragAndDropService_1 = __decorate$24([
      Bean("dragAndDropService")
    ], DragAndDropService2);
    return DragAndDropService2;
  }(BeanStub)
);
var __extends$2i = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$23 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var RowDragComp = (
  /** @class */
  function(_super) {
    __extends$2i(RowDragComp2, _super);
    function RowDragComp2(cellValueFn, rowNode, column, customGui, dragStartPixels, suppressVisibilityChange) {
      var _this = _super.call(this) || this;
      _this.cellValueFn = cellValueFn;
      _this.rowNode = rowNode;
      _this.column = column;
      _this.customGui = customGui;
      _this.dragStartPixels = dragStartPixels;
      _this.suppressVisibilityChange = suppressVisibilityChange;
      _this.dragSource = null;
      return _this;
    }
    RowDragComp2.prototype.isCustomGui = function() {
      return this.customGui != null;
    };
    RowDragComp2.prototype.postConstruct = function() {
      if (!this.customGui) {
        this.setTemplate(
          /* html */
          '<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'
        );
        this.getGui().appendChild(createIconNoSpan("rowDrag", this.gridOptionsService, null));
        this.addDragSource();
      } else {
        this.setDragElement(this.customGui, this.dragStartPixels);
      }
      this.checkCompatibility();
      if (!this.suppressVisibilityChange) {
        var strategy = this.gridOptionsService.is("rowDragManaged") ? new ManagedVisibilityStrategy(this, this.beans, this.rowNode, this.column) : new NonManagedVisibilityStrategy(this, this.beans, this.rowNode, this.column);
        this.createManagedBean(strategy, this.beans.context);
      }
    };
    RowDragComp2.prototype.setDragElement = function(dragElement, dragStartPixels) {
      this.setTemplateFromElement(dragElement);
      this.addDragSource(dragStartPixels);
    };
    RowDragComp2.prototype.getSelectedNodes = function() {
      var isRowDragMultiRow = this.gridOptionsService.is("rowDragMultiRow");
      if (!isRowDragMultiRow) {
        return [this.rowNode];
      }
      var selection = this.beans.selectionService.getSelectedNodes();
      return selection.indexOf(this.rowNode) !== -1 ? selection : [this.rowNode];
    };
    RowDragComp2.prototype.checkCompatibility = function() {
      var managed = this.gridOptionsService.is("rowDragManaged");
      var treeData = this.gridOptionsService.isTreeData();
      if (treeData && managed) {
        doOnce(function() {
          return console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true");
        }, "RowDragComp.managedAndTreeData");
      }
    };
    RowDragComp2.prototype.getDragItem = function() {
      return {
        rowNode: this.rowNode,
        rowNodes: this.getSelectedNodes(),
        columns: this.column ? [this.column] : void 0,
        defaultTextValue: this.cellValueFn()
      };
    };
    RowDragComp2.prototype.getRowDragText = function(column) {
      if (column) {
        var colDef = column.getColDef();
        if (colDef.rowDragText) {
          return colDef.rowDragText;
        }
      }
      return this.gridOptionsService.get("rowDragText");
    };
    RowDragComp2.prototype.addDragSource = function(dragStartPixels) {
      var _this = this;
      if (dragStartPixels === void 0) {
        dragStartPixels = 4;
      }
      if (this.dragSource) {
        this.removeDragSource();
      }
      var rowDragText = this.getRowDragText(this.column);
      var translate = this.localeService.getLocaleTextFunc();
      this.dragSource = {
        type: DragSourceType.RowDrag,
        eElement: this.getGui(),
        dragItemName: function() {
          var _a2;
          var dragItem = _this.getDragItem();
          var dragItemCount = ((_a2 = dragItem.rowNodes) === null || _a2 === void 0 ? void 0 : _a2.length) || 1;
          if (rowDragText) {
            return rowDragText(dragItem, dragItemCount);
          }
          return dragItemCount === 1 ? _this.cellValueFn() : dragItemCount + " " + translate("rowDragRows", "rows");
        },
        getDragItem: function() {
          return _this.getDragItem();
        },
        dragStartPixels,
        dragSourceDomDataKey: this.gridOptionsService.getDomDataKey()
      };
      this.beans.dragAndDropService.addDragSource(this.dragSource, true);
    };
    RowDragComp2.prototype.removeDragSource = function() {
      if (this.dragSource) {
        this.beans.dragAndDropService.removeDragSource(this.dragSource);
      }
      this.dragSource = null;
    };
    __decorate$23([
      Autowired("beans")
    ], RowDragComp2.prototype, "beans", void 0);
    __decorate$23([
      PostConstruct
    ], RowDragComp2.prototype, "postConstruct", null);
    __decorate$23([
      PreDestroy
    ], RowDragComp2.prototype, "removeDragSource", null);
    return RowDragComp2;
  }(Component)
);
var VisibilityStrategy = (
  /** @class */
  function(_super) {
    __extends$2i(VisibilityStrategy2, _super);
    function VisibilityStrategy2(parent, rowNode, column) {
      var _this = _super.call(this) || this;
      _this.parent = parent;
      _this.rowNode = rowNode;
      _this.column = column;
      return _this;
    }
    VisibilityStrategy2.prototype.setDisplayedOrVisible = function(neverDisplayed) {
      var displayedOptions = { skipAriaHidden: true };
      if (neverDisplayed) {
        this.parent.setDisplayed(false, displayedOptions);
      } else {
        var shown = true;
        var isShownSometimes = false;
        if (this.column) {
          shown = this.column.isRowDrag(this.rowNode) || this.parent.isCustomGui();
          isShownSometimes = isFunction$2(this.column.getColDef().rowDrag);
        }
        if (isShownSometimes) {
          this.parent.setDisplayed(true, displayedOptions);
          this.parent.setVisible(shown, displayedOptions);
        } else {
          this.parent.setDisplayed(shown, displayedOptions);
          this.parent.setVisible(true, displayedOptions);
        }
      }
    };
    return VisibilityStrategy2;
  }(BeanStub)
);
var NonManagedVisibilityStrategy = (
  /** @class */
  function(_super) {
    __extends$2i(NonManagedVisibilityStrategy2, _super);
    function NonManagedVisibilityStrategy2(parent, beans, rowNode, column) {
      var _this = _super.call(this, parent, rowNode, column) || this;
      _this.beans = beans;
      return _this;
    }
    NonManagedVisibilityStrategy2.prototype.postConstruct = function() {
      this.addManagedPropertyListener("suppressRowDrag", this.onSuppressRowDrag.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_DATA_CHANGED, this.workOutVisibility.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_CELL_CHANGED, this.workOutVisibility.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_CELL_CHANGED, this.workOutVisibility.bind(this));
      this.addManagedListener(this.beans.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.workOutVisibility.bind(this));
      this.workOutVisibility();
    };
    NonManagedVisibilityStrategy2.prototype.onSuppressRowDrag = function() {
      this.workOutVisibility();
    };
    NonManagedVisibilityStrategy2.prototype.workOutVisibility = function() {
      var neverDisplayed = this.gridOptionsService.is("suppressRowDrag");
      this.setDisplayedOrVisible(neverDisplayed);
    };
    __decorate$23([
      PostConstruct
    ], NonManagedVisibilityStrategy2.prototype, "postConstruct", null);
    return NonManagedVisibilityStrategy2;
  }(VisibilityStrategy)
);
var ManagedVisibilityStrategy = (
  /** @class */
  function(_super) {
    __extends$2i(ManagedVisibilityStrategy2, _super);
    function ManagedVisibilityStrategy2(parent, beans, rowNode, column) {
      var _this = _super.call(this, parent, rowNode, column) || this;
      _this.beans = beans;
      return _this;
    }
    ManagedVisibilityStrategy2.prototype.postConstruct = function() {
      this.addManagedListener(this.beans.eventService, Events.EVENT_SORT_CHANGED, this.workOutVisibility.bind(this));
      this.addManagedListener(this.beans.eventService, Events.EVENT_FILTER_CHANGED, this.workOutVisibility.bind(this));
      this.addManagedListener(this.beans.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.workOutVisibility.bind(this));
      this.addManagedListener(this.beans.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.workOutVisibility.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_DATA_CHANGED, this.workOutVisibility.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_CELL_CHANGED, this.workOutVisibility.bind(this));
      this.addManagedPropertyListener("suppressRowDrag", this.onSuppressRowDrag.bind(this));
      this.workOutVisibility();
    };
    ManagedVisibilityStrategy2.prototype.onSuppressRowDrag = function() {
      this.workOutVisibility();
    };
    ManagedVisibilityStrategy2.prototype.workOutVisibility = function() {
      var gridBodyCon = this.beans.ctrlsService.getGridBodyCtrl();
      var rowDragFeature = gridBodyCon.getRowDragFeature();
      var shouldPreventRowMove = rowDragFeature && rowDragFeature.shouldPreventRowMove();
      var suppressRowDrag = this.gridOptionsService.is("suppressRowDrag");
      var hasExternalDropZones = this.beans.dragAndDropService.hasExternalDropZones();
      var neverDisplayed = shouldPreventRowMove && !hasExternalDropZones || suppressRowDrag;
      this.setDisplayedOrVisible(neverDisplayed);
    };
    __decorate$23([
      PostConstruct
    ], ManagedVisibilityStrategy2.prototype, "postConstruct", null);
    return ManagedVisibilityStrategy2;
  }(VisibilityStrategy)
);
var __extends$2h = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$d = function() {
  __assign$d = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$d.apply(this, arguments);
};
var __decorate$22 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GroupCellRendererCtrl = (
  /** @class */
  function(_super) {
    __extends$2h(GroupCellRendererCtrl2, _super);
    function GroupCellRendererCtrl2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    GroupCellRendererCtrl2.prototype.init = function(comp, eGui, eCheckbox, eExpanded, eContracted, compClass, params) {
      this.params = params;
      this.eGui = eGui;
      this.eCheckbox = eCheckbox;
      this.eExpanded = eExpanded;
      this.eContracted = eContracted;
      this.comp = comp;
      this.compClass = compClass;
      var topLevelFooter = this.isTopLevelFooter();
      var embeddedRowMismatch = this.isEmbeddedRowMismatch();
      var isNullValueAndNotMaster = params.value == null && !params.node.master;
      var skipCell = false;
      if (this.gridOptionsService.is("groupIncludeFooter") && this.gridOptionsService.is("groupHideOpenParents")) {
        var node = params.node;
        if (node.footer) {
          var showRowGroup = params.colDef && params.colDef.showRowGroup;
          var rowGroupColumnId = node.rowGroupColumn && node.rowGroupColumn.getColId();
          skipCell = showRowGroup !== rowGroupColumnId;
        }
      }
      this.cellIsBlank = topLevelFooter ? false : embeddedRowMismatch || isNullValueAndNotMaster && !params.node.master || skipCell;
      if (this.cellIsBlank) {
        return;
      }
      this.setupShowingValueForOpenedParent();
      this.findDisplayedGroupNode();
      this.addFullWidthRowDraggerIfNeeded();
      this.addExpandAndContract();
      this.addCheckboxIfNeeded();
      this.addValueElement();
      this.setupIndent();
      this.refreshAriaExpanded();
    };
    GroupCellRendererCtrl2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
      this.expandListener = null;
    };
    GroupCellRendererCtrl2.prototype.refreshAriaExpanded = function() {
      var _a2 = this.params, node = _a2.node, eParentOfValue = _a2.eParentOfValue;
      if (this.expandListener) {
        this.expandListener = this.expandListener();
      }
      if (!this.isExpandable()) {
        removeAriaExpanded(eParentOfValue);
        return;
      }
      var listener = function() {
        setAriaExpanded(eParentOfValue, !!node.expanded);
      };
      this.expandListener = this.addManagedListener(node, RowNode2.EVENT_EXPANDED_CHANGED, listener) || null;
      listener();
    };
    GroupCellRendererCtrl2.prototype.isTopLevelFooter = function() {
      if (!this.gridOptionsService.is("groupIncludeTotalFooter")) {
        return false;
      }
      if (this.params.value != null || this.params.node.level != -1) {
        return false;
      }
      var colDef = this.params.colDef;
      var doingFullWidth = colDef == null;
      if (doingFullWidth) {
        return true;
      }
      if (colDef.showRowGroup === true) {
        return true;
      }
      var rowGroupCols = this.columnModel.getRowGroupColumns();
      if (!rowGroupCols || rowGroupCols.length === 0) {
        return true;
      }
      var firstRowGroupCol = rowGroupCols[0];
      return firstRowGroupCol.getId() === colDef.showRowGroup;
    };
    GroupCellRendererCtrl2.prototype.isEmbeddedRowMismatch = function() {
      if (!this.params.fullWidth || !this.gridOptionsService.is("embedFullWidthRows")) {
        return false;
      }
      var pinnedLeftCell = this.params.pinned === "left";
      var pinnedRightCell = this.params.pinned === "right";
      var bodyCell = !pinnedLeftCell && !pinnedRightCell;
      if (this.gridOptionsService.is("enableRtl")) {
        if (this.columnModel.isPinningLeft()) {
          return !pinnedRightCell;
        }
        return !bodyCell;
      }
      if (this.columnModel.isPinningLeft()) {
        return !pinnedLeftCell;
      }
      return !bodyCell;
    };
    GroupCellRendererCtrl2.prototype.findDisplayedGroupNode = function() {
      var column = this.params.column;
      var rowNode = this.params.node;
      if (this.showingValueForOpenedParent) {
        var pointer = rowNode.parent;
        while (pointer != null) {
          if (pointer.rowGroupColumn && column.isRowGroupDisplayed(pointer.rowGroupColumn.getId())) {
            this.displayedGroupNode = pointer;
            break;
          }
          pointer = pointer.parent;
        }
      }
      if (missing(this.displayedGroupNode)) {
        this.displayedGroupNode = rowNode;
      }
    };
    GroupCellRendererCtrl2.prototype.setupShowingValueForOpenedParent = function() {
      var rowNode = this.params.node;
      var column = this.params.column;
      if (!this.gridOptionsService.is("groupHideOpenParents")) {
        this.showingValueForOpenedParent = false;
        return;
      }
      if (!rowNode.groupData) {
        this.showingValueForOpenedParent = false;
        return;
      }
      var showingGroupNode = rowNode.rowGroupColumn != null;
      if (showingGroupNode) {
        var keyOfGroupingColumn = rowNode.rowGroupColumn.getId();
        var configuredToShowThisGroupLevel = column.isRowGroupDisplayed(keyOfGroupingColumn);
        if (configuredToShowThisGroupLevel) {
          this.showingValueForOpenedParent = false;
          return;
        }
      }
      var valPresent = rowNode.groupData[column.getId()] != null;
      this.showingValueForOpenedParent = valPresent;
    };
    GroupCellRendererCtrl2.prototype.addValueElement = function() {
      if (this.displayedGroupNode.footer) {
        this.addFooterValue();
      } else {
        this.addGroupValue();
        this.addChildCount();
      }
    };
    GroupCellRendererCtrl2.prototype.addGroupValue = function() {
      var paramsAdjusted = this.adjustParamsWithDetailsFromRelatedColumn();
      var innerCompDetails = this.getInnerCompDetails(paramsAdjusted);
      var valueFormatted = paramsAdjusted.valueFormatted, value = paramsAdjusted.value;
      var valueWhenNoRenderer = valueFormatted;
      if (valueWhenNoRenderer == null) {
        if (value === "" && this.params.node.group) {
          var localeTextFunc = this.localeService.getLocaleTextFunc();
          valueWhenNoRenderer = localeTextFunc("blanks", "(Blanks)");
        } else {
          valueWhenNoRenderer = value !== null && value !== void 0 ? value : null;
        }
      }
      this.comp.setInnerRenderer(innerCompDetails, valueWhenNoRenderer);
    };
    GroupCellRendererCtrl2.prototype.adjustParamsWithDetailsFromRelatedColumn = function() {
      var relatedColumn = this.displayedGroupNode.rowGroupColumn;
      var column = this.params.column;
      if (!relatedColumn) {
        return this.params;
      }
      var notFullWidth = column != null;
      if (notFullWidth) {
        var showingThisRowGroup = column.isRowGroupDisplayed(relatedColumn.getId());
        if (!showingThisRowGroup) {
          return this.params;
        }
      }
      var params = this.params;
      var _a2 = this.params, value = _a2.value, node = _a2.node;
      var valueFormatted = this.valueFormatterService.formatValue(relatedColumn, node, value);
      var paramsAdjusted = __assign$d(__assign$d({}, params), { valueFormatted });
      return paramsAdjusted;
    };
    GroupCellRendererCtrl2.prototype.addFooterValue = function() {
      var footerValueGetter = this.params.footerValueGetter;
      var footerValue = "";
      if (footerValueGetter) {
        var paramsClone = cloneObject(this.params);
        paramsClone.value = this.params.value;
        if (typeof footerValueGetter === "function") {
          footerValue = footerValueGetter(paramsClone);
        } else if (typeof footerValueGetter === "string") {
          footerValue = this.expressionService.evaluate(footerValueGetter, paramsClone);
        } else {
          console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)");
        }
      } else {
        footerValue = "Total " + (this.params.value != null ? this.params.value : "");
      }
      var innerCompDetails = this.getInnerCompDetails(this.params);
      this.comp.setInnerRenderer(innerCompDetails, footerValue);
    };
    GroupCellRendererCtrl2.prototype.getInnerCompDetails = function(params) {
      var _this = this;
      if (params.fullWidth) {
        return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"), params);
      }
      var innerCompDetails = this.userComponentFactory.getInnerRendererDetails(params, params);
      var isGroupRowRenderer = function(details) {
        return details && details.componentClass == _this.compClass;
      };
      if (innerCompDetails && !isGroupRowRenderer(innerCompDetails)) {
        return innerCompDetails;
      }
      var relatedColumn = this.displayedGroupNode.rowGroupColumn;
      var relatedColDef = relatedColumn ? relatedColumn.getColDef() : void 0;
      if (!relatedColDef) {
        return;
      }
      var relatedCompDetails = this.userComponentFactory.getCellRendererDetails(relatedColDef, params);
      if (relatedCompDetails && !isGroupRowRenderer(relatedCompDetails)) {
        return relatedCompDetails;
      }
      if (isGroupRowRenderer(relatedCompDetails) && relatedColDef.cellRendererParams && relatedColDef.cellRendererParams.innerRenderer) {
        var res = this.userComponentFactory.getInnerRendererDetails(relatedColDef.cellRendererParams, params);
        return res;
      }
    };
    GroupCellRendererCtrl2.prototype.addChildCount = function() {
      if (this.params.suppressCount) {
        return;
      }
      this.addManagedListener(this.displayedGroupNode, RowNode2.EVENT_ALL_CHILDREN_COUNT_CHANGED, this.updateChildCount.bind(this));
      this.updateChildCount();
    };
    GroupCellRendererCtrl2.prototype.updateChildCount = function() {
      var allChildrenCount = this.displayedGroupNode.allChildrenCount;
      var showingGroupForThisNode = this.isShowRowGroupForThisRow();
      var showCount = showingGroupForThisNode && allChildrenCount != null && allChildrenCount >= 0;
      var countString = showCount ? "(" + allChildrenCount + ")" : "";
      this.comp.setChildCount(countString);
    };
    GroupCellRendererCtrl2.prototype.isShowRowGroupForThisRow = function() {
      if (this.gridOptionsService.isTreeData()) {
        return true;
      }
      var rowGroupColumn = this.displayedGroupNode.rowGroupColumn;
      if (!rowGroupColumn) {
        return false;
      }
      var column = this.params.column;
      var thisColumnIsInterested = column == null || column.isRowGroupDisplayed(rowGroupColumn.getId());
      return thisColumnIsInterested;
    };
    GroupCellRendererCtrl2.prototype.addExpandAndContract = function() {
      var _a2;
      var params = this.params;
      var eExpandedIcon = createIconNoSpan("groupExpanded", this.gridOptionsService, null);
      var eContractedIcon = createIconNoSpan("groupContracted", this.gridOptionsService, null);
      if (eExpandedIcon) {
        this.eExpanded.appendChild(eExpandedIcon);
      }
      if (eContractedIcon) {
        this.eContracted.appendChild(eContractedIcon);
      }
      var eGroupCell = params.eGridCell;
      var isDoubleClickEdit = ((_a2 = this.params.column) === null || _a2 === void 0 ? void 0 : _a2.isCellEditable(params.node)) && this.gridOptionsService.is("enableGroupEdit");
      if (!isDoubleClickEdit && this.isExpandable() && !params.suppressDoubleClickExpand) {
        this.addManagedListener(eGroupCell, "dblclick", this.onCellDblClicked.bind(this));
      }
      this.addManagedListener(this.eExpanded, "click", this.onExpandClicked.bind(this));
      this.addManagedListener(this.eContracted, "click", this.onExpandClicked.bind(this));
      this.addManagedListener(eGroupCell, "keydown", this.onKeyDown.bind(this));
      this.addManagedListener(params.node, RowNode2.EVENT_EXPANDED_CHANGED, this.showExpandAndContractIcons.bind(this));
      this.showExpandAndContractIcons();
      var expandableChangedListener = this.onRowNodeIsExpandableChanged.bind(this);
      this.addManagedListener(this.displayedGroupNode, RowNode2.EVENT_ALL_CHILDREN_COUNT_CHANGED, expandableChangedListener);
      this.addManagedListener(this.displayedGroupNode, RowNode2.EVENT_MASTER_CHANGED, expandableChangedListener);
      this.addManagedListener(this.displayedGroupNode, RowNode2.EVENT_GROUP_CHANGED, expandableChangedListener);
      this.addManagedListener(this.displayedGroupNode, RowNode2.EVENT_HAS_CHILDREN_CHANGED, expandableChangedListener);
    };
    GroupCellRendererCtrl2.prototype.onExpandClicked = function(mouseEvent) {
      if (isStopPropagationForAgGrid(mouseEvent)) {
        return;
      }
      stopPropagationForAgGrid(mouseEvent);
      this.onExpandOrContract(mouseEvent);
    };
    GroupCellRendererCtrl2.prototype.onExpandOrContract = function(e) {
      var rowNode = this.displayedGroupNode;
      var nextExpandState = !rowNode.expanded;
      if (!nextExpandState && rowNode.sticky) {
        this.scrollToStickyNode(rowNode);
      }
      rowNode.setExpanded(nextExpandState, e);
    };
    GroupCellRendererCtrl2.prototype.scrollToStickyNode = function(rowNode) {
      var gridBodyCtrl = this.ctrlsService.getGridBodyCtrl();
      var scrollFeature = gridBodyCtrl.getScrollFeature();
      scrollFeature.setVerticalScrollPosition(rowNode.rowTop - rowNode.stickyRowTop);
    };
    GroupCellRendererCtrl2.prototype.isExpandable = function() {
      if (this.showingValueForOpenedParent) {
        return true;
      }
      var rowNode = this.displayedGroupNode;
      var reducedLeafNode = this.columnModel.isPivotMode() && rowNode.leafGroup;
      var expandableGroup = rowNode.isExpandable() && !rowNode.footer && !reducedLeafNode;
      if (!expandableGroup) {
        return false;
      }
      var column = this.params.column;
      var displayingForOneColumnOnly = column != null && typeof column.getColDef().showRowGroup === "string";
      if (displayingForOneColumnOnly) {
        var showing = this.isShowRowGroupForThisRow();
        return showing;
      }
      return true;
    };
    GroupCellRendererCtrl2.prototype.showExpandAndContractIcons = function() {
      var _a2 = this, params = _a2.params, displayedGroup = _a2.displayedGroupNode, columnModel = _a2.columnModel;
      var node = params.node;
      var isExpandable = this.isExpandable();
      if (isExpandable) {
        var expanded = this.showingValueForOpenedParent ? true : node.expanded;
        this.comp.setExpandedDisplayed(expanded);
        this.comp.setContractedDisplayed(!expanded);
      } else {
        this.comp.setExpandedDisplayed(false);
        this.comp.setContractedDisplayed(false);
      }
      var pivotMode = columnModel.isPivotMode();
      var pivotModeAndLeafGroup = pivotMode && displayedGroup.leafGroup;
      var addExpandableCss = isExpandable && !pivotModeAndLeafGroup;
      var isTotalFooterNode = node.footer && node.level === -1;
      this.comp.addOrRemoveCssClass("ag-cell-expandable", addExpandableCss);
      this.comp.addOrRemoveCssClass("ag-row-group", addExpandableCss);
      if (pivotMode) {
        this.comp.addOrRemoveCssClass("ag-pivot-leaf-group", pivotModeAndLeafGroup);
      } else if (!isTotalFooterNode) {
        this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent", !addExpandableCss);
      }
    };
    GroupCellRendererCtrl2.prototype.onRowNodeIsExpandableChanged = function() {
      this.showExpandAndContractIcons();
      this.setIndent();
      this.refreshAriaExpanded();
    };
    GroupCellRendererCtrl2.prototype.setupIndent = function() {
      var node = this.params.node;
      var suppressPadding = this.params.suppressPadding;
      if (!suppressPadding) {
        this.addManagedListener(node, RowNode2.EVENT_UI_LEVEL_CHANGED, this.setIndent.bind(this));
        this.setIndent();
      }
    };
    GroupCellRendererCtrl2.prototype.setIndent = function() {
      if (this.gridOptionsService.is("groupHideOpenParents")) {
        return;
      }
      var params = this.params;
      var rowNode = params.node;
      var fullWithRow = !!params.colDef;
      var treeData = this.gridOptionsService.isTreeData();
      var manyDimensionThisColumn = !fullWithRow || treeData || params.colDef.showRowGroup === true;
      var paddingCount = manyDimensionThisColumn ? rowNode.uiLevel : 0;
      if (this.indentClass) {
        this.comp.addOrRemoveCssClass(this.indentClass, false);
      }
      this.indentClass = "ag-row-group-indent-" + paddingCount;
      this.comp.addOrRemoveCssClass(this.indentClass, true);
    };
    GroupCellRendererCtrl2.prototype.addFullWidthRowDraggerIfNeeded = function() {
      var _this = this;
      if (!this.params.fullWidth || !this.params.rowDrag) {
        return;
      }
      var rowDragComp = new RowDragComp(function() {
        return _this.params.value;
      }, this.params.node);
      this.createManagedBean(rowDragComp, this.context);
      this.eGui.insertAdjacentElement("afterbegin", rowDragComp.getGui());
    };
    GroupCellRendererCtrl2.prototype.isUserWantsSelected = function() {
      var paramsCheckbox = this.params.checkbox;
      return typeof paramsCheckbox === "function" || paramsCheckbox === true;
    };
    GroupCellRendererCtrl2.prototype.addCheckboxIfNeeded = function() {
      var _this = this;
      var rowNode = this.displayedGroupNode;
      var checkboxNeeded = this.isUserWantsSelected() && // footers cannot be selected
      !rowNode.footer && // pinned rows cannot be selected
      !rowNode.rowPinned && // details cannot be selected
      !rowNode.detail;
      if (checkboxNeeded) {
        var cbSelectionComponent_1 = new CheckboxSelectionComponent();
        this.getContext().createBean(cbSelectionComponent_1);
        cbSelectionComponent_1.init({
          rowNode,
          column: this.params.column,
          overrides: {
            isVisible: this.params.checkbox,
            callbackParams: this.params,
            removeHidden: true
          }
        });
        this.eCheckbox.appendChild(cbSelectionComponent_1.getGui());
        this.addDestroyFunc(function() {
          return _this.getContext().destroyBean(cbSelectionComponent_1);
        });
      }
      this.comp.setCheckboxVisible(checkboxNeeded);
    };
    GroupCellRendererCtrl2.prototype.onKeyDown = function(event) {
      var isEnterKey = event.key === KeyCode.ENTER;
      if (!isEnterKey || this.params.suppressEnterExpand) {
        return;
      }
      var cellEditable = this.params.column && this.params.column.isCellEditable(this.params.node);
      if (cellEditable) {
        return;
      }
      this.onExpandOrContract(event);
    };
    GroupCellRendererCtrl2.prototype.onCellDblClicked = function(mouseEvent) {
      if (isStopPropagationForAgGrid(mouseEvent)) {
        return;
      }
      var targetIsExpandIcon = isElementInEventPath(this.eExpanded, mouseEvent) || isElementInEventPath(this.eContracted, mouseEvent);
      if (!targetIsExpandIcon) {
        this.onExpandOrContract(mouseEvent);
      }
    };
    __decorate$22([
      Autowired("expressionService")
    ], GroupCellRendererCtrl2.prototype, "expressionService", void 0);
    __decorate$22([
      Autowired("valueFormatterService")
    ], GroupCellRendererCtrl2.prototype, "valueFormatterService", void 0);
    __decorate$22([
      Autowired("columnModel")
    ], GroupCellRendererCtrl2.prototype, "columnModel", void 0);
    __decorate$22([
      Autowired("userComponentFactory")
    ], GroupCellRendererCtrl2.prototype, "userComponentFactory", void 0);
    __decorate$22([
      Autowired("ctrlsService")
    ], GroupCellRendererCtrl2.prototype, "ctrlsService", void 0);
    return GroupCellRendererCtrl2;
  }(BeanStub)
);
var __extends$2g = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$21 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GroupCellRenderer$1 = (
  /** @class */
  function(_super) {
    __extends$2g(GroupCellRenderer2, _super);
    function GroupCellRenderer2() {
      return _super.call(this, GroupCellRenderer2.TEMPLATE) || this;
    }
    GroupCellRenderer2.prototype.init = function(params) {
      var _this = this;
      var compProxy = {
        setInnerRenderer: function(compDetails, valueToDisplay) {
          return _this.setRenderDetails(compDetails, valueToDisplay);
        },
        setChildCount: function(count) {
          return _this.eChildCount.innerHTML = count;
        },
        addOrRemoveCssClass: function(cssClass, value) {
          return _this.addOrRemoveCssClass(cssClass, value);
        },
        setContractedDisplayed: function(expanded) {
          return setDisplayed(_this.eContracted, expanded);
        },
        setExpandedDisplayed: function(expanded) {
          return setDisplayed(_this.eExpanded, expanded);
        },
        setCheckboxVisible: function(visible) {
          return _this.eCheckbox.classList.toggle("ag-invisible", !visible);
        }
      };
      var ctrl = this.createManagedBean(new GroupCellRendererCtrl());
      var fullWidth = !params.colDef;
      var eGui = this.getGui();
      ctrl.init(compProxy, eGui, this.eCheckbox, this.eExpanded, this.eContracted, this.constructor, params);
      if (fullWidth) {
        setAriaRole(eGui, "gridcell");
      }
    };
    GroupCellRenderer2.prototype.setRenderDetails = function(compDetails, valueToDisplay) {
      var _this = this;
      if (compDetails) {
        var componentPromise = compDetails.newAgStackInstance();
        if (!componentPromise) {
          return;
        }
        componentPromise.then(function(comp) {
          if (!comp) {
            return;
          }
          var destroyComp = function() {
            return _this.context.destroyBean(comp);
          };
          if (_this.isAlive()) {
            _this.eValue.appendChild(comp.getGui());
            _this.addDestroyFunc(destroyComp);
          } else {
            destroyComp();
          }
        });
      } else {
        this.eValue.innerText = valueToDisplay;
      }
    };
    GroupCellRenderer2.prototype.destroy = function() {
      this.getContext().destroyBean(this.innerCellRenderer);
      _super.prototype.destroy.call(this);
    };
    GroupCellRenderer2.prototype.refresh = function() {
      return false;
    };
    GroupCellRenderer2.TEMPLATE = '<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>';
    __decorate$21([
      RefSelector("eExpanded")
    ], GroupCellRenderer2.prototype, "eExpanded", void 0);
    __decorate$21([
      RefSelector("eContracted")
    ], GroupCellRenderer2.prototype, "eContracted", void 0);
    __decorate$21([
      RefSelector("eCheckbox")
    ], GroupCellRenderer2.prototype, "eCheckbox", void 0);
    __decorate$21([
      RefSelector("eValue")
    ], GroupCellRenderer2.prototype, "eValue", void 0);
    __decorate$21([
      RefSelector("eChildCount")
    ], GroupCellRenderer2.prototype, "eChildCount", void 0);
    return GroupCellRenderer2;
  }(Component)
);
var __extends$2f = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$20 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var LoadingCellRenderer = (
  /** @class */
  function(_super) {
    __extends$2f(LoadingCellRenderer2, _super);
    function LoadingCellRenderer2() {
      return _super.call(this, LoadingCellRenderer2.TEMPLATE) || this;
    }
    LoadingCellRenderer2.prototype.init = function(params) {
      params.node.failedLoad ? this.setupFailed() : this.setupLoading();
    };
    LoadingCellRenderer2.prototype.setupFailed = function() {
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      this.eLoadingText.innerText = localeTextFunc("loadingError", "ERR");
    };
    LoadingCellRenderer2.prototype.setupLoading = function() {
      var eLoadingIcon = createIconNoSpan("groupLoading", this.gridOptionsService, null);
      if (eLoadingIcon) {
        this.eLoadingIcon.appendChild(eLoadingIcon);
      }
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      this.eLoadingText.innerText = localeTextFunc("loadingOoo", "Loading");
    };
    LoadingCellRenderer2.prototype.refresh = function(params) {
      return false;
    };
    LoadingCellRenderer2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    LoadingCellRenderer2.TEMPLATE = '<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>';
    __decorate$20([
      RefSelector("eLoadingIcon")
    ], LoadingCellRenderer2.prototype, "eLoadingIcon", void 0);
    __decorate$20([
      RefSelector("eLoadingText")
    ], LoadingCellRenderer2.prototype, "eLoadingText", void 0);
    return LoadingCellRenderer2;
  }(Component)
);
var __extends$2e = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var LoadingOverlayComponent$1 = (
  /** @class */
  function(_super) {
    __extends$2e(LoadingOverlayComponent2, _super);
    function LoadingOverlayComponent2() {
      return _super.call(this) || this;
    }
    LoadingOverlayComponent2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    LoadingOverlayComponent2.prototype.init = function(params) {
      var _a2;
      var template = (_a2 = this.gridOptionsService.get("overlayLoadingTemplate")) !== null && _a2 !== void 0 ? _a2 : LoadingOverlayComponent2.DEFAULT_LOADING_OVERLAY_TEMPLATE;
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      var localisedTemplate = template.replace("[LOADING...]", localeTextFunc("loadingOoo", "Loading..."));
      this.setTemplate(localisedTemplate);
    };
    LoadingOverlayComponent2.DEFAULT_LOADING_OVERLAY_TEMPLATE = '<span class="ag-overlay-loading-center">[LOADING...]</span>';
    return LoadingOverlayComponent2;
  }(Component)
);
var __extends$2d = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var NoRowsOverlayComponent$1 = (
  /** @class */
  function(_super) {
    __extends$2d(NoRowsOverlayComponent2, _super);
    function NoRowsOverlayComponent2() {
      return _super.call(this) || this;
    }
    NoRowsOverlayComponent2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    NoRowsOverlayComponent2.prototype.init = function(params) {
      var _a2;
      var template = (_a2 = this.gridOptionsService.get("overlayNoRowsTemplate")) !== null && _a2 !== void 0 ? _a2 : NoRowsOverlayComponent2.DEFAULT_NO_ROWS_TEMPLATE;
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      var localisedTemplate = template.replace("[NO_ROWS_TO_SHOW]", localeTextFunc("noRowsToShow", "No Rows To Show"));
      this.setTemplate(localisedTemplate);
    };
    NoRowsOverlayComponent2.DEFAULT_NO_ROWS_TEMPLATE = '<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>';
    return NoRowsOverlayComponent2;
  }(Component)
);
var __extends$2c = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var TooltipComponent$1 = (
  /** @class */
  function(_super) {
    __extends$2c(TooltipComponent2, _super);
    function TooltipComponent2() {
      return _super.call(
        this,
        /* html */
        '<div class="ag-tooltip"></div>'
      ) || this;
    }
    TooltipComponent2.prototype.init = function(params) {
      var value = params.value;
      this.getGui().innerHTML = escapeString(value);
    };
    return TooltipComponent2;
  }(PopupComponent)
);
var __extends$2b = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var NumberCellEditorInput = (
  /** @class */
  function() {
    function NumberCellEditorInput2() {
    }
    NumberCellEditorInput2.prototype.getTemplate = function() {
      return (
        /* html */
        '<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'
      );
    };
    NumberCellEditorInput2.prototype.init = function(eInput, params) {
      this.eInput = eInput;
      this.params = params;
      if (params.max != null) {
        eInput.setMax(params.max);
      }
      if (params.min != null) {
        eInput.setMin(params.min);
      }
      if (params.precision != null) {
        eInput.setPrecision(params.precision);
      }
      if (params.step != null) {
        eInput.setStep(params.step);
      }
      if (params.showStepperButtons) {
        eInput.getInputElement().classList.add("ag-number-field-input-stepper");
      }
    };
    NumberCellEditorInput2.prototype.getValue = function() {
      var value = this.eInput.getValue();
      if (!exists(value) && !exists(this.params.value)) {
        return this.params.value;
      }
      var parsedValue = this.params.parseValue(value);
      if (parsedValue == null) {
        return parsedValue;
      }
      if (typeof parsedValue === "string") {
        if (parsedValue === "") {
          return null;
        }
        parsedValue = Number(parsedValue);
      }
      return isNaN(parsedValue) ? null : parsedValue;
    };
    NumberCellEditorInput2.prototype.getStartValue = function() {
      return this.params.value;
    };
    return NumberCellEditorInput2;
  }()
);
var NumberCellEditor = (
  /** @class */
  function(_super) {
    __extends$2b(NumberCellEditor2, _super);
    function NumberCellEditor2() {
      return _super.call(this, new NumberCellEditorInput()) || this;
    }
    return NumberCellEditor2;
  }(SimpleCellEditor)
);
var __extends$2a = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var DateCellEditorInput = (
  /** @class */
  function() {
    function DateCellEditorInput2() {
    }
    DateCellEditorInput2.prototype.getTemplate = function() {
      return (
        /* html */
        '<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'
      );
    };
    DateCellEditorInput2.prototype.init = function(eInput, params) {
      this.eInput = eInput;
      this.params = params;
      if (params.min != null) {
        eInput.setMin(params.min);
      }
      if (params.max != null) {
        eInput.setMax(params.max);
      }
      if (params.step != null) {
        eInput.setStep(params.step);
      }
    };
    DateCellEditorInput2.prototype.getValue = function() {
      var value = this.eInput.getDate();
      if (!exists(value) && !exists(this.params.value)) {
        return this.params.value;
      }
      return value !== null && value !== void 0 ? value : null;
    };
    DateCellEditorInput2.prototype.getStartValue = function() {
      var value = this.params.value;
      if (!(value instanceof Date)) {
        return void 0;
      }
      return serialiseDate(value, false);
    };
    return DateCellEditorInput2;
  }()
);
var DateCellEditor = (
  /** @class */
  function(_super) {
    __extends$2a(DateCellEditor2, _super);
    function DateCellEditor2() {
      return _super.call(this, new DateCellEditorInput()) || this;
    }
    return DateCellEditor2;
  }(SimpleCellEditor)
);
var __extends$29 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1$ = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DateStringCellEditorInput = (
  /** @class */
  function() {
    function DateStringCellEditorInput2(getDataTypeService) {
      this.getDataTypeService = getDataTypeService;
    }
    DateStringCellEditorInput2.prototype.getTemplate = function() {
      return (
        /* html */
        '<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'
      );
    };
    DateStringCellEditorInput2.prototype.init = function(eInput, params) {
      this.eInput = eInput;
      this.params = params;
      if (params.min != null) {
        eInput.setMin(params.min);
      }
      if (params.max != null) {
        eInput.setMax(params.max);
      }
      if (params.step != null) {
        eInput.setStep(params.step);
      }
    };
    DateStringCellEditorInput2.prototype.getValue = function() {
      var value = this.formatDate(this.eInput.getDate());
      if (!exists(value) && !exists(this.params.value)) {
        return this.params.value;
      }
      return this.params.parseValue(value !== null && value !== void 0 ? value : "");
    };
    DateStringCellEditorInput2.prototype.getStartValue = function() {
      var _a2, _b2;
      return serialiseDate((_b2 = this.parseDate((_a2 = this.params.value) !== null && _a2 !== void 0 ? _a2 : void 0)) !== null && _b2 !== void 0 ? _b2 : null, false);
    };
    DateStringCellEditorInput2.prototype.parseDate = function(value) {
      return this.getDataTypeService().getDateParserFunction()(value);
    };
    DateStringCellEditorInput2.prototype.formatDate = function(value) {
      return this.getDataTypeService().getDateFormatterFunction()(value);
    };
    return DateStringCellEditorInput2;
  }()
);
var DateStringCellEditor = (
  /** @class */
  function(_super) {
    __extends$29(DateStringCellEditor2, _super);
    function DateStringCellEditor2() {
      var _this = _super.call(this, new DateStringCellEditorInput(function() {
        return _this.dataTypeService;
      })) || this;
      return _this;
    }
    __decorate$1$([
      Autowired("dataTypeService")
    ], DateStringCellEditor2.prototype, "dataTypeService", void 0);
    return DateStringCellEditor2;
  }(SimpleCellEditor)
);
var __extends$28 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1_ = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var CheckboxCellRenderer = (
  /** @class */
  function(_super) {
    __extends$28(CheckboxCellRenderer2, _super);
    function CheckboxCellRenderer2() {
      return _super.call(this, CheckboxCellRenderer2.TEMPLATE) || this;
    }
    CheckboxCellRenderer2.prototype.init = function(params) {
      var _this = this;
      this.params = params;
      this.updateCheckbox(params);
      this.eCheckbox.getInputElement().setAttribute("tabindex", "-1");
      this.addManagedListener(this.eCheckbox.getInputElement(), "click", function(event) {
        stopPropagationForAgGrid(event);
        if (_this.eCheckbox.isDisabled()) {
          return;
        }
        var isSelected = _this.eCheckbox.getValue();
        _this.onCheckboxChanged(isSelected);
      });
      this.addManagedListener(this.eCheckbox.getInputElement(), "dblclick", function(event) {
        stopPropagationForAgGrid(event);
      });
      var eDocument = this.gridOptionsService.getDocument();
      this.addManagedListener(this.params.eGridCell, "keydown", function(event) {
        if (event.key === KeyCode.SPACE && !_this.eCheckbox.isDisabled()) {
          if (_this.params.eGridCell === eDocument.activeElement) {
            _this.eCheckbox.toggle();
          }
          var isSelected = _this.eCheckbox.getValue();
          _this.onCheckboxChanged(isSelected);
          event.preventDefault();
        }
      });
    };
    CheckboxCellRenderer2.prototype.refresh = function(params) {
      this.params = params;
      this.updateCheckbox(params);
      return true;
    };
    CheckboxCellRenderer2.prototype.updateCheckbox = function(params) {
      var _a2, _b2, _c;
      var isSelected;
      var displayed = true;
      if (params.node.group && params.column) {
        var colId = params.column.getColId();
        if (colId.startsWith(GROUP_AUTO_COLUMN_ID)) {
          isSelected = params.value == null || params.value === "" ? void 0 : params.value === "true";
        } else if (params.node.aggData && params.node.aggData[colId] !== void 0) {
          isSelected = (_a2 = params.value) !== null && _a2 !== void 0 ? _a2 : void 0;
        } else {
          displayed = false;
        }
      } else {
        isSelected = (_b2 = params.value) !== null && _b2 !== void 0 ? _b2 : void 0;
      }
      if (!displayed) {
        this.eCheckbox.setDisplayed(false);
        return;
      }
      this.eCheckbox.setValue(isSelected);
      var disabled = params.disabled != null ? params.disabled : !((_c = params.column) === null || _c === void 0 ? void 0 : _c.isCellEditable(params.node));
      this.eCheckbox.setDisabled(disabled);
      var translate = this.localeService.getLocaleTextFunc();
      var stateName = getAriaCheckboxStateName(translate, isSelected);
      var ariaLabel = disabled ? stateName : translate("ariaToggleCellValue", "Press SPACE to toggle cell value") + " (" + stateName + ")";
      this.eCheckbox.setInputAriaLabel(ariaLabel);
    };
    CheckboxCellRenderer2.prototype.onCheckboxChanged = function(isSelected) {
      var _a2 = this.params, column = _a2.column, node = _a2.node, rowIndex = _a2.rowIndex, value = _a2.value;
      var eventStarted = {
        type: Events.EVENT_CELL_EDITING_STARTED,
        column,
        colDef: column === null || column === void 0 ? void 0 : column.getColDef(),
        data: node.data,
        node,
        rowIndex,
        rowPinned: node.rowPinned,
        value
      };
      this.eventService.dispatchEvent(eventStarted);
      var valueChanged = this.params.node.setDataValue(this.params.column, isSelected, "edit");
      var eventStopped = {
        type: Events.EVENT_CELL_EDITING_STOPPED,
        column,
        colDef: column === null || column === void 0 ? void 0 : column.getColDef(),
        data: node.data,
        node,
        rowIndex,
        rowPinned: node.rowPinned,
        value,
        oldValue: value,
        newValue: isSelected,
        valueChanged
      };
      this.eventService.dispatchEvent(eventStopped);
    };
    CheckboxCellRenderer2.TEMPLATE = '\n        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n        </div>';
    __decorate$1_([
      RefSelector("eCheckbox")
    ], CheckboxCellRenderer2.prototype, "eCheckbox", void 0);
    return CheckboxCellRenderer2;
  }(Component)
);
var __extends$27 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1Z = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var CheckboxCellEditor = (
  /** @class */
  function(_super) {
    __extends$27(CheckboxCellEditor2, _super);
    function CheckboxCellEditor2() {
      return _super.call(
        this,
        /* html */
        '\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>'
      ) || this;
    }
    CheckboxCellEditor2.prototype.init = function(params) {
      var _this = this;
      var _a2;
      this.params = params;
      var isSelected = (_a2 = params.value) !== null && _a2 !== void 0 ? _a2 : void 0;
      this.eCheckbox.setValue(isSelected);
      this.eCheckbox.getInputElement().setAttribute("tabindex", "-1");
      this.setAriaLabel(isSelected);
      this.addManagedListener(this.eCheckbox, AgCheckbox.EVENT_CHANGED, function(event) {
        return _this.setAriaLabel(event.selected);
      });
    };
    CheckboxCellEditor2.prototype.getValue = function() {
      return this.eCheckbox.getValue();
    };
    CheckboxCellEditor2.prototype.focusIn = function() {
      this.eCheckbox.getFocusableElement().focus();
    };
    CheckboxCellEditor2.prototype.afterGuiAttached = function() {
      if (this.params.cellStartedEdit) {
        this.focusIn();
      }
    };
    CheckboxCellEditor2.prototype.isPopup = function() {
      return false;
    };
    CheckboxCellEditor2.prototype.setAriaLabel = function(isSelected) {
      var translate = this.localeService.getLocaleTextFunc();
      var stateName = getAriaCheckboxStateName(translate, isSelected);
      var ariaLabel = translate("ariaToggleCellValue", "Press SPACE to toggle cell value");
      this.eCheckbox.setInputAriaLabel(ariaLabel + " (" + stateName + ")");
    };
    __decorate$1Z([
      RefSelector("eCheckbox")
    ], CheckboxCellEditor2.prototype, "eCheckbox", void 0);
    return CheckboxCellEditor2;
  }(PopupComponent)
);
var __extends$26 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1Y = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$n = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$j = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var UserComponentRegistry = (
  /** @class */
  function(_super) {
    __extends$26(UserComponentRegistry2, _super);
    function UserComponentRegistry2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.agGridDefaults = {
        //date
        agDateInput: DefaultDateComponent,
        //header
        agColumnHeader: HeaderComp,
        agColumnGroupHeader: HeaderGroupComp,
        agSortIndicator: SortIndicatorComp,
        //floating filters
        agTextColumnFloatingFilter: TextFloatingFilter,
        agNumberColumnFloatingFilter: NumberFloatingFilter,
        agDateColumnFloatingFilter: DateFloatingFilter,
        agReadOnlyFloatingFilter: ReadOnlyFloatingFilter,
        // renderers
        agAnimateShowChangeCellRenderer: AnimateShowChangeCellRenderer,
        agAnimateSlideCellRenderer: AnimateSlideCellRenderer,
        agGroupCellRenderer: GroupCellRenderer$1,
        agGroupRowRenderer: GroupCellRenderer$1,
        agLoadingCellRenderer: LoadingCellRenderer,
        agCheckboxCellRenderer: CheckboxCellRenderer,
        //editors
        agCellEditor: TextCellEditor,
        agTextCellEditor: TextCellEditor,
        agNumberCellEditor: NumberCellEditor,
        agDateCellEditor: DateCellEditor,
        agDateStringCellEditor: DateStringCellEditor,
        agSelectCellEditor: SelectCellEditor,
        agLargeTextCellEditor: LargeTextCellEditor,
        agCheckboxCellEditor: CheckboxCellEditor,
        //filter
        agTextColumnFilter: TextFilter,
        agNumberColumnFilter: NumberFilter,
        agDateColumnFilter: DateFilter,
        //overlays
        agLoadingOverlay: LoadingOverlayComponent$1,
        agNoRowsOverlay: NoRowsOverlayComponent$1,
        // tooltips
        agTooltipComponent: TooltipComponent$1
      };
      _this.enterpriseAgDefaultCompsModule = {
        agSetColumnFilter: ModuleNames.SetFilterModule,
        agSetColumnFloatingFilter: ModuleNames.SetFilterModule,
        agMultiColumnFilter: ModuleNames.MultiFilterModule,
        agMultiColumnFloatingFilter: ModuleNames.MultiFilterModule,
        agGroupColumnFilter: ModuleNames.RowGroupingModule,
        agGroupColumnFloatingFilter: ModuleNames.RowGroupingModule,
        agRichSelect: ModuleNames.RichSelectModule,
        agRichSelectCellEditor: ModuleNames.RichSelectModule,
        agDetailCellRenderer: ModuleNames.MasterDetailModule,
        agSparklineCellRenderer: ModuleNames.SparklinesModule
      };
      _this.jsComps = {};
      return _this;
    }
    UserComponentRegistry2.prototype.init = function() {
      var _this = this;
      if (this.gridOptions.components != null) {
        iterateObject(this.gridOptions.components, function(key, component) {
          return _this.registerJsComponent(key, component);
        });
      }
    };
    UserComponentRegistry2.prototype.registerDefaultComponent = function(name, component) {
      if (this.agGridDefaults[name]) {
        console.error("Trying to overwrite a default component. You should call registerComponent");
        return;
      }
      this.agGridDefaults[name] = component;
    };
    UserComponentRegistry2.prototype.registerJsComponent = function(name, component) {
      this.jsComps[name] = component;
    };
    UserComponentRegistry2.prototype.retrieve = function(propertyName, name) {
      var _this = this;
      var createResult = function(component, componentFromFramework) {
        return { componentFromFramework, component };
      };
      var registeredViaFrameworkComp = this.getFrameworkOverrides().frameworkComponent(name, this.gridOptions.components);
      if (registeredViaFrameworkComp != null) {
        return createResult(registeredViaFrameworkComp, true);
      }
      var jsComponent = this.jsComps[name];
      if (jsComponent) {
        var isFwkComp = this.getFrameworkOverrides().isFrameworkComponent(jsComponent);
        return createResult(jsComponent, isFwkComp);
      }
      var defaultComponent = this.agGridDefaults[name];
      if (defaultComponent) {
        return createResult(defaultComponent, false);
      }
      var moduleForComponent = this.enterpriseAgDefaultCompsModule[name];
      if (moduleForComponent) {
        ModuleRegistry.__assertRegistered(moduleForComponent, "AG Grid '" + propertyName + "' component: " + name, this.context.getGridId());
      } else {
        doOnce(function() {
          _this.warnAboutMissingComponent(propertyName, name);
        }, "MissingComp" + name);
      }
      return null;
    };
    UserComponentRegistry2.prototype.warnAboutMissingComponent = function(propertyName, componentName) {
      var validComponents = __spreadArray$j(__spreadArray$j([], __read$n(Object.keys(this.agGridDefaults).filter(function(k2) {
        return !["agCellEditor", "agGroupRowRenderer", "agSortIndicator"].includes(k2);
      }))), __read$n(Object.keys(this.jsComps)));
      var suggestions = fuzzySuggestions(componentName, validComponents, true, 0.8);
      console.warn("AG Grid: Could not find '" + componentName + `' component. It was configured as "` + propertyName + ": '" + componentName + `'" but it wasn't found in the list of registered components.`);
      if (suggestions.length > 0) {
        console.warn("         Did you mean: [" + suggestions.slice(0, 3) + "]?");
      }
      console.warn("If using a custom component check it has been registered as described in: https://ag-grid.com/javascript-data-grid/components/");
    };
    __decorate$1Y([
      Autowired("gridOptions")
    ], UserComponentRegistry2.prototype, "gridOptions", void 0);
    __decorate$1Y([
      PostConstruct
    ], UserComponentRegistry2.prototype, "init", null);
    UserComponentRegistry2 = __decorate$1Y([
      Bean("userComponentRegistry")
    ], UserComponentRegistry2);
    return UserComponentRegistry2;
  }(BeanStub)
);
var DateComponent = {
  propertyName: "dateComponent",
  cellRenderer: false
};
var HeaderComponent = {
  propertyName: "headerComponent",
  cellRenderer: false
};
var HeaderGroupComponent = {
  propertyName: "headerGroupComponent",
  cellRenderer: false
};
var CellRendererComponent = {
  propertyName: "cellRenderer",
  cellRenderer: true
};
var CellEditorComponent = {
  propertyName: "cellEditor",
  cellRenderer: false
};
var InnerRendererComponent = {
  propertyName: "innerRenderer",
  cellRenderer: true
};
var LoadingOverlayComponent = {
  propertyName: "loadingOverlayComponent",
  cellRenderer: false
};
var NoRowsOverlayComponent = {
  propertyName: "noRowsOverlayComponent",
  cellRenderer: false
};
var TooltipComponent = {
  propertyName: "tooltipComponent",
  cellRenderer: false
};
var FilterComponent = {
  propertyName: "filter",
  cellRenderer: false
};
var FloatingFilterComponent = {
  propertyName: "floatingFilterComponent",
  cellRenderer: false
};
var ToolPanelComponent = {
  propertyName: "toolPanel",
  cellRenderer: false
};
var StatusPanelComponent = {
  propertyName: "statusPanel",
  cellRenderer: false
};
var FullWidth = {
  propertyName: "fullWidthCellRenderer",
  cellRenderer: true
};
var FullWidthLoading = {
  propertyName: "loadingCellRenderer",
  cellRenderer: true
};
var FullWidthGroup = {
  propertyName: "groupRowRenderer",
  cellRenderer: true
};
var FullWidthDetail = {
  propertyName: "detailCellRenderer",
  cellRenderer: true
};
var FloatingFilterMapper = (
  /** @class */
  function() {
    function FloatingFilterMapper2() {
    }
    FloatingFilterMapper2.getFloatingFilterType = function(filterType) {
      return this.filterToFloatingFilterMapping[filterType];
    };
    FloatingFilterMapper2.filterToFloatingFilterMapping = {
      set: "agSetColumnFloatingFilter",
      agSetColumnFilter: "agSetColumnFloatingFilter",
      multi: "agMultiColumnFloatingFilter",
      agMultiColumnFilter: "agMultiColumnFloatingFilter",
      group: "agGroupColumnFloatingFilter",
      agGroupColumnFilter: "agGroupColumnFloatingFilter",
      number: "agNumberColumnFloatingFilter",
      agNumberColumnFilter: "agNumberColumnFloatingFilter",
      date: "agDateColumnFloatingFilter",
      agDateColumnFilter: "agDateColumnFloatingFilter",
      text: "agTextColumnFloatingFilter",
      agTextColumnFilter: "agTextColumnFloatingFilter"
    };
    return FloatingFilterMapper2;
  }()
);
var __extends$25 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1X = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var UserComponentFactory = (
  /** @class */
  function(_super) {
    __extends$25(UserComponentFactory2, _super);
    function UserComponentFactory2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    UserComponentFactory2.prototype.getHeaderCompDetails = function(colDef, params) {
      return this.getCompDetails(colDef, HeaderComponent, "agColumnHeader", params);
    };
    UserComponentFactory2.prototype.getHeaderGroupCompDetails = function(params) {
      var colGroupDef = params.columnGroup.getColGroupDef();
      return this.getCompDetails(colGroupDef, HeaderGroupComponent, "agColumnGroupHeader", params);
    };
    UserComponentFactory2.prototype.getFullWidthCellRendererDetails = function(params) {
      return this.getCompDetails(this.gridOptions, FullWidth, null, params, true);
    };
    UserComponentFactory2.prototype.getFullWidthLoadingCellRendererDetails = function(params) {
      return this.getCompDetails(this.gridOptions, FullWidthLoading, "agLoadingCellRenderer", params, true);
    };
    UserComponentFactory2.prototype.getFullWidthGroupCellRendererDetails = function(params) {
      return this.getCompDetails(this.gridOptions, FullWidthGroup, "agGroupRowRenderer", params, true);
    };
    UserComponentFactory2.prototype.getFullWidthDetailCellRendererDetails = function(params) {
      return this.getCompDetails(this.gridOptions, FullWidthDetail, "agDetailCellRenderer", params, true);
    };
    UserComponentFactory2.prototype.getInnerRendererDetails = function(def, params) {
      return this.getCompDetails(def, InnerRendererComponent, null, params);
    };
    UserComponentFactory2.prototype.getFullWidthGroupRowInnerCellRenderer = function(def, params) {
      return this.getCompDetails(def, InnerRendererComponent, null, params);
    };
    UserComponentFactory2.prototype.getCellRendererDetails = function(def, params) {
      return this.getCompDetails(def, CellRendererComponent, null, params);
    };
    UserComponentFactory2.prototype.getCellEditorDetails = function(def, params) {
      return this.getCompDetails(def, CellEditorComponent, "agCellEditor", params, true);
    };
    UserComponentFactory2.prototype.getFilterDetails = function(def, params, defaultFilter) {
      return this.getCompDetails(def, FilterComponent, defaultFilter, params, true);
    };
    UserComponentFactory2.prototype.getDateCompDetails = function(params) {
      return this.getCompDetails(this.gridOptions, DateComponent, "agDateInput", params, true);
    };
    UserComponentFactory2.prototype.getLoadingOverlayCompDetails = function(params) {
      return this.getCompDetails(this.gridOptions, LoadingOverlayComponent, "agLoadingOverlay", params, true);
    };
    UserComponentFactory2.prototype.getNoRowsOverlayCompDetails = function(params) {
      return this.getCompDetails(this.gridOptions, NoRowsOverlayComponent, "agNoRowsOverlay", params, true);
    };
    UserComponentFactory2.prototype.getTooltipCompDetails = function(params) {
      return this.getCompDetails(params.colDef, TooltipComponent, "agTooltipComponent", params, true);
    };
    UserComponentFactory2.prototype.getSetFilterCellRendererDetails = function(def, params) {
      return this.getCompDetails(def, CellRendererComponent, null, params);
    };
    UserComponentFactory2.prototype.getFloatingFilterCompDetails = function(def, params, defaultFloatingFilter) {
      return this.getCompDetails(def, FloatingFilterComponent, defaultFloatingFilter, params);
    };
    UserComponentFactory2.prototype.getToolPanelCompDetails = function(toolPanelDef, params) {
      return this.getCompDetails(toolPanelDef, ToolPanelComponent, null, params, true);
    };
    UserComponentFactory2.prototype.getStatusPanelCompDetails = function(def, params) {
      return this.getCompDetails(def, StatusPanelComponent, null, params, true);
    };
    UserComponentFactory2.prototype.getCompDetails = function(defObject, type, defaultName, params, mandatory) {
      var _this = this;
      if (mandatory === void 0) {
        mandatory = false;
      }
      var propertyName = type.propertyName, cellRenderer = type.cellRenderer;
      var _a2 = this.getCompKeys(defObject, type, params), compName = _a2.compName, jsComp2 = _a2.jsComp, fwComp = _a2.fwComp, paramsFromSelector = _a2.paramsFromSelector, popupFromSelector = _a2.popupFromSelector, popupPositionFromSelector = _a2.popupPositionFromSelector;
      var lookupFromRegistry = function(key) {
        var item = _this.userComponentRegistry.retrieve(propertyName, key);
        if (item) {
          jsComp2 = !item.componentFromFramework ? item.component : void 0;
          fwComp = item.componentFromFramework ? item.component : void 0;
        }
      };
      if (compName != null) {
        lookupFromRegistry(compName);
      }
      if (jsComp2 == null && fwComp == null && defaultName != null) {
        lookupFromRegistry(defaultName);
      }
      if (jsComp2 && cellRenderer && !this.agComponentUtils.doesImplementIComponent(jsComp2)) {
        jsComp2 = this.agComponentUtils.adaptFunction(propertyName, jsComp2);
      }
      if (!jsComp2 && !fwComp) {
        if (mandatory) {
          console.error("AG Grid: Could not find component " + compName + ", did you forget to configure this component?");
        }
        return;
      }
      var paramsMerged = this.mergeParamsWithApplicationProvidedParams(defObject, type, params, paramsFromSelector);
      var componentFromFramework = jsComp2 == null;
      var componentClass = jsComp2 ? jsComp2 : fwComp;
      return {
        componentFromFramework,
        componentClass,
        params: paramsMerged,
        type,
        popupFromSelector,
        popupPositionFromSelector,
        newAgStackInstance: function() {
          return _this.newAgStackInstance(componentClass, componentFromFramework, paramsMerged, type);
        }
      };
    };
    UserComponentFactory2.prototype.getCompKeys = function(defObject, type, params) {
      var _this = this;
      var propertyName = type.propertyName;
      var compName;
      var jsComp2;
      var fwComp;
      var paramsFromSelector;
      var popupFromSelector;
      var popupPositionFromSelector;
      if (defObject) {
        var defObjectAny = defObject;
        var selectorFunc = defObjectAny[propertyName + "Selector"];
        var selectorRes = selectorFunc ? selectorFunc(params) : null;
        var assignComp = function(providedJsComp) {
          if (typeof providedJsComp === "string") {
            compName = providedJsComp;
          } else if (providedJsComp != null && providedJsComp !== true) {
            var isFwkComp = _this.getFrameworkOverrides().isFrameworkComponent(providedJsComp);
            if (isFwkComp) {
              fwComp = providedJsComp;
            } else {
              jsComp2 = providedJsComp;
            }
          }
        };
        if (selectorRes) {
          assignComp(selectorRes.component);
          paramsFromSelector = selectorRes.params;
          popupFromSelector = selectorRes.popup;
          popupPositionFromSelector = selectorRes.popupPosition;
        } else {
          assignComp(defObjectAny[propertyName]);
        }
      }
      return { compName, jsComp: jsComp2, fwComp, paramsFromSelector, popupFromSelector, popupPositionFromSelector };
    };
    UserComponentFactory2.prototype.newAgStackInstance = function(ComponentClass, componentFromFramework, params, type) {
      var propertyName = type.propertyName;
      var jsComponent = !componentFromFramework;
      var instance;
      if (jsComponent) {
        instance = new ComponentClass();
      } else {
        var thisComponentConfig = this.componentMetadataProvider.retrieve(propertyName);
        instance = this.frameworkComponentWrapper.wrap(ComponentClass, thisComponentConfig.mandatoryMethodList, thisComponentConfig.optionalMethodList, type);
      }
      var deferredInit = this.initComponent(instance, params);
      if (deferredInit == null) {
        return AgPromise.resolve(instance);
      }
      return deferredInit.then(function() {
        return instance;
      });
    };
    UserComponentFactory2.prototype.mergeParamsWithApplicationProvidedParams = function(defObject, type, paramsFromGrid, paramsFromSelector) {
      if (paramsFromSelector === void 0) {
        paramsFromSelector = null;
      }
      var params = {
        context: this.gridOptionsService.context,
        columnApi: this.gridOptionsService.columnApi,
        api: this.gridOptionsService.api
      };
      mergeDeep(params, paramsFromGrid);
      var defObjectAny = defObject;
      var userParams = defObjectAny && defObjectAny[type.propertyName + "Params"];
      if (typeof userParams === "function") {
        var userParamsFromFunc = userParams(paramsFromGrid);
        mergeDeep(params, userParamsFromFunc);
      } else if (typeof userParams === "object") {
        mergeDeep(params, userParams);
      }
      mergeDeep(params, paramsFromSelector);
      return params;
    };
    UserComponentFactory2.prototype.initComponent = function(component, params) {
      this.context.createBean(component);
      if (component.init == null) {
        return;
      }
      return component.init(params);
    };
    UserComponentFactory2.prototype.getDefaultFloatingFilterType = function(def, getFromDefault) {
      if (def == null) {
        return null;
      }
      var defaultFloatingFilterType = null;
      var _a2 = this.getCompKeys(def, FilterComponent), compName = _a2.compName, jsComp2 = _a2.jsComp, fwComp = _a2.fwComp;
      if (compName) {
        defaultFloatingFilterType = FloatingFilterMapper.getFloatingFilterType(compName);
      } else {
        var usingDefaultFilter = jsComp2 == null && fwComp == null && def.filter === true;
        if (usingDefaultFilter) {
          defaultFloatingFilterType = getFromDefault();
        }
      }
      return defaultFloatingFilterType;
    };
    __decorate$1X([
      Autowired("gridOptions")
    ], UserComponentFactory2.prototype, "gridOptions", void 0);
    __decorate$1X([
      Autowired("agComponentUtils")
    ], UserComponentFactory2.prototype, "agComponentUtils", void 0);
    __decorate$1X([
      Autowired("componentMetadataProvider")
    ], UserComponentFactory2.prototype, "componentMetadataProvider", void 0);
    __decorate$1X([
      Autowired("userComponentRegistry")
    ], UserComponentFactory2.prototype, "userComponentRegistry", void 0);
    __decorate$1X([
      Optional("frameworkComponentWrapper")
    ], UserComponentFactory2.prototype, "frameworkComponentWrapper", void 0);
    UserComponentFactory2 = __decorate$1X([
      Bean("userComponentFactory")
    ], UserComponentFactory2);
    return UserComponentFactory2;
  }(BeanStub)
);
var ExcelFactoryMode;
(function(ExcelFactoryMode2) {
  ExcelFactoryMode2[ExcelFactoryMode2["SINGLE_SHEET"] = 0] = "SINGLE_SHEET";
  ExcelFactoryMode2[ExcelFactoryMode2["MULTI_SHEET"] = 1] = "MULTI_SHEET";
})(ExcelFactoryMode || (ExcelFactoryMode = {}));
var __extends$24 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1W = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DragService = (
  /** @class */
  function(_super) {
    __extends$24(DragService2, _super);
    function DragService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.dragEndFunctions = [];
      _this.dragSources = [];
      return _this;
    }
    DragService2.prototype.removeAllListeners = function() {
      this.dragSources.forEach(this.removeListener.bind(this));
      this.dragSources.length = 0;
    };
    DragService2.prototype.removeListener = function(dragSourceAndListener) {
      var element = dragSourceAndListener.dragSource.eElement;
      var mouseDownListener = dragSourceAndListener.mouseDownListener;
      element.removeEventListener("mousedown", mouseDownListener);
      if (dragSourceAndListener.touchEnabled) {
        var touchStartListener = dragSourceAndListener.touchStartListener;
        element.removeEventListener("touchstart", touchStartListener, { passive: true });
      }
    };
    DragService2.prototype.removeDragSource = function(params) {
      var dragSourceAndListener = this.dragSources.find(function(item) {
        return item.dragSource === params;
      });
      if (!dragSourceAndListener) {
        return;
      }
      this.removeListener(dragSourceAndListener);
      removeFromArray(this.dragSources, dragSourceAndListener);
    };
    DragService2.prototype.isDragging = function() {
      return this.dragging;
    };
    DragService2.prototype.addDragSource = function(params) {
      var _this = this;
      var mouseListener = this.onMouseDown.bind(this, params);
      var eElement = params.eElement, includeTouch = params.includeTouch, stopPropagationForTouch = params.stopPropagationForTouch;
      eElement.addEventListener("mousedown", mouseListener);
      var touchListener = null;
      var suppressTouch = this.gridOptionsService.is("suppressTouch");
      if (includeTouch && !suppressTouch) {
        touchListener = function(touchEvent) {
          if (isFocusableFormField(touchEvent.target)) {
            return;
          }
          if (touchEvent.cancelable) {
            touchEvent.preventDefault();
            if (stopPropagationForTouch) {
              touchEvent.stopPropagation();
            }
          }
          _this.onTouchStart(params, touchEvent);
        };
        eElement.addEventListener("touchstart", touchListener, { passive: false });
      }
      this.dragSources.push({
        dragSource: params,
        mouseDownListener: mouseListener,
        touchStartListener: touchListener,
        touchEnabled: !!includeTouch
      });
    };
    DragService2.prototype.getStartTarget = function() {
      return this.startTarget;
    };
    DragService2.prototype.onTouchStart = function(params, touchEvent) {
      var _this = this;
      this.currentDragParams = params;
      this.dragging = false;
      var touch = touchEvent.touches[0];
      this.touchLastTime = touch;
      this.touchStart = touch;
      var touchMoveEvent = function(e) {
        return _this.onTouchMove(e, params.eElement);
      };
      var touchEndEvent = function(e) {
        return _this.onTouchUp(e, params.eElement);
      };
      var documentTouchMove = function(e) {
        if (e.cancelable) {
          e.preventDefault();
        }
      };
      var target = touchEvent.target;
      var events2 = [
        // Prevents the page document from moving while we are dragging items around.
        // preventDefault needs to be called in the touchmove listener and never inside the
        // touchstart, because using touchstart causes the click event to be cancelled on touch devices.
        { target: this.gridOptionsService.getRootNode(), type: "touchmove", listener: documentTouchMove, options: { passive: false } },
        { target, type: "touchmove", listener: touchMoveEvent, options: { passive: true } },
        { target, type: "touchend", listener: touchEndEvent, options: { passive: true } },
        { target, type: "touchcancel", listener: touchEndEvent, options: { passive: true } }
      ];
      this.addTemporaryEvents(events2);
      if (params.dragStartPixels === 0) {
        this.onCommonMove(touch, this.touchStart, params.eElement);
      }
    };
    DragService2.prototype.onMouseDown = function(params, mouseEvent) {
      var _this = this;
      var e = mouseEvent;
      if (params.skipMouseEvent && params.skipMouseEvent(mouseEvent)) {
        return;
      }
      if (e._alreadyProcessedByDragService) {
        return;
      }
      e._alreadyProcessedByDragService = true;
      if (mouseEvent.button !== 0) {
        return;
      }
      if (this.shouldPreventMouseEvent(mouseEvent)) {
        mouseEvent.preventDefault();
      }
      this.currentDragParams = params;
      this.dragging = false;
      this.mouseStartEvent = mouseEvent;
      this.startTarget = mouseEvent.target;
      var mouseMoveEvent = function(event) {
        return _this.onMouseMove(event, params.eElement);
      };
      var mouseUpEvent = function(event) {
        return _this.onMouseUp(event, params.eElement);
      };
      var contextEvent = function(event) {
        return event.preventDefault();
      };
      var target = this.gridOptionsService.getRootNode();
      var events2 = [
        { target, type: "mousemove", listener: mouseMoveEvent },
        { target, type: "mouseup", listener: mouseUpEvent },
        { target, type: "contextmenu", listener: contextEvent }
      ];
      this.addTemporaryEvents(events2);
      if (params.dragStartPixels === 0) {
        this.onMouseMove(mouseEvent, params.eElement);
      }
    };
    DragService2.prototype.addTemporaryEvents = function(events2) {
      events2.forEach(function(currentEvent) {
        var target = currentEvent.target, type = currentEvent.type, listener = currentEvent.listener, options = currentEvent.options;
        target.addEventListener(type, listener, options);
      });
      this.dragEndFunctions.push(function() {
        events2.forEach(function(currentEvent) {
          var target = currentEvent.target, type = currentEvent.type, listener = currentEvent.listener, options = currentEvent.options;
          target.removeEventListener(type, listener, options);
        });
      });
    };
    DragService2.prototype.isEventNearStartEvent = function(currentEvent, startEvent) {
      var dragStartPixels = this.currentDragParams.dragStartPixels;
      var requiredPixelDiff = exists(dragStartPixels) ? dragStartPixels : 4;
      return areEventsNear(currentEvent, startEvent, requiredPixelDiff);
    };
    DragService2.prototype.getFirstActiveTouch = function(touchList) {
      for (var i = 0; i < touchList.length; i++) {
        if (touchList[i].identifier === this.touchStart.identifier) {
          return touchList[i];
        }
      }
      return null;
    };
    DragService2.prototype.onCommonMove = function(currentEvent, startEvent, el2) {
      if (!this.dragging) {
        if (!this.dragging && this.isEventNearStartEvent(currentEvent, startEvent)) {
          return;
        }
        this.dragging = true;
        var event_1 = {
          type: Events.EVENT_DRAG_STARTED,
          target: el2
        };
        this.eventService.dispatchEvent(event_1);
        this.currentDragParams.onDragStart(startEvent);
        this.currentDragParams.onDragging(startEvent);
      }
      this.currentDragParams.onDragging(currentEvent);
    };
    DragService2.prototype.onTouchMove = function(touchEvent, el2) {
      var touch = this.getFirstActiveTouch(touchEvent.touches);
      if (!touch) {
        return;
      }
      this.onCommonMove(touch, this.touchStart, el2);
    };
    DragService2.prototype.onMouseMove = function(mouseEvent, el2) {
      if (this.shouldPreventMouseEvent(mouseEvent)) {
        mouseEvent.preventDefault();
      }
      this.onCommonMove(mouseEvent, this.mouseStartEvent, el2);
    };
    DragService2.prototype.shouldPreventMouseEvent = function(mouseEvent) {
      var isEnableCellTextSelect = this.gridOptionsService.is("enableCellTextSelection");
      var isSafari2 = isBrowserSafari();
      var isMouseMove = mouseEvent.type === "mousemove";
      return (
        // when `isEnableCellTextSelect` is `true`, we need to preventDefault on mouseMove
        // to avoid the grid text being selected while dragging components.
        // Note: Safari also has an issue, where `user-select: none` is not being respected, so also
        // prevent it on MouseDown.
        (isEnableCellTextSelect && isMouseMove || isSafari2) && mouseEvent.cancelable && this.mouseEventService.isEventFromThisGrid(mouseEvent) && !this.isOverFormFieldElement(mouseEvent)
      );
    };
    DragService2.prototype.isOverFormFieldElement = function(mouseEvent) {
      var el2 = mouseEvent.target;
      var tagName = el2 === null || el2 === void 0 ? void 0 : el2.tagName.toLocaleLowerCase();
      return !!(tagName === null || tagName === void 0 ? void 0 : tagName.match("^a$|textarea|input|select|button"));
    };
    DragService2.prototype.onTouchUp = function(touchEvent, el2) {
      var touch = this.getFirstActiveTouch(touchEvent.changedTouches);
      if (!touch) {
        touch = this.touchLastTime;
      }
      this.onUpCommon(touch, el2);
    };
    DragService2.prototype.onMouseUp = function(mouseEvent, el2) {
      this.onUpCommon(mouseEvent, el2);
    };
    DragService2.prototype.onUpCommon = function(eventOrTouch, el2) {
      if (this.dragging) {
        this.dragging = false;
        this.currentDragParams.onDragStop(eventOrTouch);
        var event_2 = {
          type: Events.EVENT_DRAG_STOPPED,
          target: el2
        };
        this.eventService.dispatchEvent(event_2);
      }
      this.mouseStartEvent = null;
      this.startTarget = null;
      this.touchStart = null;
      this.touchLastTime = null;
      this.currentDragParams = null;
      this.dragEndFunctions.forEach(function(func) {
        return func();
      });
      this.dragEndFunctions.length = 0;
    };
    __decorate$1W([
      Autowired("mouseEventService")
    ], DragService2.prototype, "mouseEventService", void 0);
    __decorate$1W([
      PreDestroy
    ], DragService2.prototype, "removeAllListeners", null);
    DragService2 = __decorate$1W([
      Bean("dragService")
    ], DragService2);
    return DragService2;
  }(BeanStub)
);
var RowHighlightPosition;
(function(RowHighlightPosition2) {
  RowHighlightPosition2[RowHighlightPosition2["Above"] = 0] = "Above";
  RowHighlightPosition2[RowHighlightPosition2["Below"] = 1] = "Below";
})(RowHighlightPosition || (RowHighlightPosition = {}));
var ClientSideRowModelSteps;
(function(ClientSideRowModelSteps2) {
  ClientSideRowModelSteps2["EVERYTHING"] = "group";
  ClientSideRowModelSteps2["FILTER"] = "filter";
  ClientSideRowModelSteps2["SORT"] = "sort";
  ClientSideRowModelSteps2["MAP"] = "map";
  ClientSideRowModelSteps2["AGGREGATE"] = "aggregate";
  ClientSideRowModelSteps2["FILTER_AGGREGATES"] = "filter_aggregates";
  ClientSideRowModelSteps2["PIVOT"] = "pivot";
  ClientSideRowModelSteps2["NOTHING"] = "nothing";
})(ClientSideRowModelSteps || (ClientSideRowModelSteps = {}));
var __decorate$1V = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
function unwrapUserComp(comp) {
  var compAsAny = comp;
  var isProxy = compAsAny != null && compAsAny.getFrameworkComponentInstance != null;
  return isProxy ? compAsAny.getFrameworkComponentInstance() : comp;
}
var GridApi = (
  /** @class */
  function() {
    function GridApi2() {
      this.detailGridInfoMap = {};
      this.destroyCalled = false;
    }
    GridApi2.prototype.registerOverlayWrapperComp = function(overlayWrapperComp) {
      this.overlayWrapperComp = overlayWrapperComp;
    };
    GridApi2.prototype.registerSideBarComp = function(sideBarComp) {
      this.sideBarComp = sideBarComp;
    };
    GridApi2.prototype.init = function() {
      var _this = this;
      switch (this.rowModel.getType()) {
        case "clientSide":
          this.clientSideRowModel = this.rowModel;
          break;
        case "infinite":
          this.infiniteRowModel = this.rowModel;
          break;
        case "serverSide":
          this.serverSideRowModel = this.rowModel;
          break;
      }
      this.ctrlsService.whenReady(function() {
        _this.gridBodyCtrl = _this.ctrlsService.getGridBodyCtrl();
      });
    };
    GridApi2.prototype.__getAlignedGridService = function() {
      return this.alignedGridsService;
    };
    GridApi2.prototype.__getContext = function() {
      return this.context;
    };
    GridApi2.prototype.getSetterMethod = function(key) {
      return "set" + key.charAt(0).toUpperCase() + key.substring(1);
    };
    GridApi2.prototype.__setProperty = function(propertyName, value) {
      this.gridOptionsService.set(propertyName, value);
      var setterName = this.getSetterMethod(propertyName);
      var dynamicApi = this;
      if (dynamicApi[setterName]) {
        dynamicApi[setterName](value);
      }
    };
    GridApi2.prototype.getGridId = function() {
      return this.context.getGridId();
    };
    GridApi2.prototype.addDetailGridInfo = function(id2, gridInfo) {
      this.detailGridInfoMap[id2] = gridInfo;
    };
    GridApi2.prototype.removeDetailGridInfo = function(id2) {
      this.detailGridInfoMap[id2] = void 0;
    };
    GridApi2.prototype.getDetailGridInfo = function(id2) {
      return this.detailGridInfoMap[id2];
    };
    GridApi2.prototype.forEachDetailGridInfo = function(callback2) {
      var index2 = 0;
      iterateObject(this.detailGridInfoMap, function(id2, gridInfo) {
        if (exists(gridInfo)) {
          callback2(gridInfo, index2);
          index2++;
        }
      });
    };
    GridApi2.prototype.getDataAsCsv = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.CsvExportModule, "api.getDataAsCsv", this.context.getGridId())) {
        return this.csvCreator.getDataAsCsv(params);
      }
    };
    GridApi2.prototype.exportDataAsCsv = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.CsvExportModule, "api.exportDataAsCSv", this.context.getGridId())) {
        this.csvCreator.exportDataAsCsv(params);
      }
    };
    GridApi2.prototype.getExcelExportMode = function(params) {
      var baseParams = this.gridOptionsService.get("defaultExcelExportParams");
      var mergedParams = Object.assign({ exportMode: "xlsx" }, baseParams, params);
      return mergedParams.exportMode;
    };
    GridApi2.prototype.assertNotExcelMultiSheet = function(method, params) {
      if (!ModuleRegistry.__assertRegistered(ModuleNames.ExcelExportModule, "api." + method, this.context.getGridId())) {
        return false;
      }
      var exportMode = this.getExcelExportMode(params);
      if (this.excelCreator.getFactoryMode(exportMode) === ExcelFactoryMode.MULTI_SHEET) {
        console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'");
        return false;
      }
      return true;
    };
    GridApi2.prototype.getDataAsExcel = function(params) {
      if (this.assertNotExcelMultiSheet("getDataAsExcel", params)) {
        return this.excelCreator.getDataAsExcel(params);
      }
    };
    GridApi2.prototype.exportDataAsExcel = function(params) {
      if (this.assertNotExcelMultiSheet("exportDataAsExcel", params)) {
        this.excelCreator.exportDataAsExcel(params);
      }
    };
    GridApi2.prototype.getSheetDataForExcel = function(params) {
      if (!ModuleRegistry.__assertRegistered(ModuleNames.ExcelExportModule, "api.getSheetDataForExcel", this.context.getGridId())) {
        return;
      }
      var exportMode = this.getExcelExportMode(params);
      this.excelCreator.setFactoryMode(ExcelFactoryMode.MULTI_SHEET, exportMode);
      return this.excelCreator.getSheetDataForExcel(params);
    };
    GridApi2.prototype.getMultipleSheetsAsExcel = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.ExcelExportModule, "api.getMultipleSheetsAsExcel", this.context.getGridId())) {
        return this.excelCreator.getMultipleSheetsAsExcel(params);
      }
    };
    GridApi2.prototype.exportMultipleSheetsAsExcel = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.ExcelExportModule, "api.exportMultipleSheetsAsExcel", this.context.getGridId())) {
        return this.excelCreator.exportMultipleSheetsAsExcel(params);
      }
    };
    GridApi2.prototype.setGridAriaProperty = function(property, value) {
      if (!property) {
        return;
      }
      var eGrid = this.ctrlsService.getGridBodyCtrl().getGui();
      var ariaProperty = "aria-" + property;
      if (value === null) {
        eGrid.removeAttribute(ariaProperty);
      } else {
        eGrid.setAttribute(ariaProperty, value);
      }
    };
    GridApi2.prototype.logMissingRowModel = function(apiMethod) {
      var requiredRowModels = [];
      for (var _i = 1; _i < arguments.length; _i++) {
        requiredRowModels[_i - 1] = arguments[_i];
      }
      console.error("AG Grid: api." + apiMethod + " can only be called when gridOptions.rowModelType is " + requiredRowModels.join(" or "));
    };
    GridApi2.prototype.setServerSideDatasource = function(datasource) {
      if (this.serverSideRowModel) {
        this.serverSideRowModel.setDatasource(datasource);
      } else {
        this.logMissingRowModel("setServerSideDatasource", "serverSide");
      }
    };
    GridApi2.prototype.setCacheBlockSize = function(blockSize) {
      if (this.serverSideRowModel) {
        this.gridOptionsService.set("cacheBlockSize", blockSize);
        this.serverSideRowModel.resetRootStore();
      } else {
        this.logMissingRowModel("setCacheBlockSize", "serverSide");
      }
    };
    GridApi2.prototype.setDatasource = function(datasource) {
      if (this.gridOptionsService.isRowModelType("infinite")) {
        this.rowModel.setDatasource(datasource);
      } else {
        this.logMissingRowModel("setDatasource", "infinite");
      }
    };
    GridApi2.prototype.setViewportDatasource = function(viewportDatasource) {
      if (this.gridOptionsService.isRowModelType("viewport")) {
        this.rowModel.setViewportDatasource(viewportDatasource);
      } else {
        this.logMissingRowModel("setViewportDatasource", "viewport");
      }
    };
    GridApi2.prototype.setRowData = function(rowData) {
      var missingImmutableService = this.immutableService == null;
      if (missingImmutableService) {
        this.logMissingRowModel("setRowData", "clientSide");
        return;
      }
      if (this.immutableService.isActive()) {
        this.immutableService.setRowData(rowData);
      } else {
        this.selectionService.reset();
        this.clientSideRowModel.setRowData(rowData);
      }
    };
    GridApi2.prototype.setPinnedTopRowData = function(rows) {
      this.pinnedRowModel.setPinnedTopRowData(rows);
    };
    GridApi2.prototype.setPinnedBottomRowData = function(rows) {
      this.pinnedRowModel.setPinnedBottomRowData(rows);
    };
    GridApi2.prototype.getPinnedTopRowCount = function() {
      return this.pinnedRowModel.getPinnedTopRowCount();
    };
    GridApi2.prototype.getPinnedBottomRowCount = function() {
      return this.pinnedRowModel.getPinnedBottomRowCount();
    };
    GridApi2.prototype.getPinnedTopRow = function(index2) {
      return this.pinnedRowModel.getPinnedTopRow(index2);
    };
    GridApi2.prototype.getPinnedBottomRow = function(index2) {
      return this.pinnedRowModel.getPinnedBottomRow(index2);
    };
    GridApi2.prototype.setColumnDefs = function(colDefs, source) {
      if (source === void 0) {
        source = "api";
      }
      this.columnModel.setColumnDefs(colDefs, source);
      this.gridOptionsService.set("columnDefs", colDefs, true, { source });
    };
    GridApi2.prototype.setAutoGroupColumnDef = function(colDef, source) {
      if (source === void 0) {
        source = "api";
      }
      this.gridOptionsService.set("autoGroupColumnDef", colDef, true, { source });
    };
    GridApi2.prototype.setDefaultColDef = function(colDef, source) {
      if (source === void 0) {
        source = "api";
      }
      this.gridOptionsService.set("defaultColDef", colDef, true, { source });
    };
    GridApi2.prototype.setColumnTypes = function(columnTypes, source) {
      if (source === void 0) {
        source = "api";
      }
      this.gridOptionsService.set("columnTypes", columnTypes, true, { source });
    };
    GridApi2.prototype.expireValueCache = function() {
      this.valueCache.expire();
    };
    GridApi2.prototype.getVerticalPixelRange = function() {
      return this.gridBodyCtrl.getScrollFeature().getVScrollPosition();
    };
    GridApi2.prototype.getHorizontalPixelRange = function() {
      return this.gridBodyCtrl.getScrollFeature().getHScrollPosition();
    };
    GridApi2.prototype.setAlwaysShowHorizontalScroll = function(show) {
      this.gridOptionsService.set("alwaysShowHorizontalScroll", show);
    };
    GridApi2.prototype.setAlwaysShowVerticalScroll = function(show) {
      this.gridOptionsService.set("alwaysShowVerticalScroll", show);
    };
    GridApi2.prototype.refreshCells = function(params) {
      if (params === void 0) {
        params = {};
      }
      this.rowRenderer.refreshCells(params);
    };
    GridApi2.prototype.flashCells = function(params) {
      if (params === void 0) {
        params = {};
      }
      this.rowRenderer.flashCells(params);
    };
    GridApi2.prototype.redrawRows = function(params) {
      if (params === void 0) {
        params = {};
      }
      var rowNodes = params ? params.rowNodes : void 0;
      this.rowRenderer.redrawRows(rowNodes);
    };
    GridApi2.prototype.setFunctionsReadOnly = function(readOnly) {
      this.gridOptionsService.set("functionsReadOnly", readOnly);
    };
    GridApi2.prototype.refreshHeader = function() {
      this.ctrlsService.getHeaderRowContainerCtrls().forEach(function(c) {
        return c.refresh();
      });
    };
    GridApi2.prototype.isAnyFilterPresent = function() {
      return this.filterManager.isAnyFilterPresent();
    };
    GridApi2.prototype.isColumnFilterPresent = function() {
      return this.filterManager.isColumnFilterPresent() || this.filterManager.isAggregateFilterPresent();
    };
    GridApi2.prototype.isQuickFilterPresent = function() {
      return this.filterManager.isQuickFilterPresent();
    };
    GridApi2.prototype.getModel = function() {
      return this.rowModel;
    };
    GridApi2.prototype.setRowNodeExpanded = function(rowNode, expanded, expandParents) {
      if (rowNode) {
        if (expandParents && rowNode.parent && rowNode.parent.level !== -1) {
          this.setRowNodeExpanded(rowNode.parent, expanded, expandParents);
        }
        rowNode.setExpanded(expanded);
      }
    };
    GridApi2.prototype.onGroupExpandedOrCollapsed = function() {
      if (missing(this.clientSideRowModel)) {
        this.logMissingRowModel("onGroupExpandedOrCollapsed", "clientSide");
        return;
      }
      this.clientSideRowModel.refreshModel({ step: ClientSideRowModelSteps.MAP });
    };
    GridApi2.prototype.refreshClientSideRowModel = function(step) {
      if (missing(this.clientSideRowModel)) {
        this.logMissingRowModel("refreshClientSideRowModel", "clientSide");
        return;
      }
      this.clientSideRowModel.refreshModel(step);
    };
    GridApi2.prototype.isAnimationFrameQueueEmpty = function() {
      return this.animationFrameService.isQueueEmpty();
    };
    GridApi2.prototype.flushAllAnimationFrames = function() {
      this.animationFrameService.flushAllFrames();
    };
    GridApi2.prototype.getRowNode = function(id2) {
      return this.rowModel.getRowNode(id2);
    };
    GridApi2.prototype.getSizesForCurrentTheme = function() {
      return {
        rowHeight: this.gridOptionsService.getRowHeightAsNumber(),
        headerHeight: this.columnModel.getHeaderHeight()
      };
    };
    GridApi2.prototype.expandAll = function() {
      if (this.clientSideRowModel) {
        this.clientSideRowModel.expandOrCollapseAll(true);
      } else if (this.serverSideRowModel) {
        this.serverSideRowModel.expandAll(true);
      } else {
        this.logMissingRowModel("expandAll", "clientSide", "serverSide");
      }
    };
    GridApi2.prototype.collapseAll = function() {
      if (this.clientSideRowModel) {
        this.clientSideRowModel.expandOrCollapseAll(false);
      } else if (this.serverSideRowModel) {
        this.serverSideRowModel.expandAll(false);
      } else {
        this.logMissingRowModel("expandAll", "clientSide", "serverSide");
      }
    };
    GridApi2.prototype.addRenderedRowListener = function(eventName, rowIndex, callback2) {
      this.rowRenderer.addRenderedRowListener(eventName, rowIndex, callback2);
    };
    GridApi2.prototype.getQuickFilter = function() {
      return this.gridOptionsService.get("quickFilterText");
    };
    GridApi2.prototype.setQuickFilter = function(newFilter) {
      this.gridOptionsService.set("quickFilterText", newFilter);
    };
    GridApi2.prototype.setExcludeHiddenColumnsFromQuickFilter = function(value) {
      logDeprecation("30", "setExcludeHiddenColumnsFromQuickFilter", void 0, "Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `setIncludeHiddenColumnsInQuickFilter`");
      this.setIncludeHiddenColumnsInQuickFilter(!value);
    };
    GridApi2.prototype.setIncludeHiddenColumnsInQuickFilter = function(value) {
      this.gridOptionsService.set("includeHiddenColumnsInQuickFilter", value);
    };
    GridApi2.prototype.setNodesSelected = function(params) {
      var allNodesValid = params.nodes.every(function(node) {
        if (node.rowPinned) {
          console.warn("AG Grid: cannot select pinned rows");
          return false;
        }
        if (node.id === void 0) {
          console.warn("AG Grid: cannot select node until id for node is known");
          return false;
        }
        return true;
      });
      if (!allNodesValid) {
        return;
      }
      var nodes = params.nodes, source = params.source, newValue = params.newValue;
      var nodesAsRowNode = nodes;
      this.selectionService.setNodesSelected({ nodes: nodesAsRowNode, source: source !== null && source !== void 0 ? source : "api", newValue });
    };
    GridApi2.prototype.selectAll = function(source) {
      if (source === void 0) {
        source = "apiSelectAll";
      }
      this.selectionService.selectAllRowNodes({ source });
    };
    GridApi2.prototype.deselectAll = function(source) {
      if (source === void 0) {
        source = "apiSelectAll";
      }
      this.selectionService.deselectAllRowNodes({ source });
    };
    GridApi2.prototype.selectAllFiltered = function(source) {
      if (source === void 0) {
        source = "apiSelectAllFiltered";
      }
      this.selectionService.selectAllRowNodes({ source, justFiltered: true });
    };
    GridApi2.prototype.deselectAllFiltered = function(source) {
      if (source === void 0) {
        source = "apiSelectAllFiltered";
      }
      this.selectionService.deselectAllRowNodes({ source, justFiltered: true });
    };
    GridApi2.prototype.getServerSideSelectionState = function() {
      if (missing(this.serverSideRowModel)) {
        this.logMissingRowModel("getServerSideSelectionState", "serverSide");
        return null;
      }
      return this.selectionService.getServerSideSelectionState();
    };
    GridApi2.prototype.setServerSideSelectionState = function(state) {
      if (missing(this.serverSideRowModel)) {
        this.logMissingRowModel("setServerSideSelectionState", "serverSide");
        return;
      }
      this.selectionService.setServerSideSelectionState(state);
    };
    GridApi2.prototype.selectAllOnCurrentPage = function(source) {
      if (source === void 0) {
        source = "apiSelectAllCurrentPage";
      }
      this.selectionService.selectAllRowNodes({ source, justCurrentPage: true });
    };
    GridApi2.prototype.deselectAllOnCurrentPage = function(source) {
      if (source === void 0) {
        source = "apiSelectAllCurrentPage";
      }
      this.selectionService.deselectAllRowNodes({ source, justCurrentPage: true });
    };
    GridApi2.prototype.sizeColumnsToFit = function(params) {
      this.gridBodyCtrl.sizeColumnsToFit(params);
    };
    GridApi2.prototype.showLoadingOverlay = function() {
      this.overlayWrapperComp.showLoadingOverlay();
    };
    GridApi2.prototype.showNoRowsOverlay = function() {
      this.overlayWrapperComp.showNoRowsOverlay();
    };
    GridApi2.prototype.hideOverlay = function() {
      this.overlayWrapperComp.hideOverlay();
    };
    GridApi2.prototype.getSelectedNodes = function() {
      return this.selectionService.getSelectedNodes();
    };
    GridApi2.prototype.getSelectedRows = function() {
      return this.selectionService.getSelectedRows();
    };
    GridApi2.prototype.getBestCostNodeSelection = function() {
      if (missing(this.clientSideRowModel)) {
        this.logMissingRowModel("getBestCostNodeSelection", "clientSide");
        return;
      }
      return this.selectionService.getBestCostNodeSelection();
    };
    GridApi2.prototype.getRenderedNodes = function() {
      return this.rowRenderer.getRenderedNodes();
    };
    GridApi2.prototype.ensureColumnVisible = function(key, position) {
      if (position === void 0) {
        position = "auto";
      }
      this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(key, position);
    };
    GridApi2.prototype.ensureIndexVisible = function(index2, position) {
      this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(index2, position);
    };
    GridApi2.prototype.ensureNodeVisible = function(nodeSelector, position) {
      if (position === void 0) {
        position = null;
      }
      this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(nodeSelector, position);
    };
    GridApi2.prototype.forEachLeafNode = function(callback2) {
      if (missing(this.clientSideRowModel)) {
        this.logMissingRowModel("forEachLeafNode", "clientSide");
        return;
      }
      this.clientSideRowModel.forEachLeafNode(callback2);
    };
    GridApi2.prototype.forEachNode = function(callback2, includeFooterNodes) {
      this.rowModel.forEachNode(callback2, includeFooterNodes);
    };
    GridApi2.prototype.forEachNodeAfterFilter = function(callback2) {
      if (missing(this.clientSideRowModel)) {
        this.logMissingRowModel("forEachNodeAfterFilter", "clientSide");
        return;
      }
      this.clientSideRowModel.forEachNodeAfterFilter(callback2);
    };
    GridApi2.prototype.forEachNodeAfterFilterAndSort = function(callback2) {
      if (missing(this.clientSideRowModel)) {
        this.logMissingRowModel("forEachNodeAfterFilterAndSort", "clientSide");
        return;
      }
      this.clientSideRowModel.forEachNodeAfterFilterAndSort(callback2);
    };
    GridApi2.prototype.getFilterInstance = function(key, callback2) {
      var res = this.getFilterInstanceImpl(key, function(instance) {
        if (!callback2) {
          return;
        }
        var unwrapped2 = unwrapUserComp(instance);
        callback2(unwrapped2);
      });
      var unwrapped = unwrapUserComp(res);
      return unwrapped;
    };
    GridApi2.prototype.getFilterInstanceImpl = function(key, callback2) {
      var column = this.columnModel.getPrimaryColumn(key);
      if (!column) {
        return void 0;
      }
      var filterPromise = this.filterManager.getFilterComponent(column, "NO_UI");
      var currentValue = filterPromise && filterPromise.resolveNow(null, function(filterComp) {
        return filterComp;
      });
      if (currentValue) {
        setTimeout(callback2, 0, currentValue);
      } else if (filterPromise) {
        filterPromise.then(function(comp) {
          callback2(comp);
        });
      }
      return currentValue;
    };
    GridApi2.prototype.destroyFilter = function(key) {
      var column = this.columnModel.getPrimaryColumn(key);
      if (column) {
        return this.filterManager.destroyFilter(column, "api");
      }
    };
    GridApi2.prototype.getStatusPanel = function(key) {
      if (!ModuleRegistry.__assertRegistered(ModuleNames.StatusBarModule, "api.getStatusPanel", this.context.getGridId())) {
        return;
      }
      var comp = this.statusBarService.getStatusPanel(key);
      return unwrapUserComp(comp);
    };
    GridApi2.prototype.getColumnDef = function(key) {
      var column = this.columnModel.getPrimaryColumn(key);
      if (column) {
        return column.getColDef();
      }
      return null;
    };
    GridApi2.prototype.getColumnDefs = function() {
      return this.columnModel.getColumnDefs();
    };
    GridApi2.prototype.onFilterChanged = function() {
      this.filterManager.onFilterChanged();
    };
    GridApi2.prototype.onSortChanged = function() {
      this.sortController.onSortChanged("api");
    };
    GridApi2.prototype.setFilterModel = function(model) {
      this.filterManager.setFilterModel(model);
    };
    GridApi2.prototype.getFilterModel = function() {
      return this.filterManager.getFilterModel();
    };
    GridApi2.prototype.getFocusedCell = function() {
      return this.focusService.getFocusedCell();
    };
    GridApi2.prototype.clearFocusedCell = function() {
      return this.focusService.clearFocusedCell();
    };
    GridApi2.prototype.setFocusedCell = function(rowIndex, colKey, rowPinned) {
      this.focusService.setFocusedCell({ rowIndex, column: colKey, rowPinned, forceBrowserFocus: true });
    };
    GridApi2.prototype.setSuppressRowDrag = function(value) {
      this.gridOptionsService.set("suppressRowDrag", value);
    };
    GridApi2.prototype.setSuppressMoveWhenRowDragging = function(value) {
      this.gridOptionsService.set("suppressMoveWhenRowDragging", value);
    };
    GridApi2.prototype.setSuppressRowClickSelection = function(value) {
      this.gridOptionsService.set("suppressRowClickSelection", value);
    };
    GridApi2.prototype.addRowDropZone = function(params) {
      this.gridBodyCtrl.getRowDragFeature().addRowDropZone(params);
    };
    GridApi2.prototype.removeRowDropZone = function(params) {
      var activeDropTarget = this.dragAndDropService.findExternalZone(params);
      if (activeDropTarget) {
        this.dragAndDropService.removeDropTarget(activeDropTarget);
      }
    };
    GridApi2.prototype.getRowDropZoneParams = function(events2) {
      return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(events2);
    };
    GridApi2.prototype.setHeaderHeight = function(headerHeight) {
      this.gridOptionsService.set("headerHeight", headerHeight);
    };
    GridApi2.prototype.setDomLayout = function(domLayout) {
      this.gridOptionsService.set("domLayout", domLayout);
    };
    GridApi2.prototype.setEnableCellTextSelection = function(selectable) {
      this.gridBodyCtrl.setCellTextSelection(selectable);
    };
    GridApi2.prototype.setFillHandleDirection = function(direction) {
      this.gridOptionsService.set("fillHandleDirection", direction);
    };
    GridApi2.prototype.setGroupHeaderHeight = function(headerHeight) {
      this.gridOptionsService.set("groupHeaderHeight", headerHeight);
    };
    GridApi2.prototype.setFloatingFiltersHeight = function(headerHeight) {
      this.gridOptionsService.set("floatingFiltersHeight", headerHeight);
    };
    GridApi2.prototype.setPivotHeaderHeight = function(headerHeight) {
      this.gridOptionsService.set("pivotHeaderHeight", headerHeight);
    };
    GridApi2.prototype.setPivotGroupHeaderHeight = function(headerHeight) {
      this.gridOptionsService.set("pivotGroupHeaderHeight", headerHeight);
    };
    GridApi2.prototype.setPivotMode = function(pivotMode) {
      this.columnModel.setPivotMode(pivotMode);
    };
    GridApi2.prototype.setAnimateRows = function(animateRows) {
      this.gridOptionsService.set("animateRows", animateRows);
    };
    GridApi2.prototype.setIsExternalFilterPresent = function(isExternalFilterPresentFunc) {
      this.gridOptionsService.set("isExternalFilterPresent", isExternalFilterPresentFunc);
    };
    GridApi2.prototype.setDoesExternalFilterPass = function(doesExternalFilterPassFunc) {
      this.gridOptionsService.set("doesExternalFilterPass", doesExternalFilterPassFunc);
    };
    GridApi2.prototype.setNavigateToNextCell = function(navigateToNextCellFunc) {
      this.gridOptionsService.set("navigateToNextCell", navigateToNextCellFunc);
    };
    GridApi2.prototype.setTabToNextCell = function(tabToNextCellFunc) {
      this.gridOptionsService.set("tabToNextCell", tabToNextCellFunc);
    };
    GridApi2.prototype.setTabToNextHeader = function(tabToNextHeaderFunc) {
      this.gridOptionsService.set("tabToNextHeader", tabToNextHeaderFunc);
    };
    GridApi2.prototype.setNavigateToNextHeader = function(navigateToNextHeaderFunc) {
      this.gridOptionsService.set("navigateToNextHeader", navigateToNextHeaderFunc);
    };
    GridApi2.prototype.setRowGroupPanelShow = function(rowGroupPanelShow) {
      this.gridOptionsService.set("rowGroupPanelShow", rowGroupPanelShow);
    };
    GridApi2.prototype.setGetGroupRowAgg = function(getGroupRowAggFunc) {
      this.gridOptionsService.set("getGroupRowAgg", getGroupRowAggFunc);
    };
    GridApi2.prototype.setGetBusinessKeyForNode = function(getBusinessKeyForNodeFunc) {
      this.gridOptionsService.set("getBusinessKeyForNode", getBusinessKeyForNodeFunc);
    };
    GridApi2.prototype.setGetChildCount = function(getChildCountFunc) {
      this.gridOptionsService.set("getChildCount", getChildCountFunc);
    };
    GridApi2.prototype.setProcessRowPostCreate = function(processRowPostCreateFunc) {
      this.gridOptionsService.set("processRowPostCreate", processRowPostCreateFunc);
    };
    GridApi2.prototype.setGetRowId = function(getRowIdFunc) {
      this.gridOptionsService.set("getRowId", getRowIdFunc);
    };
    GridApi2.prototype.setGetRowClass = function(rowClassFunc) {
      this.gridOptionsService.set("getRowClass", rowClassFunc);
    };
    GridApi2.prototype.setIsFullWidthRow = function(isFullWidthRowFunc) {
      this.gridOptionsService.set("isFullWidthRow", isFullWidthRowFunc);
    };
    GridApi2.prototype.setIsRowSelectable = function(isRowSelectableFunc) {
      this.gridOptionsService.set("isRowSelectable", isRowSelectableFunc);
    };
    GridApi2.prototype.setIsRowMaster = function(isRowMasterFunc) {
      this.gridOptionsService.set("isRowMaster", isRowMasterFunc);
    };
    GridApi2.prototype.setPostSortRows = function(postSortRowsFunc) {
      this.gridOptionsService.set("postSortRows", postSortRowsFunc);
    };
    GridApi2.prototype.setGetDocument = function(getDocumentFunc) {
      this.gridOptionsService.set("getDocument", getDocumentFunc);
    };
    GridApi2.prototype.setGetContextMenuItems = function(getContextMenuItemsFunc) {
      this.gridOptionsService.set("getContextMenuItems", getContextMenuItemsFunc);
    };
    GridApi2.prototype.setGetMainMenuItems = function(getMainMenuItemsFunc) {
      this.gridOptionsService.set("getMainMenuItems", getMainMenuItemsFunc);
    };
    GridApi2.prototype.setProcessCellForClipboard = function(processCellForClipboardFunc) {
      this.gridOptionsService.set("processCellForClipboard", processCellForClipboardFunc);
    };
    GridApi2.prototype.setSendToClipboard = function(sendToClipboardFunc) {
      this.gridOptionsService.set("sendToClipboard", sendToClipboardFunc);
    };
    GridApi2.prototype.setProcessCellFromClipboard = function(processCellFromClipboardFunc) {
      this.gridOptionsService.set("processCellFromClipboard", processCellFromClipboardFunc);
    };
    GridApi2.prototype.setProcessSecondaryColDef = function(processSecondaryColDefFunc) {
      logDeprecation("28.0", "setProcessSecondaryColDef", "setProcessPivotResultColDef");
      this.setProcessPivotResultColDef(processSecondaryColDefFunc);
    };
    GridApi2.prototype.setProcessSecondaryColGroupDef = function(processSecondaryColGroupDefFunc) {
      logDeprecation("28.0", "setProcessSecondaryColGroupDef", "setProcessPivotResultColGroupDef");
      this.setProcessPivotResultColGroupDef(processSecondaryColGroupDefFunc);
    };
    GridApi2.prototype.setProcessPivotResultColDef = function(processPivotResultColDefFunc) {
      this.gridOptionsService.set("processPivotResultColDef", processPivotResultColDefFunc);
    };
    GridApi2.prototype.setProcessPivotResultColGroupDef = function(processPivotResultColGroupDefFunc) {
      this.gridOptionsService.set("processPivotResultColGroupDef", processPivotResultColGroupDefFunc);
    };
    GridApi2.prototype.setPostProcessPopup = function(postProcessPopupFunc) {
      this.gridOptionsService.set("postProcessPopup", postProcessPopupFunc);
    };
    GridApi2.prototype.setInitialGroupOrderComparator = function(initialGroupOrderComparatorFunc) {
      this.gridOptionsService.set("initialGroupOrderComparator", initialGroupOrderComparatorFunc);
    };
    GridApi2.prototype.setGetChartToolbarItems = function(getChartToolbarItemsFunc) {
      this.gridOptionsService.set("getChartToolbarItems", getChartToolbarItemsFunc);
    };
    GridApi2.prototype.setPaginationNumberFormatter = function(paginationNumberFormatterFunc) {
      this.gridOptionsService.set("paginationNumberFormatter", paginationNumberFormatterFunc);
    };
    GridApi2.prototype.setGetServerSideStoreParams = function(getServerSideStoreParamsFunc) {
      logDeprecation("28.0", "setGetServerSideStoreParams", "setGetServerSideGroupLevelParams");
      this.setGetServerSideGroupLevelParams(getServerSideStoreParamsFunc);
    };
    GridApi2.prototype.setGetServerSideGroupLevelParams = function(getServerSideGroupLevelParamsFunc) {
      this.gridOptionsService.set("getServerSideGroupLevelParams", getServerSideGroupLevelParamsFunc);
    };
    GridApi2.prototype.setIsServerSideGroupOpenByDefault = function(isServerSideGroupOpenByDefaultFunc) {
      this.gridOptionsService.set("isServerSideGroupOpenByDefault", isServerSideGroupOpenByDefaultFunc);
    };
    GridApi2.prototype.setIsApplyServerSideTransaction = function(isApplyServerSideTransactionFunc) {
      this.gridOptionsService.set("isApplyServerSideTransaction", isApplyServerSideTransactionFunc);
    };
    GridApi2.prototype.setIsServerSideGroup = function(isServerSideGroupFunc) {
      this.gridOptionsService.set("isServerSideGroup", isServerSideGroupFunc);
    };
    GridApi2.prototype.setGetServerSideGroupKey = function(getServerSideGroupKeyFunc) {
      this.gridOptionsService.set("getServerSideGroupKey", getServerSideGroupKeyFunc);
    };
    GridApi2.prototype.setGetRowStyle = function(rowStyleFunc) {
      this.gridOptionsService.set("getRowStyle", rowStyleFunc);
    };
    GridApi2.prototype.setGetRowHeight = function(rowHeightFunc) {
      this.gridOptionsService.set("getRowHeight", rowHeightFunc);
    };
    GridApi2.prototype.assertSideBarLoaded = function(apiMethod) {
      return ModuleRegistry.__assertRegistered(ModuleNames.SideBarModule, "api." + apiMethod, this.context.getGridId());
    };
    GridApi2.prototype.isSideBarVisible = function() {
      return this.assertSideBarLoaded("isSideBarVisible") && this.sideBarComp.isDisplayed();
    };
    GridApi2.prototype.setSideBarVisible = function(show) {
      if (this.assertSideBarLoaded("setSideBarVisible")) {
        this.sideBarComp.setDisplayed(show);
      }
    };
    GridApi2.prototype.setSideBarPosition = function(position) {
      if (this.assertSideBarLoaded("setSideBarPosition")) {
        this.sideBarComp.setSideBarPosition(position);
      }
    };
    GridApi2.prototype.openToolPanel = function(key) {
      if (this.assertSideBarLoaded("openToolPanel")) {
        this.sideBarComp.openToolPanel(key, "api");
      }
    };
    GridApi2.prototype.closeToolPanel = function() {
      if (this.assertSideBarLoaded("closeToolPanel")) {
        this.sideBarComp.close("api");
      }
    };
    GridApi2.prototype.getOpenedToolPanel = function() {
      if (this.assertSideBarLoaded("getOpenedToolPanel")) {
        return this.sideBarComp.openedItem();
      }
      return null;
    };
    GridApi2.prototype.refreshToolPanel = function() {
      if (this.assertSideBarLoaded("refreshToolPanel")) {
        this.sideBarComp.refresh();
      }
    };
    GridApi2.prototype.isToolPanelShowing = function() {
      return this.assertSideBarLoaded("isToolPanelShowing") && this.sideBarComp.isToolPanelShowing();
    };
    GridApi2.prototype.getToolPanelInstance = function(id2) {
      if (this.assertSideBarLoaded("getToolPanelInstance")) {
        var comp = this.sideBarComp.getToolPanelInstance(id2);
        return unwrapUserComp(comp);
      }
    };
    GridApi2.prototype.getSideBar = function() {
      if (this.assertSideBarLoaded("getSideBar")) {
        return this.sideBarComp.getDef();
      }
      return void 0;
    };
    GridApi2.prototype.setSideBar = function(def) {
      this.gridOptionsService.set("sideBar", def);
    };
    GridApi2.prototype.setSuppressClipboardPaste = function(value) {
      this.gridOptionsService.set("suppressClipboardPaste", value);
    };
    GridApi2.prototype.resetRowHeights = function() {
      if (exists(this.clientSideRowModel)) {
        if (this.columnModel.isAutoRowHeightActive()) {
          console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");
          return;
        }
        this.clientSideRowModel.resetRowHeights();
      }
    };
    GridApi2.prototype.setGroupRemoveSingleChildren = function(value) {
      this.gridOptionsService.set("groupRemoveSingleChildren", value);
    };
    GridApi2.prototype.setGroupRemoveLowestSingleChildren = function(value) {
      this.gridOptionsService.set("groupRemoveLowestSingleChildren", value);
    };
    GridApi2.prototype.setGroupDisplayType = function(value) {
      this.gridOptionsService.set("groupDisplayType", value);
    };
    GridApi2.prototype.setRowClass = function(className) {
      this.gridOptionsService.set("rowClass", className);
    };
    GridApi2.prototype.setDeltaSort = function(enable) {
      this.gridOptionsService.set("deltaSort", enable);
    };
    GridApi2.prototype.setRowCount = function(rowCount, maxRowFound) {
      if (this.serverSideRowModel) {
        if (this.columnModel.isRowGroupEmpty()) {
          this.serverSideRowModel.setRowCount(rowCount, maxRowFound);
          return;
        }
        console.error("AG Grid: setRowCount cannot be used while using row grouping.");
        return;
      }
      if (this.infiniteRowModel) {
        this.infiniteRowModel.setRowCount(rowCount, maxRowFound);
        return;
      }
      this.logMissingRowModel("setRowCount", "infinite", "serverSide");
    };
    GridApi2.prototype.onRowHeightChanged = function() {
      if (this.clientSideRowModel) {
        this.clientSideRowModel.onRowHeightChanged();
      } else if (this.serverSideRowModel) {
        this.serverSideRowModel.onRowHeightChanged();
      }
    };
    GridApi2.prototype.getValue = function(colKey, rowNode) {
      var column = this.columnModel.getPrimaryColumn(colKey);
      if (missing(column)) {
        column = this.columnModel.getGridColumn(colKey);
      }
      if (missing(column)) {
        return null;
      }
      return this.valueService.getValue(column, rowNode);
    };
    GridApi2.prototype.addEventListener = function(eventType, listener) {
      var async = this.gridOptionsService.useAsyncEvents();
      this.eventService.addEventListener(eventType, listener, async);
    };
    GridApi2.prototype.addGlobalListener = function(listener) {
      var async = this.gridOptionsService.useAsyncEvents();
      this.eventService.addGlobalListener(listener, async);
    };
    GridApi2.prototype.removeEventListener = function(eventType, listener) {
      var async = this.gridOptionsService.useAsyncEvents();
      this.eventService.removeEventListener(eventType, listener, async);
    };
    GridApi2.prototype.removeGlobalListener = function(listener) {
      var async = this.gridOptionsService.useAsyncEvents();
      this.eventService.removeGlobalListener(listener, async);
    };
    GridApi2.prototype.dispatchEvent = function(event) {
      this.eventService.dispatchEvent(event);
    };
    GridApi2.prototype.destroy = function() {
      if (this.destroyCalled) {
        return;
      }
      this.destroyCalled = true;
      var gridCtrl = this.ctrlsService.getGridCtrl();
      if (gridCtrl) {
        gridCtrl.destroyGridUi();
      }
      this.context.destroy();
    };
    GridApi2.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid = function() {
      setTimeout(removeAllReferences.bind(window, this, "Grid API"), 100);
    };
    GridApi2.prototype.warnIfDestroyed = function(methodName) {
      if (this.destroyCalled) {
        console.warn("AG Grid: Grid API method " + methodName + " was called on a grid that was destroyed.");
      }
      return this.destroyCalled;
    };
    GridApi2.prototype.resetQuickFilter = function() {
      if (this.warnIfDestroyed("resetQuickFilter")) {
        return;
      }
      this.filterManager.resetQuickFilterCache();
    };
    GridApi2.prototype.getCellRanges = function() {
      if (this.rangeService) {
        return this.rangeService.getCellRanges();
      }
      ModuleRegistry.__assertRegistered(ModuleNames.RangeSelectionModule, "api.getCellRanges", this.context.getGridId());
      return null;
    };
    GridApi2.prototype.addCellRange = function(params) {
      if (this.rangeService) {
        this.rangeService.addCellRange(params);
        return;
      }
      ModuleRegistry.__assertRegistered(ModuleNames.RangeSelectionModule, "api.addCellRange", this.context.getGridId());
    };
    GridApi2.prototype.clearRangeSelection = function() {
      if (this.rangeService) {
        this.rangeService.removeAllCellRanges();
      }
      ModuleRegistry.__assertRegistered(ModuleNames.RangeSelectionModule, "gridApi.clearRangeSelection", this.context.getGridId());
    };
    GridApi2.prototype.undoCellEditing = function() {
      this.undoRedoService.undo("api");
    };
    GridApi2.prototype.redoCellEditing = function() {
      this.undoRedoService.redo("api");
    };
    GridApi2.prototype.getCurrentUndoSize = function() {
      return this.undoRedoService.getCurrentUndoStackSize();
    };
    GridApi2.prototype.getCurrentRedoSize = function() {
      return this.undoRedoService.getCurrentRedoStackSize();
    };
    GridApi2.prototype.getChartModels = function() {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.getChartModels", this.context.getGridId())) {
        return this.chartService.getChartModels();
      }
    };
    GridApi2.prototype.getChartRef = function(chartId) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.getChartRef", this.context.getGridId())) {
        return this.chartService.getChartRef(chartId);
      }
    };
    GridApi2.prototype.getChartImageDataURL = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.getChartImageDataURL", this.context.getGridId())) {
        return this.chartService.getChartImageDataURL(params);
      }
    };
    GridApi2.prototype.downloadChart = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.downloadChart", this.context.getGridId())) {
        return this.chartService.downloadChart(params);
      }
    };
    GridApi2.prototype.openChartToolPanel = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.openChartToolPanel", this.context.getGridId())) {
        return this.chartService.openChartToolPanel(params);
      }
    };
    GridApi2.prototype.closeChartToolPanel = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.closeChartToolPanel", this.context.getGridId())) {
        return this.chartService.closeChartToolPanel(params.chartId);
      }
    };
    GridApi2.prototype.createRangeChart = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.createRangeChart", this.context.getGridId())) {
        return this.chartService.createRangeChart(params);
      }
    };
    GridApi2.prototype.createPivotChart = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.createPivotChart", this.context.getGridId())) {
        return this.chartService.createPivotChart(params);
      }
    };
    GridApi2.prototype.createCrossFilterChart = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.createCrossFilterChart", this.context.getGridId())) {
        return this.chartService.createCrossFilterChart(params);
      }
    };
    GridApi2.prototype.updateChart = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.updateChart", this.context.getGridId())) {
        this.chartService.updateChart(params);
      }
    };
    GridApi2.prototype.restoreChart = function(chartModel, chartContainer) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.GridChartsModule, "api.restoreChart", this.context.getGridId())) {
        return this.chartService.restoreChart(chartModel, chartContainer);
      }
    };
    GridApi2.prototype.copyToClipboard = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.ClipboardModule, "api.copyToClipboard", this.context.getGridId())) {
        this.clipboardService.copyToClipboard(params);
      }
    };
    GridApi2.prototype.cutToClipboard = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.ClipboardModule, "api.cutToClipboard", this.context.getGridId())) {
        this.clipboardService.cutToClipboard(params, "api");
      }
    };
    GridApi2.prototype.copySelectedRowsToClipboard = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.ClipboardModule, "api.copySelectedRowsToClipboard", this.context.getGridId())) {
        this.clipboardService.copySelectedRowsToClipboard(params);
      }
    };
    GridApi2.prototype.copySelectedRangeToClipboard = function(params) {
      if (ModuleRegistry.__assertRegistered(ModuleNames.ClipboardModule, "api.copySelectedRangeToClipboard", this.context.getGridId())) {
        this.clipboardService.copySelectedRangeToClipboard(params);
      }
    };
    GridApi2.prototype.copySelectedRangeDown = function() {
      if (ModuleRegistry.__assertRegistered(ModuleNames.ClipboardModule, "api.copySelectedRangeDown", this.context.getGridId())) {
        this.clipboardService.copyRangeDown();
      }
    };
    GridApi2.prototype.pasteFromClipboard = function() {
      if (ModuleRegistry.__assertRegistered(ModuleNames.ClipboardModule, "api.pasteFromClipboard", this.context.getGridId())) {
        this.clipboardService.pasteFromClipboard();
      }
    };
    GridApi2.prototype.showColumnMenuAfterButtonClick = function(colKey, buttonElement) {
      var column = this.columnModel.getGridColumn(colKey);
      this.menuFactory.showMenuAfterButtonClick(column, buttonElement, "columnMenu");
    };
    GridApi2.prototype.showColumnMenuAfterMouseClick = function(colKey, mouseEvent) {
      var column = this.columnModel.getGridColumn(colKey);
      if (!column) {
        column = this.columnModel.getPrimaryColumn(colKey);
      }
      if (!column) {
        console.error("AG Grid: column '" + colKey + "' not found");
        return;
      }
      this.menuFactory.showMenuAfterMouseEvent(column, mouseEvent);
    };
    GridApi2.prototype.hidePopupMenu = function() {
      if (this.contextMenuFactory) {
        this.contextMenuFactory.hideActiveMenu();
      }
      this.menuFactory.hideActiveMenu();
    };
    GridApi2.prototype.setPopupParent = function(ePopupParent) {
      this.gridOptionsService.set("popupParent", ePopupParent);
    };
    GridApi2.prototype.tabToNextCell = function(event) {
      return this.navigationService.tabToNextCell(false, event);
    };
    GridApi2.prototype.tabToPreviousCell = function(event) {
      return this.navigationService.tabToNextCell(true, event);
    };
    GridApi2.prototype.getCellRendererInstances = function(params) {
      if (params === void 0) {
        params = {};
      }
      var res = this.rowRenderer.getCellRendererInstances(params);
      var unwrapped = res.map(unwrapUserComp);
      return unwrapped;
    };
    GridApi2.prototype.getCellEditorInstances = function(params) {
      if (params === void 0) {
        params = {};
      }
      var res = this.rowRenderer.getCellEditorInstances(params);
      var unwrapped = res.map(unwrapUserComp);
      return unwrapped;
    };
    GridApi2.prototype.getEditingCells = function() {
      return this.rowRenderer.getEditingCells();
    };
    GridApi2.prototype.stopEditing = function(cancel) {
      if (cancel === void 0) {
        cancel = false;
      }
      this.rowRenderer.stopEditing(cancel);
    };
    GridApi2.prototype.startEditingCell = function(params) {
      var column = this.columnModel.getGridColumn(params.colKey);
      if (!column) {
        console.warn("AG Grid: no column found for " + params.colKey);
        return;
      }
      var cellPosition = {
        rowIndex: params.rowIndex,
        rowPinned: params.rowPinned || null,
        column
      };
      var notPinned = params.rowPinned == null;
      if (notPinned) {
        this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(params.rowIndex);
      }
      var cell = this.navigationService.getCellByPosition(cellPosition);
      if (!cell) {
        return;
      }
      cell.startRowOrCellEdit(params.key);
    };
    GridApi2.prototype.addAggFunc = function(key, aggFunc) {
      if (this.aggFuncService) {
        this.aggFuncService.addAggFunc(key, aggFunc);
      }
    };
    GridApi2.prototype.addAggFuncs = function(aggFuncs) {
      if (this.aggFuncService) {
        this.aggFuncService.addAggFuncs(aggFuncs);
      }
    };
    GridApi2.prototype.clearAggFuncs = function() {
      if (this.aggFuncService) {
        this.aggFuncService.clear();
      }
    };
    GridApi2.prototype.applyServerSideTransaction = function(transaction) {
      if (!this.serverSideTransactionManager) {
        this.logMissingRowModel("applyServerSideTransaction", "serverSide");
        return;
      }
      return this.serverSideTransactionManager.applyTransaction(transaction);
    };
    GridApi2.prototype.applyServerSideTransactionAsync = function(transaction, callback2) {
      if (!this.serverSideTransactionManager) {
        this.logMissingRowModel("applyServerSideTransactionAsync", "serverSide");
        return;
      }
      return this.serverSideTransactionManager.applyTransactionAsync(transaction, callback2);
    };
    GridApi2.prototype.retryServerSideLoads = function() {
      if (!this.serverSideRowModel) {
        this.logMissingRowModel("retryServerSideLoads", "serverSide");
        return;
      }
      this.serverSideRowModel.retryLoads();
    };
    GridApi2.prototype.flushServerSideAsyncTransactions = function() {
      if (!this.serverSideTransactionManager) {
        this.logMissingRowModel("flushServerSideAsyncTransactions", "serverSide");
        return;
      }
      return this.serverSideTransactionManager.flushAsyncTransactions();
    };
    GridApi2.prototype.applyTransaction = function(rowDataTransaction) {
      if (!this.clientSideRowModel) {
        this.logMissingRowModel("applyTransaction", "clientSide");
        return;
      }
      return this.clientSideRowModel.updateRowData(rowDataTransaction);
    };
    GridApi2.prototype.applyTransactionAsync = function(rowDataTransaction, callback2) {
      if (!this.clientSideRowModel) {
        this.logMissingRowModel("applyTransactionAsync", "clientSide");
        return;
      }
      this.clientSideRowModel.batchUpdateRowData(rowDataTransaction, callback2);
    };
    GridApi2.prototype.flushAsyncTransactions = function() {
      if (!this.clientSideRowModel) {
        this.logMissingRowModel("flushAsyncTransactions", "clientSide");
        return;
      }
      this.clientSideRowModel.flushAsyncTransactions();
    };
    GridApi2.prototype.setSuppressModelUpdateAfterUpdateTransaction = function(value) {
      this.gridOptionsService.set("suppressModelUpdateAfterUpdateTransaction", value);
    };
    GridApi2.prototype.refreshInfiniteCache = function() {
      if (this.infiniteRowModel) {
        this.infiniteRowModel.refreshCache();
      } else {
        this.logMissingRowModel("refreshInfiniteCache", "infinite");
      }
    };
    GridApi2.prototype.purgeInfiniteCache = function() {
      if (this.infiniteRowModel) {
        this.infiniteRowModel.purgeCache();
      } else {
        this.logMissingRowModel("purgeInfiniteCache", "infinite");
      }
    };
    GridApi2.prototype.refreshServerSide = function(params) {
      if (!this.serverSideRowModel) {
        this.logMissingRowModel("refreshServerSide", "serverSide");
        return;
      }
      this.serverSideRowModel.refreshStore(params);
    };
    GridApi2.prototype.refreshServerSideStore = function(params) {
      logDeprecation("28.0", "refreshServerSideStore", "refreshServerSide");
      return this.refreshServerSide(params);
    };
    GridApi2.prototype.getServerSideStoreState = function() {
      logDeprecation("28.0", "getServerSideStoreState", "getServerSideGroupLevelState");
      return this.getServerSideGroupLevelState();
    };
    GridApi2.prototype.getServerSideGroupLevelState = function() {
      if (!this.serverSideRowModel) {
        this.logMissingRowModel("getServerSideGroupLevelState", "serverSide");
        return [];
      }
      return this.serverSideRowModel.getStoreState();
    };
    GridApi2.prototype.getInfiniteRowCount = function() {
      if (this.infiniteRowModel) {
        return this.infiniteRowModel.getRowCount();
      } else {
        this.logMissingRowModel("getInfiniteRowCount", "infinite");
      }
    };
    GridApi2.prototype.isLastRowIndexKnown = function() {
      if (this.infiniteRowModel) {
        return this.infiniteRowModel.isLastRowIndexKnown();
      } else {
        this.logMissingRowModel("isLastRowIndexKnown", "infinite");
      }
    };
    GridApi2.prototype.getCacheBlockState = function() {
      return this.rowNodeBlockLoader.getBlockState();
    };
    GridApi2.prototype.getFirstDisplayedRow = function() {
      return this.rowRenderer.getFirstVirtualRenderedRow();
    };
    GridApi2.prototype.getLastDisplayedRow = function() {
      return this.rowRenderer.getLastVirtualRenderedRow();
    };
    GridApi2.prototype.getDisplayedRowAtIndex = function(index2) {
      return this.rowModel.getRow(index2);
    };
    GridApi2.prototype.getDisplayedRowCount = function() {
      return this.rowModel.getRowCount();
    };
    GridApi2.prototype.setDataTypeDefinitions = function(dataTypeDefinitions) {
      this.gridOptionsService.set("dataTypeDefinitions", dataTypeDefinitions);
    };
    GridApi2.prototype.setPagination = function(value) {
      this.gridOptionsService.set("pagination", value);
    };
    GridApi2.prototype.paginationIsLastPageFound = function() {
      return this.paginationProxy.isLastPageFound();
    };
    GridApi2.prototype.paginationGetPageSize = function() {
      return this.paginationProxy.getPageSize();
    };
    GridApi2.prototype.paginationSetPageSize = function(size) {
      this.gridOptionsService.set("paginationPageSize", size);
    };
    GridApi2.prototype.paginationGetCurrentPage = function() {
      return this.paginationProxy.getCurrentPage();
    };
    GridApi2.prototype.paginationGetTotalPages = function() {
      return this.paginationProxy.getTotalPages();
    };
    GridApi2.prototype.paginationGetRowCount = function() {
      return this.paginationProxy.getMasterRowCount();
    };
    GridApi2.prototype.paginationGoToNextPage = function() {
      this.paginationProxy.goToNextPage();
    };
    GridApi2.prototype.paginationGoToPreviousPage = function() {
      this.paginationProxy.goToPreviousPage();
    };
    GridApi2.prototype.paginationGoToFirstPage = function() {
      this.paginationProxy.goToFirstPage();
    };
    GridApi2.prototype.paginationGoToLastPage = function() {
      this.paginationProxy.goToLastPage();
    };
    GridApi2.prototype.paginationGoToPage = function(page) {
      this.paginationProxy.goToPage(page);
    };
    __decorate$1V([
      Optional("immutableService")
    ], GridApi2.prototype, "immutableService", void 0);
    __decorate$1V([
      Optional("csvCreator")
    ], GridApi2.prototype, "csvCreator", void 0);
    __decorate$1V([
      Optional("excelCreator")
    ], GridApi2.prototype, "excelCreator", void 0);
    __decorate$1V([
      Autowired("rowRenderer")
    ], GridApi2.prototype, "rowRenderer", void 0);
    __decorate$1V([
      Autowired("navigationService")
    ], GridApi2.prototype, "navigationService", void 0);
    __decorate$1V([
      Autowired("filterManager")
    ], GridApi2.prototype, "filterManager", void 0);
    __decorate$1V([
      Autowired("columnModel")
    ], GridApi2.prototype, "columnModel", void 0);
    __decorate$1V([
      Autowired("selectionService")
    ], GridApi2.prototype, "selectionService", void 0);
    __decorate$1V([
      Autowired("gridOptionsService")
    ], GridApi2.prototype, "gridOptionsService", void 0);
    __decorate$1V([
      Autowired("valueService")
    ], GridApi2.prototype, "valueService", void 0);
    __decorate$1V([
      Autowired("alignedGridsService")
    ], GridApi2.prototype, "alignedGridsService", void 0);
    __decorate$1V([
      Autowired("eventService")
    ], GridApi2.prototype, "eventService", void 0);
    __decorate$1V([
      Autowired("pinnedRowModel")
    ], GridApi2.prototype, "pinnedRowModel", void 0);
    __decorate$1V([
      Autowired("context")
    ], GridApi2.prototype, "context", void 0);
    __decorate$1V([
      Autowired("rowModel")
    ], GridApi2.prototype, "rowModel", void 0);
    __decorate$1V([
      Autowired("sortController")
    ], GridApi2.prototype, "sortController", void 0);
    __decorate$1V([
      Autowired("paginationProxy")
    ], GridApi2.prototype, "paginationProxy", void 0);
    __decorate$1V([
      Autowired("focusService")
    ], GridApi2.prototype, "focusService", void 0);
    __decorate$1V([
      Autowired("dragAndDropService")
    ], GridApi2.prototype, "dragAndDropService", void 0);
    __decorate$1V([
      Optional("rangeService")
    ], GridApi2.prototype, "rangeService", void 0);
    __decorate$1V([
      Optional("clipboardService")
    ], GridApi2.prototype, "clipboardService", void 0);
    __decorate$1V([
      Optional("aggFuncService")
    ], GridApi2.prototype, "aggFuncService", void 0);
    __decorate$1V([
      Autowired("menuFactory")
    ], GridApi2.prototype, "menuFactory", void 0);
    __decorate$1V([
      Optional("contextMenuFactory")
    ], GridApi2.prototype, "contextMenuFactory", void 0);
    __decorate$1V([
      Autowired("valueCache")
    ], GridApi2.prototype, "valueCache", void 0);
    __decorate$1V([
      Autowired("animationFrameService")
    ], GridApi2.prototype, "animationFrameService", void 0);
    __decorate$1V([
      Optional("statusBarService")
    ], GridApi2.prototype, "statusBarService", void 0);
    __decorate$1V([
      Optional("chartService")
    ], GridApi2.prototype, "chartService", void 0);
    __decorate$1V([
      Optional("undoRedoService")
    ], GridApi2.prototype, "undoRedoService", void 0);
    __decorate$1V([
      Optional("rowNodeBlockLoader")
    ], GridApi2.prototype, "rowNodeBlockLoader", void 0);
    __decorate$1V([
      Optional("ssrmTransactionManager")
    ], GridApi2.prototype, "serverSideTransactionManager", void 0);
    __decorate$1V([
      Autowired("ctrlsService")
    ], GridApi2.prototype, "ctrlsService", void 0);
    __decorate$1V([
      PostConstruct
    ], GridApi2.prototype, "init", null);
    __decorate$1V([
      PreDestroy
    ], GridApi2.prototype, "cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid", null);
    GridApi2 = __decorate$1V([
      Bean("gridApi")
    ], GridApi2);
    return GridApi2;
  }()
);
var __extends$23 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$c = function() {
  __assign$c = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$c.apply(this, arguments);
};
var __decorate$1U = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var FilterManager = (
  /** @class */
  function(_super) {
    __extends$23(FilterManager2, _super);
    function FilterManager2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.allColumnFilters = /* @__PURE__ */ new Map();
      _this.allColumnListeners = /* @__PURE__ */ new Map();
      _this.activeAggregateFilters = [];
      _this.activeColumnFilters = [];
      _this.quickFilter = null;
      _this.quickFilterParts = null;
      _this.processingFilterChange = false;
      return _this;
    }
    FilterManager_1 = FilterManager2;
    FilterManager2.prototype.init = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_GRID_COLUMNS_CHANGED, function() {
        return _this.onColumnsChanged();
      });
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VALUE_CHANGED, function() {
        return _this.refreshFiltersForAggregations();
      });
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_CHANGED, function() {
        return _this.refreshFiltersForAggregations();
      });
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_MODE_CHANGED, function() {
        _this.refreshFiltersForAggregations();
        _this.resetQuickFilterCache();
      });
      this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, function() {
        return _this.resetQuickFilterCache();
      });
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, function() {
        return _this.resetQuickFilterCache();
      });
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VISIBLE, function() {
        if (!_this.gridOptionsService.is("includeHiddenColumnsInQuickFilter")) {
          _this.resetQuickFilterCache();
        }
      });
      this.addManagedPropertyListener("quickFilterText", function(e) {
        return _this.setQuickFilter(e.currentValue);
      });
      this.addManagedPropertyListener("includeHiddenColumnsInQuickFilter", function() {
        return _this.onIncludeHiddenColumnsInQuickFilterChanged();
      });
      this.quickFilter = this.parseQuickFilter(this.gridOptionsService.get("quickFilterText"));
      this.setQuickFilterParts();
      this.allowShowChangeAfterFilter = this.gridOptionsService.is("allowShowChangeAfterFilter");
      this.externalFilterPresent = this.isExternalFilterPresentCallback();
      this.updateAggFiltering();
      this.addManagedPropertyListener("groupAggFiltering", function() {
        return _this.updateAggFiltering();
      });
    };
    FilterManager2.prototype.isExternalFilterPresentCallback = function() {
      var isFilterPresent = this.gridOptionsService.getCallback("isExternalFilterPresent");
      if (typeof isFilterPresent === "function") {
        return isFilterPresent({});
      }
      return false;
    };
    FilterManager2.prototype.doesExternalFilterPass = function(node) {
      var doesFilterPass = this.gridOptionsService.get("doesExternalFilterPass");
      if (typeof doesFilterPass === "function") {
        return doesFilterPass(node);
      }
      return false;
    };
    FilterManager2.prototype.setQuickFilterParts = function() {
      this.quickFilterParts = this.quickFilter ? this.quickFilter.split(" ") : null;
    };
    FilterManager2.prototype.setFilterModel = function(model) {
      var _this = this;
      var allPromises = [];
      var previousModel = this.getFilterModel();
      if (model) {
        var modelKeys_1 = convertToSet(Object.keys(model));
        this.allColumnFilters.forEach(function(filterWrapper, colId) {
          var newModel = model[colId];
          allPromises.push(_this.setModelOnFilterWrapper(filterWrapper.filterPromise, newModel));
          modelKeys_1.delete(colId);
        });
        modelKeys_1.forEach(function(colId) {
          var column = _this.columnModel.getPrimaryColumn(colId) || _this.columnModel.getGridColumn(colId);
          if (!column) {
            console.warn("AG Grid: setFilterModel() - no column found for colId: " + colId);
            return;
          }
          if (!column.isFilterAllowed()) {
            console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: " + colId);
            return;
          }
          var filterWrapper = _this.getOrCreateFilterWrapper(column, "NO_UI");
          if (!filterWrapper) {
            console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: " + colId);
            return;
          }
          allPromises.push(_this.setModelOnFilterWrapper(filterWrapper.filterPromise, model[colId]));
        });
      } else {
        this.allColumnFilters.forEach(function(filterWrapper) {
          allPromises.push(_this.setModelOnFilterWrapper(filterWrapper.filterPromise, null));
        });
      }
      AgPromise.all(allPromises).then(function() {
        var currentModel = _this.getFilterModel();
        var columns = [];
        _this.allColumnFilters.forEach(function(filterWrapper, colId) {
          var before = previousModel ? previousModel[colId] : null;
          var after = currentModel ? currentModel[colId] : null;
          if (!_.jsonEquals(before, after)) {
            columns.push(filterWrapper.column);
          }
        });
        if (columns.length > 0) {
          _this.onFilterChanged({ columns });
        }
      });
    };
    FilterManager2.prototype.setModelOnFilterWrapper = function(filterPromise, newModel) {
      return new AgPromise(function(resolve2) {
        filterPromise.then(function(filter) {
          if (typeof filter.setModel !== "function") {
            console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel");
            resolve2();
          }
          (filter.setModel(newModel) || AgPromise.resolve()).then(function() {
            return resolve2();
          });
        });
      });
    };
    FilterManager2.prototype.getFilterModel = function() {
      var result = {};
      this.allColumnFilters.forEach(function(filterWrapper, key) {
        var filterPromise = filterWrapper.filterPromise;
        var filter = filterPromise.resolveNow(null, function(promiseFilter) {
          return promiseFilter;
        });
        if (filter == null) {
          return null;
        }
        if (typeof filter.getModel !== "function") {
          console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel");
          return;
        }
        var model = filter.getModel();
        if (exists(model)) {
          result[key] = model;
        }
      });
      return result;
    };
    FilterManager2.prototype.isColumnFilterPresent = function() {
      return this.activeColumnFilters.length > 0;
    };
    FilterManager2.prototype.isAggregateFilterPresent = function() {
      return !!this.activeAggregateFilters.length;
    };
    FilterManager2.prototype.isExternalFilterPresent = function() {
      return this.externalFilterPresent;
    };
    FilterManager2.prototype.doAggregateFiltersPass = function(node, filterToSkip) {
      return this.doColumnFiltersPass(node, filterToSkip, true);
    };
    FilterManager2.prototype.updateActiveFilters = function() {
      var _this = this;
      this.activeColumnFilters.length = 0;
      this.activeAggregateFilters.length = 0;
      var isFilterActive = function(filter) {
        if (!filter) {
          return false;
        }
        if (!filter.isFilterActive) {
          console.warn("AG Grid: Filter is missing isFilterActive() method");
          return false;
        }
        return filter.isFilterActive();
      };
      var groupFilterEnabled = !!this.gridOptionsService.getGroupAggFiltering();
      var isAggFilter = function(column) {
        var isSecondary = !column.isPrimary();
        if (isSecondary) {
          return true;
        }
        var isShowingPrimaryColumns = !_this.columnModel.isPivotActive();
        var isValueActive = column.isValueActive();
        if (!isValueActive || !isShowingPrimaryColumns) {
          return false;
        }
        if (_this.columnModel.isPivotMode()) {
          return true;
        }
        return groupFilterEnabled;
      };
      this.allColumnFilters.forEach(function(filterWrapper) {
        if (filterWrapper.filterPromise.resolveNow(false, isFilterActive)) {
          var filterComp = filterWrapper.filterPromise.resolveNow(null, function(filter) {
            return filter;
          });
          if (isAggFilter(filterWrapper.column)) {
            _this.activeAggregateFilters.push(filterComp);
          } else {
            _this.activeColumnFilters.push(filterComp);
          }
        }
      });
    };
    FilterManager2.prototype.updateFilterFlagInColumns = function(source, additionalEventAttributes) {
      this.allColumnFilters.forEach(function(filterWrapper) {
        var isFilterActive = filterWrapper.filterPromise.resolveNow(false, function(filter) {
          return filter.isFilterActive();
        });
        filterWrapper.column.setFilterActive(isFilterActive, source, additionalEventAttributes);
      });
    };
    FilterManager2.prototype.isAnyFilterPresent = function() {
      return this.isQuickFilterPresent() || this.isColumnFilterPresent() || this.isAggregateFilterPresent() || this.isExternalFilterPresent();
    };
    FilterManager2.prototype.doColumnFiltersPass = function(node, filterToSkip, targetAggregates) {
      var data = node.data, aggData = node.aggData;
      var targetedFilters = targetAggregates ? this.activeAggregateFilters : this.activeColumnFilters;
      var targetedData = targetAggregates ? aggData : data;
      for (var i = 0; i < targetedFilters.length; i++) {
        var filter = targetedFilters[i];
        if (filter == null || filter === filterToSkip) {
          continue;
        }
        if (typeof filter.doesFilterPass !== "function") {
          throw new Error("Filter is missing method doesFilterPass");
        }
        if (!filter.doesFilterPass({ node, data: targetedData })) {
          return false;
        }
      }
      return true;
    };
    FilterManager2.prototype.parseQuickFilter = function(newFilter) {
      if (!exists(newFilter)) {
        return null;
      }
      if (!this.gridOptionsService.isRowModelType("clientSide")) {
        console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model");
        return null;
      }
      return newFilter.toUpperCase();
    };
    FilterManager2.prototype.setQuickFilter = function(newFilter) {
      if (newFilter != null && typeof newFilter !== "string") {
        console.warn("AG Grid - setQuickFilter() only supports string inputs, received: " + typeof newFilter);
        return;
      }
      var parsedFilter = this.parseQuickFilter(newFilter);
      if (this.quickFilter !== parsedFilter) {
        this.quickFilter = parsedFilter;
        this.setQuickFilterParts();
        this.onFilterChanged();
      }
    };
    FilterManager2.prototype.resetQuickFilterCache = function() {
      this.rowModel.forEachNode(function(node) {
        return node.quickFilterAggregateText = null;
      });
    };
    FilterManager2.prototype.onIncludeHiddenColumnsInQuickFilterChanged = function() {
      this.columnModel.refreshQuickFilterColumns();
      this.resetQuickFilterCache();
      if (this.isQuickFilterPresent()) {
        this.onFilterChanged();
      }
    };
    FilterManager2.prototype.refreshFiltersForAggregations = function() {
      var isAggFiltering = this.gridOptionsService.getGroupAggFiltering();
      if (isAggFiltering) {
        this.onFilterChanged();
      }
    };
    FilterManager2.prototype.callOnFilterChangedOutsideRenderCycle = function(params) {
      var _this = this;
      if (params === void 0) {
        params = {};
      }
      var action = function() {
        return _this.onFilterChanged(params);
      };
      if (this.rowRenderer.isRefreshInProgress()) {
        setTimeout(action, 0);
      } else {
        action();
      }
    };
    FilterManager2.prototype.onFilterChanged = function(params) {
      if (params === void 0) {
        params = {};
      }
      var filterInstance = params.filterInstance, additionalEventAttributes = params.additionalEventAttributes, columns = params.columns;
      this.updateDependantFilters();
      this.updateActiveFilters();
      this.updateFilterFlagInColumns("filterChanged", additionalEventAttributes);
      this.externalFilterPresent = this.isExternalFilterPresentCallback();
      this.allColumnFilters.forEach(function(filterWrapper) {
        if (!filterWrapper.filterPromise) {
          return;
        }
        filterWrapper.filterPromise.then(function(filter) {
          if (filter && filter !== filterInstance && filter.onAnyFilterChanged) {
            filter.onAnyFilterChanged();
          }
        });
      });
      var filterChangedEvent = {
        type: Events.EVENT_FILTER_CHANGED,
        columns: columns || []
      };
      if (additionalEventAttributes) {
        mergeDeep(filterChangedEvent, additionalEventAttributes);
      }
      this.processingFilterChange = true;
      this.eventService.dispatchEvent(filterChangedEvent);
      this.processingFilterChange = false;
    };
    FilterManager2.prototype.isSuppressFlashingCellsBecauseFiltering = function() {
      return !this.allowShowChangeAfterFilter && this.processingFilterChange;
    };
    FilterManager2.prototype.isQuickFilterPresent = function() {
      return this.quickFilter !== null;
    };
    FilterManager2.prototype.updateAggFiltering = function() {
      this.aggFiltering = !!this.gridOptionsService.getGroupAggFiltering();
    };
    FilterManager2.prototype.isAggregateQuickFilterPresent = function() {
      return this.isQuickFilterPresent() && (this.aggFiltering || this.columnModel.isPivotMode());
    };
    FilterManager2.prototype.isNonAggregateQuickFilterPresent = function() {
      return this.isQuickFilterPresent() && !(this.aggFiltering || this.columnModel.isPivotMode());
    };
    FilterManager2.prototype.doesRowPassOtherFilters = function(filterToSkip, node) {
      return this.doesRowPassFilter({ rowNode: node, filterInstanceToSkip: filterToSkip });
    };
    FilterManager2.prototype.doesRowPassQuickFilterNoCache = function(node, filterPart) {
      var _this = this;
      var columns = this.columnModel.getAllColumnsForQuickFilter();
      return columns.some(function(column) {
        var part = _this.getQuickFilterTextForColumn(column, node);
        return exists(part) && part.indexOf(filterPart) >= 0;
      });
    };
    FilterManager2.prototype.doesRowPassQuickFilterCache = function(node, filterPart) {
      if (!node.quickFilterAggregateText) {
        this.aggregateRowForQuickFilter(node);
      }
      return node.quickFilterAggregateText.indexOf(filterPart) >= 0;
    };
    FilterManager2.prototype.doesRowPassQuickFilter = function(node) {
      var _this = this;
      var usingCache = this.gridOptionsService.is("cacheQuickFilter");
      return this.quickFilterParts.every(function(part) {
        return usingCache ? _this.doesRowPassQuickFilterCache(node, part) : _this.doesRowPassQuickFilterNoCache(node, part);
      });
    };
    FilterManager2.prototype.doesRowPassAggregateFilters = function(params) {
      if (this.isAggregateQuickFilterPresent() && !this.doesRowPassQuickFilter(params.rowNode)) {
        return false;
      }
      if (this.isAggregateFilterPresent() && !this.doAggregateFiltersPass(params.rowNode, params.filterInstanceToSkip)) {
        return false;
      }
      return true;
    };
    FilterManager2.prototype.doesRowPassFilter = function(params) {
      if (this.isNonAggregateQuickFilterPresent() && !this.doesRowPassQuickFilter(params.rowNode)) {
        return false;
      }
      if (this.isExternalFilterPresent() && !this.doesExternalFilterPass(params.rowNode)) {
        return false;
      }
      if (this.isColumnFilterPresent() && !this.doColumnFiltersPass(params.rowNode, params.filterInstanceToSkip)) {
        return false;
      }
      return true;
    };
    FilterManager2.prototype.getQuickFilterTextForColumn = function(column, node) {
      var value = this.valueService.getValue(column, node, true);
      var colDef = column.getColDef();
      if (colDef.getQuickFilterText) {
        var params = {
          value,
          node,
          data: node.data,
          column,
          colDef,
          api: this.gridOptionsService.api,
          columnApi: this.gridOptionsService.columnApi,
          context: this.gridOptionsService.context
        };
        value = colDef.getQuickFilterText(params);
      }
      return exists(value) ? value.toString().toUpperCase() : null;
    };
    FilterManager2.prototype.aggregateRowForQuickFilter = function(node) {
      var _this = this;
      var stringParts = [];
      var columns = this.columnModel.getAllColumnsForQuickFilter();
      columns.forEach(function(column) {
        var part = _this.getQuickFilterTextForColumn(column, node);
        if (exists(part)) {
          stringParts.push(part);
        }
      });
      node.quickFilterAggregateText = stringParts.join(FilterManager_1.QUICK_FILTER_SEPARATOR);
    };
    FilterManager2.prototype.onNewRowsLoaded = function(source) {
      this.allColumnFilters.forEach(function(filterWrapper) {
        filterWrapper.filterPromise.then(function(filter) {
          if (filter.onNewRowsLoaded) {
            filter.onNewRowsLoaded();
          }
        });
      });
      this.updateFilterFlagInColumns(source, { afterDataChange: true });
      this.updateActiveFilters();
    };
    FilterManager2.prototype.createValueGetter = function(column) {
      var _this = this;
      return function(_a2) {
        var node = _a2.node;
        return _this.valueService.getValue(column, node, true);
      };
    };
    FilterManager2.prototype.getFilterComponent = function(column, source, createIfDoesNotExist) {
      var _a2;
      if (createIfDoesNotExist === void 0) {
        createIfDoesNotExist = true;
      }
      if (createIfDoesNotExist) {
        return ((_a2 = this.getOrCreateFilterWrapper(column, source)) === null || _a2 === void 0 ? void 0 : _a2.filterPromise) || null;
      }
      var filterWrapper = this.cachedFilter(column);
      return filterWrapper ? filterWrapper.filterPromise : null;
    };
    FilterManager2.prototype.isFilterActive = function(column) {
      var filterWrapper = this.cachedFilter(column);
      return !!filterWrapper && filterWrapper.filterPromise.resolveNow(false, function(filter) {
        return filter.isFilterActive();
      });
    };
    FilterManager2.prototype.getOrCreateFilterWrapper = function(column, source) {
      var _this = this;
      if (!column.isFilterAllowed()) {
        return null;
      }
      var filterWrapper = this.cachedFilter(column);
      if (!filterWrapper) {
        filterWrapper = this.createFilterWrapper(column, source);
        var colId_1 = column.getColId();
        this.allColumnFilters.set(colId_1, filterWrapper);
        this.allColumnListeners.set(colId_1, this.addManagedListener(column, Column.EVENT_COL_DEF_CHANGED, function() {
          return _this.checkDestroyFilter(colId_1);
        }));
      } else if (source !== "NO_UI") {
        this.putIntoGui(filterWrapper, source);
      }
      return filterWrapper;
    };
    FilterManager2.prototype.cachedFilter = function(column) {
      return this.allColumnFilters.get(column.getColId());
    };
    FilterManager2.prototype.getDefaultFilter = function(column) {
      var defaultFilter;
      if (ModuleRegistry.__isRegistered(ModuleNames.SetFilterModule, this.context.getGridId())) {
        defaultFilter = "agSetColumnFilter";
      } else {
        var cellDataType = column.getColDef().cellDataType;
        if (cellDataType === "number") {
          defaultFilter = "agNumberColumnFilter";
        } else if (cellDataType === "date" || cellDataType === "dateString") {
          defaultFilter = "agDateColumnFilter";
        } else {
          defaultFilter = "agTextColumnFilter";
        }
      }
      return defaultFilter;
    };
    FilterManager2.prototype.getDefaultFloatingFilter = function(column) {
      var defaultFloatingFilterType;
      if (ModuleRegistry.__isRegistered(ModuleNames.SetFilterModule, this.context.getGridId())) {
        defaultFloatingFilterType = "agSetColumnFloatingFilter";
      } else {
        var cellDataType = column.getColDef().cellDataType;
        if (cellDataType === "number") {
          defaultFloatingFilterType = "agNumberColumnFloatingFilter";
        } else if (cellDataType === "date" || cellDataType === "dateString") {
          defaultFloatingFilterType = "agDateColumnFloatingFilter";
        } else {
          defaultFloatingFilterType = "agTextColumnFloatingFilter";
        }
      }
      return defaultFloatingFilterType;
    };
    FilterManager2.prototype.createFilterInstance = function(column) {
      var _this = this;
      var defaultFilter = this.getDefaultFilter(column);
      var colDef = column.getColDef();
      var filterInstance;
      var params = __assign$c(__assign$c({}, this.createFilterParams(column, colDef)), { filterModifiedCallback: function() {
        var event = {
          type: Events.EVENT_FILTER_MODIFIED,
          column,
          filterInstance
        };
        _this.eventService.dispatchEvent(event);
      }, filterChangedCallback: function(additionalEventAttributes) {
        var params2 = { filterInstance, additionalEventAttributes, columns: [column] };
        _this.callOnFilterChangedOutsideRenderCycle(params2);
      }, doesRowPassOtherFilter: function(node) {
        return _this.doesRowPassOtherFilters(filterInstance, node);
      } });
      var compDetails = this.userComponentFactory.getFilterDetails(colDef, params, defaultFilter);
      if (!compDetails) {
        return { filterPromise: null, compDetails: null };
      }
      return {
        filterPromise: function() {
          var filterPromise = compDetails.newAgStackInstance();
          if (filterPromise) {
            filterPromise.then(function(r2) {
              return filterInstance = r2;
            });
          }
          return filterPromise;
        },
        compDetails
      };
    };
    FilterManager2.prototype.createFilterParams = function(column, colDef) {
      var params = {
        column,
        colDef: cloneObject(colDef),
        rowModel: this.rowModel,
        filterChangedCallback: function() {
        },
        filterModifiedCallback: function() {
        },
        valueGetter: this.createValueGetter(column),
        doesRowPassOtherFilter: function() {
          return true;
        },
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context
      };
      return params;
    };
    FilterManager2.prototype.createFilterWrapper = function(column, source) {
      var _a2;
      var filterWrapper = {
        column,
        filterPromise: null,
        compiledElement: null,
        guiPromise: AgPromise.resolve(null),
        compDetails: null
      };
      var _b2 = this.createFilterInstance(column), filterPromise = _b2.filterPromise, compDetails = _b2.compDetails;
      filterWrapper.filterPromise = (_a2 = filterPromise === null || filterPromise === void 0 ? void 0 : filterPromise()) !== null && _a2 !== void 0 ? _a2 : null;
      filterWrapper.compDetails = compDetails;
      if (filterPromise) {
        this.putIntoGui(filterWrapper, source);
      }
      return filterWrapper;
    };
    FilterManager2.prototype.putIntoGui = function(filterWrapper, source) {
      var _this = this;
      var eFilterGui = document.createElement("div");
      eFilterGui.className = "ag-filter";
      filterWrapper.guiPromise = new AgPromise(function(resolve2) {
        filterWrapper.filterPromise.then(function(filter) {
          var guiFromFilter = filter.getGui();
          if (!exists(guiFromFilter)) {
            console.warn("AG Grid: getGui method from filter returned " + guiFromFilter + ", it should be a DOM element or an HTML template string.");
          }
          if (typeof guiFromFilter === "string") {
            guiFromFilter = loadTemplate(guiFromFilter);
          }
          eFilterGui.appendChild(guiFromFilter);
          resolve2(eFilterGui);
          var event = {
            type: Events.EVENT_FILTER_OPENED,
            column: filterWrapper.column,
            source,
            eGui: eFilterGui
          };
          _this.eventService.dispatchEvent(event);
        });
      });
    };
    FilterManager2.prototype.onColumnsChanged = function() {
      var _this = this;
      var columns = [];
      this.allColumnFilters.forEach(function(wrapper, colId) {
        var currentColumn;
        if (wrapper.column.isPrimary()) {
          currentColumn = _this.columnModel.getPrimaryColumn(colId);
        } else {
          currentColumn = _this.columnModel.getGridColumn(colId);
        }
        if (currentColumn) {
          return;
        }
        columns.push(wrapper.column);
        _this.disposeFilterWrapper(wrapper, "columnChanged");
        _this.disposeColumnListener(colId);
      });
      if (columns.length > 0) {
        this.onFilterChanged({ columns });
      } else {
        this.updateDependantFilters();
      }
    };
    FilterManager2.prototype.updateDependantFilters = function() {
      var _this = this;
      var groupColumns = this.columnModel.getGroupAutoColumns();
      groupColumns === null || groupColumns === void 0 ? void 0 : groupColumns.forEach(function(groupColumn) {
        if (groupColumn.getColDef().filter === "agGroupColumnFilter") {
          _this.getOrCreateFilterWrapper(groupColumn, "NO_UI");
        }
      });
    };
    FilterManager2.prototype.isFilterAllowed = function(column) {
      var _a2, _b2;
      var isFilterAllowed = column.isFilterAllowed();
      if (!isFilterAllowed) {
        return false;
      }
      var filterWrapper = this.allColumnFilters.get(column.getColId());
      return (_b2 = (_a2 = filterWrapper === null || filterWrapper === void 0 ? void 0 : filterWrapper.filterPromise) === null || _a2 === void 0 ? void 0 : _a2.resolveNow(
        true,
        // defer to filter component isFilterAllowed if it exists
        function(filter) {
          var _a3, _b3;
          return typeof ((_a3 = filter) === null || _a3 === void 0 ? void 0 : _a3.isFilterAllowed) === "function" ? (_b3 = filter) === null || _b3 === void 0 ? void 0 : _b3.isFilterAllowed() : true;
        }
      )) !== null && _b2 !== void 0 ? _b2 : true;
    };
    FilterManager2.prototype.getFloatingFilterCompDetails = function(column, showParentFilter) {
      var _this = this;
      var colDef = column.getColDef();
      var filterParams = this.createFilterParams(column, colDef);
      var finalFilterParams = this.userComponentFactory.mergeParamsWithApplicationProvidedParams(colDef, FilterComponent, filterParams);
      var defaultFloatingFilterType = this.userComponentFactory.getDefaultFloatingFilterType(colDef, function() {
        return _this.getDefaultFloatingFilter(column);
      });
      if (defaultFloatingFilterType == null) {
        defaultFloatingFilterType = "agReadOnlyFloatingFilter";
      }
      var parentFilterInstance = function(callback2) {
        var filterComponent = _this.getFilterComponent(column, "NO_UI");
        if (filterComponent == null) {
          return;
        }
        filterComponent.then(function(instance) {
          callback2(unwrapUserComp(instance));
        });
      };
      var params = {
        column,
        filterParams: finalFilterParams,
        currentParentModel: function() {
          return _this.getCurrentFloatingFilterParentModel(column);
        },
        parentFilterInstance,
        showParentFilter,
        suppressFilterButton: false
        // This one might be overridden from the colDef
      };
      return this.userComponentFactory.getFloatingFilterCompDetails(colDef, params, defaultFloatingFilterType);
    };
    FilterManager2.prototype.getCurrentFloatingFilterParentModel = function(column) {
      var filterComponent = this.getFilterComponent(column, "NO_UI", false);
      return filterComponent ? filterComponent.resolveNow(null, function(filter) {
        return filter && filter.getModel();
      }) : null;
    };
    FilterManager2.prototype.destroyFilter = function(column, source) {
      if (source === void 0) {
        source = "api";
      }
      var colId = column.getColId();
      var filterWrapper = this.allColumnFilters.get(colId);
      this.disposeColumnListener(colId);
      if (filterWrapper) {
        this.disposeFilterWrapper(filterWrapper, source);
        this.onFilterChanged({ columns: [column] });
      }
    };
    FilterManager2.prototype.disposeColumnListener = function(colId) {
      var columnListener = this.allColumnListeners.get(colId);
      if (columnListener) {
        this.allColumnListeners.delete(colId);
        columnListener();
      }
    };
    FilterManager2.prototype.disposeFilterWrapper = function(filterWrapper, source) {
      var _this = this;
      filterWrapper.filterPromise.then(function(filter) {
        (filter.setModel(null) || AgPromise.resolve()).then(function() {
          _this.getContext().destroyBean(filter);
          filterWrapper.column.setFilterActive(false, "filterDestroyed");
          _this.allColumnFilters.delete(filterWrapper.column.getColId());
          var event = {
            type: Events.EVENT_FILTER_DESTROYED,
            source,
            column: filterWrapper.column
          };
          _this.eventService.dispatchEvent(event);
        });
      });
    };
    FilterManager2.prototype.checkDestroyFilter = function(colId) {
      var filterWrapper = this.allColumnFilters.get(colId);
      if (!filterWrapper) {
        return;
      }
      var column = filterWrapper.column;
      var compDetails = (column.isFilterAllowed() ? this.createFilterInstance(column) : { compDetails: null }).compDetails;
      var areFilterCompsDifferent = function(oldCompDetails, newCompDetails) {
        if (!newCompDetails || !oldCompDetails) {
          return true;
        }
        var oldComponentClass = oldCompDetails.componentClass;
        var newComponentClass = newCompDetails.componentClass;
        var isSameComponentClass = oldComponentClass === newComponentClass || // react hooks returns new wrappers, so check nested render method
        (oldComponentClass === null || oldComponentClass === void 0 ? void 0 : oldComponentClass.render) && (newComponentClass === null || newComponentClass === void 0 ? void 0 : newComponentClass.render) && oldComponentClass.render === newComponentClass.render;
        return !isSameComponentClass;
      };
      if (areFilterCompsDifferent(filterWrapper.compDetails, compDetails)) {
        this.destroyFilter(column, "columnChanged");
      }
    };
    FilterManager2.prototype.destroy = function() {
      var _this = this;
      _super.prototype.destroy.call(this);
      this.allColumnFilters.forEach(function(filterWrapper) {
        return _this.disposeFilterWrapper(filterWrapper, "gridDestroyed");
      });
      this.allColumnListeners.clear();
    };
    var FilterManager_1;
    FilterManager2.QUICK_FILTER_SEPARATOR = "\n";
    __decorate$1U([
      Autowired("valueService")
    ], FilterManager2.prototype, "valueService", void 0);
    __decorate$1U([
      Autowired("columnModel")
    ], FilterManager2.prototype, "columnModel", void 0);
    __decorate$1U([
      Autowired("rowModel")
    ], FilterManager2.prototype, "rowModel", void 0);
    __decorate$1U([
      Autowired("userComponentFactory")
    ], FilterManager2.prototype, "userComponentFactory", void 0);
    __decorate$1U([
      Autowired("rowRenderer")
    ], FilterManager2.prototype, "rowRenderer", void 0);
    __decorate$1U([
      PostConstruct
    ], FilterManager2.prototype, "init", null);
    FilterManager2 = FilterManager_1 = __decorate$1U([
      Bean("filterManager")
    ], FilterManager2);
    return FilterManager2;
  }(BeanStub)
);
var __extends$22 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AbstractHeaderCellComp = (
  /** @class */
  function(_super) {
    __extends$22(AbstractHeaderCellComp2, _super);
    function AbstractHeaderCellComp2(template, ctrl) {
      var _this = _super.call(this, template) || this;
      _this.ctrl = ctrl;
      return _this;
    }
    AbstractHeaderCellComp2.prototype.getCtrl = function() {
      return this.ctrl;
    };
    return AbstractHeaderCellComp2;
  }(Component)
);
var __extends$21 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1T = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderFilterCellComp$1 = (
  /** @class */
  function(_super) {
    __extends$21(HeaderFilterCellComp2, _super);
    function HeaderFilterCellComp2(ctrl) {
      return _super.call(this, HeaderFilterCellComp2.TEMPLATE, ctrl) || this;
    }
    HeaderFilterCellComp2.prototype.postConstruct = function() {
      var _this = this;
      var eGui = this.getGui();
      var compProxy = {
        addOrRemoveCssClass: function(cssClassName, on) {
          return _this.addOrRemoveCssClass(cssClassName, on);
        },
        addOrRemoveBodyCssClass: function(cssClassName, on) {
          return _this.eFloatingFilterBody.classList.toggle(cssClassName, on);
        },
        setButtonWrapperDisplayed: function(displayed) {
          return setDisplayed(_this.eButtonWrapper, displayed);
        },
        setCompDetails: function(compDetails) {
          return _this.setCompDetails(compDetails);
        },
        getFloatingFilterComp: function() {
          return _this.compPromise;
        },
        setWidth: function(width) {
          return eGui.style.width = width;
        },
        setMenuIcon: function(eIcon) {
          return _this.eButtonShowMainFilter.appendChild(eIcon);
        }
      };
      this.ctrl.setComp(compProxy, eGui, this.eButtonShowMainFilter, this.eFloatingFilterBody);
    };
    HeaderFilterCellComp2.prototype.setCompDetails = function(compDetails) {
      var _this = this;
      if (!compDetails) {
        this.destroyFloatingFilterComp();
        this.compPromise = null;
        return;
      }
      this.compPromise = compDetails.newAgStackInstance();
      this.compPromise.then(function(comp) {
        return _this.afterCompCreated(comp);
      });
    };
    HeaderFilterCellComp2.prototype.destroyFloatingFilterComp = function() {
      if (this.floatingFilterComp) {
        this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui());
        this.floatingFilterComp = this.destroyBean(this.floatingFilterComp);
      }
    };
    HeaderFilterCellComp2.prototype.afterCompCreated = function(comp) {
      if (!comp) {
        return;
      }
      if (!this.isAlive()) {
        this.destroyBean(comp);
        return;
      }
      this.destroyFloatingFilterComp();
      this.floatingFilterComp = comp;
      this.eFloatingFilterBody.appendChild(comp.getGui());
      if (comp.afterGuiAttached) {
        comp.afterGuiAttached();
      }
    };
    HeaderFilterCellComp2.TEMPLATE = '<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>';
    __decorate$1T([
      RefSelector("eFloatingFilterBody")
    ], HeaderFilterCellComp2.prototype, "eFloatingFilterBody", void 0);
    __decorate$1T([
      RefSelector("eButtonWrapper")
    ], HeaderFilterCellComp2.prototype, "eButtonWrapper", void 0);
    __decorate$1T([
      RefSelector("eButtonShowMainFilter")
    ], HeaderFilterCellComp2.prototype, "eButtonShowMainFilter", void 0);
    __decorate$1T([
      PostConstruct
    ], HeaderFilterCellComp2.prototype, "postConstruct", null);
    __decorate$1T([
      PreDestroy
    ], HeaderFilterCellComp2.prototype, "destroyFloatingFilterComp", null);
    return HeaderFilterCellComp2;
  }(AbstractHeaderCellComp)
);
var __extends$20 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1S = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var LayoutCssClasses;
(function(LayoutCssClasses2) {
  LayoutCssClasses2["AUTO_HEIGHT"] = "ag-layout-auto-height";
  LayoutCssClasses2["NORMAL"] = "ag-layout-normal";
  LayoutCssClasses2["PRINT"] = "ag-layout-print";
})(LayoutCssClasses || (LayoutCssClasses = {}));
var LayoutFeature = (
  /** @class */
  function(_super) {
    __extends$20(LayoutFeature2, _super);
    function LayoutFeature2(view) {
      var _this = _super.call(this) || this;
      _this.view = view;
      return _this;
    }
    LayoutFeature2.prototype.postConstruct = function() {
      this.addManagedPropertyListener("domLayout", this.updateLayoutClasses.bind(this));
      this.updateLayoutClasses();
    };
    LayoutFeature2.prototype.updateLayoutClasses = function() {
      var domLayout = this.getDomLayout();
      var params = {
        autoHeight: domLayout === "autoHeight",
        normal: domLayout === "normal",
        print: domLayout === "print"
      };
      var cssClass = params.autoHeight ? LayoutCssClasses.AUTO_HEIGHT : params.print ? LayoutCssClasses.PRINT : LayoutCssClasses.NORMAL;
      this.view.updateLayoutClasses(cssClass, params);
    };
    LayoutFeature2.prototype.getDomLayout = function() {
      var _a2;
      var domLayout = (_a2 = this.gridOptionsService.get("domLayout")) !== null && _a2 !== void 0 ? _a2 : "normal";
      var validLayouts = ["normal", "print", "autoHeight"];
      if (validLayouts.indexOf(domLayout) === -1) {
        doOnce(function() {
          return console.warn("AG Grid: " + domLayout + " is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.");
        }, "warn about dom layout values");
        return "normal";
      }
      return domLayout;
    };
    __decorate$1S([
      PostConstruct
    ], LayoutFeature2.prototype, "postConstruct", null);
    return LayoutFeature2;
  }(BeanStub)
);
var __extends$1$ = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$b = function() {
  __assign$b = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$b.apply(this, arguments);
};
var __decorate$1R = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ScrollDirection;
(function(ScrollDirection2) {
  ScrollDirection2[ScrollDirection2["Vertical"] = 0] = "Vertical";
  ScrollDirection2[ScrollDirection2["Horizontal"] = 1] = "Horizontal";
})(ScrollDirection || (ScrollDirection = {}));
var ScrollSource;
(function(ScrollSource2) {
  ScrollSource2[ScrollSource2["Container"] = 0] = "Container";
  ScrollSource2[ScrollSource2["FakeContainer"] = 1] = "FakeContainer";
})(ScrollSource || (ScrollSource = {}));
var GridBodyScrollFeature = (
  /** @class */
  function(_super) {
    __extends$1$(GridBodyScrollFeature2, _super);
    function GridBodyScrollFeature2(eBodyViewport) {
      var _this = _super.call(this) || this;
      _this.lastScrollSource = [null, null];
      _this.scrollLeft = -1;
      _this.nextScrollTop = -1;
      _this.scrollTop = -1;
      _this.eBodyViewport = eBodyViewport;
      _this.resetLastHScrollDebounced = debounce$1(function() {
        return _this.lastScrollSource[ScrollDirection.Horizontal] = null;
      }, 500);
      _this.resetLastVScrollDebounced = debounce$1(function() {
        return _this.lastScrollSource[ScrollDirection.Vertical] = null;
      }, 500);
      return _this;
    }
    GridBodyScrollFeature2.prototype.postConstruct = function() {
      var _this = this;
      this.enableRtl = this.gridOptionsService.is("enableRtl");
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, this.onDisplayedColumnsWidthChanged.bind(this));
      this.ctrlsService.whenReady(function(p2) {
        _this.centerRowContainerCtrl = p2.centerRowContainerCtrl;
        _this.onDisplayedColumnsWidthChanged();
        _this.addScrollListener();
      });
    };
    GridBodyScrollFeature2.prototype.addScrollListener = function() {
      var fakeHScroll = this.ctrlsService.getFakeHScrollComp();
      var fakeVScroll = this.ctrlsService.getFakeVScrollComp();
      this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(), "scroll", this.onHScroll.bind(this));
      fakeHScroll.onScrollCallback(this.onFakeHScroll.bind(this));
      var isDebounce = this.gridOptionsService.is("debounceVerticalScrollbar");
      var onVScroll = isDebounce ? debounce$1(this.onVScroll.bind(this), 100) : this.onVScroll.bind(this);
      var onFakeVScroll = isDebounce ? debounce$1(this.onFakeVScroll.bind(this), 100) : this.onFakeVScroll.bind(this);
      this.addManagedListener(this.eBodyViewport, "scroll", onVScroll);
      fakeVScroll.onScrollCallback(onFakeVScroll);
    };
    GridBodyScrollFeature2.prototype.onDisplayedColumnsWidthChanged = function() {
      if (this.enableRtl) {
        this.horizontallyScrollHeaderCenterAndFloatingCenter();
      }
    };
    GridBodyScrollFeature2.prototype.horizontallyScrollHeaderCenterAndFloatingCenter = function(scrollLeft) {
      var notYetInitialised = this.centerRowContainerCtrl == null;
      if (notYetInitialised) {
        return;
      }
      if (scrollLeft === void 0) {
        scrollLeft = this.centerRowContainerCtrl.getCenterViewportScrollLeft();
      }
      var offset2 = this.enableRtl ? scrollLeft : -scrollLeft;
      var topCenterContainer = this.ctrlsService.getTopCenterRowContainerCtrl();
      var stickyTopCenterContainer = this.ctrlsService.getStickyTopCenterRowContainerCtrl();
      var bottomCenterContainer = this.ctrlsService.getBottomCenterRowContainerCtrl();
      var fakeHScroll = this.ctrlsService.getFakeHScrollComp();
      var centerHeaderContainer = this.ctrlsService.getHeaderRowContainerCtrl();
      centerHeaderContainer.setHorizontalScroll(-offset2);
      bottomCenterContainer.setContainerTranslateX(offset2);
      topCenterContainer.setContainerTranslateX(offset2);
      stickyTopCenterContainer.setContainerTranslateX(offset2);
      var centerViewport = this.centerRowContainerCtrl.getViewportElement();
      var isCenterViewportLastHorizontal = this.lastScrollSource[ScrollDirection.Horizontal] === ScrollSource.Container;
      scrollLeft = Math.abs(scrollLeft);
      if (isCenterViewportLastHorizontal) {
        fakeHScroll.setScrollPosition(scrollLeft);
      } else {
        setScrollLeft(centerViewport, scrollLeft, this.enableRtl);
      }
    };
    GridBodyScrollFeature2.prototype.isControllingScroll = function(source, direction) {
      if (this.lastScrollSource[direction] == null) {
        this.lastScrollSource[direction] = source;
        return true;
      }
      return this.lastScrollSource[direction] === source;
    };
    GridBodyScrollFeature2.prototype.onFakeHScroll = function() {
      if (!this.isControllingScroll(ScrollSource.FakeContainer, ScrollDirection.Horizontal)) {
        return;
      }
      this.onHScrollCommon(ScrollSource.FakeContainer);
    };
    GridBodyScrollFeature2.prototype.onHScroll = function() {
      if (!this.isControllingScroll(ScrollSource.Container, ScrollDirection.Horizontal)) {
        return;
      }
      this.onHScrollCommon(ScrollSource.Container);
    };
    GridBodyScrollFeature2.prototype.onHScrollCommon = function(source) {
      var centerContainerViewport = this.centerRowContainerCtrl.getViewportElement();
      var scrollLeft = centerContainerViewport.scrollLeft;
      if (this.shouldBlockScrollUpdate(ScrollDirection.Horizontal, scrollLeft, true)) {
        return;
      }
      var newScrollLeft;
      if (source === ScrollSource.Container) {
        newScrollLeft = getScrollLeft(centerContainerViewport, this.enableRtl);
      } else {
        newScrollLeft = this.ctrlsService.getFakeHScrollComp().getScrollPosition();
      }
      this.doHorizontalScroll(Math.round(newScrollLeft));
      this.resetLastHScrollDebounced();
    };
    GridBodyScrollFeature2.prototype.onFakeVScroll = function() {
      if (!this.isControllingScroll(ScrollSource.FakeContainer, ScrollDirection.Vertical)) {
        return;
      }
      this.onVScrollCommon(ScrollSource.FakeContainer);
    };
    GridBodyScrollFeature2.prototype.onVScroll = function() {
      if (!this.isControllingScroll(ScrollSource.Container, ScrollDirection.Vertical)) {
        return;
      }
      this.onVScrollCommon(ScrollSource.Container);
    };
    GridBodyScrollFeature2.prototype.onVScrollCommon = function(source) {
      var scrollTop;
      if (source === ScrollSource.Container) {
        scrollTop = this.eBodyViewport.scrollTop;
      } else {
        scrollTop = this.ctrlsService.getFakeVScrollComp().getScrollPosition();
      }
      if (this.shouldBlockScrollUpdate(ScrollDirection.Vertical, scrollTop, true)) {
        return;
      }
      this.animationFrameService.setScrollTop(scrollTop);
      this.nextScrollTop = scrollTop;
      if (source === ScrollSource.Container) {
        this.ctrlsService.getFakeVScrollComp().setScrollPosition(scrollTop);
      } else {
        this.eBodyViewport.scrollTop = scrollTop;
      }
      if (this.gridOptionsService.is("suppressAnimationFrame")) {
        this.scrollGridIfNeeded();
      } else {
        this.animationFrameService.schedule();
      }
      this.resetLastVScrollDebounced();
    };
    GridBodyScrollFeature2.prototype.doHorizontalScroll = function(scrollLeft) {
      var fakeScrollLeft = this.ctrlsService.getFakeHScrollComp().getScrollPosition();
      if (this.scrollLeft === scrollLeft && scrollLeft === fakeScrollLeft) {
        return;
      }
      this.scrollLeft = scrollLeft;
      this.fireScrollEvent(ScrollDirection.Horizontal);
      this.horizontallyScrollHeaderCenterAndFloatingCenter(scrollLeft);
      this.onHorizontalViewportChanged();
    };
    GridBodyScrollFeature2.prototype.fireScrollEvent = function(direction) {
      var _this = this;
      var bodyScrollEvent = {
        type: Events.EVENT_BODY_SCROLL,
        direction: direction === ScrollDirection.Horizontal ? "horizontal" : "vertical",
        left: this.scrollLeft,
        top: this.scrollTop
      };
      this.eventService.dispatchEvent(bodyScrollEvent);
      window.clearTimeout(this.scrollTimer);
      this.scrollTimer = void 0;
      this.scrollTimer = window.setTimeout(function() {
        var bodyScrollEndEvent = __assign$b(__assign$b({}, bodyScrollEvent), { type: Events.EVENT_BODY_SCROLL_END });
        _this.eventService.dispatchEvent(bodyScrollEndEvent);
      }, 100);
    };
    GridBodyScrollFeature2.prototype.shouldBlockScrollUpdate = function(direction, scrollTo, touchOnly) {
      if (touchOnly === void 0) {
        touchOnly = false;
      }
      if (touchOnly && !isIOSUserAgent()) {
        return false;
      }
      if (direction === ScrollDirection.Vertical) {
        return this.shouldBlockVerticalScroll(scrollTo);
      }
      return this.shouldBlockHorizontalScroll(scrollTo);
    };
    GridBodyScrollFeature2.prototype.shouldBlockVerticalScroll = function(scrollTo) {
      var clientHeight = getInnerHeight(this.eBodyViewport);
      var scrollHeight = this.eBodyViewport.scrollHeight;
      if (scrollTo < 0 || scrollTo + clientHeight > scrollHeight) {
        return true;
      }
      return false;
    };
    GridBodyScrollFeature2.prototype.shouldBlockHorizontalScroll = function(scrollTo) {
      var clientWidth = this.centerRowContainerCtrl.getCenterWidth();
      var scrollWidth = this.centerRowContainerCtrl.getViewportElement().scrollWidth;
      if (this.enableRtl && isRtlNegativeScroll()) {
        if (scrollTo > 0) {
          return true;
        }
      } else if (scrollTo < 0) {
        return true;
      }
      if (Math.abs(scrollTo) + clientWidth > scrollWidth) {
        return true;
      }
      return false;
    };
    GridBodyScrollFeature2.prototype.redrawRowsAfterScroll = function() {
      this.fireScrollEvent(ScrollDirection.Vertical);
    };
    GridBodyScrollFeature2.prototype.onHorizontalViewportChanged = function() {
      this.centerRowContainerCtrl.onHorizontalViewportChanged();
    };
    GridBodyScrollFeature2.prototype.checkScrollLeft = function() {
      if (this.scrollLeft !== this.centerRowContainerCtrl.getCenterViewportScrollLeft()) {
        this.onHScrollCommon(ScrollSource.Container);
      }
    };
    GridBodyScrollFeature2.prototype.scrollGridIfNeeded = function() {
      var frameNeeded = this.scrollTop != this.nextScrollTop;
      if (frameNeeded) {
        this.scrollTop = this.nextScrollTop;
        this.redrawRowsAfterScroll();
      }
      return frameNeeded;
    };
    GridBodyScrollFeature2.prototype.setHorizontalScrollPosition = function(hScrollPosition, fromAlignedGridsService) {
      if (fromAlignedGridsService === void 0) {
        fromAlignedGridsService = false;
      }
      var minScrollLeft = 0;
      var maxScrollLeft = this.centerRowContainerCtrl.getViewportElement().scrollWidth - this.centerRowContainerCtrl.getCenterWidth();
      if (!fromAlignedGridsService && this.shouldBlockScrollUpdate(ScrollDirection.Horizontal, hScrollPosition)) {
        if (this.enableRtl && isRtlNegativeScroll()) {
          hScrollPosition = hScrollPosition > 0 ? 0 : maxScrollLeft;
        } else {
          hScrollPosition = Math.min(Math.max(hScrollPosition, minScrollLeft), maxScrollLeft);
        }
      }
      setScrollLeft(this.centerRowContainerCtrl.getViewportElement(), Math.abs(hScrollPosition), this.enableRtl);
      this.doHorizontalScroll(hScrollPosition);
    };
    GridBodyScrollFeature2.prototype.setVerticalScrollPosition = function(vScrollPosition) {
      this.eBodyViewport.scrollTop = vScrollPosition;
    };
    GridBodyScrollFeature2.prototype.getVScrollPosition = function() {
      var result = {
        top: this.eBodyViewport.scrollTop,
        bottom: this.eBodyViewport.scrollTop + this.eBodyViewport.offsetHeight
      };
      return result;
    };
    GridBodyScrollFeature2.prototype.getHScrollPosition = function() {
      return this.centerRowContainerCtrl.getHScrollPosition();
    };
    GridBodyScrollFeature2.prototype.isHorizontalScrollShowing = function() {
      return this.centerRowContainerCtrl.isHorizontalScrollShowing();
    };
    GridBodyScrollFeature2.prototype.scrollHorizontally = function(pixels) {
      var oldScrollPosition = this.centerRowContainerCtrl.getViewportElement().scrollLeft;
      this.setHorizontalScrollPosition(oldScrollPosition + pixels);
      return this.centerRowContainerCtrl.getViewportElement().scrollLeft - oldScrollPosition;
    };
    GridBodyScrollFeature2.prototype.scrollToTop = function() {
      this.eBodyViewport.scrollTop = 0;
    };
    GridBodyScrollFeature2.prototype.ensureNodeVisible = function(comparator, position) {
      if (position === void 0) {
        position = null;
      }
      var rowCount = this.rowModel.getRowCount();
      var indexToSelect = -1;
      for (var i = 0; i < rowCount; i++) {
        var node = this.rowModel.getRow(i);
        if (typeof comparator === "function") {
          var predicate = comparator;
          if (node && predicate(node)) {
            indexToSelect = i;
            break;
          }
        } else {
          if (comparator === node || comparator === node.data) {
            indexToSelect = i;
            break;
          }
        }
      }
      if (indexToSelect >= 0) {
        this.ensureIndexVisible(indexToSelect, position);
      }
    };
    GridBodyScrollFeature2.prototype.ensureIndexVisible = function(index2, position) {
      if (this.gridOptionsService.isDomLayout("print")) {
        return;
      }
      var rowCount = this.paginationProxy.getRowCount();
      if (typeof index2 !== "number" || index2 < 0 || index2 >= rowCount) {
        console.warn("AG Grid: Invalid row index for ensureIndexVisible: " + index2);
        return;
      }
      var isPaging = this.gridOptionsService.is("pagination");
      var paginationPanelEnabled = isPaging && !this.gridOptionsService.is("suppressPaginationPanel");
      if (!paginationPanelEnabled) {
        this.paginationProxy.goToPageWithIndex(index2);
      }
      var gridBodyCtrl = this.ctrlsService.getGridBodyCtrl();
      var stickyTopHeight = gridBodyCtrl.getStickyTopHeight();
      var rowNode = this.paginationProxy.getRow(index2);
      var rowGotShiftedDuringOperation;
      do {
        var startingRowTop = rowNode.rowTop;
        var startingRowHeight = rowNode.rowHeight;
        var paginationOffset = this.paginationProxy.getPixelOffset();
        var rowTopPixel = rowNode.rowTop - paginationOffset;
        var rowBottomPixel = rowTopPixel + rowNode.rowHeight;
        var scrollPosition = this.getVScrollPosition();
        var heightOffset = this.heightScaler.getDivStretchOffset();
        var vScrollTop = scrollPosition.top + heightOffset;
        var vScrollBottom = scrollPosition.bottom + heightOffset;
        var viewportHeight = vScrollBottom - vScrollTop;
        var pxTop = this.heightScaler.getScrollPositionForPixel(rowTopPixel);
        var pxBottom = this.heightScaler.getScrollPositionForPixel(rowBottomPixel - viewportHeight);
        var pxMiddle = Math.min((pxTop + pxBottom) / 2, rowTopPixel);
        var rowAboveViewport = vScrollTop + stickyTopHeight > rowTopPixel;
        var rowBelowViewport = vScrollBottom < rowBottomPixel;
        var newScrollPosition = null;
        if (position === "top") {
          newScrollPosition = pxTop;
        } else if (position === "bottom") {
          newScrollPosition = pxBottom;
        } else if (position === "middle") {
          newScrollPosition = pxMiddle;
        } else if (rowAboveViewport) {
          newScrollPosition = pxTop - stickyTopHeight;
        } else if (rowBelowViewport) {
          newScrollPosition = pxBottom;
        }
        if (newScrollPosition !== null) {
          this.setVerticalScrollPosition(newScrollPosition);
          this.rowRenderer.redraw();
        }
        rowGotShiftedDuringOperation = startingRowTop !== rowNode.rowTop || startingRowHeight !== rowNode.rowHeight;
      } while (rowGotShiftedDuringOperation);
      this.animationFrameService.flushAllFrames();
    };
    GridBodyScrollFeature2.prototype.ensureColumnVisible = function(key, position) {
      if (position === void 0) {
        position = "auto";
      }
      var column = this.columnModel.getGridColumn(key);
      if (!column) {
        return;
      }
      if (column.isPinned()) {
        return;
      }
      if (!this.columnModel.isColumnDisplayed(column)) {
        return;
      }
      var newHorizontalScroll = this.getPositionedHorizontalScroll(column, position);
      if (newHorizontalScroll !== null) {
        this.centerRowContainerCtrl.setCenterViewportScrollLeft(newHorizontalScroll);
      }
      this.centerRowContainerCtrl.onHorizontalViewportChanged();
      this.animationFrameService.flushAllFrames();
    };
    GridBodyScrollFeature2.prototype.getPositionedHorizontalScroll = function(column, position) {
      var _a2 = this.isColumnOutsideViewport(column), columnBeforeStart = _a2.columnBeforeStart, columnAfterEnd = _a2.columnAfterEnd;
      var viewportTooSmallForColumn = this.centerRowContainerCtrl.getCenterWidth() < column.getActualWidth();
      var viewportWidth = this.centerRowContainerCtrl.getCenterWidth();
      var isRtl = this.enableRtl;
      var alignColToStart = (isRtl ? columnBeforeStart : columnAfterEnd) || viewportTooSmallForColumn;
      var alignColToEnd = isRtl ? columnAfterEnd : columnBeforeStart;
      if (position !== "auto") {
        alignColToStart = position === "start";
        alignColToEnd = position === "end";
      }
      var isMiddle = position === "middle";
      if (alignColToStart || alignColToEnd || isMiddle) {
        var _b2 = this.getColumnBounds(column), colLeft = _b2.colLeft, colMiddle = _b2.colMiddle, colRight = _b2.colRight;
        if (isMiddle) {
          return colMiddle - viewportWidth / 2;
        }
        if (alignColToStart) {
          return isRtl ? colRight : colLeft;
        }
        return isRtl ? colLeft - viewportWidth : colRight - viewportWidth;
      }
      return null;
    };
    GridBodyScrollFeature2.prototype.isColumnOutsideViewport = function(column) {
      var _a2 = this.getViewportBounds(), viewportStart = _a2.start, viewportEnd = _a2.end;
      var _b2 = this.getColumnBounds(column), colLeft = _b2.colLeft, colRight = _b2.colRight;
      var isRtl = this.enableRtl;
      var columnBeforeStart = isRtl ? viewportStart > colRight : viewportEnd < colRight;
      var columnAfterEnd = isRtl ? viewportEnd < colLeft : viewportStart > colLeft;
      return { columnBeforeStart, columnAfterEnd };
    };
    GridBodyScrollFeature2.prototype.getColumnBounds = function(column) {
      var isRtl = this.enableRtl;
      var bodyWidth = this.columnModel.getBodyContainerWidth();
      var colWidth = column.getActualWidth();
      var colLeft = column.getLeft();
      var multiplier = isRtl ? -1 : 1;
      var colLeftPixel = isRtl ? bodyWidth - colLeft : colLeft;
      var colRightPixel = colLeftPixel + colWidth * multiplier;
      var colMidPixel = colLeftPixel + colWidth / 2 * multiplier;
      return { colLeft: colLeftPixel, colMiddle: colMidPixel, colRight: colRightPixel };
    };
    GridBodyScrollFeature2.prototype.getViewportBounds = function() {
      var viewportWidth = this.centerRowContainerCtrl.getCenterWidth();
      var scrollPosition = this.centerRowContainerCtrl.getCenterViewportScrollLeft();
      var viewportStartPixel = scrollPosition;
      var viewportEndPixel = viewportWidth + scrollPosition;
      return { start: viewportStartPixel, end: viewportEndPixel, width: viewportWidth };
    };
    __decorate$1R([
      Autowired("ctrlsService")
    ], GridBodyScrollFeature2.prototype, "ctrlsService", void 0);
    __decorate$1R([
      Autowired("animationFrameService")
    ], GridBodyScrollFeature2.prototype, "animationFrameService", void 0);
    __decorate$1R([
      Autowired("paginationProxy")
    ], GridBodyScrollFeature2.prototype, "paginationProxy", void 0);
    __decorate$1R([
      Autowired("rowModel")
    ], GridBodyScrollFeature2.prototype, "rowModel", void 0);
    __decorate$1R([
      Autowired("rowContainerHeightService")
    ], GridBodyScrollFeature2.prototype, "heightScaler", void 0);
    __decorate$1R([
      Autowired("rowRenderer")
    ], GridBodyScrollFeature2.prototype, "rowRenderer", void 0);
    __decorate$1R([
      Autowired("columnModel")
    ], GridBodyScrollFeature2.prototype, "columnModel", void 0);
    __decorate$1R([
      PostConstruct
    ], GridBodyScrollFeature2.prototype, "postConstruct", null);
    return GridBodyScrollFeature2;
  }(BeanStub)
);
var AutoScrollService = (
  /** @class */
  function() {
    function AutoScrollService2(params) {
      this.tickingInterval = null;
      this.onScrollCallback = null;
      this.scrollContainer = params.scrollContainer;
      this.scrollHorizontally = params.scrollAxis.indexOf("x") !== -1;
      this.scrollVertically = params.scrollAxis.indexOf("y") !== -1;
      this.scrollByTick = params.scrollByTick != null ? params.scrollByTick : 20;
      if (params.onScrollCallback) {
        this.onScrollCallback = params.onScrollCallback;
      }
      if (this.scrollVertically) {
        this.getVerticalPosition = params.getVerticalPosition;
        this.setVerticalPosition = params.setVerticalPosition;
      }
      if (this.scrollHorizontally) {
        this.getHorizontalPosition = params.getHorizontalPosition;
        this.setHorizontalPosition = params.setHorizontalPosition;
      }
      this.shouldSkipVerticalScroll = params.shouldSkipVerticalScroll || function() {
        return false;
      };
      this.shouldSkipHorizontalScroll = params.shouldSkipHorizontalScroll || function() {
        return false;
      };
    }
    AutoScrollService2.prototype.check = function(mouseEvent, forceSkipVerticalScroll) {
      if (forceSkipVerticalScroll === void 0) {
        forceSkipVerticalScroll = false;
      }
      var skipVerticalScroll = forceSkipVerticalScroll || this.shouldSkipVerticalScroll();
      if (skipVerticalScroll && this.shouldSkipHorizontalScroll()) {
        return;
      }
      var rect = this.scrollContainer.getBoundingClientRect();
      var scrollTick = this.scrollByTick;
      this.tickLeft = mouseEvent.clientX < rect.left + scrollTick;
      this.tickRight = mouseEvent.clientX > rect.right - scrollTick;
      this.tickUp = mouseEvent.clientY < rect.top + scrollTick && !skipVerticalScroll;
      this.tickDown = mouseEvent.clientY > rect.bottom - scrollTick && !skipVerticalScroll;
      if (this.tickLeft || this.tickRight || this.tickUp || this.tickDown) {
        this.ensureTickingStarted();
      } else {
        this.ensureCleared();
      }
    };
    AutoScrollService2.prototype.ensureTickingStarted = function() {
      if (this.tickingInterval === null) {
        this.tickingInterval = window.setInterval(this.doTick.bind(this), 100);
        this.tickCount = 0;
      }
    };
    AutoScrollService2.prototype.doTick = function() {
      this.tickCount++;
      var tickAmount;
      tickAmount = this.tickCount > 20 ? 200 : this.tickCount > 10 ? 80 : 40;
      if (this.scrollVertically) {
        var vScrollPosition = this.getVerticalPosition();
        if (this.tickUp) {
          this.setVerticalPosition(vScrollPosition - tickAmount);
        }
        if (this.tickDown) {
          this.setVerticalPosition(vScrollPosition + tickAmount);
        }
      }
      if (this.scrollHorizontally) {
        var hScrollPosition = this.getHorizontalPosition();
        if (this.tickLeft) {
          this.setHorizontalPosition(hScrollPosition - tickAmount);
        }
        if (this.tickRight) {
          this.setHorizontalPosition(hScrollPosition + tickAmount);
        }
      }
      if (this.onScrollCallback) {
        this.onScrollCallback();
      }
    };
    AutoScrollService2.prototype.ensureCleared = function() {
      if (this.tickingInterval) {
        window.clearInterval(this.tickingInterval);
        this.tickingInterval = null;
      }
    };
    return AutoScrollService2;
  }()
);
var __extends$1_ = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$a = function() {
  __assign$a = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$a.apply(this, arguments);
};
var __decorate$1Q = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$m = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$i = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var RowDragFeature = (
  /** @class */
  function(_super) {
    __extends$1_(RowDragFeature2, _super);
    function RowDragFeature2(eContainer) {
      var _this = _super.call(this) || this;
      _this.isMultiRowDrag = false;
      _this.isGridSorted = false;
      _this.isGridFiltered = false;
      _this.isRowGroupActive = false;
      _this.eContainer = eContainer;
      return _this;
    }
    RowDragFeature2.prototype.postConstruct = function() {
      var _this = this;
      if (this.gridOptionsService.isRowModelType("clientSide")) {
        this.clientSideRowModel = this.rowModel;
      }
      var refreshStatus = function() {
        _this.onSortChanged();
        _this.onFilterChanged();
        _this.onRowGroupChanged();
      };
      this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, this.onSortChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_FILTER_CHANGED, this.onFilterChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.onRowGroupChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_MODEL_UPDATED, function() {
        refreshStatus();
      });
      refreshStatus();
      this.ctrlsService.whenReady(function() {
        var gridBodyCon = _this.ctrlsService.getGridBodyCtrl();
        _this.autoScrollService = new AutoScrollService({
          scrollContainer: gridBodyCon.getBodyViewportElement(),
          scrollAxis: "y",
          getVerticalPosition: function() {
            return gridBodyCon.getScrollFeature().getVScrollPosition().top;
          },
          setVerticalPosition: function(position) {
            return gridBodyCon.getScrollFeature().setVerticalScrollPosition(position);
          },
          onScrollCallback: function() {
            _this.onDragging(_this.lastDraggingEvent);
          }
        });
      });
    };
    RowDragFeature2.prototype.onSortChanged = function() {
      this.isGridSorted = this.sortController.isSortActive();
    };
    RowDragFeature2.prototype.onFilterChanged = function() {
      this.isGridFiltered = this.filterManager.isAnyFilterPresent();
    };
    RowDragFeature2.prototype.onRowGroupChanged = function() {
      var rowGroups = this.columnModel.getRowGroupColumns();
      this.isRowGroupActive = !missingOrEmpty(rowGroups);
    };
    RowDragFeature2.prototype.getContainer = function() {
      return this.eContainer;
    };
    RowDragFeature2.prototype.isInterestedIn = function(type) {
      return type === DragSourceType.RowDrag;
    };
    RowDragFeature2.prototype.getIconName = function() {
      var managedDrag = this.gridOptionsService.is("rowDragManaged");
      if (managedDrag && this.shouldPreventRowMove()) {
        return DragAndDropService.ICON_NOT_ALLOWED;
      }
      return DragAndDropService.ICON_MOVE;
    };
    RowDragFeature2.prototype.shouldPreventRowMove = function() {
      return this.isGridSorted || this.isGridFiltered || this.isRowGroupActive;
    };
    RowDragFeature2.prototype.getRowNodes = function(draggingEvent) {
      var _this = this;
      if (!this.isFromThisGrid(draggingEvent)) {
        return draggingEvent.dragItem.rowNodes || [];
      }
      var isRowDragMultiRow = this.gridOptionsService.is("rowDragMultiRow");
      var selectedNodes = __spreadArray$i([], __read$m(this.selectionService.getSelectedNodes())).sort(function(a, b) {
        if (a.rowIndex == null || b.rowIndex == null) {
          return 0;
        }
        return _this.getRowIndexNumber(a) - _this.getRowIndexNumber(b);
      });
      var currentNode = draggingEvent.dragItem.rowNode;
      if (isRowDragMultiRow && selectedNodes.indexOf(currentNode) !== -1) {
        this.isMultiRowDrag = true;
        return selectedNodes;
      }
      this.isMultiRowDrag = false;
      return [currentNode];
    };
    RowDragFeature2.prototype.onDragEnter = function(draggingEvent) {
      draggingEvent.dragItem.rowNodes = this.getRowNodes(draggingEvent);
      this.dispatchGridEvent(Events.EVENT_ROW_DRAG_ENTER, draggingEvent);
      this.getRowNodes(draggingEvent).forEach(function(rowNode) {
        rowNode.setDragging(true);
      });
      this.onEnterOrDragging(draggingEvent);
    };
    RowDragFeature2.prototype.onDragging = function(draggingEvent) {
      this.onEnterOrDragging(draggingEvent);
    };
    RowDragFeature2.prototype.isFromThisGrid = function(draggingEvent) {
      var dragSourceDomDataKey = draggingEvent.dragSource.dragSourceDomDataKey;
      return dragSourceDomDataKey === this.gridOptionsService.getDomDataKey();
    };
    RowDragFeature2.prototype.isDropZoneWithinThisGrid = function(draggingEvent) {
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      var gridGui = gridBodyCon.getGui();
      var dropZoneTarget = draggingEvent.dropZoneTarget;
      return !gridGui.contains(dropZoneTarget);
    };
    RowDragFeature2.prototype.onEnterOrDragging = function(draggingEvent) {
      this.dispatchGridEvent(Events.EVENT_ROW_DRAG_MOVE, draggingEvent);
      this.lastDraggingEvent = draggingEvent;
      var pixel = this.mouseEventService.getNormalisedPosition(draggingEvent).y;
      var managedDrag = this.gridOptionsService.is("rowDragManaged");
      if (managedDrag) {
        this.doManagedDrag(draggingEvent, pixel);
      }
      this.autoScrollService.check(draggingEvent.event);
    };
    RowDragFeature2.prototype.doManagedDrag = function(draggingEvent, pixel) {
      var isFromThisGrid = this.isFromThisGrid(draggingEvent);
      var managedDrag = this.gridOptionsService.is("rowDragManaged");
      var rowNodes = draggingEvent.dragItem.rowNodes;
      if (managedDrag && this.shouldPreventRowMove()) {
        return;
      }
      if (this.gridOptionsService.is("suppressMoveWhenRowDragging") || !isFromThisGrid) {
        if (!this.isDropZoneWithinThisGrid(draggingEvent)) {
          this.clientSideRowModel.highlightRowAtPixel(rowNodes[0], pixel);
        }
      } else {
        this.moveRows(rowNodes, pixel);
      }
    };
    RowDragFeature2.prototype.getRowIndexNumber = function(rowNode) {
      return parseInt(last(rowNode.getRowIndexString().split("-")), 10);
    };
    RowDragFeature2.prototype.moveRowAndClearHighlight = function(draggingEvent) {
      var _this = this;
      var lastHighlightedRowNode = this.clientSideRowModel.getLastHighlightedRowNode();
      var isBelow = lastHighlightedRowNode && lastHighlightedRowNode.highlighted === RowHighlightPosition.Below;
      var pixel = this.mouseEventService.getNormalisedPosition(draggingEvent).y;
      var rowNodes = draggingEvent.dragItem.rowNodes;
      var increment = isBelow ? 1 : 0;
      if (this.isFromThisGrid(draggingEvent)) {
        rowNodes.forEach(function(rowNode) {
          if (rowNode.rowTop < pixel) {
            increment -= 1;
          }
        });
        this.moveRows(rowNodes, pixel, increment);
      } else {
        var getRowIdFunc_1 = this.gridOptionsService.getCallback("getRowId");
        var addIndex = this.clientSideRowModel.getRowIndexAtPixel(pixel) + 1;
        if (this.clientSideRowModel.getHighlightPosition(pixel) === RowHighlightPosition.Above) {
          addIndex--;
        }
        this.clientSideRowModel.updateRowData({
          add: rowNodes.map(function(node) {
            return node.data;
          }).filter(function(data) {
            return !_this.clientSideRowModel.getRowNode(getRowIdFunc_1 ? getRowIdFunc_1({ data, level: 0 }) : data.id);
          }),
          addIndex
        });
      }
      this.clearRowHighlight();
    };
    RowDragFeature2.prototype.clearRowHighlight = function() {
      this.clientSideRowModel.highlightRowAtPixel(null);
    };
    RowDragFeature2.prototype.moveRows = function(rowNodes, pixel, increment) {
      if (increment === void 0) {
        increment = 0;
      }
      var rowWasMoved = this.clientSideRowModel.ensureRowsAtPixel(rowNodes, pixel, increment);
      if (rowWasMoved) {
        this.focusService.clearFocusedCell();
        if (this.rangeService) {
          this.rangeService.removeAllCellRanges();
        }
      }
    };
    RowDragFeature2.prototype.addRowDropZone = function(params) {
      var _this = this;
      if (!params.getContainer()) {
        doOnce(function() {
          return console.warn("AG Grid: addRowDropZone - A container target needs to be provided");
        }, "add-drop-zone-empty-target");
        return;
      }
      if (this.dragAndDropService.findExternalZone(params)) {
        console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");
        return;
      }
      var processedParams = {
        getContainer: params.getContainer
      };
      if (params.fromGrid) {
        params.fromGrid = void 0;
        processedParams = params;
      } else {
        if (params.onDragEnter) {
          processedParams.onDragEnter = function(e) {
            params.onDragEnter(_this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_ENTER, e));
          };
        }
        if (params.onDragLeave) {
          processedParams.onDragLeave = function(e) {
            params.onDragLeave(_this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_LEAVE, e));
          };
        }
        if (params.onDragging) {
          processedParams.onDragging = function(e) {
            params.onDragging(_this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_MOVE, e));
          };
        }
        if (params.onDragStop) {
          processedParams.onDragStop = function(e) {
            params.onDragStop(_this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_END, e));
          };
        }
      }
      this.dragAndDropService.addDropTarget(__assign$a({ isInterestedIn: function(type) {
        return type === DragSourceType.RowDrag;
      }, getIconName: function() {
        return DragAndDropService.ICON_MOVE;
      }, external: true }, processedParams));
    };
    RowDragFeature2.prototype.getRowDropZone = function(events2) {
      var _this = this;
      var getContainer = this.getContainer.bind(this);
      var onDragEnter = this.onDragEnter.bind(this);
      var onDragLeave = this.onDragLeave.bind(this);
      var onDragging = this.onDragging.bind(this);
      var onDragStop = this.onDragStop.bind(this);
      if (!events2) {
        return {
          getContainer,
          onDragEnter,
          onDragLeave,
          onDragging,
          onDragStop,
          /* @private */
          fromGrid: true
        };
      }
      return {
        getContainer,
        onDragEnter: events2.onDragEnter ? function(e) {
          onDragEnter(e);
          events2.onDragEnter(_this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_ENTER, e));
        } : onDragEnter,
        onDragLeave: events2.onDragLeave ? function(e) {
          onDragLeave(e);
          events2.onDragLeave(_this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_LEAVE, e));
        } : onDragLeave,
        onDragging: events2.onDragging ? function(e) {
          onDragging(e);
          events2.onDragging(_this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_MOVE, e));
        } : onDragging,
        onDragStop: events2.onDragStop ? function(e) {
          onDragStop(e);
          events2.onDragStop(_this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_END, e));
        } : onDragStop,
        fromGrid: true
        /* @private */
      };
    };
    RowDragFeature2.prototype.draggingToRowDragEvent = function(type, draggingEvent) {
      var yNormalised = this.mouseEventService.getNormalisedPosition(draggingEvent).y;
      var mouseIsPastLastRow = yNormalised > this.paginationProxy.getCurrentPageHeight();
      var overIndex = -1;
      var overNode;
      if (!mouseIsPastLastRow) {
        overIndex = this.rowModel.getRowIndexAtPixel(yNormalised);
        overNode = this.rowModel.getRow(overIndex);
      }
      var vDirectionString;
      switch (draggingEvent.vDirection) {
        case VerticalDirection.Down:
          vDirectionString = "down";
          break;
        case VerticalDirection.Up:
          vDirectionString = "up";
          break;
        default:
          vDirectionString = null;
          break;
      }
      var event = {
        type,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context,
        event: draggingEvent.event,
        node: draggingEvent.dragItem.rowNode,
        nodes: draggingEvent.dragItem.rowNodes,
        overIndex,
        overNode,
        y: yNormalised,
        vDirection: vDirectionString
      };
      return event;
    };
    RowDragFeature2.prototype.dispatchGridEvent = function(type, draggingEvent) {
      var event = this.draggingToRowDragEvent(type, draggingEvent);
      this.eventService.dispatchEvent(event);
    };
    RowDragFeature2.prototype.onDragLeave = function(draggingEvent) {
      this.dispatchGridEvent(Events.EVENT_ROW_DRAG_LEAVE, draggingEvent);
      this.stopDragging(draggingEvent);
      if (this.gridOptionsService.is("rowDragManaged")) {
        this.clearRowHighlight();
      }
      if (this.isFromThisGrid(draggingEvent)) {
        this.isMultiRowDrag = false;
      }
    };
    RowDragFeature2.prototype.onDragStop = function(draggingEvent) {
      this.dispatchGridEvent(Events.EVENT_ROW_DRAG_END, draggingEvent);
      this.stopDragging(draggingEvent);
      if (this.gridOptionsService.is("rowDragManaged") && (this.gridOptionsService.is("suppressMoveWhenRowDragging") || !this.isFromThisGrid(draggingEvent)) && !this.isDropZoneWithinThisGrid(draggingEvent)) {
        this.moveRowAndClearHighlight(draggingEvent);
      }
    };
    RowDragFeature2.prototype.stopDragging = function(draggingEvent) {
      this.autoScrollService.ensureCleared();
      this.getRowNodes(draggingEvent).forEach(function(rowNode) {
        rowNode.setDragging(false);
      });
    };
    __decorate$1Q([
      Autowired("dragAndDropService")
    ], RowDragFeature2.prototype, "dragAndDropService", void 0);
    __decorate$1Q([
      Autowired("rowModel")
    ], RowDragFeature2.prototype, "rowModel", void 0);
    __decorate$1Q([
      Autowired("paginationProxy")
    ], RowDragFeature2.prototype, "paginationProxy", void 0);
    __decorate$1Q([
      Autowired("columnModel")
    ], RowDragFeature2.prototype, "columnModel", void 0);
    __decorate$1Q([
      Autowired("focusService")
    ], RowDragFeature2.prototype, "focusService", void 0);
    __decorate$1Q([
      Autowired("sortController")
    ], RowDragFeature2.prototype, "sortController", void 0);
    __decorate$1Q([
      Autowired("filterManager")
    ], RowDragFeature2.prototype, "filterManager", void 0);
    __decorate$1Q([
      Autowired("selectionService")
    ], RowDragFeature2.prototype, "selectionService", void 0);
    __decorate$1Q([
      Autowired("mouseEventService")
    ], RowDragFeature2.prototype, "mouseEventService", void 0);
    __decorate$1Q([
      Autowired("ctrlsService")
    ], RowDragFeature2.prototype, "ctrlsService", void 0);
    __decorate$1Q([
      Optional("rangeService")
    ], RowDragFeature2.prototype, "rangeService", void 0);
    __decorate$1Q([
      PostConstruct
    ], RowDragFeature2.prototype, "postConstruct", null);
    return RowDragFeature2;
  }(BeanStub)
);
var __extends$1Z = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1P = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var RowAnimationCssClasses;
(function(RowAnimationCssClasses2) {
  RowAnimationCssClasses2["ANIMATION_ON"] = "ag-row-animation";
  RowAnimationCssClasses2["ANIMATION_OFF"] = "ag-row-no-animation";
})(RowAnimationCssClasses || (RowAnimationCssClasses = {}));
var CSS_CLASS_FORCE_VERTICAL_SCROLL = "ag-force-vertical-scroll";
var CSS_CLASS_CELL_SELECTABLE = "ag-selectable";
var CSS_CLASS_COLUMN_MOVING = "ag-column-moving";
var GridBodyCtrl = (
  /** @class */
  function(_super) {
    __extends$1Z(GridBodyCtrl2, _super);
    function GridBodyCtrl2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.stickyTopHeight = 0;
      return _this;
    }
    GridBodyCtrl2.prototype.getScrollFeature = function() {
      return this.bodyScrollFeature;
    };
    GridBodyCtrl2.prototype.getBodyViewportElement = function() {
      return this.eBodyViewport;
    };
    GridBodyCtrl2.prototype.setComp = function(comp, eGridBody, eBodyViewport, eTop, eBottom, eStickyTop) {
      this.comp = comp;
      this.eGridBody = eGridBody;
      this.eBodyViewport = eBodyViewport;
      this.eTop = eTop;
      this.eBottom = eBottom;
      this.eStickyTop = eStickyTop;
      this.setCellTextSelection(this.gridOptionsService.is("enableCellTextSelection"));
      this.createManagedBean(new LayoutFeature(this.comp));
      this.bodyScrollFeature = this.createManagedBean(new GridBodyScrollFeature(this.eBodyViewport));
      this.addRowDragListener();
      this.setupRowAnimationCssClass();
      this.addEventListeners();
      this.addFocusListeners([eTop, eBodyViewport, eBottom, eStickyTop]);
      this.onGridColumnsChanged();
      this.addBodyViewportListener();
      this.setFloatingHeights();
      this.disableBrowserDragging();
      this.addStopEditingWhenGridLosesFocus();
      this.ctrlsService.registerGridBodyCtrl(this);
    };
    GridBodyCtrl2.prototype.getComp = function() {
      return this.comp;
    };
    GridBodyCtrl2.prototype.addEventListeners = function() {
      this.addManagedListener(this.eventService, Events.EVENT_GRID_COLUMNS_CHANGED, this.onGridColumnsChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_SCROLL_VISIBILITY_CHANGED, this.onScrollVisibilityChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_PINNED_ROW_DATA_CHANGED, this.onPinnedRowDataChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_HEADER_HEIGHT_CHANGED, this.onHeaderHeightChanged.bind(this));
    };
    GridBodyCtrl2.prototype.addFocusListeners = function(elements2) {
      var _this = this;
      elements2.forEach(function(element) {
        _this.addManagedListener(element, "focusin", function(e) {
          var target = e.target;
          var isFocusedElementNested = isElementChildOfClass(target, "ag-root", element);
          element.classList.toggle("ag-has-focus", !isFocusedElementNested);
        });
        _this.addManagedListener(element, "focusout", function(e) {
          var target = e.target, relatedTarget = e.relatedTarget;
          var gridContainRelatedTarget = element.contains(relatedTarget);
          var isNestedRelatedTarget = isElementChildOfClass(relatedTarget, "ag-root", element);
          var isNestedTarget = isElementChildOfClass(target, "ag-root", element);
          if (isNestedTarget) {
            return;
          }
          if (!gridContainRelatedTarget || isNestedRelatedTarget) {
            element.classList.remove("ag-has-focus");
          }
        });
      });
    };
    GridBodyCtrl2.prototype.setColumnMovingCss = function(moving) {
      this.comp.setColumnMovingCss(CSS_CLASS_COLUMN_MOVING, moving);
    };
    GridBodyCtrl2.prototype.setCellTextSelection = function(selectable) {
      if (selectable === void 0) {
        selectable = false;
      }
      this.comp.setCellSelectableCss(CSS_CLASS_CELL_SELECTABLE, selectable);
    };
    GridBodyCtrl2.prototype.onScrollVisibilityChanged = function() {
      var _this = this;
      var visible = this.scrollVisibleService.isVerticalScrollShowing();
      this.setVerticalScrollPaddingVisible(visible);
      this.setStickyTopWidth(visible);
      var scrollbarWidth = visible ? this.gridOptionsService.getScrollbarWidth() || 0 : 0;
      var pad = isInvisibleScrollbar() ? 16 : 0;
      var width = "calc(100% + " + (scrollbarWidth + pad) + "px)";
      this.animationFrameService.requestAnimationFrame(function() {
        return _this.comp.setBodyViewportWidth(width);
      });
    };
    GridBodyCtrl2.prototype.onGridColumnsChanged = function() {
      var columns = this.columnModel.getAllGridColumns();
      this.comp.setColumnCount(columns ? columns.length : 0);
    };
    GridBodyCtrl2.prototype.disableBrowserDragging = function() {
      this.addManagedListener(this.eGridBody, "dragstart", function(event) {
        if (event.target instanceof HTMLImageElement) {
          event.preventDefault();
          return false;
        }
      });
    };
    GridBodyCtrl2.prototype.addStopEditingWhenGridLosesFocus = function() {
      var _this = this;
      if (!this.gridOptionsService.is("stopEditingWhenCellsLoseFocus")) {
        return;
      }
      var focusOutListener = function(event) {
        var elementWithFocus = event.relatedTarget;
        if (getTabIndex(elementWithFocus) === null) {
          _this.rowRenderer.stopEditing();
          return;
        }
        var clickInsideGrid = (
          // see if click came from inside the viewports
          viewports.some(function(viewport) {
            return viewport.contains(elementWithFocus);
          }) && _this.mouseEventService.isElementInThisGrid(elementWithFocus)
        );
        if (!clickInsideGrid) {
          var popupService = _this.popupService;
          clickInsideGrid = popupService.getActivePopups().some(function(popup) {
            return popup.contains(elementWithFocus);
          }) || popupService.isElementWithinCustomPopup(elementWithFocus);
        }
        if (!clickInsideGrid) {
          _this.rowRenderer.stopEditing();
        }
      };
      var viewports = [this.eBodyViewport, this.eBottom, this.eTop, this.eStickyTop];
      viewports.forEach(function(viewport) {
        return _this.addManagedListener(viewport, "focusout", focusOutListener);
      });
    };
    GridBodyCtrl2.prototype.updateRowCount = function() {
      var headerCount = this.headerNavigationService.getHeaderRowCount();
      var rowCount = this.rowModel.isLastRowIndexKnown() ? this.rowModel.getRowCount() : -1;
      var total = rowCount === -1 ? -1 : headerCount + rowCount;
      this.comp.setRowCount(total);
    };
    GridBodyCtrl2.prototype.registerBodyViewportResizeListener = function(listener) {
      this.comp.registerBodyViewportResizeListener(listener);
    };
    GridBodyCtrl2.prototype.setVerticalScrollPaddingVisible = function(visible) {
      var overflowY = visible ? "scroll" : "hidden";
      this.comp.setPinnedTopBottomOverflowY(overflowY);
    };
    GridBodyCtrl2.prototype.isVerticalScrollShowing = function() {
      var show = this.gridOptionsService.is("alwaysShowVerticalScroll");
      var cssClass = show ? CSS_CLASS_FORCE_VERTICAL_SCROLL : null;
      var allowVerticalScroll = this.gridOptionsService.isDomLayout("normal");
      this.comp.setAlwaysVerticalScrollClass(cssClass, show);
      return show || allowVerticalScroll && isVerticalScrollShowing(this.eBodyViewport);
    };
    GridBodyCtrl2.prototype.setupRowAnimationCssClass = function() {
      var _this = this;
      var listener = function() {
        var animateRows = _this.gridOptionsService.isAnimateRows() && !_this.rowContainerHeightService.isStretching();
        var animateRowsCssClass = animateRows ? RowAnimationCssClasses.ANIMATION_ON : RowAnimationCssClasses.ANIMATION_OFF;
        _this.comp.setRowAnimationCssOnBodyViewport(animateRowsCssClass, animateRows);
      };
      listener();
      this.addManagedListener(this.eventService, Events.EVENT_HEIGHT_SCALE_CHANGED, listener);
      this.addManagedPropertyListener("animateRows", listener);
    };
    GridBodyCtrl2.prototype.getGridBodyElement = function() {
      return this.eGridBody;
    };
    GridBodyCtrl2.prototype.addBodyViewportListener = function() {
      var listener = this.onBodyViewportContextMenu.bind(this);
      this.addManagedListener(this.eBodyViewport, "contextmenu", listener);
      this.mockContextMenuForIPad(listener);
      this.addManagedListener(this.eBodyViewport, "wheel", this.onBodyViewportWheel.bind(this));
      this.addManagedListener(this.eStickyTop, "wheel", this.onStickyTopWheel.bind(this));
      this.addFullWidthContainerWheelListener();
    };
    GridBodyCtrl2.prototype.addFullWidthContainerWheelListener = function() {
      var _this = this;
      var fullWidthContainer = this.eBodyViewport.querySelector(".ag-full-width-container");
      var eCenterColsViewport = this.eBodyViewport.querySelector(".ag-center-cols-viewport");
      if (fullWidthContainer && eCenterColsViewport) {
        this.addManagedListener(fullWidthContainer, "wheel", function(e) {
          return _this.onFullWidthContainerWheel(e, eCenterColsViewport);
        });
      }
    };
    GridBodyCtrl2.prototype.onFullWidthContainerWheel = function(e, eCenterColsViewport) {
      if (!e.deltaX || Math.abs(e.deltaY) > Math.abs(e.deltaX) || !this.mouseEventService.isEventFromThisGrid(e)) {
        return;
      }
      e.preventDefault();
      eCenterColsViewport.scrollBy({ left: e.deltaX });
    };
    GridBodyCtrl2.prototype.onBodyViewportContextMenu = function(mouseEvent, touch, touchEvent) {
      if (!mouseEvent && !touchEvent) {
        return;
      }
      if (this.gridOptionsService.is("preventDefaultOnContextMenu")) {
        var event_1 = mouseEvent || touchEvent;
        event_1.preventDefault();
      }
      var target = (mouseEvent || touch).target;
      if (target === this.eBodyViewport || target === this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()) {
        if (!this.contextMenuFactory) {
          return;
        }
        if (mouseEvent) {
          this.contextMenuFactory.onContextMenu(mouseEvent, null, null, null, null, this.eGridBody);
        } else if (touchEvent) {
          this.contextMenuFactory.onContextMenu(null, touchEvent, null, null, null, this.eGridBody);
        }
      }
    };
    GridBodyCtrl2.prototype.mockContextMenuForIPad = function(listener) {
      if (!isIOSUserAgent()) {
        return;
      }
      var touchListener = new TouchListener(this.eBodyViewport);
      var longTapListener = function(event) {
        listener(void 0, event.touchStart, event.touchEvent);
      };
      this.addManagedListener(touchListener, TouchListener.EVENT_LONG_TAP, longTapListener);
      this.addDestroyFunc(function() {
        return touchListener.destroy();
      });
    };
    GridBodyCtrl2.prototype.onBodyViewportWheel = function(e) {
      if (!this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")) {
        return;
      }
      if (this.popupService.hasAnchoredPopup()) {
        e.preventDefault();
      }
    };
    GridBodyCtrl2.prototype.onStickyTopWheel = function(e) {
      e.preventDefault();
      if (e.offsetY) {
        this.scrollVertically(e.deltaY);
      }
    };
    GridBodyCtrl2.prototype.getGui = function() {
      return this.eGridBody;
    };
    GridBodyCtrl2.prototype.scrollVertically = function(pixels) {
      var oldScrollPosition = this.eBodyViewport.scrollTop;
      this.bodyScrollFeature.setVerticalScrollPosition(oldScrollPosition + pixels);
      return this.eBodyViewport.scrollTop - oldScrollPosition;
    };
    GridBodyCtrl2.prototype.addRowDragListener = function() {
      this.rowDragFeature = this.createManagedBean(new RowDragFeature(this.eBodyViewport));
      this.dragAndDropService.addDropTarget(this.rowDragFeature);
    };
    GridBodyCtrl2.prototype.getRowDragFeature = function() {
      return this.rowDragFeature;
    };
    GridBodyCtrl2.prototype.onPinnedRowDataChanged = function() {
      this.setFloatingHeights();
    };
    GridBodyCtrl2.prototype.setFloatingHeights = function() {
      var pinnedRowModel = this.pinnedRowModel;
      var floatingTopHeight = pinnedRowModel.getPinnedTopTotalHeight();
      if (floatingTopHeight) {
        floatingTopHeight += 1;
      }
      var floatingBottomHeight = pinnedRowModel.getPinnedBottomTotalHeight();
      if (floatingBottomHeight) {
        floatingBottomHeight += 1;
      }
      this.comp.setTopHeight(floatingTopHeight);
      this.comp.setBottomHeight(floatingBottomHeight);
      this.comp.setTopDisplay(floatingTopHeight ? "inherit" : "none");
      this.comp.setBottomDisplay(floatingBottomHeight ? "inherit" : "none");
      this.setStickyTopOffsetTop();
    };
    GridBodyCtrl2.prototype.setStickyTopHeight = function(height) {
      if (height === void 0) {
        height = 0;
      }
      this.comp.setStickyTopHeight(height + "px");
      this.stickyTopHeight = height;
    };
    GridBodyCtrl2.prototype.getStickyTopHeight = function() {
      return this.stickyTopHeight;
    };
    GridBodyCtrl2.prototype.setStickyTopWidth = function(vScrollVisible) {
      if (!vScrollVisible) {
        this.comp.setStickyTopWidth("100%");
      } else {
        var scrollbarWidth = this.gridOptionsService.getScrollbarWidth();
        this.comp.setStickyTopWidth("calc(100% - " + scrollbarWidth + "px)");
      }
    };
    GridBodyCtrl2.prototype.onHeaderHeightChanged = function() {
      this.setStickyTopOffsetTop();
    };
    GridBodyCtrl2.prototype.setStickyTopOffsetTop = function() {
      var headerCtrl = this.ctrlsService.getGridHeaderCtrl();
      var headerHeight = headerCtrl.getHeaderHeight();
      var pinnedTopHeight = this.pinnedRowModel.getPinnedTopTotalHeight();
      var height = 0;
      if (headerHeight > 0) {
        height += headerHeight + 1;
      }
      if (pinnedTopHeight > 0) {
        height += pinnedTopHeight + 1;
      }
      this.comp.setStickyTopTop(height + "px");
    };
    GridBodyCtrl2.prototype.sizeColumnsToFit = function(params, nextTimeout) {
      var _this = this;
      var removeScrollWidth = this.isVerticalScrollShowing();
      var scrollWidthToRemove = removeScrollWidth ? this.gridOptionsService.getScrollbarWidth() : 0;
      var bodyViewportWidth = getInnerWidth(this.eGridBody);
      var availableWidth = bodyViewportWidth - scrollWidthToRemove;
      if (availableWidth > 0) {
        this.columnModel.sizeColumnsToFit(availableWidth, "sizeColumnsToFit", false, params);
        return;
      }
      if (nextTimeout === void 0) {
        window.setTimeout(function() {
          _this.sizeColumnsToFit(params, 100);
        }, 0);
      } else if (nextTimeout === 100) {
        window.setTimeout(function() {
          _this.sizeColumnsToFit(params, 500);
        }, 100);
      } else if (nextTimeout === 500) {
        window.setTimeout(function() {
          _this.sizeColumnsToFit(params, -1);
        }, 500);
      } else {
        console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?");
      }
    };
    GridBodyCtrl2.prototype.addScrollEventListener = function(listener) {
      this.eBodyViewport.addEventListener("scroll", listener, { passive: true });
    };
    GridBodyCtrl2.prototype.removeScrollEventListener = function(listener) {
      this.eBodyViewport.removeEventListener("scroll", listener);
    };
    __decorate$1P([
      Autowired("animationFrameService")
    ], GridBodyCtrl2.prototype, "animationFrameService", void 0);
    __decorate$1P([
      Autowired("rowContainerHeightService")
    ], GridBodyCtrl2.prototype, "rowContainerHeightService", void 0);
    __decorate$1P([
      Autowired("ctrlsService")
    ], GridBodyCtrl2.prototype, "ctrlsService", void 0);
    __decorate$1P([
      Autowired("columnModel")
    ], GridBodyCtrl2.prototype, "columnModel", void 0);
    __decorate$1P([
      Autowired("scrollVisibleService")
    ], GridBodyCtrl2.prototype, "scrollVisibleService", void 0);
    __decorate$1P([
      Optional("contextMenuFactory")
    ], GridBodyCtrl2.prototype, "contextMenuFactory", void 0);
    __decorate$1P([
      Autowired("headerNavigationService")
    ], GridBodyCtrl2.prototype, "headerNavigationService", void 0);
    __decorate$1P([
      Autowired("dragAndDropService")
    ], GridBodyCtrl2.prototype, "dragAndDropService", void 0);
    __decorate$1P([
      Autowired("pinnedRowModel")
    ], GridBodyCtrl2.prototype, "pinnedRowModel", void 0);
    __decorate$1P([
      Autowired("rowRenderer")
    ], GridBodyCtrl2.prototype, "rowRenderer", void 0);
    __decorate$1P([
      Autowired("popupService")
    ], GridBodyCtrl2.prototype, "popupService", void 0);
    __decorate$1P([
      Autowired("mouseEventService")
    ], GridBodyCtrl2.prototype, "mouseEventService", void 0);
    __decorate$1P([
      Autowired("rowModel")
    ], GridBodyCtrl2.prototype, "rowModel", void 0);
    return GridBodyCtrl2;
  }(BeanStub)
);
var SelectionHandleType;
(function(SelectionHandleType2) {
  SelectionHandleType2[SelectionHandleType2["FILL"] = 0] = "FILL";
  SelectionHandleType2[SelectionHandleType2["RANGE"] = 1] = "RANGE";
})(SelectionHandleType || (SelectionHandleType = {}));
var CellRangeType;
(function(CellRangeType2) {
  CellRangeType2[CellRangeType2["VALUE"] = 0] = "VALUE";
  CellRangeType2[CellRangeType2["DIMENSION"] = 1] = "DIMENSION";
})(CellRangeType || (CellRangeType = {}));
var CSS_CELL_RANGE_SELECTED = "ag-cell-range-selected";
var CSS_CELL_RANGE_CHART = "ag-cell-range-chart";
var CSS_CELL_RANGE_SINGLE_CELL = "ag-cell-range-single-cell";
var CSS_CELL_RANGE_CHART_CATEGORY = "ag-cell-range-chart-category";
var CSS_CELL_RANGE_HANDLE = "ag-cell-range-handle";
var CSS_CELL_RANGE_TOP = "ag-cell-range-top";
var CSS_CELL_RANGE_RIGHT = "ag-cell-range-right";
var CSS_CELL_RANGE_BOTTOM = "ag-cell-range-bottom";
var CSS_CELL_RANGE_LEFT = "ag-cell-range-left";
var CellRangeFeature = (
  /** @class */
  function() {
    function CellRangeFeature2(beans, ctrl) {
      this.beans = beans;
      this.cellCtrl = ctrl;
    }
    CellRangeFeature2.prototype.setComp = function(cellComp2, eGui) {
      this.cellComp = cellComp2;
      this.eGui = eGui;
      this.onRangeSelectionChanged();
    };
    CellRangeFeature2.prototype.onRangeSelectionChanged = function() {
      if (!this.cellComp) {
        return;
      }
      this.rangeCount = this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition());
      this.hasChartRange = this.getHasChartRange();
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_SELECTED, this.rangeCount !== 0);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_SELECTED + "-1", this.rangeCount === 1);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_SELECTED + "-2", this.rangeCount === 2);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_SELECTED + "-3", this.rangeCount === 3);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_SELECTED + "-4", this.rangeCount >= 4);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_CHART, this.hasChartRange);
      setAriaSelected(this.eGui, this.rangeCount > 0 ? true : void 0);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_SINGLE_CELL, this.isSingleCell());
      this.updateRangeBorders();
      this.refreshHandle();
    };
    CellRangeFeature2.prototype.updateRangeBorders = function() {
      var rangeBorders = this.getRangeBorders();
      var isSingleCell = this.isSingleCell();
      var isTop = !isSingleCell && rangeBorders.top;
      var isRight = !isSingleCell && rangeBorders.right;
      var isBottom = !isSingleCell && rangeBorders.bottom;
      var isLeft = !isSingleCell && rangeBorders.left;
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_TOP, isTop);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_RIGHT, isRight);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_BOTTOM, isBottom);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_LEFT, isLeft);
    };
    CellRangeFeature2.prototype.isSingleCell = function() {
      var rangeService = this.beans.rangeService;
      return this.rangeCount === 1 && rangeService && !rangeService.isMoreThanOneCell();
    };
    CellRangeFeature2.prototype.getHasChartRange = function() {
      var rangeService = this.beans.rangeService;
      if (!this.rangeCount || !rangeService) {
        return false;
      }
      var cellRanges = rangeService.getCellRanges();
      return cellRanges.length > 0 && cellRanges.every(function(range) {
        return includes([CellRangeType.DIMENSION, CellRangeType.VALUE], range.type);
      });
    };
    CellRangeFeature2.prototype.updateRangeBordersIfRangeCount = function() {
      if (this.rangeCount > 0) {
        this.updateRangeBorders();
        this.refreshHandle();
      }
    };
    CellRangeFeature2.prototype.getRangeBorders = function() {
      var _this = this;
      var isRtl = this.beans.gridOptionsService.is("enableRtl");
      var top = false;
      var right = false;
      var bottom = false;
      var left = false;
      var thisCol = this.cellCtrl.getCellPosition().column;
      var _a2 = this.beans, rangeService = _a2.rangeService, columnModel = _a2.columnModel;
      var leftCol;
      var rightCol;
      if (isRtl) {
        leftCol = columnModel.getDisplayedColAfter(thisCol);
        rightCol = columnModel.getDisplayedColBefore(thisCol);
      } else {
        leftCol = columnModel.getDisplayedColBefore(thisCol);
        rightCol = columnModel.getDisplayedColAfter(thisCol);
      }
      var ranges = rangeService.getCellRanges().filter(function(range2) {
        return rangeService.isCellInSpecificRange(_this.cellCtrl.getCellPosition(), range2);
      });
      if (!leftCol) {
        left = true;
      }
      if (!rightCol) {
        right = true;
      }
      for (var i = 0; i < ranges.length; i++) {
        if (top && right && bottom && left) {
          break;
        }
        var range = ranges[i];
        var startRow = rangeService.getRangeStartRow(range);
        var endRow = rangeService.getRangeEndRow(range);
        if (!top && this.beans.rowPositionUtils.sameRow(startRow, this.cellCtrl.getCellPosition())) {
          top = true;
        }
        if (!bottom && this.beans.rowPositionUtils.sameRow(endRow, this.cellCtrl.getCellPosition())) {
          bottom = true;
        }
        if (!left && leftCol && range.columns.indexOf(leftCol) < 0) {
          left = true;
        }
        if (!right && rightCol && range.columns.indexOf(rightCol) < 0) {
          right = true;
        }
      }
      return { top, right, bottom, left };
    };
    CellRangeFeature2.prototype.refreshHandle = function() {
      if (!this.beans.rangeService) {
        return;
      }
      var shouldHaveSelectionHandle = this.shouldHaveSelectionHandle();
      if (this.selectionHandle && !shouldHaveSelectionHandle) {
        this.selectionHandle = this.beans.context.destroyBean(this.selectionHandle);
      }
      if (shouldHaveSelectionHandle) {
        this.addSelectionHandle();
      }
      this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_HANDLE, !!this.selectionHandle);
    };
    CellRangeFeature2.prototype.shouldHaveSelectionHandle = function() {
      var _a2 = this.beans, gridOptionsService = _a2.gridOptionsService, rangeService = _a2.rangeService;
      var cellRanges = rangeService.getCellRanges();
      var rangesLen = cellRanges.length;
      if (this.rangeCount < 1 || rangesLen < 1) {
        return false;
      }
      var cellRange = last(cellRanges);
      var cellPosition = this.cellCtrl.getCellPosition();
      var isFillHandleAvailable = gridOptionsService.is("enableFillHandle") && !this.cellCtrl.isSuppressFillHandle();
      var isRangeHandleAvailable = gridOptionsService.is("enableRangeHandle");
      var handleIsAvailable = rangesLen === 1 && !this.cellCtrl.isEditing() && (isFillHandleAvailable || isRangeHandleAvailable);
      if (this.hasChartRange) {
        var hasCategoryRange = cellRanges[0].type === CellRangeType.DIMENSION;
        var isCategoryCell = hasCategoryRange && rangeService.isCellInSpecificRange(cellPosition, cellRanges[0]);
        this.cellComp.addOrRemoveCssClass(CSS_CELL_RANGE_CHART_CATEGORY, isCategoryCell);
        handleIsAvailable = cellRange.type === CellRangeType.VALUE;
      }
      return handleIsAvailable && cellRange.endRow != null && rangeService.isContiguousRange(cellRange) && rangeService.isBottomRightCell(cellRange, cellPosition);
    };
    CellRangeFeature2.prototype.addSelectionHandle = function() {
      var _a2 = this.beans, gridOptionsService = _a2.gridOptionsService, rangeService = _a2.rangeService;
      var cellRangeType = last(rangeService.getCellRanges()).type;
      var selectionHandleFill = gridOptionsService.is("enableFillHandle") && missing(cellRangeType);
      var type = selectionHandleFill ? SelectionHandleType.FILL : SelectionHandleType.RANGE;
      if (this.selectionHandle && this.selectionHandle.getType() !== type) {
        this.selectionHandle = this.beans.context.destroyBean(this.selectionHandle);
      }
      if (!this.selectionHandle) {
        this.selectionHandle = this.beans.selectionHandleFactory.createSelectionHandle(type);
      }
      this.selectionHandle.refresh(this.cellCtrl);
    };
    CellRangeFeature2.prototype.destroy = function() {
      this.beans.context.destroyBean(this.selectionHandle);
    };
    return CellRangeFeature2;
  }()
);
var __extends$1Y = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var CellPositionFeature = (
  /** @class */
  function(_super) {
    __extends$1Y(CellPositionFeature2, _super);
    function CellPositionFeature2(ctrl, beans) {
      var _this = _super.call(this) || this;
      _this.cellCtrl = ctrl;
      _this.beans = beans;
      _this.column = ctrl.getColumn();
      _this.rowNode = ctrl.getRowNode();
      _this.setupColSpan();
      _this.setupRowSpan();
      return _this;
    }
    CellPositionFeature2.prototype.setupRowSpan = function() {
      this.rowSpan = this.column.getRowSpan(this.rowNode);
    };
    CellPositionFeature2.prototype.setComp = function(eGui) {
      this.eGui = eGui;
      this.onLeftChanged();
      this.onWidthChanged();
      this.applyRowSpan();
    };
    CellPositionFeature2.prototype.onDisplayColumnsChanged = function() {
      var colsSpanning = this.getColSpanningList();
      if (!areEqual(this.colsSpanning, colsSpanning)) {
        this.colsSpanning = colsSpanning;
        this.onWidthChanged();
        this.onLeftChanged();
      }
    };
    CellPositionFeature2.prototype.setupColSpan = function() {
      if (this.column.getColDef().colSpan == null) {
        return;
      }
      this.colsSpanning = this.getColSpanningList();
      this.addManagedListener(this.beans.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.onDisplayColumnsChanged.bind(this));
      this.addManagedListener(this.beans.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, this.onWidthChanged.bind(this));
    };
    CellPositionFeature2.prototype.onWidthChanged = function() {
      if (!this.eGui) {
        return;
      }
      var width = this.getCellWidth();
      this.eGui.style.width = width + "px";
    };
    CellPositionFeature2.prototype.getCellWidth = function() {
      if (!this.colsSpanning) {
        return this.column.getActualWidth();
      }
      return this.colsSpanning.reduce(function(width, col) {
        return width + col.getActualWidth();
      }, 0);
    };
    CellPositionFeature2.prototype.getColSpanningList = function() {
      var colSpan = this.column.getColSpan(this.rowNode);
      var colsSpanning = [];
      if (colSpan === 1) {
        colsSpanning.push(this.column);
      } else {
        var pointer = this.column;
        var pinned = this.column.getPinned();
        for (var i = 0; pointer && i < colSpan; i++) {
          colsSpanning.push(pointer);
          pointer = this.beans.columnModel.getDisplayedColAfter(pointer);
          if (!pointer || missing(pointer)) {
            break;
          }
          if (pinned !== pointer.getPinned()) {
            break;
          }
        }
      }
      return colsSpanning;
    };
    CellPositionFeature2.prototype.onLeftChanged = function() {
      if (!this.eGui) {
        return;
      }
      var left = this.modifyLeftForPrintLayout(this.getCellLeft());
      this.eGui.style.left = left + "px";
    };
    CellPositionFeature2.prototype.getCellLeft = function() {
      var mostLeftCol;
      if (this.beans.gridOptionsService.is("enableRtl") && this.colsSpanning) {
        mostLeftCol = last(this.colsSpanning);
      } else {
        mostLeftCol = this.column;
      }
      return mostLeftCol.getLeft();
    };
    CellPositionFeature2.prototype.modifyLeftForPrintLayout = function(leftPosition) {
      if (!this.cellCtrl.isPrintLayout() || this.column.getPinned() === "left") {
        return leftPosition;
      }
      var leftWidth = this.beans.columnModel.getDisplayedColumnsLeftWidth();
      if (this.column.getPinned() === "right") {
        var bodyWidth = this.beans.columnModel.getBodyContainerWidth();
        return leftWidth + bodyWidth + (leftPosition || 0);
      }
      return leftWidth + (leftPosition || 0);
    };
    CellPositionFeature2.prototype.applyRowSpan = function() {
      if (this.rowSpan === 1) {
        return;
      }
      var singleRowHeight = this.beans.gridOptionsService.getRowHeightAsNumber();
      var totalRowHeight = singleRowHeight * this.rowSpan;
      this.eGui.style.height = totalRowHeight + "px";
      this.eGui.style.zIndex = "1";
    };
    CellPositionFeature2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    return CellPositionFeature2;
  }(BeanStub)
);
var __extends$1X = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var CellCustomStyleFeature = (
  /** @class */
  function(_super) {
    __extends$1X(CellCustomStyleFeature2, _super);
    function CellCustomStyleFeature2(ctrl, beans) {
      var _this = _super.call(this) || this;
      _this.staticClasses = [];
      _this.cellCtrl = ctrl;
      _this.beans = beans;
      _this.column = ctrl.getColumn();
      _this.rowNode = ctrl.getRowNode();
      return _this;
    }
    CellCustomStyleFeature2.prototype.setComp = function(comp) {
      this.cellComp = comp;
      this.applyUserStyles();
      this.applyCellClassRules();
      this.applyClassesFromColDef();
    };
    CellCustomStyleFeature2.prototype.applyCellClassRules = function() {
      var _this = this;
      var colDef = this.column.getColDef();
      var cellClassParams = {
        value: this.cellCtrl.getValue(),
        data: this.rowNode.data,
        node: this.rowNode,
        colDef,
        column: this.column,
        rowIndex: this.rowNode.rowIndex,
        api: this.beans.gridOptionsService.api,
        columnApi: this.beans.gridOptionsService.columnApi,
        context: this.beans.gridOptionsService.context
      };
      this.beans.stylingService.processClassRules(colDef.cellClassRules, cellClassParams, function(className) {
        return _this.cellComp.addOrRemoveCssClass(className, true);
      }, function(className) {
        return _this.cellComp.addOrRemoveCssClass(className, false);
      });
    };
    CellCustomStyleFeature2.prototype.applyUserStyles = function() {
      var colDef = this.column.getColDef();
      if (!colDef.cellStyle) {
        return;
      }
      var styles;
      if (typeof colDef.cellStyle === "function") {
        var cellStyleParams = {
          column: this.column,
          value: this.cellCtrl.getValue(),
          colDef,
          data: this.rowNode.data,
          node: this.rowNode,
          rowIndex: this.rowNode.rowIndex,
          api: this.beans.gridOptionsService.api,
          columnApi: this.beans.gridOptionsService.columnApi,
          context: this.beans.gridOptionsService.context
        };
        var cellStyleFunc = colDef.cellStyle;
        styles = cellStyleFunc(cellStyleParams);
      } else {
        styles = colDef.cellStyle;
      }
      if (styles) {
        this.cellComp.setUserStyles(styles);
      }
    };
    CellCustomStyleFeature2.prototype.applyClassesFromColDef = function() {
      var _this = this;
      var colDef = this.column.getColDef();
      var cellClassParams = {
        value: this.cellCtrl.getValue(),
        data: this.rowNode.data,
        node: this.rowNode,
        column: this.column,
        colDef,
        rowIndex: this.rowNode.rowIndex,
        api: this.beans.gridOptionsService.api,
        columnApi: this.beans.gridOptionsService.columnApi,
        context: this.beans.gridOptionsService.context
      };
      if (this.staticClasses.length) {
        this.staticClasses.forEach(function(className) {
          return _this.cellComp.addOrRemoveCssClass(className, false);
        });
      }
      this.staticClasses = this.beans.stylingService.getStaticCellClasses(colDef, cellClassParams);
      if (this.staticClasses.length) {
        this.staticClasses.forEach(function(className) {
          return _this.cellComp.addOrRemoveCssClass(className, true);
        });
      }
    };
    CellCustomStyleFeature2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    return CellCustomStyleFeature2;
  }(BeanStub)
);
var __extends$1W = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var TooltipFeature = (
  /** @class */
  function(_super) {
    __extends$1W(TooltipFeature2, _super);
    function TooltipFeature2(ctrl, beans) {
      var _this = _super.call(this) || this;
      _this.ctrl = ctrl;
      _this.beans = beans;
      return _this;
    }
    TooltipFeature2.prototype.setComp = function(comp) {
      this.comp = comp;
      this.setupTooltip();
    };
    TooltipFeature2.prototype.setupTooltip = function() {
      this.browserTooltips = this.beans.gridOptionsService.is("enableBrowserTooltips");
      this.updateTooltipText();
      if (this.browserTooltips) {
        this.comp.setTitle(this.tooltip != null ? this.tooltip : void 0);
      } else {
        this.createTooltipFeatureIfNeeded();
      }
    };
    TooltipFeature2.prototype.updateTooltipText = function() {
      this.tooltip = this.ctrl.getTooltipValue();
    };
    TooltipFeature2.prototype.createTooltipFeatureIfNeeded = function() {
      var _this = this;
      if (this.genericTooltipFeature != null) {
        return;
      }
      var parent = {
        getTooltipParams: function() {
          return _this.getTooltipParams();
        },
        getGui: function() {
          return _this.ctrl.getGui();
        }
      };
      this.genericTooltipFeature = this.createManagedBean(new CustomTooltipFeature(parent), this.beans.context);
    };
    TooltipFeature2.prototype.refreshToolTip = function() {
      this.updateTooltipText();
      if (this.browserTooltips) {
        this.comp.setTitle(this.tooltip != null ? this.tooltip : void 0);
      }
    };
    TooltipFeature2.prototype.getTooltipParams = function() {
      var ctrl = this.ctrl;
      var column = ctrl.getColumn ? ctrl.getColumn() : void 0;
      var colDef = ctrl.getColDef ? ctrl.getColDef() : void 0;
      var rowNode = ctrl.getRowNode ? ctrl.getRowNode() : void 0;
      return {
        location: ctrl.getLocation(),
        colDef,
        column,
        rowIndex: ctrl.getRowIndex ? ctrl.getRowIndex() : void 0,
        node: rowNode,
        data: rowNode ? rowNode.data : void 0,
        value: this.getTooltipText(),
        valueFormatted: ctrl.getValueFormatted ? ctrl.getValueFormatted() : void 0
      };
    };
    TooltipFeature2.prototype.getTooltipText = function() {
      return this.tooltip;
    };
    TooltipFeature2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    return TooltipFeature2;
  }(BeanStub)
);
var __decorate$1O = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var Beans = (
  /** @class */
  function() {
    function Beans2() {
    }
    Beans2.prototype.postConstruct = function() {
      this.doingMasterDetail = this.gridOptionsService.isMasterDetail();
      if (this.gridOptionsService.isRowModelType("clientSide")) {
        this.clientSideRowModel = this.rowModel;
      }
      if (this.gridOptionsService.isRowModelType("serverSide")) {
        this.serverSideRowModel = this.rowModel;
      }
    };
    __decorate$1O([
      Autowired("resizeObserverService")
    ], Beans2.prototype, "resizeObserverService", void 0);
    __decorate$1O([
      Autowired("paginationProxy")
    ], Beans2.prototype, "paginationProxy", void 0);
    __decorate$1O([
      Autowired("context")
    ], Beans2.prototype, "context", void 0);
    __decorate$1O([
      Autowired("columnApi")
    ], Beans2.prototype, "columnApi", void 0);
    __decorate$1O([
      Autowired("gridApi")
    ], Beans2.prototype, "gridApi", void 0);
    __decorate$1O([
      Autowired("gridOptionsService")
    ], Beans2.prototype, "gridOptionsService", void 0);
    __decorate$1O([
      Autowired("expressionService")
    ], Beans2.prototype, "expressionService", void 0);
    __decorate$1O([
      Autowired("environment")
    ], Beans2.prototype, "environment", void 0);
    __decorate$1O([
      Autowired("rowRenderer")
    ], Beans2.prototype, "rowRenderer", void 0);
    __decorate$1O([
      Autowired("templateService")
    ], Beans2.prototype, "templateService", void 0);
    __decorate$1O([
      Autowired("valueService")
    ], Beans2.prototype, "valueService", void 0);
    __decorate$1O([
      Autowired("eventService")
    ], Beans2.prototype, "eventService", void 0);
    __decorate$1O([
      Autowired("columnModel")
    ], Beans2.prototype, "columnModel", void 0);
    __decorate$1O([
      Autowired("headerNavigationService")
    ], Beans2.prototype, "headerNavigationService", void 0);
    __decorate$1O([
      Autowired("navigationService")
    ], Beans2.prototype, "navigationService", void 0);
    __decorate$1O([
      Autowired("columnAnimationService")
    ], Beans2.prototype, "columnAnimationService", void 0);
    __decorate$1O([
      Optional("rangeService")
    ], Beans2.prototype, "rangeService", void 0);
    __decorate$1O([
      Autowired("focusService")
    ], Beans2.prototype, "focusService", void 0);
    __decorate$1O([
      Optional("contextMenuFactory")
    ], Beans2.prototype, "contextMenuFactory", void 0);
    __decorate$1O([
      Autowired("popupService")
    ], Beans2.prototype, "popupService", void 0);
    __decorate$1O([
      Autowired("valueFormatterService")
    ], Beans2.prototype, "valueFormatterService", void 0);
    __decorate$1O([
      Autowired("stylingService")
    ], Beans2.prototype, "stylingService", void 0);
    __decorate$1O([
      Autowired("columnHoverService")
    ], Beans2.prototype, "columnHoverService", void 0);
    __decorate$1O([
      Autowired("userComponentFactory")
    ], Beans2.prototype, "userComponentFactory", void 0);
    __decorate$1O([
      Autowired("userComponentRegistry")
    ], Beans2.prototype, "userComponentRegistry", void 0);
    __decorate$1O([
      Autowired("animationFrameService")
    ], Beans2.prototype, "animationFrameService", void 0);
    __decorate$1O([
      Autowired("dragService")
    ], Beans2.prototype, "dragService", void 0);
    __decorate$1O([
      Autowired("dragAndDropService")
    ], Beans2.prototype, "dragAndDropService", void 0);
    __decorate$1O([
      Autowired("sortController")
    ], Beans2.prototype, "sortController", void 0);
    __decorate$1O([
      Autowired("filterManager")
    ], Beans2.prototype, "filterManager", void 0);
    __decorate$1O([
      Autowired("rowContainerHeightService")
    ], Beans2.prototype, "rowContainerHeightService", void 0);
    __decorate$1O([
      Autowired("frameworkOverrides")
    ], Beans2.prototype, "frameworkOverrides", void 0);
    __decorate$1O([
      Autowired("cellPositionUtils")
    ], Beans2.prototype, "cellPositionUtils", void 0);
    __decorate$1O([
      Autowired("rowPositionUtils")
    ], Beans2.prototype, "rowPositionUtils", void 0);
    __decorate$1O([
      Autowired("selectionService")
    ], Beans2.prototype, "selectionService", void 0);
    __decorate$1O([
      Optional("selectionHandleFactory")
    ], Beans2.prototype, "selectionHandleFactory", void 0);
    __decorate$1O([
      Autowired("rowCssClassCalculator")
    ], Beans2.prototype, "rowCssClassCalculator", void 0);
    __decorate$1O([
      Autowired("rowModel")
    ], Beans2.prototype, "rowModel", void 0);
    __decorate$1O([
      Autowired("ctrlsService")
    ], Beans2.prototype, "ctrlsService", void 0);
    __decorate$1O([
      Autowired("ctrlsFactory")
    ], Beans2.prototype, "ctrlsFactory", void 0);
    __decorate$1O([
      Autowired("agStackComponentsRegistry")
    ], Beans2.prototype, "agStackComponentsRegistry", void 0);
    __decorate$1O([
      Autowired("valueCache")
    ], Beans2.prototype, "valueCache", void 0);
    __decorate$1O([
      Autowired("rowNodeEventThrottle")
    ], Beans2.prototype, "rowNodeEventThrottle", void 0);
    __decorate$1O([
      Autowired("localeService")
    ], Beans2.prototype, "localeService", void 0);
    __decorate$1O([
      Autowired("valueParserService")
    ], Beans2.prototype, "valueParserService", void 0);
    __decorate$1O([
      PostConstruct
    ], Beans2.prototype, "postConstruct", null);
    Beans2 = __decorate$1O([
      Bean("beans")
    ], Beans2);
    return Beans2;
  }()
);
var __extends$1V = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var CellMouseListenerFeature = (
  /** @class */
  function(_super) {
    __extends$1V(CellMouseListenerFeature2, _super);
    function CellMouseListenerFeature2(ctrl, beans, column) {
      var _this = _super.call(this) || this;
      _this.cellCtrl = ctrl;
      _this.beans = beans;
      _this.column = column;
      return _this;
    }
    CellMouseListenerFeature2.prototype.onMouseEvent = function(eventName, mouseEvent) {
      if (isStopPropagationForAgGrid(mouseEvent)) {
        return;
      }
      switch (eventName) {
        case "click":
          this.onCellClicked(mouseEvent);
          break;
        case "mousedown":
        case "touchstart":
          this.onMouseDown(mouseEvent);
          break;
        case "dblclick":
          this.onCellDoubleClicked(mouseEvent);
          break;
        case "mouseout":
          this.onMouseOut(mouseEvent);
          break;
        case "mouseover":
          this.onMouseOver(mouseEvent);
          break;
      }
    };
    CellMouseListenerFeature2.prototype.onCellClicked = function(mouseEvent) {
      if (this.isDoubleClickOnIPad()) {
        this.onCellDoubleClicked(mouseEvent);
        mouseEvent.preventDefault();
        return;
      }
      var _a2 = this.beans, eventService = _a2.eventService, rangeService = _a2.rangeService, gridOptionsService = _a2.gridOptionsService;
      var isMultiKey = mouseEvent.ctrlKey || mouseEvent.metaKey;
      if (rangeService && isMultiKey) {
        if (rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()) > 1) {
          rangeService.intersectLastRange(true);
        }
      }
      var cellClickedEvent = this.cellCtrl.createEvent(mouseEvent, Events.EVENT_CELL_CLICKED);
      eventService.dispatchEvent(cellClickedEvent);
      var colDef = this.column.getColDef();
      if (colDef.onCellClicked) {
        window.setTimeout(function() {
          return colDef.onCellClicked(cellClickedEvent);
        }, 0);
      }
      var editOnSingleClick = (gridOptionsService.is("singleClickEdit") || colDef.singleClickEdit) && !gridOptionsService.is("suppressClickEdit");
      if (editOnSingleClick) {
        this.cellCtrl.startRowOrCellEdit();
      }
    };
    CellMouseListenerFeature2.prototype.isDoubleClickOnIPad = function() {
      if (!isIOSUserAgent() || isEventSupported("dblclick")) {
        return false;
      }
      var nowMillis = (/* @__PURE__ */ new Date()).getTime();
      var res = nowMillis - this.lastIPadMouseClickEvent < 200;
      this.lastIPadMouseClickEvent = nowMillis;
      return res;
    };
    CellMouseListenerFeature2.prototype.onCellDoubleClicked = function(mouseEvent) {
      var colDef = this.column.getColDef();
      var cellDoubleClickedEvent = this.cellCtrl.createEvent(mouseEvent, Events.EVENT_CELL_DOUBLE_CLICKED);
      this.beans.eventService.dispatchEvent(cellDoubleClickedEvent);
      if (typeof colDef.onCellDoubleClicked === "function") {
        window.setTimeout(function() {
          return colDef.onCellDoubleClicked(cellDoubleClickedEvent);
        }, 0);
      }
      var editOnDoubleClick = !this.beans.gridOptionsService.is("singleClickEdit") && !this.beans.gridOptionsService.is("suppressClickEdit");
      if (editOnDoubleClick) {
        this.cellCtrl.startRowOrCellEdit(null, mouseEvent);
      }
    };
    CellMouseListenerFeature2.prototype.onMouseDown = function(mouseEvent) {
      var ctrlKey = mouseEvent.ctrlKey, metaKey = mouseEvent.metaKey, shiftKey = mouseEvent.shiftKey;
      var target = mouseEvent.target;
      var _a2 = this.beans, eventService = _a2.eventService, rangeService = _a2.rangeService;
      if (this.isRightClickInExistingRange(mouseEvent)) {
        return;
      }
      var ranges = rangeService && rangeService.getCellRanges().length != 0;
      if (!shiftKey || !ranges) {
        var forceBrowserFocus = isBrowserSafari() && !this.cellCtrl.isEditing() && !isFocusableFormField(target);
        this.cellCtrl.focusCell(forceBrowserFocus);
      }
      if (shiftKey && ranges) {
        mouseEvent.preventDefault();
      }
      if (this.containsWidget(target)) {
        return;
      }
      if (rangeService) {
        var thisCell = this.cellCtrl.getCellPosition();
        if (shiftKey) {
          rangeService.extendLatestRangeToCell(thisCell);
        } else {
          var isMultiKey = ctrlKey || metaKey;
          rangeService.setRangeToCell(thisCell, isMultiKey);
        }
      }
      eventService.dispatchEvent(this.cellCtrl.createEvent(mouseEvent, Events.EVENT_CELL_MOUSE_DOWN));
    };
    CellMouseListenerFeature2.prototype.isRightClickInExistingRange = function(mouseEvent) {
      var rangeService = this.beans.rangeService;
      if (rangeService) {
        var cellInRange = rangeService.isCellInAnyRange(this.cellCtrl.getCellPosition());
        if (cellInRange && mouseEvent.button === 2) {
          return true;
        }
      }
      return false;
    };
    CellMouseListenerFeature2.prototype.containsWidget = function(target) {
      return isElementChildOfClass(target, "ag-selection-checkbox", 3);
    };
    CellMouseListenerFeature2.prototype.onMouseOut = function(mouseEvent) {
      if (this.mouseStayingInsideCell(mouseEvent)) {
        return;
      }
      var cellMouseOutEvent = this.cellCtrl.createEvent(mouseEvent, Events.EVENT_CELL_MOUSE_OUT);
      this.beans.eventService.dispatchEvent(cellMouseOutEvent);
      this.beans.columnHoverService.clearMouseOver();
    };
    CellMouseListenerFeature2.prototype.onMouseOver = function(mouseEvent) {
      if (this.mouseStayingInsideCell(mouseEvent)) {
        return;
      }
      var cellMouseOverEvent = this.cellCtrl.createEvent(mouseEvent, Events.EVENT_CELL_MOUSE_OVER);
      this.beans.eventService.dispatchEvent(cellMouseOverEvent);
      this.beans.columnHoverService.setMouseOver([this.column]);
    };
    CellMouseListenerFeature2.prototype.mouseStayingInsideCell = function(e) {
      if (!e.target || !e.relatedTarget) {
        return false;
      }
      var eGui = this.cellCtrl.getGui();
      var cellContainsTarget = eGui.contains(e.target);
      var cellContainsRelatedTarget = eGui.contains(e.relatedTarget);
      return cellContainsTarget && cellContainsRelatedTarget;
    };
    CellMouseListenerFeature2.prototype.destroy = function() {
    };
    return CellMouseListenerFeature2;
  }(Beans)
);
var __extends$1U = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var CellKeyboardListenerFeature = (
  /** @class */
  function(_super) {
    __extends$1U(CellKeyboardListenerFeature2, _super);
    function CellKeyboardListenerFeature2(ctrl, beans, column, rowNode, rowCtrl) {
      var _this = _super.call(this) || this;
      _this.cellCtrl = ctrl;
      _this.beans = beans;
      _this.rowNode = rowNode;
      _this.rowCtrl = rowCtrl;
      return _this;
    }
    CellKeyboardListenerFeature2.prototype.setComp = function(eGui) {
      this.eGui = eGui;
    };
    CellKeyboardListenerFeature2.prototype.onKeyDown = function(event) {
      var key = event.key;
      switch (key) {
        case KeyCode.ENTER:
          this.onEnterKeyDown(event);
          break;
        case KeyCode.F2:
          this.onF2KeyDown(event);
          break;
        case KeyCode.ESCAPE:
          this.onEscapeKeyDown(event);
          break;
        case KeyCode.TAB:
          this.onTabKeyDown(event);
          break;
        case KeyCode.BACKSPACE:
        case KeyCode.DELETE:
          this.onBackspaceOrDeleteKeyDown(key, event);
          break;
        case KeyCode.DOWN:
        case KeyCode.UP:
        case KeyCode.RIGHT:
        case KeyCode.LEFT:
          this.onNavigationKeyDown(event, key);
          break;
      }
    };
    CellKeyboardListenerFeature2.prototype.onNavigationKeyDown = function(event, key) {
      if (this.cellCtrl.isEditing()) {
        return;
      }
      if (event.shiftKey && this.cellCtrl.isRangeSelectionEnabled()) {
        this.onShiftRangeSelect(event);
      } else {
        this.beans.navigationService.navigateToNextCell(event, key, this.cellCtrl.getCellPosition(), true);
      }
      event.preventDefault();
    };
    CellKeyboardListenerFeature2.prototype.onShiftRangeSelect = function(event) {
      if (!this.beans.rangeService) {
        return;
      }
      var endCell = this.beans.rangeService.extendLatestRangeInDirection(event);
      if (endCell) {
        this.beans.navigationService.ensureCellVisible(endCell);
      }
    };
    CellKeyboardListenerFeature2.prototype.onTabKeyDown = function(event) {
      this.beans.navigationService.onTabKeyDown(this.cellCtrl, event);
    };
    CellKeyboardListenerFeature2.prototype.onBackspaceOrDeleteKeyDown = function(key, event) {
      var _a2 = this, cellCtrl = _a2.cellCtrl, beans = _a2.beans, rowNode = _a2.rowNode;
      var gridOptionsService = beans.gridOptionsService, rangeService = beans.rangeService, eventService = beans.eventService;
      if (cellCtrl.isEditing()) {
        return;
      }
      eventService.dispatchEvent({ type: Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START });
      if (isDeleteKey(key, gridOptionsService.is("enableCellEditingOnBackspace"))) {
        if (rangeService && gridOptionsService.isEnableRangeSelection()) {
          rangeService.clearCellRangeCellValues({ dispatchWrapperEvents: true, wrapperEventSource: "deleteKey" });
        } else if (cellCtrl.isCellEditable()) {
          rowNode.setDataValue(cellCtrl.getColumn(), null, "cellClear");
        }
      } else {
        cellCtrl.startRowOrCellEdit(key, event);
      }
      eventService.dispatchEvent({ type: Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END });
    };
    CellKeyboardListenerFeature2.prototype.onEnterKeyDown = function(e) {
      if (this.cellCtrl.isEditing() || this.rowCtrl.isEditing()) {
        this.cellCtrl.stopEditingAndFocus(false, e.shiftKey);
      } else {
        if (this.beans.gridOptionsService.is("enterNavigatesVertically")) {
          var key = e.shiftKey ? KeyCode.UP : KeyCode.DOWN;
          this.beans.navigationService.navigateToNextCell(null, key, this.cellCtrl.getCellPosition(), false);
        } else {
          this.cellCtrl.startRowOrCellEdit(KeyCode.ENTER, e);
          if (this.cellCtrl.isEditing()) {
            e.preventDefault();
          }
        }
      }
    };
    CellKeyboardListenerFeature2.prototype.onF2KeyDown = function(event) {
      if (!this.cellCtrl.isEditing()) {
        this.cellCtrl.startRowOrCellEdit(KeyCode.F2, event);
      }
    };
    CellKeyboardListenerFeature2.prototype.onEscapeKeyDown = function(event) {
      if (this.cellCtrl.isEditing()) {
        this.cellCtrl.stopRowOrCellEdit(true);
        this.cellCtrl.focusCell(true);
      }
    };
    CellKeyboardListenerFeature2.prototype.processCharacter = function(event) {
      var eventTarget = event.target;
      var eventOnChildComponent = eventTarget !== this.eGui;
      if (eventOnChildComponent || this.cellCtrl.isEditing()) {
        return;
      }
      var key = event.key;
      if (key === " ") {
        this.onSpaceKeyDown(event);
      } else {
        this.cellCtrl.startRowOrCellEdit(key, event);
        event.preventDefault();
      }
    };
    CellKeyboardListenerFeature2.prototype.onSpaceKeyDown = function(event) {
      var gridOptionsService = this.beans.gridOptionsService;
      if (!this.cellCtrl.isEditing() && gridOptionsService.isRowSelection()) {
        var currentSelection = this.rowNode.isSelected();
        var newSelection = !currentSelection;
        if (newSelection || !gridOptionsService.is("suppressRowDeselection")) {
          var groupSelectsFiltered = this.beans.gridOptionsService.is("groupSelectsFiltered");
          var updatedCount = this.rowNode.setSelectedParams({
            newValue: newSelection,
            rangeSelect: event.shiftKey,
            groupSelectsFiltered,
            event,
            source: "spaceKey"
          });
          if (currentSelection === void 0 && updatedCount === 0) {
            this.rowNode.setSelectedParams({
              newValue: false,
              rangeSelect: event.shiftKey,
              groupSelectsFiltered,
              event,
              source: "spaceKey"
            });
          }
        }
      }
      event.preventDefault();
    };
    CellKeyboardListenerFeature2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
    };
    return CellKeyboardListenerFeature2;
  }(BeanStub)
);
var __extends$1T = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1N = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DndSourceComp = (
  /** @class */
  function(_super) {
    __extends$1T(DndSourceComp2, _super);
    function DndSourceComp2(rowNode, column, eCell) {
      var _this = _super.call(
        this,
        /* html */
        '<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'
      ) || this;
      _this.rowNode = rowNode;
      _this.column = column;
      _this.eCell = eCell;
      return _this;
    }
    DndSourceComp2.prototype.postConstruct = function() {
      var eGui = this.getGui();
      eGui.appendChild(createIconNoSpan("rowDrag", this.gridOptionsService, null));
      this.addGuiEventListener("mousedown", function(e) {
        e.stopPropagation();
      });
      this.addDragSource();
      this.checkVisibility();
    };
    DndSourceComp2.prototype.addDragSource = function() {
      this.addGuiEventListener("dragstart", this.onDragStart.bind(this));
    };
    DndSourceComp2.prototype.onDragStart = function(dragEvent) {
      var _this = this;
      var providedOnRowDrag = this.column.getColDef().dndSourceOnRowDrag;
      dragEvent.dataTransfer.setDragImage(this.eCell, 0, 0);
      var defaultOnRowDrag = function() {
        try {
          var jsonData = JSON.stringify(_this.rowNode.data);
          dragEvent.dataTransfer.setData("application/json", jsonData);
          dragEvent.dataTransfer.setData("text/plain", jsonData);
        } catch (e) {
        }
      };
      if (providedOnRowDrag) {
        var params = {
          rowNode: this.rowNode,
          dragEvent,
          api: this.gridOptionsService.api,
          columnApi: this.gridOptionsService.columnApi,
          context: this.gridOptionsService.context
        };
        providedOnRowDrag(params);
      } else {
        defaultOnRowDrag();
      }
    };
    DndSourceComp2.prototype.checkVisibility = function() {
      var visible = this.column.isDndSource(this.rowNode);
      this.setDisplayed(visible);
    };
    __decorate$1N([
      PostConstruct
    ], DndSourceComp2.prototype, "postConstruct", null);
    return DndSourceComp2;
  }(Component)
);
var __extends$1S = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$9 = function() {
  __assign$9 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$9.apply(this, arguments);
};
var CSS_CELL = "ag-cell";
var CSS_AUTO_HEIGHT = "ag-cell-auto-height";
var CSS_NORMAL_HEIGHT = "ag-cell-normal-height";
var CSS_CELL_FOCUS = "ag-cell-focus";
var CSS_CELL_FIRST_RIGHT_PINNED = "ag-cell-first-right-pinned";
var CSS_CELL_LAST_LEFT_PINNED = "ag-cell-last-left-pinned";
var CSS_CELL_NOT_INLINE_EDITING = "ag-cell-not-inline-editing";
var CSS_COLUMN_HOVER = "ag-column-hover";
var CSS_CELL_WRAP_TEXT = "ag-cell-wrap-text";
var instanceIdSequence$3 = 0;
var CellCtrl = (
  /** @class */
  function(_super) {
    __extends$1S(CellCtrl2, _super);
    function CellCtrl2(column, rowNode, beans, rowCtrl) {
      var _this = _super.call(this) || this;
      _this.cellRangeFeature = null;
      _this.cellPositionFeature = null;
      _this.cellCustomStyleFeature = null;
      _this.tooltipFeature = null;
      _this.cellMouseListenerFeature = null;
      _this.cellKeyboardListenerFeature = null;
      _this.suppressRefreshCell = false;
      _this.onCellCompAttachedFuncs = [];
      _this.column = column;
      _this.rowNode = rowNode;
      _this.beans = beans;
      _this.rowCtrl = rowCtrl;
      _this.instanceId = column.getId() + "-" + instanceIdSequence$3++;
      _this.createCellPosition();
      _this.addFeatures();
      return _this;
    }
    CellCtrl2.prototype.shouldRestoreFocus = function() {
      return this.beans.focusService.shouldRestoreFocus(this.cellPosition);
    };
    CellCtrl2.prototype.addFeatures = function() {
      var _this = this;
      this.cellPositionFeature = new CellPositionFeature(this, this.beans);
      this.addDestroyFunc(function() {
        var _a2;
        (_a2 = _this.cellPositionFeature) === null || _a2 === void 0 ? void 0 : _a2.destroy();
        _this.cellPositionFeature = null;
      });
      this.cellCustomStyleFeature = new CellCustomStyleFeature(this, this.beans);
      this.addDestroyFunc(function() {
        var _a2;
        (_a2 = _this.cellCustomStyleFeature) === null || _a2 === void 0 ? void 0 : _a2.destroy();
        _this.cellCustomStyleFeature = null;
      });
      this.cellMouseListenerFeature = new CellMouseListenerFeature(this, this.beans, this.column);
      this.addDestroyFunc(function() {
        var _a2;
        (_a2 = _this.cellMouseListenerFeature) === null || _a2 === void 0 ? void 0 : _a2.destroy();
        _this.cellMouseListenerFeature = null;
      });
      this.cellKeyboardListenerFeature = new CellKeyboardListenerFeature(this, this.beans, this.column, this.rowNode, this.rowCtrl);
      this.addDestroyFunc(function() {
        var _a2;
        (_a2 = _this.cellKeyboardListenerFeature) === null || _a2 === void 0 ? void 0 : _a2.destroy();
        _this.cellKeyboardListenerFeature = null;
      });
      var rangeSelectionEnabled = this.beans.rangeService && this.beans.gridOptionsService.isEnableRangeSelection();
      if (rangeSelectionEnabled) {
        this.cellRangeFeature = new CellRangeFeature(this.beans, this);
        this.addDestroyFunc(function() {
          var _a2;
          (_a2 = _this.cellRangeFeature) === null || _a2 === void 0 ? void 0 : _a2.destroy();
          _this.cellRangeFeature = null;
        });
      }
      if (this.column.isTooltipEnabled()) {
        this.addTooltipFeature();
      }
    };
    CellCtrl2.prototype.addTooltipFeature = function() {
      var _this = this;
      var getTooltipValue = function() {
        var colDef = _this.column.getColDef();
        var data = _this.rowNode.data;
        if (colDef.tooltipField && exists(data)) {
          return getValueUsingField(data, colDef.tooltipField, _this.column.isTooltipFieldContainsDots());
        }
        var valueGetter = colDef.tooltipValueGetter;
        if (valueGetter) {
          return valueGetter({
            location: "cell",
            api: _this.beans.gridOptionsService.api,
            columnApi: _this.beans.gridOptionsService.columnApi,
            context: _this.beans.gridOptionsService.context,
            colDef: _this.column.getColDef(),
            column: _this.column,
            rowIndex: _this.cellPosition.rowIndex,
            node: _this.rowNode,
            data: _this.rowNode.data,
            value: _this.value,
            valueFormatted: _this.valueFormatted
          });
        }
        return null;
      };
      var tooltipCtrl = {
        getColumn: function() {
          return _this.column;
        },
        getColDef: function() {
          return _this.column.getColDef();
        },
        getRowIndex: function() {
          return _this.cellPosition.rowIndex;
        },
        getRowNode: function() {
          return _this.rowNode;
        },
        getGui: function() {
          return _this.getGui();
        },
        getLocation: function() {
          return "cell";
        },
        getTooltipValue,
        // this makes no sense, why is the cell formatted value passed to the tooltip???
        getValueFormatted: function() {
          return _this.valueFormatted;
        }
      };
      this.tooltipFeature = new TooltipFeature(tooltipCtrl, this.beans);
      this.addDestroyFunc(function() {
        var _a2;
        (_a2 = _this.tooltipFeature) === null || _a2 === void 0 ? void 0 : _a2.destroy();
        _this.tooltipFeature = null;
      });
    };
    CellCtrl2.prototype.setComp = function(comp, eGui, eCellWrapper, printLayout, startEditing) {
      var _a2, _b2, _c, _d;
      this.cellComp = comp;
      this.eGui = eGui;
      this.printLayout = printLayout;
      this.updateAndFormatValue(true);
      this.addDomData();
      this.onCellFocused();
      this.applyStaticCssClasses();
      this.setWrapText();
      this.onFirstRightPinnedChanged();
      this.onLastLeftPinnedChanged();
      this.onColumnHover();
      this.setupControlComps();
      if (eCellWrapper) {
        this.setupAutoHeight(eCellWrapper);
      }
      this.setAriaColIndex();
      if (!this.beans.gridOptionsService.is("suppressCellFocus")) {
        this.cellComp.setTabIndex(-1);
      }
      var colIdSanitised = escapeString(this.column.getId());
      this.cellComp.setColId(colIdSanitised);
      this.cellComp.setRole("gridcell");
      (_a2 = this.cellPositionFeature) === null || _a2 === void 0 ? void 0 : _a2.setComp(eGui);
      (_b2 = this.cellCustomStyleFeature) === null || _b2 === void 0 ? void 0 : _b2.setComp(comp);
      (_c = this.tooltipFeature) === null || _c === void 0 ? void 0 : _c.setComp(comp);
      (_d = this.cellKeyboardListenerFeature) === null || _d === void 0 ? void 0 : _d.setComp(this.eGui);
      if (this.cellRangeFeature) {
        this.cellRangeFeature.setComp(comp, eGui);
      }
      if (startEditing && this.isCellEditable()) {
        this.startEditing();
      } else {
        this.showValue();
      }
      if (this.onCellCompAttachedFuncs.length) {
        this.onCellCompAttachedFuncs.forEach(function(func) {
          return func();
        });
        this.onCellCompAttachedFuncs = [];
      }
    };
    CellCtrl2.prototype.setupAutoHeight = function(eCellWrapper) {
      var _this = this;
      if (!this.column.isAutoHeight()) {
        return;
      }
      var eParentCell = eCellWrapper.parentElement;
      var minRowHeight = this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height;
      var measureHeight = function(timesCalled) {
        if (_this.editing) {
          return;
        }
        if (!_this.isAlive()) {
          return;
        }
        var _a2 = getElementSize(eParentCell), paddingTop = _a2.paddingTop, paddingBottom = _a2.paddingBottom, borderBottomWidth = _a2.borderBottomWidth, borderTopWidth = _a2.borderTopWidth;
        var extraHeight = paddingTop + paddingBottom + borderBottomWidth + borderTopWidth;
        var wrapperHeight = eCellWrapper.offsetHeight;
        var autoHeight = wrapperHeight + extraHeight;
        if (timesCalled < 5) {
          var doc = _this.beans.gridOptionsService.getDocument();
          var notYetInDom = !doc || !doc.contains(eCellWrapper);
          var possiblyNoContentYet = autoHeight == 0;
          if (notYetInDom || possiblyNoContentYet) {
            _this.beans.frameworkOverrides.setTimeout(function() {
              return measureHeight(timesCalled + 1);
            }, 0);
            return;
          }
        }
        var newHeight = Math.max(autoHeight, minRowHeight);
        _this.rowNode.setRowAutoHeight(newHeight, _this.column);
      };
      var listener = function() {
        return measureHeight(0);
      };
      listener();
      var destroyResizeObserver = this.beans.resizeObserverService.observeResize(eCellWrapper, listener);
      this.addDestroyFunc(function() {
        destroyResizeObserver();
        _this.rowNode.setRowAutoHeight(void 0, _this.column);
      });
    };
    CellCtrl2.prototype.getInstanceId = function() {
      return this.instanceId;
    };
    CellCtrl2.prototype.showValue = function(forceNewCellRendererInstance) {
      if (forceNewCellRendererInstance === void 0) {
        forceNewCellRendererInstance = false;
      }
      var valueToDisplay = this.valueFormatted != null ? this.valueFormatted : this.value;
      var params = this.createCellRendererParams();
      var compDetails = this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(), params);
      this.cellComp.setRenderDetails(compDetails, valueToDisplay, forceNewCellRendererInstance);
      this.refreshHandle();
    };
    CellCtrl2.prototype.setupControlComps = function() {
      var colDef = this.column.getColDef();
      this.includeSelection = this.isIncludeControl(colDef.checkboxSelection);
      this.includeRowDrag = this.isIncludeControl(colDef.rowDrag);
      this.includeDndSource = this.isIncludeControl(colDef.dndSource);
      this.cellComp.setIncludeSelection(this.includeSelection);
      this.cellComp.setIncludeDndSource(this.includeDndSource);
      this.cellComp.setIncludeRowDrag(this.includeRowDrag);
    };
    CellCtrl2.prototype.isForceWrapper = function() {
      var forceWrapper = this.beans.gridOptionsService.is("enableCellTextSelection") || this.column.isAutoHeight();
      return forceWrapper;
    };
    CellCtrl2.prototype.isIncludeControl = function(value) {
      var rowNodePinned = this.rowNode.rowPinned != null;
      var isFunc = typeof value === "function";
      var res = rowNodePinned ? false : isFunc || value === true;
      return res;
    };
    CellCtrl2.prototype.refreshShouldDestroy = function() {
      var colDef = this.column.getColDef();
      var selectionChanged = this.includeSelection != this.isIncludeControl(colDef.checkboxSelection);
      var rowDragChanged = this.includeRowDrag != this.isIncludeControl(colDef.rowDrag);
      var dndSourceChanged = this.includeDndSource != this.isIncludeControl(colDef.dndSource);
      return selectionChanged || rowDragChanged || dndSourceChanged;
    };
    CellCtrl2.prototype.startEditing = function(key, cellStartedEdit, event) {
      var _this = this;
      if (key === void 0) {
        key = null;
      }
      if (cellStartedEdit === void 0) {
        cellStartedEdit = false;
      }
      if (event === void 0) {
        event = null;
      }
      if (!this.isCellEditable() || this.editing) {
        return;
      }
      if (!this.cellComp) {
        this.onCellCompAttachedFuncs.push(function() {
          _this.startEditing(key, cellStartedEdit, event);
        });
        return;
      }
      var editorParams = this.createCellEditorParams(key, cellStartedEdit);
      var colDef = this.column.getColDef();
      var compDetails = this.beans.userComponentFactory.getCellEditorDetails(colDef, editorParams);
      var popup = (compDetails === null || compDetails === void 0 ? void 0 : compDetails.popupFromSelector) != null ? compDetails.popupFromSelector : !!colDef.cellEditorPopup;
      var position = (compDetails === null || compDetails === void 0 ? void 0 : compDetails.popupPositionFromSelector) != null ? compDetails.popupPositionFromSelector : colDef.cellEditorPopupPosition;
      this.setEditing(true);
      this.cellComp.setEditDetails(compDetails, popup, position);
      var e = this.createEvent(event, Events.EVENT_CELL_EDITING_STARTED);
      this.beans.eventService.dispatchEvent(e);
    };
    CellCtrl2.prototype.setEditing = function(editing) {
      if (this.editing === editing) {
        return;
      }
      this.editing = editing;
      this.refreshHandle();
    };
    CellCtrl2.prototype.stopRowOrCellEdit = function(cancel) {
      if (cancel === void 0) {
        cancel = false;
      }
      if (this.beans.gridOptionsService.get("editType") === "fullRow") {
        this.rowCtrl.stopRowEditing(cancel);
      } else {
        this.stopEditing(cancel);
      }
    };
    CellCtrl2.prototype.onPopupEditorClosed = function() {
      if (!this.isEditing()) {
        return;
      }
      this.stopEditingAndFocus();
    };
    CellCtrl2.prototype.takeValueFromCellEditor = function(cancel) {
      var noValueResult = { newValueExists: false };
      if (cancel) {
        return noValueResult;
      }
      var cellEditor = this.cellComp.getCellEditor();
      if (!cellEditor) {
        return noValueResult;
      }
      var userWantsToCancel = cellEditor.isCancelAfterEnd && cellEditor.isCancelAfterEnd();
      if (userWantsToCancel) {
        return noValueResult;
      }
      var newValue = cellEditor.getValue();
      return {
        newValue,
        newValueExists: true
      };
    };
    CellCtrl2.prototype.saveNewValue = function(oldValue, newValue) {
      if (newValue === oldValue) {
        return false;
      }
      this.suppressRefreshCell = true;
      var valueChanged = this.rowNode.setDataValue(this.column, newValue, "edit");
      this.suppressRefreshCell = false;
      return valueChanged;
    };
    CellCtrl2.prototype.stopEditing = function(cancel) {
      if (cancel === void 0) {
        cancel = false;
      }
      if (!this.editing) {
        return false;
      }
      var _a2 = this.takeValueFromCellEditor(cancel), newValue = _a2.newValue, newValueExists = _a2.newValueExists;
      var oldValue = this.rowNode.getValueFromValueService(this.column);
      var valueChanged = false;
      if (newValueExists) {
        valueChanged = this.saveNewValue(oldValue, newValue);
      }
      this.setEditing(false);
      this.cellComp.setEditDetails();
      this.updateAndFormatValue();
      this.refreshCell({ forceRefresh: true, suppressFlash: true });
      this.dispatchEditingStoppedEvent(oldValue, newValue, !cancel && !!valueChanged);
      return valueChanged;
    };
    CellCtrl2.prototype.dispatchEditingStoppedEvent = function(oldValue, newValue, valueChanged) {
      var editingStoppedEvent = __assign$9(__assign$9({}, this.createEvent(null, Events.EVENT_CELL_EDITING_STOPPED)), { oldValue, newValue, valueChanged });
      this.beans.eventService.dispatchEvent(editingStoppedEvent);
    };
    CellCtrl2.prototype.createCellEditorParams = function(key, cellStartedEdit) {
      return {
        value: this.rowNode.getValueFromValueService(this.column),
        eventKey: key,
        column: this.column,
        colDef: this.column.getColDef(),
        rowIndex: this.getCellPosition().rowIndex,
        node: this.rowNode,
        data: this.rowNode.data,
        api: this.beans.gridOptionsService.api,
        cellStartedEdit,
        columnApi: this.beans.gridOptionsService.columnApi,
        context: this.beans.gridOptionsService.context,
        onKeyDown: this.onKeyDown.bind(this),
        stopEditing: this.stopEditingAndFocus.bind(this),
        eGridCell: this.getGui(),
        parseValue: this.parseValue.bind(this),
        formatValue: this.formatValue.bind(this)
      };
    };
    CellCtrl2.prototype.createCellRendererParams = function() {
      var _this = this;
      var res = {
        value: this.value,
        valueFormatted: this.valueFormatted,
        getValue: function() {
          return _this.rowNode.getValueFromValueService(_this.column);
        },
        setValue: function(value) {
          return _this.beans.valueService.setValue(_this.rowNode, _this.column, value);
        },
        formatValue: this.formatValue.bind(this),
        data: this.rowNode.data,
        node: this.rowNode,
        pinned: this.column.getPinned(),
        colDef: this.column.getColDef(),
        column: this.column,
        rowIndex: this.getCellPosition().rowIndex,
        api: this.beans.gridOptionsService.api,
        columnApi: this.beans.gridOptionsService.columnApi,
        context: this.beans.gridOptionsService.context,
        refreshCell: this.refreshCell.bind(this),
        eGridCell: this.getGui(),
        eParentOfValue: this.cellComp.getParentOfValue(),
        registerRowDragger: function(rowDraggerElement, dragStartPixels, value, suppressVisibilityChange) {
          return _this.registerRowDragger(rowDraggerElement, dragStartPixels, suppressVisibilityChange);
        }
      };
      return res;
    };
    CellCtrl2.prototype.parseValue = function(newValue) {
      return this.beans.valueParserService.parseValue(this.column, this.rowNode, newValue, this.getValue());
    };
    CellCtrl2.prototype.setFocusOutOnEditor = function() {
      if (!this.editing) {
        return;
      }
      var cellEditor = this.cellComp.getCellEditor();
      if (cellEditor && cellEditor.focusOut) {
        cellEditor.focusOut();
      }
    };
    CellCtrl2.prototype.setFocusInOnEditor = function() {
      if (!this.editing) {
        return;
      }
      var cellEditor = this.cellComp.getCellEditor();
      if (cellEditor && cellEditor.focusIn) {
        cellEditor.focusIn();
      } else {
        this.focusCell(true);
      }
    };
    CellCtrl2.prototype.onCellChanged = function(event) {
      if (!this.cellComp) {
        return;
      }
      var eventImpactsThisCell = event.column === this.column;
      if (eventImpactsThisCell) {
        this.refreshCell({});
      }
    };
    CellCtrl2.prototype.refreshCell = function(params) {
      var _a2, _b2, _c;
      if (this.suppressRefreshCell || this.editing) {
        return;
      }
      if (!this.cellComp) {
        return;
      }
      var colDef = this.column.getColDef();
      var newData = params != null && !!params.newData;
      var suppressFlash = params != null && !!params.suppressFlash || !!colDef.suppressCellFlash;
      var noValueProvided = colDef.field == null && colDef.valueGetter == null && colDef.showRowGroup == null;
      var forceRefresh = params && params.forceRefresh || noValueProvided || newData;
      var valuesDifferent = this.updateAndFormatValue();
      var dataNeedsUpdating = forceRefresh || valuesDifferent;
      if (dataNeedsUpdating) {
        this.showValue(newData);
        var processingFilterChange = this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();
        var flashCell = !suppressFlash && !processingFilterChange && (this.beans.gridOptionsService.is("enableCellChangeFlash") || colDef.enableCellChangeFlash);
        if (flashCell) {
          this.flashCell();
        }
        (_a2 = this.cellCustomStyleFeature) === null || _a2 === void 0 ? void 0 : _a2.applyUserStyles();
        (_b2 = this.cellCustomStyleFeature) === null || _b2 === void 0 ? void 0 : _b2.applyClassesFromColDef();
      }
      this.refreshToolTip();
      (_c = this.cellCustomStyleFeature) === null || _c === void 0 ? void 0 : _c.applyCellClassRules();
    };
    CellCtrl2.prototype.stopEditingAndFocus = function(suppressNavigateAfterEdit, shiftKey) {
      if (suppressNavigateAfterEdit === void 0) {
        suppressNavigateAfterEdit = false;
      }
      if (shiftKey === void 0) {
        shiftKey = false;
      }
      this.stopRowOrCellEdit();
      this.focusCell(true);
      if (!suppressNavigateAfterEdit) {
        this.navigateAfterEdit(shiftKey);
      }
    };
    CellCtrl2.prototype.navigateAfterEdit = function(shiftKey) {
      var enterNavigatesVerticallyAfterEdit = this.beans.gridOptionsService.is("enterNavigatesVerticallyAfterEdit");
      if (enterNavigatesVerticallyAfterEdit) {
        var key = shiftKey ? KeyCode.UP : KeyCode.DOWN;
        this.beans.navigationService.navigateToNextCell(null, key, this.getCellPosition(), false);
      }
    };
    CellCtrl2.prototype.flashCell = function(delays) {
      var flashDelay = delays && delays.flashDelay;
      var fadeDelay = delays && delays.fadeDelay;
      this.animateCell("data-changed", flashDelay, fadeDelay);
    };
    CellCtrl2.prototype.animateCell = function(cssName, flashDelay, fadeDelay) {
      var _this = this;
      var _a2, _b2;
      var fullName = "ag-cell-" + cssName;
      var animationFullName = "ag-cell-" + cssName + "-animation";
      var gridOptionsService = this.beans.gridOptionsService;
      if (!flashDelay) {
        flashDelay = (_a2 = gridOptionsService.getNum("cellFlashDelay")) !== null && _a2 !== void 0 ? _a2 : 500;
      }
      if (!exists(fadeDelay)) {
        fadeDelay = (_b2 = gridOptionsService.getNum("cellFadeDelay")) !== null && _b2 !== void 0 ? _b2 : 1e3;
      }
      this.cellComp.addOrRemoveCssClass(fullName, true);
      this.cellComp.addOrRemoveCssClass(animationFullName, false);
      window.setTimeout(function() {
        if (!_this.isAlive()) {
          return;
        }
        _this.cellComp.addOrRemoveCssClass(fullName, false);
        _this.cellComp.addOrRemoveCssClass(animationFullName, true);
        _this.eGui.style.transition = "background-color " + fadeDelay + "ms";
        window.setTimeout(function() {
          if (!_this.isAlive()) {
            return;
          }
          _this.cellComp.addOrRemoveCssClass(animationFullName, false);
          _this.eGui.style.transition = "";
        }, fadeDelay);
      }, flashDelay);
    };
    CellCtrl2.prototype.onFlashCells = function(event) {
      if (!this.cellComp) {
        return;
      }
      var cellId = this.beans.cellPositionUtils.createId(this.getCellPosition());
      var shouldFlash = event.cells[cellId];
      if (shouldFlash) {
        this.animateCell("highlight");
      }
    };
    CellCtrl2.prototype.isCellEditable = function() {
      return this.column.isCellEditable(this.rowNode);
    };
    CellCtrl2.prototype.isSuppressFillHandle = function() {
      return this.column.isSuppressFillHandle();
    };
    CellCtrl2.prototype.formatValue = function(value) {
      var res = this.callValueFormatter(value);
      return res != null ? res : value;
    };
    CellCtrl2.prototype.callValueFormatter = function(value) {
      return this.beans.valueFormatterService.formatValue(this.column, this.rowNode, value);
    };
    CellCtrl2.prototype.updateAndFormatValue = function(force) {
      if (force === void 0) {
        force = false;
      }
      var oldValue = this.value;
      var oldValueFormatted = this.valueFormatted;
      this.value = this.rowNode.getValueFromValueService(this.column);
      this.valueFormatted = this.callValueFormatter(this.value);
      var valuesDifferent = force ? true : !this.valuesAreEqual(oldValue, this.value) || this.valueFormatted != oldValueFormatted;
      return valuesDifferent;
    };
    CellCtrl2.prototype.valuesAreEqual = function(val1, val2) {
      var colDef = this.column.getColDef();
      return colDef.equals ? colDef.equals(val1, val2) : val1 === val2;
    };
    CellCtrl2.prototype.getComp = function() {
      return this.cellComp;
    };
    CellCtrl2.prototype.getValue = function() {
      return this.value;
    };
    CellCtrl2.prototype.getValueFormatted = function() {
      return this.valueFormatted;
    };
    CellCtrl2.prototype.addDomData = function() {
      var _this = this;
      var element = this.getGui();
      this.beans.gridOptionsService.setDomData(element, CellCtrl2.DOM_DATA_KEY_CELL_CTRL, this);
      this.addDestroyFunc(function() {
        return _this.beans.gridOptionsService.setDomData(element, CellCtrl2.DOM_DATA_KEY_CELL_CTRL, null);
      });
    };
    CellCtrl2.prototype.createEvent = function(domEvent, eventType) {
      var event = {
        type: eventType,
        node: this.rowNode,
        data: this.rowNode.data,
        value: this.value,
        column: this.column,
        colDef: this.column.getColDef(),
        context: this.beans.gridOptionsService.context,
        api: this.beans.gridApi,
        columnApi: this.beans.columnApi,
        rowPinned: this.rowNode.rowPinned,
        event: domEvent,
        rowIndex: this.rowNode.rowIndex
      };
      return event;
    };
    CellCtrl2.prototype.processCharacter = function(event) {
      var _a2;
      (_a2 = this.cellKeyboardListenerFeature) === null || _a2 === void 0 ? void 0 : _a2.processCharacter(event);
    };
    CellCtrl2.prototype.onKeyDown = function(event) {
      var _a2;
      (_a2 = this.cellKeyboardListenerFeature) === null || _a2 === void 0 ? void 0 : _a2.onKeyDown(event);
    };
    CellCtrl2.prototype.onMouseEvent = function(eventName, mouseEvent) {
      var _a2;
      (_a2 = this.cellMouseListenerFeature) === null || _a2 === void 0 ? void 0 : _a2.onMouseEvent(eventName, mouseEvent);
    };
    CellCtrl2.prototype.getGui = function() {
      return this.eGui;
    };
    CellCtrl2.prototype.refreshToolTip = function() {
      var _a2;
      (_a2 = this.tooltipFeature) === null || _a2 === void 0 ? void 0 : _a2.refreshToolTip();
    };
    CellCtrl2.prototype.getColSpanningList = function() {
      return this.cellPositionFeature.getColSpanningList();
    };
    CellCtrl2.prototype.onLeftChanged = function() {
      var _a2;
      if (!this.cellComp) {
        return;
      }
      (_a2 = this.cellPositionFeature) === null || _a2 === void 0 ? void 0 : _a2.onLeftChanged();
    };
    CellCtrl2.prototype.onDisplayedColumnsChanged = function() {
      if (!this.eGui) {
        return;
      }
      this.setAriaColIndex();
    };
    CellCtrl2.prototype.setAriaColIndex = function() {
      var colIdx = this.beans.columnModel.getAriaColumnIndex(this.column);
      setAriaColIndex(this.getGui(), colIdx);
    };
    CellCtrl2.prototype.isSuppressNavigable = function() {
      return this.column.isSuppressNavigable(this.rowNode);
    };
    CellCtrl2.prototype.onWidthChanged = function() {
      var _a2;
      return (_a2 = this.cellPositionFeature) === null || _a2 === void 0 ? void 0 : _a2.onWidthChanged();
    };
    CellCtrl2.prototype.getColumn = function() {
      return this.column;
    };
    CellCtrl2.prototype.getRowNode = function() {
      return this.rowNode;
    };
    CellCtrl2.prototype.getBeans = function() {
      return this.beans;
    };
    CellCtrl2.prototype.isPrintLayout = function() {
      return this.printLayout;
    };
    CellCtrl2.prototype.appendChild = function(htmlElement) {
      this.eGui.appendChild(htmlElement);
    };
    CellCtrl2.prototype.refreshHandle = function() {
      if (this.cellRangeFeature) {
        this.cellRangeFeature.refreshHandle();
      }
    };
    CellCtrl2.prototype.getCellPosition = function() {
      return this.cellPosition;
    };
    CellCtrl2.prototype.isEditing = function() {
      return this.editing;
    };
    CellCtrl2.prototype.startRowOrCellEdit = function(key, event) {
      if (event === void 0) {
        event = null;
      }
      if (!this.cellComp) {
        return;
      }
      if (this.beans.gridOptionsService.get("editType") === "fullRow") {
        this.rowCtrl.startRowEditing(key, this);
      } else {
        this.startEditing(key, true, event);
      }
    };
    CellCtrl2.prototype.getRowCtrl = function() {
      return this.rowCtrl;
    };
    CellCtrl2.prototype.getRowPosition = function() {
      return {
        rowIndex: this.cellPosition.rowIndex,
        rowPinned: this.cellPosition.rowPinned
      };
    };
    CellCtrl2.prototype.updateRangeBordersIfRangeCount = function() {
      if (!this.cellComp) {
        return;
      }
      if (this.cellRangeFeature) {
        this.cellRangeFeature.updateRangeBordersIfRangeCount();
      }
    };
    CellCtrl2.prototype.onRangeSelectionChanged = function() {
      if (!this.cellComp) {
        return;
      }
      if (this.cellRangeFeature) {
        this.cellRangeFeature.onRangeSelectionChanged();
      }
    };
    CellCtrl2.prototype.isRangeSelectionEnabled = function() {
      return this.cellRangeFeature != null;
    };
    CellCtrl2.prototype.focusCell = function(forceBrowserFocus) {
      if (forceBrowserFocus === void 0) {
        forceBrowserFocus = false;
      }
      this.beans.focusService.setFocusedCell({
        rowIndex: this.getCellPosition().rowIndex,
        column: this.column,
        rowPinned: this.rowNode.rowPinned,
        forceBrowserFocus
      });
    };
    CellCtrl2.prototype.onRowIndexChanged = function() {
      this.createCellPosition();
      this.onCellFocused();
      if (this.cellRangeFeature) {
        this.cellRangeFeature.onRangeSelectionChanged();
      }
    };
    CellCtrl2.prototype.onFirstRightPinnedChanged = function() {
      if (!this.cellComp) {
        return;
      }
      var firstRightPinned = this.column.isFirstRightPinned();
      this.cellComp.addOrRemoveCssClass(CSS_CELL_FIRST_RIGHT_PINNED, firstRightPinned);
    };
    CellCtrl2.prototype.onLastLeftPinnedChanged = function() {
      if (!this.cellComp) {
        return;
      }
      var lastLeftPinned = this.column.isLastLeftPinned();
      this.cellComp.addOrRemoveCssClass(CSS_CELL_LAST_LEFT_PINNED, lastLeftPinned);
    };
    CellCtrl2.prototype.onCellFocused = function(event) {
      if (!this.cellComp || this.beans.gridOptionsService.is("suppressCellFocus")) {
        return;
      }
      var cellFocused = this.beans.focusService.isCellFocused(this.cellPosition);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_FOCUS, cellFocused);
      if (cellFocused && event && event.forceBrowserFocus) {
        var focusEl = this.cellComp.getFocusableElement();
        focusEl.focus({ preventScroll: !!event.preventScrollOnBrowserFocus });
      }
      var fullRowEdit = this.beans.gridOptionsService.get("editType") === "fullRow";
      if (!cellFocused && !fullRowEdit && this.editing) {
        this.stopRowOrCellEdit();
      }
    };
    CellCtrl2.prototype.createCellPosition = function() {
      this.cellPosition = {
        rowIndex: this.rowNode.rowIndex,
        rowPinned: makeNull(this.rowNode.rowPinned),
        column: this.column
      };
    };
    CellCtrl2.prototype.applyStaticCssClasses = function() {
      this.cellComp.addOrRemoveCssClass(CSS_CELL, true);
      this.cellComp.addOrRemoveCssClass(CSS_CELL_NOT_INLINE_EDITING, true);
      var autoHeight = this.column.isAutoHeight() == true;
      this.cellComp.addOrRemoveCssClass(CSS_AUTO_HEIGHT, autoHeight);
      this.cellComp.addOrRemoveCssClass(CSS_NORMAL_HEIGHT, !autoHeight);
    };
    CellCtrl2.prototype.onColumnHover = function() {
      if (!this.cellComp) {
        return;
      }
      if (!this.beans.gridOptionsService.is("columnHoverHighlight")) {
        return;
      }
      var isHovered = this.beans.columnHoverService.isHovered(this.column);
      this.cellComp.addOrRemoveCssClass(CSS_COLUMN_HOVER, isHovered);
    };
    CellCtrl2.prototype.onColDefChanged = function() {
      if (!this.cellComp) {
        return;
      }
      this.setWrapText();
      if (!this.editing) {
        this.refreshCell({ forceRefresh: true, suppressFlash: true });
      }
    };
    CellCtrl2.prototype.setWrapText = function() {
      var value = this.column.getColDef().wrapText == true;
      this.cellComp.addOrRemoveCssClass(CSS_CELL_WRAP_TEXT, value);
    };
    CellCtrl2.prototype.dispatchCellContextMenuEvent = function(event) {
      var colDef = this.column.getColDef();
      var cellContextMenuEvent = this.createEvent(event, Events.EVENT_CELL_CONTEXT_MENU);
      this.beans.eventService.dispatchEvent(cellContextMenuEvent);
      if (colDef.onCellContextMenu) {
        window.setTimeout(function() {
          return colDef.onCellContextMenu(cellContextMenuEvent);
        }, 0);
      }
    };
    CellCtrl2.prototype.getCellRenderer = function() {
      return this.cellComp ? this.cellComp.getCellRenderer() : null;
    };
    CellCtrl2.prototype.getCellEditor = function() {
      return this.cellComp ? this.cellComp.getCellEditor() : null;
    };
    CellCtrl2.prototype.destroy = function() {
      this.onCellCompAttachedFuncs = [];
      _super.prototype.destroy.call(this);
    };
    CellCtrl2.prototype.createSelectionCheckbox = function() {
      var cbSelectionComponent = new CheckboxSelectionComponent();
      this.beans.context.createBean(cbSelectionComponent);
      cbSelectionComponent.init({ rowNode: this.rowNode, column: this.column });
      return cbSelectionComponent;
    };
    CellCtrl2.prototype.createDndSource = function() {
      var dndSourceComp = new DndSourceComp(this.rowNode, this.column, this.eGui);
      this.beans.context.createBean(dndSourceComp);
      return dndSourceComp;
    };
    CellCtrl2.prototype.registerRowDragger = function(customElement, dragStartPixels, suppressVisibilityChange) {
      var _this = this;
      if (this.customRowDragComp) {
        this.customRowDragComp.setDragElement(customElement, dragStartPixels);
        return;
      }
      var newComp = this.createRowDragComp(customElement, dragStartPixels, suppressVisibilityChange);
      if (newComp) {
        this.customRowDragComp = newComp;
        this.addDestroyFunc(function() {
          _this.beans.context.destroyBean(newComp);
          _this.customRowDragComp = null;
        });
      }
    };
    CellCtrl2.prototype.createRowDragComp = function(customElement, dragStartPixels, suppressVisibilityChange) {
      var _this = this;
      var pagination = this.beans.gridOptionsService.is("pagination");
      var rowDragManaged = this.beans.gridOptionsService.is("rowDragManaged");
      var clientSideRowModelActive = this.beans.gridOptionsService.isRowModelType("clientSide");
      if (rowDragManaged) {
        if (!clientSideRowModelActive) {
          doOnce(function() {
            return console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model");
          }, "CellComp.addRowDragging");
          return;
        }
        if (pagination) {
          doOnce(function() {
            return console.warn("AG Grid: managed row dragging is not possible when doing pagination");
          }, "CellComp.addRowDragging");
          return;
        }
      }
      var rowDragComp = new RowDragComp(function() {
        return _this.value;
      }, this.rowNode, this.column, customElement, dragStartPixels, suppressVisibilityChange);
      this.beans.context.createBean(rowDragComp);
      return rowDragComp;
    };
    CellCtrl2.DOM_DATA_KEY_CELL_CTRL = "cellCtrl";
    return CellCtrl2;
  }(BeanStub)
);
var __extends$1R = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __values$3 = function(o) {
  var s2 = typeof Symbol === "function" && Symbol.iterator, m2 = s2 && o[s2], i = 0;
  if (m2)
    return m2.call(o);
  if (o && typeof o.length === "number")
    return {
      next: function() {
        if (o && i >= o.length)
          o = void 0;
        return { value: o && o[i++], done: !o };
      }
    };
  throw new TypeError(s2 ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __read$l = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$h = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var RowType$1;
(function(RowType2) {
  RowType2["Normal"] = "Normal";
  RowType2["FullWidth"] = "FullWidth";
  RowType2["FullWidthLoading"] = "FullWidthLoading";
  RowType2["FullWidthGroup"] = "FullWidthGroup";
  RowType2["FullWidthDetail"] = "FullWidthDetail";
})(RowType$1 || (RowType$1 = {}));
var instanceIdSequence$2 = 0;
var RowCtrl = (
  /** @class */
  function(_super) {
    __extends$1R(RowCtrl2, _super);
    function RowCtrl2(rowNode, beans, animateIn, useAnimationFrameForCreate, printLayout) {
      var _this = _super.call(this) || this;
      _this.allRowGuis = [];
      _this.active = true;
      _this.centerCellCtrls = { list: [], map: {} };
      _this.leftCellCtrls = { list: [], map: {} };
      _this.rightCellCtrls = { list: [], map: {} };
      _this.slideInAnimation = {
        left: false,
        center: false,
        right: false,
        fullWidth: false
      };
      _this.fadeInAnimation = {
        left: false,
        center: false,
        right: false,
        fullWidth: false
      };
      _this.lastMouseDownOnDragger = false;
      _this.updateColumnListsPending = false;
      _this.businessKeySanitised = null;
      _this.beans = beans;
      _this.gridOptionsService = beans.gridOptionsService;
      _this.rowNode = rowNode;
      _this.paginationPage = beans.paginationProxy.getCurrentPage();
      _this.useAnimationFrameForCreate = useAnimationFrameForCreate;
      _this.printLayout = printLayout;
      _this.instanceId = rowNode.id + "-" + instanceIdSequence$2++;
      _this.setAnimateFlags(animateIn);
      _this.initRowBusinessKey();
      _this.rowFocused = beans.focusService.isRowFocused(_this.rowNode.rowIndex, _this.rowNode.rowPinned);
      _this.rowLevel = beans.rowCssClassCalculator.calculateRowLevel(_this.rowNode);
      _this.setRowType();
      _this.addListeners();
      return _this;
    }
    RowCtrl2.prototype.initRowBusinessKey = function() {
      this.businessKeyForNodeFunc = this.gridOptionsService.get("getBusinessKeyForNode");
      this.updateRowBusinessKey();
    };
    RowCtrl2.prototype.updateRowBusinessKey = function() {
      if (typeof this.businessKeyForNodeFunc !== "function") {
        return;
      }
      var businessKey = this.businessKeyForNodeFunc(this.rowNode);
      this.businessKeySanitised = escapeString(businessKey);
    };
    RowCtrl2.prototype.isSticky = function() {
      return this.rowNode.sticky;
    };
    RowCtrl2.prototype.getBeans = function() {
      return this.beans;
    };
    RowCtrl2.prototype.getInstanceId = function() {
      return this.instanceId;
    };
    RowCtrl2.prototype.setComp = function(rowComp2, element, containerType) {
      var gui = { rowComp: rowComp2, element, containerType };
      this.allRowGuis.push(gui);
      if (containerType === RowContainerType.LEFT) {
        this.leftGui = gui;
      } else if (containerType === RowContainerType.RIGHT) {
        this.rightGui = gui;
      } else if (containerType === RowContainerType.FULL_WIDTH) {
        this.fullWidthGui = gui;
      } else {
        this.centerGui = gui;
      }
      this.initialiseRowComp(gui);
      if (this.rowType !== "FullWidthLoading" && !this.rowNode.rowPinned) {
        this.beans.rowRenderer.dispatchFirstDataRenderedEvent();
      }
    };
    RowCtrl2.prototype.unsetComp = function(containerType) {
      this.allRowGuis = this.allRowGuis.filter(function(rowGui) {
        return rowGui.containerType !== containerType;
      });
      if (containerType === RowContainerType.LEFT) {
        this.leftGui = void 0;
      } else if (containerType === RowContainerType.RIGHT) {
        this.rightGui = void 0;
      } else if (containerType === RowContainerType.FULL_WIDTH) {
        this.fullWidthGui = void 0;
      }
    };
    RowCtrl2.prototype.isCacheable = function() {
      return this.rowType === RowType$1.FullWidthDetail && this.gridOptionsService.is("keepDetailRows");
    };
    RowCtrl2.prototype.setCached = function(cached) {
      var displayValue = cached ? "none" : "";
      this.allRowGuis.forEach(function(rg2) {
        return rg2.element.style.display = displayValue;
      });
    };
    RowCtrl2.prototype.initialiseRowComp = function(gui) {
      var _this = this;
      var gos = this.gridOptionsService;
      this.listenOnDomOrder(gui);
      this.onRowHeightChanged(gui);
      this.updateRowIndexes(gui);
      this.setFocusedClasses(gui);
      this.setStylesFromGridOptions(gui);
      if (gos.isRowSelection() && this.rowNode.selectable) {
        this.onRowSelected(gui);
      }
      this.updateColumnLists(!this.useAnimationFrameForCreate);
      var comp = gui.rowComp;
      comp.setRole("row");
      var initialRowClasses = this.getInitialRowClasses(gui.containerType);
      initialRowClasses.forEach(function(name) {
        return comp.addOrRemoveCssClass(name, true);
      });
      this.executeSlideAndFadeAnimations(gui);
      if (this.rowNode.group) {
        setAriaExpanded(gui.element, this.rowNode.expanded == true);
      }
      this.setRowCompRowId(comp);
      this.setRowCompRowBusinessKey(comp);
      if (this.isFullWidth() && !this.gridOptionsService.is("suppressCellFocus")) {
        comp.setTabIndex(-1);
      }
      gos.setDomData(gui.element, RowCtrl2.DOM_DATA_KEY_ROW_CTRL, this);
      this.addDestroyFunc(function() {
        return gos.setDomData(gui.element, RowCtrl2.DOM_DATA_KEY_ROW_CTRL, null);
      });
      if (this.useAnimationFrameForCreate) {
        this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this, gui.element), this.rowNode.rowIndex, "createTasksP2");
      } else {
        this.addHoverFunctionality(gui.element);
      }
      if (this.isFullWidth()) {
        this.setupFullWidth(gui);
      }
      if (gos.is("rowDragEntireRow")) {
        this.addRowDraggerToRow(gui);
      }
      if (this.useAnimationFrameForCreate) {
        this.beans.animationFrameService.addDestroyTask(function() {
          if (!_this.isAlive()) {
            return;
          }
          gui.rowComp.addOrRemoveCssClass("ag-after-created", true);
        });
      }
      this.executeProcessRowPostCreateFunc();
    };
    RowCtrl2.prototype.setRowCompRowBusinessKey = function(comp) {
      if (this.businessKeySanitised == null) {
        return;
      }
      comp.setRowBusinessKey(this.businessKeySanitised);
    };
    RowCtrl2.prototype.setRowCompRowId = function(comp) {
      var rowId = escapeString(this.rowNode.id);
      if (rowId == null) {
        return;
      }
      comp.setRowId(rowId);
    };
    RowCtrl2.prototype.executeSlideAndFadeAnimations = function(gui) {
      var _this = this;
      var containerType = gui.containerType;
      var shouldSlide = this.slideInAnimation[containerType];
      if (shouldSlide) {
        executeNextVMTurn(function() {
          _this.onTopChanged();
        });
        this.slideInAnimation[containerType] = false;
      }
      var shouldFade = this.fadeInAnimation[containerType];
      if (shouldFade) {
        executeNextVMTurn(function() {
          gui.rowComp.addOrRemoveCssClass("ag-opacity-zero", false);
        });
        this.fadeInAnimation[containerType] = false;
      }
    };
    RowCtrl2.prototype.addRowDraggerToRow = function(gui) {
      if (this.gridOptionsService.isEnableRangeSelection()) {
        doOnce(function() {
          console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`");
        }, "rowDragAndRangeSelectionEnabled");
        return;
      }
      var translate = this.beans.localeService.getLocaleTextFunc();
      var rowDragComp = new RowDragComp(function() {
        return "1 " + translate("rowDragRow", "row");
      }, this.rowNode, void 0, gui.element, void 0, true);
      this.createManagedBean(rowDragComp, this.beans.context);
    };
    RowCtrl2.prototype.setupFullWidth = function(gui) {
      var pinned = this.getPinnedForContainer(gui.containerType);
      var params = this.createFullWidthParams(gui.element, pinned);
      if (this.rowType == RowType$1.FullWidthDetail) {
        if (!ModuleRegistry.__assertRegistered(ModuleNames.MasterDetailModule, "cell renderer 'agDetailCellRenderer' (for master detail)", this.beans.context.getGridId())) {
          return;
        }
      }
      var compDetails;
      switch (this.rowType) {
        case RowType$1.FullWidthDetail:
          compDetails = this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(params);
          break;
        case RowType$1.FullWidthGroup:
          compDetails = this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(params);
          break;
        case RowType$1.FullWidthLoading:
          compDetails = this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(params);
          break;
        default:
          compDetails = this.beans.userComponentFactory.getFullWidthCellRendererDetails(params);
          break;
      }
      gui.rowComp.showFullWidth(compDetails);
    };
    RowCtrl2.prototype.isPrintLayout = function() {
      return this.printLayout;
    };
    RowCtrl2.prototype.getFullWidthCellRenderer = function() {
      var _a2, _b2;
      return (_b2 = (_a2 = this.fullWidthGui) === null || _a2 === void 0 ? void 0 : _a2.rowComp) === null || _b2 === void 0 ? void 0 : _b2.getFullWidthCellRenderer();
    };
    RowCtrl2.prototype.getCellElement = function(column) {
      var cellCtrl = this.getCellCtrl(column);
      return cellCtrl ? cellCtrl.getGui() : null;
    };
    RowCtrl2.prototype.executeProcessRowPostCreateFunc = function() {
      var _a2;
      var func = this.gridOptionsService.getCallback("processRowPostCreate");
      if (!func || !this.areAllContainersReady()) {
        return;
      }
      var params = {
        eRow: (_a2 = this.centerGui) === null || _a2 === void 0 ? void 0 : _a2.element,
        ePinnedLeftRow: this.leftGui ? this.leftGui.element : void 0,
        ePinnedRightRow: this.rightGui ? this.rightGui.element : void 0,
        node: this.rowNode,
        rowIndex: this.rowNode.rowIndex,
        addRenderedRowListener: this.addEventListener.bind(this)
      };
      func(params);
    };
    RowCtrl2.prototype.areAllContainersReady = function() {
      var isLeftReady = !!this.leftGui || !this.beans.columnModel.isPinningLeft();
      var isCenterReady = !!this.centerGui;
      var isRightReady = !!this.rightGui || !this.beans.columnModel.isPinningRight();
      return isLeftReady && isCenterReady && isRightReady;
    };
    RowCtrl2.prototype.setRowType = function() {
      var isStub = this.rowNode.stub;
      var isFullWidthCell = this.rowNode.isFullWidthCell();
      var isDetailCell = this.beans.doingMasterDetail && this.rowNode.detail;
      var pivotMode = this.beans.columnModel.isPivotMode();
      var isGroupRow = !!this.rowNode.group && !this.rowNode.footer;
      var isFullWidthGroup = isGroupRow && this.gridOptionsService.isGroupUseEntireRow(pivotMode);
      if (isStub) {
        this.rowType = RowType$1.FullWidthLoading;
      } else if (isDetailCell) {
        this.rowType = RowType$1.FullWidthDetail;
      } else if (isFullWidthCell) {
        this.rowType = RowType$1.FullWidth;
      } else if (isFullWidthGroup) {
        this.rowType = RowType$1.FullWidthGroup;
      } else {
        this.rowType = RowType$1.Normal;
      }
    };
    RowCtrl2.prototype.updateColumnLists = function(suppressAnimationFrame, useFlushSync) {
      var _this = this;
      if (suppressAnimationFrame === void 0) {
        suppressAnimationFrame = false;
      }
      if (useFlushSync === void 0) {
        useFlushSync = false;
      }
      if (this.isFullWidth()) {
        return;
      }
      var noAnimation = suppressAnimationFrame || this.gridOptionsService.is("suppressAnimationFrame") || this.printLayout;
      if (noAnimation) {
        this.updateColumnListsImpl(useFlushSync);
        return;
      }
      if (this.updateColumnListsPending) {
        return;
      }
      this.beans.animationFrameService.createTask(function() {
        if (!_this.active) {
          return;
        }
        _this.updateColumnListsImpl(true);
      }, this.rowNode.rowIndex, "createTasksP1");
      this.updateColumnListsPending = true;
    };
    RowCtrl2.prototype.createCellCtrls = function(prev, cols, pinned) {
      var _this = this;
      if (pinned === void 0) {
        pinned = null;
      }
      var res = {
        list: [],
        map: {}
      };
      var addCell = function(colInstanceId, cellCtrl) {
        res.list.push(cellCtrl);
        res.map[colInstanceId] = cellCtrl;
      };
      cols.forEach(function(col) {
        var colInstanceId = col.getInstanceId();
        var cellCtrl = prev.map[colInstanceId];
        if (!cellCtrl) {
          cellCtrl = new CellCtrl(col, _this.rowNode, _this.beans, _this);
        }
        addCell(colInstanceId, cellCtrl);
      });
      prev.list.forEach(function(prevCellCtrl) {
        var cellInResult = res.map[prevCellCtrl.getColumn().getInstanceId()] != null;
        if (cellInResult) {
          return;
        }
        var keepCell = !_this.isCellEligibleToBeRemoved(prevCellCtrl, pinned);
        if (keepCell) {
          addCell(prevCellCtrl.getColumn().getInstanceId(), prevCellCtrl);
          return;
        }
        prevCellCtrl.destroy();
      });
      return res;
    };
    RowCtrl2.prototype.updateColumnListsImpl = function(useFlushSync) {
      var _this = this;
      if (useFlushSync === void 0) {
        useFlushSync = false;
      }
      this.updateColumnListsPending = false;
      var columnModel = this.beans.columnModel;
      if (this.printLayout) {
        this.centerCellCtrls = this.createCellCtrls(this.centerCellCtrls, columnModel.getAllDisplayedColumns());
        this.leftCellCtrls = { list: [], map: {} };
        this.rightCellCtrls = { list: [], map: {} };
      } else {
        var centerCols = columnModel.getViewportCenterColumnsForRow(this.rowNode);
        this.centerCellCtrls = this.createCellCtrls(this.centerCellCtrls, centerCols);
        var leftCols = columnModel.getDisplayedLeftColumnsForRow(this.rowNode);
        this.leftCellCtrls = this.createCellCtrls(this.leftCellCtrls, leftCols, "left");
        var rightCols = columnModel.getDisplayedRightColumnsForRow(this.rowNode);
        this.rightCellCtrls = this.createCellCtrls(this.rightCellCtrls, rightCols, "right");
      }
      this.allRowGuis.forEach(function(item) {
        var cellControls = item.containerType === RowContainerType.LEFT ? _this.leftCellCtrls : item.containerType === RowContainerType.RIGHT ? _this.rightCellCtrls : _this.centerCellCtrls;
        item.rowComp.setCellCtrls(cellControls.list, useFlushSync);
      });
    };
    RowCtrl2.prototype.isCellEligibleToBeRemoved = function(cellCtrl, nextContainerPinned) {
      var REMOVE_CELL = true;
      var KEEP_CELL = false;
      var column = cellCtrl.getColumn();
      if (column.getPinned() != nextContainerPinned) {
        return REMOVE_CELL;
      }
      var editing = cellCtrl.isEditing();
      var focused = this.beans.focusService.isCellFocused(cellCtrl.getCellPosition());
      var mightWantToKeepCell = editing || focused;
      if (mightWantToKeepCell) {
        var column_1 = cellCtrl.getColumn();
        var displayedColumns = this.beans.columnModel.getAllDisplayedColumns();
        var cellStillDisplayed = displayedColumns.indexOf(column_1) >= 0;
        return cellStillDisplayed ? KEEP_CELL : REMOVE_CELL;
      }
      return REMOVE_CELL;
    };
    RowCtrl2.prototype.listenOnDomOrder = function(gui) {
      var _this = this;
      var listener = function() {
        var isEnsureDomOrder = _this.gridOptionsService.is("ensureDomOrder");
        var isPrintLayout = _this.gridOptionsService.isDomLayout("print");
        gui.rowComp.setDomOrder(isEnsureDomOrder || isPrintLayout);
      };
      this.addManagedPropertyListener("domLayout", listener);
      listener();
    };
    RowCtrl2.prototype.setAnimateFlags = function(animateIn) {
      if (this.isSticky() || !animateIn) {
        return;
      }
      var oldRowTopExists = exists(this.rowNode.oldRowTop);
      var pinningLeft = this.beans.columnModel.isPinningLeft();
      var pinningRight = this.beans.columnModel.isPinningRight();
      if (oldRowTopExists) {
        this.slideInAnimation.center = true;
        this.slideInAnimation.left = pinningLeft;
        this.slideInAnimation.right = pinningRight;
      } else {
        this.fadeInAnimation.center = true;
        this.fadeInAnimation.left = pinningLeft;
        this.fadeInAnimation.right = pinningRight;
      }
    };
    RowCtrl2.prototype.isEditing = function() {
      return this.editingRow;
    };
    RowCtrl2.prototype.stopRowEditing = function(cancel) {
      this.stopEditing(cancel);
    };
    RowCtrl2.prototype.isFullWidth = function() {
      return this.rowType !== RowType$1.Normal;
    };
    RowCtrl2.prototype.getRowType = function() {
      return this.rowType;
    };
    RowCtrl2.prototype.refreshFullWidth = function() {
      var _this = this;
      var tryRefresh = function(gui, pinned) {
        if (!gui) {
          return true;
        }
        var cellRenderer = gui.rowComp.getFullWidthCellRenderer();
        if (!cellRenderer) {
          return false;
        }
        if (!cellRenderer.refresh) {
          return false;
        }
        var params = _this.createFullWidthParams(gui.element, pinned);
        var refreshSucceeded = cellRenderer.refresh(params);
        return refreshSucceeded;
      };
      var fullWidthSuccess = tryRefresh(this.fullWidthGui, null);
      var centerSuccess = tryRefresh(this.centerGui, null);
      var leftSuccess = tryRefresh(this.leftGui, "left");
      var rightSuccess = tryRefresh(this.rightGui, "right");
      var allFullWidthRowsRefreshed = fullWidthSuccess && centerSuccess && leftSuccess && rightSuccess;
      return allFullWidthRowsRefreshed;
    };
    RowCtrl2.prototype.addListeners = function() {
      var _this = this;
      this.addManagedListener(this.rowNode, RowNode2.EVENT_HEIGHT_CHANGED, function() {
        return _this.onRowHeightChanged();
      });
      this.addManagedListener(this.rowNode, RowNode2.EVENT_ROW_SELECTED, function() {
        return _this.onRowSelected();
      });
      this.addManagedListener(this.rowNode, RowNode2.EVENT_ROW_INDEX_CHANGED, this.onRowIndexChanged.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_TOP_CHANGED, this.onTopChanged.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_EXPANDED_CHANGED, this.updateExpandedCss.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_HAS_CHILDREN_CHANGED, this.updateExpandedCss.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_DATA_CHANGED, this.onRowNodeDataChanged.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_CELL_CHANGED, this.onRowNodeCellChanged.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_HIGHLIGHT_CHANGED, this.onRowNodeHighlightChanged.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_DRAGGING_CHANGED, this.onRowNodeDraggingChanged.bind(this));
      this.addManagedListener(this.rowNode, RowNode2.EVENT_UI_LEVEL_CHANGED, this.onUiLevelChanged.bind(this));
      var eventService = this.beans.eventService;
      this.addManagedListener(eventService, Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED, this.onPaginationPixelOffsetChanged.bind(this));
      this.addManagedListener(eventService, Events.EVENT_HEIGHT_SCALE_CHANGED, this.onTopChanged.bind(this));
      this.addManagedListener(eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.onDisplayedColumnsChanged.bind(this));
      this.addManagedListener(eventService, Events.EVENT_VIRTUAL_COLUMNS_CHANGED, this.onVirtualColumnsChanged.bind(this));
      this.addManagedListener(eventService, Events.EVENT_CELL_FOCUSED, this.onCellFocused.bind(this));
      this.addManagedListener(eventService, Events.EVENT_CELL_FOCUS_CLEARED, this.onCellFocusCleared.bind(this));
      this.addManagedListener(eventService, Events.EVENT_PAGINATION_CHANGED, this.onPaginationChanged.bind(this));
      this.addManagedListener(eventService, Events.EVENT_MODEL_UPDATED, this.onModelUpdated.bind(this));
      this.addManagedListener(eventService, Events.EVENT_COLUMN_MOVED, this.onColumnMoved.bind(this));
      this.addListenersForCellComps();
    };
    RowCtrl2.prototype.onColumnMoved = function() {
      this.updateColumnLists();
    };
    RowCtrl2.prototype.addListenersForCellComps = function() {
      var _this = this;
      this.addManagedListener(this.rowNode, RowNode2.EVENT_ROW_INDEX_CHANGED, function() {
        _this.getAllCellCtrls().forEach(function(cellCtrl) {
          return cellCtrl.onRowIndexChanged();
        });
      });
      this.addManagedListener(this.rowNode, RowNode2.EVENT_CELL_CHANGED, function(event) {
        _this.getAllCellCtrls().forEach(function(cellCtrl) {
          return cellCtrl.onCellChanged(event);
        });
      });
    };
    RowCtrl2.prototype.onRowNodeDataChanged = function(event) {
      var _this = this;
      if (this.rowNode.detailNode) {
        this.beans.rowRenderer.refreshFullWidthRow(this.rowNode.detailNode);
      }
      if (this.isFullWidth()) {
        this.beans.rowRenderer.refreshFullWidthRow(this.rowNode);
        return;
      }
      this.getAllCellCtrls().forEach(function(cellCtrl) {
        return cellCtrl.refreshCell({
          suppressFlash: !event.update,
          newData: !event.update
        });
      });
      this.allRowGuis.forEach(function(gui) {
        _this.setRowCompRowId(gui.rowComp);
        _this.updateRowBusinessKey();
        _this.setRowCompRowBusinessKey(gui.rowComp);
      });
      this.onRowSelected();
      this.postProcessCss();
    };
    RowCtrl2.prototype.onRowNodeCellChanged = function() {
      this.postProcessCss();
    };
    RowCtrl2.prototype.postProcessCss = function() {
      this.setStylesFromGridOptions();
      this.postProcessClassesFromGridOptions();
      this.postProcessRowClassRules();
      this.postProcessRowDragging();
    };
    RowCtrl2.prototype.onRowNodeHighlightChanged = function() {
      var highlighted = this.rowNode.highlighted;
      this.allRowGuis.forEach(function(gui) {
        var aboveOn = highlighted === RowHighlightPosition.Above;
        var belowOn = highlighted === RowHighlightPosition.Below;
        gui.rowComp.addOrRemoveCssClass("ag-row-highlight-above", aboveOn);
        gui.rowComp.addOrRemoveCssClass("ag-row-highlight-below", belowOn);
      });
    };
    RowCtrl2.prototype.onRowNodeDraggingChanged = function() {
      this.postProcessRowDragging();
    };
    RowCtrl2.prototype.postProcessRowDragging = function() {
      var dragging = this.rowNode.dragging;
      this.allRowGuis.forEach(function(gui) {
        return gui.rowComp.addOrRemoveCssClass("ag-row-dragging", dragging);
      });
    };
    RowCtrl2.prototype.updateExpandedCss = function() {
      var expandable = this.rowNode.isExpandable();
      var expanded = this.rowNode.expanded == true;
      this.allRowGuis.forEach(function(gui) {
        gui.rowComp.addOrRemoveCssClass("ag-row-group", expandable);
        gui.rowComp.addOrRemoveCssClass("ag-row-group-expanded", expandable && expanded);
        gui.rowComp.addOrRemoveCssClass("ag-row-group-contracted", expandable && !expanded);
        setAriaExpanded(gui.element, expandable && expanded);
      });
    };
    RowCtrl2.prototype.onDisplayedColumnsChanged = function() {
      this.updateColumnLists(true);
      if (this.beans.columnModel.wasAutoRowHeightEverActive()) {
        this.rowNode.checkAutoHeights();
      }
    };
    RowCtrl2.prototype.onVirtualColumnsChanged = function() {
      this.updateColumnLists(false, true);
    };
    RowCtrl2.prototype.getRowPosition = function() {
      return {
        rowPinned: makeNull(this.rowNode.rowPinned),
        rowIndex: this.rowNode.rowIndex
      };
    };
    RowCtrl2.prototype.onKeyboardNavigate = function(keyboardEvent) {
      var currentFullWidthComp = this.allRowGuis.find(function(c) {
        return c.element.contains(keyboardEvent.target);
      });
      var currentFullWidthContainer = currentFullWidthComp ? currentFullWidthComp.element : null;
      var isFullWidthContainerFocused = currentFullWidthContainer === keyboardEvent.target;
      if (!isFullWidthContainerFocused) {
        return;
      }
      var node = this.rowNode;
      var lastFocusedCell = this.beans.focusService.getFocusedCell();
      var cellPosition = {
        rowIndex: node.rowIndex,
        rowPinned: node.rowPinned,
        column: lastFocusedCell && lastFocusedCell.column
      };
      this.beans.navigationService.navigateToNextCell(keyboardEvent, keyboardEvent.key, cellPosition, true);
      keyboardEvent.preventDefault();
    };
    RowCtrl2.prototype.onTabKeyDown = function(keyboardEvent) {
      if (keyboardEvent.defaultPrevented || isStopPropagationForAgGrid(keyboardEvent)) {
        return;
      }
      var currentFullWidthComp = this.allRowGuis.find(function(c) {
        return c.element.contains(keyboardEvent.target);
      });
      var currentFullWidthContainer = currentFullWidthComp ? currentFullWidthComp.element : null;
      var isFullWidthContainerFocused = currentFullWidthContainer === keyboardEvent.target;
      var nextEl = null;
      if (!isFullWidthContainerFocused) {
        nextEl = this.beans.focusService.findNextFocusableElement(currentFullWidthContainer, false, keyboardEvent.shiftKey);
      }
      if (this.isFullWidth() && isFullWidthContainerFocused || !nextEl) {
        this.beans.navigationService.onTabKeyDown(this, keyboardEvent);
      }
    };
    RowCtrl2.prototype.onFullWidthRowFocused = function(event) {
      var _a2;
      var node = this.rowNode;
      var isFocused = !event ? false : this.isFullWidth() && event.rowIndex === node.rowIndex && event.rowPinned == node.rowPinned;
      var element = this.fullWidthGui ? this.fullWidthGui.element : (_a2 = this.centerGui) === null || _a2 === void 0 ? void 0 : _a2.element;
      if (!element) {
        return;
      }
      element.classList.toggle("ag-full-width-focus", isFocused);
      if (isFocused) {
        element.focus({ preventScroll: true });
      }
    };
    RowCtrl2.prototype.refreshCell = function(cellCtrl) {
      this.centerCellCtrls = this.removeCellCtrl(this.centerCellCtrls, cellCtrl);
      this.leftCellCtrls = this.removeCellCtrl(this.leftCellCtrls, cellCtrl);
      this.rightCellCtrls = this.removeCellCtrl(this.rightCellCtrls, cellCtrl);
      this.updateColumnLists();
    };
    RowCtrl2.prototype.removeCellCtrl = function(prev, cellCtrlToRemove) {
      var res = {
        list: [],
        map: {}
      };
      prev.list.forEach(function(cellCtrl) {
        if (cellCtrl === cellCtrlToRemove) {
          return;
        }
        res.list.push(cellCtrl);
        res.map[cellCtrl.getInstanceId()] = cellCtrl;
      });
      return res;
    };
    RowCtrl2.prototype.onMouseEvent = function(eventName, mouseEvent) {
      switch (eventName) {
        case "dblclick":
          this.onRowDblClick(mouseEvent);
          break;
        case "click":
          this.onRowClick(mouseEvent);
          break;
        case "touchstart":
        case "mousedown":
          this.onRowMouseDown(mouseEvent);
          break;
      }
    };
    RowCtrl2.prototype.createRowEvent = function(type, domEvent) {
      return {
        type,
        node: this.rowNode,
        data: this.rowNode.data,
        rowIndex: this.rowNode.rowIndex,
        rowPinned: this.rowNode.rowPinned,
        context: this.gridOptionsService.context,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        event: domEvent
      };
    };
    RowCtrl2.prototype.createRowEventWithSource = function(type, domEvent) {
      var event = this.createRowEvent(type, domEvent);
      event.source = this;
      return event;
    };
    RowCtrl2.prototype.onRowDblClick = function(mouseEvent) {
      if (isStopPropagationForAgGrid(mouseEvent)) {
        return;
      }
      var agEvent = this.createRowEventWithSource(Events.EVENT_ROW_DOUBLE_CLICKED, mouseEvent);
      this.beans.eventService.dispatchEvent(agEvent);
    };
    RowCtrl2.prototype.onRowMouseDown = function(mouseEvent) {
      this.lastMouseDownOnDragger = isElementChildOfClass(mouseEvent.target, "ag-row-drag", 3);
      if (!this.isFullWidth()) {
        return;
      }
      var node = this.rowNode;
      var columnModel = this.beans.columnModel;
      if (this.beans.rangeService) {
        this.beans.rangeService.removeAllCellRanges();
      }
      this.beans.focusService.setFocusedCell({
        rowIndex: node.rowIndex,
        column: columnModel.getAllDisplayedColumns()[0],
        rowPinned: node.rowPinned,
        forceBrowserFocus: true
      });
    };
    RowCtrl2.prototype.onRowClick = function(mouseEvent) {
      var stop = isStopPropagationForAgGrid(mouseEvent) || this.lastMouseDownOnDragger;
      if (stop) {
        return;
      }
      var agEvent = this.createRowEventWithSource(Events.EVENT_ROW_CLICKED, mouseEvent);
      this.beans.eventService.dispatchEvent(agEvent);
      var isMultiKey = mouseEvent.ctrlKey || mouseEvent.metaKey;
      var isShiftKey = mouseEvent.shiftKey;
      var groupSelectsChildren = this.gridOptionsService.is("groupSelectsChildren");
      if (
        // we do not allow selecting groups by clicking (as the click here expands the group), or if it's a detail row,
        // so return if it's a group row
        groupSelectsChildren && this.rowNode.group || // this is needed so we don't unselect other rows when we click this row, eg if this row is not selectable,
        // and we click it, the selection should not change (ie any currently selected row should stay selected)
        !this.rowNode.selectable || // we also don't allow selection of pinned rows
        this.rowNode.rowPinned || // if no selection method enabled, do nothing
        !this.gridOptionsService.isRowSelection() || // if click selection suppressed, do nothing
        this.gridOptionsService.is("suppressRowClickSelection")
      ) {
        return;
      }
      var multiSelectOnClick = this.gridOptionsService.is("rowMultiSelectWithClick");
      var rowDeselectionWithCtrl = !this.gridOptionsService.is("suppressRowDeselection");
      var source = "rowClicked";
      if (this.rowNode.isSelected()) {
        if (multiSelectOnClick) {
          this.rowNode.setSelectedParams({ newValue: false, event: mouseEvent, source });
        } else if (isMultiKey) {
          if (rowDeselectionWithCtrl) {
            this.rowNode.setSelectedParams({ newValue: false, event: mouseEvent, source });
          }
        } else {
          this.rowNode.setSelectedParams({ newValue: true, clearSelection: !isShiftKey, rangeSelect: isShiftKey, event: mouseEvent, source });
        }
      } else {
        var clearSelection = multiSelectOnClick ? false : !isMultiKey;
        this.rowNode.setSelectedParams({ newValue: true, clearSelection, rangeSelect: isShiftKey, event: mouseEvent, source });
      }
    };
    RowCtrl2.prototype.setupDetailRowAutoHeight = function(eDetailGui) {
      var _this = this;
      if (this.rowType !== RowType$1.FullWidthDetail) {
        return;
      }
      if (!this.gridOptionsService.is("detailRowAutoHeight")) {
        return;
      }
      var checkRowSizeFunc = function() {
        var clientHeight = eDetailGui.clientHeight;
        if (clientHeight != null && clientHeight > 0) {
          var updateRowHeightFunc = function() {
            _this.rowNode.setRowHeight(clientHeight);
            if (_this.beans.clientSideRowModel) {
              _this.beans.clientSideRowModel.onRowHeightChanged();
            } else if (_this.beans.serverSideRowModel) {
              _this.beans.serverSideRowModel.onRowHeightChanged();
            }
          };
          _this.beans.frameworkOverrides.setTimeout(updateRowHeightFunc, 0);
        }
      };
      var resizeObserverDestroyFunc = this.beans.resizeObserverService.observeResize(eDetailGui, checkRowSizeFunc);
      this.addDestroyFunc(resizeObserverDestroyFunc);
      checkRowSizeFunc();
    };
    RowCtrl2.prototype.createFullWidthParams = function(eRow, pinned) {
      var _this = this;
      var params = {
        fullWidth: true,
        data: this.rowNode.data,
        node: this.rowNode,
        value: this.rowNode.key,
        valueFormatted: this.rowNode.key,
        rowIndex: this.rowNode.rowIndex,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context,
        // these need to be taken out, as part of 'afterAttached' now
        eGridCell: eRow,
        eParentOfValue: eRow,
        pinned,
        addRenderedRowListener: this.addEventListener.bind(this),
        registerRowDragger: function(rowDraggerElement, dragStartPixels, value, suppressVisibilityChange) {
          return _this.addFullWidthRowDragging(rowDraggerElement, dragStartPixels, value, suppressVisibilityChange);
        }
      };
      return params;
    };
    RowCtrl2.prototype.addFullWidthRowDragging = function(rowDraggerElement, dragStartPixels, value, suppressVisibilityChange) {
      if (value === void 0) {
        value = "";
      }
      if (!this.isFullWidth()) {
        return;
      }
      var rowDragComp = new RowDragComp(function() {
        return value;
      }, this.rowNode, void 0, rowDraggerElement, dragStartPixels, suppressVisibilityChange);
      this.createManagedBean(rowDragComp, this.beans.context);
    };
    RowCtrl2.prototype.onUiLevelChanged = function() {
      var newLevel = this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);
      if (this.rowLevel != newLevel) {
        var classToAdd_1 = "ag-row-level-" + newLevel;
        var classToRemove_1 = "ag-row-level-" + this.rowLevel;
        this.allRowGuis.forEach(function(gui) {
          gui.rowComp.addOrRemoveCssClass(classToAdd_1, true);
          gui.rowComp.addOrRemoveCssClass(classToRemove_1, false);
        });
      }
      this.rowLevel = newLevel;
    };
    RowCtrl2.prototype.isFirstRowOnPage = function() {
      return this.rowNode.rowIndex === this.beans.paginationProxy.getPageFirstRow();
    };
    RowCtrl2.prototype.isLastRowOnPage = function() {
      return this.rowNode.rowIndex === this.beans.paginationProxy.getPageLastRow();
    };
    RowCtrl2.prototype.onModelUpdated = function() {
      this.refreshFirstAndLastRowStyles();
    };
    RowCtrl2.prototype.refreshFirstAndLastRowStyles = function() {
      var newFirst = this.isFirstRowOnPage();
      var newLast = this.isLastRowOnPage();
      if (this.firstRowOnPage !== newFirst) {
        this.firstRowOnPage = newFirst;
        this.allRowGuis.forEach(function(gui) {
          return gui.rowComp.addOrRemoveCssClass("ag-row-first", newFirst);
        });
      }
      if (this.lastRowOnPage !== newLast) {
        this.lastRowOnPage = newLast;
        this.allRowGuis.forEach(function(gui) {
          return gui.rowComp.addOrRemoveCssClass("ag-row-last", newLast);
        });
      }
    };
    RowCtrl2.prototype.stopEditing = function(cancel) {
      var e_1, _a2;
      if (cancel === void 0) {
        cancel = false;
      }
      if (this.stoppingRowEdit) {
        return;
      }
      var cellControls = this.getAllCellCtrls();
      var isRowEdit = this.editingRow;
      this.stoppingRowEdit = true;
      var fireRowEditEvent = false;
      try {
        for (var cellControls_1 = __values$3(cellControls), cellControls_1_1 = cellControls_1.next(); !cellControls_1_1.done; cellControls_1_1 = cellControls_1.next()) {
          var ctrl = cellControls_1_1.value;
          var valueChanged = ctrl.stopEditing(cancel);
          if (isRowEdit && !cancel && !fireRowEditEvent && valueChanged) {
            fireRowEditEvent = true;
          }
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (cellControls_1_1 && !cellControls_1_1.done && (_a2 = cellControls_1.return))
            _a2.call(cellControls_1);
        } finally {
          if (e_1)
            throw e_1.error;
        }
      }
      if (fireRowEditEvent) {
        var event_1 = this.createRowEvent(Events.EVENT_ROW_VALUE_CHANGED);
        this.beans.eventService.dispatchEvent(event_1);
      }
      if (isRowEdit) {
        this.setEditingRow(false);
      }
      this.stoppingRowEdit = false;
    };
    RowCtrl2.prototype.setInlineEditingCss = function(editing) {
      this.allRowGuis.forEach(function(gui) {
        gui.rowComp.addOrRemoveCssClass("ag-row-inline-editing", editing);
        gui.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing", !editing);
      });
    };
    RowCtrl2.prototype.setEditingRow = function(value) {
      this.editingRow = value;
      this.allRowGuis.forEach(function(gui) {
        return gui.rowComp.addOrRemoveCssClass("ag-row-editing", value);
      });
      var event = value ? this.createRowEvent(Events.EVENT_ROW_EDITING_STARTED) : this.createRowEvent(Events.EVENT_ROW_EDITING_STOPPED);
      this.beans.eventService.dispatchEvent(event);
    };
    RowCtrl2.prototype.startRowEditing = function(key, sourceRenderedCell, event) {
      if (key === void 0) {
        key = null;
      }
      if (sourceRenderedCell === void 0) {
        sourceRenderedCell = null;
      }
      if (event === void 0) {
        event = null;
      }
      if (this.editingRow) {
        return;
      }
      var atLeastOneEditing = this.getAllCellCtrls().reduce(function(prev, cellCtrl) {
        var cellStartedEdit = cellCtrl === sourceRenderedCell;
        if (cellStartedEdit) {
          cellCtrl.startEditing(key, cellStartedEdit, event);
        } else {
          cellCtrl.startEditing(null, cellStartedEdit, event);
        }
        if (prev) {
          return true;
        }
        return cellCtrl.isEditing();
      }, false);
      if (atLeastOneEditing) {
        this.setEditingRow(true);
      }
    };
    RowCtrl2.prototype.getAllCellCtrls = function() {
      if (this.leftCellCtrls.list.length === 0 && this.rightCellCtrls.list.length === 0) {
        return this.centerCellCtrls.list;
      }
      var res = __spreadArray$h(__spreadArray$h(__spreadArray$h([], __read$l(this.centerCellCtrls.list)), __read$l(this.leftCellCtrls.list)), __read$l(this.rightCellCtrls.list));
      return res;
    };
    RowCtrl2.prototype.postProcessClassesFromGridOptions = function() {
      var _this = this;
      var cssClasses = this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);
      if (!cssClasses || !cssClasses.length) {
        return;
      }
      cssClasses.forEach(function(classStr) {
        _this.allRowGuis.forEach(function(c) {
          return c.rowComp.addOrRemoveCssClass(classStr, true);
        });
      });
    };
    RowCtrl2.prototype.postProcessRowClassRules = function() {
      var _this = this;
      this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode, function(className) {
        _this.allRowGuis.forEach(function(gui) {
          return gui.rowComp.addOrRemoveCssClass(className, true);
        });
      }, function(className) {
        _this.allRowGuis.forEach(function(gui) {
          return gui.rowComp.addOrRemoveCssClass(className, false);
        });
      });
    };
    RowCtrl2.prototype.setStylesFromGridOptions = function(gui) {
      var rowStyles = this.processStylesFromGridOptions();
      this.forEachGui(gui, function(gui2) {
        return gui2.rowComp.setUserStyles(rowStyles);
      });
    };
    RowCtrl2.prototype.getPinnedForContainer = function(rowContainerType) {
      var pinned = rowContainerType === RowContainerType.LEFT ? "left" : rowContainerType === RowContainerType.RIGHT ? "right" : null;
      return pinned;
    };
    RowCtrl2.prototype.getInitialRowClasses = function(rowContainerType) {
      var pinned = this.getPinnedForContainer(rowContainerType);
      var params = {
        rowNode: this.rowNode,
        rowFocused: this.rowFocused,
        fadeRowIn: this.fadeInAnimation[rowContainerType],
        rowIsEven: this.rowNode.rowIndex % 2 === 0,
        rowLevel: this.rowLevel,
        fullWidthRow: this.isFullWidth(),
        firstRowOnPage: this.isFirstRowOnPage(),
        lastRowOnPage: this.isLastRowOnPage(),
        printLayout: this.printLayout,
        expandable: this.rowNode.isExpandable(),
        pinned
      };
      return this.beans.rowCssClassCalculator.getInitialRowClasses(params);
    };
    RowCtrl2.prototype.processStylesFromGridOptions = function() {
      var rowStyle = this.gridOptionsService.get("rowStyle");
      if (rowStyle && typeof rowStyle === "function") {
        console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");
        return;
      }
      var rowStyleFunc = this.gridOptionsService.getCallback("getRowStyle");
      var rowStyleFuncResult;
      if (rowStyleFunc) {
        var params = {
          data: this.rowNode.data,
          node: this.rowNode,
          rowIndex: this.rowNode.rowIndex
        };
        rowStyleFuncResult = rowStyleFunc(params);
      }
      return Object.assign({}, rowStyle, rowStyleFuncResult);
    };
    RowCtrl2.prototype.onRowSelected = function(gui) {
      var _this = this;
      var selected = !!this.rowNode.isSelected();
      this.forEachGui(gui, function(gui2) {
        gui2.rowComp.addOrRemoveCssClass("ag-row-selected", selected);
        setAriaSelected(gui2.element, selected ? true : void 0);
        var ariaLabel = _this.createAriaLabel();
        setAriaLabel(gui2.element, ariaLabel == null ? "" : ariaLabel);
      });
    };
    RowCtrl2.prototype.createAriaLabel = function() {
      var selected = this.rowNode.isSelected();
      if (selected && this.gridOptionsService.is("suppressRowDeselection")) {
        return void 0;
      }
      var translate = this.beans.localeService.getLocaleTextFunc();
      var label = translate(selected ? "ariaRowDeselect" : "ariaRowSelect", "Press SPACE to " + (selected ? "deselect" : "select") + " this row.");
      return label;
    };
    RowCtrl2.prototype.isUseAnimationFrameForCreate = function() {
      return this.useAnimationFrameForCreate;
    };
    RowCtrl2.prototype.addHoverFunctionality = function(eRow) {
      var _this = this;
      if (!this.active) {
        return;
      }
      this.addManagedListener(eRow, "mouseenter", function() {
        return _this.rowNode.onMouseEnter();
      });
      this.addManagedListener(eRow, "mouseleave", function() {
        return _this.rowNode.onMouseLeave();
      });
      this.addManagedListener(this.rowNode, RowNode2.EVENT_MOUSE_ENTER, function() {
        if (!_this.beans.dragService.isDragging() && !_this.gridOptionsService.is("suppressRowHoverHighlight")) {
          eRow.classList.add("ag-row-hover");
          _this.rowNode.setHovered(true);
        }
      });
      this.addManagedListener(this.rowNode, RowNode2.EVENT_MOUSE_LEAVE, function() {
        eRow.classList.remove("ag-row-hover");
        _this.rowNode.setHovered(false);
      });
    };
    RowCtrl2.prototype.roundRowTopToBounds = function(rowTop) {
      var gridBodyCon = this.beans.ctrlsService.getGridBodyCtrl();
      var range = gridBodyCon.getScrollFeature().getVScrollPosition();
      var minPixel = this.applyPaginationOffset(range.top, true) - 100;
      var maxPixel = this.applyPaginationOffset(range.bottom, true) + 100;
      return Math.min(Math.max(minPixel, rowTop), maxPixel);
    };
    RowCtrl2.prototype.getFrameworkOverrides = function() {
      return this.beans.frameworkOverrides;
    };
    RowCtrl2.prototype.forEachGui = function(gui, callback2) {
      var list = gui ? [gui] : this.allRowGuis;
      list.forEach(callback2);
    };
    RowCtrl2.prototype.onRowHeightChanged = function(gui) {
      if (this.rowNode.rowHeight == null) {
        return;
      }
      var rowHeight = this.rowNode.rowHeight;
      var defaultRowHeight = this.beans.environment.getDefaultRowHeight();
      var isHeightFromFunc = this.gridOptionsService.isGetRowHeightFunction();
      var heightFromFunc = isHeightFromFunc ? this.gridOptionsService.getRowHeightForNode(this.rowNode).height : void 0;
      var lineHeight = heightFromFunc ? Math.min(defaultRowHeight, heightFromFunc) - 2 + "px" : void 0;
      this.forEachGui(gui, function(gui2) {
        gui2.element.style.height = rowHeight + "px";
        if (lineHeight) {
          gui2.element.style.setProperty("--ag-line-height", lineHeight);
        }
      });
    };
    RowCtrl2.prototype.addEventListener = function(eventType, listener) {
      _super.prototype.addEventListener.call(this, eventType, listener);
    };
    RowCtrl2.prototype.removeEventListener = function(eventType, listener) {
      _super.prototype.removeEventListener.call(this, eventType, listener);
    };
    RowCtrl2.prototype.destroyFirstPass = function() {
      this.active = false;
      if (this.gridOptionsService.isAnimateRows()) {
        this.setupRemoveAnimation();
      }
      this.rowNode.setHovered(false);
      var event = this.createRowEvent(Events.EVENT_VIRTUAL_ROW_REMOVED);
      this.dispatchEvent(event);
      this.beans.eventService.dispatchEvent(event);
      _super.prototype.destroy.call(this);
    };
    RowCtrl2.prototype.setupRemoveAnimation = function() {
      if (this.isSticky()) {
        return;
      }
      var rowStillVisibleJustNotInViewport = this.rowNode.rowTop != null;
      if (rowStillVisibleJustNotInViewport) {
        var rowTop = this.roundRowTopToBounds(this.rowNode.rowTop);
        this.setRowTop(rowTop);
      } else {
        this.allRowGuis.forEach(function(gui) {
          return gui.rowComp.addOrRemoveCssClass("ag-opacity-zero", true);
        });
      }
    };
    RowCtrl2.prototype.destroySecondPass = function() {
      this.allRowGuis.length = 0;
      var destroyCellCtrls = function(ctrls) {
        ctrls.list.forEach(function(c) {
          return c.destroy();
        });
        return { list: [], map: {} };
      };
      this.centerCellCtrls = destroyCellCtrls(this.centerCellCtrls);
      this.leftCellCtrls = destroyCellCtrls(this.leftCellCtrls);
      this.rightCellCtrls = destroyCellCtrls(this.rightCellCtrls);
    };
    RowCtrl2.prototype.setFocusedClasses = function(gui) {
      var _this = this;
      this.forEachGui(gui, function(gui2) {
        gui2.rowComp.addOrRemoveCssClass("ag-row-focus", _this.rowFocused);
        gui2.rowComp.addOrRemoveCssClass("ag-row-no-focus", !_this.rowFocused);
      });
    };
    RowCtrl2.prototype.onCellFocused = function() {
      this.onCellFocusChanged();
    };
    RowCtrl2.prototype.onCellFocusCleared = function() {
      this.onCellFocusChanged();
    };
    RowCtrl2.prototype.onCellFocusChanged = function() {
      var rowFocused = this.beans.focusService.isRowFocused(this.rowNode.rowIndex, this.rowNode.rowPinned);
      if (rowFocused !== this.rowFocused) {
        this.rowFocused = rowFocused;
        this.setFocusedClasses();
      }
      if (!rowFocused && this.editingRow) {
        this.stopEditing(false);
      }
    };
    RowCtrl2.prototype.onPaginationChanged = function() {
      var currentPage = this.beans.paginationProxy.getCurrentPage();
      if (this.paginationPage !== currentPage) {
        this.paginationPage = currentPage;
        this.onTopChanged();
      }
      this.refreshFirstAndLastRowStyles();
    };
    RowCtrl2.prototype.onTopChanged = function() {
      this.setRowTop(this.rowNode.rowTop);
    };
    RowCtrl2.prototype.onPaginationPixelOffsetChanged = function() {
      this.onTopChanged();
    };
    RowCtrl2.prototype.applyPaginationOffset = function(topPx, reverse) {
      if (reverse === void 0) {
        reverse = false;
      }
      if (this.rowNode.isRowPinned() || this.rowNode.sticky) {
        return topPx;
      }
      var pixelOffset = this.beans.paginationProxy.getPixelOffset();
      var multiplier = reverse ? 1 : -1;
      return topPx + pixelOffset * multiplier;
    };
    RowCtrl2.prototype.setRowTop = function(pixels) {
      if (this.printLayout) {
        return;
      }
      if (exists(pixels)) {
        var afterPaginationPixels = this.applyPaginationOffset(pixels);
        var skipScaling = this.rowNode.isRowPinned() || this.rowNode.sticky;
        var afterScalingPixels = skipScaling ? afterPaginationPixels : this.beans.rowContainerHeightService.getRealPixelPosition(afterPaginationPixels);
        var topPx = afterScalingPixels + "px";
        this.setRowTopStyle(topPx);
      }
    };
    RowCtrl2.prototype.getInitialRowTop = function(rowContainerType) {
      var suppressRowTransform = this.gridOptionsService.is("suppressRowTransform");
      return suppressRowTransform ? this.getInitialRowTopShared(rowContainerType) : void 0;
    };
    RowCtrl2.prototype.getInitialTransform = function(rowContainerType) {
      var suppressRowTransform = this.gridOptionsService.is("suppressRowTransform");
      return suppressRowTransform ? void 0 : "translateY(" + this.getInitialRowTopShared(rowContainerType) + ")";
    };
    RowCtrl2.prototype.getInitialRowTopShared = function(rowContainerType) {
      if (this.printLayout) {
        return "";
      }
      var rowTop;
      if (this.isSticky()) {
        rowTop = this.rowNode.stickyRowTop;
      } else {
        var pixels = this.slideInAnimation[rowContainerType] ? this.roundRowTopToBounds(this.rowNode.oldRowTop) : this.rowNode.rowTop;
        var afterPaginationPixels = this.applyPaginationOffset(pixels);
        rowTop = this.rowNode.isRowPinned() ? afterPaginationPixels : this.beans.rowContainerHeightService.getRealPixelPosition(afterPaginationPixels);
      }
      return rowTop + "px";
    };
    RowCtrl2.prototype.setRowTopStyle = function(topPx) {
      var suppressRowTransform = this.gridOptionsService.is("suppressRowTransform");
      this.allRowGuis.forEach(function(gui) {
        return suppressRowTransform ? gui.rowComp.setTop(topPx) : gui.rowComp.setTransform("translateY(" + topPx + ")");
      });
    };
    RowCtrl2.prototype.getRowNode = function() {
      return this.rowNode;
    };
    RowCtrl2.prototype.getCellCtrl = function(column) {
      var res = null;
      this.getAllCellCtrls().forEach(function(cellCtrl) {
        if (cellCtrl.getColumn() == column) {
          res = cellCtrl;
        }
      });
      if (res != null) {
        return res;
      }
      this.getAllCellCtrls().forEach(function(cellCtrl) {
        if (cellCtrl.getColSpanningList().indexOf(column) >= 0) {
          res = cellCtrl;
        }
      });
      return res;
    };
    RowCtrl2.prototype.onRowIndexChanged = function() {
      if (this.rowNode.rowIndex != null) {
        this.onCellFocusChanged();
        this.updateRowIndexes();
        this.postProcessCss();
      }
    };
    RowCtrl2.prototype.updateRowIndexes = function(gui) {
      var rowIndexStr = this.rowNode.getRowIndexString();
      var headerRowCount = this.beans.headerNavigationService.getHeaderRowCount();
      var rowIsEven = this.rowNode.rowIndex % 2 === 0;
      var ariaRowIndex = headerRowCount + this.rowNode.rowIndex + 1;
      this.forEachGui(gui, function(c) {
        c.rowComp.setRowIndex(rowIndexStr);
        c.rowComp.addOrRemoveCssClass("ag-row-even", rowIsEven);
        c.rowComp.addOrRemoveCssClass("ag-row-odd", !rowIsEven);
        setAriaRowIndex(c.element, ariaRowIndex);
      });
    };
    RowCtrl2.prototype.getPinnedLeftRowElement = function() {
      return this.leftGui ? this.leftGui.element : void 0;
    };
    RowCtrl2.prototype.getPinnedRightRowElement = function() {
      return this.rightGui ? this.rightGui.element : void 0;
    };
    RowCtrl2.prototype.getBodyRowElement = function() {
      return this.centerGui ? this.centerGui.element : void 0;
    };
    RowCtrl2.prototype.getFullWidthRowElement = function() {
      return this.fullWidthGui ? this.fullWidthGui.element : void 0;
    };
    RowCtrl2.DOM_DATA_KEY_ROW_CTRL = "renderedRow";
    return RowCtrl2;
  }(BeanStub)
);
var __extends$1Q = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1M = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$k = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var RowContainerEventsFeature = (
  /** @class */
  function(_super) {
    __extends$1Q(RowContainerEventsFeature2, _super);
    function RowContainerEventsFeature2(element) {
      var _this = _super.call(this) || this;
      _this.element = element;
      return _this;
    }
    RowContainerEventsFeature2.prototype.postConstruct = function() {
      this.addKeyboardListeners();
      this.addMouseListeners();
      this.mockContextMenuForIPad();
    };
    RowContainerEventsFeature2.prototype.addKeyboardListeners = function() {
      var eventName = "keydown";
      var listener = this.processKeyboardEvent.bind(this, eventName);
      this.addManagedListener(this.element, eventName, listener);
    };
    RowContainerEventsFeature2.prototype.addMouseListeners = function() {
      var _this = this;
      var mouseDownEvent = isEventSupported("touchstart") ? "touchstart" : "mousedown";
      var eventNames2 = ["dblclick", "contextmenu", "mouseover", "mouseout", "click", mouseDownEvent];
      eventNames2.forEach(function(eventName) {
        var listener = _this.processMouseEvent.bind(_this, eventName);
        _this.addManagedListener(_this.element, eventName, listener);
      });
    };
    RowContainerEventsFeature2.prototype.processMouseEvent = function(eventName, mouseEvent) {
      if (!this.mouseEventService.isEventFromThisGrid(mouseEvent) || isStopPropagationForAgGrid(mouseEvent)) {
        return;
      }
      var rowComp2 = this.getRowForEvent(mouseEvent);
      var cellCtrl = this.mouseEventService.getRenderedCellForEvent(mouseEvent);
      if (eventName === "contextmenu") {
        this.handleContextMenuMouseEvent(mouseEvent, null, rowComp2, cellCtrl);
      } else {
        if (cellCtrl) {
          cellCtrl.onMouseEvent(eventName, mouseEvent);
        }
        if (rowComp2) {
          rowComp2.onMouseEvent(eventName, mouseEvent);
        }
      }
    };
    RowContainerEventsFeature2.prototype.mockContextMenuForIPad = function() {
      var _this = this;
      if (!isIOSUserAgent()) {
        return;
      }
      var touchListener = new TouchListener(this.element);
      var longTapListener = function(event) {
        var rowComp2 = _this.getRowForEvent(event.touchEvent);
        var cellComp2 = _this.mouseEventService.getRenderedCellForEvent(event.touchEvent);
        _this.handleContextMenuMouseEvent(null, event.touchEvent, rowComp2, cellComp2);
      };
      this.addManagedListener(touchListener, TouchListener.EVENT_LONG_TAP, longTapListener);
      this.addDestroyFunc(function() {
        return touchListener.destroy();
      });
    };
    RowContainerEventsFeature2.prototype.getRowForEvent = function(event) {
      var sourceElement = event.target;
      while (sourceElement) {
        var rowCon = this.gridOptionsService.getDomData(sourceElement, RowCtrl.DOM_DATA_KEY_ROW_CTRL);
        if (rowCon) {
          return rowCon;
        }
        sourceElement = sourceElement.parentElement;
      }
      return null;
    };
    RowContainerEventsFeature2.prototype.handleContextMenuMouseEvent = function(mouseEvent, touchEvent, rowComp2, cellCtrl) {
      var rowNode = rowComp2 ? rowComp2.getRowNode() : null;
      var column = cellCtrl ? cellCtrl.getColumn() : null;
      var value = null;
      if (column) {
        var event_1 = mouseEvent ? mouseEvent : touchEvent;
        cellCtrl.dispatchCellContextMenuEvent(event_1);
        value = this.valueService.getValue(column, rowNode);
      }
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      var anchorToElement = cellCtrl ? cellCtrl.getGui() : gridBodyCon.getGridBodyElement();
      if (this.contextMenuFactory) {
        this.contextMenuFactory.onContextMenu(mouseEvent, touchEvent, rowNode, column, value, anchorToElement);
      }
    };
    RowContainerEventsFeature2.prototype.getControlsForEventTarget = function(target) {
      return {
        cellCtrl: getCtrlForEventTarget(this.gridOptionsService, target, CellCtrl.DOM_DATA_KEY_CELL_CTRL),
        rowCtrl: getCtrlForEventTarget(this.gridOptionsService, target, RowCtrl.DOM_DATA_KEY_ROW_CTRL)
      };
    };
    RowContainerEventsFeature2.prototype.processKeyboardEvent = function(eventName, keyboardEvent) {
      var _a2 = this.getControlsForEventTarget(keyboardEvent.target), cellCtrl = _a2.cellCtrl, rowCtrl = _a2.rowCtrl;
      if (keyboardEvent.defaultPrevented) {
        return;
      }
      if (cellCtrl) {
        this.processCellKeyboardEvent(cellCtrl, eventName, keyboardEvent);
      } else if (rowCtrl && rowCtrl.isFullWidth()) {
        this.processFullWidthRowKeyboardEvent(rowCtrl, eventName, keyboardEvent);
      }
    };
    RowContainerEventsFeature2.prototype.processCellKeyboardEvent = function(cellCtrl, eventName, keyboardEvent) {
      var rowNode = cellCtrl.getRowNode();
      var column = cellCtrl.getColumn();
      var editing = cellCtrl.isEditing();
      var gridProcessingAllowed = !isUserSuppressingKeyboardEvent(this.gridOptionsService, keyboardEvent, rowNode, column, editing);
      if (gridProcessingAllowed) {
        if (eventName === "keydown") {
          var wasScrollKey = !editing && this.navigationService.handlePageScrollingKey(keyboardEvent);
          if (!wasScrollKey) {
            cellCtrl.onKeyDown(keyboardEvent);
          }
          this.doGridOperations(keyboardEvent, cellCtrl.isEditing());
          if (isEventFromPrintableCharacter(keyboardEvent)) {
            cellCtrl.processCharacter(keyboardEvent);
          }
        }
      }
      if (eventName === "keydown") {
        var cellKeyDownEvent = cellCtrl.createEvent(keyboardEvent, Events.EVENT_CELL_KEY_DOWN);
        this.eventService.dispatchEvent(cellKeyDownEvent);
      }
    };
    RowContainerEventsFeature2.prototype.processFullWidthRowKeyboardEvent = function(rowComp2, eventName, keyboardEvent) {
      var rowNode = rowComp2.getRowNode();
      var focusedCell = this.focusService.getFocusedCell();
      var column = focusedCell && focusedCell.column;
      var gridProcessingAllowed = !isUserSuppressingKeyboardEvent(this.gridOptionsService, keyboardEvent, rowNode, column, false);
      if (gridProcessingAllowed) {
        var key = keyboardEvent.key;
        if (eventName === "keydown") {
          switch (key) {
            case KeyCode.PAGE_HOME:
            case KeyCode.PAGE_END:
            case KeyCode.PAGE_UP:
            case KeyCode.PAGE_DOWN:
              this.navigationService.handlePageScrollingKey(keyboardEvent, true);
              break;
            case KeyCode.UP:
            case KeyCode.DOWN:
              rowComp2.onKeyboardNavigate(keyboardEvent);
              break;
            case KeyCode.TAB:
              rowComp2.onTabKeyDown(keyboardEvent);
              break;
          }
        }
      }
      if (eventName === "keydown") {
        var cellKeyDownEvent = rowComp2.createRowEvent(Events.EVENT_CELL_KEY_DOWN, keyboardEvent);
        this.eventService.dispatchEvent(cellKeyDownEvent);
      }
    };
    RowContainerEventsFeature2.prototype.doGridOperations = function(keyboardEvent, editing) {
      if (!keyboardEvent.ctrlKey && !keyboardEvent.metaKey) {
        return;
      }
      if (editing) {
        return;
      }
      if (!this.mouseEventService.isEventFromThisGrid(keyboardEvent)) {
        return;
      }
      var keyCode = normaliseQwertyAzerty(keyboardEvent);
      if (keyCode === KeyCode.A) {
        return this.onCtrlAndA(keyboardEvent);
      }
      if (keyCode === KeyCode.C) {
        return this.onCtrlAndC(keyboardEvent);
      }
      if (keyCode === KeyCode.D) {
        return this.onCtrlAndD(keyboardEvent);
      }
      if (keyCode === KeyCode.V) {
        return this.onCtrlAndV(keyboardEvent);
      }
      if (keyCode === KeyCode.X) {
        return this.onCtrlAndX(keyboardEvent);
      }
      if (keyCode === KeyCode.Y) {
        return this.onCtrlAndY();
      }
      if (keyCode === KeyCode.Z) {
        return this.onCtrlAndZ(keyboardEvent);
      }
    };
    RowContainerEventsFeature2.prototype.onCtrlAndA = function(event) {
      var _a2 = this, pinnedRowModel = _a2.pinnedRowModel, paginationProxy = _a2.paginationProxy, rangeService = _a2.rangeService;
      if (rangeService && paginationProxy.isRowsToRender()) {
        var _b2 = __read$k([
          pinnedRowModel.isEmpty("top"),
          pinnedRowModel.isEmpty("bottom")
        ], 2), isEmptyPinnedTop = _b2[0], isEmptyPinnedBottom = _b2[1];
        var floatingStart = isEmptyPinnedTop ? null : "top";
        var floatingEnd = void 0;
        var rowEnd = void 0;
        if (isEmptyPinnedBottom) {
          floatingEnd = null;
          rowEnd = this.paginationProxy.getRowCount() - 1;
        } else {
          floatingEnd = "bottom";
          rowEnd = pinnedRowModel.getPinnedBottomRowData().length - 1;
        }
        var allDisplayedColumns = this.columnModel.getAllDisplayedColumns();
        if (missingOrEmpty(allDisplayedColumns)) {
          return;
        }
        rangeService.setCellRange({
          rowStartIndex: 0,
          rowStartPinned: floatingStart,
          rowEndIndex: rowEnd,
          rowEndPinned: floatingEnd,
          columnStart: allDisplayedColumns[0],
          columnEnd: last(allDisplayedColumns)
        });
      }
      event.preventDefault();
    };
    RowContainerEventsFeature2.prototype.onCtrlAndC = function(event) {
      if (!this.clipboardService || this.gridOptionsService.is("enableCellTextSelection")) {
        return;
      }
      var _a2 = this.getControlsForEventTarget(event.target), cellCtrl = _a2.cellCtrl, rowCtrl = _a2.rowCtrl;
      if ((cellCtrl === null || cellCtrl === void 0 ? void 0 : cellCtrl.isEditing()) || (rowCtrl === null || rowCtrl === void 0 ? void 0 : rowCtrl.isEditing())) {
        return;
      }
      event.preventDefault();
      this.clipboardService.copyToClipboard();
    };
    RowContainerEventsFeature2.prototype.onCtrlAndX = function(event) {
      if (!this.clipboardService || this.gridOptionsService.is("enableCellTextSelection") || this.gridOptionsService.is("suppressCutToClipboard")) {
        return;
      }
      var _a2 = this.getControlsForEventTarget(event.target), cellCtrl = _a2.cellCtrl, rowCtrl = _a2.rowCtrl;
      if ((cellCtrl === null || cellCtrl === void 0 ? void 0 : cellCtrl.isEditing()) || (rowCtrl === null || rowCtrl === void 0 ? void 0 : rowCtrl.isEditing())) {
        return;
      }
      event.preventDefault();
      this.clipboardService.cutToClipboard(void 0, "ui");
    };
    RowContainerEventsFeature2.prototype.onCtrlAndV = function(event) {
      var _a2 = this.getControlsForEventTarget(event.target), cellCtrl = _a2.cellCtrl, rowCtrl = _a2.rowCtrl;
      if ((cellCtrl === null || cellCtrl === void 0 ? void 0 : cellCtrl.isEditing()) || (rowCtrl === null || rowCtrl === void 0 ? void 0 : rowCtrl.isEditing())) {
        return;
      }
      if (this.clipboardService && !this.gridOptionsService.is("suppressClipboardPaste")) {
        this.clipboardService.pasteFromClipboard();
      }
    };
    RowContainerEventsFeature2.prototype.onCtrlAndD = function(event) {
      if (this.clipboardService && !this.gridOptionsService.is("suppressClipboardPaste")) {
        this.clipboardService.copyRangeDown();
      }
      event.preventDefault();
    };
    RowContainerEventsFeature2.prototype.onCtrlAndZ = function(event) {
      if (!this.gridOptionsService.is("undoRedoCellEditing")) {
        return;
      }
      event.preventDefault();
      if (event.shiftKey) {
        this.undoRedoService.redo("ui");
      } else {
        this.undoRedoService.undo("ui");
      }
    };
    RowContainerEventsFeature2.prototype.onCtrlAndY = function() {
      this.undoRedoService.redo("ui");
    };
    __decorate$1M([
      Autowired("mouseEventService")
    ], RowContainerEventsFeature2.prototype, "mouseEventService", void 0);
    __decorate$1M([
      Autowired("valueService")
    ], RowContainerEventsFeature2.prototype, "valueService", void 0);
    __decorate$1M([
      Optional("contextMenuFactory")
    ], RowContainerEventsFeature2.prototype, "contextMenuFactory", void 0);
    __decorate$1M([
      Autowired("ctrlsService")
    ], RowContainerEventsFeature2.prototype, "ctrlsService", void 0);
    __decorate$1M([
      Autowired("navigationService")
    ], RowContainerEventsFeature2.prototype, "navigationService", void 0);
    __decorate$1M([
      Autowired("focusService")
    ], RowContainerEventsFeature2.prototype, "focusService", void 0);
    __decorate$1M([
      Autowired("undoRedoService")
    ], RowContainerEventsFeature2.prototype, "undoRedoService", void 0);
    __decorate$1M([
      Autowired("columnModel")
    ], RowContainerEventsFeature2.prototype, "columnModel", void 0);
    __decorate$1M([
      Autowired("paginationProxy")
    ], RowContainerEventsFeature2.prototype, "paginationProxy", void 0);
    __decorate$1M([
      Autowired("pinnedRowModel")
    ], RowContainerEventsFeature2.prototype, "pinnedRowModel", void 0);
    __decorate$1M([
      Optional("rangeService")
    ], RowContainerEventsFeature2.prototype, "rangeService", void 0);
    __decorate$1M([
      Optional("clipboardService")
    ], RowContainerEventsFeature2.prototype, "clipboardService", void 0);
    __decorate$1M([
      PostConstruct
    ], RowContainerEventsFeature2.prototype, "postConstruct", null);
    return RowContainerEventsFeature2;
  }(BeanStub)
);
var __extends$1P = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1L = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ViewportSizeFeature = (
  /** @class */
  function(_super) {
    __extends$1P(ViewportSizeFeature2, _super);
    function ViewportSizeFeature2(centerContainerCtrl) {
      var _this = _super.call(this) || this;
      _this.centerContainerCtrl = centerContainerCtrl;
      return _this;
    }
    ViewportSizeFeature2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function() {
        _this.gridBodyCtrl = _this.ctrlsService.getGridBodyCtrl();
        _this.listenForResize();
      });
      this.addManagedListener(this.eventService, Events.EVENT_SCROLLBAR_WIDTH_CHANGED, this.onScrollbarWidthChanged.bind(this));
    };
    ViewportSizeFeature2.prototype.listenForResize = function() {
      var _this = this;
      var listener = function() {
        return _this.onCenterViewportResized();
      };
      this.centerContainerCtrl.registerViewportResizeListener(listener);
      this.gridBodyCtrl.registerBodyViewportResizeListener(listener);
    };
    ViewportSizeFeature2.prototype.onScrollbarWidthChanged = function() {
      this.checkViewportAndScrolls();
    };
    ViewportSizeFeature2.prototype.onCenterViewportResized = function() {
      if (this.centerContainerCtrl.isViewportVisible()) {
        this.checkViewportAndScrolls();
        var newWidth = this.centerContainerCtrl.getCenterWidth();
        if (newWidth !== this.centerWidth) {
          this.centerWidth = newWidth;
          this.columnModel.refreshFlexedColumns({ viewportWidth: this.centerWidth, updateBodyWidths: true, fireResizedEvent: true });
        }
      } else {
        this.bodyHeight = 0;
      }
    };
    ViewportSizeFeature2.prototype.checkViewportAndScrolls = function() {
      this.updateScrollVisibleService();
      this.checkBodyHeight();
      this.onHorizontalViewportChanged();
      this.gridBodyCtrl.getScrollFeature().checkScrollLeft();
    };
    ViewportSizeFeature2.prototype.getBodyHeight = function() {
      return this.bodyHeight;
    };
    ViewportSizeFeature2.prototype.checkBodyHeight = function() {
      var eBodyViewport = this.gridBodyCtrl.getBodyViewportElement();
      var bodyHeight = getInnerHeight(eBodyViewport);
      if (this.bodyHeight !== bodyHeight) {
        this.bodyHeight = bodyHeight;
        var event_1 = {
          type: Events.EVENT_BODY_HEIGHT_CHANGED
        };
        this.eventService.dispatchEvent(event_1);
      }
    };
    ViewportSizeFeature2.prototype.updateScrollVisibleService = function() {
      this.updateScrollVisibleServiceImpl();
      setTimeout(this.updateScrollVisibleServiceImpl.bind(this), 500);
    };
    ViewportSizeFeature2.prototype.updateScrollVisibleServiceImpl = function() {
      var params = {
        horizontalScrollShowing: this.isHorizontalScrollShowing(),
        verticalScrollShowing: this.gridBodyCtrl.isVerticalScrollShowing()
      };
      this.scrollVisibleService.setScrollsVisible(params);
    };
    ViewportSizeFeature2.prototype.isHorizontalScrollShowing = function() {
      return this.centerContainerCtrl.isHorizontalScrollShowing();
    };
    ViewportSizeFeature2.prototype.onHorizontalViewportChanged = function() {
      var scrollWidth = this.centerContainerCtrl.getCenterWidth();
      var scrollPosition = this.centerContainerCtrl.getViewportScrollLeft();
      this.columnModel.setViewportPosition(scrollWidth, scrollPosition);
    };
    __decorate$1L([
      Autowired("ctrlsService")
    ], ViewportSizeFeature2.prototype, "ctrlsService", void 0);
    __decorate$1L([
      Autowired("columnModel")
    ], ViewportSizeFeature2.prototype, "columnModel", void 0);
    __decorate$1L([
      Autowired("scrollVisibleService")
    ], ViewportSizeFeature2.prototype, "scrollVisibleService", void 0);
    __decorate$1L([
      PostConstruct
    ], ViewportSizeFeature2.prototype, "postConstruct", null);
    return ViewportSizeFeature2;
  }(BeanStub)
);
var __extends$1O = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1K = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SetPinnedLeftWidthFeature = (
  /** @class */
  function(_super) {
    __extends$1O(SetPinnedLeftWidthFeature2, _super);
    function SetPinnedLeftWidthFeature2(element) {
      var _this = _super.call(this) || this;
      _this.element = element;
      return _this;
    }
    SetPinnedLeftWidthFeature2.prototype.postConstruct = function() {
      this.addManagedListener(this.eventService, Events.EVENT_LEFT_PINNED_WIDTH_CHANGED, this.onPinnedLeftWidthChanged.bind(this));
    };
    SetPinnedLeftWidthFeature2.prototype.onPinnedLeftWidthChanged = function() {
      var leftWidth = this.pinnedWidthService.getPinnedLeftWidth();
      var displayed = leftWidth > 0;
      setDisplayed(this.element, displayed);
      setFixedWidth(this.element, leftWidth);
    };
    SetPinnedLeftWidthFeature2.prototype.getWidth = function() {
      return this.pinnedWidthService.getPinnedLeftWidth();
    };
    __decorate$1K([
      Autowired("pinnedWidthService")
    ], SetPinnedLeftWidthFeature2.prototype, "pinnedWidthService", void 0);
    __decorate$1K([
      PostConstruct
    ], SetPinnedLeftWidthFeature2.prototype, "postConstruct", null);
    return SetPinnedLeftWidthFeature2;
  }(BeanStub)
);
var __extends$1N = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1J = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SetPinnedRightWidthFeature = (
  /** @class */
  function(_super) {
    __extends$1N(SetPinnedRightWidthFeature2, _super);
    function SetPinnedRightWidthFeature2(element) {
      var _this = _super.call(this) || this;
      _this.element = element;
      return _this;
    }
    SetPinnedRightWidthFeature2.prototype.postConstruct = function() {
      this.addManagedListener(this.eventService, Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED, this.onPinnedRightWidthChanged.bind(this));
    };
    SetPinnedRightWidthFeature2.prototype.onPinnedRightWidthChanged = function() {
      var rightWidth = this.pinnedWidthService.getPinnedRightWidth();
      var displayed = rightWidth > 0;
      setDisplayed(this.element, displayed);
      setFixedWidth(this.element, rightWidth);
    };
    SetPinnedRightWidthFeature2.prototype.getWidth = function() {
      return this.pinnedWidthService.getPinnedRightWidth();
    };
    __decorate$1J([
      Autowired("pinnedWidthService")
    ], SetPinnedRightWidthFeature2.prototype, "pinnedWidthService", void 0);
    __decorate$1J([
      PostConstruct
    ], SetPinnedRightWidthFeature2.prototype, "postConstruct", null);
    return SetPinnedRightWidthFeature2;
  }(BeanStub)
);
var __extends$1M = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1I = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SetHeightFeature = (
  /** @class */
  function(_super) {
    __extends$1M(SetHeightFeature2, _super);
    function SetHeightFeature2(eContainer, eWrapper) {
      var _this = _super.call(this) || this;
      _this.eContainer = eContainer;
      _this.eWrapper = eWrapper;
      return _this;
    }
    SetHeightFeature2.prototype.postConstruct = function() {
      this.addManagedListener(this.eventService, Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED, this.onHeightChanged.bind(this));
    };
    SetHeightFeature2.prototype.onHeightChanged = function() {
      var height = this.maxDivHeightScaler.getUiContainerHeight();
      var heightString = height != null ? height + "px" : "";
      this.eContainer.style.height = heightString;
      if (this.eWrapper) {
        this.eWrapper.style.height = heightString;
      }
    };
    __decorate$1I([
      Autowired("rowContainerHeightService")
    ], SetHeightFeature2.prototype, "maxDivHeightScaler", void 0);
    __decorate$1I([
      PostConstruct
    ], SetHeightFeature2.prototype, "postConstruct", null);
    return SetHeightFeature2;
  }(BeanStub)
);
var __extends$1L = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1H = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DragListenerFeature = (
  /** @class */
  function(_super) {
    __extends$1L(DragListenerFeature2, _super);
    function DragListenerFeature2(eContainer) {
      var _this = _super.call(this) || this;
      _this.eContainer = eContainer;
      return _this;
    }
    DragListenerFeature2.prototype.postConstruct = function() {
      var _this = this;
      if (!this.gridOptionsService.isEnableRangeSelection() || // no range selection if no property
      missing(this.rangeService)) {
        return;
      }
      var params = {
        eElement: this.eContainer,
        onDragStart: this.rangeService.onDragStart.bind(this.rangeService),
        onDragStop: this.rangeService.onDragStop.bind(this.rangeService),
        onDragging: this.rangeService.onDragging.bind(this.rangeService)
      };
      this.dragService.addDragSource(params);
      this.addDestroyFunc(function() {
        return _this.dragService.removeDragSource(params);
      });
    };
    __decorate$1H([
      Optional("rangeService")
    ], DragListenerFeature2.prototype, "rangeService", void 0);
    __decorate$1H([
      Autowired("dragService")
    ], DragListenerFeature2.prototype, "dragService", void 0);
    __decorate$1H([
      PostConstruct
    ], DragListenerFeature2.prototype, "postConstruct", null);
    return DragListenerFeature2;
  }(BeanStub)
);
var __extends$1K = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1G = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var CenterWidthFeature = (
  /** @class */
  function(_super) {
    __extends$1K(CenterWidthFeature2, _super);
    function CenterWidthFeature2(callback2, addSpacer) {
      if (addSpacer === void 0) {
        addSpacer = false;
      }
      var _this = _super.call(this) || this;
      _this.callback = callback2;
      _this.addSpacer = addSpacer;
      return _this;
    }
    CenterWidthFeature2.prototype.postConstruct = function() {
      var listener = this.setWidth.bind(this);
      this.addManagedPropertyListener("domLayout", listener);
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, listener);
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, listener);
      this.addManagedListener(this.eventService, Events.EVENT_LEFT_PINNED_WIDTH_CHANGED, listener);
      if (this.addSpacer) {
        this.addManagedListener(this.eventService, Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED, listener);
        this.addManagedListener(this.eventService, Events.EVENT_SCROLL_VISIBILITY_CHANGED, listener);
        this.addManagedListener(this.eventService, Events.EVENT_SCROLLBAR_WIDTH_CHANGED, listener);
      }
      this.setWidth();
    };
    CenterWidthFeature2.prototype.setWidth = function() {
      var columnModel = this.columnModel;
      var printLayout = this.gridOptionsService.isDomLayout("print");
      var centerWidth = columnModel.getBodyContainerWidth();
      var leftWidth = columnModel.getDisplayedColumnsLeftWidth();
      var rightWidth = columnModel.getDisplayedColumnsRightWidth();
      var totalWidth;
      if (printLayout) {
        totalWidth = centerWidth + leftWidth + rightWidth;
      } else {
        totalWidth = centerWidth;
        if (this.addSpacer) {
          var relevantWidth = this.gridOptionsService.is("enableRtl") ? leftWidth : rightWidth;
          if (relevantWidth === 0 && this.scrollVisibleService.isVerticalScrollShowing()) {
            totalWidth += this.gridOptionsService.getScrollbarWidth();
          }
        }
      }
      this.callback(totalWidth);
    };
    __decorate$1G([
      Autowired("columnModel")
    ], CenterWidthFeature2.prototype, "columnModel", void 0);
    __decorate$1G([
      Autowired("scrollVisibleService")
    ], CenterWidthFeature2.prototype, "scrollVisibleService", void 0);
    __decorate$1G([
      PostConstruct
    ], CenterWidthFeature2.prototype, "postConstruct", null);
    return CenterWidthFeature2;
  }(BeanStub)
);
var __extends$1J = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1F = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$j = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$g = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var RowContainerName;
(function(RowContainerName2) {
  RowContainerName2["LEFT"] = "left";
  RowContainerName2["RIGHT"] = "right";
  RowContainerName2["CENTER"] = "center";
  RowContainerName2["FULL_WIDTH"] = "fullWidth";
  RowContainerName2["TOP_LEFT"] = "topLeft";
  RowContainerName2["TOP_RIGHT"] = "topRight";
  RowContainerName2["TOP_CENTER"] = "topCenter";
  RowContainerName2["TOP_FULL_WIDTH"] = "topFullWidth";
  RowContainerName2["STICKY_TOP_LEFT"] = "stickyTopLeft";
  RowContainerName2["STICKY_TOP_RIGHT"] = "stickyTopRight";
  RowContainerName2["STICKY_TOP_CENTER"] = "stickyTopCenter";
  RowContainerName2["STICKY_TOP_FULL_WIDTH"] = "stickyTopFullWidth";
  RowContainerName2["BOTTOM_LEFT"] = "bottomLeft";
  RowContainerName2["BOTTOM_RIGHT"] = "bottomRight";
  RowContainerName2["BOTTOM_CENTER"] = "bottomCenter";
  RowContainerName2["BOTTOM_FULL_WIDTH"] = "bottomFullWidth";
})(RowContainerName || (RowContainerName = {}));
var RowContainerType;
(function(RowContainerType2) {
  RowContainerType2["LEFT"] = "left";
  RowContainerType2["RIGHT"] = "right";
  RowContainerType2["CENTER"] = "center";
  RowContainerType2["FULL_WIDTH"] = "fullWidth";
})(RowContainerType || (RowContainerType = {}));
function getRowContainerTypeForName(name) {
  switch (name) {
    case RowContainerName.CENTER:
    case RowContainerName.TOP_CENTER:
    case RowContainerName.STICKY_TOP_CENTER:
    case RowContainerName.BOTTOM_CENTER:
      return RowContainerType.CENTER;
    case RowContainerName.LEFT:
    case RowContainerName.TOP_LEFT:
    case RowContainerName.STICKY_TOP_LEFT:
    case RowContainerName.BOTTOM_LEFT:
      return RowContainerType.LEFT;
    case RowContainerName.RIGHT:
    case RowContainerName.TOP_RIGHT:
    case RowContainerName.STICKY_TOP_RIGHT:
    case RowContainerName.BOTTOM_RIGHT:
      return RowContainerType.RIGHT;
    case RowContainerName.FULL_WIDTH:
    case RowContainerName.TOP_FULL_WIDTH:
    case RowContainerName.STICKY_TOP_FULL_WIDTH:
    case RowContainerName.BOTTOM_FULL_WIDTH:
      return RowContainerType.FULL_WIDTH;
    default:
      throw Error("Invalid Row Container Type");
  }
}
var ContainerCssClasses = convertToMap([
  [RowContainerName.CENTER, "ag-center-cols-container"],
  [RowContainerName.LEFT, "ag-pinned-left-cols-container"],
  [RowContainerName.RIGHT, "ag-pinned-right-cols-container"],
  [RowContainerName.FULL_WIDTH, "ag-full-width-container"],
  [RowContainerName.TOP_CENTER, "ag-floating-top-container"],
  [RowContainerName.TOP_LEFT, "ag-pinned-left-floating-top"],
  [RowContainerName.TOP_RIGHT, "ag-pinned-right-floating-top"],
  [RowContainerName.TOP_FULL_WIDTH, "ag-floating-top-full-width-container"],
  [RowContainerName.STICKY_TOP_CENTER, "ag-sticky-top-container"],
  [RowContainerName.STICKY_TOP_LEFT, "ag-pinned-left-sticky-top"],
  [RowContainerName.STICKY_TOP_RIGHT, "ag-pinned-right-sticky-top"],
  [RowContainerName.STICKY_TOP_FULL_WIDTH, "ag-sticky-top-full-width-container"],
  [RowContainerName.BOTTOM_CENTER, "ag-floating-bottom-container"],
  [RowContainerName.BOTTOM_LEFT, "ag-pinned-left-floating-bottom"],
  [RowContainerName.BOTTOM_RIGHT, "ag-pinned-right-floating-bottom"],
  [RowContainerName.BOTTOM_FULL_WIDTH, "ag-floating-bottom-full-width-container"]
]);
var ViewportCssClasses = convertToMap([
  [RowContainerName.CENTER, "ag-center-cols-viewport"],
  [RowContainerName.TOP_CENTER, "ag-floating-top-viewport"],
  [RowContainerName.STICKY_TOP_CENTER, "ag-sticky-top-viewport"],
  [RowContainerName.BOTTOM_CENTER, "ag-floating-bottom-viewport"]
]);
var WrapperCssClasses = convertToMap([
  [RowContainerName.CENTER, "ag-center-cols-clipper"]
]);
var RowContainerCtrl = (
  /** @class */
  function(_super) {
    __extends$1J(RowContainerCtrl2, _super);
    function RowContainerCtrl2(name) {
      var _this = _super.call(this) || this;
      _this.visible = true;
      _this.EMPTY_CTRLS = [];
      _this.name = name;
      _this.isFullWithContainer = _this.name === RowContainerName.TOP_FULL_WIDTH || _this.name === RowContainerName.STICKY_TOP_FULL_WIDTH || _this.name === RowContainerName.BOTTOM_FULL_WIDTH || _this.name === RowContainerName.FULL_WIDTH;
      return _this;
    }
    RowContainerCtrl2.getRowContainerCssClasses = function(name) {
      var containerClass = ContainerCssClasses.get(name);
      var viewportClass = ViewportCssClasses.get(name);
      var wrapperClass = WrapperCssClasses.get(name);
      return { container: containerClass, viewport: viewportClass, wrapper: wrapperClass };
    };
    RowContainerCtrl2.getPinned = function(name) {
      switch (name) {
        case RowContainerName.BOTTOM_LEFT:
        case RowContainerName.TOP_LEFT:
        case RowContainerName.STICKY_TOP_LEFT:
        case RowContainerName.LEFT:
          return "left";
        case RowContainerName.BOTTOM_RIGHT:
        case RowContainerName.TOP_RIGHT:
        case RowContainerName.STICKY_TOP_RIGHT:
        case RowContainerName.RIGHT:
          return "right";
        default:
          return null;
      }
    };
    RowContainerCtrl2.prototype.postConstruct = function() {
      var _this = this;
      this.enableRtl = this.gridOptionsService.is("enableRtl");
      this.embedFullWidthRows = this.gridOptionsService.is("embedFullWidthRows");
      this.forContainers([RowContainerName.CENTER], function() {
        return _this.viewportSizeFeature = _this.createManagedBean(new ViewportSizeFeature(_this));
      });
    };
    RowContainerCtrl2.prototype.registerWithCtrlsService = function() {
      switch (this.name) {
        case RowContainerName.CENTER:
          this.ctrlsService.registerCenterRowContainerCtrl(this);
          break;
        case RowContainerName.LEFT:
          this.ctrlsService.registerLeftRowContainerCtrl(this);
          break;
        case RowContainerName.RIGHT:
          this.ctrlsService.registerRightRowContainerCtrl(this);
          break;
        case RowContainerName.TOP_CENTER:
          this.ctrlsService.registerTopCenterRowContainerCtrl(this);
          break;
        case RowContainerName.TOP_LEFT:
          this.ctrlsService.registerTopLeftRowContainerCon(this);
          break;
        case RowContainerName.TOP_RIGHT:
          this.ctrlsService.registerTopRightRowContainerCtrl(this);
          break;
        case RowContainerName.STICKY_TOP_CENTER:
          this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);
          break;
        case RowContainerName.STICKY_TOP_LEFT:
          this.ctrlsService.registerStickyTopLeftRowContainerCon(this);
          break;
        case RowContainerName.STICKY_TOP_RIGHT:
          this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);
          break;
        case RowContainerName.BOTTOM_CENTER:
          this.ctrlsService.registerBottomCenterRowContainerCtrl(this);
          break;
        case RowContainerName.BOTTOM_LEFT:
          this.ctrlsService.registerBottomLeftRowContainerCtrl(this);
          break;
        case RowContainerName.BOTTOM_RIGHT:
          this.ctrlsService.registerBottomRightRowContainerCtrl(this);
          break;
      }
    };
    RowContainerCtrl2.prototype.forContainers = function(names2, callback2) {
      if (names2.indexOf(this.name) >= 0) {
        callback2();
      }
    };
    RowContainerCtrl2.prototype.getContainerElement = function() {
      return this.eContainer;
    };
    RowContainerCtrl2.prototype.getViewportSizeFeature = function() {
      return this.viewportSizeFeature;
    };
    RowContainerCtrl2.prototype.setComp = function(view, eContainer, eViewport, eWrapper) {
      var _this = this;
      this.comp = view;
      this.eContainer = eContainer;
      this.eViewport = eViewport;
      this.eWrapper = eWrapper;
      this.createManagedBean(new RowContainerEventsFeature(this.eContainer));
      this.addPreventScrollWhileDragging();
      this.listenOnDomOrder();
      this.stopHScrollOnPinnedRows();
      var allTopNoFW = [RowContainerName.TOP_CENTER, RowContainerName.TOP_LEFT, RowContainerName.TOP_RIGHT];
      var allStickyTopNoFW = [RowContainerName.STICKY_TOP_CENTER, RowContainerName.STICKY_TOP_LEFT, RowContainerName.STICKY_TOP_RIGHT];
      var allBottomNoFW = [RowContainerName.BOTTOM_CENTER, RowContainerName.BOTTOM_LEFT, RowContainerName.BOTTOM_RIGHT];
      var allMiddleNoFW = [RowContainerName.CENTER, RowContainerName.LEFT, RowContainerName.RIGHT];
      var allNoFW = __spreadArray$g(__spreadArray$g(__spreadArray$g(__spreadArray$g([], __read$j(allTopNoFW)), __read$j(allBottomNoFW)), __read$j(allMiddleNoFW)), __read$j(allStickyTopNoFW));
      var allMiddle = [RowContainerName.CENTER, RowContainerName.LEFT, RowContainerName.RIGHT, RowContainerName.FULL_WIDTH];
      var allCenter = [RowContainerName.CENTER, RowContainerName.TOP_CENTER, RowContainerName.STICKY_TOP_CENTER, RowContainerName.BOTTOM_CENTER];
      var allLeft = [RowContainerName.LEFT, RowContainerName.BOTTOM_LEFT, RowContainerName.TOP_LEFT, RowContainerName.STICKY_TOP_LEFT];
      var allRight = [RowContainerName.RIGHT, RowContainerName.BOTTOM_RIGHT, RowContainerName.TOP_RIGHT, RowContainerName.STICKY_TOP_RIGHT];
      this.forContainers(allLeft, function() {
        _this.pinnedWidthFeature = _this.createManagedBean(new SetPinnedLeftWidthFeature(_this.eContainer));
        _this.addManagedListener(_this.eventService, Events.EVENT_LEFT_PINNED_WIDTH_CHANGED, function() {
          return _this.onPinnedWidthChanged();
        });
      });
      this.forContainers(allRight, function() {
        _this.pinnedWidthFeature = _this.createManagedBean(new SetPinnedRightWidthFeature(_this.eContainer));
        _this.addManagedListener(_this.eventService, Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED, function() {
          return _this.onPinnedWidthChanged();
        });
      });
      this.forContainers(allMiddle, function() {
        return _this.createManagedBean(new SetHeightFeature(_this.eContainer, _this.eWrapper));
      });
      this.forContainers(allNoFW, function() {
        return _this.createManagedBean(new DragListenerFeature(_this.eContainer));
      });
      this.forContainers(allCenter, function() {
        return _this.createManagedBean(new CenterWidthFeature(function(width) {
          return _this.comp.setContainerWidth(width + "px");
        }));
      });
      if (isInvisibleScrollbar()) {
        this.forContainers([RowContainerName.CENTER], function() {
          var pinnedWidthChangedEvent = _this.enableRtl ? Events.EVENT_LEFT_PINNED_WIDTH_CHANGED : Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED;
          _this.addManagedListener(_this.eventService, pinnedWidthChangedEvent, function() {
            return _this.refreshPaddingForFakeScrollbar();
          });
        });
        this.refreshPaddingForFakeScrollbar();
      }
      this.addListeners();
      this.registerWithCtrlsService();
    };
    RowContainerCtrl2.prototype.refreshPaddingForFakeScrollbar = function() {
      var _a2 = this, enableRtl = _a2.enableRtl, columnModel = _a2.columnModel, name = _a2.name, eWrapper = _a2.eWrapper, eContainer = _a2.eContainer;
      var sideToCheck = enableRtl ? RowContainerName.LEFT : RowContainerName.RIGHT;
      this.forContainers([RowContainerName.CENTER, sideToCheck], function() {
        var pinnedWidth = columnModel.getContainerWidth(sideToCheck);
        var marginSide = enableRtl ? "marginLeft" : "marginRight";
        if (name === RowContainerName.CENTER) {
          eWrapper.style[marginSide] = pinnedWidth ? "0px" : "16px";
        } else {
          eContainer.style[marginSide] = pinnedWidth ? "16px" : "0px";
        }
      });
    };
    RowContainerCtrl2.prototype.addListeners = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_SCROLL_VISIBILITY_CHANGED, function() {
        return _this.onScrollVisibilityChanged();
      });
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, function() {
        return _this.onDisplayedColumnsChanged();
      });
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, function() {
        return _this.onDisplayedColumnsWidthChanged();
      });
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_ROWS_CHANGED, function(params) {
        return _this.onDisplayedRowsChanged(params.afterScroll);
      });
      this.onScrollVisibilityChanged();
      this.onDisplayedColumnsChanged();
      this.onDisplayedColumnsWidthChanged();
      this.onDisplayedRowsChanged();
    };
    RowContainerCtrl2.prototype.listenOnDomOrder = function() {
      var _this = this;
      var allStickyContainers = [RowContainerName.STICKY_TOP_CENTER, RowContainerName.STICKY_TOP_LEFT, RowContainerName.STICKY_TOP_RIGHT, RowContainerName.STICKY_TOP_FULL_WIDTH];
      var isStickContainer = allStickyContainers.indexOf(this.name) >= 0;
      if (isStickContainer) {
        this.comp.setDomOrder(true);
        return;
      }
      var listener = function() {
        var isEnsureDomOrder = _this.gridOptionsService.is("ensureDomOrder");
        var isPrintLayout = _this.gridOptionsService.isDomLayout("print");
        _this.comp.setDomOrder(isEnsureDomOrder || isPrintLayout);
      };
      this.addManagedPropertyListener("domLayout", listener);
      listener();
    };
    RowContainerCtrl2.prototype.stopHScrollOnPinnedRows = function() {
      var _this = this;
      this.forContainers([RowContainerName.TOP_CENTER, RowContainerName.STICKY_TOP_CENTER, RowContainerName.BOTTOM_CENTER], function() {
        var resetScrollLeft = function() {
          return _this.eViewport.scrollLeft = 0;
        };
        _this.addManagedListener(_this.eViewport, "scroll", resetScrollLeft);
      });
    };
    RowContainerCtrl2.prototype.onDisplayedColumnsChanged = function() {
      var _this = this;
      this.forContainers([RowContainerName.CENTER], function() {
        return _this.onHorizontalViewportChanged();
      });
    };
    RowContainerCtrl2.prototype.onDisplayedColumnsWidthChanged = function() {
      var _this = this;
      this.forContainers([RowContainerName.CENTER], function() {
        return _this.onHorizontalViewportChanged();
      });
    };
    RowContainerCtrl2.prototype.onScrollVisibilityChanged = function() {
      var _this = this;
      var scrollWidth = this.gridOptionsService.getScrollbarWidth() || 0;
      if (this.name === RowContainerName.CENTER) {
        var visible = this.scrollVisibleService.isHorizontalScrollShowing();
        var scrollbarWidth = visible ? scrollWidth : 0;
        var size_1 = scrollbarWidth == 0 ? "100%" : "calc(100% + " + scrollbarWidth + "px)";
        this.animationFrameService.requestAnimationFrame(function() {
          return _this.comp.setViewportHeight(size_1);
        });
      }
      if (this.name === RowContainerName.FULL_WIDTH) {
        var pad = isInvisibleScrollbar() ? 16 : 0;
        var size = "calc(100% - " + pad + "px)";
        this.eContainer.style.setProperty("width", size);
      }
    };
    RowContainerCtrl2.prototype.addPreventScrollWhileDragging = function() {
      var _this = this;
      var preventScroll = function(e) {
        if (_this.dragService.isDragging()) {
          if (e.cancelable) {
            e.preventDefault();
          }
        }
      };
      this.eContainer.addEventListener("touchmove", preventScroll, { passive: false });
      this.addDestroyFunc(function() {
        return _this.eContainer.removeEventListener("touchmove", preventScroll);
      });
    };
    RowContainerCtrl2.prototype.onHorizontalViewportChanged = function() {
      var scrollWidth = this.getCenterWidth();
      var scrollPosition = this.getCenterViewportScrollLeft();
      this.columnModel.setViewportPosition(scrollWidth, scrollPosition);
    };
    RowContainerCtrl2.prototype.getCenterWidth = function() {
      return getInnerWidth(this.eViewport);
    };
    RowContainerCtrl2.prototype.getCenterViewportScrollLeft = function() {
      return getScrollLeft(this.eViewport, this.enableRtl);
    };
    RowContainerCtrl2.prototype.registerViewportResizeListener = function(listener) {
      var unsubscribeFromResize = this.resizeObserverService.observeResize(this.eViewport, listener);
      this.addDestroyFunc(function() {
        return unsubscribeFromResize();
      });
    };
    RowContainerCtrl2.prototype.isViewportVisible = function() {
      return isVisible(this.eViewport);
    };
    RowContainerCtrl2.prototype.getViewportScrollLeft = function() {
      return getScrollLeft(this.eViewport, this.enableRtl);
    };
    RowContainerCtrl2.prototype.isHorizontalScrollShowing = function() {
      var isAlwaysShowHorizontalScroll = this.gridOptionsService.is("alwaysShowHorizontalScroll");
      return isAlwaysShowHorizontalScroll || isHorizontalScrollShowing(this.eViewport);
    };
    RowContainerCtrl2.prototype.getViewportElement = function() {
      return this.eViewport;
    };
    RowContainerCtrl2.prototype.setContainerTranslateX = function(amount) {
      this.eContainer.style.transform = "translateX(" + amount + "px)";
    };
    RowContainerCtrl2.prototype.getHScrollPosition = function() {
      var res = {
        left: this.eViewport.scrollLeft,
        right: this.eViewport.scrollLeft + this.eViewport.offsetWidth
      };
      return res;
    };
    RowContainerCtrl2.prototype.setCenterViewportScrollLeft = function(value) {
      setScrollLeft(this.eViewport, value, this.enableRtl);
    };
    RowContainerCtrl2.prototype.isContainerVisible = function() {
      var pinned = RowContainerCtrl2.getPinned(this.name);
      return !pinned || !!this.pinnedWidthFeature && this.pinnedWidthFeature.getWidth() > 0;
    };
    RowContainerCtrl2.prototype.onPinnedWidthChanged = function() {
      var visible = this.isContainerVisible();
      if (this.visible != visible) {
        this.visible = visible;
        this.onDisplayedRowsChanged();
      }
      if (isInvisibleScrollbar()) {
        this.refreshPaddingForFakeScrollbar();
      }
    };
    RowContainerCtrl2.prototype.onDisplayedRowsChanged = function(useFlushSync) {
      var _this = this;
      if (useFlushSync === void 0) {
        useFlushSync = false;
      }
      if (this.visible) {
        var printLayout_1 = this.gridOptionsService.isDomLayout("print");
        var doesRowMatch = function(rowCtrl) {
          var fullWidthRow = rowCtrl.isFullWidth();
          var embedFW = _this.embedFullWidthRows || printLayout_1;
          var match = _this.isFullWithContainer ? !embedFW && fullWidthRow : embedFW || !fullWidthRow;
          return match;
        };
        var rowsThisContainer = this.getRowCtrls().filter(doesRowMatch);
        this.comp.setRowCtrls(rowsThisContainer, useFlushSync);
      } else {
        this.comp.setRowCtrls(this.EMPTY_CTRLS, false);
      }
    };
    RowContainerCtrl2.prototype.getRowCtrls = function() {
      switch (this.name) {
        case RowContainerName.TOP_CENTER:
        case RowContainerName.TOP_LEFT:
        case RowContainerName.TOP_RIGHT:
        case RowContainerName.TOP_FULL_WIDTH:
          return this.rowRenderer.getTopRowCtrls();
        case RowContainerName.STICKY_TOP_CENTER:
        case RowContainerName.STICKY_TOP_LEFT:
        case RowContainerName.STICKY_TOP_RIGHT:
        case RowContainerName.STICKY_TOP_FULL_WIDTH:
          return this.rowRenderer.getStickyTopRowCtrls();
        case RowContainerName.BOTTOM_CENTER:
        case RowContainerName.BOTTOM_LEFT:
        case RowContainerName.BOTTOM_RIGHT:
        case RowContainerName.BOTTOM_FULL_WIDTH:
          return this.rowRenderer.getBottomRowCtrls();
        default:
          return this.rowRenderer.getRowCtrls();
      }
    };
    __decorate$1F([
      Autowired("scrollVisibleService")
    ], RowContainerCtrl2.prototype, "scrollVisibleService", void 0);
    __decorate$1F([
      Autowired("dragService")
    ], RowContainerCtrl2.prototype, "dragService", void 0);
    __decorate$1F([
      Autowired("ctrlsService")
    ], RowContainerCtrl2.prototype, "ctrlsService", void 0);
    __decorate$1F([
      Autowired("columnModel")
    ], RowContainerCtrl2.prototype, "columnModel", void 0);
    __decorate$1F([
      Autowired("resizeObserverService")
    ], RowContainerCtrl2.prototype, "resizeObserverService", void 0);
    __decorate$1F([
      Autowired("animationFrameService")
    ], RowContainerCtrl2.prototype, "animationFrameService", void 0);
    __decorate$1F([
      Autowired("rowRenderer")
    ], RowContainerCtrl2.prototype, "rowRenderer", void 0);
    __decorate$1F([
      PostConstruct
    ], RowContainerCtrl2.prototype, "postConstruct", null);
    return RowContainerCtrl2;
  }(BeanStub)
);
var __extends$1I = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1E = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GRID_BODY_TEMPLATE = (
  /* html */
  '<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="' + RowContainerName.TOP_LEFT + '"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="' + RowContainerName.TOP_CENTER + '"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="' + RowContainerName.TOP_RIGHT + '"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="' + RowContainerName.TOP_FULL_WIDTH + '"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-clipper" ref="eBodyClipper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <ag-row-container ref="leftContainer" name="' + RowContainerName.LEFT + '"></ag-row-container>\n                    <ag-row-container ref="centerContainer" name="' + RowContainerName.CENTER + '"></ag-row-container>\n                    <ag-row-container ref="rightContainer" name="' + RowContainerName.RIGHT + '"></ag-row-container>\n                    <ag-row-container ref="fullWidthContainer" name="' + RowContainerName.FULL_WIDTH + '"></ag-row-container>\n                </div>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="' + RowContainerName.STICKY_TOP_LEFT + '"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="' + RowContainerName.STICKY_TOP_CENTER + '"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="' + RowContainerName.STICKY_TOP_RIGHT + '"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="' + RowContainerName.STICKY_TOP_FULL_WIDTH + '"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="' + RowContainerName.BOTTOM_LEFT + '"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="' + RowContainerName.BOTTOM_CENTER + '"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="' + RowContainerName.BOTTOM_RIGHT + '"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="' + RowContainerName.BOTTOM_FULL_WIDTH + '"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>'
);
var GridBodyComp$1 = (
  /** @class */
  function(_super) {
    __extends$1I(GridBodyComp2, _super);
    function GridBodyComp2() {
      return _super.call(this, GRID_BODY_TEMPLATE) || this;
    }
    GridBodyComp2.prototype.init = function() {
      var _this = this;
      var setHeight = function(height, element) {
        var heightString = height + "px";
        element.style.minHeight = heightString;
        element.style.height = heightString;
      };
      var compProxy = {
        setRowAnimationCssOnBodyViewport: function(cssClass, animate) {
          return _this.setRowAnimationCssOnBodyViewport(cssClass, animate);
        },
        setColumnCount: function(count) {
          return setAriaColCount(_this.getGui(), count);
        },
        setRowCount: function(count) {
          return setAriaRowCount(_this.getGui(), count);
        },
        setTopHeight: function(height) {
          return setHeight(height, _this.eTop);
        },
        setBottomHeight: function(height) {
          return setHeight(height, _this.eBottom);
        },
        setTopDisplay: function(display) {
          return _this.eTop.style.display = display;
        },
        setBottomDisplay: function(display) {
          return _this.eBottom.style.display = display;
        },
        setStickyTopHeight: function(height) {
          return _this.eStickyTop.style.height = height;
        },
        setStickyTopTop: function(top) {
          return _this.eStickyTop.style.top = top;
        },
        setStickyTopWidth: function(width) {
          return _this.eStickyTop.style.width = width;
        },
        setColumnMovingCss: function(cssClass, flag) {
          return _this.addOrRemoveCssClass(cssClass, flag);
        },
        updateLayoutClasses: function(cssClass, params) {
          var classLists = [
            _this.eBodyViewport.classList,
            _this.eBodyClipper.classList,
            _this.eBody.classList
          ];
          classLists.forEach(function(classList) {
            classList.toggle(LayoutCssClasses.AUTO_HEIGHT, params.autoHeight);
            classList.toggle(LayoutCssClasses.NORMAL, params.normal);
            classList.toggle(LayoutCssClasses.PRINT, params.print);
          });
          _this.addOrRemoveCssClass(LayoutCssClasses.AUTO_HEIGHT, params.autoHeight);
          _this.addOrRemoveCssClass(LayoutCssClasses.NORMAL, params.normal);
          _this.addOrRemoveCssClass(LayoutCssClasses.PRINT, params.print);
        },
        setAlwaysVerticalScrollClass: function(cssClass, on) {
          return _this.eBodyViewport.classList.toggle(CSS_CLASS_FORCE_VERTICAL_SCROLL, on);
        },
        registerBodyViewportResizeListener: function(listener) {
          var unsubscribeFromResize = _this.resizeObserverService.observeResize(_this.eBodyViewport, listener);
          _this.addDestroyFunc(function() {
            return unsubscribeFromResize();
          });
        },
        setPinnedTopBottomOverflowY: function(overflow) {
          return _this.eTop.style.overflowY = _this.eBottom.style.overflowY = overflow;
        },
        setCellSelectableCss: function(cssClass, selectable) {
          [_this.eTop, _this.eBodyViewport, _this.eBottom].forEach(function(ct) {
            return ct.classList.toggle(cssClass, selectable);
          });
        },
        setBodyViewportWidth: function(width) {
          return _this.eBodyViewport.style.width = width;
        }
      };
      this.ctrl = this.createManagedBean(new GridBodyCtrl());
      this.ctrl.setComp(compProxy, this.getGui(), this.eBodyViewport, this.eTop, this.eBottom, this.eStickyTop);
      if (this.rangeService || this.gridOptionsService.get("rowSelection") === "multiple") {
        setAriaMultiSelectable(this.getGui(), true);
      }
    };
    GridBodyComp2.prototype.setRowAnimationCssOnBodyViewport = function(cssClass, animateRows) {
      var bodyViewportClassList = this.eBodyViewport.classList;
      bodyViewportClassList.toggle(RowAnimationCssClasses.ANIMATION_ON, animateRows);
      bodyViewportClassList.toggle(RowAnimationCssClasses.ANIMATION_OFF, !animateRows);
    };
    GridBodyComp2.prototype.getFloatingTopBottom = function() {
      return [this.eTop, this.eBottom];
    };
    __decorate$1E([
      Autowired("resizeObserverService")
    ], GridBodyComp2.prototype, "resizeObserverService", void 0);
    __decorate$1E([
      Optional("rangeService")
    ], GridBodyComp2.prototype, "rangeService", void 0);
    __decorate$1E([
      RefSelector("eBodyViewport")
    ], GridBodyComp2.prototype, "eBodyViewport", void 0);
    __decorate$1E([
      RefSelector("eStickyTop")
    ], GridBodyComp2.prototype, "eStickyTop", void 0);
    __decorate$1E([
      RefSelector("eTop")
    ], GridBodyComp2.prototype, "eTop", void 0);
    __decorate$1E([
      RefSelector("eBottom")
    ], GridBodyComp2.prototype, "eBottom", void 0);
    __decorate$1E([
      RefSelector("gridHeader")
    ], GridBodyComp2.prototype, "headerRootComp", void 0);
    __decorate$1E([
      RefSelector("eBodyClipper")
    ], GridBodyComp2.prototype, "eBodyClipper", void 0);
    __decorate$1E([
      RefSelector("eBody")
    ], GridBodyComp2.prototype, "eBody", void 0);
    __decorate$1E([
      PostConstruct
    ], GridBodyComp2.prototype, "init", null);
    return GridBodyComp2;
  }(Component)
);
var __extends$1H = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1D = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ScrollVisibleService = (
  /** @class */
  function(_super) {
    __extends$1H(ScrollVisibleService2, _super);
    function ScrollVisibleService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ScrollVisibleService2.prototype.postConstruct = function() {
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.onDisplayedColumnsChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, this.onDisplayedColumnsWidthChanged.bind(this));
    };
    ScrollVisibleService2.prototype.onDisplayedColumnsChanged = function() {
      this.update();
    };
    ScrollVisibleService2.prototype.onDisplayedColumnsWidthChanged = function() {
      this.update();
    };
    ScrollVisibleService2.prototype.update = function() {
      this.updateImpl();
      setTimeout(this.updateImpl.bind(this), 500);
    };
    ScrollVisibleService2.prototype.updateImpl = function() {
      var centerRowCtrl = this.ctrlsService.getCenterRowContainerCtrl();
      if (!centerRowCtrl) {
        return;
      }
      var params = {
        horizontalScrollShowing: centerRowCtrl.isHorizontalScrollShowing(),
        verticalScrollShowing: this.isVerticalScrollShowing()
      };
      this.setScrollsVisible(params);
    };
    ScrollVisibleService2.prototype.setScrollsVisible = function(params) {
      var atLeastOneDifferent = this.horizontalScrollShowing !== params.horizontalScrollShowing || this.verticalScrollShowing !== params.verticalScrollShowing;
      if (atLeastOneDifferent) {
        this.horizontalScrollShowing = params.horizontalScrollShowing;
        this.verticalScrollShowing = params.verticalScrollShowing;
        var event_1 = {
          type: Events.EVENT_SCROLL_VISIBILITY_CHANGED
        };
        this.eventService.dispatchEvent(event_1);
      }
    };
    ScrollVisibleService2.prototype.isHorizontalScrollShowing = function() {
      return this.horizontalScrollShowing;
    };
    ScrollVisibleService2.prototype.isVerticalScrollShowing = function() {
      return this.verticalScrollShowing;
    };
    __decorate$1D([
      Autowired("ctrlsService")
    ], ScrollVisibleService2.prototype, "ctrlsService", void 0);
    __decorate$1D([
      PostConstruct
    ], ScrollVisibleService2.prototype, "postConstruct", null);
    ScrollVisibleService2 = __decorate$1D([
      Bean("scrollVisibleService")
    ], ScrollVisibleService2);
    return ScrollVisibleService2;
  }(BeanStub)
);
var __extends$1G = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1C = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var MouseEventService = (
  /** @class */
  function(_super) {
    __extends$1G(MouseEventService2, _super);
    function MouseEventService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.gridInstanceId = MouseEventService_1.gridInstanceSequence.next();
      return _this;
    }
    MouseEventService_1 = MouseEventService2;
    MouseEventService2.prototype.stampTopLevelGridCompWithGridInstance = function(eGridDiv) {
      eGridDiv[MouseEventService_1.GRID_DOM_KEY] = this.gridInstanceId;
    };
    MouseEventService2.prototype.getRenderedCellForEvent = function(event) {
      return getCtrlForEventTarget(this.gridOptionsService, event.target, CellCtrl.DOM_DATA_KEY_CELL_CTRL);
    };
    MouseEventService2.prototype.isEventFromThisGrid = function(event) {
      var res = this.isElementInThisGrid(event.target);
      return res;
    };
    MouseEventService2.prototype.isElementInThisGrid = function(element) {
      var pointer = element;
      while (pointer) {
        var instanceId = pointer[MouseEventService_1.GRID_DOM_KEY];
        if (exists(instanceId)) {
          var eventFromThisGrid = instanceId === this.gridInstanceId;
          return eventFromThisGrid;
        }
        pointer = pointer.parentElement;
      }
      return false;
    };
    MouseEventService2.prototype.getCellPositionForEvent = function(event) {
      var cellComp2 = this.getRenderedCellForEvent(event);
      return cellComp2 ? cellComp2.getCellPosition() : null;
    };
    MouseEventService2.prototype.getNormalisedPosition = function(event) {
      var gridPanelHasScrolls = this.gridOptionsService.isDomLayout("normal");
      var e = event;
      var x2;
      var y2;
      if (e.clientX != null || e.clientY != null) {
        x2 = e.clientX;
        y2 = e.clientY;
      } else {
        x2 = e.x;
        y2 = e.y;
      }
      if (gridPanelHasScrolls) {
        var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
        var vRange = gridBodyCon.getScrollFeature().getVScrollPosition();
        var hRange = gridBodyCon.getScrollFeature().getHScrollPosition();
        x2 += hRange.left;
        y2 += vRange.top;
      }
      return { x: x2, y: y2 };
    };
    var MouseEventService_1;
    MouseEventService2.gridInstanceSequence = new NumberSequence();
    MouseEventService2.GRID_DOM_KEY = "__ag_grid_instance";
    __decorate$1C([
      Autowired("ctrlsService")
    ], MouseEventService2.prototype, "ctrlsService", void 0);
    MouseEventService2 = MouseEventService_1 = __decorate$1C([
      Bean("mouseEventService")
    ], MouseEventService2);
    return MouseEventService2;
  }(BeanStub)
);
var __extends$1F = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$8$1 = function() {
  __assign$8$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$8$1.apply(this, arguments);
};
var __decorate$1B = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var NavigationService = (
  /** @class */
  function(_super) {
    __extends$1F(NavigationService2, _super);
    function NavigationService2() {
      var _this = _super.call(this) || this;
      _this.onPageDown = throttle(_this.onPageDown, 100);
      _this.onPageUp = throttle(_this.onPageUp, 100);
      return _this;
    }
    NavigationService2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function(p2) {
        _this.gridBodyCon = p2.gridBodyCtrl;
      });
    };
    NavigationService2.prototype.handlePageScrollingKey = function(event, fromFullWidth) {
      if (fromFullWidth === void 0) {
        fromFullWidth = false;
      }
      var key = event.key;
      var alt = event.altKey;
      var ctrl = event.ctrlKey || event.metaKey;
      var rangeServiceShouldHandleShift = !!this.rangeService && event.shiftKey;
      var currentCell = this.mouseEventService.getCellPositionForEvent(event);
      var processed = false;
      switch (key) {
        case KeyCode.PAGE_HOME:
        case KeyCode.PAGE_END:
          if (!ctrl && !alt) {
            this.onHomeOrEndKey(key);
            processed = true;
          }
          break;
        case KeyCode.LEFT:
        case KeyCode.RIGHT:
        case KeyCode.UP:
        case KeyCode.DOWN:
          if (!currentCell) {
            return false;
          }
          if (ctrl && !alt && !rangeServiceShouldHandleShift) {
            this.onCtrlUpDownLeftRight(key, currentCell);
            processed = true;
          }
          break;
        case KeyCode.PAGE_DOWN:
        case KeyCode.PAGE_UP:
          if (!ctrl && !alt) {
            processed = this.handlePageUpDown(key, currentCell, fromFullWidth);
          }
          break;
      }
      if (processed) {
        event.preventDefault();
      }
      return processed;
    };
    NavigationService2.prototype.handlePageUpDown = function(key, currentCell, fromFullWidth) {
      if (fromFullWidth) {
        currentCell = this.focusService.getFocusedCell();
      }
      if (!currentCell) {
        return false;
      }
      if (key === KeyCode.PAGE_UP) {
        this.onPageUp(currentCell);
      } else {
        this.onPageDown(currentCell);
      }
      return true;
    };
    NavigationService2.prototype.navigateTo = function(navigateParams) {
      var scrollIndex = navigateParams.scrollIndex, scrollType = navigateParams.scrollType, scrollColumn = navigateParams.scrollColumn, focusIndex = navigateParams.focusIndex, focusColumn = navigateParams.focusColumn;
      if (exists(scrollColumn) && !scrollColumn.isPinned()) {
        this.gridBodyCon.getScrollFeature().ensureColumnVisible(scrollColumn);
      }
      if (exists(scrollIndex)) {
        this.gridBodyCon.getScrollFeature().ensureIndexVisible(scrollIndex, scrollType);
      }
      if (!navigateParams.isAsync) {
        this.gridBodyCon.getScrollFeature().ensureIndexVisible(focusIndex);
      }
      this.focusService.setFocusedCell({ rowIndex: focusIndex, column: focusColumn, rowPinned: null, forceBrowserFocus: true });
      if (this.rangeService) {
        var cellPosition = { rowIndex: focusIndex, rowPinned: null, column: focusColumn };
        this.rangeService.setRangeToCell(cellPosition);
      }
    };
    NavigationService2.prototype.onPageDown = function(gridCell) {
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      var scrollPosition = gridBodyCon.getScrollFeature().getVScrollPosition();
      var pixelsInOnePage = this.getViewportHeight();
      var pagingPixelOffset = this.paginationProxy.getPixelOffset();
      var currentPageBottomPixel = scrollPosition.top + pixelsInOnePage;
      var currentPageBottomRow = this.paginationProxy.getRowIndexAtPixel(currentPageBottomPixel + pagingPixelOffset);
      if (this.columnModel.isAutoRowHeightActive()) {
        this.navigateToNextPageWithAutoHeight(gridCell, currentPageBottomRow);
      } else {
        this.navigateToNextPage(gridCell, currentPageBottomRow);
      }
    };
    NavigationService2.prototype.onPageUp = function(gridCell) {
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      var scrollPosition = gridBodyCon.getScrollFeature().getVScrollPosition();
      var pagingPixelOffset = this.paginationProxy.getPixelOffset();
      var currentPageTopPixel = scrollPosition.top;
      var currentPageTopRow = this.paginationProxy.getRowIndexAtPixel(currentPageTopPixel + pagingPixelOffset);
      if (this.columnModel.isAutoRowHeightActive()) {
        this.navigateToNextPageWithAutoHeight(gridCell, currentPageTopRow, true);
      } else {
        this.navigateToNextPage(gridCell, currentPageTopRow, true);
      }
    };
    NavigationService2.prototype.navigateToNextPage = function(gridCell, scrollIndex, up) {
      if (up === void 0) {
        up = false;
      }
      var pixelsInOnePage = this.getViewportHeight();
      var firstRow = this.paginationProxy.getPageFirstRow();
      var lastRow = this.paginationProxy.getPageLastRow();
      var pagingPixelOffset = this.paginationProxy.getPixelOffset();
      var currentRowNode = this.paginationProxy.getRow(gridCell.rowIndex);
      var rowPixelDiff = up ? (currentRowNode === null || currentRowNode === void 0 ? void 0 : currentRowNode.rowHeight) - pixelsInOnePage - pagingPixelOffset : pixelsInOnePage - pagingPixelOffset;
      var nextCellPixel = (currentRowNode === null || currentRowNode === void 0 ? void 0 : currentRowNode.rowTop) + rowPixelDiff;
      var focusIndex = this.paginationProxy.getRowIndexAtPixel(nextCellPixel + pagingPixelOffset);
      if (focusIndex === gridCell.rowIndex) {
        var diff2 = up ? -1 : 1;
        scrollIndex = focusIndex = gridCell.rowIndex + diff2;
      }
      var scrollType;
      if (up) {
        scrollType = "bottom";
        if (focusIndex < firstRow) {
          focusIndex = firstRow;
        }
        if (scrollIndex < firstRow) {
          scrollIndex = firstRow;
        }
      } else {
        scrollType = "top";
        if (focusIndex > lastRow) {
          focusIndex = lastRow;
        }
        if (scrollIndex > lastRow) {
          scrollIndex = lastRow;
        }
      }
      if (this.isRowTallerThanView(focusIndex)) {
        scrollIndex = focusIndex;
        scrollType = "top";
      }
      this.navigateTo({
        scrollIndex,
        scrollType,
        scrollColumn: null,
        focusIndex,
        focusColumn: gridCell.column
      });
    };
    NavigationService2.prototype.navigateToNextPageWithAutoHeight = function(gridCell, scrollIndex, up) {
      var _this = this;
      if (up === void 0) {
        up = false;
      }
      this.navigateTo({
        scrollIndex,
        scrollType: up ? "bottom" : "top",
        scrollColumn: null,
        focusIndex: scrollIndex,
        focusColumn: gridCell.column
      });
      setTimeout(function() {
        var focusIndex = _this.getNextFocusIndexForAutoHeight(gridCell, up);
        _this.navigateTo({
          scrollIndex,
          scrollType: up ? "bottom" : "top",
          scrollColumn: null,
          focusIndex,
          focusColumn: gridCell.column,
          isAsync: true
        });
      }, 50);
    };
    NavigationService2.prototype.getNextFocusIndexForAutoHeight = function(gridCell, up) {
      var _a2;
      if (up === void 0) {
        up = false;
      }
      var step = up ? -1 : 1;
      var pixelsInOnePage = this.getViewportHeight();
      var lastRowIndex = this.paginationProxy.getPageLastRow();
      var pixelSum = 0;
      var currentIndex = gridCell.rowIndex;
      while (currentIndex >= 0 && currentIndex <= lastRowIndex) {
        var currentCell = this.paginationProxy.getRow(currentIndex);
        if (currentCell) {
          var currentCellHeight = (_a2 = currentCell.rowHeight) !== null && _a2 !== void 0 ? _a2 : 0;
          if (pixelSum + currentCellHeight > pixelsInOnePage) {
            break;
          }
          pixelSum += currentCellHeight;
        }
        currentIndex += step;
      }
      return Math.max(0, Math.min(currentIndex, lastRowIndex));
    };
    NavigationService2.prototype.getViewportHeight = function() {
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      var scrollPosition = gridBodyCon.getScrollFeature().getVScrollPosition();
      var scrollbarWidth = this.gridOptionsService.getScrollbarWidth();
      var pixelsInOnePage = scrollPosition.bottom - scrollPosition.top;
      if (this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()) {
        pixelsInOnePage -= scrollbarWidth;
      }
      return pixelsInOnePage;
    };
    NavigationService2.prototype.isRowTallerThanView = function(rowIndex) {
      var rowNode = this.paginationProxy.getRow(rowIndex);
      if (!rowNode) {
        return false;
      }
      var rowHeight = rowNode.rowHeight;
      if (typeof rowHeight !== "number") {
        return false;
      }
      return rowHeight > this.getViewportHeight();
    };
    NavigationService2.prototype.onCtrlUpDownLeftRight = function(key, gridCell) {
      var cellToFocus = this.cellNavigationService.getNextCellToFocus(key, gridCell, true);
      var rowIndex = cellToFocus.rowIndex, column = cellToFocus.column;
      this.navigateTo({
        scrollIndex: rowIndex,
        scrollType: null,
        scrollColumn: column,
        focusIndex: rowIndex,
        focusColumn: column
      });
    };
    NavigationService2.prototype.onHomeOrEndKey = function(key) {
      var homeKey = key === KeyCode.PAGE_HOME;
      var allColumns = this.columnModel.getAllDisplayedColumns();
      var columnToSelect = homeKey ? allColumns[0] : last(allColumns);
      var scrollIndex = homeKey ? this.paginationProxy.getPageFirstRow() : this.paginationProxy.getPageLastRow();
      this.navigateTo({
        scrollIndex,
        scrollType: null,
        scrollColumn: columnToSelect,
        focusIndex: scrollIndex,
        focusColumn: columnToSelect
      });
    };
    NavigationService2.prototype.onTabKeyDown = function(previous, keyboardEvent) {
      var backwards = keyboardEvent.shiftKey;
      var movedToNextCell = this.tabToNextCellCommon(previous, backwards, keyboardEvent);
      if (movedToNextCell) {
        keyboardEvent.preventDefault();
        return;
      }
      if (backwards) {
        var _a2 = previous.getRowPosition(), rowIndex = _a2.rowIndex, rowPinned = _a2.rowPinned;
        var firstRow = rowPinned ? rowIndex === 0 : rowIndex === this.paginationProxy.getPageFirstRow();
        if (firstRow) {
          if (this.gridOptionsService.getNum("headerHeight") === 0) {
            this.focusService.focusNextGridCoreContainer(true, true);
          } else {
            keyboardEvent.preventDefault();
            this.focusService.focusLastHeader(keyboardEvent);
          }
        }
      } else {
        if (previous instanceof CellCtrl) {
          previous.focusCell(true);
        }
        if (this.focusService.focusNextGridCoreContainer(backwards)) {
          keyboardEvent.preventDefault();
        }
      }
    };
    NavigationService2.prototype.tabToNextCell = function(backwards, event) {
      var focusedCell = this.focusService.getFocusedCell();
      if (!focusedCell) {
        return false;
      }
      var cellOrRow = this.getCellByPosition(focusedCell);
      if (!cellOrRow) {
        cellOrRow = this.rowRenderer.getRowByPosition(focusedCell);
        if (!cellOrRow || !cellOrRow.isFullWidth()) {
          return false;
        }
      }
      return this.tabToNextCellCommon(cellOrRow, backwards, event);
    };
    NavigationService2.prototype.tabToNextCellCommon = function(previous, backwards, event) {
      var editing = previous.isEditing();
      if (!editing && previous instanceof CellCtrl) {
        var cell = previous;
        var row = cell.getRowCtrl();
        if (row) {
          editing = row.isEditing();
        }
      }
      var res;
      if (editing) {
        if (this.gridOptionsService.get("editType") === "fullRow") {
          res = this.moveToNextEditingRow(previous, backwards, event);
        } else {
          res = this.moveToNextEditingCell(previous, backwards, event);
        }
      } else {
        res = this.moveToNextCellNotEditing(previous, backwards);
      }
      return res || !!this.focusService.getFocusedHeader();
    };
    NavigationService2.prototype.moveToNextEditingCell = function(previousCell, backwards, event) {
      if (event === void 0) {
        event = null;
      }
      var previousPos = previousCell.getCellPosition();
      previousCell.getGui().focus();
      previousCell.stopEditing();
      var nextCell = this.findNextCellToFocusOn(previousPos, backwards, true);
      if (nextCell == null) {
        return false;
      }
      nextCell.startEditing(null, true, event);
      nextCell.focusCell(false);
      return true;
    };
    NavigationService2.prototype.moveToNextEditingRow = function(previousCell, backwards, event) {
      if (event === void 0) {
        event = null;
      }
      var previousPos = previousCell.getCellPosition();
      var nextCell = this.findNextCellToFocusOn(previousPos, backwards, true);
      if (nextCell == null) {
        return false;
      }
      var nextPos = nextCell.getCellPosition();
      var previousEditable = this.isCellEditable(previousPos);
      var nextEditable = this.isCellEditable(nextPos);
      var rowsMatch = nextPos && previousPos.rowIndex === nextPos.rowIndex && previousPos.rowPinned === nextPos.rowPinned;
      if (previousEditable) {
        previousCell.setFocusOutOnEditor();
      }
      if (!rowsMatch) {
        var pRow = previousCell.getRowCtrl();
        pRow.stopEditing();
        var nRow = nextCell.getRowCtrl();
        nRow.startRowEditing(void 0, void 0, event);
      }
      if (nextEditable) {
        nextCell.setFocusInOnEditor();
        nextCell.focusCell();
      } else {
        nextCell.focusCell(true);
      }
      return true;
    };
    NavigationService2.prototype.moveToNextCellNotEditing = function(previousCell, backwards) {
      var displayedColumns = this.columnModel.getAllDisplayedColumns();
      var cellPos;
      if (previousCell instanceof RowCtrl) {
        cellPos = __assign$8$1(__assign$8$1({}, previousCell.getRowPosition()), { column: backwards ? displayedColumns[0] : last(displayedColumns) });
      } else {
        cellPos = previousCell.getCellPosition();
      }
      var nextCell = this.findNextCellToFocusOn(cellPos, backwards, false);
      if (nextCell instanceof CellCtrl) {
        nextCell.focusCell(true);
      } else if (nextCell) {
        return this.tryToFocusFullWidthRow(nextCell.getRowPosition(), backwards);
      }
      return exists(nextCell);
    };
    NavigationService2.prototype.findNextCellToFocusOn = function(previousPosition, backwards, startEditing) {
      var nextPosition = previousPosition;
      while (true) {
        if (previousPosition !== nextPosition) {
          previousPosition = nextPosition;
        }
        if (!backwards) {
          nextPosition = this.getLastCellOfColSpan(nextPosition);
        }
        nextPosition = this.cellNavigationService.getNextTabbedCell(nextPosition, backwards);
        var userFunc = this.gridOptionsService.getCallback("tabToNextCell");
        if (exists(userFunc)) {
          var params = {
            backwards,
            editing: startEditing,
            previousCellPosition: previousPosition,
            nextCellPosition: nextPosition ? nextPosition : null
          };
          var userCell = userFunc(params);
          if (exists(userCell)) {
            if (userCell.floating) {
              doOnce(function() {
                console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?");
              }, "no floating in userCell");
              userCell.rowPinned = userCell.floating;
            }
            nextPosition = {
              rowIndex: userCell.rowIndex,
              column: userCell.column,
              rowPinned: userCell.rowPinned
            };
          } else {
            nextPosition = null;
          }
        }
        if (!nextPosition) {
          return null;
        }
        if (nextPosition.rowIndex < 0) {
          var headerLen = this.headerNavigationService.getHeaderRowCount();
          this.focusService.focusHeaderPosition({
            headerPosition: {
              headerRowIndex: headerLen + nextPosition.rowIndex,
              column: nextPosition.column
            }
          });
          return null;
        }
        var fullRowEdit = this.gridOptionsService.get("editType") === "fullRow";
        if (startEditing && !fullRowEdit) {
          var cellIsEditable = this.isCellEditable(nextPosition);
          if (!cellIsEditable) {
            continue;
          }
        }
        this.ensureCellVisible(nextPosition);
        var nextCell = this.getCellByPosition(nextPosition);
        if (!nextCell) {
          var row = this.rowRenderer.getRowByPosition(nextPosition);
          if (!row || !row.isFullWidth() || startEditing) {
            continue;
          }
          return row;
        }
        if (nextCell.isSuppressNavigable()) {
          continue;
        }
        if (this.rangeService) {
          this.rangeService.setRangeToCell(nextPosition);
        }
        return nextCell;
      }
    };
    NavigationService2.prototype.isCellEditable = function(cell) {
      var rowNode = this.lookupRowNodeForCell(cell);
      if (rowNode) {
        return cell.column.isCellEditable(rowNode);
      }
      return false;
    };
    NavigationService2.prototype.getCellByPosition = function(cellPosition) {
      var rowCtrl = this.rowRenderer.getRowByPosition(cellPosition);
      if (!rowCtrl) {
        return null;
      }
      return rowCtrl.getCellCtrl(cellPosition.column);
    };
    NavigationService2.prototype.lookupRowNodeForCell = function(cell) {
      if (cell.rowPinned === "top") {
        return this.pinnedRowModel.getPinnedTopRow(cell.rowIndex);
      }
      if (cell.rowPinned === "bottom") {
        return this.pinnedRowModel.getPinnedBottomRow(cell.rowIndex);
      }
      return this.paginationProxy.getRow(cell.rowIndex);
    };
    NavigationService2.prototype.navigateToNextCell = function(event, key, currentCell, allowUserOverride) {
      var nextCell = currentCell;
      var hitEdgeOfGrid = false;
      while (nextCell && (nextCell === currentCell || !this.isValidNavigateCell(nextCell))) {
        if (this.gridOptionsService.is("enableRtl")) {
          if (key === KeyCode.LEFT) {
            nextCell = this.getLastCellOfColSpan(nextCell);
          }
        } else if (key === KeyCode.RIGHT) {
          nextCell = this.getLastCellOfColSpan(nextCell);
        }
        nextCell = this.cellNavigationService.getNextCellToFocus(key, nextCell);
        hitEdgeOfGrid = missing(nextCell);
      }
      if (hitEdgeOfGrid && event && event.key === KeyCode.UP) {
        nextCell = {
          rowIndex: -1,
          rowPinned: null,
          column: currentCell.column
        };
      }
      if (allowUserOverride) {
        var userFunc = this.gridOptionsService.getCallback("navigateToNextCell");
        if (exists(userFunc)) {
          var params = {
            key,
            previousCellPosition: currentCell,
            nextCellPosition: nextCell ? nextCell : null,
            event
          };
          var userCell = userFunc(params);
          if (exists(userCell)) {
            if (userCell.floating) {
              doOnce(function() {
                console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?");
              }, "no floating in userCell");
              userCell.rowPinned = userCell.floating;
            }
            nextCell = {
              rowPinned: userCell.rowPinned,
              rowIndex: userCell.rowIndex,
              column: userCell.column
            };
          } else {
            nextCell = null;
          }
        }
      }
      if (!nextCell) {
        return;
      }
      if (nextCell.rowIndex < 0) {
        var headerLen = this.headerNavigationService.getHeaderRowCount();
        this.focusService.focusHeaderPosition({
          headerPosition: { headerRowIndex: headerLen + nextCell.rowIndex, column: currentCell.column },
          event: event || void 0
        });
        return;
      }
      var normalisedPosition = this.getNormalisedPosition(nextCell);
      if (normalisedPosition) {
        this.focusPosition(normalisedPosition);
      } else {
        this.tryToFocusFullWidthRow(nextCell);
      }
    };
    NavigationService2.prototype.getNormalisedPosition = function(cellPosition) {
      this.ensureCellVisible(cellPosition);
      var cellCtrl = this.getCellByPosition(cellPosition);
      if (!cellCtrl) {
        return null;
      }
      cellPosition = cellCtrl.getCellPosition();
      this.ensureCellVisible(cellPosition);
      return cellPosition;
    };
    NavigationService2.prototype.tryToFocusFullWidthRow = function(position, backwards) {
      if (backwards === void 0) {
        backwards = false;
      }
      var displayedColumns = this.columnModel.getAllDisplayedColumns();
      var rowComp2 = this.rowRenderer.getRowByPosition(position);
      if (!rowComp2 || !rowComp2.isFullWidth()) {
        return false;
      }
      var currentCellFocused = this.focusService.getFocusedCell();
      var cellPosition = {
        rowIndex: position.rowIndex,
        rowPinned: position.rowPinned,
        column: position.column || (backwards ? last(displayedColumns) : displayedColumns[0])
      };
      this.focusPosition(cellPosition);
      var fromBelow = currentCellFocused != null ? this.rowPositionUtils.before(cellPosition, currentCellFocused) : false;
      var focusEvent = {
        type: Events.EVENT_FULL_WIDTH_ROW_FOCUSED,
        rowIndex: cellPosition.rowIndex,
        rowPinned: cellPosition.rowPinned,
        column: cellPosition.column,
        isFullWidthCell: true,
        floating: cellPosition.rowPinned,
        fromBelow
      };
      this.eventService.dispatchEvent(focusEvent);
      return true;
    };
    NavigationService2.prototype.focusPosition = function(cellPosition) {
      this.focusService.setFocusedCell({
        rowIndex: cellPosition.rowIndex,
        column: cellPosition.column,
        rowPinned: cellPosition.rowPinned,
        forceBrowserFocus: true
      });
      if (this.rangeService) {
        this.rangeService.setRangeToCell(cellPosition);
      }
    };
    NavigationService2.prototype.isValidNavigateCell = function(cell) {
      var rowNode = this.rowPositionUtils.getRowNode(cell);
      return !!rowNode;
    };
    NavigationService2.prototype.getLastCellOfColSpan = function(cell) {
      var cellCtrl = this.getCellByPosition(cell);
      if (!cellCtrl) {
        return cell;
      }
      var colSpanningList = cellCtrl.getColSpanningList();
      if (colSpanningList.length === 1) {
        return cell;
      }
      return {
        rowIndex: cell.rowIndex,
        column: last(colSpanningList),
        rowPinned: cell.rowPinned
      };
    };
    NavigationService2.prototype.ensureCellVisible = function(gridCell) {
      var isGroupStickyEnabled = this.gridOptionsService.isGroupRowsSticky();
      var rowNode = this.rowModel.getRow(gridCell.rowIndex);
      var skipScrollToRow = isGroupStickyEnabled && (rowNode === null || rowNode === void 0 ? void 0 : rowNode.sticky);
      if (!skipScrollToRow && missing(gridCell.rowPinned)) {
        this.gridBodyCon.getScrollFeature().ensureIndexVisible(gridCell.rowIndex);
      }
      if (!gridCell.column.isPinned()) {
        this.gridBodyCon.getScrollFeature().ensureColumnVisible(gridCell.column);
      }
    };
    __decorate$1B([
      Autowired("mouseEventService")
    ], NavigationService2.prototype, "mouseEventService", void 0);
    __decorate$1B([
      Autowired("paginationProxy")
    ], NavigationService2.prototype, "paginationProxy", void 0);
    __decorate$1B([
      Autowired("focusService")
    ], NavigationService2.prototype, "focusService", void 0);
    __decorate$1B([
      Optional("rangeService")
    ], NavigationService2.prototype, "rangeService", void 0);
    __decorate$1B([
      Autowired("columnModel")
    ], NavigationService2.prototype, "columnModel", void 0);
    __decorate$1B([
      Autowired("rowModel")
    ], NavigationService2.prototype, "rowModel", void 0);
    __decorate$1B([
      Autowired("ctrlsService")
    ], NavigationService2.prototype, "ctrlsService", void 0);
    __decorate$1B([
      Autowired("rowRenderer")
    ], NavigationService2.prototype, "rowRenderer", void 0);
    __decorate$1B([
      Autowired("headerNavigationService")
    ], NavigationService2.prototype, "headerNavigationService", void 0);
    __decorate$1B([
      Autowired("rowPositionUtils")
    ], NavigationService2.prototype, "rowPositionUtils", void 0);
    __decorate$1B([
      Autowired("cellNavigationService")
    ], NavigationService2.prototype, "cellNavigationService", void 0);
    __decorate$1B([
      Autowired("pinnedRowModel")
    ], NavigationService2.prototype, "pinnedRowModel", void 0);
    __decorate$1B([
      PostConstruct
    ], NavigationService2.prototype, "postConstruct", null);
    NavigationService2 = __decorate$1B([
      Bean("navigationService")
    ], NavigationService2);
    return NavigationService2;
  }(BeanStub)
);
var __extends$1E = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1A = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var PopupEditorWrapper = (
  /** @class */
  function(_super) {
    __extends$1E(PopupEditorWrapper2, _super);
    function PopupEditorWrapper2(params) {
      var _this = _super.call(
        this,
        /* html */
        '<div class="ag-popup-editor" tabindex="-1"/>'
      ) || this;
      _this.params = params;
      return _this;
    }
    PopupEditorWrapper2.prototype.postConstruct = function() {
      this.gridOptionsService.setDomData(this.getGui(), PopupEditorWrapper2.DOM_KEY_POPUP_EDITOR_WRAPPER, true);
      this.addKeyDownListener();
    };
    PopupEditorWrapper2.prototype.addKeyDownListener = function() {
      var _this = this;
      var eGui = this.getGui();
      var params = this.params;
      var listener = function(event) {
        if (!isUserSuppressingKeyboardEvent(_this.gridOptionsService, event, params.node, params.column, true)) {
          params.onKeyDown(event);
        }
      };
      this.addManagedListener(eGui, "keydown", listener);
    };
    PopupEditorWrapper2.DOM_KEY_POPUP_EDITOR_WRAPPER = "popupEditorWrapper";
    __decorate$1A([
      PostConstruct
    ], PopupEditorWrapper2.prototype, "postConstruct", null);
    return PopupEditorWrapper2;
  }(PopupComponent)
);
var __extends$1D = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var CellComp = (
  /** @class */
  function(_super) {
    __extends$1D(CellComp2, _super);
    function CellComp2(beans, cellCtrl, printLayout, eRow, editingRow) {
      var _this = _super.call(this) || this;
      _this.rendererVersion = 0;
      _this.editorVersion = 0;
      _this.beans = beans;
      _this.column = cellCtrl.getColumn();
      _this.rowNode = cellCtrl.getRowNode();
      _this.rowCtrl = cellCtrl.getRowCtrl();
      _this.eRow = eRow;
      _this.setTemplate(
        /* html */
        '<div comp-id="' + _this.getCompId() + '"/>'
      );
      var eGui = _this.getGui();
      _this.forceWrapper = cellCtrl.isForceWrapper();
      _this.refreshWrapper(false);
      var setAttribute = function(name, value, element) {
        var actualElement = element ? element : eGui;
        if (value != null && value != "") {
          actualElement.setAttribute(name, value);
        } else {
          actualElement.removeAttribute(name);
        }
      };
      var compProxy = {
        addOrRemoveCssClass: function(cssClassName, on) {
          return _this.addOrRemoveCssClass(cssClassName, on);
        },
        setUserStyles: function(styles) {
          return addStylesToElement(eGui, styles);
        },
        getFocusableElement: function() {
          return _this.getFocusableElement();
        },
        setTabIndex: function(tabIndex) {
          return setAttribute("tabindex", tabIndex.toString());
        },
        setRole: function(role) {
          return setAriaRole(eGui, role);
        },
        setColId: function(colId) {
          return setAttribute("col-id", colId);
        },
        setTitle: function(title) {
          return setAttribute("title", title);
        },
        setIncludeSelection: function(include) {
          return _this.includeSelection = include;
        },
        setIncludeRowDrag: function(include) {
          return _this.includeRowDrag = include;
        },
        setIncludeDndSource: function(include) {
          return _this.includeDndSource = include;
        },
        setRenderDetails: function(compDetails, valueToDisplay, force) {
          return _this.setRenderDetails(compDetails, valueToDisplay, force);
        },
        setEditDetails: function(compDetails, popup, position) {
          return _this.setEditDetails(compDetails, popup, position);
        },
        getCellEditor: function() {
          return _this.cellEditor || null;
        },
        getCellRenderer: function() {
          return _this.cellRenderer || null;
        },
        getParentOfValue: function() {
          return _this.getParentOfValue();
        }
      };
      _this.cellCtrl = cellCtrl;
      cellCtrl.setComp(compProxy, _this.getGui(), _this.eCellWrapper, printLayout, editingRow);
      return _this;
    }
    CellComp2.prototype.getParentOfValue = function() {
      if (this.eCellValue) {
        return this.eCellValue;
      }
      if (this.eCellWrapper) {
        return this.eCellWrapper;
      }
      return this.getGui();
    };
    CellComp2.prototype.setRenderDetails = function(compDetails, valueToDisplay, forceNewCellRendererInstance) {
      var isInlineEditing = this.cellEditor && !this.cellEditorPopupWrapper;
      if (isInlineEditing) {
        return;
      }
      this.firstRender = this.firstRender == null;
      var controlWrapperChanged = this.refreshWrapper(false);
      this.refreshEditStyles(false);
      if (compDetails) {
        var neverRefresh = forceNewCellRendererInstance || controlWrapperChanged;
        var cellRendererRefreshSuccessful = neverRefresh ? false : this.refreshCellRenderer(compDetails);
        if (!cellRendererRefreshSuccessful) {
          this.destroyRenderer();
          this.createCellRendererInstance(compDetails);
        }
      } else {
        this.destroyRenderer();
        this.insertValueWithoutCellRenderer(valueToDisplay);
      }
    };
    CellComp2.prototype.setEditDetails = function(compDetails, popup, position) {
      if (compDetails) {
        this.createCellEditorInstance(compDetails, popup, position);
      } else {
        this.destroyEditor();
      }
    };
    CellComp2.prototype.removeControls = function() {
      this.checkboxSelectionComp = this.beans.context.destroyBean(this.checkboxSelectionComp);
      this.dndSourceComp = this.beans.context.destroyBean(this.dndSourceComp);
      this.rowDraggingComp = this.beans.context.destroyBean(this.rowDraggingComp);
    };
    CellComp2.prototype.refreshWrapper = function(editing) {
      var providingControls = this.includeRowDrag || this.includeDndSource || this.includeSelection;
      var usingWrapper = providingControls || this.forceWrapper;
      var putWrapperIn = usingWrapper && this.eCellWrapper == null;
      if (putWrapperIn) {
        this.eCellWrapper = loadTemplate(
          /* html */
          '<div class="ag-cell-wrapper" role="presentation"></div>'
        );
        this.getGui().appendChild(this.eCellWrapper);
      }
      var takeWrapperOut = !usingWrapper && this.eCellWrapper != null;
      if (takeWrapperOut) {
        removeFromParent(this.eCellWrapper);
        this.eCellWrapper = void 0;
      }
      this.addOrRemoveCssClass("ag-cell-value", !usingWrapper);
      var usingCellValue = !editing && usingWrapper;
      var putCellValueIn = usingCellValue && this.eCellValue == null;
      if (putCellValueIn) {
        this.eCellValue = loadTemplate(
          /* html */
          '<span class="ag-cell-value" role="presentation"></span>'
        );
        this.eCellWrapper.appendChild(this.eCellValue);
      }
      var takeCellValueOut = !usingCellValue && this.eCellValue != null;
      if (takeCellValueOut) {
        removeFromParent(this.eCellValue);
        this.eCellValue = void 0;
      }
      var templateChanged = putWrapperIn || takeWrapperOut || putCellValueIn || takeCellValueOut;
      if (templateChanged) {
        this.removeControls();
      }
      if (!editing) {
        if (providingControls) {
          this.addControls();
        }
      }
      return templateChanged;
    };
    CellComp2.prototype.addControls = function() {
      if (this.includeRowDrag) {
        if (this.rowDraggingComp == null) {
          this.rowDraggingComp = this.cellCtrl.createRowDragComp();
          if (this.rowDraggingComp) {
            this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(), this.eCellValue);
          }
        }
      }
      if (this.includeDndSource) {
        if (this.dndSourceComp == null) {
          this.dndSourceComp = this.cellCtrl.createDndSource();
          this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(), this.eCellValue);
        }
      }
      if (this.includeSelection) {
        if (this.checkboxSelectionComp == null) {
          this.checkboxSelectionComp = this.cellCtrl.createSelectionCheckbox();
          this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(), this.eCellValue);
        }
      }
    };
    CellComp2.prototype.createCellEditorInstance = function(compDetails, popup, position) {
      var _this = this;
      var versionCopy = this.editorVersion;
      var cellEditorPromise = compDetails.newAgStackInstance();
      if (!cellEditorPromise) {
        return;
      }
      var params = compDetails.params;
      cellEditorPromise.then(function(c) {
        return _this.afterCellEditorCreated(versionCopy, c, params, popup, position);
      });
      var cellEditorAsync = missing(this.cellEditor);
      if (cellEditorAsync && params.cellStartedEdit) {
        this.cellCtrl.focusCell(true);
      }
    };
    CellComp2.prototype.insertValueWithoutCellRenderer = function(valueToDisplay) {
      var eParent = this.getParentOfValue();
      clearElement(eParent);
      var escapedValue = valueToDisplay != null ? escapeString(valueToDisplay) : null;
      if (escapedValue != null) {
        eParent.innerHTML = escapedValue;
      }
    };
    CellComp2.prototype.destroyEditorAndRenderer = function() {
      this.destroyRenderer();
      this.destroyEditor();
    };
    CellComp2.prototype.destroyRenderer = function() {
      var context = this.beans.context;
      this.cellRenderer = context.destroyBean(this.cellRenderer);
      removeFromParent(this.cellRendererGui);
      this.cellRendererGui = null;
      this.rendererVersion++;
    };
    CellComp2.prototype.destroyEditor = function() {
      var context = this.beans.context;
      if (this.hideEditorPopup) {
        this.hideEditorPopup();
      }
      this.hideEditorPopup = void 0;
      this.cellEditor = context.destroyBean(this.cellEditor);
      this.cellEditorPopupWrapper = context.destroyBean(this.cellEditorPopupWrapper);
      removeFromParent(this.cellEditorGui);
      this.cellEditorGui = null;
      this.editorVersion++;
    };
    CellComp2.prototype.refreshCellRenderer = function(compClassAndParams) {
      if (this.cellRenderer == null || this.cellRenderer.refresh == null) {
        return false;
      }
      if (this.cellRendererClass !== compClassAndParams.componentClass) {
        return false;
      }
      var result = this.cellRenderer.refresh(compClassAndParams.params);
      return result === true || result === void 0;
    };
    CellComp2.prototype.createCellRendererInstance = function(compDetails) {
      var _this = this;
      var suppressAnimationFrame = this.beans.gridOptionsService.is("suppressAnimationFrame");
      var useTaskService = !suppressAnimationFrame;
      var displayComponentVersionCopy = this.rendererVersion;
      var componentClass = compDetails.componentClass;
      var createCellRendererFunc = function() {
        var staleTask = _this.rendererVersion !== displayComponentVersionCopy || !_this.isAlive();
        if (staleTask) {
          return;
        }
        var componentPromise = compDetails.newAgStackInstance();
        var callback2 = _this.afterCellRendererCreated.bind(_this, displayComponentVersionCopy, componentClass);
        if (componentPromise) {
          componentPromise.then(callback2);
        }
      };
      if (useTaskService && this.firstRender) {
        this.beans.animationFrameService.createTask(createCellRendererFunc, this.rowNode.rowIndex, "createTasksP2");
      } else {
        createCellRendererFunc();
      }
    };
    CellComp2.prototype.getCtrl = function() {
      return this.cellCtrl;
    };
    CellComp2.prototype.getRowCtrl = function() {
      return this.rowCtrl;
    };
    CellComp2.prototype.getCellRenderer = function() {
      return this.cellRenderer;
    };
    CellComp2.prototype.getCellEditor = function() {
      return this.cellEditor;
    };
    CellComp2.prototype.afterCellRendererCreated = function(cellRendererVersion, cellRendererClass, cellRenderer) {
      var staleTask = !this.isAlive() || cellRendererVersion !== this.rendererVersion;
      if (staleTask) {
        this.beans.context.destroyBean(cellRenderer);
        return;
      }
      this.cellRenderer = cellRenderer;
      this.cellRendererClass = cellRendererClass;
      this.cellRendererGui = this.cellRenderer.getGui();
      if (this.cellRendererGui != null) {
        var eParent = this.getParentOfValue();
        clearElement(eParent);
        eParent.appendChild(this.cellRendererGui);
      }
    };
    CellComp2.prototype.afterCellEditorCreated = function(requestVersion, cellEditor, params, popup, position) {
      var staleComp = requestVersion !== this.editorVersion;
      if (staleComp) {
        this.beans.context.destroyBean(cellEditor);
        return;
      }
      var editingCancelledByUserComp = cellEditor.isCancelBeforeStart && cellEditor.isCancelBeforeStart();
      if (editingCancelledByUserComp) {
        this.beans.context.destroyBean(cellEditor);
        this.cellCtrl.stopEditing(true);
        return;
      }
      if (!cellEditor.getGui) {
        console.warn("AG Grid: cellEditor for column " + this.column.getId() + " is missing getGui() method");
        this.beans.context.destroyBean(cellEditor);
        return;
      }
      this.cellEditor = cellEditor;
      this.cellEditorGui = cellEditor.getGui();
      var cellEditorInPopup = popup || cellEditor.isPopup !== void 0 && cellEditor.isPopup();
      if (cellEditorInPopup) {
        this.addPopupCellEditor(params, position);
      } else {
        this.addInCellEditor();
      }
      this.refreshEditStyles(true, cellEditorInPopup);
      if (cellEditor.afterGuiAttached) {
        cellEditor.afterGuiAttached();
      }
    };
    CellComp2.prototype.refreshEditStyles = function(editing, isPopup) {
      var _a2;
      this.addOrRemoveCssClass("ag-cell-inline-editing", editing && !isPopup);
      this.addOrRemoveCssClass("ag-cell-popup-editing", editing && !!isPopup);
      this.addOrRemoveCssClass("ag-cell-not-inline-editing", !editing || !!isPopup);
      (_a2 = this.rowCtrl) === null || _a2 === void 0 ? void 0 : _a2.setInlineEditingCss(editing);
    };
    CellComp2.prototype.addInCellEditor = function() {
      var eGui = this.getGui();
      var eDocument = this.beans.gridOptionsService.getDocument();
      if (eGui.contains(eDocument.activeElement)) {
        eGui.focus();
      }
      this.destroyRenderer();
      this.refreshWrapper(true);
      this.clearParentOfValue();
      if (this.cellEditorGui) {
        var eParent = this.getParentOfValue();
        eParent.appendChild(this.cellEditorGui);
      }
    };
    CellComp2.prototype.addPopupCellEditor = function(params, position) {
      var _this = this;
      if (this.beans.gridOptionsService.get("editType") === "fullRow") {
        console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");
      }
      var cellEditor = this.cellEditor;
      this.cellEditorPopupWrapper = this.beans.context.createBean(new PopupEditorWrapper(params));
      var ePopupGui = this.cellEditorPopupWrapper.getGui();
      if (this.cellEditorGui) {
        ePopupGui.appendChild(this.cellEditorGui);
      }
      var popupService = this.beans.popupService;
      var useModelPopup = this.beans.gridOptionsService.is("stopEditingWhenCellsLoseFocus");
      var positionToUse = position != null ? position : cellEditor.getPopupPosition ? cellEditor.getPopupPosition() : "over";
      var isRtl = this.beans.gridOptionsService.is("enableRtl");
      var positionParams = {
        ePopup: ePopupGui,
        column: this.column,
        rowNode: this.rowNode,
        type: "popupCellEditor",
        eventSource: this.getGui(),
        position: positionToUse,
        alignSide: isRtl ? "right" : "left",
        keepWithinBounds: true
      };
      var positionCallback = popupService.positionPopupByComponent.bind(popupService, positionParams);
      var translate = this.beans.localeService.getLocaleTextFunc();
      var addPopupRes = popupService.addPopup({
        modal: useModelPopup,
        eChild: ePopupGui,
        closeOnEsc: true,
        closedCallback: function() {
          _this.cellCtrl.onPopupEditorClosed();
        },
        anchorToElement: this.getGui(),
        positionCallback,
        ariaLabel: translate("ariaLabelCellEditor", "Cell Editor")
      });
      if (addPopupRes) {
        this.hideEditorPopup = addPopupRes.hideFunc;
      }
    };
    CellComp2.prototype.detach = function() {
      this.eRow.removeChild(this.getGui());
    };
    CellComp2.prototype.destroy = function() {
      this.cellCtrl.stopEditing();
      this.destroyEditorAndRenderer();
      this.removeControls();
      _super.prototype.destroy.call(this);
    };
    CellComp2.prototype.clearParentOfValue = function() {
      var eGui = this.getGui();
      var eDocument = this.beans.gridOptionsService.getDocument();
      if (eGui.contains(eDocument.activeElement) && browserSupportsPreventScroll()) {
        eGui.focus({ preventScroll: true });
      }
      clearElement(this.getParentOfValue());
    };
    return CellComp2;
  }(Component)
);
var __extends$1C = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var RowComp$1 = (
  /** @class */
  function(_super) {
    __extends$1C(RowComp2, _super);
    function RowComp2(ctrl, beans, containerType) {
      var _this = _super.call(this) || this;
      _this.cellComps = {};
      _this.beans = beans;
      _this.rowCtrl = ctrl;
      _this.setTemplate(
        /* html */
        '<div comp-id="' + _this.getCompId() + '" style="' + _this.getInitialStyle(containerType) + '"/>'
      );
      var eGui = _this.getGui();
      var style2 = eGui.style;
      var compProxy = {
        setDomOrder: function(domOrder) {
          return _this.domOrder = domOrder;
        },
        setCellCtrls: function(cellCtrls) {
          return _this.setCellCtrls(cellCtrls);
        },
        showFullWidth: function(compDetails) {
          return _this.showFullWidth(compDetails);
        },
        getFullWidthCellRenderer: function() {
          return _this.getFullWidthCellRenderer();
        },
        addOrRemoveCssClass: function(name, on) {
          return _this.addOrRemoveCssClass(name, on);
        },
        setUserStyles: function(styles) {
          return addStylesToElement(eGui, styles);
        },
        setTop: function(top) {
          return style2.top = top;
        },
        setTransform: function(transform) {
          return style2.transform = transform;
        },
        setRowIndex: function(rowIndex) {
          return eGui.setAttribute("row-index", rowIndex);
        },
        setRole: function(role) {
          return setAriaRole(eGui, role);
        },
        setRowId: function(rowId) {
          return eGui.setAttribute("row-id", rowId);
        },
        setRowBusinessKey: function(businessKey) {
          return eGui.setAttribute("row-business-key", businessKey);
        },
        setTabIndex: function(tabIndex) {
          return eGui.setAttribute("tabindex", tabIndex.toString());
        }
      };
      ctrl.setComp(compProxy, _this.getGui(), containerType);
      _this.addDestroyFunc(function() {
        ctrl.unsetComp(containerType);
      });
      return _this;
    }
    RowComp2.prototype.getInitialStyle = function(containerType) {
      var transform = this.rowCtrl.getInitialTransform(containerType);
      var top = this.rowCtrl.getInitialRowTop(containerType);
      return transform ? "transform: " + transform : "top: " + top;
    };
    RowComp2.prototype.showFullWidth = function(compDetails) {
      var _this = this;
      var callback2 = function(cellRenderer) {
        if (_this.isAlive()) {
          var eGui = cellRenderer.getGui();
          _this.getGui().appendChild(eGui);
          _this.rowCtrl.setupDetailRowAutoHeight(eGui);
          _this.setFullWidthRowComp(cellRenderer);
        } else {
          _this.beans.context.destroyBean(cellRenderer);
        }
      };
      var res = compDetails.newAgStackInstance();
      if (!res) {
        return;
      }
      res.then(callback2);
    };
    RowComp2.prototype.setCellCtrls = function(cellCtrls) {
      var _this = this;
      var cellsToRemove = Object.assign({}, this.cellComps);
      cellCtrls.forEach(function(cellCtrl) {
        var key = cellCtrl.getInstanceId();
        var existingCellComp = _this.cellComps[key];
        if (existingCellComp == null) {
          _this.newCellComp(cellCtrl);
        } else {
          cellsToRemove[key] = null;
        }
      });
      var cellCompsToRemove = getAllValuesInObject(cellsToRemove).filter(function(cellComp2) {
        return cellComp2 != null;
      });
      this.destroyCells(cellCompsToRemove);
      this.ensureDomOrder(cellCtrls);
    };
    RowComp2.prototype.ensureDomOrder = function(cellCtrls) {
      var _this = this;
      if (!this.domOrder) {
        return;
      }
      var elementsInOrder = [];
      cellCtrls.forEach(function(cellCtrl) {
        var cellComp2 = _this.cellComps[cellCtrl.getInstanceId()];
        if (cellComp2) {
          elementsInOrder.push(cellComp2.getGui());
        }
      });
      setDomChildOrder(this.getGui(), elementsInOrder);
    };
    RowComp2.prototype.newCellComp = function(cellCtrl) {
      var cellComp2 = new CellComp(this.beans, cellCtrl, this.rowCtrl.isPrintLayout(), this.getGui(), this.rowCtrl.isEditing());
      this.cellComps[cellCtrl.getInstanceId()] = cellComp2;
      this.getGui().appendChild(cellComp2.getGui());
    };
    RowComp2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
      this.destroyAllCells();
    };
    RowComp2.prototype.destroyAllCells = function() {
      var cellsToDestroy = getAllValuesInObject(this.cellComps).filter(function(cp) {
        return cp != null;
      });
      this.destroyCells(cellsToDestroy);
    };
    RowComp2.prototype.setFullWidthRowComp = function(fullWidthRowComponent) {
      var _this = this;
      if (this.fullWidthCellRenderer) {
        console.error("AG Grid - should not be setting fullWidthRowComponent twice");
      }
      this.fullWidthCellRenderer = fullWidthRowComponent;
      this.addDestroyFunc(function() {
        _this.fullWidthCellRenderer = _this.beans.context.destroyBean(_this.fullWidthCellRenderer);
      });
    };
    RowComp2.prototype.getFullWidthCellRenderer = function() {
      return this.fullWidthCellRenderer;
    };
    RowComp2.prototype.destroyCells = function(cellComps) {
      var _this = this;
      cellComps.forEach(function(cellComp2) {
        if (!cellComp2) {
          return;
        }
        var instanceId = cellComp2.getCtrl().getInstanceId();
        if (_this.cellComps[instanceId] !== cellComp2) {
          return;
        }
        cellComp2.detach();
        cellComp2.destroy();
        _this.cellComps[instanceId] = null;
      });
    };
    return RowComp2;
  }(Component)
);
var __extends$1B = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$7$1 = function() {
  __assign$7$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$7$1.apply(this, arguments);
};
var __decorate$1z = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
function templateFactory() {
  var name = Component.elementGettingCreated.getAttribute("name");
  var cssClasses = RowContainerCtrl.getRowContainerCssClasses(name);
  var res;
  var template1 = name === RowContainerName.CENTER;
  var template2 = name === RowContainerName.TOP_CENTER || name === RowContainerName.STICKY_TOP_CENTER || name === RowContainerName.BOTTOM_CENTER;
  if (template1) {
    res = /* html */
    '<div class="' + cssClasses.wrapper + '" ref="eWrapper" role="presentation">\n                <div class="' + cssClasses.viewport + '" ref="eViewport" role="presentation">\n                    <div class="' + cssClasses.container + '" ref="eContainer"></div>\n                </div>\n            </div>';
  } else if (template2) {
    res = /* html */
    '<div class="' + cssClasses.viewport + '" ref="eViewport" role="presentation">\n                <div class="' + cssClasses.container + '" ref="eContainer"></div>\n            </div>';
  } else {
    res = /* html */
    '<div class="' + cssClasses.container + '" ref="eContainer"></div>';
  }
  return res;
}
var RowContainerComp$1 = (
  /** @class */
  function(_super) {
    __extends$1B(RowContainerComp2, _super);
    function RowContainerComp2() {
      var _this = _super.call(this, templateFactory()) || this;
      _this.rowComps = {};
      _this.name = Component.elementGettingCreated.getAttribute("name");
      _this.type = getRowContainerTypeForName(_this.name);
      return _this;
    }
    RowContainerComp2.prototype.postConstruct = function() {
      var _this = this;
      var compProxy = {
        setViewportHeight: function(height) {
          return _this.eViewport.style.height = height;
        },
        setRowCtrls: function(rowCtrls) {
          return _this.setRowCtrls(rowCtrls);
        },
        setDomOrder: function(domOrder) {
          _this.domOrder = domOrder;
        },
        setContainerWidth: function(width) {
          return _this.eContainer.style.width = width;
        }
      };
      var ctrl = this.createManagedBean(new RowContainerCtrl(this.name));
      ctrl.setComp(compProxy, this.eContainer, this.eViewport, this.eWrapper);
    };
    RowContainerComp2.prototype.preDestroy = function() {
      this.setRowCtrls([]);
    };
    RowContainerComp2.prototype.setRowCtrls = function(rowCtrls) {
      var _this = this;
      var oldRows = __assign$7$1({}, this.rowComps);
      this.rowComps = {};
      this.lastPlacedElement = null;
      var processRow = function(rowCon) {
        var instanceId = rowCon.getInstanceId();
        var existingRowComp = oldRows[instanceId];
        if (existingRowComp) {
          _this.rowComps[instanceId] = existingRowComp;
          delete oldRows[instanceId];
          _this.ensureDomOrder(existingRowComp.getGui());
        } else {
          if (!rowCon.getRowNode().displayed) {
            return;
          }
          var rowComp2 = new RowComp$1(rowCon, _this.beans, _this.type);
          _this.rowComps[instanceId] = rowComp2;
          _this.appendRow(rowComp2.getGui());
        }
      };
      rowCtrls.forEach(processRow);
      getAllValuesInObject(oldRows).forEach(function(oldRowComp) {
        _this.eContainer.removeChild(oldRowComp.getGui());
        oldRowComp.destroy();
      });
      setAriaRole(this.eContainer, rowCtrls.length ? "rowgroup" : "presentation");
    };
    RowContainerComp2.prototype.appendRow = function(element) {
      if (this.domOrder) {
        insertWithDomOrder(this.eContainer, element, this.lastPlacedElement);
      } else {
        this.eContainer.appendChild(element);
      }
      this.lastPlacedElement = element;
    };
    RowContainerComp2.prototype.ensureDomOrder = function(eRow) {
      if (this.domOrder) {
        ensureDomOrder(this.eContainer, eRow, this.lastPlacedElement);
        this.lastPlacedElement = eRow;
      }
    };
    __decorate$1z([
      Autowired("beans")
    ], RowContainerComp2.prototype, "beans", void 0);
    __decorate$1z([
      RefSelector("eViewport")
    ], RowContainerComp2.prototype, "eViewport", void 0);
    __decorate$1z([
      RefSelector("eContainer")
    ], RowContainerComp2.prototype, "eContainer", void 0);
    __decorate$1z([
      RefSelector("eWrapper")
    ], RowContainerComp2.prototype, "eWrapper", void 0);
    __decorate$1z([
      PostConstruct
    ], RowContainerComp2.prototype, "postConstruct", null);
    __decorate$1z([
      PreDestroy
    ], RowContainerComp2.prototype, "preDestroy", null);
    return RowContainerComp2;
  }(Component)
);
var __decorate$1y = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var BodyDropPivotTarget = (
  /** @class */
  function() {
    function BodyDropPivotTarget2(pinned) {
      this.columnsToAggregate = [];
      this.columnsToGroup = [];
      this.columnsToPivot = [];
      this.pinned = pinned;
    }
    BodyDropPivotTarget2.prototype.onDragEnter = function(draggingEvent) {
      var _this = this;
      this.clearColumnsList();
      if (this.gridOptionsService.is("functionsReadOnly")) {
        return;
      }
      var dragColumns = draggingEvent.dragItem.columns;
      if (!dragColumns) {
        return;
      }
      dragColumns.forEach(function(column) {
        if (!column.isPrimary()) {
          return;
        }
        if (column.isAnyFunctionActive()) {
          return;
        }
        if (column.isAllowValue()) {
          _this.columnsToAggregate.push(column);
        } else if (column.isAllowRowGroup()) {
          _this.columnsToGroup.push(column);
        } else if (column.isAllowPivot()) {
          _this.columnsToPivot.push(column);
        }
      });
    };
    BodyDropPivotTarget2.prototype.getIconName = function() {
      var totalColumns = this.columnsToAggregate.length + this.columnsToGroup.length + this.columnsToPivot.length;
      if (totalColumns > 0) {
        return this.pinned ? DragAndDropService.ICON_PINNED : DragAndDropService.ICON_MOVE;
      }
      return null;
    };
    BodyDropPivotTarget2.prototype.onDragLeave = function(draggingEvent) {
      this.clearColumnsList();
    };
    BodyDropPivotTarget2.prototype.clearColumnsList = function() {
      this.columnsToAggregate.length = 0;
      this.columnsToGroup.length = 0;
      this.columnsToPivot.length = 0;
    };
    BodyDropPivotTarget2.prototype.onDragging = function(draggingEvent) {
    };
    BodyDropPivotTarget2.prototype.onDragStop = function(draggingEvent) {
      if (this.columnsToAggregate.length > 0) {
        this.columnModel.addValueColumns(this.columnsToAggregate, "toolPanelDragAndDrop");
      }
      if (this.columnsToGroup.length > 0) {
        this.columnModel.addRowGroupColumns(this.columnsToGroup, "toolPanelDragAndDrop");
      }
      if (this.columnsToPivot.length > 0) {
        this.columnModel.addPivotColumns(this.columnsToPivot, "toolPanelDragAndDrop");
      }
    };
    __decorate$1y([
      Autowired("columnModel")
    ], BodyDropPivotTarget2.prototype, "columnModel", void 0);
    __decorate$1y([
      Autowired("gridOptionsService")
    ], BodyDropPivotTarget2.prototype, "gridOptionsService", void 0);
    return BodyDropPivotTarget2;
  }()
);
var __decorate$1x = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$i = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var MoveColumnFeature = (
  /** @class */
  function() {
    function MoveColumnFeature2(pinned, eContainer) {
      this.needToMoveLeft = false;
      this.needToMoveRight = false;
      this.lastMovedInfo = null;
      this.pinned = pinned;
      this.eContainer = eContainer;
      this.centerContainer = !exists(pinned);
    }
    MoveColumnFeature2.prototype.init = function() {
      var _this = this;
      this.ctrlsService.whenReady(function() {
        _this.gridBodyCon = _this.ctrlsService.getGridBodyCtrl();
      });
    };
    MoveColumnFeature2.prototype.getIconName = function() {
      return this.pinned ? DragAndDropService.ICON_PINNED : DragAndDropService.ICON_MOVE;
    };
    MoveColumnFeature2.prototype.onDragEnter = function(draggingEvent) {
      var columns = draggingEvent.dragItem.columns;
      var dragCameFromToolPanel = draggingEvent.dragSource.type === DragSourceType.ToolPanel;
      if (dragCameFromToolPanel) {
        this.setColumnsVisible(columns, true, "uiColumnDragged");
      } else {
        var visibleState_1 = draggingEvent.dragItem.visibleState;
        var visibleColumns = (columns || []).filter(function(column) {
          return visibleState_1[column.getId()];
        });
        this.setColumnsVisible(visibleColumns, true, "uiColumnDragged");
      }
      this.setColumnsPinned(columns, this.pinned, "uiColumnDragged");
      this.onDragging(draggingEvent, true, true);
    };
    MoveColumnFeature2.prototype.onDragLeave = function() {
      this.ensureIntervalCleared();
      this.lastMovedInfo = null;
    };
    MoveColumnFeature2.prototype.setColumnsVisible = function(columns, visible, source) {
      if (source === void 0) {
        source = "api";
      }
      if (columns) {
        var allowedCols = columns.filter(function(c) {
          return !c.getColDef().lockVisible;
        });
        this.columnModel.setColumnsVisible(allowedCols, visible, source);
      }
    };
    MoveColumnFeature2.prototype.setColumnsPinned = function(columns, pinned, source) {
      if (source === void 0) {
        source = "api";
      }
      if (columns) {
        var allowedCols = columns.filter(function(c) {
          return !c.getColDef().lockPinned;
        });
        this.columnModel.setColumnsPinned(allowedCols, pinned, source);
      }
    };
    MoveColumnFeature2.prototype.onDragStop = function() {
      this.onDragging(this.lastDraggingEvent, false, true, true);
      this.ensureIntervalCleared();
      this.lastMovedInfo = null;
    };
    MoveColumnFeature2.prototype.normaliseX = function(x2) {
      if (this.gridOptionsService.is("enableRtl")) {
        var clientWidth = this.eContainer.clientWidth;
        x2 = clientWidth - x2;
      }
      if (this.centerContainer) {
        x2 += this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft();
      }
      return x2;
    };
    MoveColumnFeature2.prototype.checkCenterForScrolling = function(xAdjustedForScroll) {
      if (this.centerContainer) {
        var firstVisiblePixel = this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft();
        var lastVisiblePixel = firstVisiblePixel + this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();
        if (this.gridOptionsService.is("enableRtl")) {
          this.needToMoveRight = xAdjustedForScroll < firstVisiblePixel + 50;
          this.needToMoveLeft = xAdjustedForScroll > lastVisiblePixel - 50;
        } else {
          this.needToMoveLeft = xAdjustedForScroll < firstVisiblePixel + 50;
          this.needToMoveRight = xAdjustedForScroll > lastVisiblePixel - 50;
        }
        if (this.needToMoveLeft || this.needToMoveRight) {
          this.ensureIntervalStarted();
        } else {
          this.ensureIntervalCleared();
        }
      }
    };
    MoveColumnFeature2.prototype.onDragging = function(draggingEvent, fromEnter, fakeEvent, finished) {
      var _this = this;
      var _a2;
      if (draggingEvent === void 0) {
        draggingEvent = this.lastDraggingEvent;
      }
      if (fromEnter === void 0) {
        fromEnter = false;
      }
      if (fakeEvent === void 0) {
        fakeEvent = false;
      }
      if (finished === void 0) {
        finished = false;
      }
      if (finished) {
        if (this.lastMovedInfo) {
          var _b2 = this.lastMovedInfo, columns = _b2.columns, toIndex = _b2.toIndex;
          this.moveColumns(columns, toIndex, "uiColumnMoved", true);
        }
        return;
      }
      this.lastDraggingEvent = draggingEvent;
      if (missing(draggingEvent.hDirection)) {
        return;
      }
      var mouseX = this.normaliseX(draggingEvent.x);
      if (!fromEnter) {
        this.checkCenterForScrolling(mouseX);
      }
      var hDirection = this.normaliseDirection(draggingEvent.hDirection);
      var dragSourceType = draggingEvent.dragSource.type;
      var allMovingColumns = ((_a2 = draggingEvent.dragSource.getDragItem().columns) === null || _a2 === void 0 ? void 0 : _a2.filter(function(col) {
        if (col.getColDef().lockPinned) {
          return col.getPinned() == _this.pinned;
        }
        return true;
      })) || [];
      this.attemptMoveColumns({ dragSourceType, allMovingColumns, hDirection, mouseX, fromEnter, fakeEvent });
    };
    MoveColumnFeature2.prototype.normaliseDirection = function(hDirection) {
      if (this.gridOptionsService.is("enableRtl")) {
        switch (hDirection) {
          case HorizontalDirection.Left:
            return HorizontalDirection.Right;
          case HorizontalDirection.Right:
            return HorizontalDirection.Left;
          default:
            console.error("AG Grid: Unknown direction " + hDirection);
        }
      } else {
        return hDirection;
      }
    };
    MoveColumnFeature2.prototype.attemptMoveColumns = function(params) {
      var dragSourceType = params.dragSourceType, hDirection = params.hDirection, mouseX = params.mouseX, fromEnter = params.fromEnter, fakeEvent = params.fakeEvent;
      var draggingLeft = hDirection === HorizontalDirection.Left;
      var draggingRight = hDirection === HorizontalDirection.Right;
      var allMovingColumns = params.allMovingColumns;
      if (dragSourceType === DragSourceType.HeaderCell) {
        var newCols_1 = [];
        allMovingColumns.forEach(function(col) {
          var movingGroup = null;
          var parent = col.getParent();
          while (parent != null && parent.getDisplayedLeafColumns().length === 1) {
            movingGroup = parent;
            parent = parent.getParent();
          }
          if (movingGroup != null) {
            var providedColumnGroup = movingGroup.getProvidedColumnGroup();
            providedColumnGroup.getLeafColumns().forEach(function(newCol) {
              if (!newCols_1.includes(newCol)) {
                newCols_1.push(newCol);
              }
            });
          } else if (!newCols_1.includes(col)) {
            newCols_1.push(col);
          }
        });
        allMovingColumns = newCols_1;
      }
      var allMovingColumnsOrdered = allMovingColumns.slice();
      this.columnModel.sortColumnsLikeGridColumns(allMovingColumnsOrdered);
      var validMoves = this.calculateValidMoves(allMovingColumnsOrdered, draggingRight, mouseX);
      var oldIndex = this.calculateOldIndex(allMovingColumnsOrdered);
      if (validMoves.length === 0) {
        return;
      }
      var firstValidMove = validMoves[0];
      var constrainDirection = oldIndex !== null && !fromEnter;
      if (dragSourceType == DragSourceType.HeaderCell) {
        constrainDirection = oldIndex !== null;
      }
      if (constrainDirection && !fakeEvent) {
        if (draggingLeft && firstValidMove >= oldIndex) {
          return;
        }
        if (draggingRight && firstValidMove <= oldIndex) {
          return;
        }
      }
      var displayedCols = this.columnModel.getAllDisplayedColumns();
      var potentialMoves = [];
      var targetOrder = null;
      for (var i = 0; i < validMoves.length; i++) {
        var move = validMoves[i];
        var order = this.columnModel.getProposedColumnOrder(allMovingColumnsOrdered, move);
        if (!this.columnModel.doesOrderPassRules(order)) {
          continue;
        }
        var displayedOrder = order.filter(function(col) {
          return displayedCols.includes(col);
        });
        if (targetOrder === null) {
          targetOrder = displayedOrder;
        } else if (!_.areEqual(displayedOrder, targetOrder)) {
          break;
        }
        var fragCount = this.groupFragCount(order);
        potentialMoves.push({ move, fragCount });
      }
      if (potentialMoves.length === 0) {
        return;
      }
      potentialMoves.sort(function(a, b) {
        return a.fragCount - b.fragCount;
      });
      this.moveColumns(allMovingColumns, potentialMoves[0].move, "uiColumnMoved", false);
    };
    MoveColumnFeature2.prototype.calculateOldIndex = function(movingCols) {
      var gridCols = this.columnModel.getAllGridColumns();
      var indexes = sortNumerically(movingCols.map(function(col) {
        return gridCols.indexOf(col);
      }));
      var firstIndex = indexes[0];
      var lastIndex = last(indexes);
      var spread = lastIndex - firstIndex;
      var gapsExist = spread !== indexes.length - 1;
      return gapsExist ? null : firstIndex;
    };
    MoveColumnFeature2.prototype.moveColumns = function(columns, toIndex, source, finished) {
      this.columnModel.moveColumns(columns, toIndex, source, finished);
      this.lastMovedInfo = finished ? null : { columns, toIndex };
    };
    MoveColumnFeature2.prototype.groupFragCount = function(columns) {
      function parents(col) {
        var result = [];
        var parent = col.getOriginalParent();
        while (parent != null) {
          result.push(parent);
          parent = parent.getOriginalParent();
        }
        return result;
      }
      var count = 0;
      var _loop_1 = function(i2) {
        var _a2;
        var a = parents(columns[i2]);
        var b = parents(columns[i2 + 1]);
        _a2 = __read$i(a.length > b.length ? [a, b] : [b, a], 2), a = _a2[0], b = _a2[1];
        a.forEach(function(parent) {
          if (b.indexOf(parent) === -1) {
            count++;
          }
        });
      };
      for (var i = 0; i < columns.length - 1; i++) {
        _loop_1(i);
      }
      return count;
    };
    MoveColumnFeature2.prototype.calculateValidMoves = function(movingCols, draggingRight, mouseX) {
      var isMoveBlocked = this.gridOptionsService.is("suppressMovableColumns") || movingCols.some(function(col2) {
        return col2.getColDef().suppressMovable;
      });
      if (isMoveBlocked) {
        return [];
      }
      var allDisplayedCols = this.columnModel.getDisplayedColumns(this.pinned);
      var allGridCols = this.columnModel.getAllGridColumns();
      var movingDisplayedCols = allDisplayedCols.filter(function(col2) {
        return includes(movingCols, col2);
      });
      var otherDisplayedCols = allDisplayedCols.filter(function(col2) {
        return !includes(movingCols, col2);
      });
      var otherGridCols = allGridCols.filter(function(col2) {
        return !includes(movingCols, col2);
      });
      var displayIndex = 0;
      var availableWidth = mouseX;
      if (draggingRight) {
        var widthOfMovingDisplayedCols_1 = 0;
        movingDisplayedCols.forEach(function(col2) {
          return widthOfMovingDisplayedCols_1 += col2.getActualWidth();
        });
        availableWidth -= widthOfMovingDisplayedCols_1;
      }
      if (availableWidth > 0) {
        for (var i = 0; i < otherDisplayedCols.length; i++) {
          var col = otherDisplayedCols[i];
          availableWidth -= col.getActualWidth();
          if (availableWidth < 0) {
            break;
          }
          displayIndex++;
        }
        if (draggingRight) {
          displayIndex++;
        }
      }
      var firstValidMove;
      if (displayIndex > 0) {
        var leftColumn = otherDisplayedCols[displayIndex - 1];
        firstValidMove = otherGridCols.indexOf(leftColumn) + 1;
      } else {
        firstValidMove = otherGridCols.indexOf(otherDisplayedCols[0]);
        if (firstValidMove === -1) {
          firstValidMove = 0;
        }
      }
      var validMoves = [firstValidMove];
      var numberComparator = function(a, b) {
        return a - b;
      };
      if (draggingRight) {
        var pointer = firstValidMove + 1;
        var lastIndex = allGridCols.length - 1;
        while (pointer <= lastIndex) {
          validMoves.push(pointer);
          pointer++;
        }
        validMoves.sort(numberComparator);
      } else {
        var pointer = firstValidMove;
        var lastIndex = allGridCols.length - 1;
        var displacedCol = allGridCols[pointer];
        while (pointer <= lastIndex && this.isColumnHidden(allDisplayedCols, displacedCol)) {
          pointer++;
          validMoves.push(pointer);
          displacedCol = allGridCols[pointer];
        }
        pointer = firstValidMove - 1;
        var firstDisplayIndex = 0;
        while (pointer >= firstDisplayIndex) {
          validMoves.push(pointer);
          pointer--;
        }
        validMoves.sort(numberComparator).reverse();
      }
      return validMoves;
    };
    MoveColumnFeature2.prototype.isColumnHidden = function(displayedColumns, col) {
      return displayedColumns.indexOf(col) < 0;
    };
    MoveColumnFeature2.prototype.ensureIntervalStarted = function() {
      if (!this.movingIntervalId) {
        this.intervalCount = 0;
        this.failedMoveAttempts = 0;
        this.movingIntervalId = window.setInterval(this.moveInterval.bind(this), 100);
        if (this.needToMoveLeft) {
          this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_LEFT, true);
        } else {
          this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_RIGHT, true);
        }
      }
    };
    MoveColumnFeature2.prototype.ensureIntervalCleared = function() {
      if (this.movingIntervalId) {
        window.clearInterval(this.movingIntervalId);
        this.movingIntervalId = null;
        this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_MOVE);
      }
    };
    MoveColumnFeature2.prototype.moveInterval = function() {
      var pixelsToMove;
      this.intervalCount++;
      pixelsToMove = 10 + this.intervalCount * 5;
      if (pixelsToMove > 100) {
        pixelsToMove = 100;
      }
      var pixelsMoved = null;
      var scrollFeature = this.gridBodyCon.getScrollFeature();
      if (this.needToMoveLeft) {
        pixelsMoved = scrollFeature.scrollHorizontally(-pixelsToMove);
      } else if (this.needToMoveRight) {
        pixelsMoved = scrollFeature.scrollHorizontally(pixelsToMove);
      }
      if (pixelsMoved !== 0) {
        this.onDragging(this.lastDraggingEvent);
        this.failedMoveAttempts = 0;
      } else {
        this.failedMoveAttempts++;
        var columns = this.lastDraggingEvent.dragItem.columns;
        var columnsThatCanPin = columns.filter(function(c) {
          return !c.getColDef().lockPinned;
        });
        if (columnsThatCanPin.length > 0) {
          this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_PINNED);
          if (this.failedMoveAttempts > 7) {
            var pinType = this.needToMoveLeft ? "left" : "right";
            this.setColumnsPinned(columnsThatCanPin, pinType, "uiColumnDragged");
            this.dragAndDropService.nudge();
          }
        }
      }
    };
    __decorate$1x([
      Autowired("columnModel")
    ], MoveColumnFeature2.prototype, "columnModel", void 0);
    __decorate$1x([
      Autowired("dragAndDropService")
    ], MoveColumnFeature2.prototype, "dragAndDropService", void 0);
    __decorate$1x([
      Autowired("gridOptionsService")
    ], MoveColumnFeature2.prototype, "gridOptionsService", void 0);
    __decorate$1x([
      Autowired("ctrlsService")
    ], MoveColumnFeature2.prototype, "ctrlsService", void 0);
    __decorate$1x([
      PostConstruct
    ], MoveColumnFeature2.prototype, "init", null);
    return MoveColumnFeature2;
  }()
);
var __extends$1A = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1w = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var BodyDropTarget = (
  /** @class */
  function(_super) {
    __extends$1A(BodyDropTarget2, _super);
    function BodyDropTarget2(pinned, eContainer) {
      var _this = _super.call(this) || this;
      _this.pinned = pinned;
      _this.eContainer = eContainer;
      return _this;
    }
    BodyDropTarget2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function(p2) {
        switch (_this.pinned) {
          case "left":
            _this.eSecondaryContainers = [
              [p2.gridBodyCtrl.getBodyViewportElement(), p2.leftRowContainerCtrl.getContainerElement()],
              [p2.bottomLeftRowContainerCtrl.getContainerElement()],
              [p2.topLeftRowContainerCtrl.getContainerElement()]
            ];
            break;
          case "right":
            _this.eSecondaryContainers = [
              [p2.gridBodyCtrl.getBodyViewportElement(), p2.rightRowContainerCtrl.getContainerElement()],
              [p2.bottomRightRowContainerCtrl.getContainerElement()],
              [p2.topRightRowContainerCtrl.getContainerElement()]
            ];
            break;
          default:
            _this.eSecondaryContainers = [
              [p2.gridBodyCtrl.getBodyViewportElement(), p2.centerRowContainerCtrl.getViewportElement()],
              [p2.bottomCenterRowContainerCtrl.getViewportElement()],
              [p2.topCenterRowContainerCtrl.getViewportElement()]
            ];
            break;
        }
      });
    };
    BodyDropTarget2.prototype.isInterestedIn = function(type) {
      return type === DragSourceType.HeaderCell || type === DragSourceType.ToolPanel && this.gridOptionsService.is("allowDragFromColumnsToolPanel");
    };
    BodyDropTarget2.prototype.getSecondaryContainers = function() {
      return this.eSecondaryContainers;
    };
    BodyDropTarget2.prototype.getContainer = function() {
      return this.eContainer;
    };
    BodyDropTarget2.prototype.init = function() {
      this.moveColumnFeature = this.createManagedBean(new MoveColumnFeature(this.pinned, this.eContainer));
      this.bodyDropPivotTarget = this.createManagedBean(new BodyDropPivotTarget(this.pinned));
      this.dragAndDropService.addDropTarget(this);
    };
    BodyDropTarget2.prototype.getIconName = function() {
      return this.currentDropListener.getIconName();
    };
    BodyDropTarget2.prototype.isDropColumnInPivotMode = function(draggingEvent) {
      return this.columnModel.isPivotMode() && draggingEvent.dragSource.type === DragSourceType.ToolPanel;
    };
    BodyDropTarget2.prototype.onDragEnter = function(draggingEvent) {
      this.currentDropListener = this.isDropColumnInPivotMode(draggingEvent) ? this.bodyDropPivotTarget : this.moveColumnFeature;
      this.currentDropListener.onDragEnter(draggingEvent);
    };
    BodyDropTarget2.prototype.onDragLeave = function(params) {
      this.currentDropListener.onDragLeave(params);
    };
    BodyDropTarget2.prototype.onDragging = function(params) {
      this.currentDropListener.onDragging(params);
    };
    BodyDropTarget2.prototype.onDragStop = function(params) {
      this.currentDropListener.onDragStop(params);
    };
    __decorate$1w([
      Autowired("dragAndDropService")
    ], BodyDropTarget2.prototype, "dragAndDropService", void 0);
    __decorate$1w([
      Autowired("columnModel")
    ], BodyDropTarget2.prototype, "columnModel", void 0);
    __decorate$1w([
      Autowired("ctrlsService")
    ], BodyDropTarget2.prototype, "ctrlsService", void 0);
    __decorate$1w([
      PostConstruct
    ], BodyDropTarget2.prototype, "postConstruct", null);
    __decorate$1w([
      PostConstruct
    ], BodyDropTarget2.prototype, "init", null);
    return BodyDropTarget2;
  }(BeanStub)
);
var __read$h = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$f = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var CssClassApplier = (
  /** @class */
  function() {
    function CssClassApplier2() {
    }
    CssClassApplier2.getHeaderClassesFromColDef = function(abstractColDef, gridOptionsService, column, columnGroup) {
      if (missing(abstractColDef)) {
        return [];
      }
      return this.getColumnClassesFromCollDef(abstractColDef.headerClass, abstractColDef, gridOptionsService, column, columnGroup);
    };
    CssClassApplier2.getToolPanelClassesFromColDef = function(abstractColDef, gridOptionsService, column, columnGroup) {
      if (missing(abstractColDef)) {
        return [];
      }
      return this.getColumnClassesFromCollDef(abstractColDef.toolPanelClass, abstractColDef, gridOptionsService, column, columnGroup);
    };
    CssClassApplier2.getClassParams = function(abstractColDef, gridOptionsService, column, columnGroup) {
      return {
        // bad naming, as colDef here can be a group or a column,
        // however most people won't appreciate the difference,
        // so keeping it as colDef to avoid confusion.
        colDef: abstractColDef,
        column,
        columnGroup,
        api: gridOptionsService.api,
        columnApi: gridOptionsService.columnApi,
        context: gridOptionsService.context
      };
    };
    CssClassApplier2.getColumnClassesFromCollDef = function(classesOrFunc, abstractColDef, gridOptionsService, column, columnGroup) {
      if (missing(classesOrFunc)) {
        return [];
      }
      var classToUse;
      if (typeof classesOrFunc === "function") {
        var params = this.getClassParams(abstractColDef, gridOptionsService, column, columnGroup);
        classToUse = classesOrFunc(params);
      } else {
        classToUse = classesOrFunc;
      }
      if (typeof classToUse === "string") {
        return [classToUse];
      }
      if (Array.isArray(classToUse)) {
        return __spreadArray$f([], __read$h(classToUse));
      }
      return [];
    };
    return CssClassApplier2;
  }()
);
var __extends$1z = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1v = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderCellComp$1 = (
  /** @class */
  function(_super) {
    __extends$1z(HeaderCellComp2, _super);
    function HeaderCellComp2(ctrl) {
      var _this = _super.call(this, HeaderCellComp2.TEMPLATE, ctrl) || this;
      _this.headerCompVersion = 0;
      _this.column = ctrl.getColumnGroupChild();
      _this.pinned = ctrl.getPinned();
      return _this;
    }
    HeaderCellComp2.prototype.postConstruct = function() {
      var _this = this;
      var eGui = this.getGui();
      var setAttribute = function(name, value, element) {
        var actualElement = element ? element : eGui;
        if (value != null && value != "") {
          actualElement.setAttribute(name, value);
        } else {
          actualElement.removeAttribute(name);
        }
      };
      var compProxy = {
        setWidth: function(width) {
          return eGui.style.width = width;
        },
        addOrRemoveCssClass: function(cssClassName, on) {
          return _this.addOrRemoveCssClass(cssClassName, on);
        },
        setColId: function(id2) {
          return setAttribute("col-id", id2);
        },
        setTitle: function(title) {
          return setAttribute("title", title);
        },
        setAriaDescription: function(label) {
          return setAriaDescription(eGui, label);
        },
        setAriaSort: function(sort) {
          return sort ? setAriaSort(eGui, sort) : removeAriaSort(eGui);
        },
        setUserCompDetails: function(compDetails) {
          return _this.setUserCompDetails(compDetails);
        },
        getUserCompInstance: function() {
          return _this.headerComp;
        }
      };
      this.ctrl.setComp(compProxy, this.getGui(), this.eResize, this.eHeaderCompWrapper);
      var selectAllGui = this.ctrl.getSelectAllGui();
      this.eResize.insertAdjacentElement("afterend", selectAllGui);
    };
    HeaderCellComp2.prototype.destroyHeaderComp = function() {
      if (this.headerComp) {
        this.eHeaderCompWrapper.removeChild(this.headerCompGui);
        this.headerComp = this.destroyBean(this.headerComp);
        this.headerCompGui = void 0;
      }
    };
    HeaderCellComp2.prototype.setUserCompDetails = function(compDetails) {
      var _this = this;
      this.headerCompVersion++;
      var versionCopy = this.headerCompVersion;
      compDetails.newAgStackInstance().then(function(comp) {
        return _this.afterCompCreated(versionCopy, comp);
      });
    };
    HeaderCellComp2.prototype.afterCompCreated = function(version2, headerComp) {
      if (version2 != this.headerCompVersion || !this.isAlive()) {
        this.destroyBean(headerComp);
        return;
      }
      this.destroyHeaderComp();
      this.headerComp = headerComp;
      this.headerCompGui = headerComp.getGui();
      this.eHeaderCompWrapper.appendChild(this.headerCompGui);
      this.ctrl.setDragSource(this.getGui());
    };
    HeaderCellComp2.TEMPLATE = '<div class="ag-header-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>';
    __decorate$1v([
      RefSelector("eResize")
    ], HeaderCellComp2.prototype, "eResize", void 0);
    __decorate$1v([
      RefSelector("eHeaderCompWrapper")
    ], HeaderCellComp2.prototype, "eHeaderCompWrapper", void 0);
    __decorate$1v([
      PostConstruct
    ], HeaderCellComp2.prototype, "postConstruct", null);
    __decorate$1v([
      PreDestroy
    ], HeaderCellComp2.prototype, "destroyHeaderComp", null);
    return HeaderCellComp2;
  }(AbstractHeaderCellComp)
);
var __extends$1y = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1u = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderGroupCellComp$1 = (
  /** @class */
  function(_super) {
    __extends$1y(HeaderGroupCellComp2, _super);
    function HeaderGroupCellComp2(ctrl) {
      return _super.call(this, HeaderGroupCellComp2.TEMPLATE, ctrl) || this;
    }
    HeaderGroupCellComp2.prototype.postConstruct = function() {
      var _this = this;
      var eGui = this.getGui();
      var setAttribute = function(key, value) {
        return value != void 0 ? eGui.setAttribute(key, value) : eGui.removeAttribute(key);
      };
      var compProxy = {
        addOrRemoveCssClass: function(cssClassName, on) {
          return _this.addOrRemoveCssClass(cssClassName, on);
        },
        setResizableDisplayed: function(displayed) {
          return setDisplayed(_this.eResize, displayed);
        },
        setWidth: function(width) {
          return eGui.style.width = width;
        },
        setColId: function(id2) {
          return eGui.setAttribute("col-id", id2);
        },
        setAriaExpanded: function(expanded) {
          return setAttribute("aria-expanded", expanded);
        },
        setTitle: function(title) {
          return setAttribute("title", title);
        },
        setUserCompDetails: function(details) {
          return _this.setUserCompDetails(details);
        }
      };
      this.ctrl.setComp(compProxy, eGui, this.eResize);
    };
    HeaderGroupCellComp2.prototype.setUserCompDetails = function(details) {
      var _this = this;
      details.newAgStackInstance().then(function(comp) {
        return _this.afterHeaderCompCreated(comp);
      });
    };
    HeaderGroupCellComp2.prototype.afterHeaderCompCreated = function(headerGroupComp) {
      var _this = this;
      var destroyFunc = function() {
        return _this.destroyBean(headerGroupComp);
      };
      if (!this.isAlive()) {
        destroyFunc();
        return;
      }
      var eGui = this.getGui();
      var eHeaderGroupGui = headerGroupComp.getGui();
      eGui.appendChild(eHeaderGroupGui);
      this.addDestroyFunc(destroyFunc);
      this.ctrl.setDragSource(eGui);
    };
    HeaderGroupCellComp2.TEMPLATE = '<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>';
    __decorate$1u([
      Autowired("userComponentFactory")
    ], HeaderGroupCellComp2.prototype, "userComponentFactory", void 0);
    __decorate$1u([
      RefSelector("eResize")
    ], HeaderGroupCellComp2.prototype, "eResize", void 0);
    __decorate$1u([
      PostConstruct
    ], HeaderGroupCellComp2.prototype, "postConstruct", null);
    return HeaderGroupCellComp2;
  }(AbstractHeaderCellComp)
);
var __extends$1x = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1t = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderRowType;
(function(HeaderRowType2) {
  HeaderRowType2["COLUMN_GROUP"] = "group";
  HeaderRowType2["COLUMN"] = "column";
  HeaderRowType2["FLOATING_FILTER"] = "filter";
})(HeaderRowType || (HeaderRowType = {}));
var HeaderRowComp$1 = (
  /** @class */
  function(_super) {
    __extends$1x(HeaderRowComp2, _super);
    function HeaderRowComp2(ctrl) {
      var _this = _super.call(this) || this;
      _this.headerComps = {};
      var extraClass = ctrl.getType() == HeaderRowType.COLUMN_GROUP ? "ag-header-row-column-group" : ctrl.getType() == HeaderRowType.FLOATING_FILTER ? "ag-header-row-column-filter" : "ag-header-row-column";
      _this.setTemplate(
        /* html */
        '<div class="ag-header-row ' + extraClass + '" role="row"></div>'
      );
      _this.ctrl = ctrl;
      return _this;
    }
    HeaderRowComp2.prototype.init = function() {
      var _this = this;
      var compProxy = {
        setTransform: function(transform) {
          return _this.getGui().style.transform = transform;
        },
        setHeight: function(height) {
          return _this.getGui().style.height = height;
        },
        setTop: function(top) {
          return _this.getGui().style.top = top;
        },
        setHeaderCtrls: function(ctrls) {
          return _this.setHeaderCtrls(ctrls);
        },
        setWidth: function(width) {
          return _this.getGui().style.width = width;
        },
        setAriaRowIndex: function(rowIndex) {
          return setAriaRowIndex(_this.getGui(), rowIndex);
        }
      };
      this.ctrl.setComp(compProxy);
    };
    HeaderRowComp2.prototype.destroyHeaderCtrls = function() {
      this.setHeaderCtrls([]);
    };
    HeaderRowComp2.prototype.setHeaderCtrls = function(ctrls) {
      var _this = this;
      if (!this.isAlive()) {
        return;
      }
      var oldComps = this.headerComps;
      this.headerComps = {};
      ctrls.forEach(function(ctrl) {
        var id2 = ctrl.getInstanceId();
        var comp = oldComps[id2];
        delete oldComps[id2];
        if (comp == null) {
          comp = _this.createHeaderComp(ctrl);
          _this.getGui().appendChild(comp.getGui());
        }
        _this.headerComps[id2] = comp;
      });
      iterateObject(oldComps, function(id2, comp) {
        _this.getGui().removeChild(comp.getGui());
        _this.destroyBean(comp);
      });
      var isEnsureDomOrder = this.gridOptionsService.is("ensureDomOrder");
      var isPrintLayout = this.gridOptionsService.isDomLayout("print");
      if (isEnsureDomOrder || isPrintLayout) {
        var comps = getAllValuesInObject(this.headerComps);
        comps.sort(function(a, b) {
          var leftA = a.getCtrl().getColumnGroupChild().getLeft();
          var leftB = b.getCtrl().getColumnGroupChild().getLeft();
          return leftA - leftB;
        });
        var elementsInOrder = comps.map(function(c) {
          return c.getGui();
        });
        setDomChildOrder(this.getGui(), elementsInOrder);
      }
    };
    HeaderRowComp2.prototype.createHeaderComp = function(headerCtrl) {
      var result;
      switch (this.ctrl.getType()) {
        case HeaderRowType.COLUMN_GROUP:
          result = new HeaderGroupCellComp$1(headerCtrl);
          break;
        case HeaderRowType.FLOATING_FILTER:
          result = new HeaderFilterCellComp$1(headerCtrl);
          break;
        default:
          result = new HeaderCellComp$1(headerCtrl);
          break;
      }
      this.createBean(result);
      result.setParentComponent(this);
      return result;
    };
    __decorate$1t([
      PostConstruct
    ], HeaderRowComp2.prototype, "init", null);
    __decorate$1t([
      PreDestroy
    ], HeaderRowComp2.prototype, "destroyHeaderCtrls", null);
    return HeaderRowComp2;
  }(Component)
);
var __extends$1w = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1s = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var instanceIdSequence$1 = 0;
var AbstractHeaderCellCtrl = (
  /** @class */
  function(_super) {
    __extends$1w(AbstractHeaderCellCtrl2, _super);
    function AbstractHeaderCellCtrl2(columnGroupChild, parentRowCtrl) {
      var _this = _super.call(this) || this;
      _this.lastFocusEvent = null;
      _this.columnGroupChild = columnGroupChild;
      _this.parentRowCtrl = parentRowCtrl;
      _this.instanceId = columnGroupChild.getUniqueId() + "-" + instanceIdSequence$1++;
      return _this;
    }
    AbstractHeaderCellCtrl2.prototype.shouldStopEventPropagation = function(e) {
      var _a2 = this.focusService.getFocusedHeader(), headerRowIndex = _a2.headerRowIndex, column = _a2.column;
      return isUserSuppressingHeaderKeyboardEvent(this.gridOptionsService, e, headerRowIndex, column);
    };
    AbstractHeaderCellCtrl2.prototype.getWrapperHasFocus = function() {
      var eDocument = this.gridOptionsService.getDocument();
      var activeEl = eDocument.activeElement;
      return activeEl === this.eGui;
    };
    AbstractHeaderCellCtrl2.prototype.setGui = function(eGui) {
      this.eGui = eGui;
      this.addDomData();
    };
    AbstractHeaderCellCtrl2.prototype.handleKeyDown = function(e) {
      var wrapperHasFocus = this.getWrapperHasFocus();
      switch (e.key) {
        case KeyCode.PAGE_DOWN:
        case KeyCode.PAGE_UP:
        case KeyCode.PAGE_HOME:
        case KeyCode.PAGE_END:
          if (wrapperHasFocus) {
            e.preventDefault();
          }
      }
    };
    AbstractHeaderCellCtrl2.prototype.addDomData = function() {
      var _this = this;
      var key = AbstractHeaderCellCtrl2.DOM_DATA_KEY_HEADER_CTRL;
      this.gridOptionsService.setDomData(this.eGui, key, this);
      this.addDestroyFunc(function() {
        return _this.gridOptionsService.setDomData(_this.eGui, key, null);
      });
    };
    AbstractHeaderCellCtrl2.prototype.getGui = function() {
      return this.eGui;
    };
    AbstractHeaderCellCtrl2.prototype.focus = function(event) {
      if (!this.eGui) {
        return false;
      }
      this.lastFocusEvent = event || null;
      this.eGui.focus();
      return true;
    };
    AbstractHeaderCellCtrl2.prototype.getRowIndex = function() {
      return this.parentRowCtrl.getRowIndex();
    };
    AbstractHeaderCellCtrl2.prototype.getParentRowCtrl = function() {
      return this.parentRowCtrl;
    };
    AbstractHeaderCellCtrl2.prototype.getPinned = function() {
      return this.parentRowCtrl.getPinned();
    };
    AbstractHeaderCellCtrl2.prototype.getInstanceId = function() {
      return this.instanceId;
    };
    AbstractHeaderCellCtrl2.prototype.getColumnGroupChild = function() {
      return this.columnGroupChild;
    };
    AbstractHeaderCellCtrl2.DOM_DATA_KEY_HEADER_CTRL = "headerCtrl";
    __decorate$1s([
      Autowired("focusService")
    ], AbstractHeaderCellCtrl2.prototype, "focusService", void 0);
    __decorate$1s([
      Autowired("beans")
    ], AbstractHeaderCellCtrl2.prototype, "beans", void 0);
    __decorate$1s([
      Autowired("userComponentFactory")
    ], AbstractHeaderCellCtrl2.prototype, "userComponentFactory", void 0);
    return AbstractHeaderCellCtrl2;
  }(BeanStub)
);
var __extends$1v = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1r = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SetLeftFeature = (
  /** @class */
  function(_super) {
    __extends$1v(SetLeftFeature2, _super);
    function SetLeftFeature2(columnOrGroup, eCell, beans, colsSpanning) {
      var _this = _super.call(this) || this;
      _this.columnOrGroup = columnOrGroup;
      _this.eCell = eCell;
      _this.ariaEl = _this.eCell.querySelector("[role=columnheader]") || _this.eCell;
      _this.colsSpanning = colsSpanning;
      _this.beans = beans;
      return _this;
    }
    SetLeftFeature2.prototype.setColsSpanning = function(colsSpanning) {
      this.colsSpanning = colsSpanning;
      this.onLeftChanged();
    };
    SetLeftFeature2.prototype.getColumnOrGroup = function() {
      if (this.beans.gridOptionsService.is("enableRtl") && this.colsSpanning) {
        return last(this.colsSpanning);
      }
      return this.columnOrGroup;
    };
    SetLeftFeature2.prototype.postConstruct = function() {
      this.addManagedListener(this.columnOrGroup, Column.EVENT_LEFT_CHANGED, this.onLeftChanged.bind(this));
      this.setLeftFirstTime();
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, this.onLeftChanged.bind(this));
      this.addManagedPropertyListener("domLayout", this.onLeftChanged.bind(this));
    };
    SetLeftFeature2.prototype.setLeftFirstTime = function() {
      var suppressMoveAnimation = this.beans.gridOptionsService.is("suppressColumnMoveAnimation");
      var oldLeftExists = exists(this.columnOrGroup.getOldLeft());
      var animateColumnMove = this.beans.columnAnimationService.isActive() && oldLeftExists && !suppressMoveAnimation;
      if (animateColumnMove) {
        this.animateInLeft();
      } else {
        this.onLeftChanged();
      }
    };
    SetLeftFeature2.prototype.animateInLeft = function() {
      var _this = this;
      var colOrGroup = this.getColumnOrGroup();
      var left = colOrGroup.getLeft();
      var oldLeft = colOrGroup.getOldLeft();
      var oldActualLeft = this.modifyLeftForPrintLayout(colOrGroup, oldLeft);
      var actualLeft = this.modifyLeftForPrintLayout(colOrGroup, left);
      this.setLeft(oldActualLeft);
      this.actualLeft = actualLeft;
      this.beans.columnAnimationService.executeNextVMTurn(function() {
        if (_this.actualLeft === actualLeft) {
          _this.setLeft(actualLeft);
        }
      });
    };
    SetLeftFeature2.prototype.onLeftChanged = function() {
      var colOrGroup = this.getColumnOrGroup();
      var left = colOrGroup.getLeft();
      this.actualLeft = this.modifyLeftForPrintLayout(colOrGroup, left);
      this.setLeft(this.actualLeft);
    };
    SetLeftFeature2.prototype.modifyLeftForPrintLayout = function(colOrGroup, leftPosition) {
      var printLayout = this.beans.gridOptionsService.isDomLayout("print");
      if (!printLayout) {
        return leftPosition;
      }
      if (colOrGroup.getPinned() === "left") {
        return leftPosition;
      }
      var leftWidth = this.beans.columnModel.getDisplayedColumnsLeftWidth();
      if (colOrGroup.getPinned() === "right") {
        var bodyWidth = this.beans.columnModel.getBodyContainerWidth();
        return leftWidth + bodyWidth + leftPosition;
      }
      return leftWidth + leftPosition;
    };
    SetLeftFeature2.prototype.setLeft = function(value) {
      if (exists(value)) {
        this.eCell.style.left = value + "px";
      }
      var indexColumn;
      if (this.columnOrGroup instanceof Column) {
        indexColumn = this.columnOrGroup;
      } else {
        var columnGroup = this.columnOrGroup;
        var children = columnGroup.getLeafColumns();
        if (!children.length) {
          return;
        }
        if (children.length > 1) {
          setAriaColSpan(this.ariaEl, children.length);
        }
        indexColumn = children[0];
      }
      var index2 = this.beans.columnModel.getAriaColumnIndex(indexColumn);
      setAriaColIndex(this.ariaEl, index2);
    };
    __decorate$1r([
      PostConstruct
    ], SetLeftFeature2.prototype, "postConstruct", null);
    return SetLeftFeature2;
  }(BeanStub)
);
var __extends$1u = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1q = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HoverFeature = (
  /** @class */
  function(_super) {
    __extends$1u(HoverFeature2, _super);
    function HoverFeature2(columns, element) {
      var _this = _super.call(this) || this;
      _this.columns = columns;
      _this.element = element;
      return _this;
    }
    HoverFeature2.prototype.postConstruct = function() {
      if (this.gridOptionsService.is("columnHoverHighlight")) {
        this.addMouseHoverListeners();
      }
    };
    HoverFeature2.prototype.addMouseHoverListeners = function() {
      this.addManagedListener(this.element, "mouseout", this.onMouseOut.bind(this));
      this.addManagedListener(this.element, "mouseover", this.onMouseOver.bind(this));
    };
    HoverFeature2.prototype.onMouseOut = function() {
      this.columnHoverService.clearMouseOver();
    };
    HoverFeature2.prototype.onMouseOver = function() {
      this.columnHoverService.setMouseOver(this.columns);
    };
    __decorate$1q([
      Autowired("columnHoverService")
    ], HoverFeature2.prototype, "columnHoverService", void 0);
    __decorate$1q([
      PostConstruct
    ], HoverFeature2.prototype, "postConstruct", null);
    return HoverFeature2;
  }(BeanStub)
);
var __extends$1t = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1p = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderFilterCellCtrl = (
  /** @class */
  function(_super) {
    __extends$1t(HeaderFilterCellCtrl2, _super);
    function HeaderFilterCellCtrl2(column, parentRowCtrl) {
      var _this = _super.call(this, column, parentRowCtrl) || this;
      _this.iconCreated = false;
      _this.column = column;
      return _this;
    }
    HeaderFilterCellCtrl2.prototype.setComp = function(comp, eGui, eButtonShowMainFilter, eFloatingFilterBody) {
      _super.prototype.setGui.call(this, eGui);
      this.comp = comp;
      this.eButtonShowMainFilter = eButtonShowMainFilter;
      this.eFloatingFilterBody = eFloatingFilterBody;
      this.setupActive();
      this.setupWidth();
      this.setupLeft();
      this.setupHover();
      this.setupFocus();
      this.setupAria();
      this.setupFilterButton();
      this.setupUserComp();
      this.setupSyncWithFilter();
      this.setupUi();
      this.addManagedListener(this.eButtonShowMainFilter, "click", this.showParentFilter.bind(this));
      this.setupFilterChangedListener();
      this.addManagedListener(this.column, Column.EVENT_COL_DEF_CHANGED, this.onColDefChanged.bind(this));
    };
    HeaderFilterCellCtrl2.prototype.setupActive = function() {
      var colDef = this.column.getColDef();
      var filterExists = !!colDef.filter;
      var floatingFilterExists = !!colDef.floatingFilter;
      this.active = filterExists && floatingFilterExists;
    };
    HeaderFilterCellCtrl2.prototype.setupUi = function() {
      this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton && this.active);
      this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body", this.suppressFilterButton);
      this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body", !this.suppressFilterButton);
      if (!this.active || this.iconCreated) {
        return;
      }
      var eMenuIcon = createIconNoSpan("filter", this.gridOptionsService, this.column);
      if (eMenuIcon) {
        this.iconCreated = true;
        this.eButtonShowMainFilter.appendChild(eMenuIcon);
      }
    };
    HeaderFilterCellCtrl2.prototype.setupFocus = function() {
      this.createManagedBean(new ManagedFocusFeature(this.eGui, {
        shouldStopEventPropagation: this.shouldStopEventPropagation.bind(this),
        onTabKeyDown: this.onTabKeyDown.bind(this),
        handleKeyDown: this.handleKeyDown.bind(this),
        onFocusIn: this.onFocusIn.bind(this)
      }));
    };
    HeaderFilterCellCtrl2.prototype.setupAria = function() {
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      setAriaLabel(this.eButtonShowMainFilter, localeTextFunc("ariaFilterMenuOpen", "Open Filter Menu"));
    };
    HeaderFilterCellCtrl2.prototype.onTabKeyDown = function(e) {
      var eDocument = this.gridOptionsService.getDocument();
      var activeEl = eDocument.activeElement;
      var wrapperHasFocus = activeEl === this.eGui;
      if (wrapperHasFocus) {
        return;
      }
      var nextFocusableEl = this.focusService.findNextFocusableElement(this.eGui, null, e.shiftKey);
      if (nextFocusableEl) {
        this.beans.headerNavigationService.scrollToColumn(this.column);
        e.preventDefault();
        nextFocusableEl.focus();
        return;
      }
      var nextFocusableColumn = this.findNextColumnWithFloatingFilter(e.shiftKey);
      if (!nextFocusableColumn) {
        return;
      }
      if (this.focusService.focusHeaderPosition({
        headerPosition: {
          headerRowIndex: this.getParentRowCtrl().getRowIndex(),
          column: nextFocusableColumn
        },
        event: e
      })) {
        e.preventDefault();
      }
    };
    HeaderFilterCellCtrl2.prototype.findNextColumnWithFloatingFilter = function(backwards) {
      var columModel = this.beans.columnModel;
      var nextCol = this.column;
      do {
        nextCol = backwards ? columModel.getDisplayedColBefore(nextCol) : columModel.getDisplayedColAfter(nextCol);
        if (!nextCol) {
          break;
        }
      } while (!nextCol.getColDef().filter || !nextCol.getColDef().floatingFilter);
      return nextCol;
    };
    HeaderFilterCellCtrl2.prototype.handleKeyDown = function(e) {
      _super.prototype.handleKeyDown.call(this, e);
      var wrapperHasFocus = this.getWrapperHasFocus();
      switch (e.key) {
        case KeyCode.UP:
        case KeyCode.DOWN:
          if (!wrapperHasFocus) {
            e.preventDefault();
          }
        case KeyCode.LEFT:
        case KeyCode.RIGHT:
          if (wrapperHasFocus) {
            return;
          }
          e.stopPropagation();
        case KeyCode.ENTER:
          if (wrapperHasFocus) {
            if (this.focusService.focusInto(this.eGui)) {
              e.preventDefault();
            }
          }
          break;
        case KeyCode.ESCAPE:
          if (!wrapperHasFocus) {
            this.eGui.focus();
          }
      }
    };
    HeaderFilterCellCtrl2.prototype.onFocusIn = function(e) {
      var isRelatedWithin = this.eGui.contains(e.relatedTarget);
      if (isRelatedWithin) {
        return;
      }
      var notFromHeaderWrapper = !!e.relatedTarget && !e.relatedTarget.classList.contains("ag-floating-filter");
      var fromWithinHeader = !!e.relatedTarget && isElementChildOfClass(e.relatedTarget, "ag-floating-filter");
      if (notFromHeaderWrapper && fromWithinHeader && e.target === this.eGui) {
        var lastFocusEvent = this.lastFocusEvent;
        var fromTab = !!(lastFocusEvent && lastFocusEvent.key === KeyCode.TAB);
        if (lastFocusEvent && fromTab) {
          var shouldFocusLast = lastFocusEvent.shiftKey;
          this.focusService.focusInto(this.eGui, shouldFocusLast);
        }
      }
      var rowIndex = this.getRowIndex();
      this.beans.focusService.setFocusedHeader(rowIndex, this.column);
    };
    HeaderFilterCellCtrl2.prototype.setupHover = function() {
      var _this = this;
      this.createManagedBean(new HoverFeature([this.column], this.eGui));
      var listener = function() {
        if (!_this.gridOptionsService.is("columnHoverHighlight")) {
          return;
        }
        var hovered = _this.columnHoverService.isHovered(_this.column);
        _this.comp.addOrRemoveCssClass("ag-column-hover", hovered);
      };
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_HOVER_CHANGED, listener);
      listener();
    };
    HeaderFilterCellCtrl2.prototype.setupLeft = function() {
      var setLeftFeature = new SetLeftFeature(this.column, this.eGui, this.beans);
      this.createManagedBean(setLeftFeature);
    };
    HeaderFilterCellCtrl2.prototype.setupFilterButton = function() {
      var colDef = this.column.getColDef();
      this.suppressFilterButton = colDef.floatingFilterComponentParams ? !!colDef.floatingFilterComponentParams.suppressFilterButton : false;
    };
    HeaderFilterCellCtrl2.prototype.setupUserComp = function() {
      var _this = this;
      if (!this.active) {
        return;
      }
      var compDetails = this.filterManager.getFloatingFilterCompDetails(this.column, function() {
        return _this.showParentFilter();
      });
      if (compDetails) {
        this.setCompDetails(compDetails);
      }
    };
    HeaderFilterCellCtrl2.prototype.setCompDetails = function(compDetails) {
      this.userCompDetails = compDetails;
      this.comp.setCompDetails(compDetails);
    };
    HeaderFilterCellCtrl2.prototype.showParentFilter = function() {
      var eventSource = this.suppressFilterButton ? this.eFloatingFilterBody : this.eButtonShowMainFilter;
      this.menuFactory.showMenuAfterButtonClick(this.column, eventSource, "floatingFilter", "filterMenuTab", ["filterMenuTab"]);
    };
    HeaderFilterCellCtrl2.prototype.setupSyncWithFilter = function() {
      var _this = this;
      if (!this.active) {
        return;
      }
      var syncWithFilter = function(filterChangedEvent) {
        var compPromise = _this.comp.getFloatingFilterComp();
        if (!compPromise) {
          return;
        }
        compPromise.then(function(comp) {
          if (comp) {
            var parentModel = _this.filterManager.getCurrentFloatingFilterParentModel(_this.column);
            comp.onParentModelChanged(parentModel, filterChangedEvent);
          }
        });
      };
      this.destroySyncListener = this.addManagedListener(this.column, Column.EVENT_FILTER_CHANGED, syncWithFilter);
      if (this.filterManager.isFilterActive(this.column)) {
        syncWithFilter(null);
      }
    };
    HeaderFilterCellCtrl2.prototype.setupWidth = function() {
      var _this = this;
      var listener = function() {
        var width = _this.column.getActualWidth() + "px";
        _this.comp.setWidth(width);
      };
      this.addManagedListener(this.column, Column.EVENT_WIDTH_CHANGED, listener);
      listener();
    };
    HeaderFilterCellCtrl2.prototype.setupFilterChangedListener = function() {
      if (this.active) {
        this.destroyFilterChangedListener = this.addManagedListener(this.column, Column.EVENT_FILTER_CHANGED, this.updateFilterButton.bind(this));
      }
    };
    HeaderFilterCellCtrl2.prototype.updateFilterButton = function() {
      if (!this.suppressFilterButton && this.comp) {
        this.comp.setButtonWrapperDisplayed(this.filterManager.isFilterAllowed(this.column));
      }
    };
    HeaderFilterCellCtrl2.prototype.onColDefChanged = function() {
      var _this = this;
      var _a2, _b2;
      var wasActive = this.active;
      this.setupActive();
      var becomeActive = !wasActive && this.active;
      if (wasActive && !this.active) {
        (_a2 = this.destroySyncListener) === null || _a2 === void 0 ? void 0 : _a2.call(this);
        (_b2 = this.destroyFilterChangedListener) === null || _b2 === void 0 ? void 0 : _b2.call(this);
      }
      var newCompDetails = this.active ? this.filterManager.getFloatingFilterCompDetails(this.column, function() {
        return _this.showParentFilter();
      }) : null;
      var compPromise = this.comp.getFloatingFilterComp();
      if (!compPromise || !newCompDetails) {
        this.updateCompDetails(newCompDetails, becomeActive);
      } else {
        compPromise.then(function(compInstance) {
          var _a3;
          if (!compInstance || ((_a3 = _this.userCompDetails) === null || _a3 === void 0 ? void 0 : _a3.componentClass) !== newCompDetails.componentClass) {
            _this.updateCompDetails(newCompDetails, becomeActive);
          }
        });
      }
    };
    HeaderFilterCellCtrl2.prototype.updateCompDetails = function(compDetails, becomeActive) {
      this.setCompDetails(compDetails);
      this.setupFilterButton();
      this.setupUi();
      if (becomeActive) {
        this.setupSyncWithFilter();
        this.setupFilterChangedListener();
      }
    };
    __decorate$1p([
      Autowired("filterManager")
    ], HeaderFilterCellCtrl2.prototype, "filterManager", void 0);
    __decorate$1p([
      Autowired("columnHoverService")
    ], HeaderFilterCellCtrl2.prototype, "columnHoverService", void 0);
    __decorate$1p([
      Autowired("menuFactory")
    ], HeaderFilterCellCtrl2.prototype, "menuFactory", void 0);
    return HeaderFilterCellCtrl2;
  }(AbstractHeaderCellCtrl)
);
var __extends$1s = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1o = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ResizeFeature = (
  /** @class */
  function(_super) {
    __extends$1s(ResizeFeature2, _super);
    function ResizeFeature2(pinned, column, eResize, comp, ctrl) {
      var _this = _super.call(this) || this;
      _this.pinned = pinned;
      _this.column = column;
      _this.eResize = eResize;
      _this.comp = comp;
      _this.ctrl = ctrl;
      return _this;
    }
    ResizeFeature2.prototype.postConstruct = function() {
      var _this = this;
      var colDef = this.column.getColDef();
      var destroyResizeFuncs = [];
      var canResize;
      var canAutosize;
      var addResize = function() {
        setDisplayed(_this.eResize, canResize);
        if (!canResize) {
          return;
        }
        var finishedWithResizeFunc = _this.horizontalResizeService.addResizeBar({
          eResizeBar: _this.eResize,
          onResizeStart: _this.onResizeStart.bind(_this),
          onResizing: _this.onResizing.bind(_this, false),
          onResizeEnd: _this.onResizing.bind(_this, true)
        });
        destroyResizeFuncs.push(finishedWithResizeFunc);
        if (canAutosize) {
          var skipHeaderOnAutoSize_1 = _this.gridOptionsService.is("skipHeaderOnAutoSize");
          var autoSizeColListener_1 = function() {
            _this.columnModel.autoSizeColumn(_this.column, skipHeaderOnAutoSize_1, "uiColumnResized");
          };
          _this.eResize.addEventListener("dblclick", autoSizeColListener_1);
          var touchListener_1 = new TouchListener(_this.eResize);
          touchListener_1.addEventListener(TouchListener.EVENT_DOUBLE_TAP, autoSizeColListener_1);
          _this.addDestroyFunc(function() {
            _this.eResize.removeEventListener("dblclick", autoSizeColListener_1);
            touchListener_1.removeEventListener(TouchListener.EVENT_DOUBLE_TAP, autoSizeColListener_1);
            touchListener_1.destroy();
          });
        }
      };
      var removeResize = function() {
        destroyResizeFuncs.forEach(function(f2) {
          return f2();
        });
        destroyResizeFuncs.length = 0;
      };
      var refresh = function() {
        var resize = _this.column.isResizable();
        var autoSize = !_this.gridOptionsService.is("suppressAutoSize") && !colDef.suppressAutoSize;
        var propertyChange = resize !== canResize || autoSize !== canAutosize;
        if (propertyChange) {
          canResize = resize;
          canAutosize = autoSize;
          removeResize();
          addResize();
        }
      };
      refresh();
      this.addDestroyFunc(removeResize);
      this.ctrl.addRefreshFunction(refresh);
    };
    ResizeFeature2.prototype.onResizing = function(finished, resizeAmount) {
      var resizeAmountNormalised = this.normaliseResizeAmount(resizeAmount);
      var columnWidths = [{ key: this.column, newWidth: this.resizeStartWidth + resizeAmountNormalised }];
      this.columnModel.setColumnWidths(columnWidths, this.resizeWithShiftKey, finished, "uiColumnResized");
      if (finished) {
        this.comp.addOrRemoveCssClass("ag-column-resizing", false);
      }
    };
    ResizeFeature2.prototype.onResizeStart = function(shiftKey) {
      this.resizeStartWidth = this.column.getActualWidth();
      this.resizeWithShiftKey = shiftKey;
      this.comp.addOrRemoveCssClass("ag-column-resizing", true);
    };
    ResizeFeature2.prototype.normaliseResizeAmount = function(dragChange) {
      var result = dragChange;
      var notPinningLeft = this.pinned !== "left";
      var pinningRight = this.pinned === "right";
      if (this.gridOptionsService.is("enableRtl")) {
        if (notPinningLeft) {
          result *= -1;
        }
      } else {
        if (pinningRight) {
          result *= -1;
        }
      }
      return result;
    };
    __decorate$1o([
      Autowired("horizontalResizeService")
    ], ResizeFeature2.prototype, "horizontalResizeService", void 0);
    __decorate$1o([
      Autowired("columnModel")
    ], ResizeFeature2.prototype, "columnModel", void 0);
    __decorate$1o([
      PostConstruct
    ], ResizeFeature2.prototype, "postConstruct", null);
    return ResizeFeature2;
  }(BeanStub)
);
var __extends$1r = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1n = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SelectAllFeature = (
  /** @class */
  function(_super) {
    __extends$1r(SelectAllFeature2, _super);
    function SelectAllFeature2(column) {
      var _this = _super.call(this) || this;
      _this.cbSelectAllVisible = false;
      _this.processingEventFromCheckbox = false;
      _this.column = column;
      var colDef = column.getColDef();
      _this.filteredOnly = !!(colDef === null || colDef === void 0 ? void 0 : colDef.headerCheckboxSelectionFilteredOnly);
      _this.currentPageOnly = !!(colDef === null || colDef === void 0 ? void 0 : colDef.headerCheckboxSelectionCurrentPageOnly);
      return _this;
    }
    SelectAllFeature2.prototype.onSpaceKeyDown = function(e) {
      var checkbox = this.cbSelectAll;
      var eDocument = this.gridOptionsService.getDocument();
      if (checkbox.isDisplayed() && !checkbox.getGui().contains(eDocument.activeElement)) {
        e.preventDefault();
        checkbox.setValue(!checkbox.getValue());
      }
    };
    SelectAllFeature2.prototype.getCheckboxGui = function() {
      return this.cbSelectAll.getGui();
    };
    SelectAllFeature2.prototype.setComp = function(ctrl) {
      this.headerCellCtrl = ctrl;
      this.cbSelectAll = this.createManagedBean(new AgCheckbox());
      this.cbSelectAll.addCssClass("ag-header-select-all");
      setAriaRole(this.cbSelectAll.getGui(), "presentation");
      this.showOrHideSelectAll();
      this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.showOrHideSelectAll.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.showOrHideSelectAll.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_SELECTION_CHANGED, this.onSelectionChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_PAGINATION_CHANGED, this.onSelectionChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_MODEL_UPDATED, this.onModelChanged.bind(this));
      this.addManagedListener(this.cbSelectAll, AgCheckbox.EVENT_CHANGED, this.onCbSelectAll.bind(this));
      setAriaHidden(this.cbSelectAll.getGui(), true);
      this.cbSelectAll.getInputElement().setAttribute("tabindex", "-1");
      this.refreshSelectAllLabel();
    };
    SelectAllFeature2.prototype.showOrHideSelectAll = function() {
      this.cbSelectAllVisible = this.isCheckboxSelection();
      this.cbSelectAll.setDisplayed(this.cbSelectAllVisible, { skipAriaHidden: true });
      if (this.cbSelectAllVisible) {
        this.checkRightRowModelType("selectAllCheckbox");
        this.updateStateOfCheckbox();
      }
      this.refreshSelectAllLabel();
    };
    SelectAllFeature2.prototype.onModelChanged = function() {
      if (!this.cbSelectAllVisible) {
        return;
      }
      this.updateStateOfCheckbox();
    };
    SelectAllFeature2.prototype.onSelectionChanged = function() {
      if (!this.cbSelectAllVisible) {
        return;
      }
      this.updateStateOfCheckbox();
    };
    SelectAllFeature2.prototype.updateStateOfCheckbox = function() {
      if (this.processingEventFromCheckbox) {
        return;
      }
      this.processingEventFromCheckbox = true;
      var allSelected = this.selectionService.getSelectAllState(this.filteredOnly, this.currentPageOnly);
      this.cbSelectAll.setValue(allSelected);
      this.refreshSelectAllLabel();
      this.processingEventFromCheckbox = false;
    };
    SelectAllFeature2.prototype.refreshSelectAllLabel = function() {
      var translate = this.localeService.getLocaleTextFunc();
      var checked = this.cbSelectAll.getValue();
      var ariaStatus = checked ? translate("ariaChecked", "checked") : translate("ariaUnchecked", "unchecked");
      var ariaLabel = translate("ariaRowSelectAll", "Press Space to toggle all rows selection");
      if (!this.cbSelectAllVisible) {
        this.headerCellCtrl.setAriaDescriptionProperty("selectAll", null);
      } else {
        this.headerCellCtrl.setAriaDescriptionProperty("selectAll", ariaLabel + " (" + ariaStatus + ")");
      }
      this.cbSelectAll.setInputAriaLabel(ariaLabel + " (" + ariaStatus + ")");
      this.headerCellCtrl.refreshAriaDescription();
    };
    SelectAllFeature2.prototype.checkRightRowModelType = function(feature) {
      var rowModelType = this.rowModel.getType();
      var rowModelMatches = rowModelType === "clientSide" || rowModelType === "serverSide";
      if (!rowModelMatches) {
        console.warn("AG Grid: " + feature + " is only available if using 'clientSide' or 'serverSide' rowModelType, you are using " + rowModelType + ".");
        return false;
      }
      return true;
    };
    SelectAllFeature2.prototype.onCbSelectAll = function() {
      if (this.processingEventFromCheckbox) {
        return;
      }
      if (!this.cbSelectAllVisible) {
        return;
      }
      var value = this.cbSelectAll.getValue();
      var source = "uiSelectAll";
      if (this.currentPageOnly)
        source = "uiSelectAllCurrentPage";
      else if (this.filteredOnly)
        source = "uiSelectAllFiltered";
      var params = {
        source,
        justFiltered: this.filteredOnly,
        justCurrentPage: this.currentPageOnly
      };
      if (value) {
        this.selectionService.selectAllRowNodes(params);
      } else {
        this.selectionService.deselectAllRowNodes(params);
      }
    };
    SelectAllFeature2.prototype.isCheckboxSelection = function() {
      var result = this.column.getColDef().headerCheckboxSelection;
      if (typeof result === "function") {
        var func = result;
        var params = {
          column: this.column,
          colDef: this.column.getColDef(),
          columnApi: this.columnApi,
          api: this.gridApi,
          context: this.gridOptionsService.context
        };
        result = func(params);
      }
      if (result) {
        return this.checkRightRowModelType("headerCheckboxSelection");
      }
      return false;
    };
    __decorate$1n([
      Autowired("gridApi")
    ], SelectAllFeature2.prototype, "gridApi", void 0);
    __decorate$1n([
      Autowired("columnApi")
    ], SelectAllFeature2.prototype, "columnApi", void 0);
    __decorate$1n([
      Autowired("rowModel")
    ], SelectAllFeature2.prototype, "rowModel", void 0);
    __decorate$1n([
      Autowired("selectionService")
    ], SelectAllFeature2.prototype, "selectionService", void 0);
    return SelectAllFeature2;
  }(BeanStub)
);
var __extends$1q = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1m = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var TabGuardClassNames;
(function(TabGuardClassNames2) {
  TabGuardClassNames2["TAB_GUARD"] = "ag-tab-guard";
  TabGuardClassNames2["TAB_GUARD_TOP"] = "ag-tab-guard-top";
  TabGuardClassNames2["TAB_GUARD_BOTTOM"] = "ag-tab-guard-bottom";
})(TabGuardClassNames || (TabGuardClassNames = {}));
var TabGuardCtrl = (
  /** @class */
  function(_super) {
    __extends$1q(TabGuardCtrl2, _super);
    function TabGuardCtrl2(params) {
      var _this = _super.call(this) || this;
      _this.skipTabGuardFocus = false;
      var comp = params.comp, eTopGuard = params.eTopGuard, eBottomGuard = params.eBottomGuard, focusInnerElement = params.focusInnerElement, onFocusIn = params.onFocusIn, onFocusOut = params.onFocusOut, shouldStopEventPropagation = params.shouldStopEventPropagation, onTabKeyDown = params.onTabKeyDown, handleKeyDown = params.handleKeyDown, eFocusableElement = params.eFocusableElement;
      _this.comp = comp;
      _this.eTopGuard = eTopGuard;
      _this.eBottomGuard = eBottomGuard;
      _this.providedFocusInnerElement = focusInnerElement;
      _this.eFocusableElement = eFocusableElement;
      _this.providedFocusIn = onFocusIn;
      _this.providedFocusOut = onFocusOut;
      _this.providedShouldStopEventPropagation = shouldStopEventPropagation;
      _this.providedOnTabKeyDown = onTabKeyDown;
      _this.providedHandleKeyDown = handleKeyDown;
      return _this;
    }
    TabGuardCtrl2.prototype.postConstruct = function() {
      var _this = this;
      this.createManagedBean(new ManagedFocusFeature(this.eFocusableElement, {
        shouldStopEventPropagation: function() {
          return _this.shouldStopEventPropagation();
        },
        onTabKeyDown: function(e) {
          return _this.onTabKeyDown(e);
        },
        handleKeyDown: function(e) {
          return _this.handleKeyDown(e);
        },
        onFocusIn: function(e) {
          return _this.onFocusIn(e);
        },
        onFocusOut: function(e) {
          return _this.onFocusOut(e);
        }
      }));
      this.activateTabGuards();
      [this.eTopGuard, this.eBottomGuard].forEach(function(guard) {
        return _this.addManagedListener(guard, "focus", _this.onFocus.bind(_this));
      });
    };
    TabGuardCtrl2.prototype.handleKeyDown = function(e) {
      if (this.providedHandleKeyDown) {
        this.providedHandleKeyDown(e);
      }
    };
    TabGuardCtrl2.prototype.tabGuardsAreActive = function() {
      return !!this.eTopGuard && this.eTopGuard.hasAttribute("tabIndex");
    };
    TabGuardCtrl2.prototype.shouldStopEventPropagation = function() {
      if (this.providedShouldStopEventPropagation) {
        return this.providedShouldStopEventPropagation();
      }
      return false;
    };
    TabGuardCtrl2.prototype.activateTabGuards = function() {
      var tabIndex = this.gridOptionsService.getNum("tabIndex") || 0;
      this.comp.setTabIndex(tabIndex.toString());
    };
    TabGuardCtrl2.prototype.deactivateTabGuards = function() {
      this.comp.setTabIndex();
    };
    TabGuardCtrl2.prototype.onFocus = function(e) {
      if (this.skipTabGuardFocus) {
        this.skipTabGuardFocus = false;
        return;
      }
      var fromBottom = e.target === this.eBottomGuard;
      if (this.providedFocusInnerElement) {
        this.providedFocusInnerElement(fromBottom);
      } else {
        this.focusInnerElement(fromBottom);
      }
    };
    TabGuardCtrl2.prototype.onFocusIn = function(e) {
      if (this.providedFocusIn && this.providedFocusIn(e)) {
        return;
      }
      this.deactivateTabGuards();
    };
    TabGuardCtrl2.prototype.onFocusOut = function(e) {
      if (this.providedFocusOut && this.providedFocusOut(e)) {
        return;
      }
      if (!this.eFocusableElement.contains(e.relatedTarget)) {
        this.activateTabGuards();
      }
    };
    TabGuardCtrl2.prototype.onTabKeyDown = function(e) {
      var _this = this;
      if (this.providedOnTabKeyDown) {
        this.providedOnTabKeyDown(e);
        return;
      }
      if (e.defaultPrevented) {
        return;
      }
      var tabGuardsAreActive = this.tabGuardsAreActive();
      if (tabGuardsAreActive) {
        this.deactivateTabGuards();
      }
      var nextRoot = this.getNextFocusableElement(e.shiftKey);
      if (tabGuardsAreActive) {
        setTimeout(function() {
          return _this.activateTabGuards();
        }, 0);
      }
      if (!nextRoot) {
        return;
      }
      nextRoot.focus();
      e.preventDefault();
    };
    TabGuardCtrl2.prototype.focusInnerElement = function(fromBottom) {
      if (fromBottom === void 0) {
        fromBottom = false;
      }
      var focusable = this.focusService.findFocusableElements(this.eFocusableElement);
      if (this.tabGuardsAreActive()) {
        focusable.splice(0, 1);
        focusable.splice(focusable.length - 1, 1);
      }
      if (!focusable.length) {
        return;
      }
      focusable[fromBottom ? focusable.length - 1 : 0].focus({ preventScroll: true });
    };
    TabGuardCtrl2.prototype.getNextFocusableElement = function(backwards) {
      return this.focusService.findNextFocusableElement(this.eFocusableElement, false, backwards);
    };
    TabGuardCtrl2.prototype.forceFocusOutOfContainer = function(up) {
      if (up === void 0) {
        up = false;
      }
      var tabGuardToFocus = up ? this.eTopGuard : this.eBottomGuard;
      this.activateTabGuards();
      this.skipTabGuardFocus = true;
      tabGuardToFocus.focus();
    };
    __decorate$1m([
      Autowired("focusService")
    ], TabGuardCtrl2.prototype, "focusService", void 0);
    __decorate$1m([
      PostConstruct
    ], TabGuardCtrl2.prototype, "postConstruct", null);
    return TabGuardCtrl2;
  }(BeanStub)
);
var __extends$1p = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$6$1 = function() {
  __assign$6$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$6$1.apply(this, arguments);
};
var __decorate$1l = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$g = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$e = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var FocusService = (
  /** @class */
  function(_super) {
    __extends$1p(FocusService2, _super);
    function FocusService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    FocusService_1 = FocusService2;
    FocusService2.addKeyboardModeEvents = function(doc, controller) {
      var docControllers = FocusService_1.instancesMonitored.get(doc);
      if (docControllers && docControllers.length > 0) {
        if (docControllers.indexOf(controller) === -1) {
          docControllers.push(controller);
        }
      } else {
        FocusService_1.instancesMonitored.set(doc, [controller]);
        doc.addEventListener("keydown", FocusService_1.toggleKeyboardMode);
        doc.addEventListener("mousedown", FocusService_1.toggleKeyboardMode);
      }
    };
    FocusService2.removeKeyboardModeEvents = function(doc, controller) {
      var docControllers = FocusService_1.instancesMonitored.get(doc);
      var newControllers = [];
      if (docControllers && docControllers.length) {
        newControllers = __spreadArray$e([], __read$g(docControllers)).filter(function(currentGridCore) {
          return currentGridCore !== controller;
        });
        FocusService_1.instancesMonitored.set(doc, newControllers);
      }
      if (newControllers.length === 0) {
        doc.removeEventListener("keydown", FocusService_1.toggleKeyboardMode);
        doc.removeEventListener("mousedown", FocusService_1.toggleKeyboardMode);
      }
    };
    FocusService2.toggleKeyboardMode = function(event) {
      var isKeyboardActive = FocusService_1.keyboardModeActive;
      var isKeyboardEvent = event.type === "keydown";
      if (isKeyboardEvent) {
        if (event.ctrlKey || event.metaKey || event.altKey) {
          return;
        }
      }
      if (isKeyboardActive && isKeyboardEvent || !isKeyboardActive && !isKeyboardEvent) {
        return;
      }
      FocusService_1.keyboardModeActive = isKeyboardEvent;
      var doc = event.target.ownerDocument;
      if (!doc) {
        return;
      }
      var controllersForDoc = FocusService_1.instancesMonitored.get(doc);
      if (controllersForDoc) {
        controllersForDoc.forEach(function(controller) {
          controller.dispatchEvent({ type: isKeyboardEvent ? Events.EVENT_KEYBOARD_FOCUS : Events.EVENT_MOUSE_FOCUS });
        });
      }
    };
    FocusService2.prototype.init = function() {
      var _this = this;
      var clearFocusedCellListener = this.clearFocusedCell.bind(this);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_MODE_CHANGED, clearFocusedCellListener);
      this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.onColumnEverythingChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_GROUP_OPENED, clearFocusedCellListener);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, clearFocusedCellListener);
      this.ctrlsService.whenReady(function(p2) {
        _this.gridCtrl = p2.gridCtrl;
        var doc = _this.gridOptionsService.getDocument();
        FocusService_1.addKeyboardModeEvents(doc, _this.gridCtrl);
        _this.addDestroyFunc(function() {
          return _this.unregisterGridCompController(_this.gridCtrl);
        });
      });
    };
    FocusService2.prototype.unregisterGridCompController = function(gridCompController) {
      var doc = this.gridOptionsService.getDocument();
      FocusService_1.removeKeyboardModeEvents(doc, gridCompController);
    };
    FocusService2.prototype.onColumnEverythingChanged = function() {
      if (!this.focusedCellPosition) {
        return;
      }
      var col = this.focusedCellPosition.column;
      var colFromColumnModel = this.columnModel.getGridColumn(col.getId());
      if (col !== colFromColumnModel) {
        this.clearFocusedCell();
      }
    };
    FocusService2.prototype.isKeyboardMode = function() {
      return FocusService_1.keyboardModeActive;
    };
    FocusService2.prototype.getFocusCellToUseAfterRefresh = function() {
      var eDocument = this.gridOptionsService.getDocument();
      if (this.gridOptionsService.is("suppressFocusAfterRefresh") || !this.focusedCellPosition) {
        return null;
      }
      if (this.isDomDataMissingInHierarchy(eDocument.activeElement, RowCtrl.DOM_DATA_KEY_ROW_CTRL)) {
        return null;
      }
      return this.focusedCellPosition;
    };
    FocusService2.prototype.getFocusHeaderToUseAfterRefresh = function() {
      var eDocument = this.gridOptionsService.getDocument();
      if (this.gridOptionsService.is("suppressFocusAfterRefresh") || !this.focusedHeaderPosition) {
        return null;
      }
      if (this.isDomDataMissingInHierarchy(eDocument.activeElement, AbstractHeaderCellCtrl.DOM_DATA_KEY_HEADER_CTRL)) {
        return null;
      }
      return this.focusedHeaderPosition;
    };
    FocusService2.prototype.isDomDataMissingInHierarchy = function(eBrowserCell, key) {
      var ePointer = eBrowserCell;
      while (ePointer) {
        var data = this.gridOptionsService.getDomData(ePointer, key);
        if (data) {
          return false;
        }
        ePointer = ePointer.parentNode;
      }
      return true;
    };
    FocusService2.prototype.getFocusedCell = function() {
      return this.focusedCellPosition;
    };
    FocusService2.prototype.shouldRestoreFocus = function(cell) {
      var _this = this;
      if (this.isCellRestoreFocused(cell)) {
        setTimeout(function() {
          _this.restoredFocusedCellPosition = null;
        }, 0);
        return true;
      }
      return false;
    };
    FocusService2.prototype.isCellRestoreFocused = function(cellPosition) {
      if (this.restoredFocusedCellPosition == null) {
        return false;
      }
      return this.cellPositionUtils.equals(cellPosition, this.restoredFocusedCellPosition);
    };
    FocusService2.prototype.setRestoreFocusedCell = function(cellPosition) {
      if (this.getFrameworkOverrides().renderingEngine === "react") {
        this.restoredFocusedCellPosition = cellPosition;
      }
    };
    FocusService2.prototype.getFocusEventParams = function() {
      var _a2 = this.focusedCellPosition, rowIndex = _a2.rowIndex, rowPinned = _a2.rowPinned, column = _a2.column;
      var params = {
        rowIndex,
        rowPinned,
        column,
        isFullWidthCell: false
      };
      var rowCtrl = this.rowRenderer.getRowByPosition({ rowIndex, rowPinned });
      if (rowCtrl) {
        params.isFullWidthCell = rowCtrl.isFullWidth();
      }
      return params;
    };
    FocusService2.prototype.clearFocusedCell = function() {
      this.restoredFocusedCellPosition = null;
      if (this.focusedCellPosition == null) {
        return;
      }
      var event = __assign$6$1({ type: Events.EVENT_CELL_FOCUS_CLEARED }, this.getFocusEventParams());
      this.focusedCellPosition = null;
      this.eventService.dispatchEvent(event);
    };
    FocusService2.prototype.setFocusedCell = function(params) {
      var column = params.column, rowIndex = params.rowIndex, rowPinned = params.rowPinned, _a2 = params.forceBrowserFocus, forceBrowserFocus = _a2 === void 0 ? false : _a2, _b2 = params.preventScrollOnBrowserFocus, preventScrollOnBrowserFocus = _b2 === void 0 ? false : _b2;
      var gridColumn = this.columnModel.getGridColumn(column);
      if (!gridColumn) {
        this.focusedCellPosition = null;
        return;
      }
      this.focusedCellPosition = gridColumn ? {
        rowIndex,
        rowPinned: makeNull(rowPinned),
        column: gridColumn
      } : null;
      var event = __assign$6$1(__assign$6$1({ type: Events.EVENT_CELL_FOCUSED }, this.getFocusEventParams()), { forceBrowserFocus, preventScrollOnBrowserFocus, floating: null });
      this.eventService.dispatchEvent(event);
    };
    FocusService2.prototype.isCellFocused = function(cellPosition) {
      if (this.focusedCellPosition == null) {
        return false;
      }
      return this.cellPositionUtils.equals(cellPosition, this.focusedCellPosition);
    };
    FocusService2.prototype.isRowNodeFocused = function(rowNode) {
      return this.isRowFocused(rowNode.rowIndex, rowNode.rowPinned);
    };
    FocusService2.prototype.isHeaderWrapperFocused = function(headerCtrl) {
      if (this.focusedHeaderPosition == null) {
        return false;
      }
      var column = headerCtrl.getColumnGroupChild();
      var headerRowIndex = headerCtrl.getRowIndex();
      var pinned = headerCtrl.getPinned();
      var _a2 = this.focusedHeaderPosition, focusedColumn = _a2.column, focusedHeaderRowIndex = _a2.headerRowIndex;
      return column === focusedColumn && headerRowIndex === focusedHeaderRowIndex && pinned == focusedColumn.getPinned();
    };
    FocusService2.prototype.clearFocusedHeader = function() {
      this.focusedHeaderPosition = null;
    };
    FocusService2.prototype.getFocusedHeader = function() {
      return this.focusedHeaderPosition;
    };
    FocusService2.prototype.setFocusedHeader = function(headerRowIndex, column) {
      this.focusedHeaderPosition = { headerRowIndex, column };
    };
    FocusService2.prototype.focusHeaderPosition = function(params) {
      var direction = params.direction, fromTab = params.fromTab, allowUserOverride = params.allowUserOverride, event = params.event;
      var headerPosition = params.headerPosition;
      if (allowUserOverride) {
        var currentPosition = this.getFocusedHeader();
        var headerRowCount = this.headerNavigationService.getHeaderRowCount();
        if (fromTab) {
          var userFunc = this.gridOptionsService.getCallback("tabToNextHeader");
          if (userFunc) {
            var params_1 = {
              backwards: direction === "Before",
              previousHeaderPosition: currentPosition,
              nextHeaderPosition: headerPosition,
              headerRowCount
            };
            headerPosition = userFunc(params_1);
          }
        } else {
          var userFunc = this.gridOptionsService.getCallback("navigateToNextHeader");
          if (userFunc && event) {
            var params_2 = {
              key: event.key,
              previousHeaderPosition: currentPosition,
              nextHeaderPosition: headerPosition,
              headerRowCount,
              event
            };
            headerPosition = userFunc(params_2);
          }
        }
      }
      if (!headerPosition) {
        return false;
      }
      if (headerPosition.headerRowIndex === -1) {
        return this.focusGridView(headerPosition.column);
      }
      this.headerNavigationService.scrollToColumn(headerPosition.column, direction);
      var headerRowContainerCtrl = this.ctrlsService.getHeaderRowContainerCtrl(headerPosition.column.getPinned());
      var focusSuccess = headerRowContainerCtrl.focusHeader(headerPosition.headerRowIndex, headerPosition.column, event);
      return focusSuccess;
    };
    FocusService2.prototype.focusFirstHeader = function() {
      var firstColumn = this.columnModel.getAllDisplayedColumns()[0];
      if (!firstColumn) {
        return false;
      }
      if (firstColumn.getParent()) {
        firstColumn = this.columnModel.getColumnGroupAtLevel(firstColumn, 0);
      }
      return this.focusHeaderPosition({
        headerPosition: { headerRowIndex: 0, column: firstColumn }
      });
    };
    FocusService2.prototype.focusLastHeader = function(event) {
      var headerRowIndex = this.headerNavigationService.getHeaderRowCount() - 1;
      var column = last(this.columnModel.getAllDisplayedColumns());
      return this.focusHeaderPosition({
        headerPosition: { headerRowIndex, column },
        event
      });
    };
    FocusService2.prototype.isAnyCellFocused = function() {
      return !!this.focusedCellPosition;
    };
    FocusService2.prototype.isRowFocused = function(rowIndex, floating) {
      if (this.focusedCellPosition == null) {
        return false;
      }
      return this.focusedCellPosition.rowIndex === rowIndex && this.focusedCellPosition.rowPinned === makeNull(floating);
    };
    FocusService2.prototype.findFocusableElements = function(rootNode, exclude, onlyUnmanaged) {
      if (onlyUnmanaged === void 0) {
        onlyUnmanaged = false;
      }
      var focusableString = FOCUSABLE_SELECTOR;
      var excludeString = FOCUSABLE_EXCLUDE;
      if (exclude) {
        excludeString += ", " + exclude;
      }
      if (onlyUnmanaged) {
        excludeString += ', [tabindex="-1"]';
      }
      var nodes = Array.prototype.slice.apply(rootNode.querySelectorAll(focusableString));
      var excludeNodes = Array.prototype.slice.apply(rootNode.querySelectorAll(excludeString));
      if (!excludeNodes.length) {
        return nodes;
      }
      var diff2 = function(a, b) {
        return a.filter(function(element) {
          return b.indexOf(element) === -1;
        });
      };
      return diff2(nodes, excludeNodes);
    };
    FocusService2.prototype.focusInto = function(rootNode, up, onlyUnmanaged) {
      if (up === void 0) {
        up = false;
      }
      if (onlyUnmanaged === void 0) {
        onlyUnmanaged = false;
      }
      var focusableElements = this.findFocusableElements(rootNode, null, onlyUnmanaged);
      var toFocus = up ? last(focusableElements) : focusableElements[0];
      if (toFocus) {
        toFocus.focus({ preventScroll: true });
        return true;
      }
      return false;
    };
    FocusService2.prototype.findFocusableElementBeforeTabGuard = function(rootNode, referenceElement) {
      if (!referenceElement) {
        return null;
      }
      var focusableElements = this.findFocusableElements(rootNode);
      var referenceIndex = focusableElements.indexOf(referenceElement);
      if (referenceIndex === -1) {
        return null;
      }
      var lastTabGuardIndex = -1;
      for (var i = referenceIndex - 1; i >= 0; i--) {
        if (focusableElements[i].classList.contains(TabGuardClassNames.TAB_GUARD_TOP)) {
          lastTabGuardIndex = i;
          break;
        }
      }
      if (lastTabGuardIndex <= 0) {
        return null;
      }
      return focusableElements[lastTabGuardIndex - 1];
    };
    FocusService2.prototype.findNextFocusableElement = function(rootNode, onlyManaged, backwards) {
      if (rootNode === void 0) {
        rootNode = this.eGridDiv;
      }
      var focusable = this.findFocusableElements(rootNode, onlyManaged ? ':not([tabindex="-1"])' : null);
      var eDocument = this.gridOptionsService.getDocument();
      var activeEl = eDocument.activeElement;
      var currentIndex;
      if (onlyManaged) {
        currentIndex = focusable.findIndex(function(el2) {
          return el2.contains(activeEl);
        });
      } else {
        currentIndex = focusable.indexOf(activeEl);
      }
      var nextIndex = currentIndex + (backwards ? -1 : 1);
      if (nextIndex < 0 || nextIndex >= focusable.length) {
        return null;
      }
      return focusable[nextIndex];
    };
    FocusService2.prototype.isTargetUnderManagedComponent = function(rootNode, target) {
      if (!target) {
        return false;
      }
      var managedContainers = rootNode.querySelectorAll("." + ManagedFocusFeature.FOCUS_MANAGED_CLASS);
      if (!managedContainers.length) {
        return false;
      }
      for (var i = 0; i < managedContainers.length; i++) {
        if (managedContainers[i].contains(target)) {
          return true;
        }
      }
      return false;
    };
    FocusService2.prototype.findTabbableParent = function(node, limit) {
      if (limit === void 0) {
        limit = 5;
      }
      var counter2 = 0;
      while (node && getTabIndex(node) === null && ++counter2 <= limit) {
        node = node.parentElement;
      }
      if (getTabIndex(node) === null) {
        return null;
      }
      return node;
    };
    FocusService2.prototype.focusGridView = function(column, backwards) {
      if (this.gridOptionsService.is("suppressCellFocus")) {
        if (backwards) {
          return this.focusLastHeader();
        }
        return this.focusNextGridCoreContainer(false);
      }
      var nextRow = backwards ? this.rowPositionUtils.getLastRow() : this.rowPositionUtils.getFirstRow();
      if (!nextRow) {
        return false;
      }
      var rowIndex = nextRow.rowIndex, rowPinned = nextRow.rowPinned;
      var focusedHeader = this.getFocusedHeader();
      if (!column && focusedHeader) {
        column = focusedHeader.column;
      }
      if (rowIndex == null || !column) {
        return false;
      }
      this.navigationService.ensureCellVisible({ rowIndex, column, rowPinned });
      this.setFocusedCell({
        rowIndex,
        column,
        rowPinned: makeNull(rowPinned),
        forceBrowserFocus: true
      });
      if (this.rangeService) {
        var cellPosition = { rowIndex, rowPinned, column };
        this.rangeService.setRangeToCell(cellPosition);
      }
      return true;
    };
    FocusService2.prototype.focusNextGridCoreContainer = function(backwards, forceOut) {
      if (forceOut === void 0) {
        forceOut = false;
      }
      if (!forceOut && this.gridCtrl.focusNextInnerContainer(backwards)) {
        return true;
      }
      if (forceOut || !backwards && !this.gridCtrl.isDetailGrid()) {
        this.gridCtrl.forceFocusOutOfContainer(backwards);
      }
      return false;
    };
    var FocusService_1;
    FocusService2.AG_KEYBOARD_FOCUS = "ag-keyboard-focus";
    FocusService2.keyboardModeActive = false;
    FocusService2.instancesMonitored = /* @__PURE__ */ new Map();
    __decorate$1l([
      Autowired("eGridDiv")
    ], FocusService2.prototype, "eGridDiv", void 0);
    __decorate$1l([
      Autowired("columnModel")
    ], FocusService2.prototype, "columnModel", void 0);
    __decorate$1l([
      Autowired("headerNavigationService")
    ], FocusService2.prototype, "headerNavigationService", void 0);
    __decorate$1l([
      Autowired("rowRenderer")
    ], FocusService2.prototype, "rowRenderer", void 0);
    __decorate$1l([
      Autowired("rowPositionUtils")
    ], FocusService2.prototype, "rowPositionUtils", void 0);
    __decorate$1l([
      Autowired("cellPositionUtils")
    ], FocusService2.prototype, "cellPositionUtils", void 0);
    __decorate$1l([
      Optional("rangeService")
    ], FocusService2.prototype, "rangeService", void 0);
    __decorate$1l([
      Autowired("navigationService")
    ], FocusService2.prototype, "navigationService", void 0);
    __decorate$1l([
      Autowired("ctrlsService")
    ], FocusService2.prototype, "ctrlsService", void 0);
    __decorate$1l([
      PostConstruct
    ], FocusService2.prototype, "init", null);
    FocusService2 = FocusService_1 = __decorate$1l([
      Bean("focusService")
    ], FocusService2);
    return FocusService2;
  }(BeanStub)
);
var __extends$1o = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1k = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderCellCtrl = (
  /** @class */
  function(_super) {
    __extends$1o(HeaderCellCtrl2, _super);
    function HeaderCellCtrl2(column, parentRowCtrl) {
      var _this = _super.call(this, column, parentRowCtrl) || this;
      _this.refreshFunctions = [];
      _this.userHeaderClasses = /* @__PURE__ */ new Set();
      _this.ariaDescriptionProperties = /* @__PURE__ */ new Map();
      _this.column = column;
      return _this;
    }
    HeaderCellCtrl2.prototype.setComp = function(comp, eGui, eResize, eHeaderCompWrapper) {
      var _this = this;
      _super.prototype.setGui.call(this, eGui);
      this.comp = comp;
      this.updateState();
      this.setupWidth();
      this.setupMovingCss();
      this.setupMenuClass();
      this.setupSortableClass();
      this.setupWrapTextClass();
      this.refreshSpanHeaderHeight();
      this.setupAutoHeight(eHeaderCompWrapper);
      this.addColumnHoverListener();
      this.setupFilterCss();
      this.setupColId();
      this.setupClassesFromColDef();
      this.setupTooltip();
      this.addActiveHeaderMouseListeners();
      this.setupSelectAll();
      this.setupUserComp();
      this.refreshAria();
      this.createManagedBean(new ResizeFeature(this.getPinned(), this.column, eResize, comp, this));
      this.createManagedBean(new HoverFeature([this.column], eGui));
      this.createManagedBean(new SetLeftFeature(this.column, eGui, this.beans));
      this.createManagedBean(new ManagedFocusFeature(eGui, {
        shouldStopEventPropagation: function(e) {
          return _this.shouldStopEventPropagation(e);
        },
        onTabKeyDown: function() {
          return null;
        },
        handleKeyDown: this.handleKeyDown.bind(this),
        onFocusIn: this.onFocusIn.bind(this),
        onFocusOut: this.onFocusOut.bind(this)
      }));
      this.addMouseDownListenerIfNeeded(eGui);
      this.addManagedListener(this.column, Column.EVENT_COL_DEF_CHANGED, this.onColDefChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VALUE_CHANGED, this.onColumnValueChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.onColumnRowGroupChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_CHANGED, this.onColumnPivotChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_HEADER_HEIGHT_CHANGED, this.onHeaderHeightChanged.bind(this));
    };
    HeaderCellCtrl2.prototype.addMouseDownListenerIfNeeded = function(eGui) {
      var _this = this;
      if (!isBrowserSafari()) {
        return;
      }
      var events2 = ["mousedown", "touchstart"];
      var eDocument = this.gridOptionsService.getDocument();
      events2.forEach(function(eventName) {
        _this.addManagedListener(eGui, eventName, function(e) {
          var activeEl = eDocument.activeElement;
          if (activeEl !== eGui && !eGui.contains(activeEl)) {
            eGui.focus();
            FocusService.toggleKeyboardMode(e);
          }
        });
      });
    };
    HeaderCellCtrl2.prototype.setupUserComp = function() {
      var compDetails = this.lookupUserCompDetails();
      this.setCompDetails(compDetails);
    };
    HeaderCellCtrl2.prototype.setCompDetails = function(compDetails) {
      this.userCompDetails = compDetails;
      this.comp.setUserCompDetails(compDetails);
    };
    HeaderCellCtrl2.prototype.lookupUserCompDetails = function() {
      var params = this.createParams();
      var colDef = this.column.getColDef();
      return this.userComponentFactory.getHeaderCompDetails(colDef, params);
    };
    HeaderCellCtrl2.prototype.createParams = function() {
      var _this = this;
      var colDef = this.column.getColDef();
      var params = {
        column: this.column,
        displayName: this.displayName,
        enableSorting: colDef.sortable,
        enableMenu: this.menuEnabled,
        showColumnMenu: function(source) {
          _this.gridApi.showColumnMenuAfterButtonClick(_this.column, source);
        },
        progressSort: function(multiSort) {
          _this.sortController.progressSort(_this.column, !!multiSort, "uiColumnSorted");
        },
        setSort: function(sort, multiSort) {
          _this.sortController.setSortForColumn(_this.column, sort, !!multiSort, "uiColumnSorted");
        },
        api: this.gridApi,
        columnApi: this.columnApi,
        context: this.gridOptionsService.context,
        eGridHeader: this.getGui()
      };
      return params;
    };
    HeaderCellCtrl2.prototype.setupSelectAll = function() {
      this.selectAllFeature = this.createManagedBean(new SelectAllFeature(this.column));
      this.selectAllFeature.setComp(this);
    };
    HeaderCellCtrl2.prototype.getSelectAllGui = function() {
      return this.selectAllFeature.getCheckboxGui();
    };
    HeaderCellCtrl2.prototype.handleKeyDown = function(e) {
      _super.prototype.handleKeyDown.call(this, e);
      if (e.key === KeyCode.SPACE) {
        this.selectAllFeature.onSpaceKeyDown(e);
      }
      if (e.key === KeyCode.ENTER) {
        this.onEnterKeyDown(e);
      }
    };
    HeaderCellCtrl2.prototype.onEnterKeyDown = function(e) {
      var headerComp = this.comp.getUserCompInstance();
      if (!headerComp) {
        return;
      }
      if (e.ctrlKey || e.metaKey) {
        if (this.menuEnabled && headerComp.showMenu) {
          e.preventDefault();
          headerComp.showMenu();
        }
      } else if (this.sortable) {
        var multiSort = e.shiftKey;
        this.sortController.progressSort(this.column, multiSort, "uiColumnSorted");
      }
    };
    HeaderCellCtrl2.prototype.isMenuEnabled = function() {
      return this.menuEnabled;
    };
    HeaderCellCtrl2.prototype.onFocusIn = function(e) {
      if (!this.getGui().contains(e.relatedTarget)) {
        var rowIndex = this.getRowIndex();
        this.focusService.setFocusedHeader(rowIndex, this.column);
      }
      this.setActiveHeader(true);
    };
    HeaderCellCtrl2.prototype.onFocusOut = function(e) {
      if (this.getGui().contains(e.relatedTarget)) {
        return;
      }
      this.setActiveHeader(false);
    };
    HeaderCellCtrl2.prototype.setupTooltip = function() {
      var _this = this;
      var tooltipCtrl = {
        getColumn: function() {
          return _this.column;
        },
        getColDef: function() {
          return _this.column.getColDef();
        },
        getGui: function() {
          return _this.eGui;
        },
        getLocation: function() {
          return "header";
        },
        getTooltipValue: function() {
          var res = _this.column.getColDef().headerTooltip;
          return res;
        }
      };
      var tooltipFeature = this.createManagedBean(new TooltipFeature(tooltipCtrl, this.beans));
      tooltipFeature.setComp(this.comp);
      this.refreshFunctions.push(function() {
        return tooltipFeature.refreshToolTip();
      });
    };
    HeaderCellCtrl2.prototype.setupClassesFromColDef = function() {
      var _this = this;
      var refreshHeaderClasses = function() {
        var colDef = _this.column.getColDef();
        var classes = CssClassApplier.getHeaderClassesFromColDef(colDef, _this.gridOptionsService, _this.column, null);
        var oldClasses = _this.userHeaderClasses;
        _this.userHeaderClasses = new Set(classes);
        classes.forEach(function(c) {
          if (oldClasses.has(c)) {
            oldClasses.delete(c);
          } else {
            _this.comp.addOrRemoveCssClass(c, true);
          }
        });
        oldClasses.forEach(function(c) {
          return _this.comp.addOrRemoveCssClass(c, false);
        });
      };
      this.refreshFunctions.push(refreshHeaderClasses);
      refreshHeaderClasses();
    };
    HeaderCellCtrl2.prototype.setDragSource = function(eSource) {
      var _this = this;
      this.dragSourceElement = eSource;
      this.removeDragSource();
      if (!eSource) {
        return;
      }
      if (!this.draggable) {
        return;
      }
      var hideColumnOnExit = !this.gridOptionsService.is("suppressDragLeaveHidesColumns");
      this.moveDragSource = {
        type: DragSourceType.HeaderCell,
        eElement: eSource,
        defaultIconName: hideColumnOnExit ? DragAndDropService.ICON_HIDE : DragAndDropService.ICON_NOT_ALLOWED,
        getDragItem: function() {
          return _this.createDragItem();
        },
        dragItemName: this.displayName,
        onDragStarted: function() {
          return _this.column.setMoving(true, "uiColumnMoved");
        },
        onDragStopped: function() {
          return _this.column.setMoving(false, "uiColumnMoved");
        },
        onGridEnter: function(dragItem) {
          var _a2;
          if (hideColumnOnExit) {
            var unlockedColumns = ((_a2 = dragItem === null || dragItem === void 0 ? void 0 : dragItem.columns) === null || _a2 === void 0 ? void 0 : _a2.filter(function(col) {
              return !col.getColDef().lockVisible;
            })) || [];
            _this.columnModel.setColumnsVisible(unlockedColumns, true, "uiColumnMoved");
          }
        },
        onGridExit: function(dragItem) {
          var _a2;
          if (hideColumnOnExit) {
            var unlockedColumns = ((_a2 = dragItem === null || dragItem === void 0 ? void 0 : dragItem.columns) === null || _a2 === void 0 ? void 0 : _a2.filter(function(col) {
              return !col.getColDef().lockVisible;
            })) || [];
            _this.columnModel.setColumnsVisible(unlockedColumns, false, "uiColumnMoved");
          }
        }
      };
      this.dragAndDropService.addDragSource(this.moveDragSource, true);
    };
    HeaderCellCtrl2.prototype.createDragItem = function() {
      var visibleState = {};
      visibleState[this.column.getId()] = this.column.isVisible();
      return {
        columns: [this.column],
        visibleState
      };
    };
    HeaderCellCtrl2.prototype.removeDragSource = function() {
      if (this.moveDragSource) {
        this.dragAndDropService.removeDragSource(this.moveDragSource);
        this.moveDragSource = void 0;
      }
    };
    HeaderCellCtrl2.prototype.onColDefChanged = function() {
      this.refresh();
    };
    HeaderCellCtrl2.prototype.updateState = function() {
      var colDef = this.column.getColDef();
      this.menuEnabled = this.menuFactory.isMenuEnabled(this.column) && !colDef.suppressMenu;
      this.sortable = colDef.sortable;
      this.displayName = this.calculateDisplayName();
      this.draggable = this.workOutDraggable();
    };
    HeaderCellCtrl2.prototype.addRefreshFunction = function(func) {
      this.refreshFunctions.push(func);
    };
    HeaderCellCtrl2.prototype.refresh = function() {
      this.updateState();
      this.refreshHeaderComp();
      this.refreshAria();
      this.refreshFunctions.forEach(function(f2) {
        return f2();
      });
    };
    HeaderCellCtrl2.prototype.refreshHeaderComp = function() {
      var newCompDetails = this.lookupUserCompDetails();
      var compInstance = this.comp.getUserCompInstance();
      var attemptRefresh = compInstance != null && this.userCompDetails.componentClass == newCompDetails.componentClass;
      var headerCompRefreshed = attemptRefresh ? this.attemptHeaderCompRefresh(newCompDetails.params) : false;
      if (headerCompRefreshed) {
        this.setDragSource(this.dragSourceElement);
      } else {
        this.setCompDetails(newCompDetails);
      }
    };
    HeaderCellCtrl2.prototype.attemptHeaderCompRefresh = function(params) {
      var headerComp = this.comp.getUserCompInstance();
      if (!headerComp) {
        return false;
      }
      if (!headerComp.refresh) {
        return false;
      }
      var res = headerComp.refresh(params);
      return res;
    };
    HeaderCellCtrl2.prototype.calculateDisplayName = function() {
      return this.columnModel.getDisplayNameForColumn(this.column, "header", true);
    };
    HeaderCellCtrl2.prototype.checkDisplayName = function() {
      if (this.displayName !== this.calculateDisplayName()) {
        this.refresh();
      }
    };
    HeaderCellCtrl2.prototype.workOutDraggable = function() {
      var colDef = this.column.getColDef();
      var isSuppressMovableColumns = this.gridOptionsService.is("suppressMovableColumns");
      var colCanMove = !isSuppressMovableColumns && !colDef.suppressMovable && !colDef.lockPosition;
      return !!colCanMove || !!colDef.enableRowGroup || !!colDef.enablePivot;
    };
    HeaderCellCtrl2.prototype.onColumnRowGroupChanged = function() {
      this.checkDisplayName();
    };
    HeaderCellCtrl2.prototype.onColumnPivotChanged = function() {
      this.checkDisplayName();
    };
    HeaderCellCtrl2.prototype.onColumnValueChanged = function() {
      this.checkDisplayName();
    };
    HeaderCellCtrl2.prototype.setupWidth = function() {
      var _this = this;
      var listener = function() {
        var columnWidth = _this.column.getActualWidth();
        _this.comp.setWidth(columnWidth + "px");
      };
      this.addManagedListener(this.column, Column.EVENT_WIDTH_CHANGED, listener);
      listener();
    };
    HeaderCellCtrl2.prototype.setupMovingCss = function() {
      var _this = this;
      var listener = function() {
        _this.comp.addOrRemoveCssClass("ag-header-cell-moving", _this.column.isMoving());
      };
      this.addManagedListener(this.column, Column.EVENT_MOVING_CHANGED, listener);
      listener();
    };
    HeaderCellCtrl2.prototype.setupMenuClass = function() {
      var _this = this;
      var listener = function() {
        _this.comp.addOrRemoveCssClass("ag-column-menu-visible", _this.column.isMenuVisible());
      };
      this.addManagedListener(this.column, Column.EVENT_MENU_VISIBLE_CHANGED, listener);
      listener();
    };
    HeaderCellCtrl2.prototype.setupSortableClass = function() {
      var _this = this;
      var updateSortableCssClass = function() {
        _this.comp.addOrRemoveCssClass("ag-header-cell-sortable", !!_this.sortable);
      };
      updateSortableCssClass();
      this.addRefreshFunction(updateSortableCssClass);
      this.addManagedListener(this.eventService, Column.EVENT_SORT_CHANGED, this.refreshAriaSort.bind(this));
    };
    HeaderCellCtrl2.prototype.setupWrapTextClass = function() {
      var _this = this;
      var listener = function() {
        var wrapText = !!_this.column.getColDef().wrapHeaderText;
        _this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text", wrapText);
      };
      listener();
      this.addRefreshFunction(listener);
    };
    HeaderCellCtrl2.prototype.onHeaderHeightChanged = function() {
      this.refreshSpanHeaderHeight();
    };
    HeaderCellCtrl2.prototype.refreshSpanHeaderHeight = function() {
      var _a2 = this, eGui = _a2.eGui, column = _a2.column, comp = _a2.comp, columnModel = _a2.columnModel, gridOptionsService = _a2.gridOptionsService;
      if (!column.isSpanHeaderHeight()) {
        return;
      }
      var _b2 = this.getColumnGroupPaddingInfo(), numberOfParents = _b2.numberOfParents, isSpanningTotal = _b2.isSpanningTotal;
      comp.addOrRemoveCssClass("ag-header-span-height", numberOfParents > 0);
      if (numberOfParents === 0) {
        return;
      }
      comp.addOrRemoveCssClass("ag-header-span-total", isSpanningTotal);
      var pivotMode = gridOptionsService.is("pivotMode");
      var groupHeaderHeight = pivotMode ? columnModel.getPivotGroupHeaderHeight() : columnModel.getGroupHeaderHeight();
      var headerHeight = columnModel.getColumnHeaderRowHeight();
      var extraHeight = numberOfParents * groupHeaderHeight;
      eGui.style.setProperty("top", -extraHeight + "px");
      eGui.style.setProperty("height", headerHeight + extraHeight + "px");
    };
    HeaderCellCtrl2.prototype.getColumnGroupPaddingInfo = function() {
      var parent = this.column.getParent();
      if (!parent || !parent.isPadding()) {
        return { numberOfParents: 0, isSpanningTotal: false };
      }
      var numberOfParents = parent.getPaddingLevel() + 1;
      var isSpanningTotal = true;
      while (parent) {
        if (!parent.isPadding()) {
          isSpanningTotal = false;
          break;
        }
        parent = parent.getParent();
      }
      return { numberOfParents, isSpanningTotal };
    };
    HeaderCellCtrl2.prototype.setupAutoHeight = function(wrapperElement) {
      var _this = this;
      var measureHeight = function(timesCalled) {
        if (!_this.isAlive()) {
          return;
        }
        var _a2 = getElementSize(_this.getGui()), paddingTop = _a2.paddingTop, paddingBottom = _a2.paddingBottom, borderBottomWidth = _a2.borderBottomWidth, borderTopWidth = _a2.borderTopWidth;
        var extraHeight = paddingTop + paddingBottom + borderBottomWidth + borderTopWidth;
        var wrapperHeight = wrapperElement.offsetHeight;
        var autoHeight = wrapperHeight + extraHeight;
        if (timesCalled < 5) {
          var doc = _this.beans.gridOptionsService.getDocument();
          var notYetInDom = !doc || !doc.contains(wrapperElement);
          var possiblyNoContentYet = autoHeight == 0;
          if (notYetInDom || possiblyNoContentYet) {
            _this.beans.frameworkOverrides.setTimeout(function() {
              return measureHeight(timesCalled + 1);
            }, 0);
            return;
          }
        }
        _this.columnModel.setColumnHeaderHeight(_this.column, autoHeight);
      };
      var isMeasuring = false;
      var stopResizeObserver;
      var checkMeasuring = function() {
        var newValue = _this.column.isAutoHeaderHeight();
        if (newValue && !isMeasuring) {
          startMeasuring();
        }
        if (!newValue && isMeasuring) {
          stopMeasuring();
        }
      };
      var startMeasuring = function() {
        isMeasuring = true;
        measureHeight(0);
        _this.comp.addOrRemoveCssClass("ag-header-cell-auto-height", true);
        stopResizeObserver = _this.resizeObserverService.observeResize(wrapperElement, function() {
          return measureHeight(0);
        });
      };
      var stopMeasuring = function() {
        isMeasuring = false;
        if (stopResizeObserver) {
          stopResizeObserver();
        }
        _this.comp.addOrRemoveCssClass("ag-header-cell-auto-height", false);
        stopResizeObserver = void 0;
      };
      checkMeasuring();
      this.addDestroyFunc(function() {
        return stopMeasuring();
      });
      this.addManagedListener(this.column, Column.EVENT_WIDTH_CHANGED, function() {
        return isMeasuring && measureHeight(0);
      });
      this.addManagedListener(this.eventService, Column.EVENT_SORT_CHANGED, function() {
        if (isMeasuring) {
          _this.beans.frameworkOverrides.setTimeout(function() {
            return measureHeight(0);
          });
        }
      });
      this.addRefreshFunction(checkMeasuring);
    };
    HeaderCellCtrl2.prototype.refreshAriaSort = function() {
      if (this.sortable) {
        var translate = this.localeService.getLocaleTextFunc();
        var sort = this.sortController.getDisplaySortForColumn(this.column) || null;
        this.comp.setAriaSort(getAriaSortState(sort));
        this.setAriaDescriptionProperty("sort", translate("ariaSortableColumn", "Press ENTER to sort."));
      } else {
        this.comp.setAriaSort();
        this.setAriaDescriptionProperty("sort", null);
      }
    };
    HeaderCellCtrl2.prototype.refreshAriaMenu = function() {
      if (this.menuEnabled) {
        var translate = this.localeService.getLocaleTextFunc();
        this.setAriaDescriptionProperty("menu", translate("ariaMenuColumn", "Press CTRL ENTER to open column menu."));
      } else {
        this.setAriaDescriptionProperty("menu", null);
      }
    };
    HeaderCellCtrl2.prototype.setAriaDescriptionProperty = function(property, value) {
      if (value != null) {
        this.ariaDescriptionProperties.set(property, value);
      } else {
        this.ariaDescriptionProperties.delete(property);
      }
    };
    HeaderCellCtrl2.prototype.refreshAriaDescription = function() {
      var descriptionArray = Array.from(this.ariaDescriptionProperties.values());
      this.comp.setAriaDescription(descriptionArray.length ? descriptionArray.join(" ") : void 0);
    };
    HeaderCellCtrl2.prototype.refreshAria = function() {
      this.refreshAriaSort();
      this.refreshAriaMenu();
      this.refreshAriaDescription();
    };
    HeaderCellCtrl2.prototype.addColumnHoverListener = function() {
      var _this = this;
      var listener = function() {
        if (!_this.gridOptionsService.is("columnHoverHighlight")) {
          return;
        }
        var isHovered = _this.columnHoverService.isHovered(_this.column);
        _this.comp.addOrRemoveCssClass("ag-column-hover", isHovered);
      };
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_HOVER_CHANGED, listener);
      listener();
    };
    HeaderCellCtrl2.prototype.setupFilterCss = function() {
      var _this = this;
      var listener = function() {
        _this.comp.addOrRemoveCssClass("ag-header-cell-filtered", _this.column.isFilterActive());
      };
      this.addManagedListener(this.column, Column.EVENT_FILTER_ACTIVE_CHANGED, listener);
      listener();
    };
    HeaderCellCtrl2.prototype.setupColId = function() {
      this.comp.setColId(this.column.getColId());
    };
    HeaderCellCtrl2.prototype.addActiveHeaderMouseListeners = function() {
      var _this = this;
      var listener = function(e) {
        return _this.setActiveHeader(e.type === "mouseenter");
      };
      this.addManagedListener(this.getGui(), "mouseenter", listener);
      this.addManagedListener(this.getGui(), "mouseleave", listener);
    };
    HeaderCellCtrl2.prototype.setActiveHeader = function(active) {
      this.comp.addOrRemoveCssClass("ag-header-active", active);
    };
    __decorate$1k([
      Autowired("columnModel")
    ], HeaderCellCtrl2.prototype, "columnModel", void 0);
    __decorate$1k([
      Autowired("columnHoverService")
    ], HeaderCellCtrl2.prototype, "columnHoverService", void 0);
    __decorate$1k([
      Autowired("sortController")
    ], HeaderCellCtrl2.prototype, "sortController", void 0);
    __decorate$1k([
      Autowired("menuFactory")
    ], HeaderCellCtrl2.prototype, "menuFactory", void 0);
    __decorate$1k([
      Autowired("dragAndDropService")
    ], HeaderCellCtrl2.prototype, "dragAndDropService", void 0);
    __decorate$1k([
      Autowired("resizeObserverService")
    ], HeaderCellCtrl2.prototype, "resizeObserverService", void 0);
    __decorate$1k([
      Autowired("gridApi")
    ], HeaderCellCtrl2.prototype, "gridApi", void 0);
    __decorate$1k([
      Autowired("columnApi")
    ], HeaderCellCtrl2.prototype, "columnApi", void 0);
    __decorate$1k([
      PreDestroy
    ], HeaderCellCtrl2.prototype, "removeDragSource", null);
    return HeaderCellCtrl2;
  }(AbstractHeaderCellCtrl)
);
var __extends$1n = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1j = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GroupResizeFeature = (
  /** @class */
  function(_super) {
    __extends$1n(GroupResizeFeature2, _super);
    function GroupResizeFeature2(comp, eResize, pinned, columnGroup) {
      var _this = _super.call(this) || this;
      _this.eResize = eResize;
      _this.comp = comp;
      _this.pinned = pinned;
      _this.columnGroup = columnGroup;
      return _this;
    }
    GroupResizeFeature2.prototype.postConstruct = function() {
      var _this = this;
      if (!this.columnGroup.isResizable()) {
        this.comp.setResizableDisplayed(false);
        return;
      }
      var finishedWithResizeFunc = this.horizontalResizeService.addResizeBar({
        eResizeBar: this.eResize,
        onResizeStart: this.onResizeStart.bind(this),
        onResizing: this.onResizing.bind(this, false),
        onResizeEnd: this.onResizing.bind(this, true)
      });
      this.addDestroyFunc(finishedWithResizeFunc);
      if (!this.gridOptionsService.is("suppressAutoSize")) {
        var skipHeaderOnAutoSize_1 = this.gridOptionsService.is("skipHeaderOnAutoSize");
        this.eResize.addEventListener("dblclick", function() {
          var keys2 = [];
          var leafCols = _this.columnGroup.getDisplayedLeafColumns();
          leafCols.forEach(function(column) {
            if (!column.getColDef().suppressAutoSize) {
              keys2.push(column.getColId());
            }
          });
          if (keys2.length > 0) {
            _this.columnModel.autoSizeColumns({
              columns: keys2,
              skipHeader: skipHeaderOnAutoSize_1,
              stopAtGroup: _this.columnGroup,
              source: "uiColumnResized"
            });
          }
          _this.resizeLeafColumnsToFit("uiColumnResized");
        });
      }
    };
    GroupResizeFeature2.prototype.onResizeStart = function(shiftKey) {
      var _this = this;
      this.calculateInitialValues();
      var takeFromGroup = null;
      if (shiftKey) {
        takeFromGroup = this.columnModel.getDisplayedGroupAfter(this.columnGroup);
      }
      if (takeFromGroup) {
        var takeFromLeafCols = takeFromGroup.getDisplayedLeafColumns();
        this.resizeTakeFromCols = takeFromLeafCols.filter(function(col) {
          return col.isResizable();
        });
        this.resizeTakeFromStartWidth = 0;
        this.resizeTakeFromCols.forEach(function(col) {
          return _this.resizeTakeFromStartWidth += col.getActualWidth();
        });
        this.resizeTakeFromRatios = [];
        this.resizeTakeFromCols.forEach(function(col) {
          return _this.resizeTakeFromRatios.push(col.getActualWidth() / _this.resizeTakeFromStartWidth);
        });
      } else {
        this.resizeTakeFromCols = null;
        this.resizeTakeFromStartWidth = null;
        this.resizeTakeFromRatios = null;
      }
      this.comp.addOrRemoveCssClass("ag-column-resizing", true);
    };
    GroupResizeFeature2.prototype.onResizing = function(finished, resizeAmount, source) {
      if (source === void 0) {
        source = "uiColumnResized";
      }
      var resizeAmountNormalised = this.normaliseDragChange(resizeAmount);
      var width = this.resizeStartWidth + resizeAmountNormalised;
      this.resizeColumns(width, source, finished);
    };
    GroupResizeFeature2.prototype.resizeLeafColumnsToFit = function(source) {
      var preferredSize = this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup);
      this.calculateInitialValues();
      if (preferredSize > this.resizeStartWidth) {
        this.resizeColumns(preferredSize, source, true);
      }
    };
    GroupResizeFeature2.prototype.resizeColumns = function(totalWidth, source, finished) {
      if (finished === void 0) {
        finished = true;
      }
      var resizeSets = [];
      resizeSets.push({
        columns: this.resizeCols,
        ratios: this.resizeRatios,
        width: totalWidth
      });
      if (this.resizeTakeFromCols) {
        var diff2 = totalWidth - this.resizeStartWidth;
        resizeSets.push({
          columns: this.resizeTakeFromCols,
          ratios: this.resizeTakeFromRatios,
          width: this.resizeTakeFromStartWidth - diff2
        });
      }
      this.columnModel.resizeColumnSets({
        resizeSets,
        finished,
        source
      });
      if (finished) {
        this.comp.addOrRemoveCssClass("ag-column-resizing", false);
      }
    };
    GroupResizeFeature2.prototype.calculateInitialValues = function() {
      var _this = this;
      var leafCols = this.columnGroup.getDisplayedLeafColumns();
      this.resizeCols = leafCols.filter(function(col) {
        return col.isResizable();
      });
      this.resizeStartWidth = 0;
      this.resizeCols.forEach(function(col) {
        return _this.resizeStartWidth += col.getActualWidth();
      });
      this.resizeRatios = [];
      this.resizeCols.forEach(function(col) {
        return _this.resizeRatios.push(col.getActualWidth() / _this.resizeStartWidth);
      });
    };
    GroupResizeFeature2.prototype.normaliseDragChange = function(dragChange) {
      var result = dragChange;
      if (this.gridOptionsService.is("enableRtl")) {
        if (this.pinned !== "left") {
          result *= -1;
        }
      } else if (this.pinned === "right") {
        result *= -1;
      }
      return result;
    };
    __decorate$1j([
      Autowired("horizontalResizeService")
    ], GroupResizeFeature2.prototype, "horizontalResizeService", void 0);
    __decorate$1j([
      Autowired("autoWidthCalculator")
    ], GroupResizeFeature2.prototype, "autoWidthCalculator", void 0);
    __decorate$1j([
      Autowired("columnModel")
    ], GroupResizeFeature2.prototype, "columnModel", void 0);
    __decorate$1j([
      PostConstruct
    ], GroupResizeFeature2.prototype, "postConstruct", null);
    return GroupResizeFeature2;
  }(BeanStub)
);
var __extends$1m = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1i = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GroupWidthFeature = (
  /** @class */
  function(_super) {
    __extends$1m(GroupWidthFeature2, _super);
    function GroupWidthFeature2(comp, columnGroup) {
      var _this = _super.call(this) || this;
      _this.removeChildListenersFuncs = [];
      _this.columnGroup = columnGroup;
      _this.comp = comp;
      return _this;
    }
    GroupWidthFeature2.prototype.postConstruct = function() {
      this.addListenersToChildrenColumns();
      this.addManagedListener(this.columnGroup, ColumnGroup.EVENT_DISPLAYED_CHILDREN_CHANGED, this.onDisplayedChildrenChanged.bind(this));
      this.onWidthChanged();
      this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this));
    };
    GroupWidthFeature2.prototype.addListenersToChildrenColumns = function() {
      var _this = this;
      this.removeListenersOnChildrenColumns();
      var widthChangedListener = this.onWidthChanged.bind(this);
      this.columnGroup.getLeafColumns().forEach(function(column) {
        column.addEventListener("widthChanged", widthChangedListener);
        column.addEventListener("visibleChanged", widthChangedListener);
        _this.removeChildListenersFuncs.push(function() {
          column.removeEventListener("widthChanged", widthChangedListener);
          column.removeEventListener("visibleChanged", widthChangedListener);
        });
      });
    };
    GroupWidthFeature2.prototype.removeListenersOnChildrenColumns = function() {
      this.removeChildListenersFuncs.forEach(function(func) {
        return func();
      });
      this.removeChildListenersFuncs = [];
    };
    GroupWidthFeature2.prototype.onDisplayedChildrenChanged = function() {
      this.addListenersToChildrenColumns();
      this.onWidthChanged();
    };
    GroupWidthFeature2.prototype.onWidthChanged = function() {
      var columnWidth = this.columnGroup.getActualWidth();
      this.comp.setWidth(columnWidth + "px");
      this.comp.addOrRemoveCssClass("ag-hidden", columnWidth === 0);
    };
    __decorate$1i([
      PostConstruct
    ], GroupWidthFeature2.prototype, "postConstruct", null);
    return GroupWidthFeature2;
  }(BeanStub)
);
var __extends$1l = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1h = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderGroupCellCtrl = (
  /** @class */
  function(_super) {
    __extends$1l(HeaderGroupCellCtrl2, _super);
    function HeaderGroupCellCtrl2(columnGroup, parentRowCtrl) {
      var _this = _super.call(this, columnGroup, parentRowCtrl) || this;
      _this.columnGroup = columnGroup;
      return _this;
    }
    HeaderGroupCellCtrl2.prototype.setComp = function(comp, eGui, eResize) {
      _super.prototype.setGui.call(this, eGui);
      this.comp = comp;
      this.displayName = this.columnModel.getDisplayNameForColumnGroup(this.columnGroup, "header");
      this.addClasses();
      this.addAttributes();
      this.setupMovingCss();
      this.setupExpandable();
      this.setupTooltip();
      this.setupUserComp();
      var pinned = this.getParentRowCtrl().getPinned();
      var leafCols = this.columnGroup.getProvidedColumnGroup().getLeafColumns();
      this.createManagedBean(new HoverFeature(leafCols, eGui));
      this.createManagedBean(new SetLeftFeature(this.columnGroup, eGui, this.beans));
      this.createManagedBean(new GroupWidthFeature(comp, this.columnGroup));
      this.groupResizeFeature = this.createManagedBean(new GroupResizeFeature(comp, eResize, pinned, this.columnGroup));
      this.createManagedBean(new ManagedFocusFeature(eGui, {
        shouldStopEventPropagation: this.shouldStopEventPropagation.bind(this),
        onTabKeyDown: function() {
          return void 0;
        },
        handleKeyDown: this.handleKeyDown.bind(this),
        onFocusIn: this.onFocusIn.bind(this)
      }));
    };
    HeaderGroupCellCtrl2.prototype.resizeLeafColumnsToFit = function(source) {
      if (!this.groupResizeFeature) {
        return;
      }
      this.groupResizeFeature.resizeLeafColumnsToFit(source);
    };
    HeaderGroupCellCtrl2.prototype.setupUserComp = function() {
      var _this = this;
      var displayName = this.displayName;
      var params = {
        displayName: this.displayName,
        columnGroup: this.columnGroup,
        setExpanded: function(expanded) {
          _this.columnModel.setColumnGroupOpened(_this.columnGroup.getProvidedColumnGroup(), expanded, "gridInitializing");
        },
        api: this.gridApi,
        columnApi: this.columnApi,
        context: this.gridOptionsService.context
      };
      if (!displayName) {
        var columnGroup = this.columnGroup;
        var leafCols = columnGroup.getLeafColumns();
        while (columnGroup.getParent() && columnGroup.getParent().getLeafColumns().length === leafCols.length) {
          columnGroup = columnGroup.getParent();
        }
        var colGroupDef = columnGroup.getColGroupDef();
        if (colGroupDef) {
          displayName = colGroupDef.headerName;
        }
        if (!displayName) {
          displayName = leafCols ? this.columnModel.getDisplayNameForColumn(leafCols[0], "header", true) : "";
        }
      }
      var compDetails = this.userComponentFactory.getHeaderGroupCompDetails(params);
      this.comp.setUserCompDetails(compDetails);
    };
    HeaderGroupCellCtrl2.prototype.setupTooltip = function() {
      var _this = this;
      var colGroupDef = this.columnGroup.getColGroupDef();
      var tooltipCtrl = {
        getColumn: function() {
          return _this.columnGroup;
        },
        getGui: function() {
          return _this.eGui;
        },
        getLocation: function() {
          return "headerGroup";
        },
        getTooltipValue: function() {
          return colGroupDef && colGroupDef.headerTooltip;
        }
      };
      if (colGroupDef) {
        tooltipCtrl.getColDef = function() {
          return colGroupDef;
        };
      }
      var tooltipFeature = this.createManagedBean(new TooltipFeature(tooltipCtrl, this.beans));
      tooltipFeature.setComp(this.comp);
    };
    HeaderGroupCellCtrl2.prototype.setupExpandable = function() {
      var providedColGroup = this.columnGroup.getProvidedColumnGroup();
      this.refreshExpanded();
      this.addManagedListener(providedColGroup, ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED, this.refreshExpanded.bind(this));
      this.addManagedListener(providedColGroup, ProvidedColumnGroup.EVENT_EXPANDED_CHANGED, this.refreshExpanded.bind(this));
    };
    HeaderGroupCellCtrl2.prototype.refreshExpanded = function() {
      var column = this.columnGroup;
      this.expandable = column.isExpandable();
      var expanded = column.isExpanded();
      if (this.expandable) {
        this.comp.setAriaExpanded(expanded ? "true" : "false");
      } else {
        this.comp.setAriaExpanded(void 0);
      }
    };
    HeaderGroupCellCtrl2.prototype.addAttributes = function() {
      this.comp.setColId(this.columnGroup.getUniqueId());
    };
    HeaderGroupCellCtrl2.prototype.addClasses = function() {
      var _this = this;
      var colGroupDef = this.columnGroup.getColGroupDef();
      var classes = CssClassApplier.getHeaderClassesFromColDef(colGroupDef, this.gridOptionsService, null, this.columnGroup);
      if (this.columnGroup.isPadding()) {
        classes.push("ag-header-group-cell-no-group");
        var leafCols = this.columnGroup.getLeafColumns();
        if (leafCols.every(function(col) {
          return col.isSpanHeaderHeight();
        })) {
          classes.push("ag-header-span-height");
        }
      } else {
        classes.push("ag-header-group-cell-with-group");
      }
      classes.forEach(function(c) {
        return _this.comp.addOrRemoveCssClass(c, true);
      });
    };
    HeaderGroupCellCtrl2.prototype.setupMovingCss = function() {
      var _this = this;
      var providedColumnGroup = this.columnGroup.getProvidedColumnGroup();
      var leafColumns = providedColumnGroup.getLeafColumns();
      var listener = function() {
        return _this.comp.addOrRemoveCssClass("ag-header-cell-moving", _this.columnGroup.isMoving());
      };
      leafColumns.forEach(function(col) {
        _this.addManagedListener(col, Column.EVENT_MOVING_CHANGED, listener);
      });
      listener();
    };
    HeaderGroupCellCtrl2.prototype.onFocusIn = function(e) {
      if (!this.eGui.contains(e.relatedTarget)) {
        var rowIndex = this.getRowIndex();
        this.beans.focusService.setFocusedHeader(rowIndex, this.columnGroup);
      }
    };
    HeaderGroupCellCtrl2.prototype.handleKeyDown = function(e) {
      _super.prototype.handleKeyDown.call(this, e);
      var wrapperHasFocus = this.getWrapperHasFocus();
      if (!this.expandable || !wrapperHasFocus) {
        return;
      }
      if (e.key === KeyCode.ENTER) {
        var column = this.columnGroup;
        var newExpandedValue = !column.isExpanded();
        this.columnModel.setColumnGroupOpened(column.getProvidedColumnGroup(), newExpandedValue, "uiColumnExpanded");
      }
    };
    HeaderGroupCellCtrl2.prototype.setDragSource = function(eHeaderGroup) {
      var _this = this;
      if (this.isSuppressMoving()) {
        return;
      }
      var allLeafColumns = this.columnGroup.getProvidedColumnGroup().getLeafColumns();
      var hideColumnOnExit = !this.gridOptionsService.is("suppressDragLeaveHidesColumns");
      var dragSource = {
        type: DragSourceType.HeaderCell,
        eElement: eHeaderGroup,
        defaultIconName: hideColumnOnExit ? DragAndDropService.ICON_HIDE : DragAndDropService.ICON_NOT_ALLOWED,
        dragItemName: this.displayName,
        // we add in the original group leaf columns, so we move both visible and non-visible items
        getDragItem: this.getDragItemForGroup.bind(this),
        onDragStarted: function() {
          return allLeafColumns.forEach(function(col) {
            return col.setMoving(true, "uiColumnDragged");
          });
        },
        onDragStopped: function() {
          return allLeafColumns.forEach(function(col) {
            return col.setMoving(false, "uiColumnDragged");
          });
        },
        onGridEnter: function(dragItem) {
          var _a2;
          if (hideColumnOnExit) {
            var unlockedColumns = ((_a2 = dragItem === null || dragItem === void 0 ? void 0 : dragItem.columns) === null || _a2 === void 0 ? void 0 : _a2.filter(function(col) {
              return !col.getColDef().lockVisible;
            })) || [];
            _this.columnModel.setColumnsVisible(unlockedColumns, true, "uiColumnMoved");
          }
        },
        onGridExit: function(dragItem) {
          var _a2;
          if (hideColumnOnExit) {
            var unlockedColumns = ((_a2 = dragItem === null || dragItem === void 0 ? void 0 : dragItem.columns) === null || _a2 === void 0 ? void 0 : _a2.filter(function(col) {
              return !col.getColDef().lockVisible;
            })) || [];
            _this.columnModel.setColumnsVisible(unlockedColumns, false, "uiColumnMoved");
          }
        }
      };
      this.dragAndDropService.addDragSource(dragSource, true);
      this.addDestroyFunc(function() {
        return _this.dragAndDropService.removeDragSource(dragSource);
      });
    };
    HeaderGroupCellCtrl2.prototype.getDragItemForGroup = function() {
      var allColumnsOriginalOrder = this.columnGroup.getProvidedColumnGroup().getLeafColumns();
      var visibleState = {};
      allColumnsOriginalOrder.forEach(function(column) {
        return visibleState[column.getId()] = column.isVisible();
      });
      var allColumnsCurrentOrder = [];
      this.columnModel.getAllDisplayedColumns().forEach(function(column) {
        if (allColumnsOriginalOrder.indexOf(column) >= 0) {
          allColumnsCurrentOrder.push(column);
          removeFromArray(allColumnsOriginalOrder, column);
        }
      });
      allColumnsOriginalOrder.forEach(function(column) {
        return allColumnsCurrentOrder.push(column);
      });
      return {
        columns: allColumnsCurrentOrder,
        visibleState
      };
    };
    HeaderGroupCellCtrl2.prototype.isSuppressMoving = function() {
      var childSuppressesMoving = false;
      this.columnGroup.getLeafColumns().forEach(function(column) {
        if (column.getColDef().suppressMovable || column.getColDef().lockPosition) {
          childSuppressesMoving = true;
        }
      });
      var result = childSuppressesMoving || this.gridOptionsService.is("suppressMovableColumns");
      return result;
    };
    __decorate$1h([
      Autowired("columnModel")
    ], HeaderGroupCellCtrl2.prototype, "columnModel", void 0);
    __decorate$1h([
      Autowired("dragAndDropService")
    ], HeaderGroupCellCtrl2.prototype, "dragAndDropService", void 0);
    __decorate$1h([
      Autowired("gridApi")
    ], HeaderGroupCellCtrl2.prototype, "gridApi", void 0);
    __decorate$1h([
      Autowired("columnApi")
    ], HeaderGroupCellCtrl2.prototype, "columnApi", void 0);
    return HeaderGroupCellCtrl2;
  }(AbstractHeaderCellCtrl)
);
var __extends$1k = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1g = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var instanceIdSequence = 0;
var HeaderRowCtrl = (
  /** @class */
  function(_super) {
    __extends$1k(HeaderRowCtrl2, _super);
    function HeaderRowCtrl2(rowIndex, pinned, type) {
      var _this = _super.call(this) || this;
      _this.instanceId = instanceIdSequence++;
      _this.headerCellCtrls = {};
      _this.rowIndex = rowIndex;
      _this.pinned = pinned;
      _this.type = type;
      return _this;
    }
    HeaderRowCtrl2.prototype.getInstanceId = function() {
      return this.instanceId;
    };
    HeaderRowCtrl2.prototype.setComp = function(comp) {
      this.comp = comp;
      this.onRowHeightChanged();
      this.onVirtualColumnsChanged();
      this.setWidth();
      this.addEventListeners();
      if (isBrowserSafari()) {
        this.comp.setTransform("translateZ(0)");
      }
      comp.setAriaRowIndex(this.rowIndex + 1);
    };
    HeaderRowCtrl2.prototype.addEventListeners = function() {
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_RESIZED, this.onColumnResized.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.onDisplayedColumnsChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_VIRTUAL_COLUMNS_CHANGED, this.onVirtualColumnsChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED, this.onRowHeightChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_GRID_STYLES_CHANGED, this.onRowHeightChanged.bind(this));
      this.addManagedPropertyListener("domLayout", this.onDisplayedColumnsChanged.bind(this));
      this.addManagedPropertyListener("headerHeight", this.onRowHeightChanged.bind(this));
      this.addManagedPropertyListener("pivotHeaderHeight", this.onRowHeightChanged.bind(this));
      this.addManagedPropertyListener("groupHeaderHeight", this.onRowHeightChanged.bind(this));
      this.addManagedPropertyListener("pivotGroupHeaderHeight", this.onRowHeightChanged.bind(this));
      this.addManagedPropertyListener("floatingFiltersHeight", this.onRowHeightChanged.bind(this));
    };
    HeaderRowCtrl2.prototype.getHeaderCellCtrl = function(column) {
      return values(this.headerCellCtrls).find(function(cellCtrl) {
        return cellCtrl.getColumnGroupChild() === column;
      });
    };
    HeaderRowCtrl2.prototype.onDisplayedColumnsChanged = function() {
      this.onVirtualColumnsChanged();
      this.setWidth();
      this.onRowHeightChanged();
    };
    HeaderRowCtrl2.prototype.getType = function() {
      return this.type;
    };
    HeaderRowCtrl2.prototype.onColumnResized = function() {
      this.setWidth();
    };
    HeaderRowCtrl2.prototype.setWidth = function() {
      var width = this.getWidthForRow();
      this.comp.setWidth(width + "px");
    };
    HeaderRowCtrl2.prototype.getWidthForRow = function() {
      var printLayout = this.gridOptionsService.isDomLayout("print");
      if (printLayout) {
        var pinned = this.pinned != null;
        if (pinned) {
          return 0;
        }
        return this.columnModel.getContainerWidth("right") + this.columnModel.getContainerWidth("left") + this.columnModel.getContainerWidth(null);
      }
      return this.columnModel.getContainerWidth(this.pinned);
    };
    HeaderRowCtrl2.prototype.onRowHeightChanged = function() {
      var headerRowCount = this.columnModel.getHeaderRowCount();
      var sizes = [];
      var numberOfFloating = 0;
      if (this.columnModel.hasFloatingFilters()) {
        headerRowCount++;
        numberOfFloating = 1;
      }
      var groupHeight = this.columnModel.getColumnGroupHeaderRowHeight();
      var headerHeight = this.columnModel.getColumnHeaderRowHeight();
      var numberOfNonGroups = 1 + numberOfFloating;
      var numberOfGroups = headerRowCount - numberOfNonGroups;
      for (var i = 0; i < numberOfGroups; i++) {
        sizes.push(groupHeight);
      }
      sizes.push(headerHeight);
      for (var i = 0; i < numberOfFloating; i++) {
        sizes.push(this.columnModel.getFloatingFiltersHeight());
      }
      var topOffset = 0;
      for (var i = 0; i < this.rowIndex; i++) {
        topOffset += sizes[i];
      }
      var thisRowHeight = sizes[this.rowIndex] + "px";
      this.comp.setTop(topOffset + "px");
      this.comp.setHeight(thisRowHeight);
    };
    HeaderRowCtrl2.prototype.getPinned = function() {
      return this.pinned;
    };
    HeaderRowCtrl2.prototype.getRowIndex = function() {
      return this.rowIndex;
    };
    HeaderRowCtrl2.prototype.onVirtualColumnsChanged = function() {
      var _this = this;
      var oldCtrls = this.headerCellCtrls;
      this.headerCellCtrls = {};
      var columns = this.getColumnsInViewport();
      columns.forEach(function(child) {
        if (child.isEmptyGroup()) {
          return;
        }
        var idOfChild = child.getUniqueId();
        var headerCtrl = oldCtrls[idOfChild];
        delete oldCtrls[idOfChild];
        var forOldColumn = headerCtrl && headerCtrl.getColumnGroupChild() != child;
        if (forOldColumn) {
          _this.destroyBean(headerCtrl);
          headerCtrl = void 0;
        }
        if (headerCtrl == null) {
          switch (_this.type) {
            case HeaderRowType.FLOATING_FILTER:
              headerCtrl = _this.createBean(new HeaderFilterCellCtrl(child, _this));
              break;
            case HeaderRowType.COLUMN_GROUP:
              headerCtrl = _this.createBean(new HeaderGroupCellCtrl(child, _this));
              break;
            default:
              headerCtrl = _this.createBean(new HeaderCellCtrl(child, _this));
              break;
          }
        }
        _this.headerCellCtrls[idOfChild] = headerCtrl;
      });
      var isFocusedAndDisplayed = function(ctrl) {
        var isFocused = _this.focusService.isHeaderWrapperFocused(ctrl);
        if (!isFocused) {
          return false;
        }
        var isDisplayed = _this.columnModel.isDisplayed(ctrl.getColumnGroupChild());
        return isDisplayed;
      };
      iterateObject(oldCtrls, function(id2, oldCtrl) {
        var keepCtrl = isFocusedAndDisplayed(oldCtrl);
        if (keepCtrl) {
          _this.headerCellCtrls[id2] = oldCtrl;
        } else {
          _this.destroyBean(oldCtrl);
        }
      });
      var ctrlsToDisplay = getAllValuesInObject(this.headerCellCtrls);
      this.comp.setHeaderCtrls(ctrlsToDisplay);
    };
    HeaderRowCtrl2.prototype.getColumnsInViewport = function() {
      var printLayout = this.gridOptionsService.isDomLayout("print");
      return printLayout ? this.getColumnsInViewportPrintLayout() : this.getColumnsInViewportNormalLayout();
    };
    HeaderRowCtrl2.prototype.getColumnsInViewportPrintLayout = function() {
      var _this = this;
      if (this.pinned != null) {
        return [];
      }
      var viewportColumns = [];
      var actualDepth = this.getActualDepth();
      ["left", null, "right"].forEach(function(pinned) {
        var items = _this.columnModel.getVirtualHeaderGroupRow(pinned, actualDepth);
        viewportColumns = viewportColumns.concat(items);
      });
      return viewportColumns;
    };
    HeaderRowCtrl2.prototype.getActualDepth = function() {
      return this.type == HeaderRowType.FLOATING_FILTER ? this.rowIndex - 1 : this.rowIndex;
    };
    HeaderRowCtrl2.prototype.getColumnsInViewportNormalLayout = function() {
      return this.columnModel.getVirtualHeaderGroupRow(this.pinned, this.getActualDepth());
    };
    HeaderRowCtrl2.prototype.focusHeader = function(column, event) {
      var allCtrls = getAllValuesInObject(this.headerCellCtrls);
      var ctrl = allCtrls.find(function(ctrl2) {
        return ctrl2.getColumnGroupChild() == column;
      });
      if (!ctrl) {
        return false;
      }
      ctrl.focus(event);
      return true;
    };
    HeaderRowCtrl2.prototype.destroy = function() {
      var _this = this;
      iterateObject(this.headerCellCtrls, function(key, ctrl) {
        _this.destroyBean(ctrl);
      });
      this.headerCellCtrls = {};
      _super.prototype.destroy.call(this);
    };
    __decorate$1g([
      Autowired("columnModel")
    ], HeaderRowCtrl2.prototype, "columnModel", void 0);
    __decorate$1g([
      Autowired("focusService")
    ], HeaderRowCtrl2.prototype, "focusService", void 0);
    return HeaderRowCtrl2;
  }(BeanStub)
);
var __extends$1j = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1f = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$f = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$d = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var HeaderRowContainerCtrl = (
  /** @class */
  function(_super) {
    __extends$1j(HeaderRowContainerCtrl2, _super);
    function HeaderRowContainerCtrl2(pinned) {
      var _this = _super.call(this) || this;
      _this.hidden = false;
      _this.includeFloatingFilter = false;
      _this.groupsRowCtrls = [];
      _this.pinned = pinned;
      return _this;
    }
    HeaderRowContainerCtrl2.prototype.setComp = function(comp, eGui) {
      this.comp = comp;
      this.eViewport = eGui;
      this.setupCenterWidth();
      this.setupPinnedWidth();
      this.setupDragAndDrop(this.eViewport);
      this.addManagedListener(this.eventService, Events.EVENT_GRID_COLUMNS_CHANGED, this.onGridColumnsChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.onDisplayedColumnsChanged.bind(this));
      this.ctrlsService.registerHeaderContainer(this, this.pinned);
      if (this.columnModel.isReady()) {
        this.refresh();
      }
    };
    HeaderRowContainerCtrl2.prototype.setupDragAndDrop = function(dropContainer) {
      var bodyDropTarget = new BodyDropTarget(this.pinned, dropContainer);
      this.createManagedBean(bodyDropTarget);
    };
    HeaderRowContainerCtrl2.prototype.refresh = function(keepColumns) {
      var _this = this;
      if (keepColumns === void 0) {
        keepColumns = false;
      }
      var sequence = new NumberSequence();
      var focusedHeaderPosition = this.focusService.getFocusHeaderToUseAfterRefresh();
      var refreshColumnGroups = function() {
        var groupRowCount = _this.columnModel.getHeaderRowCount() - 1;
        _this.groupsRowCtrls = _this.destroyBeans(_this.groupsRowCtrls);
        for (var i = 0; i < groupRowCount; i++) {
          var ctrl = _this.createBean(new HeaderRowCtrl(sequence.next(), _this.pinned, HeaderRowType.COLUMN_GROUP));
          _this.groupsRowCtrls.push(ctrl);
        }
      };
      var refreshColumns = function() {
        var rowIndex = sequence.next();
        var needNewInstance = !_this.hidden && (_this.columnsRowCtrl == null || !keepColumns || _this.columnsRowCtrl.getRowIndex() !== rowIndex);
        var shouldDestroyInstance = needNewInstance || _this.hidden;
        if (shouldDestroyInstance) {
          _this.columnsRowCtrl = _this.destroyBean(_this.columnsRowCtrl);
        }
        if (needNewInstance) {
          _this.columnsRowCtrl = _this.createBean(new HeaderRowCtrl(rowIndex, _this.pinned, HeaderRowType.COLUMN));
        }
      };
      var refreshFilters = function() {
        _this.includeFloatingFilter = _this.columnModel.hasFloatingFilters() && !_this.hidden;
        var destroyPreviousComp = function() {
          _this.filtersRowCtrl = _this.destroyBean(_this.filtersRowCtrl);
        };
        if (!_this.includeFloatingFilter) {
          destroyPreviousComp();
          return;
        }
        var rowIndex = sequence.next();
        if (_this.filtersRowCtrl) {
          var rowIndexMismatch = _this.filtersRowCtrl.getRowIndex() !== rowIndex;
          if (!keepColumns || rowIndexMismatch) {
            destroyPreviousComp();
          }
        }
        if (!_this.filtersRowCtrl) {
          _this.filtersRowCtrl = _this.createBean(new HeaderRowCtrl(rowIndex, _this.pinned, HeaderRowType.FLOATING_FILTER));
        }
      };
      refreshColumnGroups();
      refreshColumns();
      refreshFilters();
      var allCtrls = this.getAllCtrls();
      this.comp.setCtrls(allCtrls);
      this.restoreFocusOnHeader(focusedHeaderPosition);
    };
    HeaderRowContainerCtrl2.prototype.restoreFocusOnHeader = function(position) {
      if (position == null || position.column.getPinned() != this.pinned) {
        return;
      }
      this.focusService.focusHeaderPosition({ headerPosition: position });
    };
    HeaderRowContainerCtrl2.prototype.getAllCtrls = function() {
      var res = __spreadArray$d([], __read$f(this.groupsRowCtrls));
      if (this.columnsRowCtrl) {
        res.push(this.columnsRowCtrl);
      }
      if (this.filtersRowCtrl) {
        res.push(this.filtersRowCtrl);
      }
      return res;
    };
    HeaderRowContainerCtrl2.prototype.onGridColumnsChanged = function() {
      this.refresh(true);
    };
    HeaderRowContainerCtrl2.prototype.onDisplayedColumnsChanged = function() {
      var includeFloatingFilter = this.columnModel.hasFloatingFilters() && !this.hidden;
      if (this.includeFloatingFilter !== includeFloatingFilter) {
        this.refresh(true);
      }
    };
    HeaderRowContainerCtrl2.prototype.setupCenterWidth = function() {
      var _this = this;
      if (this.pinned != null) {
        return;
      }
      this.createManagedBean(new CenterWidthFeature(function(width) {
        return _this.comp.setCenterWidth(width + "px");
      }, true));
    };
    HeaderRowContainerCtrl2.prototype.setHorizontalScroll = function(offset2) {
      this.comp.setViewportScrollLeft(offset2);
    };
    HeaderRowContainerCtrl2.prototype.setupPinnedWidth = function() {
      var _this = this;
      if (this.pinned == null) {
        return;
      }
      var pinningLeft = this.pinned === "left";
      var pinningRight = this.pinned === "right";
      this.hidden = true;
      var listener = function() {
        var width = pinningLeft ? _this.pinnedWidthService.getPinnedLeftWidth() : _this.pinnedWidthService.getPinnedRightWidth();
        if (width == null) {
          return;
        }
        var hidden = width == 0;
        var hiddenChanged = _this.hidden !== hidden;
        var isRtl = _this.gridOptionsService.is("enableRtl");
        var scrollbarWidth = _this.gridOptionsService.getScrollbarWidth();
        var addPaddingForScrollbar = _this.scrollVisibleService.isVerticalScrollShowing() && (isRtl && pinningLeft || !isRtl && pinningRight);
        var widthWithPadding = addPaddingForScrollbar ? width + scrollbarWidth : width;
        _this.comp.setPinnedContainerWidth(widthWithPadding + "px");
        _this.comp.setDisplayed(!hidden);
        if (hiddenChanged) {
          _this.hidden = hidden;
          _this.refresh();
        }
      };
      this.addManagedListener(this.eventService, Events.EVENT_LEFT_PINNED_WIDTH_CHANGED, listener);
      this.addManagedListener(this.eventService, Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED, listener);
      this.addManagedListener(this.eventService, Events.EVENT_SCROLL_VISIBILITY_CHANGED, listener);
      this.addManagedListener(this.eventService, Events.EVENT_SCROLLBAR_WIDTH_CHANGED, listener);
    };
    HeaderRowContainerCtrl2.prototype.getHeaderCtrlForColumn = function(column) {
      if (column instanceof Column) {
        if (!this.columnsRowCtrl) {
          return;
        }
        return this.columnsRowCtrl.getHeaderCellCtrl(column);
      }
      if (this.groupsRowCtrls.length === 0) {
        return;
      }
      for (var i = 0; i < this.groupsRowCtrls.length; i++) {
        var ctrl = this.groupsRowCtrls[i].getHeaderCellCtrl(column);
        if (ctrl) {
          return ctrl;
        }
      }
    };
    HeaderRowContainerCtrl2.prototype.getHtmlElementForColumnHeader = function(column) {
      var cellCtrl = this.getHeaderCtrlForColumn(column);
      if (!cellCtrl) {
        return null;
      }
      return cellCtrl.getGui();
    };
    HeaderRowContainerCtrl2.prototype.getRowType = function(rowIndex) {
      var allCtrls = this.getAllCtrls();
      var ctrl = allCtrls[rowIndex];
      return ctrl ? ctrl.getType() : void 0;
    };
    HeaderRowContainerCtrl2.prototype.focusHeader = function(rowIndex, column, event) {
      var allCtrls = this.getAllCtrls();
      var ctrl = allCtrls[rowIndex];
      if (!ctrl) {
        return false;
      }
      return ctrl.focusHeader(column, event);
    };
    HeaderRowContainerCtrl2.prototype.getRowCount = function() {
      return this.groupsRowCtrls.length + (this.columnsRowCtrl ? 1 : 0) + (this.filtersRowCtrl ? 1 : 0);
    };
    HeaderRowContainerCtrl2.prototype.destroy = function() {
      if (this.filtersRowCtrl) {
        this.filtersRowCtrl = this.destroyBean(this.filtersRowCtrl);
      }
      if (this.columnsRowCtrl) {
        this.columnsRowCtrl = this.destroyBean(this.columnsRowCtrl);
      }
      if (this.groupsRowCtrls && this.groupsRowCtrls.length) {
        this.groupsRowCtrls = this.destroyBeans(this.groupsRowCtrls);
      }
      _super.prototype.destroy.call(this);
    };
    __decorate$1f([
      Autowired("ctrlsService")
    ], HeaderRowContainerCtrl2.prototype, "ctrlsService", void 0);
    __decorate$1f([
      Autowired("scrollVisibleService")
    ], HeaderRowContainerCtrl2.prototype, "scrollVisibleService", void 0);
    __decorate$1f([
      Autowired("pinnedWidthService")
    ], HeaderRowContainerCtrl2.prototype, "pinnedWidthService", void 0);
    __decorate$1f([
      Autowired("columnModel")
    ], HeaderRowContainerCtrl2.prototype, "columnModel", void 0);
    __decorate$1f([
      Autowired("focusService")
    ], HeaderRowContainerCtrl2.prototype, "focusService", void 0);
    return HeaderRowContainerCtrl2;
  }(BeanStub)
);
var __extends$1i = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1e = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderRowContainerComp$1 = (
  /** @class */
  function(_super) {
    __extends$1i(HeaderRowContainerComp2, _super);
    function HeaderRowContainerComp2(pinned) {
      var _this = _super.call(this) || this;
      _this.headerRowComps = {};
      _this.rowCompsList = [];
      _this.pinned = pinned;
      return _this;
    }
    HeaderRowContainerComp2.prototype.init = function() {
      var _this = this;
      this.selectAndSetTemplate();
      var compProxy = {
        setDisplayed: function(displayed) {
          return _this.setDisplayed(displayed);
        },
        setCtrls: function(ctrls) {
          return _this.setCtrls(ctrls);
        },
        // only gets called for center section
        setCenterWidth: function(width) {
          return _this.eCenterContainer.style.width = width;
        },
        setViewportScrollLeft: function(left) {
          return _this.getGui().scrollLeft = left;
        },
        // only gets called for pinned sections
        setPinnedContainerWidth: function(width) {
          var eGui = _this.getGui();
          eGui.style.width = width;
          eGui.style.maxWidth = width;
          eGui.style.minWidth = width;
        }
      };
      var ctrl = this.createManagedBean(new HeaderRowContainerCtrl(this.pinned));
      ctrl.setComp(compProxy, this.getGui());
    };
    HeaderRowContainerComp2.prototype.selectAndSetTemplate = function() {
      var pinnedLeft = this.pinned == "left";
      var pinnedRight = this.pinned == "right";
      var template = pinnedLeft ? HeaderRowContainerComp2.PINNED_LEFT_TEMPLATE : pinnedRight ? HeaderRowContainerComp2.PINNED_RIGHT_TEMPLATE : HeaderRowContainerComp2.CENTER_TEMPLATE;
      this.setTemplate(template);
      this.eRowContainer = this.eCenterContainer ? this.eCenterContainer : this.getGui();
    };
    HeaderRowContainerComp2.prototype.destroyRowComps = function() {
      this.setCtrls([]);
    };
    HeaderRowContainerComp2.prototype.destroyRowComp = function(rowComp2) {
      this.destroyBean(rowComp2);
      this.eRowContainer.removeChild(rowComp2.getGui());
    };
    HeaderRowContainerComp2.prototype.setCtrls = function(ctrls) {
      var _this = this;
      var oldRowComps = this.headerRowComps;
      this.headerRowComps = {};
      this.rowCompsList = [];
      var prevGui;
      var appendEnsuringDomOrder = function(rowComp2) {
        var eGui = rowComp2.getGui();
        var notAlreadyIn = eGui.parentElement != _this.eRowContainer;
        if (notAlreadyIn) {
          _this.eRowContainer.appendChild(eGui);
        }
        if (prevGui) {
          ensureDomOrder(_this.eRowContainer, eGui, prevGui);
        }
        prevGui = eGui;
      };
      ctrls.forEach(function(ctrl) {
        var ctrlId = ctrl.getInstanceId();
        var existingComp = oldRowComps[ctrlId];
        delete oldRowComps[ctrlId];
        var rowComp2 = existingComp ? existingComp : _this.createBean(new HeaderRowComp$1(ctrl));
        _this.headerRowComps[ctrlId] = rowComp2;
        _this.rowCompsList.push(rowComp2);
        appendEnsuringDomOrder(rowComp2);
      });
      getAllValuesInObject(oldRowComps).forEach(function(c) {
        return _this.destroyRowComp(c);
      });
    };
    HeaderRowContainerComp2.PINNED_LEFT_TEMPLATE = '<div class="ag-pinned-left-header" role="presentation"></div>';
    HeaderRowContainerComp2.PINNED_RIGHT_TEMPLATE = '<div class="ag-pinned-right-header" role="presentation"></div>';
    HeaderRowContainerComp2.CENTER_TEMPLATE = '<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>';
    __decorate$1e([
      RefSelector("eCenterContainer")
    ], HeaderRowContainerComp2.prototype, "eCenterContainer", void 0);
    __decorate$1e([
      PostConstruct
    ], HeaderRowContainerComp2.prototype, "init", null);
    __decorate$1e([
      PreDestroy
    ], HeaderRowContainerComp2.prototype, "destroyRowComps", null);
    return HeaderRowContainerComp2;
  }(Component)
);
var __extends$1h = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1d = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderNavigationDirection;
(function(HeaderNavigationDirection2) {
  HeaderNavigationDirection2[HeaderNavigationDirection2["UP"] = 0] = "UP";
  HeaderNavigationDirection2[HeaderNavigationDirection2["DOWN"] = 1] = "DOWN";
  HeaderNavigationDirection2[HeaderNavigationDirection2["LEFT"] = 2] = "LEFT";
  HeaderNavigationDirection2[HeaderNavigationDirection2["RIGHT"] = 3] = "RIGHT";
})(HeaderNavigationDirection || (HeaderNavigationDirection = {}));
var HeaderNavigationService = (
  /** @class */
  function(_super) {
    __extends$1h(HeaderNavigationService2, _super);
    function HeaderNavigationService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    HeaderNavigationService2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function(p2) {
        _this.gridBodyCon = p2.gridBodyCtrl;
      });
    };
    HeaderNavigationService2.prototype.getHeaderRowCount = function() {
      var centerHeaderContainer = this.ctrlsService.getHeaderRowContainerCtrl();
      return centerHeaderContainer ? centerHeaderContainer.getRowCount() : 0;
    };
    HeaderNavigationService2.prototype.navigateVertically = function(direction, fromHeader, event) {
      if (!fromHeader) {
        fromHeader = this.focusService.getFocusedHeader();
      }
      if (!fromHeader) {
        return false;
      }
      var headerRowIndex = fromHeader.headerRowIndex, column = fromHeader.column;
      var rowLen = this.getHeaderRowCount();
      var isUp = direction === HeaderNavigationDirection.UP;
      var _a2 = isUp ? this.headerPositionUtils.getColumnVisibleParent(column, headerRowIndex) : this.headerPositionUtils.getColumnVisibleChild(column, headerRowIndex), nextRow = _a2.nextRow, nextFocusColumn = _a2.nextFocusColumn;
      var skipColumn = false;
      if (nextRow < 0) {
        nextRow = 0;
        nextFocusColumn = column;
        skipColumn = true;
      }
      if (nextRow >= rowLen) {
        nextRow = -1;
      }
      if (!skipColumn && !nextFocusColumn) {
        return false;
      }
      return this.focusService.focusHeaderPosition({
        headerPosition: { headerRowIndex: nextRow, column: nextFocusColumn },
        allowUserOverride: true,
        event
      });
    };
    HeaderNavigationService2.prototype.navigateHorizontally = function(direction, fromTab, event) {
      if (fromTab === void 0) {
        fromTab = false;
      }
      var focusedHeader = this.focusService.getFocusedHeader();
      var isLeft = direction === HeaderNavigationDirection.LEFT;
      var isRtl = this.gridOptionsService.is("enableRtl");
      var nextHeader;
      var normalisedDirection;
      if (isLeft !== isRtl) {
        normalisedDirection = "Before";
        nextHeader = this.headerPositionUtils.findHeader(focusedHeader, normalisedDirection);
      } else {
        normalisedDirection = "After";
        nextHeader = this.headerPositionUtils.findHeader(focusedHeader, normalisedDirection);
      }
      if (nextHeader || !fromTab) {
        return this.focusService.focusHeaderPosition({
          headerPosition: nextHeader,
          direction: normalisedDirection,
          fromTab,
          allowUserOverride: true,
          event
        });
      }
      return this.focusNextHeaderRow(focusedHeader, normalisedDirection, event);
    };
    HeaderNavigationService2.prototype.focusNextHeaderRow = function(focusedHeader, direction, event) {
      var currentIndex = focusedHeader.headerRowIndex;
      var nextPosition = null;
      var nextRowIndex;
      if (direction === "Before") {
        if (currentIndex > 0) {
          nextRowIndex = currentIndex - 1;
          nextPosition = this.headerPositionUtils.findColAtEdgeForHeaderRow(nextRowIndex, "end");
        }
      } else {
        nextRowIndex = currentIndex + 1;
        nextPosition = this.headerPositionUtils.findColAtEdgeForHeaderRow(nextRowIndex, "start");
      }
      return this.focusService.focusHeaderPosition({
        headerPosition: nextPosition,
        direction,
        fromTab: true,
        allowUserOverride: true,
        event
      });
    };
    HeaderNavigationService2.prototype.scrollToColumn = function(column, direction) {
      if (direction === void 0) {
        direction = "After";
      }
      if (column.getPinned()) {
        return;
      }
      var columnToScrollTo;
      if (column instanceof ColumnGroup) {
        var columns = column.getDisplayedLeafColumns();
        columnToScrollTo = direction === "Before" ? last(columns) : columns[0];
      } else {
        columnToScrollTo = column;
      }
      this.gridBodyCon.getScrollFeature().ensureColumnVisible(columnToScrollTo);
    };
    __decorate$1d([
      Autowired("focusService")
    ], HeaderNavigationService2.prototype, "focusService", void 0);
    __decorate$1d([
      Autowired("headerPositionUtils")
    ], HeaderNavigationService2.prototype, "headerPositionUtils", void 0);
    __decorate$1d([
      Autowired("ctrlsService")
    ], HeaderNavigationService2.prototype, "ctrlsService", void 0);
    __decorate$1d([
      PostConstruct
    ], HeaderNavigationService2.prototype, "postConstruct", null);
    HeaderNavigationService2 = __decorate$1d([
      Bean("headerNavigationService")
    ], HeaderNavigationService2);
    return HeaderNavigationService2;
  }(BeanStub)
);
var __extends$1g = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1c = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GridHeaderCtrl = (
  /** @class */
  function(_super) {
    __extends$1g(GridHeaderCtrl2, _super);
    function GridHeaderCtrl2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    GridHeaderCtrl2.prototype.setComp = function(comp, eGui, eFocusableElement) {
      this.comp = comp;
      this.eGui = eGui;
      this.createManagedBean(new ManagedFocusFeature(eFocusableElement, {
        onTabKeyDown: this.onTabKeyDown.bind(this),
        handleKeyDown: this.handleKeyDown.bind(this),
        onFocusOut: this.onFocusOut.bind(this)
      }));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_MODE_CHANGED, this.onPivotModeChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.onDisplayedColumnsChanged.bind(this));
      this.onPivotModeChanged();
      this.setupHeaderHeight();
      this.ctrlsService.registerGridHeaderCtrl(this);
    };
    GridHeaderCtrl2.prototype.setupHeaderHeight = function() {
      var listener = this.setHeaderHeight.bind(this);
      listener();
      this.addManagedPropertyListener("headerHeight", listener);
      this.addManagedPropertyListener("pivotHeaderHeight", listener);
      this.addManagedPropertyListener("groupHeaderHeight", listener);
      this.addManagedPropertyListener("pivotGroupHeaderHeight", listener);
      this.addManagedPropertyListener("floatingFiltersHeight", listener);
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, listener);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED, listener);
      this.addManagedListener(this.eventService, Events.EVENT_GRID_STYLES_CHANGED, listener);
    };
    GridHeaderCtrl2.prototype.getHeaderHeight = function() {
      return this.headerHeight;
    };
    GridHeaderCtrl2.prototype.setHeaderHeight = function() {
      var columnModel = this.columnModel;
      var numberOfFloating = 0;
      var headerRowCount = columnModel.getHeaderRowCount();
      var totalHeaderHeight;
      var hasFloatingFilters = columnModel.hasFloatingFilters();
      if (hasFloatingFilters) {
        headerRowCount++;
        numberOfFloating = 1;
      }
      var groupHeight = this.columnModel.getColumnGroupHeaderRowHeight();
      var headerHeight = this.columnModel.getColumnHeaderRowHeight();
      var numberOfNonGroups = 1 + numberOfFloating;
      var numberOfGroups = headerRowCount - numberOfNonGroups;
      totalHeaderHeight = numberOfFloating * columnModel.getFloatingFiltersHeight();
      totalHeaderHeight += numberOfGroups * groupHeight;
      totalHeaderHeight += headerHeight;
      if (this.headerHeight === totalHeaderHeight) {
        return;
      }
      this.headerHeight = totalHeaderHeight;
      var px = totalHeaderHeight + 1 + "px";
      this.comp.setHeightAndMinHeight(px);
      this.eventService.dispatchEvent({
        type: Events.EVENT_HEADER_HEIGHT_CHANGED
      });
    };
    GridHeaderCtrl2.prototype.onPivotModeChanged = function() {
      var pivotMode = this.columnModel.isPivotMode();
      this.comp.addOrRemoveCssClass("ag-pivot-on", pivotMode);
      this.comp.addOrRemoveCssClass("ag-pivot-off", !pivotMode);
    };
    GridHeaderCtrl2.prototype.onDisplayedColumnsChanged = function() {
      var columns = this.columnModel.getAllDisplayedColumns();
      var shouldAllowOverflow = columns.some(function(col) {
        return col.isSpanHeaderHeight();
      });
      this.comp.addOrRemoveCssClass("ag-header-allow-overflow", shouldAllowOverflow);
    };
    GridHeaderCtrl2.prototype.onTabKeyDown = function(e) {
      var isRtl = this.gridOptionsService.is("enableRtl");
      var direction = e.shiftKey !== isRtl ? HeaderNavigationDirection.LEFT : HeaderNavigationDirection.RIGHT;
      if (this.headerNavigationService.navigateHorizontally(direction, true, e) || this.focusService.focusNextGridCoreContainer(e.shiftKey)) {
        e.preventDefault();
      }
    };
    GridHeaderCtrl2.prototype.handleKeyDown = function(e) {
      var direction = null;
      switch (e.key) {
        case KeyCode.LEFT:
          direction = HeaderNavigationDirection.LEFT;
        case KeyCode.RIGHT:
          if (!exists(direction)) {
            direction = HeaderNavigationDirection.RIGHT;
          }
          this.headerNavigationService.navigateHorizontally(direction, false, e);
          break;
        case KeyCode.UP:
          direction = HeaderNavigationDirection.UP;
        case KeyCode.DOWN:
          if (!exists(direction)) {
            direction = HeaderNavigationDirection.DOWN;
          }
          if (this.headerNavigationService.navigateVertically(direction, null, e)) {
            e.preventDefault();
          }
          break;
        default:
          return;
      }
    };
    GridHeaderCtrl2.prototype.onFocusOut = function(e) {
      var eDocument = this.gridOptionsService.getDocument();
      var relatedTarget = e.relatedTarget;
      if (!relatedTarget && this.eGui.contains(eDocument.activeElement)) {
        return;
      }
      if (!this.eGui.contains(relatedTarget)) {
        this.focusService.clearFocusedHeader();
      }
    };
    __decorate$1c([
      Autowired("headerNavigationService")
    ], GridHeaderCtrl2.prototype, "headerNavigationService", void 0);
    __decorate$1c([
      Autowired("focusService")
    ], GridHeaderCtrl2.prototype, "focusService", void 0);
    __decorate$1c([
      Autowired("columnModel")
    ], GridHeaderCtrl2.prototype, "columnModel", void 0);
    __decorate$1c([
      Autowired("ctrlsService")
    ], GridHeaderCtrl2.prototype, "ctrlsService", void 0);
    return GridHeaderCtrl2;
  }(BeanStub)
);
var __extends$1f = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1b = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GridHeaderComp$1 = (
  /** @class */
  function(_super) {
    __extends$1f(GridHeaderComp2, _super);
    function GridHeaderComp2() {
      return _super.call(this, GridHeaderComp2.TEMPLATE) || this;
    }
    GridHeaderComp2.prototype.postConstruct = function() {
      var _this = this;
      var compProxy = {
        addOrRemoveCssClass: function(cssClassName, on) {
          return _this.addOrRemoveCssClass(cssClassName, on);
        },
        setHeightAndMinHeight: function(height) {
          _this.getGui().style.height = height;
          _this.getGui().style.minHeight = height;
        }
      };
      var ctrl = this.createManagedBean(new GridHeaderCtrl());
      ctrl.setComp(compProxy, this.getGui(), this.getFocusableElement());
      var addContainer = function(container) {
        _this.createManagedBean(container);
        _this.appendChild(container);
      };
      addContainer(new HeaderRowContainerComp$1("left"));
      addContainer(new HeaderRowContainerComp$1(null));
      addContainer(new HeaderRowContainerComp$1("right"));
    };
    GridHeaderComp2.TEMPLATE = '<div class="ag-header" role="presentation"/>';
    __decorate$1b([
      PostConstruct
    ], GridHeaderComp2.prototype, "postConstruct", null);
    return GridHeaderComp2;
  }(Component)
);
var __extends$1e = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1a = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HorizontalResizeService = (
  /** @class */
  function(_super) {
    __extends$1e(HorizontalResizeService2, _super);
    function HorizontalResizeService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    HorizontalResizeService2.prototype.addResizeBar = function(params) {
      var _this = this;
      var dragSource = {
        dragStartPixels: params.dragStartPixels || 0,
        eElement: params.eResizeBar,
        onDragStart: this.onDragStart.bind(this, params),
        onDragStop: this.onDragStop.bind(this, params),
        onDragging: this.onDragging.bind(this, params),
        includeTouch: true,
        stopPropagationForTouch: true
      };
      this.dragService.addDragSource(dragSource);
      var finishedWithResizeFunc = function() {
        return _this.dragService.removeDragSource(dragSource);
      };
      return finishedWithResizeFunc;
    };
    HorizontalResizeService2.prototype.onDragStart = function(params, mouseEvent) {
      this.dragStartX = mouseEvent.clientX;
      this.setResizeIcons();
      var shiftKey = mouseEvent instanceof MouseEvent && mouseEvent.shiftKey === true;
      params.onResizeStart(shiftKey);
    };
    HorizontalResizeService2.prototype.setResizeIcons = function() {
      var ctrl = this.ctrlsService.getGridCtrl();
      ctrl.setResizeCursor(true);
      ctrl.disableUserSelect(true);
    };
    HorizontalResizeService2.prototype.onDragStop = function(params, mouseEvent) {
      params.onResizeEnd(this.resizeAmount);
      this.resetIcons();
    };
    HorizontalResizeService2.prototype.resetIcons = function() {
      var ctrl = this.ctrlsService.getGridCtrl();
      ctrl.setResizeCursor(false);
      ctrl.disableUserSelect(false);
    };
    HorizontalResizeService2.prototype.onDragging = function(params, mouseEvent) {
      this.resizeAmount = mouseEvent.clientX - this.dragStartX;
      params.onResizing(this.resizeAmount);
    };
    __decorate$1a([
      Autowired("dragService")
    ], HorizontalResizeService2.prototype, "dragService", void 0);
    __decorate$1a([
      Autowired("ctrlsService")
    ], HorizontalResizeService2.prototype, "ctrlsService", void 0);
    HorizontalResizeService2 = __decorate$1a([
      Bean("horizontalResizeService")
    ], HorizontalResizeService2);
    return HorizontalResizeService2;
  }(BeanStub)
);
var __extends$1d = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$19 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var StandardMenuFactory = (
  /** @class */
  function(_super) {
    __extends$1d(StandardMenuFactory2, _super);
    function StandardMenuFactory2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    StandardMenuFactory2.prototype.hideActiveMenu = function() {
      if (this.hidePopup) {
        this.hidePopup();
      }
    };
    StandardMenuFactory2.prototype.showMenuAfterMouseEvent = function(column, mouseEvent) {
      var _this = this;
      this.showPopup(column, function(eMenu) {
        _this.popupService.positionPopupUnderMouseEvent({
          column,
          type: "columnMenu",
          mouseEvent,
          ePopup: eMenu
        });
      }, "columnMenu", mouseEvent.target);
    };
    StandardMenuFactory2.prototype.showMenuAfterButtonClick = function(column, eventSource, containerType) {
      var _this = this;
      this.showPopup(column, function(eMenu) {
        _this.popupService.positionPopupByComponent({
          type: containerType,
          eventSource,
          ePopup: eMenu,
          keepWithinBounds: true,
          position: "under",
          column
        });
      }, containerType, eventSource);
    };
    StandardMenuFactory2.prototype.showPopup = function(column, positionCallback, containerType, eventSource) {
      var _this = this;
      var filterWrapper = this.filterManager.getOrCreateFilterWrapper(column, "COLUMN_MENU");
      if (!filterWrapper) {
        throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");
      }
      var eMenu = document.createElement("div");
      setAriaRole(eMenu, "presentation");
      eMenu.classList.add("ag-menu");
      this.tabListener = this.addManagedListener(eMenu, "keydown", function(e) {
        return _this.trapFocusWithin(e, eMenu);
      });
      filterWrapper.guiPromise.then(function(gui) {
        return eMenu.appendChild(gui);
      });
      var hidePopup;
      var afterGuiDetached = function() {
        var _a2;
        return (_a2 = filterWrapper.filterPromise) === null || _a2 === void 0 ? void 0 : _a2.then(function(filter) {
          var _a3;
          return (_a3 = filter === null || filter === void 0 ? void 0 : filter.afterGuiDetached) === null || _a3 === void 0 ? void 0 : _a3.call(filter);
        });
      };
      var anchorToElement = eventSource || this.ctrlsService.getGridBodyCtrl().getGui();
      var closedCallback = function(e) {
        column.setMenuVisible(false, "contextMenu");
        var isKeyboardEvent = e instanceof KeyboardEvent;
        if (_this.tabListener) {
          _this.tabListener = _this.tabListener();
        }
        if (isKeyboardEvent && eventSource && isVisible(eventSource)) {
          var focusableEl = _this.focusService.findTabbableParent(eventSource);
          if (focusableEl) {
            focusableEl.focus();
          }
        }
        afterGuiDetached();
      };
      var translate = this.localeService.getLocaleTextFunc();
      var addPopupRes = this.popupService.addPopup({
        modal: true,
        eChild: eMenu,
        closeOnEsc: true,
        closedCallback,
        positionCallback: function() {
          return positionCallback(eMenu);
        },
        anchorToElement,
        ariaLabel: translate("ariaLabelColumnMenu", "Column Menu")
      });
      if (addPopupRes) {
        this.hidePopup = hidePopup = addPopupRes.hideFunc;
      }
      filterWrapper.filterPromise.then(function(filter) {
        positionCallback(eMenu);
        if (filter.afterGuiAttached) {
          filter.afterGuiAttached({ container: containerType, hidePopup });
        }
      });
      column.setMenuVisible(true, "contextMenu");
    };
    StandardMenuFactory2.prototype.trapFocusWithin = function(e, menu) {
      if (e.key !== KeyCode.TAB || e.defaultPrevented || this.focusService.findNextFocusableElement(menu, false, e.shiftKey)) {
        return;
      }
      e.preventDefault();
      this.focusService.focusInto(menu, e.shiftKey);
    };
    StandardMenuFactory2.prototype.isMenuEnabled = function(column) {
      return column.isFilterAllowed() && column.getMenuTabs(["filterMenuTab"]).includes("filterMenuTab");
    };
    __decorate$19([
      Autowired("filterManager")
    ], StandardMenuFactory2.prototype, "filterManager", void 0);
    __decorate$19([
      Autowired("popupService")
    ], StandardMenuFactory2.prototype, "popupService", void 0);
    __decorate$19([
      Autowired("focusService")
    ], StandardMenuFactory2.prototype, "focusService", void 0);
    __decorate$19([
      Autowired("ctrlsService")
    ], StandardMenuFactory2.prototype, "ctrlsService", void 0);
    StandardMenuFactory2 = __decorate$19([
      Bean("menuFactory")
    ], StandardMenuFactory2);
    return StandardMenuFactory2;
  }(BeanStub)
);
var __extends$1c = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$18 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var TabbedLayout = (
  /** @class */
  function(_super) {
    __extends$1c(TabbedLayout2, _super);
    function TabbedLayout2(params) {
      var _this = _super.call(this, TabbedLayout2.getTemplate(params.cssClass)) || this;
      _this.items = [];
      _this.tabbedItemScrollMap = /* @__PURE__ */ new Map();
      _this.params = params;
      if (params.items) {
        params.items.forEach(function(item) {
          return _this.addItem(item);
        });
      }
      return _this;
    }
    TabbedLayout2.prototype.postConstruct = function() {
      var _this = this;
      this.createManagedBean(new ManagedFocusFeature(this.getFocusableElement(), {
        onTabKeyDown: this.onTabKeyDown.bind(this),
        handleKeyDown: this.handleKeyDown.bind(this)
      }));
      this.addDestroyFunc(function() {
        var _a2, _b2, _c;
        return (_c = (_b2 = (_a2 = _this.activeItem) === null || _a2 === void 0 ? void 0 : _a2.tabbedItem) === null || _b2 === void 0 ? void 0 : _b2.afterDetachedCallback) === null || _c === void 0 ? void 0 : _c.call(_b2);
      });
    };
    TabbedLayout2.getTemplate = function(cssClass) {
      return (
        /* html */
        '<div class="ag-tabs ' + cssClass + '">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header ' + (cssClass ? cssClass + "-header" : "") + '"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body ' + (cssClass ? cssClass + "-body" : "") + '"></div>\n        </div>'
      );
    };
    TabbedLayout2.prototype.handleKeyDown = function(e) {
      var eDocument = this.gridOptionsService.getDocument();
      switch (e.key) {
        case KeyCode.RIGHT:
        case KeyCode.LEFT:
          if (!this.eHeader.contains(eDocument.activeElement)) {
            return;
          }
          var isRightKey = e.key === KeyCode.RIGHT;
          var isRtl = this.gridOptionsService.is("enableRtl");
          var currentPosition = this.items.indexOf(this.activeItem);
          var nextPosition = isRightKey !== isRtl ? Math.min(currentPosition + 1, this.items.length - 1) : Math.max(currentPosition - 1, 0);
          if (currentPosition === nextPosition) {
            return;
          }
          e.preventDefault();
          var nextItem = this.items[nextPosition];
          this.showItemWrapper(nextItem);
          nextItem.eHeaderButton.focus();
          break;
        case KeyCode.UP:
        case KeyCode.DOWN:
          e.stopPropagation();
          break;
      }
    };
    TabbedLayout2.prototype.onTabKeyDown = function(e) {
      if (e.defaultPrevented) {
        return;
      }
      var _a2 = this, focusService = _a2.focusService, eHeader = _a2.eHeader, eBody = _a2.eBody, activeItem = _a2.activeItem;
      var eDocument = this.gridOptionsService.getDocument();
      var activeElement = eDocument.activeElement;
      var target = e.target;
      e.preventDefault();
      if (eHeader.contains(activeElement)) {
        focusService.focusInto(eBody, e.shiftKey);
        return;
      }
      var nextEl = null;
      if (focusService.isTargetUnderManagedComponent(eBody, target)) {
        if (e.shiftKey) {
          nextEl = this.focusService.findFocusableElementBeforeTabGuard(eBody, target);
        }
        if (!nextEl) {
          nextEl = activeItem.eHeaderButton;
        }
      }
      if (!nextEl && eBody.contains(activeElement)) {
        nextEl = focusService.findNextFocusableElement(eBody, false, e.shiftKey);
        if (!nextEl) {
          nextEl = activeItem.eHeaderButton;
        }
      }
      if (nextEl) {
        nextEl.focus();
      }
    };
    TabbedLayout2.prototype.setAfterAttachedParams = function(params) {
      this.afterAttachedParams = params;
    };
    TabbedLayout2.prototype.showFirstItem = function() {
      if (this.items.length > 0) {
        this.showItemWrapper(this.items[0]);
      }
    };
    TabbedLayout2.prototype.addItem = function(item) {
      var eHeaderButton = document.createElement("span");
      setAriaRole(eHeaderButton, "tab");
      eHeaderButton.setAttribute("tabindex", "-1");
      eHeaderButton.appendChild(item.title);
      eHeaderButton.classList.add("ag-tab");
      this.eHeader.appendChild(eHeaderButton);
      setAriaLabel(eHeaderButton, item.titleLabel);
      var wrapper = {
        tabbedItem: item,
        eHeaderButton
      };
      this.items.push(wrapper);
      eHeaderButton.addEventListener("click", this.showItemWrapper.bind(this, wrapper));
    };
    TabbedLayout2.prototype.showItem = function(tabbedItem) {
      var itemWrapper = this.items.find(function(wrapper) {
        return wrapper.tabbedItem === tabbedItem;
      });
      if (itemWrapper) {
        this.showItemWrapper(itemWrapper);
      }
    };
    TabbedLayout2.prototype.showItemWrapper = function(wrapper) {
      var _this = this;
      var _a2, _b2;
      var tabbedItem = wrapper.tabbedItem, eHeaderButton = wrapper.eHeaderButton;
      if (this.params.onItemClicked) {
        this.params.onItemClicked({ item: tabbedItem });
      }
      if (this.activeItem === wrapper) {
        callIfPresent(this.params.onActiveItemClicked);
        return;
      }
      if (this.lastScrollListener) {
        this.lastScrollListener = this.lastScrollListener();
      }
      clearElement(this.eBody);
      tabbedItem.bodyPromise.then(function(body) {
        _this.eBody.appendChild(body);
        var onlyUnmanaged = !_this.focusService.isKeyboardMode();
        _this.focusService.focusInto(_this.eBody, false, onlyUnmanaged);
        if (tabbedItem.afterAttachedCallback) {
          tabbedItem.afterAttachedCallback(_this.afterAttachedParams);
        }
        if (_this.params.keepScrollPosition) {
          var scrollableContainer_1 = tabbedItem.getScrollableContainer && tabbedItem.getScrollableContainer() || body;
          _this.lastScrollListener = _this.addManagedListener(scrollableContainer_1, "scroll", function() {
            _this.tabbedItemScrollMap.set(tabbedItem.name, scrollableContainer_1.scrollTop);
          });
          var scrollPosition_1 = _this.tabbedItemScrollMap.get(tabbedItem.name);
          if (scrollPosition_1 !== void 0) {
            setTimeout(function() {
              scrollableContainer_1.scrollTop = scrollPosition_1;
            }, 0);
          }
        }
      });
      if (this.activeItem) {
        this.activeItem.eHeaderButton.classList.remove("ag-tab-selected");
        (_b2 = (_a2 = this.activeItem.tabbedItem).afterDetachedCallback) === null || _b2 === void 0 ? void 0 : _b2.call(_a2);
      }
      eHeaderButton.classList.add("ag-tab-selected");
      this.activeItem = wrapper;
    };
    __decorate$18([
      Autowired("focusService")
    ], TabbedLayout2.prototype, "focusService", void 0);
    __decorate$18([
      RefSelector("eHeader")
    ], TabbedLayout2.prototype, "eHeader", void 0);
    __decorate$18([
      RefSelector("eBody")
    ], TabbedLayout2.prototype, "eBody", void 0);
    __decorate$18([
      PostConstruct
    ], TabbedLayout2.prototype, "postConstruct", null);
    return TabbedLayout2;
  }(Component)
);
function simpleHttpRequest(params) {
  doOnce(function() {
    return console.warn("AG Grid: Since v29 simpleHttpRequest has been deprecated as it was only meant for use in internal AG Grid documentation examples. Please use the browser fetch api directly.");
  }, "simpleHttpRequest");
  return new AgPromise(function(resolve2) {
    var httpRequest = new XMLHttpRequest();
    httpRequest.open("GET", params.url);
    httpRequest.send();
    httpRequest.onreadystatechange = function() {
      if (httpRequest.readyState === 4 && httpRequest.status === 200) {
        resolve2(JSON.parse(httpRequest.responseText));
      }
    };
  });
}
var __extends$1b = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$17 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var DEBOUNCE_DELAY = 50;
var ResizeObserverService = (
  /** @class */
  function(_super) {
    __extends$1b(ResizeObserverService2, _super);
    function ResizeObserverService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.polyfillFunctions = [];
      return _this;
    }
    ResizeObserverService2.prototype.observeResize = function(element, callback2) {
      var _this = this;
      var win = this.gridOptionsService.getWindow();
      var useBrowserResizeObserver = function() {
        var resizeObserver = new win.ResizeObserver(callback2);
        resizeObserver.observe(element);
        return function() {
          return resizeObserver.disconnect();
        };
      };
      var usePolyfill = function() {
        var widthLastTime = offsetWidth(element);
        var heightLastTime = offsetHeight(element);
        var running = true;
        var periodicallyCheckWidthAndHeight = function() {
          if (running) {
            var newWidth = offsetWidth(element);
            var newHeight = offsetHeight(element);
            var changed = newWidth !== widthLastTime || newHeight !== heightLastTime;
            if (changed) {
              widthLastTime = newWidth;
              heightLastTime = newHeight;
              callback2();
            }
            _this.doNextPolyfillTurn(periodicallyCheckWidthAndHeight);
          }
        };
        periodicallyCheckWidthAndHeight();
        return function() {
          return running = false;
        };
      };
      var suppressResize = this.gridOptionsService.is("suppressBrowserResizeObserver");
      var resizeObserverExists = !!win.ResizeObserver;
      if (resizeObserverExists && !suppressResize) {
        return useBrowserResizeObserver();
      }
      return usePolyfill();
    };
    ResizeObserverService2.prototype.doNextPolyfillTurn = function(func) {
      this.polyfillFunctions.push(func);
      this.schedulePolyfill();
    };
    ResizeObserverService2.prototype.schedulePolyfill = function() {
      var _this = this;
      if (this.polyfillScheduled) {
        return;
      }
      var executeAllFuncs = function() {
        var funcs = _this.polyfillFunctions;
        _this.polyfillScheduled = false;
        _this.polyfillFunctions = [];
        funcs.forEach(function(f2) {
          return f2();
        });
      };
      this.polyfillScheduled = true;
      this.getFrameworkOverrides().setTimeout(executeAllFuncs, DEBOUNCE_DELAY);
    };
    ResizeObserverService2 = __decorate$17([
      Bean("resizeObserverService")
    ], ResizeObserverService2);
    return ResizeObserverService2;
  }(BeanStub)
);
var __extends$1a = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$16 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AnimationFrameService = (
  /** @class */
  function(_super) {
    __extends$1a(AnimationFrameService2, _super);
    function AnimationFrameService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.createTasksP1 = { list: [], sorted: false };
      _this.createTasksP2 = { list: [], sorted: false };
      _this.destroyTasks = [];
      _this.ticking = false;
      _this.scrollGoingDown = true;
      _this.lastPage = 0;
      _this.lastScrollTop = 0;
      _this.taskCount = 0;
      _this.cancelledTasks = /* @__PURE__ */ new Set();
      return _this;
    }
    AnimationFrameService2.prototype.setScrollTop = function(scrollTop) {
      var isPaginationActive = this.gridOptionsService.is("pagination");
      this.scrollGoingDown = scrollTop >= this.lastScrollTop;
      if (isPaginationActive && scrollTop === 0) {
        var currentPage = this.paginationProxy.getCurrentPage();
        if (currentPage !== this.lastPage) {
          this.lastPage = currentPage;
          this.scrollGoingDown = true;
        }
      }
      this.lastScrollTop = scrollTop;
    };
    AnimationFrameService2.prototype.init = function() {
      this.useAnimationFrame = !this.gridOptionsService.is("suppressAnimationFrame");
    };
    AnimationFrameService2.prototype.isOn = function() {
      return this.useAnimationFrame;
    };
    AnimationFrameService2.prototype.verifyAnimationFrameOn = function(methodName) {
      if (this.useAnimationFrame === false) {
        console.warn("AG Grid: AnimationFrameService." + methodName + " called but animation frames are off");
      }
    };
    AnimationFrameService2.prototype.createTask = function(task, index2, list) {
      this.verifyAnimationFrameOn(list);
      var taskItem = { task, index: index2, createOrder: ++this.taskCount };
      this.addTaskToList(this[list], taskItem);
      this.schedule();
    };
    AnimationFrameService2.prototype.cancelTask = function(task) {
      this.cancelledTasks.add(task);
    };
    AnimationFrameService2.prototype.addTaskToList = function(taskList, task) {
      taskList.list.push(task);
      taskList.sorted = false;
    };
    AnimationFrameService2.prototype.sortTaskList = function(taskList) {
      if (taskList.sorted) {
        return;
      }
      var sortDirection = this.scrollGoingDown ? 1 : -1;
      taskList.list.sort(function(a, b) {
        return a.index !== b.index ? sortDirection * (b.index - a.index) : b.createOrder - a.createOrder;
      });
      taskList.sorted = true;
    };
    AnimationFrameService2.prototype.addDestroyTask = function(task) {
      this.verifyAnimationFrameOn("createTasksP3");
      this.destroyTasks.push(task);
      this.schedule();
    };
    AnimationFrameService2.prototype.executeFrame = function(millis) {
      this.verifyAnimationFrameOn("executeFrame");
      var p1TaskList = this.createTasksP1;
      var p1Tasks = p1TaskList.list;
      var p2TaskList = this.createTasksP2;
      var p2Tasks = p2TaskList.list;
      var destroyTasks = this.destroyTasks;
      var frameStart = (/* @__PURE__ */ new Date()).getTime();
      var duration = (/* @__PURE__ */ new Date()).getTime() - frameStart;
      var noMaxMillis = millis <= 0;
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      while (noMaxMillis || duration < millis) {
        var gridBodyDidSomething = gridBodyCon.getScrollFeature().scrollGridIfNeeded();
        if (!gridBodyDidSomething) {
          var task = void 0;
          if (p1Tasks.length) {
            this.sortTaskList(p1TaskList);
            task = p1Tasks.pop().task;
          } else if (p2Tasks.length) {
            this.sortTaskList(p2TaskList);
            task = p2Tasks.pop().task;
          } else if (destroyTasks.length) {
            task = destroyTasks.pop();
          } else {
            this.cancelledTasks.clear();
            break;
          }
          if (!this.cancelledTasks.has(task)) {
            task();
          }
        }
        duration = (/* @__PURE__ */ new Date()).getTime() - frameStart;
      }
      if (p1Tasks.length || p2Tasks.length || destroyTasks.length) {
        this.requestFrame();
      } else {
        this.stopTicking();
      }
    };
    AnimationFrameService2.prototype.stopTicking = function() {
      this.ticking = false;
    };
    AnimationFrameService2.prototype.flushAllFrames = function() {
      if (!this.useAnimationFrame) {
        return;
      }
      this.executeFrame(-1);
    };
    AnimationFrameService2.prototype.schedule = function() {
      if (!this.useAnimationFrame) {
        return;
      }
      if (!this.ticking) {
        this.ticking = true;
        this.requestFrame();
      }
    };
    AnimationFrameService2.prototype.requestFrame = function() {
      var callback2 = this.executeFrame.bind(this, 60);
      this.requestAnimationFrame(callback2);
    };
    AnimationFrameService2.prototype.requestAnimationFrame = function(callback2) {
      var win = this.gridOptionsService.getWindow();
      if (win.requestAnimationFrame) {
        win.requestAnimationFrame(callback2);
      } else if (win.webkitRequestAnimationFrame) {
        win.webkitRequestAnimationFrame(callback2);
      } else {
        win.setTimeout(callback2, 0);
      }
    };
    AnimationFrameService2.prototype.isQueueEmpty = function() {
      return !this.ticking;
    };
    AnimationFrameService2.prototype.debounce = function(func) {
      var _this = this;
      var pending = false;
      return function() {
        if (!_this.isOn()) {
          _this.getFrameworkOverrides().setTimeout(func, 0);
          return;
        }
        if (pending) {
          return;
        }
        pending = true;
        _this.addDestroyTask(function() {
          pending = false;
          func();
        });
      };
    };
    __decorate$16([
      Autowired("ctrlsService")
    ], AnimationFrameService2.prototype, "ctrlsService", void 0);
    __decorate$16([
      Autowired("paginationProxy")
    ], AnimationFrameService2.prototype, "paginationProxy", void 0);
    __decorate$16([
      PostConstruct
    ], AnimationFrameService2.prototype, "init", null);
    AnimationFrameService2 = __decorate$16([
      Bean("animationFrameService")
    ], AnimationFrameService2);
    return AnimationFrameService2;
  }(BeanStub)
);
var __extends$19 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$15 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AutoWidthCalculator = (
  /** @class */
  function(_super) {
    __extends$19(AutoWidthCalculator2, _super);
    function AutoWidthCalculator2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    AutoWidthCalculator2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function(p2) {
        _this.centerRowContainerCtrl = p2.centerRowContainerCtrl;
      });
    };
    AutoWidthCalculator2.prototype.getPreferredWidthForColumn = function(column, skipHeader) {
      var eHeaderCell = this.getHeaderCellForColumn(column);
      if (!eHeaderCell) {
        return -1;
      }
      var elements2 = this.rowRenderer.getAllCellsForColumn(column);
      if (!skipHeader) {
        elements2.push(eHeaderCell);
      }
      return this.addElementsToContainerAndGetWidth(elements2);
    };
    AutoWidthCalculator2.prototype.getPreferredWidthForColumnGroup = function(columnGroup) {
      var eHeaderCell = this.getHeaderCellForColumn(columnGroup);
      if (!eHeaderCell) {
        return -1;
      }
      return this.addElementsToContainerAndGetWidth([eHeaderCell]);
    };
    AutoWidthCalculator2.prototype.addElementsToContainerAndGetWidth = function(elements2) {
      var _this = this;
      var eDummyContainer = document.createElement("form");
      eDummyContainer.style.position = "fixed";
      var eBodyContainer = this.centerRowContainerCtrl.getContainerElement();
      elements2.forEach(function(el2) {
        return _this.cloneItemIntoDummy(el2, eDummyContainer);
      });
      eBodyContainer.appendChild(eDummyContainer);
      var dummyContainerWidth = eDummyContainer.offsetWidth;
      eBodyContainer.removeChild(eDummyContainer);
      var autoSizePadding = this.getAutoSizePadding();
      return dummyContainerWidth + autoSizePadding;
    };
    AutoWidthCalculator2.prototype.getAutoSizePadding = function() {
      var value = this.gridOptionsService.getNum("autoSizePadding");
      return value != null && value >= 0 ? value : 20;
    };
    AutoWidthCalculator2.prototype.getHeaderCellForColumn = function(column) {
      var element = null;
      this.ctrlsService.getHeaderRowContainerCtrls().forEach(function(container) {
        var res = container.getHtmlElementForColumnHeader(column);
        if (res != null) {
          element = res;
        }
      });
      return element;
    };
    AutoWidthCalculator2.prototype.cloneItemIntoDummy = function(eCell, eDummyContainer) {
      var eCellClone = eCell.cloneNode(true);
      eCellClone.style.width = "";
      eCellClone.style.position = "static";
      eCellClone.style.left = "";
      var eCloneParent = document.createElement("div");
      var eCloneParentClassList = eCloneParent.classList;
      var isHeader = ["ag-header-cell", "ag-header-group-cell"].some(function(cls) {
        return eCellClone.classList.contains(cls);
      });
      if (isHeader) {
        eCloneParentClassList.add("ag-header", "ag-header-row");
        eCloneParent.style.position = "static";
      } else {
        eCloneParentClassList.add("ag-row");
      }
      var pointer = eCell.parentElement;
      while (pointer) {
        var isRow = ["ag-header-row", "ag-row"].some(function(cls) {
          return pointer.classList.contains(cls);
        });
        if (isRow) {
          for (var i = 0; i < pointer.classList.length; i++) {
            var item = pointer.classList[i];
            if (item != "ag-row-position-absolute") {
              eCloneParentClassList.add(item);
            }
          }
          break;
        }
        pointer = pointer.parentElement;
      }
      eCloneParent.appendChild(eCellClone);
      eDummyContainer.appendChild(eCloneParent);
    };
    __decorate$15([
      Autowired("rowRenderer")
    ], AutoWidthCalculator2.prototype, "rowRenderer", void 0);
    __decorate$15([
      Autowired("ctrlsService")
    ], AutoWidthCalculator2.prototype, "ctrlsService", void 0);
    __decorate$15([
      Autowired("rowCssClassCalculator")
    ], AutoWidthCalculator2.prototype, "rowCssClassCalculator", void 0);
    __decorate$15([
      PostConstruct
    ], AutoWidthCalculator2.prototype, "postConstruct", null);
    AutoWidthCalculator2 = __decorate$15([
      Bean("autoWidthCalculator")
    ], AutoWidthCalculator2);
    return AutoWidthCalculator2;
  }(BeanStub)
);
var __extends$18 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$14 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __values$2 = function(o) {
  var s2 = typeof Symbol === "function" && Symbol.iterator, m2 = s2 && o[s2], i = 0;
  if (m2)
    return m2.call(o);
  if (o && typeof o.length === "number")
    return {
      next: function() {
        if (o && i >= o.length)
          o = void 0;
        return { value: o && o[i++], done: !o };
      }
    };
  throw new TypeError(s2 ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __read$e = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$c = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var StickyRowFeature = (
  /** @class */
  function(_super) {
    __extends$18(StickyRowFeature2, _super);
    function StickyRowFeature2(createRowCon, destroyRowCtrls) {
      var _this = _super.call(this) || this;
      _this.createRowCon = createRowCon;
      _this.destroyRowCtrls = destroyRowCtrls;
      _this.stickyRowCtrls = [];
      _this.containerHeight = 0;
      return _this;
    }
    StickyRowFeature2.prototype.postConstruct = function() {
      var _this = this;
      this.isClientSide = this.rowModel.getType() === "clientSide";
      this.ctrlsService.whenReady(function(params) {
        _this.gridBodyCtrl = params.gridBodyCtrl;
      });
    };
    StickyRowFeature2.prototype.getStickyRowCtrls = function() {
      return this.stickyRowCtrls;
    };
    StickyRowFeature2.prototype.checkStickyRows = function() {
      var _this = this;
      var height = 0;
      if (!this.gridOptionsService.isGroupRowsSticky()) {
        this.refreshNodesAndContainerHeight([], height);
        return;
      }
      var stickyRows = [];
      var firstPixel = this.rowRenderer.getFirstVisibleVerticalPixel();
      var addStickyRow = function(stickyRow) {
        var _a2, _b2, _c;
        stickyRows.push(stickyRow);
        var lastChildBottom;
        if (_this.isClientSide) {
          var lastAncestor = stickyRow;
          while (lastAncestor.expanded) {
            if (lastAncestor.master) {
              lastAncestor = lastAncestor.detailNode;
            } else if (lastAncestor.childrenAfterSort) {
              if (lastAncestor.childrenAfterSort.length === 0) {
                break;
              }
              lastAncestor = last(lastAncestor.childrenAfterSort);
            }
          }
          lastChildBottom = lastAncestor.rowTop + lastAncestor.rowHeight;
        } else {
          if (stickyRow.master) {
            lastChildBottom = stickyRow.detailNode.rowTop + stickyRow.detailNode.rowHeight;
          } else {
            var storeBounds = (_a2 = stickyRow.childStore) === null || _a2 === void 0 ? void 0 : _a2.getStoreBounds();
            lastChildBottom = ((_b2 = storeBounds === null || storeBounds === void 0 ? void 0 : storeBounds.heightPx) !== null && _b2 !== void 0 ? _b2 : 0) + ((_c = storeBounds === null || storeBounds === void 0 ? void 0 : storeBounds.topPx) !== null && _c !== void 0 ? _c : 0);
          }
        }
        var stickRowBottom = firstPixel + height + stickyRow.rowHeight;
        if (lastChildBottom < stickRowBottom) {
          stickyRow.stickyRowTop = height + (lastChildBottom - stickRowBottom);
        } else {
          stickyRow.stickyRowTop = height;
        }
        height = 0;
        stickyRows.forEach(function(rowNode) {
          var thisRowLastPx = rowNode.stickyRowTop + rowNode.rowHeight;
          if (height < thisRowLastPx) {
            height = thisRowLastPx;
          }
        });
      };
      while (true) {
        var firstPixelAfterStickyRows = firstPixel + height;
        var firstIndex = this.rowModel.getRowIndexAtPixel(firstPixelAfterStickyRows);
        var firstRow = this.rowModel.getRow(firstIndex);
        if (firstRow == null) {
          break;
        }
        if (firstRow.level < 0) {
          break;
        }
        var parents = [];
        var p2 = firstRow.parent;
        while (p2.level >= 0) {
          parents.push(p2);
          p2 = p2.parent;
        }
        var firstMissingParent = parents.reverse().find(function(parent) {
          return stickyRows.indexOf(parent) < 0 && parent.displayed;
        });
        if (firstMissingParent) {
          addStickyRow(firstMissingParent);
          continue;
        }
        if (firstRow.isExpandable() && firstRow.expanded && firstRow.rowTop < firstPixelAfterStickyRows) {
          addStickyRow(firstRow);
          continue;
        }
        break;
      }
      this.refreshNodesAndContainerHeight(stickyRows, height);
    };
    StickyRowFeature2.prototype.refreshStickyNode = function(stickRowNode) {
      var allStickyNodes = [];
      for (var i = 0; i < this.stickyRowCtrls.length; i++) {
        var currentNode = this.stickyRowCtrls[i].getRowNode();
        if (currentNode !== stickRowNode) {
          allStickyNodes.push(currentNode);
        }
      }
      this.refreshNodesAndContainerHeight(allStickyNodes, this.containerHeight);
      this.checkStickyRows();
    };
    StickyRowFeature2.prototype.refreshNodesAndContainerHeight = function(allStickyNodes, height) {
      var e_1, _a2, _b2;
      var _this = this;
      var removedCtrls = this.stickyRowCtrls.filter(function(ctrl2) {
        return allStickyNodes.indexOf(ctrl2.getRowNode()) === -1;
      });
      var addedNodes = allStickyNodes.filter(function(rowNode) {
        return _this.stickyRowCtrls.findIndex(function(ctrl2) {
          return ctrl2.getRowNode() === rowNode;
        }) === -1;
      });
      var ctrlsToDestroy = {};
      removedCtrls.forEach(function(removedCtrl) {
        ctrlsToDestroy[removedCtrl.getRowNode().id] = removedCtrl;
        _this.stickyRowCtrls = _this.stickyRowCtrls.filter(function(ctrl2) {
          return ctrl2 !== removedCtrl;
        });
      });
      try {
        for (var _c = __values$2(Object.values(ctrlsToDestroy)), _d = _c.next(); !_d.done; _d = _c.next()) {
          var ctrl = _d.value;
          ctrl.getRowNode().sticky = false;
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (_d && !_d.done && (_a2 = _c.return))
            _a2.call(_c);
        } finally {
          if (e_1)
            throw e_1.error;
        }
      }
      this.destroyRowCtrls(ctrlsToDestroy, false);
      var newCtrls = addedNodes.map(function(rowNode) {
        rowNode.sticky = true;
        return _this.createRowCon(rowNode, false, false);
      });
      (_b2 = this.stickyRowCtrls).push.apply(_b2, __spreadArray$c([], __read$e(newCtrls)));
      this.stickyRowCtrls.forEach(function(ctrl2) {
        return ctrl2.setRowTop(ctrl2.getRowNode().stickyRowTop);
      });
      this.stickyRowCtrls.sort(function(a, b) {
        return b.getRowNode().rowIndex - a.getRowNode().rowIndex;
      });
      if (this.containerHeight !== height) {
        this.containerHeight = height;
        this.gridBodyCtrl.setStickyTopHeight(height);
      }
    };
    __decorate$14([
      Autowired("rowModel")
    ], StickyRowFeature2.prototype, "rowModel", void 0);
    __decorate$14([
      Autowired("rowRenderer")
    ], StickyRowFeature2.prototype, "rowRenderer", void 0);
    __decorate$14([
      Autowired("ctrlsService")
    ], StickyRowFeature2.prototype, "ctrlsService", void 0);
    __decorate$14([
      PostConstruct
    ], StickyRowFeature2.prototype, "postConstruct", null);
    return StickyRowFeature2;
  }(BeanStub)
);
var __extends$17 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$13 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$d = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$b = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var __values$1 = function(o) {
  var s2 = typeof Symbol === "function" && Symbol.iterator, m2 = s2 && o[s2], i = 0;
  if (m2)
    return m2.call(o);
  if (o && typeof o.length === "number")
    return {
      next: function() {
        if (o && i >= o.length)
          o = void 0;
        return { value: o && o[i++], done: !o };
      }
    };
  throw new TypeError(s2 ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var DEFAULT_KEEP_DETAIL_ROW_COUNT = 10;
var RowRenderer = (
  /** @class */
  function(_super) {
    __extends$17(RowRenderer2, _super);
    function RowRenderer2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.destroyFuncsForColumnListeners = [];
      _this.rowCtrlsByRowIndex = {};
      _this.zombieRowCtrls = {};
      _this.allRowCtrls = [];
      _this.topRowCtrls = [];
      _this.bottomRowCtrls = [];
      _this.refreshInProgress = false;
      _this.dataFirstRenderedFired = false;
      return _this;
    }
    RowRenderer2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function() {
        _this.gridBodyCtrl = _this.ctrlsService.getGridBodyCtrl();
        _this.initialise();
      });
    };
    RowRenderer2.prototype.initialise = function() {
      this.addManagedListener(this.eventService, Events.EVENT_PAGINATION_CHANGED, this.onPageLoaded.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_PINNED_ROW_DATA_CHANGED, this.onPinnedRowDataChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, this.onDisplayedColumnsChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_BODY_SCROLL, this.onBodyScroll.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_BODY_HEIGHT_CHANGED, this.redraw.bind(this));
      this.addManagedPropertyListener("domLayout", this.onDomLayoutChanged.bind(this));
      this.addManagedPropertyListener("rowClass", this.redrawRows.bind(this));
      if (this.gridOptionsService.isGroupRowsSticky()) {
        var rowModelType = this.rowModel.getType();
        if (rowModelType === "clientSide" || rowModelType === "serverSide") {
          this.stickyRowFeature = this.createManagedBean(new StickyRowFeature(this.createRowCon.bind(this), this.destroyRowCtrls.bind(this)));
        }
      }
      this.registerCellEventListeners();
      this.initialiseCache();
      this.printLayout = this.gridOptionsService.isDomLayout("print");
      this.embedFullWidthRows = this.printLayout || this.gridOptionsService.is("embedFullWidthRows");
      this.redrawAfterModelUpdate();
    };
    RowRenderer2.prototype.initialiseCache = function() {
      if (this.gridOptionsService.is("keepDetailRows")) {
        var countProp = this.getKeepDetailRowsCount();
        var count = countProp != null ? countProp : 3;
        this.cachedRowCtrls = new RowCtrlCache(count);
      }
    };
    RowRenderer2.prototype.getKeepDetailRowsCount = function() {
      var keepDetailRowsCount = this.gridOptionsService.getNum("keepDetailRowsCount");
      if (exists(keepDetailRowsCount) && keepDetailRowsCount > 0) {
        return keepDetailRowsCount;
      }
      return DEFAULT_KEEP_DETAIL_ROW_COUNT;
    };
    RowRenderer2.prototype.getRowCtrls = function() {
      return this.allRowCtrls;
    };
    RowRenderer2.prototype.getStickyTopRowCtrls = function() {
      if (!this.stickyRowFeature) {
        return [];
      }
      return this.stickyRowFeature.getStickyRowCtrls();
    };
    RowRenderer2.prototype.updateAllRowCtrls = function() {
      var liveList = getAllValuesInObject(this.rowCtrlsByRowIndex);
      var isEnsureDomOrder = this.gridOptionsService.is("ensureDomOrder");
      var isPrintLayout = this.gridOptionsService.isDomLayout("print");
      if (isEnsureDomOrder || isPrintLayout) {
        liveList.sort(function(a, b) {
          return a.getRowNode().rowIndex - b.getRowNode.rowIndex;
        });
      }
      var zombieList = getAllValuesInObject(this.zombieRowCtrls);
      var cachedList = this.cachedRowCtrls ? this.cachedRowCtrls.getEntries() : [];
      this.allRowCtrls = __spreadArray$b(__spreadArray$b(__spreadArray$b([], __read$d(liveList)), __read$d(zombieList)), __read$d(cachedList));
    };
    RowRenderer2.prototype.onCellFocusChanged = function(event) {
      this.getAllCellCtrls().forEach(function(cellCtrl) {
        return cellCtrl.onCellFocused(event);
      });
      this.getFullWidthRowCtrls().forEach(function(rowCtrl) {
        return rowCtrl.onFullWidthRowFocused(event);
      });
    };
    RowRenderer2.prototype.registerCellEventListeners = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_CELL_FOCUSED, function(event) {
        _this.onCellFocusChanged(event);
      });
      this.addManagedListener(this.eventService, Events.EVENT_CELL_FOCUS_CLEARED, function() {
        _this.onCellFocusChanged();
      });
      this.addManagedListener(this.eventService, Events.EVENT_FLASH_CELLS, function(event) {
        _this.getAllCellCtrls().forEach(function(cellCtrl) {
          return cellCtrl.onFlashCells(event);
        });
      });
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_HOVER_CHANGED, function() {
        _this.getAllCellCtrls().forEach(function(cellCtrl) {
          return cellCtrl.onColumnHover();
        });
      });
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, function() {
        _this.getAllCellCtrls().forEach(function(cellCtrl) {
          return cellCtrl.onDisplayedColumnsChanged();
        });
      });
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, function() {
        if (_this.printLayout) {
          _this.getAllCellCtrls().forEach(function(cellCtrl) {
            return cellCtrl.onLeftChanged();
          });
        }
      });
      var rangeSelectionEnabled = this.gridOptionsService.isEnableRangeSelection();
      if (rangeSelectionEnabled) {
        this.addManagedListener(this.eventService, Events.EVENT_RANGE_SELECTION_CHANGED, function() {
          _this.getAllCellCtrls().forEach(function(cellCtrl) {
            return cellCtrl.onRangeSelectionChanged();
          });
        });
        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_MOVED, function() {
          _this.getAllCellCtrls().forEach(function(cellCtrl) {
            return cellCtrl.updateRangeBordersIfRangeCount();
          });
        });
        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PINNED, function() {
          _this.getAllCellCtrls().forEach(function(cellCtrl) {
            return cellCtrl.updateRangeBordersIfRangeCount();
          });
        });
        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VISIBLE, function() {
          _this.getAllCellCtrls().forEach(function(cellCtrl) {
            return cellCtrl.updateRangeBordersIfRangeCount();
          });
        });
      }
      this.refreshListenersToColumnsForCellComps();
      this.addManagedListener(this.eventService, Events.EVENT_GRID_COLUMNS_CHANGED, this.refreshListenersToColumnsForCellComps.bind(this));
      this.addDestroyFunc(this.removeGridColumnListeners.bind(this));
    };
    RowRenderer2.prototype.removeGridColumnListeners = function() {
      this.destroyFuncsForColumnListeners.forEach(function(func) {
        return func();
      });
      this.destroyFuncsForColumnListeners.length = 0;
    };
    RowRenderer2.prototype.refreshListenersToColumnsForCellComps = function() {
      var _this = this;
      this.removeGridColumnListeners();
      var cols = this.columnModel.getAllGridColumns();
      if (!cols) {
        return;
      }
      cols.forEach(function(col) {
        var forEachCellWithThisCol = function(callback2) {
          _this.getAllCellCtrls().forEach(function(cellCtrl) {
            if (cellCtrl.getColumn() === col) {
              callback2(cellCtrl);
            }
          });
        };
        var leftChangedListener = function() {
          forEachCellWithThisCol(function(cellCtrl) {
            return cellCtrl.onLeftChanged();
          });
        };
        var widthChangedListener = function() {
          forEachCellWithThisCol(function(cellCtrl) {
            return cellCtrl.onWidthChanged();
          });
        };
        var firstRightPinnedChangedListener = function() {
          forEachCellWithThisCol(function(cellCtrl) {
            return cellCtrl.onFirstRightPinnedChanged();
          });
        };
        var lastLeftPinnedChangedListener = function() {
          forEachCellWithThisCol(function(cellCtrl) {
            return cellCtrl.onLastLeftPinnedChanged();
          });
        };
        var colDefChangedListener = function() {
          forEachCellWithThisCol(function(cellCtrl) {
            return cellCtrl.onColDefChanged();
          });
        };
        col.addEventListener("leftChanged", leftChangedListener);
        col.addEventListener("widthChanged", widthChangedListener);
        col.addEventListener("firstRightPinnedChanged", firstRightPinnedChangedListener);
        col.addEventListener("lastLeftPinnedChanged", lastLeftPinnedChangedListener);
        col.addEventListener("colDefChanged", colDefChangedListener);
        _this.destroyFuncsForColumnListeners.push(function() {
          col.removeEventListener("leftChanged", leftChangedListener);
          col.removeEventListener("widthChanged", widthChangedListener);
          col.removeEventListener("firstRightPinnedChanged", firstRightPinnedChangedListener);
          col.removeEventListener("lastLeftPinnedChanged", lastLeftPinnedChangedListener);
          col.removeEventListener("colDefChanged", colDefChangedListener);
        });
      });
    };
    RowRenderer2.prototype.onDomLayoutChanged = function() {
      var printLayout = this.gridOptionsService.isDomLayout("print");
      var embedFullWidthRows = printLayout || this.gridOptionsService.is("embedFullWidthRows");
      var destroyRows = embedFullWidthRows !== this.embedFullWidthRows || this.printLayout !== printLayout;
      this.printLayout = printLayout;
      this.embedFullWidthRows = embedFullWidthRows;
      if (destroyRows) {
        this.redrawAfterModelUpdate({ domLayoutChanged: true });
      }
    };
    RowRenderer2.prototype.datasourceChanged = function() {
      this.firstRenderedRow = 0;
      this.lastRenderedRow = -1;
      var rowIndexesToRemove = Object.keys(this.rowCtrlsByRowIndex);
      this.removeRowCtrls(rowIndexesToRemove);
    };
    RowRenderer2.prototype.onPageLoaded = function(event) {
      var params = {
        recycleRows: event.keepRenderedRows,
        animate: event.animate,
        newData: event.newData,
        newPage: event.newPage,
        // because this is a model updated event (not pinned rows), we
        // can skip updating the pinned rows. this is needed so that if user
        // is doing transaction updates, the pinned rows are not getting constantly
        // trashed - or editing cells in pinned rows are not refreshed and put into read mode
        onlyBody: true
      };
      this.redrawAfterModelUpdate(params);
    };
    RowRenderer2.prototype.getAllCellsForColumn = function(column) {
      var res = [];
      this.getAllRowCtrls().forEach(function(rowCtrl) {
        var eCell = rowCtrl.getCellElement(column);
        if (eCell) {
          res.push(eCell);
        }
      });
      return res;
    };
    RowRenderer2.prototype.refreshFloatingRowComps = function() {
      this.refreshFloatingRows(this.topRowCtrls, this.pinnedRowModel.getPinnedTopRowData());
      this.refreshFloatingRows(this.bottomRowCtrls, this.pinnedRowModel.getPinnedBottomRowData());
    };
    RowRenderer2.prototype.getTopRowCtrls = function() {
      return this.topRowCtrls;
    };
    RowRenderer2.prototype.getBottomRowCtrls = function() {
      return this.bottomRowCtrls;
    };
    RowRenderer2.prototype.refreshFloatingRows = function(rowComps, rowNodes) {
      var _this = this;
      rowComps.forEach(function(row) {
        row.destroyFirstPass();
        row.destroySecondPass();
      });
      rowComps.length = 0;
      if (!rowNodes) {
        return;
      }
      rowNodes.forEach(function(rowNode) {
        var rowCtrl = new RowCtrl(rowNode, _this.beans, false, false, _this.printLayout);
        rowComps.push(rowCtrl);
      });
    };
    RowRenderer2.prototype.onPinnedRowDataChanged = function() {
      var params = {
        recycleRows: true
      };
      this.redrawAfterModelUpdate(params);
    };
    RowRenderer2.prototype.getRenderedIndexesForRowNodes = function(rowNodes) {
      var result = [];
      if (missing(rowNodes)) {
        return result;
      }
      iterateObject(this.rowCtrlsByRowIndex, function(index2, renderedRow) {
        var rowNode = renderedRow.getRowNode();
        if (rowNodes.indexOf(rowNode) >= 0) {
          result.push(index2);
        }
      });
      return result;
    };
    RowRenderer2.prototype.redrawRows = function(rowNodes) {
      var partialRefresh = rowNodes != null && rowNodes.length > 0;
      if (partialRefresh) {
        var indexesToRemove = this.getRenderedIndexesForRowNodes(rowNodes);
        this.removeRowCtrls(indexesToRemove);
      }
      this.redrawAfterModelUpdate({
        recycleRows: partialRefresh
      });
    };
    RowRenderer2.prototype.getCellToRestoreFocusToAfterRefresh = function(params) {
      var focusedCell = (params === null || params === void 0 ? void 0 : params.suppressKeepFocus) ? null : this.focusService.getFocusCellToUseAfterRefresh();
      if (focusedCell == null) {
        return null;
      }
      var eDocument = this.gridOptionsService.getDocument();
      var activeElement = eDocument.activeElement;
      var cellDomData = this.gridOptionsService.getDomData(activeElement, CellCtrl.DOM_DATA_KEY_CELL_CTRL);
      var rowDomData = this.gridOptionsService.getDomData(activeElement, RowCtrl.DOM_DATA_KEY_ROW_CTRL);
      var gridElementFocused = cellDomData || rowDomData;
      return gridElementFocused ? focusedCell : null;
    };
    RowRenderer2.prototype.redrawAfterModelUpdate = function(params) {
      if (params === void 0) {
        params = {};
      }
      this.getLockOnRefresh();
      var focusedCell = this.getCellToRestoreFocusToAfterRefresh(params);
      this.updateContainerHeights();
      this.scrollToTopIfNewData(params);
      var recycleRows = !params.domLayoutChanged && !!params.recycleRows;
      var animate = params.animate && this.gridOptionsService.isAnimateRows();
      var rowsToRecycle = recycleRows ? this.getRowsToRecycle() : null;
      if (!recycleRows) {
        this.removeAllRowComps();
      }
      this.recycleRows(rowsToRecycle, animate);
      this.gridBodyCtrl.updateRowCount();
      if (!params.onlyBody) {
        this.refreshFloatingRowComps();
      }
      this.dispatchDisplayedRowsChanged();
      if (focusedCell != null) {
        this.restoreFocusedCell(focusedCell);
      }
      this.releaseLockOnRefresh();
    };
    RowRenderer2.prototype.scrollToTopIfNewData = function(params) {
      var scrollToTop = params.newData || params.newPage;
      var suppressScrollToTop = this.gridOptionsService.is("suppressScrollOnNewData");
      if (scrollToTop && !suppressScrollToTop) {
        this.gridBodyCtrl.getScrollFeature().scrollToTop();
      }
    };
    RowRenderer2.prototype.updateContainerHeights = function() {
      if (this.printLayout) {
        this.rowContainerHeightService.setModelHeight(null);
        return;
      }
      var containerHeight = this.paginationProxy.getCurrentPageHeight();
      if (containerHeight === 0) {
        containerHeight = 1;
      }
      this.rowContainerHeightService.setModelHeight(containerHeight);
    };
    RowRenderer2.prototype.getLockOnRefresh = function() {
      if (this.refreshInProgress) {
        throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");
      }
      this.refreshInProgress = true;
    };
    RowRenderer2.prototype.releaseLockOnRefresh = function() {
      this.refreshInProgress = false;
    };
    RowRenderer2.prototype.isRefreshInProgress = function() {
      return this.refreshInProgress;
    };
    RowRenderer2.prototype.restoreFocusedCell = function(cellPosition) {
      if (cellPosition) {
        this.focusService.setRestoreFocusedCell(cellPosition);
        this.onCellFocusChanged({
          rowIndex: cellPosition.rowIndex,
          column: cellPosition.column,
          rowPinned: cellPosition.rowPinned,
          forceBrowserFocus: true,
          preventScrollOnBrowserFocus: true,
          api: this.beans.gridApi,
          columnApi: this.beans.columnApi,
          context: this.beans.gridOptionsService.context,
          type: "mock"
        });
      }
    };
    RowRenderer2.prototype.stopEditing = function(cancel) {
      if (cancel === void 0) {
        cancel = false;
      }
      this.getAllRowCtrls().forEach(function(rowCtrl) {
        rowCtrl.stopEditing(cancel);
      });
    };
    RowRenderer2.prototype.getAllCellCtrls = function() {
      var res = [];
      var rowCtrls = this.getAllRowCtrls();
      var rowCtrlsLength = rowCtrls.length;
      for (var i = 0; i < rowCtrlsLength; i++) {
        var cellCtrls = rowCtrls[i].getAllCellCtrls();
        var cellCtrlsLength = cellCtrls.length;
        for (var j = 0; j < cellCtrlsLength; j++) {
          res.push(cellCtrls[j]);
        }
      }
      return res;
    };
    RowRenderer2.prototype.getAllRowCtrls = function() {
      var e_1, _a2;
      var stickyRowCtrls = this.stickyRowFeature && this.stickyRowFeature.getStickyRowCtrls() || [];
      var res = __spreadArray$b(__spreadArray$b(__spreadArray$b([], __read$d(this.topRowCtrls)), __read$d(this.bottomRowCtrls)), __read$d(stickyRowCtrls));
      try {
        for (var _b2 = __values$1(Object.keys(this.rowCtrlsByRowIndex)), _c = _b2.next(); !_c.done; _c = _b2.next()) {
          var key = _c.value;
          res.push(this.rowCtrlsByRowIndex[key]);
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (_c && !_c.done && (_a2 = _b2.return))
            _a2.call(_b2);
        } finally {
          if (e_1)
            throw e_1.error;
        }
      }
      return res;
    };
    RowRenderer2.prototype.addRenderedRowListener = function(eventName, rowIndex, callback2) {
      var rowComp2 = this.rowCtrlsByRowIndex[rowIndex];
      if (rowComp2) {
        rowComp2.addEventListener(eventName, callback2);
      }
    };
    RowRenderer2.prototype.flashCells = function(params) {
      if (params === void 0) {
        params = {};
      }
      var flashDelay = params.flashDelay, fadeDelay = params.fadeDelay;
      this.getCellCtrls(params.rowNodes, params.columns).forEach(function(cellCtrl) {
        return cellCtrl.flashCell({ flashDelay, fadeDelay });
      });
    };
    RowRenderer2.prototype.refreshCells = function(params) {
      if (params === void 0) {
        params = {};
      }
      var refreshCellParams = {
        forceRefresh: params.force,
        newData: false,
        suppressFlash: params.suppressFlash
      };
      this.getCellCtrls(params.rowNodes, params.columns).forEach(function(cellCtrl) {
        if (cellCtrl.refreshShouldDestroy()) {
          var rowCtrl = cellCtrl.getRowCtrl();
          if (rowCtrl) {
            rowCtrl.refreshCell(cellCtrl);
          }
        } else {
          cellCtrl.refreshCell(refreshCellParams);
        }
      });
      this.refreshFullWidthRows(params.rowNodes);
    };
    RowRenderer2.prototype.getCellRendererInstances = function(params) {
      var _this = this;
      var _a2;
      var cellRenderers = this.getCellCtrls(params.rowNodes, params.columns).map(function(cellCtrl) {
        return cellCtrl.getCellRenderer();
      }).filter(function(renderer) {
        return renderer != null;
      });
      if ((_a2 = params.columns) === null || _a2 === void 0 ? void 0 : _a2.length) {
        return cellRenderers;
      }
      var fullWidthRenderers = [];
      var rowIdMap = this.mapRowNodes(params.rowNodes);
      this.getAllRowCtrls().forEach(function(rowCtrl) {
        if (rowIdMap && !_this.isRowInMap(rowCtrl.getRowNode(), rowIdMap)) {
          return;
        }
        if (!rowCtrl.isFullWidth()) {
          return;
        }
        var fullWidthRenderer = rowCtrl.getFullWidthCellRenderer();
        if (fullWidthRenderer) {
          fullWidthRenderers.push(fullWidthRenderer);
        }
      });
      return __spreadArray$b(__spreadArray$b([], __read$d(fullWidthRenderers)), __read$d(cellRenderers));
    };
    RowRenderer2.prototype.getCellEditorInstances = function(params) {
      var res = [];
      this.getCellCtrls(params.rowNodes, params.columns).forEach(function(cellCtrl) {
        var cellEditor = cellCtrl.getCellEditor();
        if (cellEditor) {
          res.push(cellEditor);
        }
      });
      return res;
    };
    RowRenderer2.prototype.getEditingCells = function() {
      var res = [];
      this.getAllCellCtrls().forEach(function(cellCtrl) {
        if (cellCtrl.isEditing()) {
          var cellPosition = cellCtrl.getCellPosition();
          res.push(cellPosition);
        }
      });
      return res;
    };
    RowRenderer2.prototype.mapRowNodes = function(rowNodes) {
      if (!rowNodes) {
        return;
      }
      var res = {
        top: {},
        bottom: {},
        normal: {}
      };
      rowNodes.forEach(function(rowNode) {
        var id2 = rowNode.id;
        if (rowNode.rowPinned === "top") {
          res.top[id2] = rowNode;
        } else if (rowNode.rowPinned === "bottom") {
          res.bottom[id2] = rowNode;
        } else {
          res.normal[id2] = rowNode;
        }
      });
      return res;
    };
    RowRenderer2.prototype.isRowInMap = function(rowNode, rowIdsMap) {
      var id2 = rowNode.id;
      var floating = rowNode.rowPinned;
      if (floating === "bottom") {
        return rowIdsMap.bottom[id2] != null;
      }
      if (floating === "top") {
        return rowIdsMap.top[id2] != null;
      }
      return rowIdsMap.normal[id2] != null;
    };
    RowRenderer2.prototype.getCellCtrls = function(rowNodes, columns) {
      var _this = this;
      var rowIdsMap = this.mapRowNodes(rowNodes);
      var res = [];
      var colIdsMap;
      if (exists(columns)) {
        colIdsMap = {};
        columns.forEach(function(colKey) {
          var column = _this.columnModel.getGridColumn(colKey);
          if (exists(column)) {
            colIdsMap[column.getId()] = true;
          }
        });
      }
      var processRow = function(rowCtrl) {
        var rowNode = rowCtrl.getRowNode();
        if (rowIdsMap != null && !_this.isRowInMap(rowNode, rowIdsMap)) {
          return;
        }
        rowCtrl.getAllCellCtrls().forEach(function(cellCtrl) {
          var colId = cellCtrl.getColumn().getId();
          var excludeColFromRefresh = colIdsMap && !colIdsMap[colId];
          if (excludeColFromRefresh) {
            return;
          }
          res.push(cellCtrl);
        });
      };
      this.getAllRowCtrls().forEach(function(row) {
        return processRow(row);
      });
      return res;
    };
    RowRenderer2.prototype.destroy = function() {
      this.removeAllRowComps();
      _super.prototype.destroy.call(this);
    };
    RowRenderer2.prototype.removeAllRowComps = function() {
      var rowIndexesToRemove = Object.keys(this.rowCtrlsByRowIndex);
      this.removeRowCtrls(rowIndexesToRemove);
    };
    RowRenderer2.prototype.getRowsToRecycle = function() {
      var stubNodeIndexes = [];
      iterateObject(this.rowCtrlsByRowIndex, function(index2, rowComp2) {
        var stubNode = rowComp2.getRowNode().id == null;
        if (stubNode) {
          stubNodeIndexes.push(index2);
        }
      });
      this.removeRowCtrls(stubNodeIndexes);
      var ctrlsByIdMap = {};
      iterateObject(this.rowCtrlsByRowIndex, function(index2, rowComp2) {
        var rowNode = rowComp2.getRowNode();
        ctrlsByIdMap[rowNode.id] = rowComp2;
      });
      this.rowCtrlsByRowIndex = {};
      return ctrlsByIdMap;
    };
    RowRenderer2.prototype.removeRowCtrls = function(rowsToRemove) {
      var _this = this;
      rowsToRemove.forEach(function(indexToRemove) {
        var rowCtrl = _this.rowCtrlsByRowIndex[indexToRemove];
        if (rowCtrl) {
          rowCtrl.destroyFirstPass();
          rowCtrl.destroySecondPass();
        }
        delete _this.rowCtrlsByRowIndex[indexToRemove];
      });
    };
    RowRenderer2.prototype.onBodyScroll = function(e) {
      if (e.direction !== "vertical") {
        return;
      }
      this.redraw();
    };
    RowRenderer2.prototype.redraw = function(afterScroll) {
      if (afterScroll === void 0) {
        afterScroll = true;
      }
      var cellFocused;
      if (this.stickyRowFeature && browserSupportsPreventScroll()) {
        cellFocused = this.getCellToRestoreFocusToAfterRefresh() || void 0;
      }
      this.getLockOnRefresh();
      this.recycleRows(null, false, afterScroll);
      this.releaseLockOnRefresh();
      this.dispatchDisplayedRowsChanged(afterScroll);
      if (cellFocused != null) {
        var newFocusedCell = this.getCellToRestoreFocusToAfterRefresh();
        if (cellFocused != null && newFocusedCell == null) {
          this.animationFrameService.flushAllFrames();
          this.restoreFocusedCell(cellFocused);
        }
      }
    };
    RowRenderer2.prototype.removeRowCompsNotToDraw = function(indexesToDraw) {
      var indexesToDrawMap = {};
      indexesToDraw.forEach(function(index2) {
        return indexesToDrawMap[index2] = true;
      });
      var existingIndexes = Object.keys(this.rowCtrlsByRowIndex);
      var indexesNotToDraw = existingIndexes.filter(function(index2) {
        return !indexesToDrawMap[index2];
      });
      this.removeRowCtrls(indexesNotToDraw);
    };
    RowRenderer2.prototype.calculateIndexesToDraw = function(rowsToRecycle) {
      var _this = this;
      var indexesToDraw = createArrayOfNumbers(this.firstRenderedRow, this.lastRenderedRow);
      var checkRowToDraw = function(indexStr, rowComp2) {
        var index2 = rowComp2.getRowNode().rowIndex;
        if (index2 == null) {
          return;
        }
        if (index2 < _this.firstRenderedRow || index2 > _this.lastRenderedRow) {
          if (_this.doNotUnVirtualiseRow(rowComp2)) {
            indexesToDraw.push(index2);
          }
        }
      };
      iterateObject(this.rowCtrlsByRowIndex, checkRowToDraw);
      iterateObject(rowsToRecycle, checkRowToDraw);
      indexesToDraw.sort(function(a, b) {
        return a - b;
      });
      indexesToDraw = indexesToDraw.filter(function(index2) {
        var rowNode = _this.paginationProxy.getRow(index2);
        return rowNode && !rowNode.sticky;
      });
      return indexesToDraw;
    };
    RowRenderer2.prototype.recycleRows = function(rowsToRecycle, animate, afterScroll) {
      var _this = this;
      if (animate === void 0) {
        animate = false;
      }
      if (afterScroll === void 0) {
        afterScroll = false;
      }
      this.rowContainerHeightService.updateOffset();
      this.workOutFirstAndLastRowsToRender();
      if (this.stickyRowFeature) {
        this.stickyRowFeature.checkStickyRows();
      }
      var indexesToDraw = this.calculateIndexesToDraw(rowsToRecycle);
      this.removeRowCompsNotToDraw(indexesToDraw);
      if (this.printLayout) {
        animate = false;
      }
      indexesToDraw.forEach(function(rowIndex) {
        var rowCtrl = _this.createOrUpdateRowCtrl(rowIndex, rowsToRecycle, animate, afterScroll);
        if (exists(rowCtrl))
          ;
      });
      if (rowsToRecycle) {
        var useAnimationFrame = afterScroll && !this.gridOptionsService.is("suppressAnimationFrame") && !this.printLayout;
        if (useAnimationFrame) {
          this.beans.animationFrameService.addDestroyTask(function() {
            _this.destroyRowCtrls(rowsToRecycle, animate);
            _this.updateAllRowCtrls();
            _this.dispatchDisplayedRowsChanged();
          });
        } else {
          this.destroyRowCtrls(rowsToRecycle, animate);
        }
      }
      this.updateAllRowCtrls();
    };
    RowRenderer2.prototype.dispatchDisplayedRowsChanged = function(afterScroll) {
      if (afterScroll === void 0) {
        afterScroll = false;
      }
      var event = { type: Events.EVENT_DISPLAYED_ROWS_CHANGED, afterScroll };
      this.eventService.dispatchEvent(event);
    };
    RowRenderer2.prototype.onDisplayedColumnsChanged = function() {
      var pinningLeft = this.columnModel.isPinningLeft();
      var pinningRight = this.columnModel.isPinningRight();
      var atLeastOneChanged = this.pinningLeft !== pinningLeft || pinningRight !== this.pinningRight;
      if (atLeastOneChanged) {
        this.pinningLeft = pinningLeft;
        this.pinningRight = pinningRight;
        if (this.embedFullWidthRows) {
          this.redrawFullWidthEmbeddedRows();
        }
      }
    };
    RowRenderer2.prototype.redrawFullWidthEmbeddedRows = function() {
      var rowsToRemove = [];
      this.getFullWidthRowCtrls().forEach(function(fullWidthCtrl) {
        var rowIndex = fullWidthCtrl.getRowNode().rowIndex;
        rowsToRemove.push(rowIndex.toString());
      });
      this.refreshFloatingRowComps();
      this.removeRowCtrls(rowsToRemove);
      this.redraw();
    };
    RowRenderer2.prototype.getFullWidthRowCtrls = function(rowNodes) {
      var _this = this;
      var rowNodesMap = this.mapRowNodes(rowNodes);
      return this.getAllRowCtrls().filter(function(rowCtrl) {
        if (!rowCtrl.isFullWidth()) {
          return false;
        }
        var rowNode = rowCtrl.getRowNode();
        if (rowNodesMap != null && !_this.isRowInMap(rowNode, rowNodesMap)) {
          return false;
        }
        return true;
      });
    };
    RowRenderer2.prototype.refreshFullWidthRow = function(rowNode) {
      this.refreshFullWidthRows([rowNode]);
    };
    RowRenderer2.prototype.refreshFullWidthRows = function(rowNodes) {
      var _this = this;
      var fullWidthCtrls = this.getFullWidthRowCtrls(rowNodes);
      var redraw = false;
      var indicesToForce = [];
      fullWidthCtrls.forEach(function(fullWidthCtrl) {
        var refreshed = fullWidthCtrl.refreshFullWidth();
        if (refreshed) {
          return;
        }
        var node = fullWidthCtrl.getRowNode();
        if (node.sticky) {
          _this.stickyRowFeature.refreshStickyNode(node);
        } else {
          indicesToForce.push(node.rowIndex);
        }
        redraw = true;
      });
      if (indicesToForce.length > 0) {
        this.removeRowCtrls(indicesToForce);
      }
      if (redraw) {
        this.redraw(false);
      }
    };
    RowRenderer2.prototype.createOrUpdateRowCtrl = function(rowIndex, rowsToRecycle, animate, afterScroll) {
      var rowNode;
      var rowCtrl = this.rowCtrlsByRowIndex[rowIndex];
      if (!rowCtrl) {
        rowNode = this.paginationProxy.getRow(rowIndex);
        if (exists(rowNode) && exists(rowsToRecycle) && rowsToRecycle[rowNode.id] && rowNode.alreadyRendered) {
          rowCtrl = rowsToRecycle[rowNode.id];
          rowsToRecycle[rowNode.id] = null;
        }
      }
      var creatingNewRowCtrl = !rowCtrl;
      if (creatingNewRowCtrl) {
        if (!rowNode) {
          rowNode = this.paginationProxy.getRow(rowIndex);
        }
        if (exists(rowNode)) {
          rowCtrl = this.createRowCon(rowNode, animate, afterScroll);
        } else {
          return;
        }
      }
      if (rowNode) {
        rowNode.alreadyRendered = true;
      }
      this.rowCtrlsByRowIndex[rowIndex] = rowCtrl;
      return rowCtrl;
    };
    RowRenderer2.prototype.destroyRowCtrls = function(rowCtrlsMap, animate) {
      var _this = this;
      var executeInAWhileFuncs = [];
      iterateObject(rowCtrlsMap, function(nodeId, rowCtrl) {
        if (!rowCtrl) {
          return;
        }
        if (_this.cachedRowCtrls && rowCtrl.isCacheable()) {
          _this.cachedRowCtrls.addRow(rowCtrl);
          return;
        }
        rowCtrl.destroyFirstPass();
        if (animate) {
          _this.zombieRowCtrls[rowCtrl.getInstanceId()] = rowCtrl;
          executeInAWhileFuncs.push(function() {
            rowCtrl.destroySecondPass();
            delete _this.zombieRowCtrls[rowCtrl.getInstanceId()];
          });
        } else {
          rowCtrl.destroySecondPass();
        }
      });
      if (animate) {
        executeInAWhileFuncs.push(function() {
          _this.updateAllRowCtrls();
          _this.dispatchDisplayedRowsChanged();
        });
        executeInAWhile(executeInAWhileFuncs);
      }
    };
    RowRenderer2.prototype.getRowBuffer = function() {
      var rowBuffer = this.gridOptionsService.getNum("rowBuffer");
      if (typeof rowBuffer === "number") {
        if (rowBuffer < 0) {
          doOnce(function() {
            return console.warn("AG Grid: rowBuffer should not be negative");
          }, "warn rowBuffer negative");
          rowBuffer = 0;
          this.gridOptionsService.set("rowBuffer", 0);
        }
      } else {
        rowBuffer = 10;
      }
      return rowBuffer;
    };
    RowRenderer2.prototype.getRowBufferInPixels = function() {
      var rowsToBuffer = this.getRowBuffer();
      var defaultRowHeight = this.gridOptionsService.getRowHeightAsNumber();
      return rowsToBuffer * defaultRowHeight;
    };
    RowRenderer2.prototype.workOutFirstAndLastRowsToRender = function() {
      var newFirst;
      var newLast;
      if (!this.paginationProxy.isRowsToRender()) {
        newFirst = 0;
        newLast = -1;
      } else if (this.printLayout) {
        newFirst = this.paginationProxy.getPageFirstRow();
        newLast = this.paginationProxy.getPageLastRow();
      } else {
        var bufferPixels = this.getRowBufferInPixels();
        var gridBodyCtrl = this.ctrlsService.getGridBodyCtrl();
        var suppressRowVirtualisation = this.gridOptionsService.is("suppressRowVirtualisation");
        var rowHeightsChanged = false;
        var firstPixel = void 0;
        var lastPixel = void 0;
        do {
          var paginationOffset = this.paginationProxy.getPixelOffset();
          var _a2 = this.paginationProxy.getCurrentPagePixelRange(), pageFirstPixel = _a2.pageFirstPixel, pageLastPixel = _a2.pageLastPixel;
          var divStretchOffset = this.rowContainerHeightService.getDivStretchOffset();
          var bodyVRange = gridBodyCtrl.getScrollFeature().getVScrollPosition();
          var bodyTopPixel = bodyVRange.top;
          var bodyBottomPixel = bodyVRange.bottom;
          if (suppressRowVirtualisation) {
            firstPixel = pageFirstPixel + divStretchOffset;
            lastPixel = pageLastPixel + divStretchOffset;
          } else {
            firstPixel = Math.max(bodyTopPixel + paginationOffset - bufferPixels, pageFirstPixel) + divStretchOffset;
            lastPixel = Math.min(bodyBottomPixel + paginationOffset + bufferPixels, pageLastPixel) + divStretchOffset;
          }
          this.firstVisibleVPixel = Math.max(bodyTopPixel + paginationOffset, pageFirstPixel) + divStretchOffset;
          rowHeightsChanged = this.ensureAllRowsInRangeHaveHeightsCalculated(firstPixel, lastPixel);
        } while (rowHeightsChanged);
        var firstRowIndex = this.paginationProxy.getRowIndexAtPixel(firstPixel);
        var lastRowIndex = this.paginationProxy.getRowIndexAtPixel(lastPixel);
        var pageFirstRow = this.paginationProxy.getPageFirstRow();
        var pageLastRow = this.paginationProxy.getPageLastRow();
        if (firstRowIndex < pageFirstRow) {
          firstRowIndex = pageFirstRow;
        }
        if (lastRowIndex > pageLastRow) {
          lastRowIndex = pageLastRow;
        }
        newFirst = firstRowIndex;
        newLast = lastRowIndex;
      }
      var rowLayoutNormal = this.gridOptionsService.isDomLayout("normal");
      var suppressRowCountRestriction = this.gridOptionsService.is("suppressMaxRenderedRowRestriction");
      var rowBufferMaxSize = Math.max(this.getRowBuffer(), 500);
      if (rowLayoutNormal && !suppressRowCountRestriction) {
        if (newLast - newFirst > rowBufferMaxSize) {
          newLast = newFirst + rowBufferMaxSize;
        }
      }
      var firstDiffers = newFirst !== this.firstRenderedRow;
      var lastDiffers = newLast !== this.lastRenderedRow;
      if (firstDiffers || lastDiffers) {
        this.firstRenderedRow = newFirst;
        this.lastRenderedRow = newLast;
        var event_1 = {
          type: Events.EVENT_VIEWPORT_CHANGED,
          firstRow: newFirst,
          lastRow: newLast
        };
        this.eventService.dispatchEvent(event_1);
      }
    };
    RowRenderer2.prototype.dispatchFirstDataRenderedEvent = function() {
      var _this = this;
      if (this.dataFirstRenderedFired) {
        return;
      }
      this.dataFirstRenderedFired = true;
      var event = {
        type: Events.EVENT_FIRST_DATA_RENDERED,
        firstRow: this.firstRenderedRow,
        lastRow: this.lastRenderedRow
      };
      window.requestAnimationFrame(function() {
        _this.beans.eventService.dispatchEvent(event);
      });
    };
    RowRenderer2.prototype.ensureAllRowsInRangeHaveHeightsCalculated = function(topPixel, bottomPixel) {
      var res = this.paginationProxy.ensureRowHeightsValid(topPixel, bottomPixel, -1, -1);
      if (res) {
        this.updateContainerHeights();
      }
      return res;
    };
    RowRenderer2.prototype.getFirstVisibleVerticalPixel = function() {
      return this.firstVisibleVPixel;
    };
    RowRenderer2.prototype.getFirstVirtualRenderedRow = function() {
      return this.firstRenderedRow;
    };
    RowRenderer2.prototype.getLastVirtualRenderedRow = function() {
      return this.lastRenderedRow;
    };
    RowRenderer2.prototype.doNotUnVirtualiseRow = function(rowComp2) {
      var REMOVE_ROW = false;
      var KEEP_ROW = true;
      var rowNode = rowComp2.getRowNode();
      var rowHasFocus = this.focusService.isRowNodeFocused(rowNode);
      var rowIsEditing = rowComp2.isEditing();
      var rowIsDetail = rowNode.detail;
      var mightWantToKeepRow = rowHasFocus || rowIsEditing || rowIsDetail;
      if (!mightWantToKeepRow) {
        return REMOVE_ROW;
      }
      var rowNodePresent = this.paginationProxy.isRowPresent(rowNode);
      return rowNodePresent ? KEEP_ROW : REMOVE_ROW;
    };
    RowRenderer2.prototype.createRowCon = function(rowNode, animate, afterScroll) {
      var rowCtrlFromCache = this.cachedRowCtrls ? this.cachedRowCtrls.getRow(rowNode) : null;
      if (rowCtrlFromCache) {
        return rowCtrlFromCache;
      }
      var suppressAnimationFrame = this.gridOptionsService.is("suppressAnimationFrame");
      var useAnimationFrameForCreate = afterScroll && !suppressAnimationFrame && !this.printLayout;
      var res = new RowCtrl(rowNode, this.beans, animate, useAnimationFrameForCreate, this.printLayout);
      return res;
    };
    RowRenderer2.prototype.getRenderedNodes = function() {
      var renderedRows = this.rowCtrlsByRowIndex;
      return Object.keys(renderedRows).map(function(key) {
        return renderedRows[key].getRowNode();
      });
    };
    RowRenderer2.prototype.getRowByPosition = function(rowPosition) {
      var rowCtrl;
      var rowIndex = rowPosition.rowIndex;
      switch (rowPosition.rowPinned) {
        case "top":
          rowCtrl = this.topRowCtrls[rowIndex];
          break;
        case "bottom":
          rowCtrl = this.bottomRowCtrls[rowIndex];
          break;
        default:
          rowCtrl = this.rowCtrlsByRowIndex[rowIndex];
          if (!rowCtrl) {
            rowCtrl = this.getStickyTopRowCtrls().find(function(ctrl) {
              return ctrl.getRowNode().rowIndex === rowIndex;
            }) || null;
          }
          break;
      }
      return rowCtrl;
    };
    RowRenderer2.prototype.getRowNode = function(gridRow) {
      switch (gridRow.rowPinned) {
        case "top":
          return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];
        case "bottom":
          return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];
        default:
          return this.rowModel.getRow(gridRow.rowIndex);
      }
    };
    RowRenderer2.prototype.isRangeInRenderedViewport = function(startIndex, endIndex) {
      var parentClosed = startIndex == null || endIndex == null;
      if (parentClosed) {
        return false;
      }
      var blockAfterViewport = startIndex > this.lastRenderedRow;
      var blockBeforeViewport = endIndex < this.firstRenderedRow;
      var blockInsideViewport = !blockBeforeViewport && !blockAfterViewport;
      return blockInsideViewport;
    };
    __decorate$13([
      Autowired("animationFrameService")
    ], RowRenderer2.prototype, "animationFrameService", void 0);
    __decorate$13([
      Autowired("paginationProxy")
    ], RowRenderer2.prototype, "paginationProxy", void 0);
    __decorate$13([
      Autowired("columnModel")
    ], RowRenderer2.prototype, "columnModel", void 0);
    __decorate$13([
      Autowired("pinnedRowModel")
    ], RowRenderer2.prototype, "pinnedRowModel", void 0);
    __decorate$13([
      Autowired("rowModel")
    ], RowRenderer2.prototype, "rowModel", void 0);
    __decorate$13([
      Autowired("focusService")
    ], RowRenderer2.prototype, "focusService", void 0);
    __decorate$13([
      Autowired("beans")
    ], RowRenderer2.prototype, "beans", void 0);
    __decorate$13([
      Autowired("rowContainerHeightService")
    ], RowRenderer2.prototype, "rowContainerHeightService", void 0);
    __decorate$13([
      Autowired("ctrlsService")
    ], RowRenderer2.prototype, "ctrlsService", void 0);
    __decorate$13([
      PostConstruct
    ], RowRenderer2.prototype, "postConstruct", null);
    RowRenderer2 = __decorate$13([
      Bean("rowRenderer")
    ], RowRenderer2);
    return RowRenderer2;
  }(BeanStub)
);
var RowCtrlCache = (
  /** @class */
  function() {
    function RowCtrlCache2(maxCount) {
      this.entriesMap = {};
      this.entriesList = [];
      this.maxCount = maxCount;
    }
    RowCtrlCache2.prototype.addRow = function(rowCtrl) {
      this.entriesMap[rowCtrl.getRowNode().id] = rowCtrl;
      this.entriesList.push(rowCtrl);
      rowCtrl.setCached(true);
      if (this.entriesList.length > this.maxCount) {
        var rowCtrlToDestroy = this.entriesList[0];
        rowCtrlToDestroy.destroyFirstPass();
        rowCtrlToDestroy.destroySecondPass();
        this.removeFromCache(rowCtrlToDestroy);
      }
    };
    RowCtrlCache2.prototype.getRow = function(rowNode) {
      if (rowNode == null || rowNode.id == null) {
        return null;
      }
      var res = this.entriesMap[rowNode.id];
      if (!res) {
        return null;
      }
      this.removeFromCache(res);
      res.setCached(false);
      var rowNodeMismatch = res.getRowNode() != rowNode;
      return rowNodeMismatch ? null : res;
    };
    RowCtrlCache2.prototype.removeFromCache = function(rowCtrl) {
      var rowNodeId = rowCtrl.getRowNode().id;
      delete this.entriesMap[rowNodeId];
      removeFromArray(this.entriesList, rowCtrl);
    };
    RowCtrlCache2.prototype.getEntries = function() {
      return this.entriesList;
    };
    return RowCtrlCache2;
  }()
);
var __extends$16 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$12 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ValueFormatterService = (
  /** @class */
  function(_super) {
    __extends$16(ValueFormatterService2, _super);
    function ValueFormatterService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ValueFormatterService2.prototype.formatValue = function(column, node, value, suppliedFormatter, useFormatterFromColumn) {
      if (useFormatterFromColumn === void 0) {
        useFormatterFromColumn = true;
      }
      var result = null;
      var formatter;
      var colDef = column.getColDef();
      if (suppliedFormatter) {
        formatter = suppliedFormatter;
      } else if (useFormatterFromColumn) {
        formatter = colDef.valueFormatter;
      }
      if (formatter) {
        var params = {
          value,
          node,
          data: node ? node.data : null,
          colDef,
          column,
          api: this.gridOptionsService.api,
          columnApi: this.gridOptionsService.columnApi,
          context: this.gridOptionsService.context
        };
        if (typeof formatter === "function") {
          result = formatter(params);
        } else {
          result = this.expressionService.evaluate(formatter, params);
        }
      } else if (colDef.refData) {
        return colDef.refData[value] || "";
      }
      if (result == null && Array.isArray(value)) {
        result = value.join(", ");
      }
      return result;
    };
    __decorate$12([
      Autowired("expressionService")
    ], ValueFormatterService2.prototype, "expressionService", void 0);
    ValueFormatterService2 = __decorate$12([
      Bean("valueFormatterService")
    ], ValueFormatterService2);
    return ValueFormatterService2;
  }(BeanStub)
);
var __extends$15 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$11 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var PinnedRowModel = (
  /** @class */
  function(_super) {
    __extends$15(PinnedRowModel2, _super);
    function PinnedRowModel2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    PinnedRowModel2.prototype.init = function() {
      this.setPinnedTopRowData(this.gridOptionsService.get("pinnedTopRowData"));
      this.setPinnedBottomRowData(this.gridOptionsService.get("pinnedBottomRowData"));
    };
    PinnedRowModel2.prototype.isEmpty = function(floating) {
      var rows = floating === "top" ? this.pinnedTopRows : this.pinnedBottomRows;
      return missingOrEmpty(rows);
    };
    PinnedRowModel2.prototype.isRowsToRender = function(floating) {
      return !this.isEmpty(floating);
    };
    PinnedRowModel2.prototype.getRowAtPixel = function(pixel, floating) {
      var rows = floating === "top" ? this.pinnedTopRows : this.pinnedBottomRows;
      if (missingOrEmpty(rows)) {
        return 0;
      }
      for (var i = 0; i < rows.length; i++) {
        var rowNode = rows[i];
        var rowTopPixel = rowNode.rowTop + rowNode.rowHeight - 1;
        if (rowTopPixel >= pixel) {
          return i;
        }
      }
      return rows.length - 1;
    };
    PinnedRowModel2.prototype.setPinnedTopRowData = function(rowData) {
      this.pinnedTopRows = this.createNodesFromData(rowData, true);
      var event = {
        type: Events.EVENT_PINNED_ROW_DATA_CHANGED
      };
      this.eventService.dispatchEvent(event);
    };
    PinnedRowModel2.prototype.setPinnedBottomRowData = function(rowData) {
      this.pinnedBottomRows = this.createNodesFromData(rowData, false);
      var event = {
        type: Events.EVENT_PINNED_ROW_DATA_CHANGED
      };
      this.eventService.dispatchEvent(event);
    };
    PinnedRowModel2.prototype.createNodesFromData = function(allData, isTop) {
      var _this = this;
      var rowNodes = [];
      if (allData) {
        var nextRowTop_1 = 0;
        allData.forEach(function(dataItem, index2) {
          var rowNode = new RowNode2(_this.beans);
          rowNode.data = dataItem;
          var idPrefix = isTop ? RowNode2.ID_PREFIX_TOP_PINNED : RowNode2.ID_PREFIX_BOTTOM_PINNED;
          rowNode.id = idPrefix + index2;
          rowNode.rowPinned = isTop ? "top" : "bottom";
          rowNode.setRowTop(nextRowTop_1);
          rowNode.setRowHeight(_this.gridOptionsService.getRowHeightForNode(rowNode).height);
          rowNode.setRowIndex(index2);
          nextRowTop_1 += rowNode.rowHeight;
          rowNodes.push(rowNode);
        });
      }
      return rowNodes;
    };
    PinnedRowModel2.prototype.getPinnedTopRowData = function() {
      return this.pinnedTopRows;
    };
    PinnedRowModel2.prototype.getPinnedBottomRowData = function() {
      return this.pinnedBottomRows;
    };
    PinnedRowModel2.prototype.getPinnedTopTotalHeight = function() {
      return this.getTotalHeight(this.pinnedTopRows);
    };
    PinnedRowModel2.prototype.getPinnedTopRowCount = function() {
      return this.pinnedTopRows ? this.pinnedTopRows.length : 0;
    };
    PinnedRowModel2.prototype.getPinnedBottomRowCount = function() {
      return this.pinnedBottomRows ? this.pinnedBottomRows.length : 0;
    };
    PinnedRowModel2.prototype.getPinnedTopRow = function(index2) {
      return this.pinnedTopRows[index2];
    };
    PinnedRowModel2.prototype.getPinnedBottomRow = function(index2) {
      return this.pinnedBottomRows[index2];
    };
    PinnedRowModel2.prototype.forEachPinnedTopRow = function(callback2) {
      if (missingOrEmpty(this.pinnedTopRows)) {
        return;
      }
      this.pinnedTopRows.forEach(callback2);
    };
    PinnedRowModel2.prototype.forEachPinnedBottomRow = function(callback2) {
      if (missingOrEmpty(this.pinnedBottomRows)) {
        return;
      }
      this.pinnedBottomRows.forEach(callback2);
    };
    PinnedRowModel2.prototype.getPinnedBottomTotalHeight = function() {
      return this.getTotalHeight(this.pinnedBottomRows);
    };
    PinnedRowModel2.prototype.getTotalHeight = function(rowNodes) {
      if (!rowNodes || rowNodes.length === 0) {
        return 0;
      }
      var lastNode = last(rowNodes);
      return lastNode.rowTop + lastNode.rowHeight;
    };
    __decorate$11([
      Autowired("beans")
    ], PinnedRowModel2.prototype, "beans", void 0);
    __decorate$11([
      PostConstruct
    ], PinnedRowModel2.prototype, "init", null);
    PinnedRowModel2 = __decorate$11([
      Bean("pinnedRowModel")
    ], PinnedRowModel2);
    return PinnedRowModel2;
  }(BeanStub)
);
var ServerSideTransactionResultStatus;
(function(ServerSideTransactionResultStatus2) {
  ServerSideTransactionResultStatus2["Applied"] = "Applied";
  ServerSideTransactionResultStatus2["StoreNotFound"] = "StoreNotFound";
  ServerSideTransactionResultStatus2["StoreLoading"] = "StoreLoading";
  ServerSideTransactionResultStatus2["StoreWaitingToLoad"] = "StoreWaitingToLoad";
  ServerSideTransactionResultStatus2["StoreLoadingFailed"] = "StoreLoadingFailed";
  ServerSideTransactionResultStatus2["StoreWrongType"] = "StoreWrongType";
  ServerSideTransactionResultStatus2["Cancelled"] = "Cancelled";
})(ServerSideTransactionResultStatus || (ServerSideTransactionResultStatus = {}));
var ChangedPath = (
  /** @class */
  function() {
    function ChangedPath2(keepingColumns, rootNode) {
      this.active = true;
      this.nodeIdsToColumns = {};
      this.mapToItems = {};
      this.keepingColumns = keepingColumns;
      this.pathRoot = {
        rowNode: rootNode,
        children: null
      };
      this.mapToItems[rootNode.id] = this.pathRoot;
    }
    ChangedPath2.prototype.setInactive = function() {
      this.active = false;
    };
    ChangedPath2.prototype.isActive = function() {
      return this.active;
    };
    ChangedPath2.prototype.depthFirstSearchChangedPath = function(pathItem, callback2) {
      if (pathItem.children) {
        for (var i = 0; i < pathItem.children.length; i++) {
          this.depthFirstSearchChangedPath(pathItem.children[i], callback2);
        }
      }
      callback2(pathItem.rowNode);
    };
    ChangedPath2.prototype.depthFirstSearchEverything = function(rowNode, callback2, traverseEverything) {
      if (rowNode.childrenAfterGroup) {
        for (var i = 0; i < rowNode.childrenAfterGroup.length; i++) {
          var childNode = rowNode.childrenAfterGroup[i];
          if (childNode.childrenAfterGroup) {
            this.depthFirstSearchEverything(rowNode.childrenAfterGroup[i], callback2, traverseEverything);
          } else if (traverseEverything) {
            callback2(childNode);
          }
        }
      }
      callback2(rowNode);
    };
    ChangedPath2.prototype.forEachChangedNodeDepthFirst = function(callback2, traverseLeafNodes, includeUnchangedNodes) {
      if (traverseLeafNodes === void 0) {
        traverseLeafNodes = false;
      }
      if (includeUnchangedNodes === void 0) {
        includeUnchangedNodes = false;
      }
      if (this.active && !includeUnchangedNodes) {
        this.depthFirstSearchChangedPath(this.pathRoot, callback2);
      } else {
        this.depthFirstSearchEverything(this.pathRoot.rowNode, callback2, traverseLeafNodes);
      }
    };
    ChangedPath2.prototype.executeFromRootNode = function(callback2) {
      callback2(this.pathRoot.rowNode);
    };
    ChangedPath2.prototype.createPathItems = function(rowNode) {
      var pointer = rowNode;
      var newEntryCount = 0;
      while (!this.mapToItems[pointer.id]) {
        var newEntry = {
          rowNode: pointer,
          children: null
        };
        this.mapToItems[pointer.id] = newEntry;
        newEntryCount++;
        pointer = pointer.parent;
      }
      return newEntryCount;
    };
    ChangedPath2.prototype.populateColumnsMap = function(rowNode, columns) {
      var _this = this;
      if (!this.keepingColumns || !columns) {
        return;
      }
      var pointer = rowNode;
      while (pointer) {
        if (!this.nodeIdsToColumns[pointer.id]) {
          this.nodeIdsToColumns[pointer.id] = {};
        }
        columns.forEach(function(col) {
          return _this.nodeIdsToColumns[pointer.id][col.getId()] = true;
        });
        pointer = pointer.parent;
      }
    };
    ChangedPath2.prototype.linkPathItems = function(rowNode, newEntryCount) {
      var pointer = rowNode;
      for (var i = 0; i < newEntryCount; i++) {
        var thisItem = this.mapToItems[pointer.id];
        var parentItem = this.mapToItems[pointer.parent.id];
        if (!parentItem.children) {
          parentItem.children = [];
        }
        parentItem.children.push(thisItem);
        pointer = pointer.parent;
      }
    };
    ChangedPath2.prototype.addParentNode = function(rowNode, columns) {
      if (!rowNode || rowNode.isRowPinned()) {
        return;
      }
      var newEntryCount = this.createPathItems(rowNode);
      this.linkPathItems(rowNode, newEntryCount);
      this.populateColumnsMap(rowNode, columns);
    };
    ChangedPath2.prototype.canSkip = function(rowNode) {
      return this.active && !this.mapToItems[rowNode.id];
    };
    ChangedPath2.prototype.getValueColumnsForNode = function(rowNode, valueColumns) {
      if (!this.keepingColumns) {
        return valueColumns;
      }
      var colsForThisNode = this.nodeIdsToColumns[rowNode.id];
      var result = valueColumns.filter(function(col) {
        return colsForThisNode[col.getId()];
      });
      return result;
    };
    ChangedPath2.prototype.getNotValueColumnsForNode = function(rowNode, valueColumns) {
      if (!this.keepingColumns) {
        return null;
      }
      var colsForThisNode = this.nodeIdsToColumns[rowNode.id];
      var result = valueColumns.filter(function(col) {
        return !colsForThisNode[col.getId()];
      });
      return result;
    };
    return ChangedPath2;
  }()
);
var __extends$14 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var RowNodeBlock = (
  /** @class */
  function(_super) {
    __extends$14(RowNodeBlock2, _super);
    function RowNodeBlock2(id2) {
      var _this = _super.call(this) || this;
      _this.state = RowNodeBlock2.STATE_WAITING_TO_LOAD;
      _this.version = 0;
      _this.id = id2;
      return _this;
    }
    RowNodeBlock2.prototype.getId = function() {
      return this.id;
    };
    RowNodeBlock2.prototype.load = function() {
      this.state = RowNodeBlock2.STATE_LOADING;
      this.loadFromDatasource();
    };
    RowNodeBlock2.prototype.getVersion = function() {
      return this.version;
    };
    RowNodeBlock2.prototype.setStateWaitingToLoad = function() {
      this.version++;
      this.state = RowNodeBlock2.STATE_WAITING_TO_LOAD;
    };
    RowNodeBlock2.prototype.getState = function() {
      return this.state;
    };
    RowNodeBlock2.prototype.pageLoadFailed = function(version2) {
      var requestMostRecentAndLive = this.isRequestMostRecentAndLive(version2);
      if (requestMostRecentAndLive) {
        this.state = RowNodeBlock2.STATE_FAILED;
        this.processServerFail();
      }
      this.dispatchLoadCompleted(false);
    };
    RowNodeBlock2.prototype.success = function(version2, params) {
      this.successCommon(version2, params);
    };
    RowNodeBlock2.prototype.pageLoaded = function(version2, rows, lastRow) {
      this.successCommon(version2, { rowData: rows, rowCount: lastRow });
    };
    RowNodeBlock2.prototype.isRequestMostRecentAndLive = function(version2) {
      var thisIsMostRecentRequest = version2 === this.version;
      var weAreNotDestroyed = this.isAlive();
      return thisIsMostRecentRequest && weAreNotDestroyed;
    };
    RowNodeBlock2.prototype.successCommon = function(version2, params) {
      this.dispatchLoadCompleted();
      var requestMostRecentAndLive = this.isRequestMostRecentAndLive(version2);
      if (requestMostRecentAndLive) {
        this.state = RowNodeBlock2.STATE_LOADED;
        this.processServerResult(params);
      }
    };
    RowNodeBlock2.prototype.dispatchLoadCompleted = function(success) {
      if (success === void 0) {
        success = true;
      }
      var event = {
        type: RowNodeBlock2.EVENT_LOAD_COMPLETE,
        success,
        block: this
      };
      this.dispatchEvent(event);
    };
    RowNodeBlock2.EVENT_LOAD_COMPLETE = "loadComplete";
    RowNodeBlock2.STATE_WAITING_TO_LOAD = "needsLoading";
    RowNodeBlock2.STATE_LOADING = "loading";
    RowNodeBlock2.STATE_LOADED = "loaded";
    RowNodeBlock2.STATE_FAILED = "failed";
    return RowNodeBlock2;
  }(BeanStub)
);
var __extends$13 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$10 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$7 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var RowNodeBlockLoader = (
  /** @class */
  function(_super) {
    __extends$13(RowNodeBlockLoader2, _super);
    function RowNodeBlockLoader2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.activeBlockLoadsCount = 0;
      _this.blocks = [];
      _this.active = true;
      return _this;
    }
    RowNodeBlockLoader_1 = RowNodeBlockLoader2;
    RowNodeBlockLoader2.prototype.postConstruct = function() {
      this.maxConcurrentRequests = this.getMaxConcurrentDatasourceRequests();
      var blockLoadDebounceMillis = this.gridOptionsService.getNum("blockLoadDebounceMillis");
      if (blockLoadDebounceMillis && blockLoadDebounceMillis > 0) {
        this.checkBlockToLoadDebounce = _.debounce(this.performCheckBlocksToLoad.bind(this), blockLoadDebounceMillis);
      }
    };
    RowNodeBlockLoader2.prototype.setBeans = function(loggerFactory) {
      this.logger = loggerFactory.create("RowNodeBlockLoader");
    };
    RowNodeBlockLoader2.prototype.getMaxConcurrentDatasourceRequests = function() {
      var res = this.gridOptionsService.getNum("maxConcurrentDatasourceRequests");
      if (res == null) {
        return 2;
      }
      if (res <= 0) {
        return;
      }
      return res;
    };
    RowNodeBlockLoader2.prototype.addBlock = function(block) {
      this.blocks.push(block);
      block.addEventListener(RowNodeBlock.EVENT_LOAD_COMPLETE, this.loadComplete.bind(this));
      this.checkBlockToLoad();
    };
    RowNodeBlockLoader2.prototype.removeBlock = function(block) {
      _.removeFromArray(this.blocks, block);
    };
    RowNodeBlockLoader2.prototype.destroy = function() {
      _super.prototype.destroy.call(this);
      this.active = false;
    };
    RowNodeBlockLoader2.prototype.loadComplete = function() {
      this.activeBlockLoadsCount--;
      this.checkBlockToLoad();
      this.dispatchEvent({ type: RowNodeBlockLoader_1.BLOCK_LOADED_EVENT });
      if (this.activeBlockLoadsCount == 0) {
        this.dispatchEvent({ type: RowNodeBlockLoader_1.BLOCK_LOADER_FINISHED_EVENT });
      }
    };
    RowNodeBlockLoader2.prototype.checkBlockToLoad = function() {
      if (this.checkBlockToLoadDebounce) {
        this.checkBlockToLoadDebounce();
      } else {
        this.performCheckBlocksToLoad();
      }
    };
    RowNodeBlockLoader2.prototype.performCheckBlocksToLoad = function() {
      if (!this.active) {
        return;
      }
      this.printCacheStatus();
      if (this.maxConcurrentRequests != null && this.activeBlockLoadsCount >= this.maxConcurrentRequests) {
        this.logger.log("checkBlockToLoad: max loads exceeded");
        return;
      }
      var loadAvailability = this.getAvailableLoadingCount();
      var blocksToLoad = this.blocks.filter(function(block) {
        return block.getState() === RowNodeBlock.STATE_WAITING_TO_LOAD;
      }).slice(0, loadAvailability);
      this.registerLoads(blocksToLoad.length);
      blocksToLoad.forEach(function(block) {
        return block.load();
      });
      this.printCacheStatus();
    };
    RowNodeBlockLoader2.prototype.getBlockState = function() {
      if (this.gridOptionsService.isRowModelType("serverSide")) {
        var ssrm = this.rowModel;
        return ssrm.getBlockStates();
      }
      var result = {};
      this.blocks.forEach(function(block) {
        var _a2 = block.getBlockStateJson(), id2 = _a2.id, state = _a2.state;
        result[id2] = state;
      });
      return result;
    };
    RowNodeBlockLoader2.prototype.printCacheStatus = function() {
      if (this.logger.isLogging()) {
        this.logger.log("printCacheStatus: activePageLoadsCount = " + this.activeBlockLoadsCount + "," + (" blocks = " + JSON.stringify(this.getBlockState())));
      }
    };
    RowNodeBlockLoader2.prototype.isLoading = function() {
      return this.activeBlockLoadsCount > 0;
    };
    RowNodeBlockLoader2.prototype.registerLoads = function(count) {
      this.activeBlockLoadsCount += count;
    };
    RowNodeBlockLoader2.prototype.getAvailableLoadingCount = function() {
      return this.maxConcurrentRequests !== void 0 ? this.maxConcurrentRequests - this.activeBlockLoadsCount : void 0;
    };
    var RowNodeBlockLoader_1;
    RowNodeBlockLoader2.BLOCK_LOADED_EVENT = "blockLoaded";
    RowNodeBlockLoader2.BLOCK_LOADER_FINISHED_EVENT = "blockLoaderFinished";
    __decorate$10([
      Autowired("rowModel")
    ], RowNodeBlockLoader2.prototype, "rowModel", void 0);
    __decorate$10([
      PostConstruct
    ], RowNodeBlockLoader2.prototype, "postConstruct", null);
    __decorate$10([
      __param$7(0, Qualifier("loggerFactory"))
    ], RowNodeBlockLoader2.prototype, "setBeans", null);
    RowNodeBlockLoader2 = RowNodeBlockLoader_1 = __decorate$10([
      Bean("rowNodeBlockLoader")
    ], RowNodeBlockLoader2);
    return RowNodeBlockLoader2;
  }(BeanStub)
);
var __extends$12 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$$ = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var PaginationProxy = (
  /** @class */
  function(_super) {
    __extends$12(PaginationProxy2, _super);
    function PaginationProxy2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.currentPage = 0;
      _this.topDisplayedRowIndex = 0;
      _this.bottomDisplayedRowIndex = 0;
      _this.pixelOffset = 0;
      _this.masterRowCount = 0;
      return _this;
    }
    PaginationProxy2.prototype.postConstruct = function() {
      this.active = this.gridOptionsService.is("pagination");
      this.paginateChildRows = this.isPaginateChildRows();
      this.addManagedListener(this.eventService, Events.EVENT_MODEL_UPDATED, this.onModelUpdated.bind(this));
      this.addManagedPropertyListener("pagination", this.onPaginationPageSizeChanged.bind(this));
      this.addManagedPropertyListener("paginationPageSize", this.onPaginationPageSizeChanged.bind(this));
      this.onModelUpdated();
    };
    PaginationProxy2.prototype.ensureRowHeightsValid = function(startPixel, endPixel, startLimitIndex, endLimitIndex) {
      var res = this.rowModel.ensureRowHeightsValid(startPixel, endPixel, this.getPageFirstRow(), this.getPageLastRow());
      if (res) {
        this.calculatePages();
      }
      return res;
    };
    PaginationProxy2.prototype.isPaginateChildRows = function() {
      var shouldPaginate = this.gridOptionsService.is("groupRemoveSingleChildren") || this.gridOptionsService.is("groupRemoveLowestSingleChildren");
      if (shouldPaginate) {
        return true;
      }
      return this.gridOptionsService.is("paginateChildRows");
    };
    PaginationProxy2.prototype.onModelUpdated = function(modelUpdatedEvent) {
      this.calculatePages();
      var paginationChangedEvent = {
        type: Events.EVENT_PAGINATION_CHANGED,
        animate: modelUpdatedEvent ? modelUpdatedEvent.animate : false,
        newData: modelUpdatedEvent ? modelUpdatedEvent.newData : false,
        newPage: modelUpdatedEvent ? modelUpdatedEvent.newPage : false,
        keepRenderedRows: modelUpdatedEvent ? modelUpdatedEvent.keepRenderedRows : false
      };
      this.eventService.dispatchEvent(paginationChangedEvent);
    };
    PaginationProxy2.prototype.onPaginationPageSizeChanged = function() {
      this.active = this.gridOptionsService.is("pagination");
      this.calculatePages();
      var paginationChangedEvent = {
        type: Events.EVENT_PAGINATION_CHANGED,
        animate: false,
        newData: false,
        newPage: false,
        // important to keep rendered rows, otherwise every time grid is resized,
        // we would destroy all the rows.
        keepRenderedRows: true
      };
      this.eventService.dispatchEvent(paginationChangedEvent);
    };
    PaginationProxy2.prototype.goToPage = function(page) {
      if (!this.active || this.currentPage === page || typeof this.currentPage !== "number") {
        return;
      }
      this.currentPage = page;
      var event = {
        type: Events.EVENT_MODEL_UPDATED,
        animate: false,
        keepRenderedRows: false,
        newData: false,
        newPage: true
      };
      this.onModelUpdated(event);
    };
    PaginationProxy2.prototype.getPixelOffset = function() {
      return this.pixelOffset;
    };
    PaginationProxy2.prototype.getRow = function(index2) {
      return this.rowModel.getRow(index2);
    };
    PaginationProxy2.prototype.getRowNode = function(id2) {
      return this.rowModel.getRowNode(id2);
    };
    PaginationProxy2.prototype.getRowIndexAtPixel = function(pixel) {
      return this.rowModel.getRowIndexAtPixel(pixel);
    };
    PaginationProxy2.prototype.getCurrentPageHeight = function() {
      if (missing(this.topRowBounds) || missing(this.bottomRowBounds)) {
        return 0;
      }
      return Math.max(this.bottomRowBounds.rowTop + this.bottomRowBounds.rowHeight - this.topRowBounds.rowTop, 0);
    };
    PaginationProxy2.prototype.getCurrentPagePixelRange = function() {
      var pageFirstPixel = this.topRowBounds ? this.topRowBounds.rowTop : 0;
      var pageLastPixel = this.bottomRowBounds ? this.bottomRowBounds.rowTop + this.bottomRowBounds.rowHeight : 0;
      return { pageFirstPixel, pageLastPixel };
    };
    PaginationProxy2.prototype.isRowPresent = function(rowNode) {
      if (!this.rowModel.isRowPresent(rowNode)) {
        return false;
      }
      var nodeIsInPage = rowNode.rowIndex >= this.topDisplayedRowIndex && rowNode.rowIndex <= this.bottomDisplayedRowIndex;
      return nodeIsInPage;
    };
    PaginationProxy2.prototype.isEmpty = function() {
      return this.rowModel.isEmpty();
    };
    PaginationProxy2.prototype.isRowsToRender = function() {
      return this.rowModel.isRowsToRender();
    };
    PaginationProxy2.prototype.forEachNode = function(callback2) {
      return this.rowModel.forEachNode(callback2);
    };
    PaginationProxy2.prototype.forEachNodeOnPage = function(callback2) {
      var firstRow = this.getPageFirstRow();
      var lastRow = this.getPageLastRow();
      for (var i = firstRow; i <= lastRow; i++) {
        var node = this.getRow(i);
        if (node) {
          callback2(node);
        }
      }
    };
    PaginationProxy2.prototype.getType = function() {
      return this.rowModel.getType();
    };
    PaginationProxy2.prototype.getRowBounds = function(index2) {
      var res = this.rowModel.getRowBounds(index2);
      res.rowIndex = index2;
      return res;
    };
    PaginationProxy2.prototype.getPageFirstRow = function() {
      return this.topRowBounds ? this.topRowBounds.rowIndex : -1;
    };
    PaginationProxy2.prototype.getPageLastRow = function() {
      return this.bottomRowBounds ? this.bottomRowBounds.rowIndex : -1;
    };
    PaginationProxy2.prototype.getRowCount = function() {
      return this.rowModel.getRowCount();
    };
    PaginationProxy2.prototype.getPageForIndex = function(index2) {
      return Math.floor(index2 / this.pageSize);
    };
    PaginationProxy2.prototype.goToPageWithIndex = function(index2) {
      if (!this.active) {
        return;
      }
      var pageNumber = this.getPageForIndex(index2);
      this.goToPage(pageNumber);
    };
    PaginationProxy2.prototype.isRowInPage = function(row) {
      if (!this.active) {
        return true;
      }
      var rowPage = this.getPageForIndex(row.rowIndex);
      return rowPage === this.currentPage;
    };
    PaginationProxy2.prototype.isLastPageFound = function() {
      return this.rowModel.isLastRowIndexKnown();
    };
    PaginationProxy2.prototype.getCurrentPage = function() {
      return this.currentPage;
    };
    PaginationProxy2.prototype.goToNextPage = function() {
      this.goToPage(this.currentPage + 1);
    };
    PaginationProxy2.prototype.goToPreviousPage = function() {
      this.goToPage(this.currentPage - 1);
    };
    PaginationProxy2.prototype.goToFirstPage = function() {
      this.goToPage(0);
    };
    PaginationProxy2.prototype.goToLastPage = function() {
      var rowCount = this.rowModel.getRowCount();
      var lastPage = Math.floor(rowCount / this.pageSize);
      this.goToPage(lastPage);
    };
    PaginationProxy2.prototype.getPageSize = function() {
      return this.pageSize;
    };
    PaginationProxy2.prototype.getTotalPages = function() {
      return this.totalPages;
    };
    PaginationProxy2.prototype.setPageSize = function() {
      this.pageSize = this.gridOptionsService.getNum("paginationPageSize");
      if (this.pageSize == null || this.pageSize < 1) {
        this.pageSize = 100;
      }
    };
    PaginationProxy2.prototype.calculatePages = function() {
      if (this.active) {
        this.setPageSize();
        if (this.paginateChildRows) {
          this.calculatePagesAllRows();
        } else {
          this.calculatePagesMasterRowsOnly();
        }
      } else {
        this.calculatedPagesNotActive();
      }
      this.topRowBounds = this.rowModel.getRowBounds(this.topDisplayedRowIndex);
      if (this.topRowBounds) {
        this.topRowBounds.rowIndex = this.topDisplayedRowIndex;
      }
      this.bottomRowBounds = this.rowModel.getRowBounds(this.bottomDisplayedRowIndex);
      if (this.bottomRowBounds) {
        this.bottomRowBounds.rowIndex = this.bottomDisplayedRowIndex;
      }
      this.setPixelOffset(exists(this.topRowBounds) ? this.topRowBounds.rowTop : 0);
    };
    PaginationProxy2.prototype.setPixelOffset = function(value) {
      if (this.pixelOffset === value) {
        return;
      }
      this.pixelOffset = value;
      this.eventService.dispatchEvent({ type: Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED });
    };
    PaginationProxy2.prototype.setZeroRows = function() {
      this.masterRowCount = 0;
      this.topDisplayedRowIndex = 0;
      this.bottomDisplayedRowIndex = -1;
      this.currentPage = 0;
      this.totalPages = 0;
    };
    PaginationProxy2.prototype.adjustCurrentPageIfInvalid = function() {
      if (this.currentPage >= this.totalPages) {
        this.currentPage = this.totalPages - 1;
      }
      if (!isFinite(this.currentPage) || isNaN(this.currentPage) || this.currentPage < 0) {
        this.currentPage = 0;
      }
    };
    PaginationProxy2.prototype.calculatePagesMasterRowsOnly = function() {
      this.masterRowCount = this.rowModel.getTopLevelRowCount();
      if (this.masterRowCount <= 0) {
        this.setZeroRows();
        return;
      }
      var masterLastRowIndex = this.masterRowCount - 1;
      this.totalPages = Math.floor(masterLastRowIndex / this.pageSize) + 1;
      this.adjustCurrentPageIfInvalid();
      var masterPageStartIndex = this.pageSize * this.currentPage;
      var masterPageEndIndex = this.pageSize * (this.currentPage + 1) - 1;
      if (masterPageEndIndex > masterLastRowIndex) {
        masterPageEndIndex = masterLastRowIndex;
      }
      this.topDisplayedRowIndex = this.rowModel.getTopLevelRowDisplayedIndex(masterPageStartIndex);
      if (masterPageEndIndex === masterLastRowIndex) {
        this.bottomDisplayedRowIndex = this.rowModel.getRowCount() - 1;
      } else {
        var firstIndexNotToShow = this.rowModel.getTopLevelRowDisplayedIndex(masterPageEndIndex + 1);
        this.bottomDisplayedRowIndex = firstIndexNotToShow - 1;
      }
    };
    PaginationProxy2.prototype.getMasterRowCount = function() {
      return this.masterRowCount;
    };
    PaginationProxy2.prototype.calculatePagesAllRows = function() {
      this.masterRowCount = this.rowModel.getRowCount();
      if (this.masterRowCount === 0) {
        this.setZeroRows();
        return;
      }
      var maxRowIndex = this.masterRowCount - 1;
      this.totalPages = Math.floor(maxRowIndex / this.pageSize) + 1;
      this.adjustCurrentPageIfInvalid();
      this.topDisplayedRowIndex = this.pageSize * this.currentPage;
      this.bottomDisplayedRowIndex = this.pageSize * (this.currentPage + 1) - 1;
      if (this.bottomDisplayedRowIndex > maxRowIndex) {
        this.bottomDisplayedRowIndex = maxRowIndex;
      }
    };
    PaginationProxy2.prototype.calculatedPagesNotActive = function() {
      this.pageSize = this.rowModel.getRowCount();
      this.totalPages = 1;
      this.currentPage = 0;
      this.topDisplayedRowIndex = 0;
      this.bottomDisplayedRowIndex = this.rowModel.getRowCount() - 1;
    };
    __decorate$$([
      Autowired("rowModel")
    ], PaginationProxy2.prototype, "rowModel", void 0);
    __decorate$$([
      PostConstruct
    ], PaginationProxy2.prototype, "postConstruct", null);
    PaginationProxy2 = __decorate$$([
      Bean("paginationProxy")
    ], PaginationProxy2);
    return PaginationProxy2;
  }(BeanStub)
);
var __extends$11 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$_ = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var StylingService = (
  /** @class */
  function(_super) {
    __extends$11(StylingService2, _super);
    function StylingService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    StylingService2.prototype.processAllCellClasses = function(colDef, params, onApplicableClass, onNotApplicableClass) {
      this.processClassRules(colDef.cellClassRules, params, onApplicableClass, onNotApplicableClass);
      this.processStaticCellClasses(colDef, params, onApplicableClass);
    };
    StylingService2.prototype.processClassRules = function(classRules, params, onApplicableClass, onNotApplicableClass) {
      if (classRules == null) {
        return;
      }
      var classNames = Object.keys(classRules);
      var classesToApply = {};
      var classesToRemove = {};
      var _loop_1 = function(i2) {
        var className = classNames[i2];
        var rule = classRules[className];
        var resultOfRule;
        if (typeof rule === "string") {
          resultOfRule = this_1.expressionService.evaluate(rule, params);
        } else if (typeof rule === "function") {
          resultOfRule = rule(params);
        }
        className.split(" ").forEach(function(singleClass) {
          if (singleClass == null || singleClass.trim() == "") {
            return;
          }
          resultOfRule ? classesToApply[singleClass] = true : classesToRemove[singleClass] = true;
        });
      };
      var this_1 = this;
      for (var i = 0; i < classNames.length; i++) {
        _loop_1(i);
      }
      if (onNotApplicableClass) {
        Object.keys(classesToRemove).forEach(onNotApplicableClass);
      }
      Object.keys(classesToApply).forEach(onApplicableClass);
    };
    StylingService2.prototype.getStaticCellClasses = function(colDef, params) {
      var cellClass = colDef.cellClass;
      if (!cellClass) {
        return [];
      }
      var classOrClasses;
      if (typeof cellClass === "function") {
        var cellClassFunc = cellClass;
        classOrClasses = cellClassFunc(params);
      } else {
        classOrClasses = cellClass;
      }
      if (typeof classOrClasses === "string") {
        classOrClasses = [classOrClasses];
      }
      return classOrClasses || [];
    };
    StylingService2.prototype.processStaticCellClasses = function(colDef, params, onApplicableClass) {
      var classOrClasses = this.getStaticCellClasses(colDef, params);
      classOrClasses.forEach(function(cssClassItem) {
        onApplicableClass(cssClassItem);
      });
    };
    __decorate$_([
      Autowired("expressionService")
    ], StylingService2.prototype, "expressionService", void 0);
    StylingService2 = __decorate$_([
      Bean("stylingService")
    ], StylingService2);
    return StylingService2;
  }(BeanStub)
);
var __extends$10 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgToggleButton = (
  /** @class */
  function(_super) {
    __extends$10(AgToggleButton2, _super);
    function AgToggleButton2(config) {
      return _super.call(this, config, "ag-toggle-button") || this;
    }
    AgToggleButton2.prototype.setValue = function(value, silent) {
      _super.prototype.setValue.call(this, value, silent);
      this.addOrRemoveCssClass("ag-selected", this.getValue());
      return this;
    };
    return AgToggleButton2;
  }(AgCheckbox)
);
var __extends$$ = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgInputTextArea = (
  /** @class */
  function(_super) {
    __extends$$(AgInputTextArea2, _super);
    function AgInputTextArea2(config) {
      return _super.call(this, config, "ag-text-area", null, "textarea") || this;
    }
    AgInputTextArea2.prototype.setValue = function(value, silent) {
      var ret = _super.prototype.setValue.call(this, value, silent);
      this.eInput.value = value;
      return ret;
    };
    AgInputTextArea2.prototype.setCols = function(cols) {
      this.eInput.cols = cols;
      return this;
    };
    AgInputTextArea2.prototype.setRows = function(rows) {
      this.eInput.rows = rows;
      return this;
    };
    return AgInputTextArea2;
  }(AgAbstractInputField)
);
var __extends$_ = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgInputDateField = (
  /** @class */
  function(_super) {
    __extends$_(AgInputDateField2, _super);
    function AgInputDateField2(config) {
      return _super.call(this, config, "ag-date-field", "date") || this;
    }
    AgInputDateField2.prototype.postConstruct = function() {
      var _this = this;
      _super.prototype.postConstruct.call(this);
      this.addManagedListener(this.eInput, "wheel", this.onWheel.bind(this));
      var usingSafari = isBrowserSafari();
      this.addManagedListener(this.eInput, "mousedown", function() {
        if (_this.isDisabled() || usingSafari) {
          return;
        }
        _this.eInput.focus();
      });
      this.eInput.step = "any";
    };
    AgInputDateField2.prototype.onWheel = function(e) {
      if (document.activeElement === this.eInput) {
        e.preventDefault();
      }
    };
    AgInputDateField2.prototype.setMin = function(minDate) {
      var _a2;
      var min2 = minDate instanceof Date ? (_a2 = serialiseDate(minDate !== null && minDate !== void 0 ? minDate : null, false)) !== null && _a2 !== void 0 ? _a2 : void 0 : minDate;
      if (this.min === min2) {
        return this;
      }
      this.min = min2;
      addOrRemoveAttribute(this.eInput, "min", min2);
      return this;
    };
    AgInputDateField2.prototype.setMax = function(maxDate) {
      var _a2;
      var max2 = maxDate instanceof Date ? (_a2 = serialiseDate(maxDate !== null && maxDate !== void 0 ? maxDate : null, false)) !== null && _a2 !== void 0 ? _a2 : void 0 : maxDate;
      if (this.max === max2) {
        return this;
      }
      this.max = max2;
      addOrRemoveAttribute(this.eInput, "max", max2);
      return this;
    };
    AgInputDateField2.prototype.setStep = function(step) {
      if (this.step === step) {
        return this;
      }
      this.step = step;
      addOrRemoveAttribute(this.eInput, "step", step);
      return this;
    };
    AgInputDateField2.prototype.getDate = function() {
      var _a2;
      if (!this.eInput.validity.valid) {
        return void 0;
      }
      return (_a2 = parseDateTimeFromString(this.getValue())) !== null && _a2 !== void 0 ? _a2 : void 0;
    };
    AgInputDateField2.prototype.setDate = function(date, silent) {
      this.setValue(serialiseDate(date !== null && date !== void 0 ? date : null, false), silent);
    };
    return AgInputDateField2;
  }(AgInputTextField)
);
var __extends$Z = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var AgInputRange = (
  /** @class */
  function(_super) {
    __extends$Z(AgInputRange2, _super);
    function AgInputRange2(config) {
      return _super.call(this, config, "ag-range-field", "range") || this;
    }
    AgInputRange2.prototype.postConstruct = function() {
      _super.prototype.postConstruct.call(this);
      var _a2 = this.config, min2 = _a2.min, max2 = _a2.max, step = _a2.step;
      if (min2 != null) {
        this.setMinValue(min2);
      }
      if (max2 != null) {
        this.setMaxValue(max2);
      }
      this.setStep(step || 1);
    };
    AgInputRange2.prototype.addInputListeners = function() {
      var _this = this;
      this.addManagedListener(this.eInput, "input", function(e) {
        var value = e.target.value;
        _this.setValue(value);
      });
    };
    AgInputRange2.prototype.setMinValue = function(value) {
      this.min = value;
      this.eInput.setAttribute("min", value.toString());
      return this;
    };
    AgInputRange2.prototype.setMaxValue = function(value) {
      this.max = value;
      this.eInput.setAttribute("max", value.toString());
      return this;
    };
    AgInputRange2.prototype.setStep = function(value) {
      this.eInput.setAttribute("step", value.toString());
      return this;
    };
    AgInputRange2.prototype.setValue = function(value, silent) {
      if (this.min != null) {
        value = Math.max(parseFloat(value), this.min).toString();
      }
      if (this.max != null) {
        value = Math.min(parseFloat(value), this.max).toString();
      }
      var ret = _super.prototype.setValue.call(this, value, silent);
      this.eInput.value = value;
      return ret;
    };
    return AgInputRange2;
  }(AgAbstractInputField)
);
var __extends$Y = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$Z = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgSlider = (
  /** @class */
  function(_super) {
    __extends$Y(AgSlider2, _super);
    function AgSlider2(config) {
      var _this = _super.call(this, config, AgSlider2.TEMPLATE) || this;
      _this.labelAlignment = "top";
      return _this;
    }
    AgSlider2.prototype.init = function() {
      this.eSlider.addCssClass("ag-slider-field");
    };
    AgSlider2.prototype.onValueChange = function(callbackFn) {
      var _this = this;
      var eventChanged = AgAbstractField.EVENT_CHANGED;
      this.addManagedListener(this.eText, eventChanged, function() {
        var textValue = parseFloat(_this.eText.getValue());
        _this.eSlider.setValue(textValue.toString(), true);
        callbackFn(textValue || 0);
      });
      this.addManagedListener(this.eSlider, eventChanged, function() {
        var sliderValue = _this.eSlider.getValue();
        _this.eText.setValue(sliderValue, true);
        callbackFn(parseFloat(sliderValue));
      });
      return this;
    };
    AgSlider2.prototype.setSliderWidth = function(width) {
      this.eSlider.setWidth(width);
      return this;
    };
    AgSlider2.prototype.setTextFieldWidth = function(width) {
      this.eText.setWidth(width);
      return this;
    };
    AgSlider2.prototype.setMinValue = function(minValue) {
      this.eSlider.setMinValue(minValue);
      this.eText.setMin(minValue);
      return this;
    };
    AgSlider2.prototype.setMaxValue = function(maxValue) {
      this.eSlider.setMaxValue(maxValue);
      this.eText.setMax(maxValue);
      return this;
    };
    AgSlider2.prototype.getValue = function() {
      return this.eText.getValue();
    };
    AgSlider2.prototype.setValue = function(value) {
      if (this.getValue() === value) {
        return this;
      }
      this.eText.setValue(value, true);
      this.eSlider.setValue(value, true);
      this.dispatchEvent({ type: AgAbstractField.EVENT_CHANGED });
      return this;
    };
    AgSlider2.prototype.setStep = function(step) {
      this.eSlider.setStep(step);
      this.eText.setStep(step);
      return this;
    };
    AgSlider2.TEMPLATE = '<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>';
    __decorate$Z([
      RefSelector("eLabel")
    ], AgSlider2.prototype, "eLabel", void 0);
    __decorate$Z([
      RefSelector("eSlider")
    ], AgSlider2.prototype, "eSlider", void 0);
    __decorate$Z([
      RefSelector("eText")
    ], AgSlider2.prototype, "eText", void 0);
    __decorate$Z([
      PostConstruct
    ], AgSlider2.prototype, "init", null);
    return AgSlider2;
  }(AgAbstractLabel)
);
var __extends$X = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$Y = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgGroupComponent = (
  /** @class */
  function(_super) {
    __extends$X(AgGroupComponent2, _super);
    function AgGroupComponent2(params) {
      if (params === void 0) {
        params = {};
      }
      var _this = _super.call(this, AgGroupComponent2.getTemplate(params)) || this;
      _this.suppressEnabledCheckbox = true;
      _this.suppressOpenCloseIcons = false;
      var title = params.title, enabled = params.enabled, items = params.items, suppressEnabledCheckbox = params.suppressEnabledCheckbox, suppressOpenCloseIcons = params.suppressOpenCloseIcons;
      _this.title = title;
      _this.cssIdentifier = params.cssIdentifier || "default";
      _this.enabled = enabled != null ? enabled : true;
      _this.items = items || [];
      _this.alignItems = params.alignItems || "center";
      if (suppressEnabledCheckbox != null) {
        _this.suppressEnabledCheckbox = suppressEnabledCheckbox;
      }
      if (suppressOpenCloseIcons != null) {
        _this.suppressOpenCloseIcons = suppressOpenCloseIcons;
      }
      return _this;
    }
    AgGroupComponent2.getTemplate = function(params) {
      var cssIdentifier = params.cssIdentifier || "default";
      var direction = params.direction || "vertical";
      return (
        /* html */
        '<div class="ag-group ag-' + cssIdentifier + '-group" role="presentation">\n            <div class="ag-group-title-bar ag-' + cssIdentifier + '-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-' + cssIdentifier + '-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-' + cssIdentifier + '-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-' + cssIdentifier + '-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-' + cssIdentifier + '-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-' + direction + " ag-" + cssIdentifier + '-group-container"></div>\n        </div>'
      );
    };
    AgGroupComponent2.prototype.postConstruct = function() {
      if (this.items.length) {
        var initialItems = this.items;
        this.items = [];
        this.addItems(initialItems);
      }
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      this.cbGroupEnabled.setLabel(localeTextFunc("enabled", "Enabled"));
      if (this.title) {
        this.setTitle(this.title);
      }
      if (this.enabled) {
        this.setEnabled(this.enabled);
      }
      this.setAlignItems(this.alignItems);
      this.hideEnabledCheckbox(this.suppressEnabledCheckbox);
      this.hideOpenCloseIcons(this.suppressOpenCloseIcons);
      this.setupExpandContract();
      this.refreshAriaStatus();
      this.refreshChildDisplay();
    };
    AgGroupComponent2.prototype.setupExpandContract = function() {
      var _this = this;
      this.eGroupClosedIcon.appendChild(createIcon("columnSelectClosed", this.gridOptionsService, null));
      this.eGroupOpenedIcon.appendChild(createIcon("columnSelectOpen", this.gridOptionsService, null));
      this.addManagedListener(this.eTitleBar, "click", function() {
        return _this.toggleGroupExpand();
      });
      this.addManagedListener(this.eTitleBar, "keydown", function(e) {
        switch (e.key) {
          case KeyCode.ENTER:
          case KeyCode.SPACE:
            e.preventDefault();
            _this.toggleGroupExpand();
            break;
          case KeyCode.RIGHT:
          case KeyCode.LEFT:
            e.preventDefault();
            _this.toggleGroupExpand(e.key === KeyCode.RIGHT);
            break;
        }
      });
    };
    AgGroupComponent2.prototype.refreshAriaStatus = function() {
      if (!this.suppressOpenCloseIcons) {
        setAriaExpanded(this.eTitleBar, this.expanded);
      }
    };
    AgGroupComponent2.prototype.refreshChildDisplay = function() {
      var showIcon = !this.suppressOpenCloseIcons;
      setDisplayed(this.eToolbar, this.expanded && !this.suppressEnabledCheckbox);
      setDisplayed(this.eGroupOpenedIcon, showIcon && this.expanded);
      setDisplayed(this.eGroupClosedIcon, showIcon && !this.expanded);
    };
    AgGroupComponent2.prototype.isExpanded = function() {
      return this.expanded;
    };
    AgGroupComponent2.prototype.setAlignItems = function(alignment) {
      if (this.alignItems !== alignment) {
        this.removeCssClass("ag-group-item-alignment-" + this.alignItems);
      }
      this.alignItems = alignment;
      var newCls = "ag-group-item-alignment-" + this.alignItems;
      this.addCssClass(newCls);
      return this;
    };
    AgGroupComponent2.prototype.toggleGroupExpand = function(expanded) {
      if (this.suppressOpenCloseIcons) {
        this.expanded = true;
        this.refreshChildDisplay();
        setDisplayed(this.eContainer, true);
        return this;
      }
      expanded = expanded != null ? expanded : !this.expanded;
      if (this.expanded === expanded) {
        return this;
      }
      this.expanded = expanded;
      this.refreshAriaStatus();
      this.refreshChildDisplay();
      setDisplayed(this.eContainer, expanded);
      this.dispatchEvent({ type: this.expanded ? AgGroupComponent2.EVENT_EXPANDED : AgGroupComponent2.EVENT_COLLAPSED });
      return this;
    };
    AgGroupComponent2.prototype.addItems = function(items) {
      var _this = this;
      items.forEach(function(item) {
        return _this.addItem(item);
      });
    };
    AgGroupComponent2.prototype.addItem = function(item) {
      var container = this.eContainer;
      var el2 = item instanceof Component ? item.getGui() : item;
      el2.classList.add("ag-group-item", "ag-" + this.cssIdentifier + "-group-item");
      container.appendChild(el2);
      this.items.push(el2);
    };
    AgGroupComponent2.prototype.hideItem = function(hide, index2) {
      var itemToHide = this.items[index2];
      setDisplayed(itemToHide, !hide);
    };
    AgGroupComponent2.prototype.setTitle = function(title) {
      this.eTitle.innerText = title;
      return this;
    };
    AgGroupComponent2.prototype.addCssClassToTitleBar = function(cssClass) {
      this.eTitleBar.classList.add(cssClass);
    };
    AgGroupComponent2.prototype.setEnabled = function(enabled, skipToggle) {
      this.enabled = enabled;
      this.refreshDisabledStyles();
      this.toggleGroupExpand(enabled);
      if (!skipToggle) {
        this.cbGroupEnabled.setValue(enabled);
      }
      return this;
    };
    AgGroupComponent2.prototype.isEnabled = function() {
      return this.enabled;
    };
    AgGroupComponent2.prototype.onEnableChange = function(callbackFn) {
      var _this = this;
      this.cbGroupEnabled.onValueChange(function(newSelection) {
        _this.setEnabled(newSelection, true);
        callbackFn(newSelection);
      });
      return this;
    };
    AgGroupComponent2.prototype.hideEnabledCheckbox = function(hide) {
      this.suppressEnabledCheckbox = hide;
      this.refreshChildDisplay();
      this.refreshDisabledStyles();
      return this;
    };
    AgGroupComponent2.prototype.hideOpenCloseIcons = function(hide) {
      this.suppressOpenCloseIcons = hide;
      if (hide) {
        this.toggleGroupExpand(true);
      }
      return this;
    };
    AgGroupComponent2.prototype.refreshDisabledStyles = function() {
      this.addOrRemoveCssClass("ag-disabled", !this.enabled);
      if (this.suppressEnabledCheckbox && !this.enabled) {
        this.eTitleBar.classList.add("ag-disabled-group-title-bar");
        this.eTitleBar.removeAttribute("tabindex");
      } else {
        this.eTitleBar.classList.remove("ag-disabled-group-title-bar");
        this.eTitleBar.setAttribute("tabindex", "0");
      }
      this.eContainer.classList.toggle("ag-disabled-group-container", !this.enabled);
    };
    AgGroupComponent2.EVENT_EXPANDED = "expanded";
    AgGroupComponent2.EVENT_COLLAPSED = "collapsed";
    __decorate$Y([
      RefSelector("eTitleBar")
    ], AgGroupComponent2.prototype, "eTitleBar", void 0);
    __decorate$Y([
      RefSelector("eGroupOpenedIcon")
    ], AgGroupComponent2.prototype, "eGroupOpenedIcon", void 0);
    __decorate$Y([
      RefSelector("eGroupClosedIcon")
    ], AgGroupComponent2.prototype, "eGroupClosedIcon", void 0);
    __decorate$Y([
      RefSelector("eToolbar")
    ], AgGroupComponent2.prototype, "eToolbar", void 0);
    __decorate$Y([
      RefSelector("cbGroupEnabled")
    ], AgGroupComponent2.prototype, "cbGroupEnabled", void 0);
    __decorate$Y([
      RefSelector("eTitle")
    ], AgGroupComponent2.prototype, "eTitle", void 0);
    __decorate$Y([
      RefSelector("eContainer")
    ], AgGroupComponent2.prototype, "eContainer", void 0);
    __decorate$Y([
      PostConstruct
    ], AgGroupComponent2.prototype, "postConstruct", null);
    return AgGroupComponent2;
  }(Component)
);
var __extends$W = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __read$c = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$a = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var TabGuardComp$1 = (
  /** @class */
  function(_super) {
    __extends$W(TabGuardComp2, _super);
    function TabGuardComp2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    TabGuardComp2.prototype.initialiseTabGuard = function(params) {
      this.eTopGuard = this.createTabGuard("top");
      this.eBottomGuard = this.createTabGuard("bottom");
      this.eFocusableElement = this.getFocusableElement();
      var tabGuards = [this.eTopGuard, this.eBottomGuard];
      var compProxy = {
        setTabIndex: function(tabIndex) {
          tabGuards.forEach(function(tabGuard) {
            return tabIndex != null ? tabGuard.setAttribute("tabindex", tabIndex) : tabGuard.removeAttribute("tabindex");
          });
        }
      };
      this.addTabGuards(this.eTopGuard, this.eBottomGuard);
      this.tabGuardCtrl = this.createManagedBean(new TabGuardCtrl({
        comp: compProxy,
        eTopGuard: this.eTopGuard,
        eBottomGuard: this.eBottomGuard,
        eFocusableElement: this.eFocusableElement,
        onFocusIn: params.onFocusIn,
        onFocusOut: params.onFocusOut,
        focusInnerElement: params.focusInnerElement,
        handleKeyDown: params.handleKeyDown,
        onTabKeyDown: params.onTabKeyDown,
        shouldStopEventPropagation: params.shouldStopEventPropagation
      }));
    };
    TabGuardComp2.prototype.createTabGuard = function(side) {
      var tabGuard = document.createElement("div");
      var cls = side === "top" ? TabGuardClassNames.TAB_GUARD_TOP : TabGuardClassNames.TAB_GUARD_BOTTOM;
      tabGuard.classList.add(TabGuardClassNames.TAB_GUARD, cls);
      setAriaRole(tabGuard, "presentation");
      return tabGuard;
    };
    TabGuardComp2.prototype.addTabGuards = function(topTabGuard, bottomTabGuard) {
      this.eFocusableElement.insertAdjacentElement("afterbegin", topTabGuard);
      this.eFocusableElement.insertAdjacentElement("beforeend", bottomTabGuard);
    };
    TabGuardComp2.prototype.removeAllChildrenExceptTabGuards = function() {
      var tabGuards = [this.eTopGuard, this.eBottomGuard];
      clearElement(this.getFocusableElement());
      this.addTabGuards.apply(this, __spreadArray$a([], __read$c(tabGuards)));
    };
    TabGuardComp2.prototype.forceFocusOutOfContainer = function(up) {
      if (up === void 0) {
        up = false;
      }
      this.tabGuardCtrl.forceFocusOutOfContainer(up);
    };
    TabGuardComp2.prototype.appendChild = function(newChild, container) {
      if (!isNodeOrElement(newChild)) {
        newChild = newChild.getGui();
      }
      var bottomTabGuard = this.eBottomGuard;
      if (bottomTabGuard) {
        bottomTabGuard.insertAdjacentElement("beforebegin", newChild);
      } else {
        _super.prototype.appendChild.call(this, newChild, container);
      }
    };
    return TabGuardComp2;
  }(Component)
);
var __extends$V = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$5$1 = function() {
  __assign$5$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$5$1.apply(this, arguments);
};
var __decorate$X = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgMenuList = (
  /** @class */
  function(_super) {
    __extends$V(AgMenuList2, _super);
    function AgMenuList2(level) {
      if (level === void 0) {
        level = 1;
      }
      var _this = _super.call(
        this,
        /* html */
        '<div class="ag-menu-list" role="tree"></div>'
      ) || this;
      _this.level = level;
      _this.menuItems = [];
      return _this;
    }
    AgMenuList2.prototype.postConstruct = function() {
      var _this = this;
      this.initialiseTabGuard({
        onTabKeyDown: function(e) {
          return _this.onTabKeyDown(e);
        },
        handleKeyDown: function(e) {
          return _this.handleKeyDown(e);
        }
      });
    };
    AgMenuList2.prototype.onTabKeyDown = function(e) {
      var parent = this.getParentComponent();
      var parentGui = parent && parent.getGui();
      var isManaged = parentGui && parentGui.classList.contains("ag-focus-managed");
      if (!isManaged) {
        e.preventDefault();
      }
      if (e.shiftKey) {
        this.closeIfIsChild(e);
      }
    };
    AgMenuList2.prototype.handleKeyDown = function(e) {
      switch (e.key) {
        case KeyCode.UP:
        case KeyCode.RIGHT:
        case KeyCode.DOWN:
        case KeyCode.LEFT:
          e.preventDefault();
          this.handleNavKey(e.key);
          break;
        case KeyCode.ESCAPE:
          var topMenu = this.findTopMenu();
          if (topMenu) {
            this.focusService.focusInto(topMenu.getGui());
          }
          break;
      }
    };
    AgMenuList2.prototype.clearActiveItem = function() {
      if (this.activeMenuItem) {
        this.activeMenuItem.deactivate();
        this.activeMenuItem = null;
      }
    };
    AgMenuList2.prototype.addMenuItems = function(menuItems) {
      var _this = this;
      if (menuItems == null) {
        return;
      }
      menuItems.forEach(function(menuItemOrString) {
        if (menuItemOrString === "separator") {
          _this.addSeparator();
        } else if (typeof menuItemOrString === "string") {
          console.warn("AG Grid: unrecognised menu item " + menuItemOrString);
        } else {
          _this.addItem(menuItemOrString);
        }
      });
    };
    AgMenuList2.prototype.addItem = function(menuItemDef) {
      var _this = this;
      var menuItem = this.createManagedBean(new AgMenuItemComponent(__assign$5$1(__assign$5$1({}, menuItemDef), { isAnotherSubMenuOpen: function() {
        return _this.menuItems.some(function(m2) {
          return m2.isSubMenuOpen();
        });
      } })));
      menuItem.setParentComponent(this);
      setAriaLevel(menuItem.getGui(), this.level);
      this.menuItems.push(menuItem);
      this.appendChild(menuItem.getGui());
      this.addManagedListener(menuItem, AgMenuItemComponent.EVENT_MENU_ITEM_SELECTED, function(event) {
        _this.dispatchEvent(event);
      });
      this.addManagedListener(menuItem, AgMenuItemComponent.EVENT_MENU_ITEM_ACTIVATED, function(event) {
        if (_this.activeMenuItem && _this.activeMenuItem !== event.menuItem) {
          _this.activeMenuItem.deactivate();
        }
        _this.activeMenuItem = event.menuItem;
      });
    };
    AgMenuList2.prototype.activateFirstItem = function() {
      var item = this.menuItems.filter(function(currentItem) {
        return !currentItem.isDisabled();
      })[0];
      if (!item) {
        return;
      }
      item.activate();
    };
    AgMenuList2.prototype.addSeparator = function() {
      var separatorHtml = (
        /* html */
        '\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>'
      );
      this.appendChild(loadTemplate(separatorHtml));
    };
    AgMenuList2.prototype.findTopMenu = function() {
      var parent = this.getParentComponent();
      if (!parent && this instanceof AgMenuList2) {
        return this;
      }
      while (true) {
        var nextParent = parent && parent.getParentComponent && parent.getParentComponent();
        if (!nextParent || !(nextParent instanceof AgMenuList2 || nextParent instanceof AgMenuItemComponent)) {
          break;
        }
        parent = nextParent;
      }
      return parent instanceof AgMenuList2 ? parent : void 0;
    };
    AgMenuList2.prototype.handleNavKey = function(key) {
      switch (key) {
        case KeyCode.UP:
        case KeyCode.DOWN:
          var nextItem = this.findNextItem(key === KeyCode.UP);
          if (nextItem && nextItem !== this.activeMenuItem) {
            nextItem.activate();
          }
          return;
      }
      var left = this.gridOptionsService.is("enableRtl") ? KeyCode.RIGHT : KeyCode.LEFT;
      if (key === left) {
        this.closeIfIsChild();
      } else {
        this.openChild();
      }
    };
    AgMenuList2.prototype.closeIfIsChild = function(e) {
      var parentItem = this.getParentComponent();
      if (parentItem && parentItem instanceof AgMenuItemComponent) {
        if (e) {
          e.preventDefault();
        }
        parentItem.closeSubMenu();
        parentItem.getGui().focus();
      }
    };
    AgMenuList2.prototype.openChild = function() {
      if (this.activeMenuItem) {
        this.activeMenuItem.openSubMenu(true);
      }
    };
    AgMenuList2.prototype.findNextItem = function(up) {
      var items = this.menuItems.filter(function(item2) {
        return !item2.isDisabled();
      });
      if (!items.length) {
        return;
      }
      if (!this.activeMenuItem) {
        return up ? last(items) : items[0];
      }
      if (up) {
        items.reverse();
      }
      var nextItem;
      var foundCurrent = false;
      for (var i = 0; i < items.length; i++) {
        var item = items[i];
        if (!foundCurrent) {
          if (item === this.activeMenuItem) {
            foundCurrent = true;
          }
          continue;
        }
        nextItem = item;
        break;
      }
      return nextItem || this.activeMenuItem;
    };
    AgMenuList2.prototype.destroy = function() {
      this.clearActiveItem();
      _super.prototype.destroy.call(this);
    };
    __decorate$X([
      Autowired("focusService")
    ], AgMenuList2.prototype, "focusService", void 0);
    __decorate$X([
      PostConstruct
    ], AgMenuList2.prototype, "postConstruct", null);
    return AgMenuList2;
  }(TabGuardComp$1)
);
var __extends$U = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$W = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgMenuPanel = (
  /** @class */
  function(_super) {
    __extends$U(AgMenuPanel2, _super);
    function AgMenuPanel2(wrappedComponent) {
      var _this = _super.call(this) || this;
      _this.wrappedComponent = wrappedComponent;
      _this.setTemplateFromElement(wrappedComponent.getGui());
      return _this;
    }
    AgMenuPanel2.prototype.postConstruct = function() {
      var _this = this;
      this.initialiseTabGuard({
        onTabKeyDown: function(e) {
          return _this.onTabKeyDown(e);
        },
        handleKeyDown: function(e) {
          return _this.handleKeyDown(e);
        }
      });
    };
    AgMenuPanel2.prototype.handleKeyDown = function(e) {
      if (e.key === KeyCode.ESCAPE) {
        this.closePanel();
      }
    };
    AgMenuPanel2.prototype.onTabKeyDown = function(e) {
      if (e.defaultPrevented) {
        return;
      }
      this.closePanel();
      e.preventDefault();
    };
    AgMenuPanel2.prototype.closePanel = function() {
      var menuItem = this.parentComponent;
      menuItem.closeSubMenu();
      setTimeout(function() {
        return menuItem.getGui().focus();
      }, 0);
    };
    __decorate$W([
      PostConstruct
    ], AgMenuPanel2.prototype, "postConstruct", null);
    return AgMenuPanel2;
  }(TabGuardComp$1)
);
var __extends$T = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$V = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgMenuItemComponent = (
  /** @class */
  function(_super) {
    __extends$T(AgMenuItemComponent2, _super);
    function AgMenuItemComponent2(params) {
      var _this = _super.call(this) || this;
      _this.params = params;
      _this.isActive = false;
      _this.subMenuIsOpen = false;
      _this.setTemplate(
        /* html */
        '<div class="' + _this.getClassName() + '" tabindex="-1" role="treeitem"></div>'
      );
      return _this;
    }
    AgMenuItemComponent2.prototype.init = function() {
      var _this = this;
      this.addIcon();
      this.addName();
      this.addShortcut();
      this.addSubMenu();
      this.addTooltip();
      var eGui = this.getGui();
      if (this.params.disabled) {
        this.addCssClass(this.getClassName("disabled"));
        setAriaDisabled(eGui, true);
      } else {
        this.addGuiEventListener("click", function(e) {
          return _this.onItemSelected(e);
        });
        this.addGuiEventListener("keydown", function(e) {
          if (e.key === KeyCode.ENTER || e.key === KeyCode.SPACE) {
            e.preventDefault();
            _this.onItemSelected(e);
          }
        });
        this.addGuiEventListener("mousedown", function(e) {
          e.stopPropagation();
          e.preventDefault();
        });
        this.addGuiEventListener("mouseenter", function() {
          return _this.onMouseEnter();
        });
        this.addGuiEventListener("mouseleave", function() {
          return _this.onMouseLeave();
        });
      }
      if (this.params.cssClasses) {
        this.params.cssClasses.forEach(function(it) {
          return _this.addCssClass(it);
        });
      }
    };
    AgMenuItemComponent2.prototype.isDisabled = function() {
      return !!this.params.disabled;
    };
    AgMenuItemComponent2.prototype.openSubMenu = function(activateFirstItem) {
      var _this = this;
      if (activateFirstItem === void 0) {
        activateFirstItem = false;
      }
      this.closeSubMenu();
      if (!this.params.subMenu) {
        return;
      }
      var ePopup = loadTemplate(
        /* html */
        '<div class="ag-menu" role="presentation"></div>'
      );
      var destroySubMenu;
      if (this.params.subMenu instanceof Array) {
        var currentLevel = getAriaLevel(this.getGui());
        var nextLevel = isNaN(currentLevel) ? 1 : currentLevel + 1;
        var childMenu_1 = this.createBean(new AgMenuList(nextLevel));
        childMenu_1.setParentComponent(this);
        childMenu_1.addMenuItems(this.params.subMenu);
        ePopup.appendChild(childMenu_1.getGui());
        this.addManagedListener(childMenu_1, AgMenuItemComponent2.EVENT_MENU_ITEM_SELECTED, function(e) {
          return _this.dispatchEvent(e);
        });
        childMenu_1.addGuiEventListener("mouseenter", function() {
          return _this.cancelDeactivate();
        });
        destroySubMenu = function() {
          return _this.destroyBean(childMenu_1);
        };
        if (activateFirstItem) {
          setTimeout(function() {
            return childMenu_1.activateFirstItem();
          }, 0);
        }
      } else {
        var subMenu_1 = this.params.subMenu;
        var menuPanel = this.createBean(new AgMenuPanel(subMenu_1));
        menuPanel.setParentComponent(this);
        var subMenuGui_1 = menuPanel.getGui();
        var mouseEvent_1 = "mouseenter";
        var mouseEnterListener_1 = function() {
          return _this.cancelDeactivate();
        };
        subMenuGui_1.addEventListener(mouseEvent_1, mouseEnterListener_1);
        destroySubMenu = function() {
          return subMenuGui_1.removeEventListener(mouseEvent_1, mouseEnterListener_1);
        };
        ePopup.appendChild(subMenuGui_1);
        if (subMenu_1.afterGuiAttached) {
          setTimeout(function() {
            return subMenu_1.afterGuiAttached();
          }, 0);
        }
      }
      var eGui = this.getGui();
      var positionCallback = this.popupService.positionPopupForMenu.bind(this.popupService, { eventSource: eGui, ePopup });
      var translate = this.localeService.getLocaleTextFunc();
      var addPopupRes = this.popupService.addPopup({
        modal: true,
        eChild: ePopup,
        positionCallback,
        anchorToElement: eGui,
        ariaLabel: translate("ariaLabelSubMenu", "SubMenu")
      });
      this.subMenuIsOpen = true;
      setAriaExpanded(eGui, true);
      this.hideSubMenu = function() {
        if (addPopupRes) {
          addPopupRes.hideFunc();
        }
        _this.subMenuIsOpen = false;
        setAriaExpanded(eGui, false);
        destroySubMenu();
      };
    };
    AgMenuItemComponent2.prototype.closeSubMenu = function() {
      if (!this.hideSubMenu) {
        return;
      }
      this.hideSubMenu();
      this.hideSubMenu = null;
      setAriaExpanded(this.getGui(), false);
    };
    AgMenuItemComponent2.prototype.isSubMenuOpen = function() {
      return this.subMenuIsOpen;
    };
    AgMenuItemComponent2.prototype.activate = function(openSubMenu) {
      var _this = this;
      this.cancelActivate();
      if (this.params.disabled) {
        return;
      }
      this.isActive = true;
      this.addCssClass(this.getClassName("active"));
      this.getGui().focus();
      if (openSubMenu && this.params.subMenu) {
        window.setTimeout(function() {
          if (_this.isAlive() && _this.isActive) {
            _this.openSubMenu();
          }
        }, 300);
      }
      this.onItemActivated();
    };
    AgMenuItemComponent2.prototype.deactivate = function() {
      this.cancelDeactivate();
      this.removeCssClass(this.getClassName("active"));
      this.isActive = false;
      if (this.subMenuIsOpen) {
        this.hideSubMenu();
      }
    };
    AgMenuItemComponent2.prototype.addIcon = function() {
      if (!this.params.checked && !this.params.icon && this.params.isCompact) {
        return;
      }
      var icon = loadTemplate(
        /* html */
        '<span ref="eIcon" class="' + this.getClassName("part") + " " + this.getClassName("icon") + '" role="presentation"></span>'
      );
      if (this.params.checked) {
        icon.appendChild(createIconNoSpan("check", this.gridOptionsService));
      } else if (this.params.icon) {
        if (isNodeOrElement(this.params.icon)) {
          icon.appendChild(this.params.icon);
        } else if (typeof this.params.icon === "string") {
          icon.innerHTML = this.params.icon;
        } else {
          console.warn("AG Grid: menu item icon must be DOM node or string");
        }
      }
      this.getGui().appendChild(icon);
    };
    AgMenuItemComponent2.prototype.addName = function() {
      if (!this.params.name && this.params.isCompact) {
        return;
      }
      var name = loadTemplate(
        /* html */
        '<span ref="eName" class="' + this.getClassName("part") + " " + this.getClassName("text") + '">' + (this.params.name || "") + "</span>"
      );
      this.getGui().appendChild(name);
    };
    AgMenuItemComponent2.prototype.addTooltip = function() {
      if (!this.params.tooltip) {
        return;
      }
      this.tooltip = this.params.tooltip;
      if (this.gridOptionsService.is("enableBrowserTooltips")) {
        this.getGui().setAttribute("title", this.tooltip);
      } else {
        this.createManagedBean(new CustomTooltipFeature(this));
      }
    };
    AgMenuItemComponent2.prototype.getTooltipParams = function() {
      return {
        location: "menu",
        value: this.tooltip
      };
    };
    AgMenuItemComponent2.prototype.addShortcut = function() {
      if (!this.params.shortcut && this.params.isCompact) {
        return;
      }
      var shortcut = loadTemplate(
        /* html */
        '<span ref="eShortcut" class="' + this.getClassName("part") + " " + this.getClassName("shortcut") + '">' + (this.params.shortcut || "") + "</span>"
      );
      this.getGui().appendChild(shortcut);
    };
    AgMenuItemComponent2.prototype.addSubMenu = function() {
      if (!this.params.subMenu && this.params.isCompact) {
        return;
      }
      var pointer = loadTemplate(
        /* html */
        '<span ref="ePopupPointer" class="' + this.getClassName("part") + " " + this.getClassName("popup-pointer") + '"></span>'
      );
      var eGui = this.getGui();
      if (this.params.subMenu) {
        var iconName = this.gridOptionsService.is("enableRtl") ? "smallLeft" : "smallRight";
        setAriaExpanded(eGui, false);
        pointer.appendChild(createIconNoSpan(iconName, this.gridOptionsService));
      }
      eGui.appendChild(pointer);
    };
    AgMenuItemComponent2.prototype.onItemSelected = function(event) {
      if (this.params.action) {
        this.params.action();
      } else {
        this.openSubMenu(event && event.type === "keydown");
      }
      if (this.params.subMenu && !this.params.action) {
        return;
      }
      var e = {
        type: AgMenuItemComponent2.EVENT_MENU_ITEM_SELECTED,
        action: this.params.action,
        checked: this.params.checked,
        cssClasses: this.params.cssClasses,
        disabled: this.params.disabled,
        icon: this.params.icon,
        name: this.params.name,
        shortcut: this.params.shortcut,
        subMenu: this.params.subMenu,
        tooltip: this.params.tooltip,
        event
      };
      this.dispatchEvent(e);
    };
    AgMenuItemComponent2.prototype.onItemActivated = function() {
      var event = {
        type: AgMenuItemComponent2.EVENT_MENU_ITEM_ACTIVATED,
        menuItem: this
      };
      this.dispatchEvent(event);
    };
    AgMenuItemComponent2.prototype.cancelActivate = function() {
      if (this.activateTimeoutId) {
        window.clearTimeout(this.activateTimeoutId);
        this.activateTimeoutId = 0;
      }
    };
    AgMenuItemComponent2.prototype.cancelDeactivate = function() {
      if (this.deactivateTimeoutId) {
        window.clearTimeout(this.deactivateTimeoutId);
        this.deactivateTimeoutId = 0;
      }
    };
    AgMenuItemComponent2.prototype.onMouseEnter = function() {
      var _this = this;
      this.cancelDeactivate();
      if (this.params.isAnotherSubMenuOpen()) {
        this.activateTimeoutId = window.setTimeout(function() {
          return _this.activate(true);
        }, AgMenuItemComponent2.ACTIVATION_DELAY);
      } else {
        this.activate(true);
      }
    };
    AgMenuItemComponent2.prototype.onMouseLeave = function() {
      var _this = this;
      this.cancelActivate();
      if (this.isSubMenuOpen()) {
        this.deactivateTimeoutId = window.setTimeout(function() {
          return _this.deactivate();
        }, AgMenuItemComponent2.ACTIVATION_DELAY);
      } else {
        this.deactivate();
      }
    };
    AgMenuItemComponent2.prototype.getClassName = function(suffix) {
      var prefix = this.params.isCompact ? "ag-compact-menu-option" : "ag-menu-option";
      return suffix ? prefix + "-" + suffix : prefix;
    };
    AgMenuItemComponent2.EVENT_MENU_ITEM_SELECTED = "menuItemSelected";
    AgMenuItemComponent2.EVENT_MENU_ITEM_ACTIVATED = "menuItemActivated";
    AgMenuItemComponent2.ACTIVATION_DELAY = 80;
    __decorate$V([
      Autowired("popupService")
    ], AgMenuItemComponent2.prototype, "popupService", void 0);
    __decorate$V([
      PostConstruct
    ], AgMenuItemComponent2.prototype, "init", null);
    return AgMenuItemComponent2;
  }(Component)
);
var __extends$S = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$U = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgPanel = (
  /** @class */
  function(_super) {
    __extends$S(AgPanel2, _super);
    function AgPanel2(config) {
      var _this = _super.call(this, AgPanel2.getTemplate(config)) || this;
      _this.closable = true;
      _this.config = config;
      return _this;
    }
    AgPanel2.getTemplate = function(config) {
      var cssIdentifier = config && config.cssIdentifier || "default";
      return (
        /* html */
        '<div class="ag-panel ag-' + cssIdentifier + '-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-' + cssIdentifier + '-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-' + cssIdentifier + '-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-' + cssIdentifier + '-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-' + cssIdentifier + '-panel-content-wrapper"></div>\n        </div>'
      );
    };
    AgPanel2.prototype.postConstruct = function() {
      var _this = this;
      var _a2 = this.config, component = _a2.component, closable = _a2.closable, hideTitleBar = _a2.hideTitleBar, title = _a2.title, _b2 = _a2.minWidth, minWidth = _b2 === void 0 ? 250 : _b2, width = _a2.width, _c = _a2.minHeight, minHeight = _c === void 0 ? 250 : _c, height = _a2.height, centered = _a2.centered, popup = _a2.popup, x2 = _a2.x, y2 = _a2.y;
      this.positionableFeature = new PositionableFeature(this.getGui(), {
        minWidth,
        width,
        minHeight,
        height,
        centered,
        x: x2,
        y: y2,
        popup,
        calculateTopBuffer: function() {
          return _this.positionableFeature.getHeight() - _this.getBodyHeight();
        }
      });
      this.createManagedBean(this.positionableFeature);
      var eGui = this.getGui();
      if (component) {
        this.setBodyComponent(component);
      }
      if (!hideTitleBar) {
        if (title) {
          this.setTitle(title);
        }
        this.setClosable(closable != null ? closable : this.closable);
      } else {
        setDisplayed(this.eTitleBar, false);
      }
      this.addManagedListener(this.eTitleBar, "mousedown", function(e) {
        var eDocument = _this.gridOptionsService.getDocument();
        if (eGui.contains(e.relatedTarget) || eGui.contains(eDocument.activeElement) || _this.eTitleBarButtons.contains(e.target)) {
          e.preventDefault();
          return;
        }
        var focusEl = _this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");
        if (focusEl) {
          focusEl.focus();
        }
      });
      if (popup && this.positionableFeature.isPositioned()) {
        return;
      }
      if (this.renderComponent) {
        this.renderComponent();
      }
      this.positionableFeature.initialisePosition();
      this.eContentWrapper.style.height = "0";
    };
    AgPanel2.prototype.renderComponent = function() {
      var _this = this;
      var eGui = this.getGui();
      eGui.focus();
      this.close = function() {
        eGui.parentElement.removeChild(eGui);
        _this.destroy();
      };
    };
    AgPanel2.prototype.getHeight = function() {
      return this.positionableFeature.getHeight();
    };
    AgPanel2.prototype.setHeight = function(height) {
      this.positionableFeature.setHeight(height);
    };
    AgPanel2.prototype.getWidth = function() {
      return this.positionableFeature.getWidth();
    };
    AgPanel2.prototype.setWidth = function(width) {
      this.positionableFeature.setWidth(width);
    };
    AgPanel2.prototype.setClosable = function(closable) {
      if (closable !== this.closable) {
        this.closable = closable;
      }
      if (closable) {
        var closeButtonComp = this.closeButtonComp = new Component(AgPanel2.CLOSE_BTN_TEMPLATE);
        this.getContext().createBean(closeButtonComp);
        var eGui = closeButtonComp.getGui();
        var child = createIconNoSpan("close", this.gridOptionsService);
        child.classList.add("ag-panel-title-bar-button-icon");
        eGui.appendChild(child);
        this.addTitleBarButton(closeButtonComp);
        closeButtonComp.addManagedListener(eGui, "click", this.onBtClose.bind(this));
      } else if (this.closeButtonComp) {
        var eGui = this.closeButtonComp.getGui();
        eGui.parentElement.removeChild(eGui);
        this.closeButtonComp = this.destroyBean(this.closeButtonComp);
      }
    };
    AgPanel2.prototype.setBodyComponent = function(bodyComponent) {
      bodyComponent.setParentComponent(this);
      this.eContentWrapper.appendChild(bodyComponent.getGui());
    };
    AgPanel2.prototype.addTitleBarButton = function(button, position) {
      var eTitleBarButtons = this.eTitleBarButtons;
      var buttons = eTitleBarButtons.children;
      var len = buttons.length;
      if (position == null) {
        position = len;
      }
      position = Math.max(0, Math.min(position, len));
      button.addCssClass("ag-panel-title-bar-button");
      var eGui = button.getGui();
      if (position === 0) {
        eTitleBarButtons.insertAdjacentElement("afterbegin", eGui);
      } else if (position === len) {
        eTitleBarButtons.insertAdjacentElement("beforeend", eGui);
      } else {
        buttons[position - 1].insertAdjacentElement("afterend", eGui);
      }
      button.setParentComponent(this);
    };
    AgPanel2.prototype.getBodyHeight = function() {
      return getInnerHeight(this.eContentWrapper);
    };
    AgPanel2.prototype.getBodyWidth = function() {
      return getInnerWidth(this.eContentWrapper);
    };
    AgPanel2.prototype.setTitle = function(title) {
      this.eTitle.innerText = title;
    };
    AgPanel2.prototype.onBtClose = function() {
      this.close();
    };
    AgPanel2.prototype.destroy = function() {
      if (this.closeButtonComp) {
        this.closeButtonComp = this.destroyBean(this.closeButtonComp);
      }
      var eGui = this.getGui();
      if (eGui && eGui.offsetParent) {
        this.close();
      }
      _super.prototype.destroy.call(this);
    };
    AgPanel2.CLOSE_BTN_TEMPLATE = '<div class="ag-button"></div>';
    __decorate$U([
      RefSelector("eContentWrapper")
    ], AgPanel2.prototype, "eContentWrapper", void 0);
    __decorate$U([
      RefSelector("eTitleBar")
    ], AgPanel2.prototype, "eTitleBar", void 0);
    __decorate$U([
      RefSelector("eTitleBarButtons")
    ], AgPanel2.prototype, "eTitleBarButtons", void 0);
    __decorate$U([
      RefSelector("eTitle")
    ], AgPanel2.prototype, "eTitle", void 0);
    __decorate$U([
      PostConstruct
    ], AgPanel2.prototype, "postConstruct", null);
    return AgPanel2;
  }(Component)
);
var __extends$R = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$4$1 = function() {
  __assign$4$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$4$1.apply(this, arguments);
};
var __decorate$T = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgDialog = (
  /** @class */
  function(_super) {
    __extends$R(AgDialog2, _super);
    function AgDialog2(config) {
      var _this = _super.call(this, __assign$4$1(__assign$4$1({}, config), { popup: true })) || this;
      _this.isMaximizable = false;
      _this.isMaximized = false;
      _this.maximizeListeners = [];
      _this.resizeListenerDestroy = null;
      _this.lastPosition = {
        x: 0,
        y: 0,
        width: 0,
        height: 0
      };
      return _this;
    }
    AgDialog2.prototype.postConstruct = function() {
      var _this = this;
      var eGui = this.getGui();
      var _a2 = this.config, movable = _a2.movable, resizable = _a2.resizable, maximizable = _a2.maximizable;
      this.addCssClass("ag-dialog");
      _super.prototype.postConstruct.call(this);
      this.addManagedListener(eGui, "focusin", function(e) {
        if (eGui.contains(e.relatedTarget)) {
          return;
        }
        _this.popupService.bringPopupToFront(eGui);
      });
      if (movable) {
        this.setMovable(movable);
      }
      if (maximizable) {
        this.setMaximizable(maximizable);
      }
      if (resizable) {
        this.setResizable(resizable);
      }
    };
    AgDialog2.prototype.renderComponent = function() {
      var eGui = this.getGui();
      var _a2 = this.config, alwaysOnTop = _a2.alwaysOnTop, modal = _a2.modal, title = _a2.title;
      var translate = this.localeService.getLocaleTextFunc();
      var addPopupRes = this.popupService.addPopup({
        modal,
        eChild: eGui,
        closeOnEsc: true,
        closedCallback: this.destroy.bind(this),
        alwaysOnTop,
        ariaLabel: title || translate("ariaLabelDialog", "Dialog")
      });
      if (addPopupRes) {
        this.close = addPopupRes.hideFunc;
      }
    };
    AgDialog2.prototype.toggleMaximize = function() {
      var position = this.positionableFeature.getPosition();
      if (this.isMaximized) {
        var _a2 = this.lastPosition, x2 = _a2.x, y2 = _a2.y, width = _a2.width, height = _a2.height;
        this.setWidth(width);
        this.setHeight(height);
        this.positionableFeature.offsetElement(x2, y2);
      } else {
        this.lastPosition.width = this.getWidth();
        this.lastPosition.height = this.getHeight();
        this.lastPosition.x = position.x;
        this.lastPosition.y = position.y;
        this.positionableFeature.offsetElement(0, 0);
        this.setHeight("100%");
        this.setWidth("100%");
      }
      this.isMaximized = !this.isMaximized;
      this.refreshMaximizeIcon();
    };
    AgDialog2.prototype.refreshMaximizeIcon = function() {
      setDisplayed(this.maximizeIcon, !this.isMaximized);
      setDisplayed(this.minimizeIcon, this.isMaximized);
    };
    AgDialog2.prototype.clearMaximizebleListeners = function() {
      if (this.maximizeListeners.length) {
        this.maximizeListeners.forEach(function(destroyListener) {
          return destroyListener();
        });
        this.maximizeListeners.length = 0;
      }
      if (this.resizeListenerDestroy) {
        this.resizeListenerDestroy();
        this.resizeListenerDestroy = null;
      }
    };
    AgDialog2.prototype.destroy = function() {
      this.maximizeButtonComp = this.destroyBean(this.maximizeButtonComp);
      this.clearMaximizebleListeners();
      _super.prototype.destroy.call(this);
    };
    AgDialog2.prototype.setResizable = function(resizable) {
      this.positionableFeature.setResizable(resizable);
    };
    AgDialog2.prototype.setMovable = function(movable) {
      this.positionableFeature.setMovable(movable, this.eTitleBar);
    };
    AgDialog2.prototype.setMaximizable = function(maximizable) {
      var _this = this;
      if (!maximizable) {
        this.clearMaximizebleListeners();
        if (this.maximizeButtonComp) {
          this.destroyBean(this.maximizeButtonComp);
          this.maximizeButtonComp = this.maximizeIcon = this.minimizeIcon = void 0;
        }
        return;
      }
      var eTitleBar = this.eTitleBar;
      if (!eTitleBar || maximizable === this.isMaximizable) {
        return;
      }
      var maximizeButtonComp = this.buildMaximizeAndMinimizeElements();
      this.refreshMaximizeIcon();
      maximizeButtonComp.addManagedListener(maximizeButtonComp.getGui(), "click", this.toggleMaximize.bind(this));
      this.addTitleBarButton(maximizeButtonComp, 0);
      this.maximizeListeners.push(this.addManagedListener(eTitleBar, "dblclick", this.toggleMaximize.bind(this)));
      this.resizeListenerDestroy = this.addManagedListener(this, "resize", function() {
        _this.isMaximized = false;
        _this.refreshMaximizeIcon();
      });
    };
    AgDialog2.prototype.buildMaximizeAndMinimizeElements = function() {
      var maximizeButtonComp = this.maximizeButtonComp = this.createBean(new Component(
        /* html */
        '<div class="ag-dialog-button"></span>'
      ));
      var eGui = maximizeButtonComp.getGui();
      this.maximizeIcon = createIconNoSpan("maximize", this.gridOptionsService);
      eGui.appendChild(this.maximizeIcon);
      this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon");
      this.minimizeIcon = createIconNoSpan("minimize", this.gridOptionsService);
      eGui.appendChild(this.minimizeIcon);
      this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon");
      return maximizeButtonComp;
    };
    __decorate$T([
      Autowired("popupService")
    ], AgDialog2.prototype, "popupService", void 0);
    return AgDialog2;
  }(AgPanel)
);
var __extends$Q = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$3$1 = function() {
  __assign$3$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$3$1.apply(this, arguments);
};
var __decorate$S = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$b = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$9 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var DIRECTION;
(function(DIRECTION2) {
  DIRECTION2[DIRECTION2["vertical"] = 0] = "vertical";
  DIRECTION2[DIRECTION2["horizontal"] = 1] = "horizontal";
})(DIRECTION || (DIRECTION = {}));
var instanceIdSeq = 0;
var PopupService = (
  /** @class */
  function(_super) {
    __extends$Q(PopupService2, _super);
    function PopupService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.popupList = [];
      return _this;
    }
    PopupService_1 = PopupService2;
    PopupService2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function(p2) {
        _this.gridCtrl = p2.gridCtrl;
        _this.addManagedListener(_this.gridCtrl, Events.EVENT_KEYBOARD_FOCUS, function() {
          _this.popupList.forEach(function(popup) {
            return popup.element.classList.add(FocusService.AG_KEYBOARD_FOCUS);
          });
        });
        _this.addManagedListener(_this.gridCtrl, Events.EVENT_MOUSE_FOCUS, function() {
          _this.popupList.forEach(function(popup) {
            return popup.element.classList.remove(FocusService.AG_KEYBOARD_FOCUS);
          });
        });
      });
    };
    PopupService2.prototype.getPopupParent = function() {
      var ePopupParent = this.gridOptionsService.get("popupParent");
      if (ePopupParent) {
        return ePopupParent;
      }
      return this.gridCtrl.getGui();
    };
    PopupService2.prototype.positionPopupForMenu = function(params) {
      var sourceRect = params.eventSource.getBoundingClientRect();
      var parentRect = this.getParentRect();
      var y2 = this.keepXYWithinBounds(params.ePopup, sourceRect.top - parentRect.top, DIRECTION.vertical);
      var minWidth = params.ePopup.clientWidth > 0 ? params.ePopup.clientWidth : 200;
      params.ePopup.style.minWidth = minWidth + "px";
      var widthOfParent = parentRect.right - parentRect.left;
      var maxX = widthOfParent - minWidth;
      var x2;
      if (this.gridOptionsService.is("enableRtl")) {
        x2 = xLeftPosition();
        if (x2 < 0) {
          x2 = xRightPosition();
        }
        if (x2 > maxX) {
          x2 = 0;
        }
      } else {
        x2 = xRightPosition();
        if (x2 > maxX) {
          x2 = xLeftPosition();
        }
        if (x2 < 0) {
          x2 = 0;
        }
      }
      params.ePopup.style.left = x2 + "px";
      params.ePopup.style.top = y2 + "px";
      function xRightPosition() {
        return sourceRect.right - parentRect.left - 2;
      }
      function xLeftPosition() {
        return sourceRect.left - parentRect.left - minWidth;
      }
    };
    PopupService2.prototype.positionPopupUnderMouseEvent = function(params) {
      var _this = this;
      var ePopup = params.ePopup, nudgeX = params.nudgeX, nudgeY = params.nudgeY, skipObserver = params.skipObserver;
      this.positionPopup({
        ePopup,
        nudgeX,
        nudgeY,
        keepWithinBounds: true,
        skipObserver,
        updatePosition: function() {
          return _this.calculatePointerAlign(params.mouseEvent);
        },
        postProcessCallback: function() {
          return _this.callPostProcessPopup(params.type, params.ePopup, null, params.mouseEvent, params.column, params.rowNode);
        }
      });
    };
    PopupService2.prototype.calculatePointerAlign = function(e) {
      var parentRect = this.getParentRect();
      return {
        x: e.clientX - parentRect.left,
        y: e.clientY - parentRect.top
      };
    };
    PopupService2.prototype.positionPopupByComponent = function(params) {
      var _this = this;
      var sourceRect = params.eventSource.getBoundingClientRect();
      var alignSide = params.alignSide || "left";
      var position = params.position || "over";
      var parentRect = this.getParentRect();
      var updatePosition = function() {
        var x2 = sourceRect.left - parentRect.left;
        if (alignSide === "right") {
          x2 -= params.ePopup.offsetWidth - sourceRect.width;
        }
        var y2 = position === "over" ? sourceRect.top - parentRect.top : sourceRect.top - parentRect.top + sourceRect.height;
        return { x: x2, y: y2 };
      };
      this.positionPopup({
        ePopup: params.ePopup,
        nudgeX: params.nudgeX,
        nudgeY: params.nudgeY,
        keepWithinBounds: params.keepWithinBounds,
        updatePosition,
        postProcessCallback: function() {
          return _this.callPostProcessPopup(params.type, params.ePopup, params.eventSource, null, params.column, params.rowNode);
        }
      });
    };
    PopupService2.prototype.callPostProcessPopup = function(type, ePopup, eventSource, mouseEvent, column, rowNode) {
      var callback2 = this.gridOptionsService.getCallback("postProcessPopup");
      if (callback2) {
        var params = {
          column,
          rowNode,
          ePopup,
          type,
          eventSource,
          mouseEvent
        };
        callback2(params);
      }
    };
    PopupService2.prototype.positionPopup = function(params) {
      var _this = this;
      var ePopup = params.ePopup, keepWithinBounds = params.keepWithinBounds, nudgeX = params.nudgeX, nudgeY = params.nudgeY, skipObserver = params.skipObserver, updatePosition = params.updatePosition;
      var lastSize = { width: 0, height: 0 };
      var updatePopupPosition = function(fromResizeObserver) {
        if (fromResizeObserver === void 0) {
          fromResizeObserver = false;
        }
        var _a2 = updatePosition(), x2 = _a2.x, y2 = _a2.y;
        if (fromResizeObserver && ePopup.clientWidth === lastSize.width && ePopup.clientHeight === lastSize.height) {
          return;
        }
        lastSize.width = ePopup.clientWidth;
        lastSize.height = ePopup.clientHeight;
        if (nudgeX) {
          x2 += nudgeX;
        }
        if (nudgeY) {
          y2 += nudgeY;
        }
        if (keepWithinBounds) {
          x2 = _this.keepXYWithinBounds(ePopup, x2, DIRECTION.horizontal);
          y2 = _this.keepXYWithinBounds(ePopup, y2, DIRECTION.vertical);
        }
        ePopup.style.left = x2 + "px";
        ePopup.style.top = y2 + "px";
        if (params.postProcessCallback) {
          params.postProcessCallback();
        }
      };
      updatePopupPosition();
      if (!skipObserver) {
        var resizeObserverDestroyFunc_1 = this.resizeObserverService.observeResize(ePopup, function() {
          return updatePopupPosition(true);
        });
        setTimeout(function() {
          return resizeObserverDestroyFunc_1();
        }, PopupService_1.WAIT_FOR_POPUP_CONTENT_RESIZE);
      }
    };
    PopupService2.prototype.getActivePopups = function() {
      return this.popupList.map(function(popup) {
        return popup.element;
      });
    };
    PopupService2.prototype.getPopupList = function() {
      return this.popupList;
    };
    PopupService2.prototype.getParentRect = function() {
      var eDocument = this.gridOptionsService.getDocument();
      var popupParent = this.getPopupParent();
      if (popupParent === eDocument.body) {
        popupParent = eDocument.documentElement;
      } else if (getComputedStyle(popupParent).position === "static") {
        popupParent = popupParent.offsetParent;
      }
      return getElementRectWithOffset(popupParent);
    };
    PopupService2.prototype.keepXYWithinBounds = function(ePopup, position, direction) {
      var isVertical = direction === DIRECTION.vertical;
      var sizeProperty = isVertical ? "clientHeight" : "clientWidth";
      var anchorProperty = isVertical ? "top" : "left";
      var offsetProperty = isVertical ? "offsetHeight" : "offsetWidth";
      var scrollPositionProperty = isVertical ? "scrollTop" : "scrollLeft";
      var eDocument = this.gridOptionsService.getDocument();
      var docElement = eDocument.documentElement;
      var popupParent = this.getPopupParent();
      var parentRect = popupParent.getBoundingClientRect();
      var documentRect = eDocument.documentElement.getBoundingClientRect();
      var isBody = popupParent === eDocument.body;
      var offsetSize = ePopup[offsetProperty];
      var getSize = isVertical ? getAbsoluteHeight : getAbsoluteWidth;
      var sizeOfParent = isBody ? getSize(docElement) + docElement[scrollPositionProperty] : popupParent[sizeProperty];
      if (isBody) {
        sizeOfParent -= Math.abs(documentRect[anchorProperty] - parentRect[anchorProperty]);
      }
      var max2 = sizeOfParent - offsetSize;
      return Math.min(Math.max(position, 0), Math.abs(max2));
    };
    PopupService2.prototype.addPopup = function(params) {
      var eDocument = this.gridOptionsService.getDocument();
      var eChild = params.eChild, ariaLabel = params.ariaLabel, alwaysOnTop = params.alwaysOnTop, positionCallback = params.positionCallback, anchorToElement = params.anchorToElement;
      if (!eDocument) {
        console.warn("AG Grid: could not find the document, document is empty");
        return { hideFunc: function() {
        } };
      }
      var pos = this.popupList.findIndex(function(popup2) {
        return popup2.element === eChild;
      });
      if (pos !== -1) {
        var popup = this.popupList[pos];
        return { hideFunc: popup.hideFunc };
      }
      this.initialisePopupPosition(eChild);
      var wrapperEl = this.createPopupWrapper(eChild, ariaLabel, !!alwaysOnTop);
      var removeListeners = this.addEventListenersToPopup(__assign$3$1(__assign$3$1({}, params), { wrapperEl }));
      if (positionCallback) {
        positionCallback();
      }
      this.addPopupToPopupList(eChild, wrapperEl, removeListeners, anchorToElement);
      return {
        hideFunc: removeListeners
      };
    };
    PopupService2.prototype.initialisePopupPosition = function(element) {
      var ePopupParent = this.getPopupParent();
      var ePopupParentRect = ePopupParent.getBoundingClientRect();
      if (!exists(element.style.top)) {
        element.style.top = ePopupParentRect.top * -1 + "px";
      }
      if (!exists(element.style.left)) {
        element.style.left = ePopupParentRect.left * -1 + "px";
      }
    };
    PopupService2.prototype.createPopupWrapper = function(element, ariaLabel, alwaysOnTop) {
      var _a2;
      var ePopupParent = this.getPopupParent();
      var eWrapper = document.createElement("div");
      var allThemes = this.environment.getTheme().allThemes;
      if (allThemes.length) {
        (_a2 = eWrapper.classList).add.apply(_a2, __spreadArray$9([], __read$b(allThemes)));
      }
      eWrapper.classList.add("ag-popup");
      element.classList.add(this.gridOptionsService.is("enableRtl") ? "ag-rtl" : "ag-ltr", "ag-popup-child");
      if (!element.hasAttribute("role")) {
        setAriaRole(element, "dialog");
      }
      setAriaLabel(element, ariaLabel);
      if (this.focusService.isKeyboardMode()) {
        element.classList.add(FocusService.AG_KEYBOARD_FOCUS);
      }
      eWrapper.appendChild(element);
      ePopupParent.appendChild(eWrapper);
      if (alwaysOnTop) {
        this.setAlwaysOnTop(element, true);
      } else {
        this.bringPopupToFront(element);
      }
      return eWrapper;
    };
    PopupService2.prototype.addEventListenersToPopup = function(params) {
      var _this = this;
      var eDocument = this.gridOptionsService.getDocument();
      var ePopupParent = this.getPopupParent();
      var wrapperEl = params.wrapperEl, popupEl = params.eChild, pointerEvent = params.click, closedCallback = params.closedCallback, afterGuiAttached = params.afterGuiAttached, closeOnEsc = params.closeOnEsc, modal = params.modal;
      var popupHidden = false;
      var hidePopupOnKeyboardEvent = function(event) {
        if (!wrapperEl.contains(eDocument.activeElement)) {
          return;
        }
        var key = event.key;
        if (key === KeyCode.ESCAPE) {
          removeListeners({ keyboardEvent: event });
        }
      };
      var hidePopupOnMouseEvent = function(event) {
        return removeListeners({ mouseEvent: event });
      };
      var hidePopupOnTouchEvent = function(event) {
        return removeListeners({ touchEvent: event });
      };
      var removeListeners = function(popupParams) {
        if (popupParams === void 0) {
          popupParams = {};
        }
        var mouseEvent = popupParams.mouseEvent, touchEvent = popupParams.touchEvent, keyboardEvent = popupParams.keyboardEvent;
        if (
          // we don't hide popup if the event was on the child, or any
          // children of this child
          _this.isEventFromCurrentPopup({ mouseEvent, touchEvent }, popupEl) || // if the event to close is actually the open event, then ignore it
          _this.isEventSameChainAsOriginalEvent({ originalMouseEvent: pointerEvent, mouseEvent, touchEvent }) || // this method should only be called once. the client can have different
          // paths, each one wanting to close, so this method may be called multiple times.
          popupHidden
        ) {
          return;
        }
        popupHidden = true;
        ePopupParent.removeChild(wrapperEl);
        eDocument.removeEventListener("keydown", hidePopupOnKeyboardEvent);
        eDocument.removeEventListener("mousedown", hidePopupOnMouseEvent);
        eDocument.removeEventListener("touchstart", hidePopupOnTouchEvent);
        eDocument.removeEventListener("contextmenu", hidePopupOnMouseEvent);
        _this.eventService.removeEventListener(Events.EVENT_DRAG_STARTED, hidePopupOnMouseEvent);
        if (closedCallback) {
          closedCallback(mouseEvent || touchEvent || keyboardEvent);
        }
        _this.removePopupFromPopupList(popupEl);
      };
      if (afterGuiAttached) {
        afterGuiAttached({ hidePopup: removeListeners });
      }
      window.setTimeout(function() {
        if (closeOnEsc) {
          eDocument.addEventListener("keydown", hidePopupOnKeyboardEvent);
        }
        if (modal) {
          eDocument.addEventListener("mousedown", hidePopupOnMouseEvent);
          _this.eventService.addEventListener(Events.EVENT_DRAG_STARTED, hidePopupOnMouseEvent);
          eDocument.addEventListener("touchstart", hidePopupOnTouchEvent);
          eDocument.addEventListener("contextmenu", hidePopupOnMouseEvent);
        }
      }, 0);
      return removeListeners;
    };
    PopupService2.prototype.addPopupToPopupList = function(element, wrapperEl, removeListeners, anchorToElement) {
      this.popupList.push({
        element,
        wrapper: wrapperEl,
        hideFunc: removeListeners,
        instanceId: instanceIdSeq++,
        isAnchored: !!anchorToElement
      });
      if (anchorToElement) {
        this.setPopupPositionRelatedToElement(element, anchorToElement);
      }
    };
    PopupService2.prototype.setPopupPositionRelatedToElement = function(popupEl, relativeElement) {
      var popup = this.popupList.find(function(p2) {
        return p2.element === popupEl;
      });
      if (!popup) {
        return;
      }
      if (popup.stopAnchoringPromise) {
        popup.stopAnchoringPromise.then(function(destroyFunc) {
          return destroyFunc && destroyFunc();
        });
      }
      popup.stopAnchoringPromise = void 0;
      popup.isAnchored = false;
      if (!relativeElement) {
        return;
      }
      var destroyPositionTracker = this.keepPopupPositionedRelativeTo({
        element: relativeElement,
        ePopup: popupEl,
        hidePopup: popup.hideFunc
      });
      popup.stopAnchoringPromise = destroyPositionTracker;
      popup.isAnchored = true;
      return destroyPositionTracker;
    };
    PopupService2.prototype.removePopupFromPopupList = function(element) {
      this.setPopupPositionRelatedToElement(element, null);
      this.popupList = this.popupList.filter(function(p2) {
        return p2.element !== element;
      });
    };
    PopupService2.prototype.keepPopupPositionedRelativeTo = function(params) {
      var _this = this;
      var eParent = this.getPopupParent();
      var parentRect = eParent.getBoundingClientRect();
      var element = params.element, ePopup = params.ePopup;
      var sourceRect = element.getBoundingClientRect();
      var initialDiffTop = parentRect.top - sourceRect.top;
      var initialDiffLeft = parentRect.left - sourceRect.left;
      var lastDiffTop = initialDiffTop;
      var lastDiffLeft = initialDiffLeft;
      var topPx = ePopup.style.top;
      var top = parseInt(topPx.substring(0, topPx.length - 1), 10);
      var leftPx = ePopup.style.left;
      var left = parseInt(leftPx.substring(0, leftPx.length - 1), 10);
      return new AgPromise(function(resolve2) {
        _this.getFrameworkOverrides().setInterval(function() {
          var pRect = eParent.getBoundingClientRect();
          var sRect = element.getBoundingClientRect();
          var elementNotInDom = sRect.top == 0 && sRect.left == 0 && sRect.height == 0 && sRect.width == 0;
          if (elementNotInDom) {
            params.hidePopup();
            return;
          }
          var currentDiffTop = pRect.top - sRect.top;
          if (currentDiffTop != lastDiffTop) {
            var newTop = _this.keepXYWithinBounds(ePopup, top + initialDiffTop - currentDiffTop, DIRECTION.vertical);
            ePopup.style.top = newTop + "px";
          }
          lastDiffTop = currentDiffTop;
          var currentDiffLeft = pRect.left - sRect.left;
          if (currentDiffLeft != lastDiffLeft) {
            var newLeft = _this.keepXYWithinBounds(ePopup, left + initialDiffLeft - currentDiffLeft, DIRECTION.horizontal);
            ePopup.style.left = newLeft + "px";
          }
          lastDiffLeft = currentDiffLeft;
        }, 200).then(function(intervalId) {
          var result = function() {
            if (intervalId != null) {
              window.clearInterval(intervalId);
            }
          };
          resolve2(result);
        });
      });
    };
    PopupService2.prototype.hasAnchoredPopup = function() {
      return this.popupList.some(function(popup) {
        return popup.isAnchored;
      });
    };
    PopupService2.prototype.isEventFromCurrentPopup = function(params, target) {
      var mouseEvent = params.mouseEvent, touchEvent = params.touchEvent;
      var event = mouseEvent ? mouseEvent : touchEvent;
      if (!event) {
        return false;
      }
      var indexOfThisChild = this.popupList.findIndex(function(popup2) {
        return popup2.element === target;
      });
      if (indexOfThisChild === -1) {
        return false;
      }
      for (var i = indexOfThisChild; i < this.popupList.length; i++) {
        var popup = this.popupList[i];
        if (isElementInEventPath(popup.element, event)) {
          return true;
        }
      }
      return this.isElementWithinCustomPopup(event.target);
    };
    PopupService2.prototype.isElementWithinCustomPopup = function(el2) {
      var eDocument = this.gridOptionsService.getDocument();
      while (el2 && el2 !== eDocument.body) {
        if (el2.classList.contains("ag-custom-component-popup") || el2.parentElement === null) {
          return true;
        }
        el2 = el2.parentElement;
      }
      return false;
    };
    PopupService2.prototype.isEventSameChainAsOriginalEvent = function(params) {
      var originalMouseEvent = params.originalMouseEvent, mouseEvent = params.mouseEvent, touchEvent = params.touchEvent;
      var mouseEventOrTouch = null;
      if (mouseEvent) {
        mouseEventOrTouch = mouseEvent;
      } else if (touchEvent) {
        mouseEventOrTouch = touchEvent.touches[0];
      }
      if (mouseEventOrTouch && originalMouseEvent) {
        var screenX_1 = mouseEvent ? mouseEvent.screenX : 0;
        var screenY_1 = mouseEvent ? mouseEvent.screenY : 0;
        var xMatch = Math.abs(originalMouseEvent.screenX - screenX_1) < 5;
        var yMatch = Math.abs(originalMouseEvent.screenY - screenY_1) < 5;
        if (xMatch && yMatch) {
          return true;
        }
      }
      return false;
    };
    PopupService2.prototype.getWrapper = function(ePopup) {
      while (!ePopup.classList.contains("ag-popup") && ePopup.parentElement) {
        ePopup = ePopup.parentElement;
      }
      return ePopup.classList.contains("ag-popup") ? ePopup : null;
    };
    PopupService2.prototype.setAlwaysOnTop = function(ePopup, alwaysOnTop) {
      var eWrapper = this.getWrapper(ePopup);
      if (!eWrapper) {
        return;
      }
      eWrapper.classList.toggle("ag-always-on-top", !!alwaysOnTop);
      if (alwaysOnTop) {
        this.bringPopupToFront(eWrapper);
      }
    };
    PopupService2.prototype.bringPopupToFront = function(ePopup) {
      var parent = this.getPopupParent();
      var popupList = Array.prototype.slice.call(parent.querySelectorAll(".ag-popup"));
      var popupLen = popupList.length;
      var alwaysOnTopList = Array.prototype.slice.call(parent.querySelectorAll(".ag-popup.ag-always-on-top"));
      var onTopLength = alwaysOnTopList.length;
      var eWrapper = this.getWrapper(ePopup);
      if (!eWrapper || popupLen <= 1 || !parent.contains(ePopup)) {
        return;
      }
      var pos = popupList.indexOf(eWrapper);
      var innerEls = eWrapper.querySelectorAll("div");
      var innerElsScrollMap = [];
      innerEls.forEach(function(el2) {
        if (el2.scrollTop !== 0) {
          innerElsScrollMap.push([el2, el2.scrollTop]);
        }
      });
      if (onTopLength) {
        var isPopupAlwaysOnTop = eWrapper.classList.contains("ag-always-on-top");
        if (isPopupAlwaysOnTop) {
          if (pos !== popupLen - 1) {
            last(alwaysOnTopList).insertAdjacentElement("afterend", eWrapper);
          }
        } else if (pos !== popupLen - onTopLength - 1) {
          alwaysOnTopList[0].insertAdjacentElement("beforebegin", eWrapper);
        }
      } else if (pos !== popupLen - 1) {
        last(popupList).insertAdjacentElement("afterend", eWrapper);
      }
      while (innerElsScrollMap.length) {
        var currentEl = innerElsScrollMap.pop();
        currentEl[0].scrollTop = currentEl[1];
      }
      var params = {
        type: "popupToFront",
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        eWrapper
      };
      this.eventService.dispatchEvent(params);
    };
    var PopupService_1;
    PopupService2.WAIT_FOR_POPUP_CONTENT_RESIZE = 200;
    __decorate$S([
      Autowired("focusService")
    ], PopupService2.prototype, "focusService", void 0);
    __decorate$S([
      Autowired("ctrlsService")
    ], PopupService2.prototype, "ctrlsService", void 0);
    __decorate$S([
      Autowired("resizeObserverService")
    ], PopupService2.prototype, "resizeObserverService", void 0);
    __decorate$S([
      PostConstruct
    ], PopupService2.prototype, "postConstruct", null);
    PopupService2 = PopupService_1 = __decorate$S([
      Bean("popupService")
    ], PopupService2);
    return PopupService2;
  }(BeanStub)
);
var __extends$P = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$R = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var VirtualList = (
  /** @class */
  function(_super) {
    __extends$P(VirtualList2, _super);
    function VirtualList2(cssIdentifier, ariaRole, listName) {
      if (cssIdentifier === void 0) {
        cssIdentifier = "default";
      }
      if (ariaRole === void 0) {
        ariaRole = "listbox";
      }
      var _this = _super.call(this, VirtualList2.getTemplate(cssIdentifier)) || this;
      _this.cssIdentifier = cssIdentifier;
      _this.ariaRole = ariaRole;
      _this.listName = listName;
      _this.renderedRows = /* @__PURE__ */ new Map();
      _this.rowHeight = 20;
      return _this;
    }
    VirtualList2.prototype.postConstruct = function() {
      var _this = this;
      this.addScrollListener();
      this.rowHeight = this.getItemHeight();
      this.addResizeObserver();
      this.initialiseTabGuard({
        onFocusIn: function(e) {
          return _this.onFocusIn(e);
        },
        onFocusOut: function(e) {
          return _this.onFocusOut(e);
        },
        focusInnerElement: function(fromBottom) {
          return _this.focusInnerElement(fromBottom);
        },
        onTabKeyDown: function(e) {
          return _this.onTabKeyDown(e);
        },
        handleKeyDown: function(e) {
          return _this.handleKeyDown(e);
        }
      });
      this.setAriaProperties();
      this.addManagedListener(this.eventService, Events.EVENT_GRID_STYLES_CHANGED, this.onGridStylesChanged.bind(this));
    };
    VirtualList2.prototype.onGridStylesChanged = function() {
      this.rowHeight = this.getItemHeight();
      this.refresh();
    };
    VirtualList2.prototype.setAriaProperties = function() {
      var translate = this.localeService.getLocaleTextFunc();
      var listName = translate("ariaDefaultListName", this.listName || "List");
      var ariaEl = this.eContainer;
      setAriaRole(ariaEl, this.ariaRole);
      setAriaLabel(ariaEl, listName);
    };
    VirtualList2.prototype.addResizeObserver = function() {
      var _this = this;
      var listener = function() {
        return _this.drawVirtualRows();
      };
      var destroyObserver = this.resizeObserverService.observeResize(this.getGui(), listener);
      this.addDestroyFunc(destroyObserver);
    };
    VirtualList2.prototype.focusInnerElement = function(fromBottom) {
      this.focusRow(fromBottom ? this.model.getRowCount() - 1 : 0);
    };
    VirtualList2.prototype.onFocusIn = function(e) {
      var target = e.target;
      if (target.classList.contains("ag-virtual-list-item")) {
        this.lastFocusedRowIndex = getAriaPosInSet(target) - 1;
      }
      return false;
    };
    VirtualList2.prototype.onFocusOut = function(e) {
      if (!this.getFocusableElement().contains(e.relatedTarget)) {
        this.lastFocusedRowIndex = null;
      }
      return false;
    };
    VirtualList2.prototype.handleKeyDown = function(e) {
      switch (e.key) {
        case KeyCode.UP:
        case KeyCode.DOWN:
          if (this.navigate(e.key === KeyCode.UP)) {
            e.preventDefault();
          }
          break;
      }
    };
    VirtualList2.prototype.onTabKeyDown = function(e) {
      if (this.navigate(e.shiftKey)) {
        e.preventDefault();
      } else {
        stopPropagationForAgGrid(e);
        this.forceFocusOutOfContainer(e.shiftKey);
      }
    };
    VirtualList2.prototype.navigate = function(up) {
      if (this.lastFocusedRowIndex == null) {
        return false;
      }
      var nextRow = this.lastFocusedRowIndex + (up ? -1 : 1);
      if (nextRow < 0 || nextRow >= this.model.getRowCount()) {
        return false;
      }
      this.focusRow(nextRow);
      return true;
    };
    VirtualList2.prototype.getLastFocusedRow = function() {
      return this.lastFocusedRowIndex;
    };
    VirtualList2.prototype.focusRow = function(rowNumber) {
      var _this = this;
      this.ensureIndexVisible(rowNumber);
      window.setTimeout(function() {
        if (!_this.isAlive()) {
          return;
        }
        var renderedRow = _this.renderedRows.get(rowNumber);
        if (renderedRow) {
          renderedRow.eDiv.focus();
        }
      }, 10);
    };
    VirtualList2.prototype.getComponentAt = function(rowIndex) {
      var comp = this.renderedRows.get(rowIndex);
      return comp && comp.rowComponent;
    };
    VirtualList2.prototype.forEachRenderedRow = function(func) {
      this.renderedRows.forEach(function(value, key) {
        return func(value.rowComponent, key);
      });
    };
    VirtualList2.getTemplate = function(cssIdentifier) {
      return (
        /* html */
        '\n            <div class="ag-virtual-list-viewport ag-' + cssIdentifier + '-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-' + cssIdentifier + '-virtual-list-container" ref="eContainer"></div>\n            </div>'
      );
    };
    VirtualList2.prototype.getItemHeight = function() {
      return this.environment.getListItemHeight();
    };
    VirtualList2.prototype.ensureIndexVisible = function(index2) {
      var lastRow = this.model.getRowCount();
      if (typeof index2 !== "number" || index2 < 0 || index2 >= lastRow) {
        console.warn("AG Grid: invalid row index for ensureIndexVisible: " + index2);
        return;
      }
      var rowTopPixel = index2 * this.rowHeight;
      var rowBottomPixel = rowTopPixel + this.rowHeight;
      var eGui = this.getGui();
      var viewportTopPixel = eGui.scrollTop;
      var viewportHeight = eGui.offsetHeight;
      var viewportBottomPixel = viewportTopPixel + viewportHeight;
      var viewportScrolledPastRow = viewportTopPixel > rowTopPixel;
      var viewportScrolledBeforeRow = viewportBottomPixel < rowBottomPixel;
      if (viewportScrolledPastRow) {
        eGui.scrollTop = rowTopPixel;
      } else if (viewportScrolledBeforeRow) {
        var newScrollPosition = rowBottomPixel - viewportHeight;
        eGui.scrollTop = newScrollPosition;
      }
    };
    VirtualList2.prototype.setComponentCreator = function(componentCreator) {
      this.componentCreator = componentCreator;
    };
    VirtualList2.prototype.setComponentUpdater = function(componentUpdater) {
      this.componentUpdater = componentUpdater;
    };
    VirtualList2.prototype.getRowHeight = function() {
      return this.rowHeight;
    };
    VirtualList2.prototype.getScrollTop = function() {
      return this.getGui().scrollTop;
    };
    VirtualList2.prototype.setRowHeight = function(rowHeight) {
      this.rowHeight = rowHeight;
      this.refresh();
    };
    VirtualList2.prototype.refresh = function(softRefresh) {
      var _this = this;
      if (this.model == null || !this.isAlive()) {
        return;
      }
      var rowCount = this.model.getRowCount();
      this.eContainer.style.height = rowCount * this.rowHeight + "px";
      waitUntil(function() {
        return _this.eContainer.clientHeight >= rowCount * _this.rowHeight;
      }, function() {
        if (!_this.isAlive()) {
          return;
        }
        if (_this.canSoftRefresh(softRefresh)) {
          _this.drawVirtualRows(true);
        } else {
          _this.clearVirtualRows();
          _this.drawVirtualRows();
        }
      });
    };
    VirtualList2.prototype.canSoftRefresh = function(softRefresh) {
      return !!(softRefresh && this.renderedRows.size && typeof this.model.areRowsEqual === "function" && this.componentUpdater);
    };
    VirtualList2.prototype.clearVirtualRows = function() {
      var _this = this;
      this.renderedRows.forEach(function(_2, rowIndex) {
        return _this.removeRow(rowIndex);
      });
    };
    VirtualList2.prototype.drawVirtualRows = function(softRefresh) {
      if (!this.isAlive()) {
        return;
      }
      var gui = this.getGui();
      var topPixel = gui.scrollTop;
      var bottomPixel = topPixel + gui.offsetHeight;
      var firstRow = Math.floor(topPixel / this.rowHeight);
      var lastRow = Math.floor(bottomPixel / this.rowHeight);
      this.ensureRowsRendered(firstRow, lastRow, softRefresh);
    };
    VirtualList2.prototype.ensureRowsRendered = function(start, finish, softRefresh) {
      var _this = this;
      this.renderedRows.forEach(function(_2, rowIndex2) {
        if ((rowIndex2 < start || rowIndex2 > finish) && rowIndex2 !== _this.lastFocusedRowIndex) {
          _this.removeRow(rowIndex2);
        }
      });
      if (softRefresh) {
        this.refreshRows();
      }
      for (var rowIndex = start; rowIndex <= finish; rowIndex++) {
        if (this.renderedRows.has(rowIndex)) {
          continue;
        }
        if (rowIndex < this.model.getRowCount()) {
          this.insertRow(rowIndex);
        }
      }
    };
    VirtualList2.prototype.insertRow = function(rowIndex) {
      var _this = this;
      var value = this.model.getRow(rowIndex);
      var eDiv = document.createElement("div");
      eDiv.classList.add("ag-virtual-list-item", "ag-" + this.cssIdentifier + "-virtual-list-item");
      setAriaRole(eDiv, this.ariaRole === "tree" ? "treeitem" : "option");
      setAriaSetSize(eDiv, this.model.getRowCount());
      setAriaPosInSet(eDiv, rowIndex + 1);
      eDiv.setAttribute("tabindex", "-1");
      if (typeof this.model.isRowSelected === "function") {
        var isSelected = this.model.isRowSelected(rowIndex);
        setAriaSelected(eDiv, !!isSelected);
        setAriaChecked(eDiv, isSelected);
      }
      eDiv.style.height = this.rowHeight + "px";
      eDiv.style.top = this.rowHeight * rowIndex + "px";
      var rowComponent = this.componentCreator(value, eDiv);
      rowComponent.addGuiEventListener("focusin", function() {
        return _this.lastFocusedRowIndex = rowIndex;
      });
      eDiv.appendChild(rowComponent.getGui());
      if (this.renderedRows.has(rowIndex - 1)) {
        this.renderedRows.get(rowIndex - 1).eDiv.insertAdjacentElement("afterend", eDiv);
      } else if (this.renderedRows.has(rowIndex + 1)) {
        this.renderedRows.get(rowIndex + 1).eDiv.insertAdjacentElement("beforebegin", eDiv);
      } else {
        this.eContainer.appendChild(eDiv);
      }
      this.renderedRows.set(rowIndex, { rowComponent, eDiv, value });
    };
    VirtualList2.prototype.removeRow = function(rowIndex) {
      var component = this.renderedRows.get(rowIndex);
      this.eContainer.removeChild(component.eDiv);
      this.destroyBean(component.rowComponent);
      this.renderedRows.delete(rowIndex);
    };
    VirtualList2.prototype.refreshRows = function() {
      var _this = this;
      var rowCount = this.model.getRowCount();
      this.renderedRows.forEach(function(row, rowIndex) {
        var _a2, _b2;
        if (rowIndex >= rowCount) {
          _this.removeRow(rowIndex);
        } else {
          var newValue = _this.model.getRow(rowIndex);
          if ((_b2 = (_a2 = _this.model).areRowsEqual) === null || _b2 === void 0 ? void 0 : _b2.call(_a2, row.value, newValue)) {
            _this.componentUpdater(newValue, row.rowComponent);
          } else {
            _this.removeRow(rowIndex);
          }
        }
      });
    };
    VirtualList2.prototype.addScrollListener = function() {
      var _this = this;
      this.addGuiEventListener("scroll", function() {
        return _this.drawVirtualRows();
      }, { passive: true });
    };
    VirtualList2.prototype.setModel = function(model) {
      this.model = model;
    };
    VirtualList2.prototype.destroy = function() {
      if (!this.isAlive()) {
        return;
      }
      this.clearVirtualRows();
      _super.prototype.destroy.call(this);
    };
    __decorate$R([
      Autowired("resizeObserverService")
    ], VirtualList2.prototype, "resizeObserverService", void 0);
    __decorate$R([
      RefSelector("eContainer")
    ], VirtualList2.prototype, "eContainer", void 0);
    __decorate$R([
      PostConstruct
    ], VirtualList2.prototype, "postConstruct", null);
    return VirtualList2;
  }(TabGuardComp$1)
);
var OUTSIDE_ANGULAR_EVENTS = ["mouseover", "mouseout", "mouseenter", "mouseleave", "mousemove"];
var PASSIVE_EVENTS = ["touchstart", "touchend", "touchmove", "touchcancel"];
var VanillaFrameworkOverrides = (
  /** @class */
  function() {
    function VanillaFrameworkOverrides2() {
      this.renderingEngine = "vanilla";
      this.isOutsideAngular = function(eventType) {
        return includes(OUTSIDE_ANGULAR_EVENTS, eventType);
      };
    }
    VanillaFrameworkOverrides2.prototype.setTimeout = function(action, timeout) {
      window.setTimeout(action, timeout);
    };
    VanillaFrameworkOverrides2.prototype.setInterval = function(action, timeout) {
      return new AgPromise(function(resolve2) {
        resolve2(window.setInterval(action, timeout));
      });
    };
    VanillaFrameworkOverrides2.prototype.addEventListener = function(element, type, listener, useCapture) {
      var isPassive = includes(PASSIVE_EVENTS, type);
      element.addEventListener(type, listener, { capture: !!useCapture, passive: isPassive });
    };
    VanillaFrameworkOverrides2.prototype.dispatchEvent = function(eventType, listener, global2) {
      listener();
    };
    VanillaFrameworkOverrides2.prototype.frameworkComponent = function(name) {
      return null;
    };
    VanillaFrameworkOverrides2.prototype.isFrameworkComponent = function(comp) {
      return false;
    };
    return VanillaFrameworkOverrides2;
  }()
);
var __extends$O = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$Q = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$a = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$8 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var CellNavigationService = (
  /** @class */
  function(_super) {
    __extends$O(CellNavigationService2, _super);
    function CellNavigationService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CellNavigationService2.prototype.getNextCellToFocus = function(key, focusedCell, ctrlPressed) {
      if (ctrlPressed === void 0) {
        ctrlPressed = false;
      }
      if (ctrlPressed) {
        return this.getNextCellToFocusWithCtrlPressed(key, focusedCell);
      }
      return this.getNextCellToFocusWithoutCtrlPressed(key, focusedCell);
    };
    CellNavigationService2.prototype.getNextCellToFocusWithCtrlPressed = function(key, focusedCell) {
      var upKey = key === KeyCode.UP;
      var downKey = key === KeyCode.DOWN;
      var leftKey = key === KeyCode.LEFT;
      var column;
      var rowIndex;
      if (upKey || downKey) {
        rowIndex = upKey ? this.paginationProxy.getPageFirstRow() : this.paginationProxy.getPageLastRow();
        column = focusedCell.column;
      } else {
        var allColumns = this.columnModel.getAllDisplayedColumns();
        var isRtl = this.gridOptionsService.is("enableRtl");
        rowIndex = focusedCell.rowIndex;
        column = leftKey !== isRtl ? allColumns[0] : last(allColumns);
      }
      return {
        rowIndex,
        rowPinned: null,
        column
      };
    };
    CellNavigationService2.prototype.getNextCellToFocusWithoutCtrlPressed = function(key, focusedCell) {
      var pointer = focusedCell;
      var finished = false;
      while (!finished) {
        switch (key) {
          case KeyCode.UP:
            pointer = this.getCellAbove(pointer);
            break;
          case KeyCode.DOWN:
            pointer = this.getCellBelow(pointer);
            break;
          case KeyCode.RIGHT:
            if (this.gridOptionsService.is("enableRtl")) {
              pointer = this.getCellToLeft(pointer);
            } else {
              pointer = this.getCellToRight(pointer);
            }
            break;
          case KeyCode.LEFT:
            if (this.gridOptionsService.is("enableRtl")) {
              pointer = this.getCellToRight(pointer);
            } else {
              pointer = this.getCellToLeft(pointer);
            }
            break;
          default:
            pointer = null;
            console.warn("AG Grid: unknown key for navigation " + key);
            break;
        }
        if (pointer) {
          finished = this.isCellGoodToFocusOn(pointer);
        } else {
          finished = true;
        }
      }
      return pointer;
    };
    CellNavigationService2.prototype.isCellGoodToFocusOn = function(gridCell) {
      var column = gridCell.column;
      var rowNode;
      switch (gridCell.rowPinned) {
        case "top":
          rowNode = this.pinnedRowModel.getPinnedTopRow(gridCell.rowIndex);
          break;
        case "bottom":
          rowNode = this.pinnedRowModel.getPinnedBottomRow(gridCell.rowIndex);
          break;
        default:
          rowNode = this.rowModel.getRow(gridCell.rowIndex);
          break;
      }
      if (!rowNode) {
        return false;
      }
      var suppressNavigable = column.isSuppressNavigable(rowNode);
      return !suppressNavigable;
    };
    CellNavigationService2.prototype.getCellToLeft = function(lastCell) {
      if (!lastCell) {
        return null;
      }
      var colToLeft = this.columnModel.getDisplayedColBefore(lastCell.column);
      if (!colToLeft) {
        return null;
      }
      return {
        rowIndex: lastCell.rowIndex,
        column: colToLeft,
        rowPinned: lastCell.rowPinned
      };
    };
    CellNavigationService2.prototype.getCellToRight = function(lastCell) {
      if (!lastCell) {
        return null;
      }
      var colToRight = this.columnModel.getDisplayedColAfter(lastCell.column);
      if (!colToRight) {
        return null;
      }
      return {
        rowIndex: lastCell.rowIndex,
        column: colToRight,
        rowPinned: lastCell.rowPinned
      };
    };
    CellNavigationService2.prototype.getRowBelow = function(rowPosition) {
      var index2 = rowPosition.rowIndex;
      var pinned = rowPosition.rowPinned;
      if (this.isLastRowInContainer(rowPosition)) {
        switch (pinned) {
          case "bottom":
            return null;
          case "top":
            if (this.rowModel.isRowsToRender()) {
              return { rowIndex: this.paginationProxy.getPageFirstRow(), rowPinned: null };
            }
            if (this.pinnedRowModel.isRowsToRender("bottom")) {
              return { rowIndex: 0, rowPinned: "bottom" };
            }
            return null;
          default:
            if (this.pinnedRowModel.isRowsToRender("bottom")) {
              return { rowIndex: 0, rowPinned: "bottom" };
            }
            return null;
        }
      }
      var rowNode = this.rowModel.getRow(rowPosition.rowIndex);
      var nextStickyPosition = this.getNextStickyPosition(rowNode);
      if (nextStickyPosition) {
        return nextStickyPosition;
      }
      return { rowIndex: index2 + 1, rowPinned: pinned };
    };
    CellNavigationService2.prototype.getNextStickyPosition = function(rowNode, up) {
      if (!this.gridOptionsService.isGroupRowsSticky() || !rowNode || !rowNode.sticky) {
        return;
      }
      var stickyRowCtrls = __spreadArray$8([], __read$a(this.rowRenderer.getStickyTopRowCtrls())).sort(function(a, b) {
        return a.getRowNode().rowIndex - b.getRowNode().rowIndex;
      });
      var diff2 = up ? -1 : 1;
      var idx = stickyRowCtrls.findIndex(function(ctrl) {
        return ctrl.getRowNode().rowIndex === rowNode.rowIndex;
      });
      var nextCtrl = stickyRowCtrls[idx + diff2];
      if (nextCtrl) {
        return { rowIndex: nextCtrl.getRowNode().rowIndex, rowPinned: null };
      }
    };
    CellNavigationService2.prototype.getCellBelow = function(lastCell) {
      if (!lastCell) {
        return null;
      }
      var rowBelow = this.getRowBelow(lastCell);
      if (rowBelow) {
        return {
          rowIndex: rowBelow.rowIndex,
          column: lastCell.column,
          rowPinned: rowBelow.rowPinned
        };
      }
      return null;
    };
    CellNavigationService2.prototype.isLastRowInContainer = function(rowPosition) {
      var pinned = rowPosition.rowPinned;
      var index2 = rowPosition.rowIndex;
      if (pinned === "top") {
        var lastTopIndex = this.pinnedRowModel.getPinnedTopRowData().length - 1;
        return lastTopIndex <= index2;
      }
      if (pinned === "bottom") {
        var lastBottomIndex = this.pinnedRowModel.getPinnedBottomRowData().length - 1;
        return lastBottomIndex <= index2;
      }
      var lastBodyIndex = this.paginationProxy.getPageLastRow();
      return lastBodyIndex <= index2;
    };
    CellNavigationService2.prototype.getRowAbove = function(rowPosition) {
      var index2 = rowPosition.rowIndex;
      var pinned = rowPosition.rowPinned;
      var isFirstRow = pinned ? index2 === 0 : index2 === this.paginationProxy.getPageFirstRow();
      if (isFirstRow) {
        if (pinned === "top") {
          return null;
        }
        if (!pinned) {
          if (this.pinnedRowModel.isRowsToRender("top")) {
            return this.getLastFloatingTopRow();
          }
          return null;
        }
        if (this.rowModel.isRowsToRender()) {
          return this.getLastBodyCell();
        }
        if (this.pinnedRowModel.isRowsToRender("top")) {
          return this.getLastFloatingTopRow();
        }
        return null;
      }
      var rowNode = this.rowModel.getRow(rowPosition.rowIndex);
      var nextStickyPosition = this.getNextStickyPosition(rowNode, true);
      if (nextStickyPosition) {
        return nextStickyPosition;
      }
      return { rowIndex: index2 - 1, rowPinned: pinned };
    };
    CellNavigationService2.prototype.getCellAbove = function(lastCell) {
      if (!lastCell) {
        return null;
      }
      var rowAbove = this.getRowAbove({ rowIndex: lastCell.rowIndex, rowPinned: lastCell.rowPinned });
      if (rowAbove) {
        return {
          rowIndex: rowAbove.rowIndex,
          column: lastCell.column,
          rowPinned: rowAbove.rowPinned
        };
      }
      return null;
    };
    CellNavigationService2.prototype.getLastBodyCell = function() {
      var lastBodyRow = this.paginationProxy.getPageLastRow();
      return { rowIndex: lastBodyRow, rowPinned: null };
    };
    CellNavigationService2.prototype.getLastFloatingTopRow = function() {
      var lastFloatingRow = this.pinnedRowModel.getPinnedTopRowData().length - 1;
      return { rowIndex: lastFloatingRow, rowPinned: "top" };
    };
    CellNavigationService2.prototype.getNextTabbedCell = function(gridCell, backwards) {
      if (backwards) {
        return this.getNextTabbedCellBackwards(gridCell);
      }
      return this.getNextTabbedCellForwards(gridCell);
    };
    CellNavigationService2.prototype.getNextTabbedCellForwards = function(gridCell) {
      var displayedColumns = this.columnModel.getAllDisplayedColumns();
      var newRowIndex = gridCell.rowIndex;
      var newFloating = gridCell.rowPinned;
      var newColumn = this.columnModel.getDisplayedColAfter(gridCell.column);
      if (!newColumn) {
        newColumn = displayedColumns[0];
        var rowBelow = this.getRowBelow(gridCell);
        if (missing(rowBelow)) {
          return null;
        }
        if (!rowBelow.rowPinned && !this.paginationProxy.isRowInPage(rowBelow)) {
          return null;
        }
        newRowIndex = rowBelow ? rowBelow.rowIndex : null;
        newFloating = rowBelow ? rowBelow.rowPinned : null;
      }
      return { rowIndex: newRowIndex, column: newColumn, rowPinned: newFloating };
    };
    CellNavigationService2.prototype.getNextTabbedCellBackwards = function(gridCell) {
      var displayedColumns = this.columnModel.getAllDisplayedColumns();
      var newRowIndex = gridCell.rowIndex;
      var newFloating = gridCell.rowPinned;
      var newColumn = this.columnModel.getDisplayedColBefore(gridCell.column);
      if (!newColumn) {
        newColumn = last(displayedColumns);
        var rowAbove = this.getRowAbove({ rowIndex: gridCell.rowIndex, rowPinned: gridCell.rowPinned });
        if (missing(rowAbove)) {
          return null;
        }
        if (!rowAbove.rowPinned && !this.paginationProxy.isRowInPage(rowAbove)) {
          return null;
        }
        newRowIndex = rowAbove ? rowAbove.rowIndex : null;
        newFloating = rowAbove ? rowAbove.rowPinned : null;
      }
      return { rowIndex: newRowIndex, column: newColumn, rowPinned: newFloating };
    };
    __decorate$Q([
      Autowired("columnModel")
    ], CellNavigationService2.prototype, "columnModel", void 0);
    __decorate$Q([
      Autowired("rowModel")
    ], CellNavigationService2.prototype, "rowModel", void 0);
    __decorate$Q([
      Autowired("rowRenderer")
    ], CellNavigationService2.prototype, "rowRenderer", void 0);
    __decorate$Q([
      Autowired("pinnedRowModel")
    ], CellNavigationService2.prototype, "pinnedRowModel", void 0);
    __decorate$Q([
      Autowired("paginationProxy")
    ], CellNavigationService2.prototype, "paginationProxy", void 0);
    CellNavigationService2 = __decorate$Q([
      Bean("cellNavigationService")
    ], CellNavigationService2);
    return CellNavigationService2;
  }(BeanStub)
);
var __extends$N = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$P = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$6 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var AlignedGridsService = (
  /** @class */
  function(_super) {
    __extends$N(AlignedGridsService2, _super);
    function AlignedGridsService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.consuming = false;
      return _this;
    }
    AlignedGridsService2.prototype.setBeans = function(loggerFactory) {
      this.logger = loggerFactory.create("AlignedGridsService");
    };
    AlignedGridsService2.prototype.init = function() {
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_MOVED, this.fireColumnEvent.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VISIBLE, this.fireColumnEvent.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PINNED, this.fireColumnEvent.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_GROUP_OPENED, this.fireColumnEvent.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_RESIZED, this.fireColumnEvent.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_BODY_SCROLL, this.fireScrollEvent.bind(this));
    };
    AlignedGridsService2.prototype.fireEvent = function(callback2) {
      if (this.consuming) {
        return;
      }
      var otherGrids = this.gridOptionsService.get("alignedGrids");
      if (otherGrids) {
        otherGrids.forEach(function(otherGridOptions) {
          if (otherGridOptions.api) {
            var alignedGridService = otherGridOptions.api.__getAlignedGridService();
            callback2(alignedGridService);
          }
        });
      }
    };
    AlignedGridsService2.prototype.onEvent = function(callback2) {
      this.consuming = true;
      callback2();
      this.consuming = false;
    };
    AlignedGridsService2.prototype.fireColumnEvent = function(event) {
      this.fireEvent(function(alignedGridsService) {
        alignedGridsService.onColumnEvent(event);
      });
    };
    AlignedGridsService2.prototype.fireScrollEvent = function(event) {
      if (event.direction !== "horizontal") {
        return;
      }
      this.fireEvent(function(alignedGridsService) {
        alignedGridsService.onScrollEvent(event);
      });
    };
    AlignedGridsService2.prototype.onScrollEvent = function(event) {
      var _this = this;
      this.onEvent(function() {
        var gridBodyCon = _this.ctrlsService.getGridBodyCtrl();
        gridBodyCon.getScrollFeature().setHorizontalScrollPosition(event.left, true);
      });
    };
    AlignedGridsService2.prototype.getMasterColumns = function(event) {
      var result = [];
      if (event.columns) {
        event.columns.forEach(function(column) {
          result.push(column);
        });
      } else if (event.column) {
        result.push(event.column);
      }
      return result;
    };
    AlignedGridsService2.prototype.getColumnIds = function(event) {
      var result = [];
      if (event.columns) {
        event.columns.forEach(function(column) {
          result.push(column.getColId());
        });
      } else if (event.column) {
        result.push(event.column.getColId());
      }
      return result;
    };
    AlignedGridsService2.prototype.onColumnEvent = function(event) {
      var _this = this;
      this.onEvent(function() {
        switch (event.type) {
          case Events.EVENT_COLUMN_MOVED:
          case Events.EVENT_COLUMN_VISIBLE:
          case Events.EVENT_COLUMN_PINNED:
          case Events.EVENT_COLUMN_RESIZED:
            var colEvent = event;
            _this.processColumnEvent(colEvent);
            break;
          case Events.EVENT_COLUMN_GROUP_OPENED:
            var groupOpenedEvent = event;
            _this.processGroupOpenedEvent(groupOpenedEvent);
            break;
          case Events.EVENT_COLUMN_PIVOT_CHANGED:
            console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.");
            break;
        }
      });
    };
    AlignedGridsService2.prototype.processGroupOpenedEvent = function(groupOpenedEvent) {
      var masterColumnGroup = groupOpenedEvent.columnGroup;
      var otherColumnGroup = null;
      if (masterColumnGroup) {
        var groupId = masterColumnGroup.getGroupId();
        otherColumnGroup = this.columnModel.getProvidedColumnGroup(groupId);
      }
      if (masterColumnGroup && !otherColumnGroup) {
        return;
      }
      this.logger.log("onColumnEvent-> processing " + groupOpenedEvent + " expanded = " + masterColumnGroup.isExpanded());
      this.columnModel.setColumnGroupOpened(otherColumnGroup, masterColumnGroup.isExpanded(), "alignedGridChanged");
    };
    AlignedGridsService2.prototype.processColumnEvent = function(colEvent) {
      var _this = this;
      var _a2;
      var masterColumn = colEvent.column;
      var otherColumn = null;
      if (masterColumn) {
        otherColumn = this.columnModel.getPrimaryColumn(masterColumn.getColId());
      }
      if (masterColumn && !otherColumn) {
        return;
      }
      var masterColumns = this.getMasterColumns(colEvent);
      switch (colEvent.type) {
        case Events.EVENT_COLUMN_MOVED:
          {
            var movedEvent = colEvent;
            var srcColState = colEvent.columnApi.getColumnState();
            var destColState = srcColState.map(function(s2) {
              return { colId: s2.colId };
            });
            this.columnModel.applyColumnState({ state: destColState, applyOrder: true }, "alignedGridChanged");
            this.logger.log("onColumnEvent-> processing " + colEvent.type + " toIndex = " + movedEvent.toIndex);
          }
          break;
        case Events.EVENT_COLUMN_VISIBLE:
          {
            var visibleEvent = colEvent;
            var srcColState = colEvent.columnApi.getColumnState();
            var destColState = srcColState.map(function(s2) {
              return { colId: s2.colId, hide: s2.hide };
            });
            this.columnModel.applyColumnState({ state: destColState }, "alignedGridChanged");
            this.logger.log("onColumnEvent-> processing " + colEvent.type + " visible = " + visibleEvent.visible);
          }
          break;
        case Events.EVENT_COLUMN_PINNED:
          {
            var pinnedEvent = colEvent;
            var srcColState = colEvent.columnApi.getColumnState();
            var destColState = srcColState.map(function(s2) {
              return { colId: s2.colId, pinned: s2.pinned };
            });
            this.columnModel.applyColumnState({ state: destColState }, "alignedGridChanged");
            this.logger.log("onColumnEvent-> processing " + colEvent.type + " pinned = " + pinnedEvent.pinned);
          }
          break;
        case Events.EVENT_COLUMN_RESIZED:
          var resizedEvent = colEvent;
          var columnWidths_1 = {};
          masterColumns.forEach(function(column) {
            _this.logger.log("onColumnEvent-> processing " + colEvent.type + " actualWidth = " + column.getActualWidth());
            columnWidths_1[column.getId()] = { key: column.getColId(), newWidth: column.getActualWidth() };
          });
          (_a2 = resizedEvent.flexColumns) === null || _a2 === void 0 ? void 0 : _a2.forEach(function(col) {
            if (columnWidths_1[col.getId()]) {
              delete columnWidths_1[col.getId()];
            }
          });
          this.columnModel.setColumnWidths(Object.values(columnWidths_1), false, resizedEvent.finished, "alignedGridChanged");
          break;
      }
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      var isVerticalScrollShowing2 = gridBodyCon.isVerticalScrollShowing();
      var alignedGrids = this.gridOptionsService.get("alignedGrids");
      if (alignedGrids) {
        alignedGrids.forEach(function(grid) {
          if (grid.api) {
            grid.api.setAlwaysShowVerticalScroll(isVerticalScrollShowing2);
          }
        });
      }
    };
    __decorate$P([
      Autowired("columnModel")
    ], AlignedGridsService2.prototype, "columnModel", void 0);
    __decorate$P([
      Autowired("ctrlsService")
    ], AlignedGridsService2.prototype, "ctrlsService", void 0);
    __decorate$P([
      __param$6(0, Qualifier("loggerFactory"))
    ], AlignedGridsService2.prototype, "setBeans", null);
    __decorate$P([
      PostConstruct
    ], AlignedGridsService2.prototype, "init", null);
    AlignedGridsService2 = __decorate$P([
      Bean("alignedGridsService")
    ], AlignedGridsService2);
    return AlignedGridsService2;
  }(BeanStub)
);
var __extends$M = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$O = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$5 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var __read$9 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var SelectionService = (
  /** @class */
  function(_super) {
    __extends$M(SelectionService2, _super);
    function SelectionService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    SelectionService2.prototype.setBeans = function(loggerFactory) {
      this.logger = loggerFactory.create("selectionService");
      this.reset();
    };
    SelectionService2.prototype.init = function() {
      var _this = this;
      this.groupSelectsChildren = this.gridOptionsService.is("groupSelectsChildren");
      this.addManagedPropertyListener("groupSelectsChildren", function(propChange) {
        return _this.groupSelectsChildren = propChange.currentValue;
      });
      this.rowSelection = this.gridOptionsService.get("rowSelection");
      this.addManagedPropertyListener("rowSelection", function(propChange) {
        return _this.rowSelection = propChange.currentValue;
      });
      this.addManagedListener(this.eventService, Events.EVENT_ROW_SELECTED, this.onRowSelected.bind(this));
    };
    SelectionService2.prototype.isMultiselect = function() {
      return this.rowSelection === "multiple";
    };
    SelectionService2.prototype.setNodesSelected = function(params) {
      var _a2;
      if (params.nodes.length === 0)
        return 0;
      var newValue = params.newValue, clearSelection = params.clearSelection, suppressFinishActions = params.suppressFinishActions, rangeSelect = params.rangeSelect;
      params.event;
      var _b2 = params.source, source = _b2 === void 0 ? "api" : _b2;
      if (params.nodes.length > 1 && !this.isMultiselect()) {
        console.warn("AG Grid: cannot multi select while rowSelection='single'");
        return 0;
      }
      var groupSelectsFiltered = this.groupSelectsChildren && params.groupSelectsFiltered === true;
      var nodes = params.nodes.map(function(node2) {
        return node2.footer ? node2.sibling : node2;
      });
      if (rangeSelect) {
        if (params.nodes.length > 1) {
          console.warn("AG Grid: cannot range select while selecting multiple rows");
          return 0;
        }
        var lastSelectedNode = this.getLastSelectedNode();
        if (lastSelectedNode) {
          var node = nodes[0];
          var newRowClicked = lastSelectedNode !== node;
          if (newRowClicked && this.isMultiselect()) {
            var nodesChanged = this.selectRange(node, lastSelectedNode, params.newValue, source);
            this.setLastSelectedNode(node);
            return nodesChanged;
          }
        }
      }
      var updatedCount = 0;
      for (var i = 0; i < nodes.length; i++) {
        var node = nodes[i];
        var skipThisNode = groupSelectsFiltered && node.group;
        if (!skipThisNode) {
          var thisNodeWasSelected = node.selectThisNode(newValue, params.event, source);
          if (thisNodeWasSelected) {
            updatedCount++;
          }
        }
        if (this.groupSelectsChildren && ((_a2 = node.childrenAfterGroup) === null || _a2 === void 0 ? void 0 : _a2.length)) {
          updatedCount += this.selectChildren(node, newValue, groupSelectsFiltered, source);
        }
      }
      if (!suppressFinishActions) {
        var clearOtherNodes = newValue && (clearSelection || !this.isMultiselect());
        if (clearOtherNodes) {
          updatedCount += this.clearOtherNodes(nodes[0], source);
        }
        if (updatedCount > 0) {
          this.updateGroupsFromChildrenSelections(source);
          var event_1 = {
            type: Events.EVENT_SELECTION_CHANGED,
            source
          };
          this.eventService.dispatchEvent(event_1);
        }
        if (newValue) {
          this.setLastSelectedNode(nodes[nodes.length - 1]);
        }
      }
      return updatedCount;
    };
    SelectionService2.prototype.selectRange = function(fromNode, toNode, value, source) {
      var _this = this;
      if (value === void 0) {
        value = true;
      }
      var nodesToSelect = this.rowModel.getNodesInRangeForSelection(fromNode, toNode);
      var updatedCount = 0;
      nodesToSelect.forEach(function(rowNode) {
        if (rowNode.group && _this.groupSelectsChildren || value === false && fromNode === rowNode) {
          return;
        }
        var nodeWasSelected = rowNode.selectThisNode(value, void 0, source);
        if (nodeWasSelected) {
          updatedCount++;
        }
      });
      this.updateGroupsFromChildrenSelections(source);
      var event = {
        type: Events.EVENT_SELECTION_CHANGED,
        source
      };
      this.eventService.dispatchEvent(event);
      return updatedCount;
    };
    SelectionService2.prototype.selectChildren = function(node, newValue, groupSelectsFiltered, source) {
      var children = groupSelectsFiltered ? node.childrenAfterAggFilter : node.childrenAfterGroup;
      if (_.missing(children)) {
        return 0;
      }
      return this.setNodesSelected({
        newValue,
        clearSelection: false,
        suppressFinishActions: true,
        groupSelectsFiltered,
        source,
        nodes: children
      });
    };
    SelectionService2.prototype.setLastSelectedNode = function(rowNode) {
      this.lastSelectedNode = rowNode;
    };
    SelectionService2.prototype.getLastSelectedNode = function() {
      return this.lastSelectedNode;
    };
    SelectionService2.prototype.getSelectedNodes = function() {
      var selectedNodes = [];
      iterateObject(this.selectedNodes, function(key, rowNode) {
        if (rowNode) {
          selectedNodes.push(rowNode);
        }
      });
      return selectedNodes;
    };
    SelectionService2.prototype.getSelectedRows = function() {
      var selectedRows = [];
      iterateObject(this.selectedNodes, function(key, rowNode) {
        if (rowNode && rowNode.data) {
          selectedRows.push(rowNode.data);
        }
      });
      return selectedRows;
    };
    SelectionService2.prototype.getSelectionCount = function() {
      return Object.values(this.selectedNodes).length;
    };
    SelectionService2.prototype.filterFromSelection = function(predicate) {
      var newSelectedNodes = {};
      Object.entries(this.selectedNodes).forEach(function(_a2) {
        var _b2 = __read$9(_a2, 2), key = _b2[0], node = _b2[1];
        var passesPredicate = node && predicate(node);
        if (passesPredicate) {
          newSelectedNodes[key] = node;
        }
      });
      this.selectedNodes = newSelectedNodes;
    };
    SelectionService2.prototype.updateGroupsFromChildrenSelections = function(source, changedPath) {
      if (!this.groupSelectsChildren) {
        return false;
      }
      if (this.rowModel.getType() !== "clientSide") {
        return false;
      }
      var clientSideRowModel = this.rowModel;
      var rootNode = clientSideRowModel.getRootNode();
      if (!changedPath) {
        changedPath = new ChangedPath(true, rootNode);
        changedPath.setInactive();
      }
      var selectionChanged = false;
      changedPath.forEachChangedNodeDepthFirst(function(rowNode) {
        if (rowNode !== rootNode) {
          var selected = rowNode.calculateSelectedFromChildren();
          selectionChanged = rowNode.selectThisNode(selected === null ? false : selected, void 0, source) || selectionChanged;
        }
      });
      return selectionChanged;
    };
    SelectionService2.prototype.clearOtherNodes = function(rowNodeToKeepSelected, source) {
      var _this = this;
      var groupsToRefresh = {};
      var updatedCount = 0;
      iterateObject(this.selectedNodes, function(key, otherRowNode) {
        if (otherRowNode && otherRowNode.id !== rowNodeToKeepSelected.id) {
          var rowNode = _this.selectedNodes[otherRowNode.id];
          updatedCount += rowNode.setSelectedParams({
            newValue: false,
            clearSelection: false,
            suppressFinishActions: true,
            source
          });
          if (_this.groupSelectsChildren && otherRowNode.parent) {
            groupsToRefresh[otherRowNode.parent.id] = otherRowNode.parent;
          }
        }
      });
      iterateObject(groupsToRefresh, function(key, group) {
        var selected = group.calculateSelectedFromChildren();
        group.selectThisNode(selected === null ? false : selected, void 0, source);
      });
      return updatedCount;
    };
    SelectionService2.prototype.onRowSelected = function(event) {
      var rowNode = event.node;
      if (this.groupSelectsChildren && rowNode.group) {
        return;
      }
      if (rowNode.isSelected()) {
        this.selectedNodes[rowNode.id] = rowNode;
      } else {
        delete this.selectedNodes[rowNode.id];
      }
    };
    SelectionService2.prototype.syncInRowNode = function(rowNode, oldNode) {
      this.syncInOldRowNode(rowNode, oldNode);
      this.syncInNewRowNode(rowNode);
    };
    SelectionService2.prototype.syncInOldRowNode = function(rowNode, oldNode) {
      var oldNodeHasDifferentId = exists(oldNode) && rowNode.id !== oldNode.id;
      if (oldNodeHasDifferentId && oldNode) {
        var id2 = oldNode.id;
        var oldNodeSelected = this.selectedNodes[id2] == rowNode;
        if (oldNodeSelected) {
          this.selectedNodes[oldNode.id] = oldNode;
        }
      }
    };
    SelectionService2.prototype.syncInNewRowNode = function(rowNode) {
      if (exists(this.selectedNodes[rowNode.id])) {
        rowNode.setSelectedInitialValue(true);
        this.selectedNodes[rowNode.id] = rowNode;
      } else {
        rowNode.setSelectedInitialValue(false);
      }
    };
    SelectionService2.prototype.reset = function() {
      this.logger.log("reset");
      this.selectedNodes = {};
      this.lastSelectedNode = null;
    };
    SelectionService2.prototype.getBestCostNodeSelection = function() {
      if (this.rowModel.getType() !== "clientSide") {
        return;
      }
      var clientSideRowModel = this.rowModel;
      var topLevelNodes = clientSideRowModel.getTopLevelNodes();
      if (topLevelNodes === null) {
        return;
      }
      var result = [];
      function traverse(nodes) {
        for (var i = 0, l2 = nodes.length; i < l2; i++) {
          var node = nodes[i];
          if (node.isSelected()) {
            result.push(node);
          } else {
            var maybeGroup = node;
            if (maybeGroup.group && maybeGroup.children) {
              traverse(maybeGroup.children);
            }
          }
        }
      }
      traverse(topLevelNodes);
      return result;
    };
    SelectionService2.prototype.isEmpty = function() {
      var count = 0;
      iterateObject(this.selectedNodes, function(nodeId, rowNode) {
        if (rowNode) {
          count++;
        }
      });
      return count === 0;
    };
    SelectionService2.prototype.deselectAllRowNodes = function(params) {
      var callback2 = function(rowNode) {
        return rowNode.selectThisNode(false, void 0, source);
      };
      var rowModelClientSide = this.rowModel.getType() === "clientSide";
      var source = params.source, justFiltered = params.justFiltered, justCurrentPage = params.justCurrentPage;
      if (justCurrentPage || justFiltered) {
        if (!rowModelClientSide) {
          console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");
          return;
        }
        this.getNodesToSelect(justFiltered, justCurrentPage).forEach(callback2);
      } else {
        iterateObject(this.selectedNodes, function(id2, rowNode) {
          if (rowNode) {
            callback2(rowNode);
          }
        });
        this.reset();
      }
      if (rowModelClientSide && this.groupSelectsChildren) {
        this.updateGroupsFromChildrenSelections(source);
      }
      var event = {
        type: Events.EVENT_SELECTION_CHANGED,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    SelectionService2.prototype.getSelectAllState = function(justFiltered, justCurrentPage) {
      var _this = this;
      var selectedCount = 0;
      var notSelectedCount = 0;
      var callback2 = function(node) {
        if (_this.groupSelectsChildren && node.group) {
          return;
        }
        if (node.isSelected()) {
          selectedCount++;
        } else if (!node.selectable)
          ;
        else {
          notSelectedCount++;
        }
      };
      this.getNodesToSelect(justFiltered, justCurrentPage).forEach(callback2);
      if (selectedCount === 0 && notSelectedCount === 0) {
        return false;
      }
      if (selectedCount > 0 && notSelectedCount > 0) {
        return null;
      }
      return selectedCount > 0;
    };
    SelectionService2.prototype.getNodesToSelect = function(justFiltered, justCurrentPage) {
      var _this = this;
      if (justFiltered === void 0) {
        justFiltered = false;
      }
      if (justCurrentPage === void 0) {
        justCurrentPage = false;
      }
      if (this.rowModel.getType() !== "clientSide") {
        throw new Error("selectAll only available when rowModelType='clientSide', ie not " + this.rowModel.getType());
      }
      var nodes = [];
      if (justCurrentPage) {
        this.paginationProxy.forEachNodeOnPage(function(node) {
          if (!node.group) {
            nodes.push(node);
            return;
          }
          if (!node.expanded) {
            var recursivelyAddChildren_1 = function(child) {
              var _a2;
              nodes.push(child);
              if ((_a2 = child.childrenAfterFilter) === null || _a2 === void 0 ? void 0 : _a2.length) {
                child.childrenAfterFilter.forEach(recursivelyAddChildren_1);
              }
            };
            recursivelyAddChildren_1(node);
            return;
          }
          if (!_this.groupSelectsChildren) {
            nodes.push(node);
          }
        });
        return nodes;
      }
      var clientSideRowModel = this.rowModel;
      if (justFiltered) {
        clientSideRowModel.forEachNodeAfterFilter(function(node) {
          nodes.push(node);
        });
        return nodes;
      }
      clientSideRowModel.forEachNode(function(node) {
        nodes.push(node);
      });
      return nodes;
    };
    SelectionService2.prototype.selectAllRowNodes = function(params) {
      if (this.rowModel.getType() !== "clientSide") {
        throw new Error("selectAll only available when rowModelType='clientSide', ie not " + this.rowModel.getType());
      }
      var source = params.source, justFiltered = params.justFiltered, justCurrentPage = params.justCurrentPage;
      var callback2 = function(rowNode) {
        return rowNode.selectThisNode(true, void 0, source);
      };
      this.getNodesToSelect(justFiltered, justCurrentPage).forEach(callback2);
      if (this.rowModel.getType() === "clientSide" && this.groupSelectsChildren) {
        this.updateGroupsFromChildrenSelections(source);
      }
      var event = {
        type: Events.EVENT_SELECTION_CHANGED,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    SelectionService2.prototype.getServerSideSelectionState = function() {
      return null;
    };
    SelectionService2.prototype.setServerSideSelectionState = function(state) {
    };
    __decorate$O([
      Autowired("rowModel")
    ], SelectionService2.prototype, "rowModel", void 0);
    __decorate$O([
      Autowired("paginationProxy")
    ], SelectionService2.prototype, "paginationProxy", void 0);
    __decorate$O([
      __param$5(0, Qualifier("loggerFactory"))
    ], SelectionService2.prototype, "setBeans", null);
    __decorate$O([
      PostConstruct
    ], SelectionService2.prototype, "init", null);
    SelectionService2 = __decorate$O([
      Bean("selectionService")
    ], SelectionService2);
    return SelectionService2;
  }(BeanStub)
);
var __decorate$N = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ColumnApi = (
  /** @class */
  function() {
    function ColumnApi2() {
    }
    ColumnApi2.prototype.sizeColumnsToFit = function(gridWidth) {
      if (typeof gridWidth === "undefined") {
        console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)");
      }
      this.columnModel.sizeColumnsToFit(gridWidth, "api");
    };
    ColumnApi2.prototype.setColumnGroupOpened = function(group, newValue) {
      this.columnModel.setColumnGroupOpened(group, newValue, "api");
    };
    ColumnApi2.prototype.getColumnGroup = function(name, instanceId) {
      return this.columnModel.getColumnGroup(name, instanceId);
    };
    ColumnApi2.prototype.getProvidedColumnGroup = function(name) {
      return this.columnModel.getProvidedColumnGroup(name);
    };
    ColumnApi2.prototype.getDisplayNameForColumn = function(column, location) {
      return this.columnModel.getDisplayNameForColumn(column, location) || "";
    };
    ColumnApi2.prototype.getDisplayNameForColumnGroup = function(columnGroup, location) {
      return this.columnModel.getDisplayNameForColumnGroup(columnGroup, location) || "";
    };
    ColumnApi2.prototype.getColumn = function(key) {
      return this.columnModel.getPrimaryColumn(key);
    };
    ColumnApi2.prototype.getColumns = function() {
      return this.columnModel.getAllPrimaryColumns();
    };
    ColumnApi2.prototype.applyColumnState = function(params) {
      return this.columnModel.applyColumnState(params, "api");
    };
    ColumnApi2.prototype.getColumnState = function() {
      return this.columnModel.getColumnState();
    };
    ColumnApi2.prototype.resetColumnState = function() {
      this.columnModel.resetColumnState("api");
    };
    ColumnApi2.prototype.getColumnGroupState = function() {
      return this.columnModel.getColumnGroupState();
    };
    ColumnApi2.prototype.setColumnGroupState = function(stateItems) {
      this.columnModel.setColumnGroupState(stateItems, "api");
    };
    ColumnApi2.prototype.resetColumnGroupState = function() {
      this.columnModel.resetColumnGroupState("api");
    };
    ColumnApi2.prototype.isPinning = function() {
      return this.columnModel.isPinningLeft() || this.columnModel.isPinningRight();
    };
    ColumnApi2.prototype.isPinningLeft = function() {
      return this.columnModel.isPinningLeft();
    };
    ColumnApi2.prototype.isPinningRight = function() {
      return this.columnModel.isPinningRight();
    };
    ColumnApi2.prototype.getDisplayedColAfter = function(col) {
      return this.columnModel.getDisplayedColAfter(col);
    };
    ColumnApi2.prototype.getDisplayedColBefore = function(col) {
      return this.columnModel.getDisplayedColBefore(col);
    };
    ColumnApi2.prototype.setColumnVisible = function(key, visible) {
      this.columnModel.setColumnVisible(key, visible, "api");
    };
    ColumnApi2.prototype.setColumnsVisible = function(keys2, visible) {
      this.columnModel.setColumnsVisible(keys2, visible, "api");
    };
    ColumnApi2.prototype.setColumnPinned = function(key, pinned) {
      this.columnModel.setColumnPinned(key, pinned, "api");
    };
    ColumnApi2.prototype.setColumnsPinned = function(keys2, pinned) {
      this.columnModel.setColumnsPinned(keys2, pinned, "api");
    };
    ColumnApi2.prototype.getAllGridColumns = function() {
      return this.columnModel.getAllGridColumns();
    };
    ColumnApi2.prototype.getDisplayedLeftColumns = function() {
      return this.columnModel.getDisplayedLeftColumns();
    };
    ColumnApi2.prototype.getDisplayedCenterColumns = function() {
      return this.columnModel.getDisplayedCenterColumns();
    };
    ColumnApi2.prototype.getDisplayedRightColumns = function() {
      return this.columnModel.getDisplayedRightColumns();
    };
    ColumnApi2.prototype.getAllDisplayedColumns = function() {
      return this.columnModel.getAllDisplayedColumns();
    };
    ColumnApi2.prototype.getAllDisplayedVirtualColumns = function() {
      return this.columnModel.getViewportColumns();
    };
    ColumnApi2.prototype.moveColumn = function(key, toIndex) {
      this.columnModel.moveColumn(key, toIndex, "api");
    };
    ColumnApi2.prototype.moveColumnByIndex = function(fromIndex, toIndex) {
      this.columnModel.moveColumnByIndex(fromIndex, toIndex, "api");
    };
    ColumnApi2.prototype.moveColumns = function(columnsToMoveKeys, toIndex) {
      this.columnModel.moveColumns(columnsToMoveKeys, toIndex, "api");
    };
    ColumnApi2.prototype.moveRowGroupColumn = function(fromIndex, toIndex) {
      this.columnModel.moveRowGroupColumn(fromIndex, toIndex);
    };
    ColumnApi2.prototype.setColumnAggFunc = function(key, aggFunc) {
      this.columnModel.setColumnAggFunc(key, aggFunc);
    };
    ColumnApi2.prototype.setColumnWidth = function(key, newWidth, finished, source) {
      if (finished === void 0) {
        finished = true;
      }
      this.columnModel.setColumnWidths([{ key, newWidth }], false, finished, source);
    };
    ColumnApi2.prototype.setColumnWidths = function(columnWidths, finished, source) {
      if (finished === void 0) {
        finished = true;
      }
      this.columnModel.setColumnWidths(columnWidths, false, finished, source);
    };
    ColumnApi2.prototype.setPivotMode = function(pivotMode) {
      this.columnModel.setPivotMode(pivotMode);
    };
    ColumnApi2.prototype.isPivotMode = function() {
      return this.columnModel.isPivotMode();
    };
    ColumnApi2.prototype.getPivotResultColumn = function(pivotKeys, valueColKey) {
      return this.columnModel.getSecondaryPivotColumn(pivotKeys, valueColKey);
    };
    ColumnApi2.prototype.setValueColumns = function(colKeys) {
      this.columnModel.setValueColumns(colKeys, "api");
    };
    ColumnApi2.prototype.getValueColumns = function() {
      return this.columnModel.getValueColumns();
    };
    ColumnApi2.prototype.removeValueColumn = function(colKey) {
      this.columnModel.removeValueColumn(colKey, "api");
    };
    ColumnApi2.prototype.removeValueColumns = function(colKeys) {
      this.columnModel.removeValueColumns(colKeys, "api");
    };
    ColumnApi2.prototype.addValueColumn = function(colKey) {
      this.columnModel.addValueColumn(colKey, "api");
    };
    ColumnApi2.prototype.addValueColumns = function(colKeys) {
      this.columnModel.addValueColumns(colKeys, "api");
    };
    ColumnApi2.prototype.setRowGroupColumns = function(colKeys) {
      this.columnModel.setRowGroupColumns(colKeys, "api");
    };
    ColumnApi2.prototype.removeRowGroupColumn = function(colKey) {
      this.columnModel.removeRowGroupColumn(colKey, "api");
    };
    ColumnApi2.prototype.removeRowGroupColumns = function(colKeys) {
      this.columnModel.removeRowGroupColumns(colKeys, "api");
    };
    ColumnApi2.prototype.addRowGroupColumn = function(colKey) {
      this.columnModel.addRowGroupColumn(colKey, "api");
    };
    ColumnApi2.prototype.addRowGroupColumns = function(colKeys) {
      this.columnModel.addRowGroupColumns(colKeys, "api");
    };
    ColumnApi2.prototype.getRowGroupColumns = function() {
      return this.columnModel.getRowGroupColumns();
    };
    ColumnApi2.prototype.setPivotColumns = function(colKeys) {
      this.columnModel.setPivotColumns(colKeys, "api");
    };
    ColumnApi2.prototype.removePivotColumn = function(colKey) {
      this.columnModel.removePivotColumn(colKey, "api");
    };
    ColumnApi2.prototype.removePivotColumns = function(colKeys) {
      this.columnModel.removePivotColumns(colKeys, "api");
    };
    ColumnApi2.prototype.addPivotColumn = function(colKey) {
      this.columnModel.addPivotColumn(colKey, "api");
    };
    ColumnApi2.prototype.addPivotColumns = function(colKeys) {
      this.columnModel.addPivotColumns(colKeys, "api");
    };
    ColumnApi2.prototype.getPivotColumns = function() {
      return this.columnModel.getPivotColumns();
    };
    ColumnApi2.prototype.getLeftDisplayedColumnGroups = function() {
      return this.columnModel.getDisplayedTreeLeft();
    };
    ColumnApi2.prototype.getCenterDisplayedColumnGroups = function() {
      return this.columnModel.getDisplayedTreeCentre();
    };
    ColumnApi2.prototype.getRightDisplayedColumnGroups = function() {
      return this.columnModel.getDisplayedTreeRight();
    };
    ColumnApi2.prototype.getAllDisplayedColumnGroups = function() {
      return this.columnModel.getAllDisplayedTrees();
    };
    ColumnApi2.prototype.autoSizeColumn = function(key, skipHeader) {
      return this.columnModel.autoSizeColumn(key, skipHeader, "api");
    };
    ColumnApi2.prototype.autoSizeColumns = function(keys2, skipHeader) {
      this.columnModel.autoSizeColumns({ columns: keys2, skipHeader });
    };
    ColumnApi2.prototype.autoSizeAllColumns = function(skipHeader) {
      this.columnModel.autoSizeAllColumns(skipHeader, "api");
    };
    ColumnApi2.prototype.setPivotResultColumns = function(colDefs) {
      this.columnModel.setSecondaryColumns(colDefs, "api");
    };
    ColumnApi2.prototype.getPivotResultColumns = function() {
      return this.columnModel.getSecondaryColumns();
    };
    ColumnApi2.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid = function() {
      setTimeout(_.removeAllReferences.bind(window, this, "Column API"), 100);
    };
    ColumnApi2.prototype.getAllColumns = function() {
      logDeprecation("28.0", "getAllColumns", "getColumns");
      return this.getColumns();
    };
    ColumnApi2.prototype.getPrimaryColumns = function() {
      logDeprecation("28.0", "getPrimaryColumns", "getColumns");
      return this.getColumns();
    };
    ColumnApi2.prototype.getSecondaryColumns = function() {
      logDeprecation("28.0", "getSecondaryColumns", "getPivotResultColumns");
      return this.getPivotResultColumns();
    };
    ColumnApi2.prototype.setSecondaryColumns = function(colDefs) {
      logDeprecation("28.0", "setSecondaryColumns", "setPivotResultColumns");
      this.setPivotResultColumns(colDefs);
    };
    ColumnApi2.prototype.getSecondaryPivotColumn = function(pivotKeys, valueColKey) {
      logDeprecation("28.0", "getSecondaryPivotColumn", "getPivotResultColumn");
      return this.getPivotResultColumn(pivotKeys, valueColKey);
    };
    __decorate$N([
      Autowired("columnModel")
    ], ColumnApi2.prototype, "columnModel", void 0);
    __decorate$N([
      PreDestroy
    ], ColumnApi2.prototype, "cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid", null);
    ColumnApi2 = __decorate$N([
      Bean("columnApi")
    ], ColumnApi2);
    return ColumnApi2;
  }()
);
var __extends$L = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$M = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ValueService = (
  /** @class */
  function(_super) {
    __extends$L(ValueService2, _super);
    function ValueService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.initialised = false;
      _this.isSsrm = false;
      return _this;
    }
    ValueService2.prototype.init = function() {
      var _this = this;
      this.isSsrm = this.gridOptionsService.isRowModelType("serverSide");
      this.cellExpressions = this.gridOptionsService.is("enableCellExpressions");
      this.isTreeData = this.gridOptionsService.is("treeData");
      this.initialised = true;
      this.eventService.addEventListener(Events.EVENT_CELL_VALUE_CHANGED, function(event) {
        return _this.callColumnCellValueChangedHandler(event);
      }, this.gridOptionsService.useAsyncEvents());
      this.addManagedPropertyListener("treeData", function(propChange) {
        return _this.isTreeData = propChange.currentValue;
      });
    };
    ValueService2.prototype.getValue = function(column, rowNode, forFilter, ignoreAggData) {
      if (forFilter === void 0) {
        forFilter = false;
      }
      if (ignoreAggData === void 0) {
        ignoreAggData = false;
      }
      if (!this.initialised) {
        this.init();
      }
      if (!rowNode) {
        return;
      }
      var colDef = column.getColDef();
      var field = colDef.field;
      var colId = column.getColId();
      var data = rowNode.data;
      var result;
      var groupDataExists = rowNode.groupData && rowNode.groupData[colId] !== void 0;
      var aggDataExists = !ignoreAggData && rowNode.aggData && rowNode.aggData[colId] !== void 0;
      var ignoreSsrmAggData = this.isSsrm && ignoreAggData && !!column.getColDef().aggFunc;
      var ssrmFooterGroupCol = this.isSsrm && rowNode.footer && rowNode.field && (column.getColDef().showRowGroup === true || column.getColDef().showRowGroup === rowNode.field);
      if (forFilter && colDef.filterValueGetter) {
        result = this.executeFilterValueGetter(colDef.filterValueGetter, data, column, rowNode);
      } else if (this.isTreeData && aggDataExists) {
        result = rowNode.aggData[colId];
      } else if (this.isTreeData && colDef.valueGetter) {
        result = this.executeValueGetter(colDef.valueGetter, data, column, rowNode);
      } else if (this.isTreeData && (field && data)) {
        result = getValueUsingField(data, field, column.isFieldContainsDots());
      } else if (groupDataExists) {
        result = rowNode.groupData[colId];
      } else if (aggDataExists) {
        result = rowNode.aggData[colId];
      } else if (colDef.valueGetter) {
        result = this.executeValueGetter(colDef.valueGetter, data, column, rowNode);
      } else if (ssrmFooterGroupCol) {
        result = getValueUsingField(data, rowNode.field, column.isFieldContainsDots());
      } else if (field && data && !ignoreSsrmAggData) {
        result = getValueUsingField(data, field, column.isFieldContainsDots());
      }
      if (this.cellExpressions && typeof result === "string" && result.indexOf("=") === 0) {
        var cellValueGetter = result.substring(1);
        result = this.executeValueGetter(cellValueGetter, data, column, rowNode);
      }
      if (result == null) {
        var openedGroup = this.getOpenedGroup(rowNode, column);
        if (openedGroup != null) {
          return openedGroup;
        }
      }
      return result;
    };
    ValueService2.prototype.getOpenedGroup = function(rowNode, column) {
      if (!this.gridOptionsService.is("showOpenedGroup")) {
        return;
      }
      var colDef = column.getColDef();
      if (!colDef.showRowGroup) {
        return;
      }
      var showRowGroup = column.getColDef().showRowGroup;
      var pointer = rowNode.parent;
      while (pointer != null) {
        if (pointer.rowGroupColumn && (showRowGroup === true || showRowGroup === pointer.rowGroupColumn.getColId())) {
          return pointer.key;
        }
        pointer = pointer.parent;
      }
      return void 0;
    };
    ValueService2.prototype.setValue = function(rowNode, colKey, newValue, eventSource) {
      var column = this.columnModel.getPrimaryColumn(colKey);
      if (!rowNode || !column) {
        return false;
      }
      if (missing(rowNode.data)) {
        rowNode.data = {};
      }
      var _a2 = column.getColDef(), field = _a2.field, valueSetter = _a2.valueSetter;
      if (missing(field) && missing(valueSetter)) {
        console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work");
        return false;
      }
      if (!this.dataTypeService.checkType(column, newValue)) {
        console.warn("AG Grid: Data type of the new value does not match the cell data type of the column");
        return false;
      }
      var params = {
        node: rowNode,
        data: rowNode.data,
        oldValue: this.getValue(column, rowNode),
        newValue,
        colDef: column.getColDef(),
        column,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context
      };
      params.newValue = newValue;
      var valueWasDifferent;
      if (exists(valueSetter)) {
        if (typeof valueSetter === "function") {
          valueWasDifferent = valueSetter(params);
        } else {
          valueWasDifferent = this.expressionService.evaluate(valueSetter, params);
        }
      } else {
        valueWasDifferent = this.setValueUsingField(rowNode.data, field, newValue, column.isFieldContainsDots());
      }
      if (valueWasDifferent === void 0) {
        valueWasDifferent = true;
      }
      if (!valueWasDifferent) {
        return false;
      }
      rowNode.resetQuickFilterAggregateText();
      this.valueCache.onDataChanged();
      params.newValue = this.getValue(column, rowNode);
      var event = {
        type: Events.EVENT_CELL_VALUE_CHANGED,
        event: null,
        rowIndex: rowNode.rowIndex,
        rowPinned: rowNode.rowPinned,
        column: params.column,
        api: params.api,
        columnApi: params.columnApi,
        colDef: params.colDef,
        context: params.context,
        data: rowNode.data,
        node: rowNode,
        oldValue: params.oldValue,
        newValue: params.newValue,
        value: params.newValue,
        source: eventSource
      };
      this.eventService.dispatchEvent(event);
      return true;
    };
    ValueService2.prototype.callColumnCellValueChangedHandler = function(event) {
      var onCellValueChanged = event.colDef.onCellValueChanged;
      if (typeof onCellValueChanged === "function") {
        onCellValueChanged({
          node: event.node,
          data: event.data,
          oldValue: event.oldValue,
          newValue: event.newValue,
          colDef: event.colDef,
          column: event.column,
          api: event.api,
          columnApi: event.columnApi,
          context: event.context
        });
      }
    };
    ValueService2.prototype.setValueUsingField = function(data, field, newValue, isFieldContainsDots) {
      if (!field) {
        return false;
      }
      var valuesAreSame = false;
      if (!isFieldContainsDots) {
        valuesAreSame = data[field] == newValue;
        if (!valuesAreSame) {
          data[field] = newValue;
        }
      } else {
        var fieldPieces = field.split(".");
        var currentObject = data;
        while (fieldPieces.length > 0 && currentObject) {
          var fieldPiece = fieldPieces.shift();
          if (fieldPieces.length === 0) {
            valuesAreSame = currentObject[fieldPiece] == newValue;
            if (!valuesAreSame) {
              currentObject[fieldPiece] = newValue;
            }
          } else {
            currentObject = currentObject[fieldPiece];
          }
        }
      }
      return !valuesAreSame;
    };
    ValueService2.prototype.executeFilterValueGetter = function(valueGetter, data, column, rowNode) {
      var params = {
        data,
        node: rowNode,
        column,
        colDef: column.getColDef(),
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context,
        getValue: this.getValueCallback.bind(this, rowNode)
      };
      if (typeof valueGetter === "function") {
        return valueGetter(params);
      }
      return this.expressionService.evaluate(valueGetter, params);
    };
    ValueService2.prototype.executeValueGetter = function(valueGetter, data, column, rowNode) {
      var colId = column.getColId();
      var valueFromCache = this.valueCache.getValue(rowNode, colId);
      if (valueFromCache !== void 0) {
        return valueFromCache;
      }
      var params = {
        data,
        node: rowNode,
        column,
        colDef: column.getColDef(),
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context,
        getValue: this.getValueCallback.bind(this, rowNode)
      };
      var result;
      if (typeof valueGetter === "function") {
        result = valueGetter(params);
      } else {
        result = this.expressionService.evaluate(valueGetter, params);
      }
      this.valueCache.setValue(rowNode, colId, result);
      return result;
    };
    ValueService2.prototype.getValueCallback = function(node, field) {
      var otherColumn = this.columnModel.getPrimaryColumn(field);
      if (otherColumn) {
        return this.getValue(otherColumn, node);
      }
      return null;
    };
    ValueService2.prototype.getKeyForNode = function(col, rowNode) {
      var value = this.getValue(col, rowNode);
      var keyCreator = col.getColDef().keyCreator;
      var result = value;
      if (keyCreator) {
        var keyParams = {
          value,
          colDef: col.getColDef(),
          column: col,
          node: rowNode,
          data: rowNode.data,
          api: this.gridOptionsService.api,
          columnApi: this.gridOptionsService.columnApi,
          context: this.gridOptionsService.context
        };
        result = keyCreator(keyParams);
      }
      if (typeof result === "string" || result == null) {
        return result;
      }
      result = String(result);
      if (result === "[object Object]") {
        doOnce(function() {
          console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key");
        }, "getKeyForNode - warn about [object,object]");
      }
      return result;
    };
    __decorate$M([
      Autowired("expressionService")
    ], ValueService2.prototype, "expressionService", void 0);
    __decorate$M([
      Autowired("columnModel")
    ], ValueService2.prototype, "columnModel", void 0);
    __decorate$M([
      Autowired("valueCache")
    ], ValueService2.prototype, "valueCache", void 0);
    __decorate$M([
      Autowired("dataTypeService")
    ], ValueService2.prototype, "dataTypeService", void 0);
    __decorate$M([
      PostConstruct
    ], ValueService2.prototype, "init", null);
    ValueService2 = __decorate$M([
      Bean("valueService")
    ], ValueService2);
    return ValueService2;
  }(BeanStub)
);
var __extends$K = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$L = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$4 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var ExpressionService = (
  /** @class */
  function(_super) {
    __extends$K(ExpressionService2, _super);
    function ExpressionService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.expressionToFunctionCache = {};
      return _this;
    }
    ExpressionService2.prototype.setBeans = function(loggerFactory) {
      this.logger = loggerFactory.create("ExpressionService");
    };
    ExpressionService2.prototype.evaluate = function(expression, params) {
      if (typeof expression === "string") {
        return this.evaluateExpression(expression, params);
      } else {
        console.error("AG Grid: value should be either a string or a function", expression);
      }
    };
    ExpressionService2.prototype.evaluateExpression = function(expression, params) {
      try {
        var javaScriptFunction = this.createExpressionFunction(expression);
        var result = javaScriptFunction(params.value, params.context, params.oldValue, params.newValue, params.value, params.node, params.data, params.colDef, params.rowIndex, params.api, params.columnApi, params.getValue, params.column, params.columnGroup);
        return result;
      } catch (e) {
        console.log("Processing of the expression failed");
        console.log("Expression = " + expression);
        console.log("Params =", params);
        console.log("Exception = " + e);
        return null;
      }
    };
    ExpressionService2.prototype.createExpressionFunction = function(expression) {
      if (this.expressionToFunctionCache[expression]) {
        return this.expressionToFunctionCache[expression];
      }
      var functionBody = this.createFunctionBody(expression);
      var theFunction = new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup", functionBody);
      this.expressionToFunctionCache[expression] = theFunction;
      return theFunction;
    };
    ExpressionService2.prototype.createFunctionBody = function(expression) {
      if (expression.indexOf("return") >= 0) {
        return expression;
      } else {
        return "return " + expression + ";";
      }
    };
    __decorate$L([
      __param$4(0, Qualifier("loggerFactory"))
    ], ExpressionService2.prototype, "setBeans", null);
    ExpressionService2 = __decorate$L([
      Bean("expressionService")
    ], ExpressionService2);
    return ExpressionService2;
  }(BeanStub)
);
var __extends$J = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$K = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var TemplateService = (
  /** @class */
  function(_super) {
    __extends$J(TemplateService2, _super);
    function TemplateService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.templateCache = {};
      _this.waitingCallbacks = {};
      return _this;
    }
    TemplateService2.prototype.getTemplate = function(url, callback2) {
      var templateFromCache = this.templateCache[url];
      if (templateFromCache) {
        return templateFromCache;
      }
      var callbackList = this.waitingCallbacks[url];
      var that = this;
      if (!callbackList) {
        callbackList = [];
        this.waitingCallbacks[url] = callbackList;
        var client = new XMLHttpRequest();
        client.onload = function() {
          that.handleHttpResult(this, url);
        };
        client.open("GET", url);
        client.send();
      }
      if (callback2) {
        callbackList.push(callback2);
      }
      return null;
    };
    TemplateService2.prototype.handleHttpResult = function(httpResult, url) {
      if (httpResult.status !== 200 || httpResult.response === null) {
        console.warn("AG Grid: Unable to get template error " + httpResult.status + " - " + url);
        return;
      }
      this.templateCache[url] = httpResult.response || httpResult.responseText;
      var callbacks = this.waitingCallbacks[url];
      for (var i = 0; i < callbacks.length; i++) {
        var callback2 = callbacks[i];
        callback2();
      }
    };
    TemplateService2 = __decorate$K([
      Bean("templateService")
    ], TemplateService2);
    return TemplateService2;
  }(BeanStub)
);
var __extends$I = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$J = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$3 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var LoggerFactory = (
  /** @class */
  function(_super) {
    __extends$I(LoggerFactory2, _super);
    function LoggerFactory2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    LoggerFactory2.prototype.setBeans = function(gridOptionsService) {
      this.logging = gridOptionsService.is("debug");
    };
    LoggerFactory2.prototype.create = function(name) {
      return new Logger(name, this.isLogging.bind(this));
    };
    LoggerFactory2.prototype.isLogging = function() {
      return this.logging;
    };
    __decorate$J([
      __param$3(0, Qualifier("gridOptionsService"))
    ], LoggerFactory2.prototype, "setBeans", null);
    LoggerFactory2 = __decorate$J([
      Bean("loggerFactory")
    ], LoggerFactory2);
    return LoggerFactory2;
  }(BeanStub)
);
var Logger = (
  /** @class */
  function() {
    function Logger2(name, isLoggingFunc) {
      this.name = name;
      this.isLoggingFunc = isLoggingFunc;
    }
    Logger2.prototype.isLogging = function() {
      return this.isLoggingFunc();
    };
    Logger2.prototype.log = function(message) {
      if (this.isLoggingFunc()) {
        console.log("AG Grid." + this.name + ": " + message);
      }
    };
    return Logger2;
  }()
);
var __extends$H = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$I = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GridCtrl = (
  /** @class */
  function(_super) {
    __extends$H(GridCtrl2, _super);
    function GridCtrl2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    GridCtrl2.prototype.setComp = function(view, eGridDiv, eGui) {
      var _this = this;
      this.view = view;
      this.eGridHostDiv = eGridDiv;
      this.eGui = eGui;
      this.eGui.setAttribute("grid-id", this.context.getGridId());
      this.dragAndDropService.addDropTarget({
        getContainer: function() {
          return _this.eGui;
        },
        isInterestedIn: function(type) {
          return type === DragSourceType.HeaderCell || type === DragSourceType.ToolPanel;
        },
        getIconName: function() {
          return DragAndDropService.ICON_NOT_ALLOWED;
        }
      });
      this.mouseEventService.stampTopLevelGridCompWithGridInstance(eGridDiv);
      this.createManagedBean(new LayoutFeature(this.view));
      this.addRtlSupport();
      this.addManagedListener(this, Events.EVENT_KEYBOARD_FOCUS, function() {
        _this.view.addOrRemoveKeyboardFocusClass(true);
      });
      this.addManagedListener(this, Events.EVENT_MOUSE_FOCUS, function() {
        _this.view.addOrRemoveKeyboardFocusClass(false);
      });
      var unsubscribeFromResize = this.resizeObserverService.observeResize(this.eGridHostDiv, this.onGridSizeChanged.bind(this));
      this.addDestroyFunc(function() {
        return unsubscribeFromResize();
      });
      this.ctrlsService.registerGridCtrl(this);
    };
    GridCtrl2.prototype.isDetailGrid = function() {
      var _a2;
      var el2 = this.focusService.findTabbableParent(this.getGui());
      return ((_a2 = el2 === null || el2 === void 0 ? void 0 : el2.getAttribute("row-id")) === null || _a2 === void 0 ? void 0 : _a2.startsWith("detail")) || false;
    };
    GridCtrl2.prototype.showDropZones = function() {
      return ModuleRegistry.__isRegistered(ModuleNames.RowGroupingModule, this.context.getGridId());
    };
    GridCtrl2.prototype.showSideBar = function() {
      return ModuleRegistry.__isRegistered(ModuleNames.SideBarModule, this.context.getGridId());
    };
    GridCtrl2.prototype.showStatusBar = function() {
      return ModuleRegistry.__isRegistered(ModuleNames.StatusBarModule, this.context.getGridId());
    };
    GridCtrl2.prototype.showWatermark = function() {
      return ModuleRegistry.__isRegistered(ModuleNames.EnterpriseCoreModule, this.context.getGridId());
    };
    GridCtrl2.prototype.onGridSizeChanged = function() {
      var event = {
        type: Events.EVENT_GRID_SIZE_CHANGED,
        clientWidth: this.eGridHostDiv.clientWidth,
        clientHeight: this.eGridHostDiv.clientHeight
      };
      this.eventService.dispatchEvent(event);
    };
    GridCtrl2.prototype.addRtlSupport = function() {
      var cssClass = this.gridOptionsService.is("enableRtl") ? "ag-rtl" : "ag-ltr";
      this.view.setRtlClass(cssClass);
    };
    GridCtrl2.prototype.destroyGridUi = function() {
      this.view.destroyGridUi();
    };
    GridCtrl2.prototype.getGui = function() {
      return this.eGui;
    };
    GridCtrl2.prototype.setResizeCursor = function(on) {
      this.view.setCursor(on ? "ew-resize" : null);
    };
    GridCtrl2.prototype.disableUserSelect = function(on) {
      this.view.setUserSelect(on ? "none" : null);
    };
    GridCtrl2.prototype.focusNextInnerContainer = function(backwards) {
      var eDocument = this.gridOptionsService.getDocument();
      var focusableContainers = this.view.getFocusableContainers();
      var idxWithFocus = focusableContainers.findIndex(function(container) {
        return container.contains(eDocument.activeElement);
      });
      var nextIdx = idxWithFocus + (backwards ? -1 : 1);
      if (nextIdx <= 0 || nextIdx >= focusableContainers.length) {
        return false;
      }
      return this.focusService.focusInto(focusableContainers[nextIdx]);
    };
    GridCtrl2.prototype.focusInnerElement = function(fromBottom) {
      var focusableContainers = this.view.getFocusableContainers();
      var allColumns = this.columnModel.getAllDisplayedColumns();
      if (fromBottom) {
        if (focusableContainers.length > 1) {
          return this.focusService.focusInto(last(focusableContainers), true);
        }
        var lastColumn = last(allColumns);
        if (this.focusService.focusGridView(lastColumn, true)) {
          return true;
        }
      }
      if (this.gridOptionsService.getNum("headerHeight") === 0) {
        return this.focusService.focusGridView(allColumns[0]);
      }
      return this.focusService.focusFirstHeader();
    };
    GridCtrl2.prototype.forceFocusOutOfContainer = function(up) {
      if (up === void 0) {
        up = false;
      }
      this.view.forceFocusOutOfContainer(up);
    };
    __decorate$I([
      Autowired("focusService")
    ], GridCtrl2.prototype, "focusService", void 0);
    __decorate$I([
      Autowired("resizeObserverService")
    ], GridCtrl2.prototype, "resizeObserverService", void 0);
    __decorate$I([
      Autowired("columnModel")
    ], GridCtrl2.prototype, "columnModel", void 0);
    __decorate$I([
      Autowired("ctrlsService")
    ], GridCtrl2.prototype, "ctrlsService", void 0);
    __decorate$I([
      Autowired("mouseEventService")
    ], GridCtrl2.prototype, "mouseEventService", void 0);
    __decorate$I([
      Autowired("dragAndDropService")
    ], GridCtrl2.prototype, "dragAndDropService", void 0);
    return GridCtrl2;
  }(BeanStub)
);
var __extends$G = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$H = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var GridComp$1 = (
  /** @class */
  function(_super) {
    __extends$G(GridComp2, _super);
    function GridComp2(eGridDiv) {
      var _this = _super.call(this) || this;
      _this.eGridDiv = eGridDiv;
      return _this;
    }
    GridComp2.prototype.postConstruct = function() {
      var _this = this;
      this.logger = this.loggerFactory.create("GridComp");
      var compProxy = {
        destroyGridUi: function() {
          return _this.destroyBean(_this);
        },
        setRtlClass: function(cssClass) {
          return _this.addCssClass(cssClass);
        },
        addOrRemoveKeyboardFocusClass: function(addOrRemove) {
          return _this.addOrRemoveCssClass(FocusService.AG_KEYBOARD_FOCUS, addOrRemove);
        },
        forceFocusOutOfContainer: this.forceFocusOutOfContainer.bind(this),
        updateLayoutClasses: this.updateLayoutClasses.bind(this),
        getFocusableContainers: this.getFocusableContainers.bind(this),
        setUserSelect: function(value) {
          _this.getGui().style.userSelect = value != null ? value : "";
          _this.getGui().style.webkitUserSelect = value != null ? value : "";
        },
        setCursor: function(value) {
          _this.getGui().style.cursor = value != null ? value : "";
        }
      };
      this.ctrl = this.createManagedBean(new GridCtrl());
      var template = this.createTemplate();
      this.setTemplate(template);
      this.ctrl.setComp(compProxy, this.eGridDiv, this.getGui());
      this.insertGridIntoDom();
      this.initialiseTabGuard({
        // we want to override the default behaviour to do nothing for onTabKeyDown
        onTabKeyDown: function() {
          return void 0;
        },
        focusInnerElement: function(fromBottom) {
          return _this.ctrl.focusInnerElement(fromBottom);
        }
      });
    };
    GridComp2.prototype.insertGridIntoDom = function() {
      var _this = this;
      var eGui = this.getGui();
      this.eGridDiv.appendChild(eGui);
      this.addDestroyFunc(function() {
        _this.eGridDiv.removeChild(eGui);
        _this.logger.log("Grid removed from DOM");
      });
    };
    GridComp2.prototype.updateLayoutClasses = function(cssClass, params) {
      var eRootWrapperBodyClassList = this.eRootWrapperBody.classList;
      eRootWrapperBodyClassList.toggle(LayoutCssClasses.AUTO_HEIGHT, params.autoHeight);
      eRootWrapperBodyClassList.toggle(LayoutCssClasses.NORMAL, params.normal);
      eRootWrapperBodyClassList.toggle(LayoutCssClasses.PRINT, params.print);
      this.addOrRemoveCssClass(LayoutCssClasses.AUTO_HEIGHT, params.autoHeight);
      this.addOrRemoveCssClass(LayoutCssClasses.NORMAL, params.normal);
      this.addOrRemoveCssClass(LayoutCssClasses.PRINT, params.print);
    };
    GridComp2.prototype.createTemplate = function() {
      var dropZones = this.ctrl.showDropZones() ? "<ag-grid-header-drop-zones></ag-grid-header-drop-zones>" : "";
      var sideBar = this.ctrl.showSideBar() ? '<ag-side-bar ref="sideBar"></ag-side-bar>' : "";
      var statusBar = this.ctrl.showStatusBar() ? '<ag-status-bar ref="statusBar"></ag-status-bar>' : "";
      var watermark = this.ctrl.showWatermark() ? "<ag-watermark></ag-watermark>" : "";
      var template = (
        /* html */
        '<div class="ag-root-wrapper" role="presentation">\n                ' + dropZones + '\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    ' + sideBar + "\n                </div>\n                " + statusBar + "\n                <ag-pagination></ag-pagination>\n                " + watermark + "\n            </div>"
      );
      return template;
    };
    GridComp2.prototype.getFocusableElement = function() {
      return this.eRootWrapperBody;
    };
    GridComp2.prototype.getFocusableContainers = function() {
      var focusableContainers = [
        this.gridBodyComp.getGui()
      ];
      if (this.sideBarComp) {
        focusableContainers.push(this.sideBarComp.getGui());
      }
      return focusableContainers.filter(function(el2) {
        return isVisible(el2);
      });
    };
    __decorate$H([
      Autowired("loggerFactory")
    ], GridComp2.prototype, "loggerFactory", void 0);
    __decorate$H([
      RefSelector("gridBody")
    ], GridComp2.prototype, "gridBodyComp", void 0);
    __decorate$H([
      RefSelector("sideBar")
    ], GridComp2.prototype, "sideBarComp", void 0);
    __decorate$H([
      RefSelector("rootWrapperBody")
    ], GridComp2.prototype, "eRootWrapperBody", void 0);
    __decorate$H([
      PostConstruct
    ], GridComp2.prototype, "postConstruct", null);
    return GridComp2;
  }(TabGuardComp$1)
);
var __extends$F = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$G = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$8 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$7 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var SortController = (
  /** @class */
  function(_super) {
    __extends$F(SortController2, _super);
    function SortController2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    SortController_1 = SortController2;
    SortController2.prototype.progressSort = function(column, multiSort, source) {
      var nextDirection = this.getNextSortDirection(column);
      this.setSortForColumn(column, nextDirection, multiSort, source);
    };
    SortController2.prototype.setSortForColumn = function(column, sort, multiSort, source) {
      if (sort !== "asc" && sort !== "desc") {
        sort = null;
      }
      var isColumnsSortingCoupledToGroup = this.gridOptionsService.isColumnsSortingCoupledToGroup();
      var columnsToUpdate = [column];
      if (isColumnsSortingCoupledToGroup) {
        if (column.getColDef().showRowGroup) {
          var rowGroupColumns = this.columnModel.getSourceColumnsForGroupColumn(column);
          var sortableRowGroupColumns = rowGroupColumns === null || rowGroupColumns === void 0 ? void 0 : rowGroupColumns.filter(function(col) {
            return col.getColDef().sortable;
          });
          if (sortableRowGroupColumns) {
            columnsToUpdate = __spreadArray$7([column], __read$8(sortableRowGroupColumns));
          }
        }
      }
      columnsToUpdate.forEach(function(col) {
        return col.setSort(sort, source);
      });
      var doingMultiSort = (multiSort || this.gridOptionsService.is("alwaysMultiSort")) && !this.gridOptionsService.is("suppressMultiSort");
      if (!doingMultiSort) {
        this.clearSortBarTheseColumns(columnsToUpdate, source);
      }
      this.updateSortIndex(column);
      this.dispatchSortChangedEvents(source);
    };
    SortController2.prototype.updateSortIndex = function(lastColToChange) {
      var isCoupled = this.gridOptionsService.isColumnsSortingCoupledToGroup();
      var groupParent = this.columnModel.getGroupDisplayColumnForGroup(lastColToChange.getId());
      var lastSortIndexCol = isCoupled ? groupParent || lastColToChange : lastColToChange;
      var allSortedCols = this.getColumnsWithSortingOrdered();
      this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(function(col) {
        return col.setSortIndex(null);
      });
      var allSortedColsWithoutChanges = allSortedCols.filter(function(col) {
        return col !== lastSortIndexCol;
      });
      var sortedColsWithIndices = !!lastSortIndexCol.getSort() ? __spreadArray$7(__spreadArray$7([], __read$8(allSortedColsWithoutChanges)), [lastSortIndexCol]) : allSortedColsWithoutChanges;
      sortedColsWithIndices.forEach(function(col, idx) {
        return col.setSortIndex(idx);
      });
    };
    SortController2.prototype.onSortChanged = function(source) {
      this.dispatchSortChangedEvents(source);
    };
    SortController2.prototype.isSortActive = function() {
      var allCols = this.columnModel.getPrimaryAndSecondaryAndAutoColumns();
      var sortedCols = allCols.filter(function(column) {
        return !!column.getSort();
      });
      return sortedCols && sortedCols.length > 0;
    };
    SortController2.prototype.dispatchSortChangedEvents = function(source) {
      var event = {
        type: Events.EVENT_SORT_CHANGED,
        source
      };
      this.eventService.dispatchEvent(event);
    };
    SortController2.prototype.clearSortBarTheseColumns = function(columnsToSkip, source) {
      this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(function(columnToClear) {
        if (!columnsToSkip.includes(columnToClear)) {
          columnToClear.setSort(void 0, source);
        }
      });
    };
    SortController2.prototype.getNextSortDirection = function(column) {
      var sortingOrder;
      if (column.getColDef().sortingOrder) {
        sortingOrder = column.getColDef().sortingOrder;
      } else if (this.gridOptionsService.get("sortingOrder")) {
        sortingOrder = this.gridOptionsService.get("sortingOrder");
      } else {
        sortingOrder = SortController_1.DEFAULT_SORTING_ORDER;
      }
      if (!Array.isArray(sortingOrder) || sortingOrder.length <= 0) {
        console.warn("AG Grid: sortingOrder must be an array with at least one element, currently it's " + sortingOrder);
        return null;
      }
      var currentIndex = sortingOrder.indexOf(column.getSort());
      var notInArray = currentIndex < 0;
      var lastItemInArray = currentIndex == sortingOrder.length - 1;
      var result;
      if (notInArray || lastItemInArray) {
        result = sortingOrder[0];
      } else {
        result = sortingOrder[currentIndex + 1];
      }
      if (SortController_1.DEFAULT_SORTING_ORDER.indexOf(result) < 0) {
        console.warn("AG Grid: invalid sort type " + result);
        return null;
      }
      return result;
    };
    SortController2.prototype.getIndexedSortMap = function() {
      var _this = this;
      var allSortedCols = this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(function(col) {
        return !!col.getSort();
      });
      if (this.columnModel.isPivotMode()) {
        var isSortingLinked_1 = this.gridOptionsService.isColumnsSortingCoupledToGroup();
        allSortedCols = allSortedCols.filter(function(col) {
          var isAggregated = !!col.getAggFunc();
          var isSecondary = !col.isPrimary();
          var isGroup = isSortingLinked_1 ? _this.columnModel.getGroupDisplayColumnForGroup(col.getId()) : col.getColDef().showRowGroup;
          return isAggregated || isSecondary || isGroup;
        });
      }
      var sortedRowGroupCols = this.columnModel.getRowGroupColumns().filter(function(col) {
        return !!col.getSort();
      });
      var isSortLinked = this.gridOptionsService.isColumnsSortingCoupledToGroup() && !!sortedRowGroupCols.length;
      if (isSortLinked) {
        allSortedCols = __spreadArray$7([], __read$8(new Set(
          // if linked sorting, replace all columns with the display group column for index purposes, and ensure uniqueness
          allSortedCols.map(function(col) {
            var _a2;
            return (_a2 = _this.columnModel.getGroupDisplayColumnForGroup(col.getId())) !== null && _a2 !== void 0 ? _a2 : col;
          })
        )));
      }
      var allColsIndexes = {};
      allSortedCols.forEach(function(col, index2) {
        return allColsIndexes[col.getId()] = index2;
      });
      allSortedCols.sort(function(a, b) {
        var iA = a.getSortIndex();
        var iB = b.getSortIndex();
        if (iA != null && iB != null) {
          return iA - iB;
        } else if (iA == null && iB == null) {
          var posA = allColsIndexes[a.getId()];
          var posB = allColsIndexes[b.getId()];
          return posA > posB ? 1 : -1;
        } else if (iB == null) {
          return -1;
        } else {
          return 1;
        }
      });
      var indexMap = /* @__PURE__ */ new Map();
      allSortedCols.forEach(function(col, idx) {
        return indexMap.set(col, idx);
      });
      if (isSortLinked) {
        sortedRowGroupCols.forEach(function(col) {
          var groupDisplayCol = _this.columnModel.getGroupDisplayColumnForGroup(col.getId());
          indexMap.set(col, indexMap.get(groupDisplayCol));
        });
      }
      return indexMap;
    };
    SortController2.prototype.getColumnsWithSortingOrdered = function() {
      return __spreadArray$7([], __read$8(this.getIndexedSortMap().entries())).sort(function(_a2, _b2) {
        var _c = __read$8(_a2, 2);
        _c[0];
        var idx1 = _c[1];
        var _d = __read$8(_b2, 2);
        _d[0];
        var idx2 = _d[1];
        return idx1 - idx2;
      }).map(function(_a2) {
        var _b2 = __read$8(_a2, 1), col = _b2[0];
        return col;
      });
    };
    SortController2.prototype.getSortModel = function() {
      return this.getColumnsWithSortingOrdered().map(function(column) {
        return {
          sort: column.getSort(),
          colId: column.getId()
        };
      });
    };
    SortController2.prototype.getSortOptions = function() {
      return this.getColumnsWithSortingOrdered().map(function(column) {
        return {
          sort: column.getSort(),
          column
        };
      });
    };
    SortController2.prototype.canColumnDisplayMixedSort = function(column) {
      var isColumnSortCouplingActive = this.gridOptionsService.isColumnsSortingCoupledToGroup();
      var isGroupDisplayColumn = !!column.getColDef().showRowGroup;
      return isColumnSortCouplingActive && isGroupDisplayColumn;
    };
    SortController2.prototype.getDisplaySortForColumn = function(column) {
      var linkedColumns = this.columnModel.getSourceColumnsForGroupColumn(column);
      if (!this.canColumnDisplayMixedSort(column) || !(linkedColumns === null || linkedColumns === void 0 ? void 0 : linkedColumns.length)) {
        return column.getSort();
      }
      var columnHasUniqueData = !!column.getColDef().field;
      var sortableColumns = columnHasUniqueData ? __spreadArray$7([column], __read$8(linkedColumns)) : linkedColumns;
      var firstSort = sortableColumns[0].getSort();
      var allMatch = sortableColumns.every(function(col) {
        return col.getSort() == firstSort;
      });
      if (!allMatch) {
        return "mixed";
      }
      return firstSort;
    };
    SortController2.prototype.getDisplaySortIndexForColumn = function(column) {
      return this.getIndexedSortMap().get(column);
    };
    var SortController_1;
    SortController2.DEFAULT_SORTING_ORDER = ["asc", "desc", null];
    __decorate$G([
      Autowired("columnModel")
    ], SortController2.prototype, "columnModel", void 0);
    SortController2 = SortController_1 = __decorate$G([
      Bean("sortController")
    ], SortController2);
    return SortController2;
  }(BeanStub)
);
var __extends$E = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$F = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ColumnHoverService = (
  /** @class */
  function(_super) {
    __extends$E(ColumnHoverService2, _super);
    function ColumnHoverService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ColumnHoverService2.prototype.setMouseOver = function(columns) {
      this.selectedColumns = columns;
      var event = {
        type: Events.EVENT_COLUMN_HOVER_CHANGED
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnHoverService2.prototype.clearMouseOver = function() {
      this.selectedColumns = null;
      var event = {
        type: Events.EVENT_COLUMN_HOVER_CHANGED
      };
      this.eventService.dispatchEvent(event);
    };
    ColumnHoverService2.prototype.isHovered = function(column) {
      return !!this.selectedColumns && this.selectedColumns.indexOf(column) >= 0;
    };
    ColumnHoverService2 = __decorate$F([
      Bean("columnHoverService")
    ], ColumnHoverService2);
    return ColumnHoverService2;
  }(BeanStub)
);
var __extends$D = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$E = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ColumnAnimationService = (
  /** @class */
  function(_super) {
    __extends$D(ColumnAnimationService2, _super);
    function ColumnAnimationService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.executeNextFuncs = [];
      _this.executeLaterFuncs = [];
      _this.active = false;
      _this.animationThreadCount = 0;
      return _this;
    }
    ColumnAnimationService2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function(p2) {
        return _this.gridBodyCtrl = p2.gridBodyCtrl;
      });
    };
    ColumnAnimationService2.prototype.isActive = function() {
      return this.active;
    };
    ColumnAnimationService2.prototype.start = function() {
      if (this.active) {
        return;
      }
      if (this.gridOptionsService.is("suppressColumnMoveAnimation")) {
        return;
      }
      if (this.gridOptionsService.is("enableRtl")) {
        return;
      }
      this.ensureAnimationCssClassPresent();
      this.active = true;
    };
    ColumnAnimationService2.prototype.finish = function() {
      if (!this.active) {
        return;
      }
      this.flush();
      this.active = false;
    };
    ColumnAnimationService2.prototype.executeNextVMTurn = function(func) {
      if (this.active) {
        this.executeNextFuncs.push(func);
      } else {
        func();
      }
    };
    ColumnAnimationService2.prototype.executeLaterVMTurn = function(func) {
      if (this.active) {
        this.executeLaterFuncs.push(func);
      } else {
        func();
      }
    };
    ColumnAnimationService2.prototype.ensureAnimationCssClassPresent = function() {
      var _this = this;
      this.animationThreadCount++;
      var animationThreadCountCopy = this.animationThreadCount;
      this.gridBodyCtrl.setColumnMovingCss(true);
      this.executeLaterFuncs.push(function() {
        if (_this.animationThreadCount === animationThreadCountCopy) {
          _this.gridBodyCtrl.setColumnMovingCss(false);
        }
      });
    };
    ColumnAnimationService2.prototype.flush = function() {
      var nowFuncs = this.executeNextFuncs;
      this.executeNextFuncs = [];
      var waitFuncs = this.executeLaterFuncs;
      this.executeLaterFuncs = [];
      if (nowFuncs.length === 0 && waitFuncs.length === 0) {
        return;
      }
      window.setTimeout(function() {
        return nowFuncs.forEach(function(func) {
          return func();
        });
      }, 0);
      window.setTimeout(function() {
        return waitFuncs.forEach(function(func) {
          return func();
        });
      }, 300);
    };
    __decorate$E([
      Autowired("ctrlsService")
    ], ColumnAnimationService2.prototype, "ctrlsService", void 0);
    __decorate$E([
      PostConstruct
    ], ColumnAnimationService2.prototype, "postConstruct", null);
    ColumnAnimationService2 = __decorate$E([
      Bean("columnAnimationService")
    ], ColumnAnimationService2);
    return ColumnAnimationService2;
  }(BeanStub)
);
var __extends$C = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$D = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var PaginationAutoPageSizeService = (
  /** @class */
  function(_super) {
    __extends$C(PaginationAutoPageSizeService2, _super);
    function PaginationAutoPageSizeService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    PaginationAutoPageSizeService2.prototype.postConstruct = function() {
      var _this = this;
      this.ctrlsService.whenReady(function(p2) {
        _this.centerRowContainerCon = p2.centerRowContainerCtrl;
        _this.addManagedListener(_this.eventService, Events.EVENT_BODY_HEIGHT_CHANGED, _this.checkPageSize.bind(_this));
        _this.addManagedListener(_this.eventService, Events.EVENT_SCROLL_VISIBILITY_CHANGED, _this.checkPageSize.bind(_this));
        _this.checkPageSize();
      });
    };
    PaginationAutoPageSizeService2.prototype.notActive = function() {
      return !this.gridOptionsService.is("paginationAutoPageSize") || this.centerRowContainerCon == null;
    };
    PaginationAutoPageSizeService2.prototype.checkPageSize = function() {
      var _this = this;
      if (this.notActive()) {
        return;
      }
      var bodyHeight = this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();
      if (bodyHeight > 0) {
        var update_1 = function() {
          var rowHeight = _this.gridOptionsService.getRowHeightAsNumber();
          var newPageSize = Math.floor(bodyHeight / rowHeight);
          _this.gridOptionsService.set("paginationPageSize", newPageSize);
        };
        if (!this.isBodyRendered) {
          update_1();
          this.isBodyRendered = true;
        } else {
          debounce$1(function() {
            return update_1();
          }, 50)();
        }
      } else {
        this.isBodyRendered = false;
      }
    };
    __decorate$D([
      Autowired("ctrlsService")
    ], PaginationAutoPageSizeService2.prototype, "ctrlsService", void 0);
    __decorate$D([
      PostConstruct
    ], PaginationAutoPageSizeService2.prototype, "postConstruct", null);
    PaginationAutoPageSizeService2 = __decorate$D([
      Bean("paginationAutoPageSizeService")
    ], PaginationAutoPageSizeService2);
    return PaginationAutoPageSizeService2;
  }(BeanStub)
);
var __extends$B = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$C = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ValueCache = (
  /** @class */
  function(_super) {
    __extends$B(ValueCache2, _super);
    function ValueCache2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.cacheVersion = 0;
      return _this;
    }
    ValueCache2.prototype.init = function() {
      this.active = this.gridOptionsService.is("valueCache");
      this.neverExpires = this.gridOptionsService.is("valueCacheNeverExpires");
    };
    ValueCache2.prototype.onDataChanged = function() {
      if (this.neverExpires) {
        return;
      }
      this.expire();
    };
    ValueCache2.prototype.expire = function() {
      this.cacheVersion++;
    };
    ValueCache2.prototype.setValue = function(rowNode, colId, value) {
      if (this.active) {
        if (rowNode.__cacheVersion !== this.cacheVersion) {
          rowNode.__cacheVersion = this.cacheVersion;
          rowNode.__cacheData = {};
        }
        rowNode.__cacheData[colId] = value;
      }
    };
    ValueCache2.prototype.getValue = function(rowNode, colId) {
      if (!this.active || rowNode.__cacheVersion !== this.cacheVersion) {
        return void 0;
      }
      return rowNode.__cacheData[colId];
    };
    __decorate$C([
      PostConstruct
    ], ValueCache2.prototype, "init", null);
    ValueCache2 = __decorate$C([
      Bean("valueCache")
    ], ValueCache2);
    return ValueCache2;
  }(BeanStub)
);
var __extends$A = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$B = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SOURCE_PASTE = "paste";
var ChangeDetectionService = (
  /** @class */
  function(_super) {
    __extends$A(ChangeDetectionService2, _super);
    function ChangeDetectionService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ChangeDetectionService2.prototype.init = function() {
      if (this.rowModel.getType() === "clientSide") {
        this.clientSideRowModel = this.rowModel;
      }
      this.addManagedListener(this.eventService, Events.EVENT_CELL_VALUE_CHANGED, this.onCellValueChanged.bind(this));
    };
    ChangeDetectionService2.prototype.onCellValueChanged = function(event) {
      if (event.source === SOURCE_PASTE) {
        return;
      }
      this.doChangeDetection(event.node, event.column);
    };
    ChangeDetectionService2.prototype.doChangeDetection = function(rowNode, column) {
      if (this.gridOptionsService.is("suppressChangeDetection")) {
        return;
      }
      var nodesToRefresh = [rowNode];
      if (this.clientSideRowModel && !rowNode.isRowPinned()) {
        var onlyChangedColumns = this.gridOptionsService.is("aggregateOnlyChangedColumns");
        var changedPath = new ChangedPath(onlyChangedColumns, this.clientSideRowModel.getRootNode());
        changedPath.addParentNode(rowNode.parent, [column]);
        this.clientSideRowModel.doAggregate(changedPath);
        changedPath.forEachChangedNodeDepthFirst(function(rowNode2) {
          nodesToRefresh.push(rowNode2);
        });
      }
      this.rowRenderer.refreshCells({ rowNodes: nodesToRefresh });
    };
    __decorate$B([
      Autowired("rowModel")
    ], ChangeDetectionService2.prototype, "rowModel", void 0);
    __decorate$B([
      Autowired("rowRenderer")
    ], ChangeDetectionService2.prototype, "rowRenderer", void 0);
    __decorate$B([
      PostConstruct
    ], ChangeDetectionService2.prototype, "init", null);
    ChangeDetectionService2 = __decorate$B([
      Bean("changeDetectionService")
    ], ChangeDetectionService2);
    return ChangeDetectionService2;
  }(BeanStub)
);
var __extends$z = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$A = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AgComponentUtils = (
  /** @class */
  function(_super) {
    __extends$z(AgComponentUtils2, _super);
    function AgComponentUtils2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    AgComponentUtils2.prototype.adaptFunction = function(propertyName, jsCompFunc) {
      var metadata = this.componentMetadataProvider.retrieve(propertyName);
      if (metadata && metadata.functionAdapter) {
        return metadata.functionAdapter(jsCompFunc);
      }
      return null;
    };
    AgComponentUtils2.prototype.adaptCellRendererFunction = function(callback2) {
      var Adapter = (
        /** @class */
        function() {
          function Adapter2() {
          }
          Adapter2.prototype.refresh = function(params) {
            return false;
          };
          Adapter2.prototype.getGui = function() {
            return this.eGui;
          };
          Adapter2.prototype.init = function(params) {
            var callbackResult = callback2(params);
            var type = typeof callbackResult;
            if (type === "string" || type === "number" || type === "boolean") {
              this.eGui = loadTemplate("<span>" + callbackResult + "</span>");
              return;
            }
            if (callbackResult == null) {
              this.eGui = loadTemplate("<span></span>");
              return;
            }
            this.eGui = callbackResult;
          };
          return Adapter2;
        }()
      );
      return Adapter;
    };
    AgComponentUtils2.prototype.doesImplementIComponent = function(candidate) {
      if (!candidate) {
        return false;
      }
      return candidate.prototype && "getGui" in candidate.prototype;
    };
    __decorate$A([
      Autowired("componentMetadataProvider")
    ], AgComponentUtils2.prototype, "componentMetadataProvider", void 0);
    AgComponentUtils2 = __decorate$A([
      Bean("agComponentUtils")
    ], AgComponentUtils2);
    return AgComponentUtils2;
  }(BeanStub)
);
var __extends$y = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$z = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ComponentMetadataProvider = (
  /** @class */
  function(_super) {
    __extends$y(ComponentMetadataProvider2, _super);
    function ComponentMetadataProvider2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ComponentMetadataProvider2.prototype.postConstruct = function() {
      this.componentMetaData = {
        dateComponent: {
          mandatoryMethodList: ["getDate", "setDate"],
          optionalMethodList: ["afterGuiAttached", "setInputPlaceholder", "setInputAriaLabel"]
        },
        detailCellRenderer: {
          mandatoryMethodList: [],
          optionalMethodList: ["refresh"],
          functionAdapter: this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)
        },
        headerComponent: {
          mandatoryMethodList: [],
          optionalMethodList: ["refresh"]
        },
        headerGroupComponent: {
          mandatoryMethodList: [],
          optionalMethodList: []
        },
        loadingCellRenderer: {
          mandatoryMethodList: [],
          optionalMethodList: []
        },
        loadingOverlayComponent: {
          mandatoryMethodList: [],
          optionalMethodList: []
        },
        noRowsOverlayComponent: {
          mandatoryMethodList: [],
          optionalMethodList: []
        },
        floatingFilterComponent: {
          mandatoryMethodList: ["onParentModelChanged"],
          optionalMethodList: ["afterGuiAttached"]
        },
        floatingFilterWrapperComponent: {
          mandatoryMethodList: [],
          optionalMethodList: []
        },
        cellRenderer: {
          mandatoryMethodList: [],
          optionalMethodList: ["refresh", "afterGuiAttached"],
          functionAdapter: this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)
        },
        cellEditor: {
          mandatoryMethodList: ["getValue"],
          optionalMethodList: ["isPopup", "isCancelBeforeStart", "isCancelAfterEnd", "getPopupPosition", "focusIn", "focusOut", "afterGuiAttached"]
        },
        innerRenderer: {
          mandatoryMethodList: [],
          optionalMethodList: ["afterGuiAttached"],
          functionAdapter: this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)
        },
        fullWidthCellRenderer: {
          mandatoryMethodList: [],
          optionalMethodList: ["refresh", "afterGuiAttached"],
          functionAdapter: this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)
        },
        groupRowRenderer: {
          mandatoryMethodList: [],
          optionalMethodList: ["afterGuiAttached"],
          functionAdapter: this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)
        },
        filter: {
          mandatoryMethodList: ["isFilterActive", "doesFilterPass", "getModel", "setModel"],
          optionalMethodList: ["afterGuiAttached", "afterGuiDetached", "onNewRowsLoaded", "getModelAsString", "onFloatingFilterChanged", "onAnyFilterChanged"]
        },
        filterComponent: {
          mandatoryMethodList: ["isFilterActive", "doesFilterPass", "getModel", "setModel"],
          optionalMethodList: ["afterGuiAttached", "afterGuiDetached", "onNewRowsLoaded", "getModelAsString", "onFloatingFilterChanged", "onAnyFilterChanged"]
        },
        statusPanel: {
          mandatoryMethodList: [],
          optionalMethodList: ["afterGuiAttached"]
        },
        toolPanel: {
          mandatoryMethodList: [],
          optionalMethodList: ["refresh", "afterGuiAttached"]
        },
        tooltipComponent: {
          mandatoryMethodList: [],
          optionalMethodList: []
        }
      };
    };
    ComponentMetadataProvider2.prototype.retrieve = function(name) {
      return this.componentMetaData[name];
    };
    __decorate$z([
      Autowired("agComponentUtils")
    ], ComponentMetadataProvider2.prototype, "agComponentUtils", void 0);
    __decorate$z([
      PostConstruct
    ], ComponentMetadataProvider2.prototype, "postConstruct", null);
    ComponentMetadataProvider2 = __decorate$z([
      Bean("componentMetadataProvider")
    ], ComponentMetadataProvider2);
    return ComponentMetadataProvider2;
  }(BeanStub)
);
var __extends$x = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$y = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$7 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$6 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var DEFAULT_ROW_HEIGHT = 25;
var MIN_COL_WIDTH = 10;
var MAT_GRID_SIZE = 8;
var BASE_GRID_SIZE = 4;
var BALHAM_GRID_SIZE = 4;
var ALPINE_GRID_SIZE = 6;
var HARD_CODED_SIZES = {
  // this item is required for custom themes
  "ag-theme-custom": {
    headerHeight: 25,
    headerCellMinWidth: 24,
    listItemHeight: BASE_GRID_SIZE * 5,
    rowHeight: 25,
    chartMenuPanelWidth: 220
  },
  "ag-theme-material": {
    headerHeight: MAT_GRID_SIZE * 7,
    headerCellMinWidth: 48,
    listItemHeight: MAT_GRID_SIZE * 4,
    rowHeight: MAT_GRID_SIZE * 6,
    chartMenuPanelWidth: 240
  },
  "ag-theme-balham": {
    headerHeight: BALHAM_GRID_SIZE * 8,
    headerCellMinWidth: 24,
    listItemHeight: BALHAM_GRID_SIZE * 6,
    rowHeight: BALHAM_GRID_SIZE * 7,
    chartMenuPanelWidth: 220
  },
  "ag-theme-alpine": {
    headerHeight: ALPINE_GRID_SIZE * 8,
    headerCellMinWidth: 36,
    listItemHeight: ALPINE_GRID_SIZE * 4,
    rowHeight: ALPINE_GRID_SIZE * 7,
    chartMenuPanelWidth: 240
  }
};
var SASS_PROPERTY_BUILDER = {
  headerHeight: ["ag-header-row"],
  headerCellMinWidth: ["ag-header-cell"],
  listItemHeight: ["ag-virtual-list-item"],
  rowHeight: ["ag-row"],
  chartMenuPanelWidth: ["ag-chart-docked-container"]
};
var Environment = (
  /** @class */
  function(_super) {
    __extends$x(Environment2, _super);
    function Environment2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.calculatedSizes = {};
      return _this;
    }
    Environment2.prototype.postConstruct = function() {
      var _this = this;
      var _a2;
      var el2 = (_a2 = this.getTheme().el) !== null && _a2 !== void 0 ? _a2 : this.eGridDiv;
      this.mutationObserver = new MutationObserver(function() {
        _this.calculatedSizes = {};
        _this.fireGridStylesChangedEvent();
      });
      this.mutationObserver.observe(el2 || this.eGridDiv, {
        attributes: true,
        attributeFilter: ["class"]
      });
    };
    Environment2.prototype.fireGridStylesChangedEvent = function() {
      var event = {
        type: Events.EVENT_GRID_STYLES_CHANGED
      };
      this.eventService.dispatchEvent(event);
    };
    Environment2.prototype.getSassVariable = function(key) {
      var _a2 = this.getTheme(), themeFamily = _a2.themeFamily, el2 = _a2.el;
      if (!themeFamily || themeFamily.indexOf("ag-theme") !== 0) {
        return;
      }
      if (!this.calculatedSizes) {
        this.calculatedSizes = {};
      }
      if (!this.calculatedSizes[themeFamily]) {
        this.calculatedSizes[themeFamily] = {};
      }
      var size = this.calculatedSizes[themeFamily][key];
      if (size != null) {
        return size;
      }
      this.calculatedSizes[themeFamily][key] = this.calculateValueForSassProperty(key, themeFamily, el2);
      return this.calculatedSizes[themeFamily][key];
    };
    Environment2.prototype.calculateValueForSassProperty = function(property, theme3, themeElement) {
      var _a2;
      var useTheme = "ag-theme-" + (theme3.match("material") ? "material" : theme3.match("balham") ? "balham" : theme3.match("alpine") ? "alpine" : "custom");
      var defaultValue = HARD_CODED_SIZES[useTheme][property];
      var eDocument = this.gridOptionsService.getDocument();
      if (!themeElement) {
        themeElement = this.eGridDiv;
      }
      if (!SASS_PROPERTY_BUILDER[property]) {
        return defaultValue;
      }
      var classList = SASS_PROPERTY_BUILDER[property];
      var div = eDocument.createElement("div");
      var classesFromThemeElement = Array.from(themeElement.classList);
      (_a2 = div.classList).add.apply(_a2, __spreadArray$6([theme3], __read$7(classesFromThemeElement)));
      div.style.position = "absolute";
      var el2 = classList.reduce(function(prevEl, currentClass) {
        var currentDiv = eDocument.createElement("div");
        currentDiv.style.position = "static";
        currentDiv.classList.add(currentClass);
        prevEl.appendChild(currentDiv);
        return currentDiv;
      }, div);
      var calculatedValue = 0;
      if (eDocument.body) {
        eDocument.body.appendChild(div);
        var sizeName = property.toLowerCase().indexOf("height") !== -1 ? "height" : "width";
        calculatedValue = parseInt(window.getComputedStyle(el2)[sizeName], 10);
        eDocument.body.removeChild(div);
      }
      return calculatedValue || defaultValue;
    };
    Environment2.prototype.isThemeDark = function() {
      var theme3 = this.getTheme().theme;
      return !!theme3 && theme3.indexOf("dark") >= 0;
    };
    Environment2.prototype.chartMenuPanelWidth = function() {
      return this.getSassVariable("chartMenuPanelWidth");
    };
    Environment2.prototype.getTheme = function() {
      var reg = /\bag-(material|(?:theme-([\w\-]*)))\b/g;
      var el2 = this.eGridDiv;
      var themeMatch = null;
      var allThemes = [];
      while (el2) {
        themeMatch = reg.exec(el2.className);
        if (!themeMatch) {
          el2 = el2.parentElement || void 0;
        } else {
          var matched = el2.className.match(reg);
          if (matched) {
            allThemes = matched;
          }
          break;
        }
      }
      if (!themeMatch) {
        return { allThemes };
      }
      var theme3 = themeMatch[0];
      return { theme: theme3, el: el2, themeFamily: theme3.replace(/-dark$/, ""), allThemes };
    };
    Environment2.prototype.getFromTheme = function(defaultValue, sassVariableName) {
      var _a2;
      return (_a2 = this.getSassVariable(sassVariableName)) !== null && _a2 !== void 0 ? _a2 : defaultValue;
    };
    Environment2.prototype.getDefaultRowHeight = function() {
      return this.getFromTheme(DEFAULT_ROW_HEIGHT, "rowHeight");
    };
    Environment2.prototype.getListItemHeight = function() {
      return this.getFromTheme(20, "listItemHeight");
    };
    Environment2.prototype.setRowHeightVariable = function(height) {
      var oldRowHeight = this.eGridDiv.style.getPropertyValue("--ag-line-height").trim();
      var newRowHeight = height + "px";
      if (oldRowHeight != newRowHeight) {
        this.eGridDiv.style.setProperty("--ag-line-height", newRowHeight);
      }
    };
    Environment2.prototype.getMinColWidth = function() {
      var measuredMin = this.getFromTheme(null, "headerCellMinWidth");
      return exists(measuredMin) ? Math.max(measuredMin, MIN_COL_WIDTH) : MIN_COL_WIDTH;
    };
    Environment2.prototype.destroy = function() {
      this.calculatedSizes = null;
      if (this.mutationObserver) {
        this.mutationObserver.disconnect();
      }
      _super.prototype.destroy.call(this);
    };
    __decorate$y([
      Autowired("eGridDiv")
    ], Environment2.prototype, "eGridDiv", void 0);
    __decorate$y([
      PostConstruct
    ], Environment2.prototype, "postConstruct", null);
    Environment2 = __decorate$y([
      Bean("environment")
    ], Environment2);
    return Environment2;
  }(BeanStub)
);
var __extends$w = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$x = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$2 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var RowContainerHeightService = (
  /** @class */
  function(_super) {
    __extends$w(RowContainerHeightService2, _super);
    function RowContainerHeightService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.scrollY = 0;
      _this.uiBodyHeight = 0;
      return _this;
    }
    RowContainerHeightService2.prototype.agWire = function(loggerFactory) {
      this.logger = loggerFactory.create("RowContainerHeightService");
    };
    RowContainerHeightService2.prototype.postConstruct = function() {
      this.addManagedListener(this.eventService, Events.EVENT_BODY_HEIGHT_CHANGED, this.updateOffset.bind(this));
      this.maxDivHeight = getMaxDivHeight();
      this.logger.log("maxDivHeight = " + this.maxDivHeight);
    };
    RowContainerHeightService2.prototype.isStretching = function() {
      return this.stretching;
    };
    RowContainerHeightService2.prototype.getDivStretchOffset = function() {
      return this.divStretchOffset;
    };
    RowContainerHeightService2.prototype.updateOffset = function() {
      if (!this.stretching) {
        return;
      }
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      var newScrollY = gridBodyCon.getScrollFeature().getVScrollPosition().top;
      var newBodyHeight = this.getUiBodyHeight();
      var atLeastOneChanged = newScrollY !== this.scrollY || newBodyHeight !== this.uiBodyHeight;
      if (atLeastOneChanged) {
        this.scrollY = newScrollY;
        this.uiBodyHeight = newBodyHeight;
        this.calculateOffset();
      }
    };
    RowContainerHeightService2.prototype.calculateOffset = function() {
      this.setUiContainerHeight(this.maxDivHeight);
      this.pixelsToShave = this.modelHeight - this.uiContainerHeight;
      this.maxScrollY = this.uiContainerHeight - this.uiBodyHeight;
      var scrollPercent = this.scrollY / this.maxScrollY;
      var divStretchOffset = scrollPercent * this.pixelsToShave;
      this.logger.log("Div Stretch Offset = " + divStretchOffset + " (" + this.pixelsToShave + " * " + scrollPercent + ")");
      this.setDivStretchOffset(divStretchOffset);
    };
    RowContainerHeightService2.prototype.setUiContainerHeight = function(height) {
      if (height !== this.uiContainerHeight) {
        this.uiContainerHeight = height;
        this.eventService.dispatchEvent({ type: Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED });
      }
    };
    RowContainerHeightService2.prototype.clearOffset = function() {
      this.setUiContainerHeight(this.modelHeight);
      this.pixelsToShave = 0;
      this.setDivStretchOffset(0);
    };
    RowContainerHeightService2.prototype.setDivStretchOffset = function(newOffset) {
      var newOffsetFloor = typeof newOffset === "number" ? Math.floor(newOffset) : null;
      if (this.divStretchOffset === newOffsetFloor) {
        return;
      }
      this.divStretchOffset = newOffsetFloor;
      this.eventService.dispatchEvent({ type: Events.EVENT_HEIGHT_SCALE_CHANGED });
    };
    RowContainerHeightService2.prototype.setModelHeight = function(modelHeight) {
      this.modelHeight = modelHeight;
      this.stretching = modelHeight != null && this.maxDivHeight > 0 && modelHeight > this.maxDivHeight;
      if (this.stretching) {
        this.calculateOffset();
      } else {
        this.clearOffset();
      }
    };
    RowContainerHeightService2.prototype.getUiContainerHeight = function() {
      return this.uiContainerHeight;
    };
    RowContainerHeightService2.prototype.getRealPixelPosition = function(modelPixel) {
      return modelPixel - this.divStretchOffset;
    };
    RowContainerHeightService2.prototype.getUiBodyHeight = function() {
      var gridBodyCon = this.ctrlsService.getGridBodyCtrl();
      var pos = gridBodyCon.getScrollFeature().getVScrollPosition();
      return pos.bottom - pos.top;
    };
    RowContainerHeightService2.prototype.getScrollPositionForPixel = function(rowTop) {
      if (this.pixelsToShave <= 0) {
        return rowTop;
      }
      var modelMaxScroll = this.modelHeight - this.getUiBodyHeight();
      var scrollPercent = rowTop / modelMaxScroll;
      var scrollPixel = this.maxScrollY * scrollPercent;
      return scrollPixel;
    };
    __decorate$x([
      Autowired("ctrlsService")
    ], RowContainerHeightService2.prototype, "ctrlsService", void 0);
    __decorate$x([
      __param$2(0, Qualifier("loggerFactory"))
    ], RowContainerHeightService2.prototype, "agWire", null);
    __decorate$x([
      PostConstruct
    ], RowContainerHeightService2.prototype, "postConstruct", null);
    RowContainerHeightService2 = __decorate$x([
      Bean("rowContainerHeightService")
    ], RowContainerHeightService2);
    return RowContainerHeightService2;
  }(BeanStub)
);
var __extends$v = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$w = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SelectableService = (
  /** @class */
  function(_super) {
    __extends$v(SelectableService2, _super);
    function SelectableService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    SelectableService2.prototype.init = function() {
      this.groupSelectsChildren = this.gridOptionsService.is("groupSelectsChildren");
      this.isRowSelectableFunc = this.gridOptionsService.get("isRowSelectable");
    };
    SelectableService2.prototype.updateSelectableAfterGrouping = function(rowNode) {
      if (this.isRowSelectableFunc) {
        var nextChildrenFunc = function(node) {
          return node.childrenAfterGroup;
        };
        this.recurseDown(rowNode.childrenAfterGroup, nextChildrenFunc);
      }
    };
    SelectableService2.prototype.recurseDown = function(children, nextChildrenFunc) {
      var _this = this;
      if (!children) {
        return;
      }
      children.forEach(function(child) {
        if (!child.group) {
          return;
        }
        if (child.hasChildren()) {
          _this.recurseDown(nextChildrenFunc(child), nextChildrenFunc);
        }
        var rowSelectable;
        if (_this.groupSelectsChildren) {
          var firstSelectable = (nextChildrenFunc(child) || []).find(function(rowNode) {
            return rowNode.selectable === true;
          });
          rowSelectable = exists(firstSelectable);
        } else {
          rowSelectable = _this.isRowSelectableFunc ? _this.isRowSelectableFunc(child) : false;
        }
        child.setRowSelectable(rowSelectable);
      });
    };
    __decorate$w([
      PostConstruct
    ], SelectableService2.prototype, "init", null);
    SelectableService2 = __decorate$w([
      Bean("selectableService")
    ], SelectableService2);
    return SelectableService2;
  }(BeanStub)
);
var __extends$u = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$v = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var PaginationComp = (
  /** @class */
  function(_super) {
    __extends$u(PaginationComp2, _super);
    function PaginationComp2() {
      var _this = _super.call(this) || this;
      _this.previousAndFirstButtonsDisabled = false;
      _this.nextButtonDisabled = false;
      _this.lastButtonDisabled = false;
      _this.areListenersSetup = false;
      return _this;
    }
    PaginationComp2.prototype.postConstruct = function() {
      var isRtl = this.gridOptionsService.is("enableRtl");
      this.setTemplate(this.getTemplate());
      var _a2 = this, btFirst = _a2.btFirst, btPrevious = _a2.btPrevious, btNext = _a2.btNext, btLast = _a2.btLast;
      this.activateTabIndex([btFirst, btPrevious, btNext, btLast]);
      btFirst.insertAdjacentElement("afterbegin", createIconNoSpan(isRtl ? "last" : "first", this.gridOptionsService));
      btPrevious.insertAdjacentElement("afterbegin", createIconNoSpan(isRtl ? "next" : "previous", this.gridOptionsService));
      btNext.insertAdjacentElement("afterbegin", createIconNoSpan(isRtl ? "previous" : "next", this.gridOptionsService));
      btLast.insertAdjacentElement("afterbegin", createIconNoSpan(isRtl ? "first" : "last", this.gridOptionsService));
      this.addManagedPropertyListener("pagination", this.onPaginationChanged.bind(this));
      this.addManagedPropertyListener("suppressPaginationPanel", this.onPaginationChanged.bind(this));
      this.onPaginationChanged();
    };
    PaginationComp2.prototype.onPaginationChanged = function() {
      var isPaging = this.gridOptionsService.is("pagination");
      var paginationPanelEnabled = isPaging && !this.gridOptionsService.is("suppressPaginationPanel");
      this.setDisplayed(paginationPanelEnabled);
      if (!paginationPanelEnabled) {
        return;
      }
      this.setupListeners();
      this.enableOrDisableButtons();
      this.updateRowLabels();
      this.setCurrentPageLabel();
      this.setTotalLabels();
    };
    PaginationComp2.prototype.setupListeners = function() {
      var _this = this;
      if (!this.areListenersSetup) {
        this.addManagedListener(this.eventService, Events.EVENT_PAGINATION_CHANGED, this.onPaginationChanged.bind(this));
        [
          { el: this.btFirst, fn: this.onBtFirst.bind(this) },
          { el: this.btPrevious, fn: this.onBtPrevious.bind(this) },
          { el: this.btNext, fn: this.onBtNext.bind(this) },
          { el: this.btLast, fn: this.onBtLast.bind(this) }
        ].forEach(function(item) {
          var el2 = item.el, fn = item.fn;
          _this.addManagedListener(el2, "click", fn);
          _this.addManagedListener(el2, "keydown", function(e) {
            if (e.key === KeyCode.ENTER || e.key === KeyCode.SPACE) {
              e.preventDefault();
              fn();
            }
          });
        });
        this.areListenersSetup = true;
      }
    };
    PaginationComp2.prototype.onBtFirst = function() {
      if (!this.previousAndFirstButtonsDisabled) {
        this.paginationProxy.goToFirstPage();
      }
    };
    PaginationComp2.prototype.setCurrentPageLabel = function() {
      var pagesExist = this.paginationProxy.getTotalPages() > 0;
      var currentPage = this.paginationProxy.getCurrentPage();
      var toDisplay = pagesExist ? currentPage + 1 : 0;
      this.lbCurrent.innerHTML = this.formatNumber(toDisplay);
    };
    PaginationComp2.prototype.formatNumber = function(value) {
      var userFunc = this.gridOptionsService.getCallback("paginationNumberFormatter");
      if (userFunc) {
        var params = { value };
        return userFunc(params);
      }
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      var thousandSeparator = localeTextFunc("thousandSeparator", ",");
      var decimalSeparator = localeTextFunc("decimalSeparator", ".");
      return formatNumberCommas(value, thousandSeparator, decimalSeparator);
    };
    PaginationComp2.prototype.getTemplate = function() {
      var localeTextFunc = this.localeService.getLocaleTextFunc();
      var strPage = localeTextFunc("page", "Page");
      var strTo = localeTextFunc("to", "to");
      var strOf = localeTextFunc("of", "of");
      var strFirst = localeTextFunc("firstPage", "First Page");
      var strPrevious = localeTextFunc("previousPage", "Previous Page");
      var strNext = localeTextFunc("nextPage", "Next Page");
      var strLast = localeTextFunc("lastPage", "Last Page");
      var compId = this.getCompId();
      return (
        /* html */
        '<div class="ag-paging-panel ag-unselectable" id="ag-' + compId + '">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-' + compId + '-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-' + compId + '-to">' + strTo + '</span>\n                    <span id="ag-' + compId + '-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-' + compId + '-of">' + strOf + '</span>\n                    <span id="ag-' + compId + '-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="' + strFirst + '"></div>\n                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="' + strPrevious + '"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-' + compId + '-start-page">' + strPage + '</span>\n                        <span id="ag-' + compId + '-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-' + compId + '-of-page">' + strOf + '</span>\n                        <span id="ag-' + compId + '-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="' + strNext + '"></div>\n                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="' + strLast + '"></div>\n                </span>\n            </div>'
      );
    };
    PaginationComp2.prototype.onBtNext = function() {
      if (!this.nextButtonDisabled) {
        this.paginationProxy.goToNextPage();
      }
    };
    PaginationComp2.prototype.onBtPrevious = function() {
      if (!this.previousAndFirstButtonsDisabled) {
        this.paginationProxy.goToPreviousPage();
      }
    };
    PaginationComp2.prototype.onBtLast = function() {
      if (!this.lastButtonDisabled) {
        this.paginationProxy.goToLastPage();
      }
    };
    PaginationComp2.prototype.enableOrDisableButtons = function() {
      var currentPage = this.paginationProxy.getCurrentPage();
      var maxRowFound = this.paginationProxy.isLastPageFound();
      var totalPages = this.paginationProxy.getTotalPages();
      this.previousAndFirstButtonsDisabled = currentPage === 0;
      this.toggleButtonDisabled(this.btFirst, this.previousAndFirstButtonsDisabled);
      this.toggleButtonDisabled(this.btPrevious, this.previousAndFirstButtonsDisabled);
      var zeroPagesToDisplay = this.isZeroPagesToDisplay();
      var onLastPage = maxRowFound && currentPage === totalPages - 1;
      this.nextButtonDisabled = onLastPage || zeroPagesToDisplay;
      this.lastButtonDisabled = !maxRowFound || zeroPagesToDisplay || currentPage === totalPages - 1;
      this.toggleButtonDisabled(this.btNext, this.nextButtonDisabled);
      this.toggleButtonDisabled(this.btLast, this.lastButtonDisabled);
    };
    PaginationComp2.prototype.toggleButtonDisabled = function(button, disabled) {
      setAriaDisabled(button, disabled);
      button.classList.toggle("ag-disabled", disabled);
    };
    PaginationComp2.prototype.updateRowLabels = function() {
      var currentPage = this.paginationProxy.getCurrentPage();
      var pageSize = this.paginationProxy.getPageSize();
      var maxRowFound = this.paginationProxy.isLastPageFound();
      var rowCount = this.paginationProxy.isLastPageFound() ? this.paginationProxy.getMasterRowCount() : null;
      var startRow;
      var endRow;
      if (this.isZeroPagesToDisplay()) {
        startRow = endRow = 0;
      } else {
        startRow = pageSize * currentPage + 1;
        endRow = startRow + pageSize - 1;
        if (maxRowFound && endRow > rowCount) {
          endRow = rowCount;
        }
      }
      this.lbFirstRowOnPage.innerHTML = this.formatNumber(startRow);
      if (this.rowNodeBlockLoader.isLoading()) {
        var translate = this.localeService.getLocaleTextFunc();
        this.lbLastRowOnPage.innerHTML = translate("pageLastRowUnknown", "?");
      } else {
        this.lbLastRowOnPage.innerHTML = this.formatNumber(endRow);
      }
    };
    PaginationComp2.prototype.isZeroPagesToDisplay = function() {
      var maxRowFound = this.paginationProxy.isLastPageFound();
      var totalPages = this.paginationProxy.getTotalPages();
      return maxRowFound && totalPages === 0;
    };
    PaginationComp2.prototype.setTotalLabels = function() {
      var lastPageFound = this.paginationProxy.isLastPageFound();
      var totalPages = this.paginationProxy.getTotalPages();
      var rowCount = lastPageFound ? this.paginationProxy.getMasterRowCount() : null;
      if (rowCount === 1) {
        var firstRow = this.paginationProxy.getRow(0);
        var hiddenGroupRow = firstRow && firstRow.group && !(firstRow.groupData || firstRow.aggData);
        if (hiddenGroupRow) {
          this.setTotalLabelsToZero();
          return;
        }
      }
      if (lastPageFound) {
        this.lbTotal.innerHTML = this.formatNumber(totalPages);
        this.lbRecordCount.innerHTML = this.formatNumber(rowCount);
      } else {
        var moreText = this.localeService.getLocaleTextFunc()("more", "more");
        this.lbTotal.innerHTML = moreText;
        this.lbRecordCount.innerHTML = moreText;
      }
    };
    PaginationComp2.prototype.setTotalLabelsToZero = function() {
      this.lbFirstRowOnPage.innerHTML = this.formatNumber(0);
      this.lbCurrent.innerHTML = this.formatNumber(0);
      this.lbLastRowOnPage.innerHTML = this.formatNumber(0);
      this.lbTotal.innerHTML = this.formatNumber(0);
      this.lbRecordCount.innerHTML = this.formatNumber(0);
    };
    __decorate$v([
      Autowired("paginationProxy")
    ], PaginationComp2.prototype, "paginationProxy", void 0);
    __decorate$v([
      Autowired("rowNodeBlockLoader")
    ], PaginationComp2.prototype, "rowNodeBlockLoader", void 0);
    __decorate$v([
      RefSelector("btFirst")
    ], PaginationComp2.prototype, "btFirst", void 0);
    __decorate$v([
      RefSelector("btPrevious")
    ], PaginationComp2.prototype, "btPrevious", void 0);
    __decorate$v([
      RefSelector("btNext")
    ], PaginationComp2.prototype, "btNext", void 0);
    __decorate$v([
      RefSelector("btLast")
    ], PaginationComp2.prototype, "btLast", void 0);
    __decorate$v([
      RefSelector("lbRecordCount")
    ], PaginationComp2.prototype, "lbRecordCount", void 0);
    __decorate$v([
      RefSelector("lbFirstRowOnPage")
    ], PaginationComp2.prototype, "lbFirstRowOnPage", void 0);
    __decorate$v([
      RefSelector("lbLastRowOnPage")
    ], PaginationComp2.prototype, "lbLastRowOnPage", void 0);
    __decorate$v([
      RefSelector("lbCurrent")
    ], PaginationComp2.prototype, "lbCurrent", void 0);
    __decorate$v([
      RefSelector("lbTotal")
    ], PaginationComp2.prototype, "lbTotal", void 0);
    __decorate$v([
      PostConstruct
    ], PaginationComp2.prototype, "postConstruct", null);
    return PaginationComp2;
  }(Component)
);
var __extends$t = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$u = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var LoadingType;
(function(LoadingType2) {
  LoadingType2[LoadingType2["Loading"] = 0] = "Loading";
  LoadingType2[LoadingType2["NoRows"] = 1] = "NoRows";
})(LoadingType || (LoadingType = {}));
var OverlayWrapperComponent = (
  /** @class */
  function(_super) {
    __extends$t(OverlayWrapperComponent2, _super);
    function OverlayWrapperComponent2() {
      var _this = _super.call(this, OverlayWrapperComponent2.TEMPLATE) || this;
      _this.inProgress = false;
      _this.destroyRequested = false;
      _this.manuallyDisplayed = false;
      return _this;
    }
    OverlayWrapperComponent2.prototype.updateLayoutClasses = function(cssClass, params) {
      var overlayWrapperClassList = this.eOverlayWrapper.classList;
      overlayWrapperClassList.toggle(LayoutCssClasses.AUTO_HEIGHT, params.autoHeight);
      overlayWrapperClassList.toggle(LayoutCssClasses.NORMAL, params.normal);
      overlayWrapperClassList.toggle(LayoutCssClasses.PRINT, params.print);
    };
    OverlayWrapperComponent2.prototype.postConstruct = function() {
      this.createManagedBean(new LayoutFeature(this));
      this.setDisplayed(false, { skipAriaHidden: true });
      this.addManagedListener(this.eventService, Events.EVENT_ROW_DATA_UPDATED, this.onRowDataUpdated.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.onNewColumnsLoaded.bind(this));
      if (this.gridOptionsService.isRowModelType("clientSide") && !this.gridOptionsService.get("rowData")) {
        this.showLoadingOverlay();
      }
      this.gridApi.registerOverlayWrapperComp(this);
    };
    OverlayWrapperComponent2.prototype.setWrapperTypeClass = function(loadingType) {
      var overlayWrapperClassList = this.eOverlayWrapper.classList;
      overlayWrapperClassList.toggle("ag-overlay-loading-wrapper", loadingType === LoadingType.Loading);
      overlayWrapperClassList.toggle("ag-overlay-no-rows-wrapper", loadingType === LoadingType.NoRows);
    };
    OverlayWrapperComponent2.prototype.showLoadingOverlay = function() {
      if (this.gridOptionsService.is("suppressLoadingOverlay")) {
        return;
      }
      var params = {};
      var compDetails = this.userComponentFactory.getLoadingOverlayCompDetails(params);
      var promise = compDetails.newAgStackInstance();
      this.showOverlay(promise, LoadingType.Loading);
    };
    OverlayWrapperComponent2.prototype.showNoRowsOverlay = function() {
      if (this.gridOptionsService.is("suppressNoRowsOverlay")) {
        return;
      }
      var params = {};
      var compDetails = this.userComponentFactory.getNoRowsOverlayCompDetails(params);
      var promise = compDetails.newAgStackInstance();
      this.showOverlay(promise, LoadingType.NoRows);
    };
    OverlayWrapperComponent2.prototype.showOverlay = function(workItem, type) {
      var _this = this;
      if (this.inProgress) {
        return;
      }
      this.setWrapperTypeClass(type);
      this.destroyActiveOverlay();
      this.inProgress = true;
      if (workItem) {
        workItem.then(function(comp) {
          _this.inProgress = false;
          _this.eOverlayWrapper.appendChild(comp.getGui());
          _this.activeOverlay = comp;
          if (_this.destroyRequested) {
            _this.destroyRequested = false;
            _this.destroyActiveOverlay();
          }
        });
      }
      this.manuallyDisplayed = this.columnModel.isReady() && !this.paginationProxy.isEmpty();
      this.setDisplayed(true, { skipAriaHidden: true });
    };
    OverlayWrapperComponent2.prototype.destroyActiveOverlay = function() {
      if (this.inProgress) {
        this.destroyRequested = true;
        return;
      }
      if (!this.activeOverlay) {
        return;
      }
      this.activeOverlay = this.getContext().destroyBean(this.activeOverlay);
      clearElement(this.eOverlayWrapper);
    };
    OverlayWrapperComponent2.prototype.hideOverlay = function() {
      this.manuallyDisplayed = false;
      this.destroyActiveOverlay();
      this.setDisplayed(false, { skipAriaHidden: true });
    };
    OverlayWrapperComponent2.prototype.destroy = function() {
      this.destroyActiveOverlay();
      _super.prototype.destroy.call(this);
    };
    OverlayWrapperComponent2.prototype.showOrHideOverlay = function() {
      var isEmpty = this.paginationProxy.isEmpty();
      var isSuppressNoRowsOverlay = this.gridOptionsService.is("suppressNoRowsOverlay");
      if (isEmpty && !isSuppressNoRowsOverlay) {
        this.showNoRowsOverlay();
      } else {
        this.hideOverlay();
      }
    };
    OverlayWrapperComponent2.prototype.onRowDataUpdated = function() {
      this.showOrHideOverlay();
    };
    OverlayWrapperComponent2.prototype.onNewColumnsLoaded = function() {
      if (this.columnModel.isReady() && !this.paginationProxy.isEmpty() && !this.manuallyDisplayed) {
        this.hideOverlay();
      }
    };
    OverlayWrapperComponent2.TEMPLATE = '\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>';
    __decorate$u([
      Autowired("userComponentFactory")
    ], OverlayWrapperComponent2.prototype, "userComponentFactory", void 0);
    __decorate$u([
      Autowired("paginationProxy")
    ], OverlayWrapperComponent2.prototype, "paginationProxy", void 0);
    __decorate$u([
      Autowired("gridApi")
    ], OverlayWrapperComponent2.prototype, "gridApi", void 0);
    __decorate$u([
      Autowired("columnModel")
    ], OverlayWrapperComponent2.prototype, "columnModel", void 0);
    __decorate$u([
      RefSelector("eOverlayWrapper")
    ], OverlayWrapperComponent2.prototype, "eOverlayWrapper", void 0);
    __decorate$u([
      PostConstruct
    ], OverlayWrapperComponent2.prototype, "postConstruct", null);
    return OverlayWrapperComponent2;
  }(Component)
);
var __extends$s = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$t = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var RowPositionUtils = (
  /** @class */
  function(_super) {
    __extends$s(RowPositionUtils2, _super);
    function RowPositionUtils2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    RowPositionUtils2.prototype.getFirstRow = function() {
      var rowIndex = 0;
      var rowPinned;
      if (this.pinnedRowModel.getPinnedTopRowCount()) {
        rowPinned = "top";
      } else if (this.rowModel.getRowCount()) {
        rowPinned = null;
        rowIndex = this.paginationProxy.getPageFirstRow();
      } else if (this.pinnedRowModel.getPinnedBottomRowCount()) {
        rowPinned = "bottom";
      }
      return rowPinned === void 0 ? null : { rowIndex, rowPinned };
    };
    RowPositionUtils2.prototype.getLastRow = function() {
      var rowIndex;
      var rowPinned = null;
      var pinnedBottomCount = this.pinnedRowModel.getPinnedBottomRowCount();
      var pinnedTopCount = this.pinnedRowModel.getPinnedTopRowCount();
      if (pinnedBottomCount) {
        rowPinned = "bottom";
        rowIndex = pinnedBottomCount - 1;
      } else if (this.rowModel.getRowCount()) {
        rowPinned = null;
        rowIndex = this.paginationProxy.getPageLastRow();
      } else if (pinnedTopCount) {
        rowPinned = "top";
        rowIndex = pinnedTopCount - 1;
      }
      return rowIndex === void 0 ? null : { rowIndex, rowPinned };
    };
    RowPositionUtils2.prototype.getRowNode = function(gridRow) {
      switch (gridRow.rowPinned) {
        case "top":
          return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];
        case "bottom":
          return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];
        default:
          return this.rowModel.getRow(gridRow.rowIndex);
      }
    };
    RowPositionUtils2.prototype.sameRow = function(rowA, rowB) {
      if (!rowA && !rowB) {
        return true;
      }
      if (rowA && !rowB || !rowA && rowB) {
        return false;
      }
      return rowA.rowIndex === rowB.rowIndex && rowA.rowPinned == rowB.rowPinned;
    };
    RowPositionUtils2.prototype.before = function(rowA, rowB) {
      switch (rowA.rowPinned) {
        case "top":
          if (rowB.rowPinned !== "top") {
            return true;
          }
          break;
        case "bottom":
          if (rowB.rowPinned !== "bottom") {
            return false;
          }
          break;
        default:
          if (exists(rowB.rowPinned)) {
            return rowB.rowPinned !== "top";
          }
          break;
      }
      return rowA.rowIndex < rowB.rowIndex;
    };
    RowPositionUtils2.prototype.rowMax = function(rows) {
      var _this = this;
      var max2;
      rows.forEach(function(row) {
        if (max2 === void 0 || _this.before(max2, row)) {
          max2 = row;
        }
      });
      return max2;
    };
    RowPositionUtils2.prototype.rowMin = function(rows) {
      var _this = this;
      var min2;
      rows.forEach(function(row) {
        if (min2 === void 0 || _this.before(row, min2)) {
          min2 = row;
        }
      });
      return min2;
    };
    __decorate$t([
      Autowired("rowModel")
    ], RowPositionUtils2.prototype, "rowModel", void 0);
    __decorate$t([
      Autowired("pinnedRowModel")
    ], RowPositionUtils2.prototype, "pinnedRowModel", void 0);
    __decorate$t([
      Autowired("paginationProxy")
    ], RowPositionUtils2.prototype, "paginationProxy", void 0);
    RowPositionUtils2 = __decorate$t([
      Bean("rowPositionUtils")
    ], RowPositionUtils2);
    return RowPositionUtils2;
  }(BeanStub)
);
var __extends$r = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$s = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var CellPositionUtils = (
  /** @class */
  function(_super) {
    __extends$r(CellPositionUtils2, _super);
    function CellPositionUtils2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CellPositionUtils2.prototype.createId = function(cellPosition) {
      var rowIndex = cellPosition.rowIndex, rowPinned = cellPosition.rowPinned, column = cellPosition.column;
      return this.createIdFromValues({ rowIndex, column, rowPinned });
    };
    CellPositionUtils2.prototype.createIdFromValues = function(cellPosition) {
      var rowIndex = cellPosition.rowIndex, rowPinned = cellPosition.rowPinned, column = cellPosition.column;
      return rowIndex + "." + (rowPinned == null ? "null" : rowPinned) + "." + column.getId();
    };
    CellPositionUtils2.prototype.equals = function(cellA, cellB) {
      var colsMatch = cellA.column === cellB.column;
      var floatingMatch = cellA.rowPinned === cellB.rowPinned;
      var indexMatch = cellA.rowIndex === cellB.rowIndex;
      return colsMatch && floatingMatch && indexMatch;
    };
    CellPositionUtils2 = __decorate$s([
      Bean("cellPositionUtils")
    ], CellPositionUtils2);
    return CellPositionUtils2;
  }(BeanStub)
);
var __extends$q = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var UndoRedoAction = (
  /** @class */
  function() {
    function UndoRedoAction2(cellValueChanges) {
      this.cellValueChanges = cellValueChanges;
    }
    return UndoRedoAction2;
  }()
);
var RangeUndoRedoAction = (
  /** @class */
  function(_super) {
    __extends$q(RangeUndoRedoAction2, _super);
    function RangeUndoRedoAction2(cellValueChanges, initialRange, finalRange, ranges) {
      var _this = _super.call(this, cellValueChanges) || this;
      _this.initialRange = initialRange;
      _this.finalRange = finalRange;
      _this.ranges = ranges;
      return _this;
    }
    return RangeUndoRedoAction2;
  }(UndoRedoAction)
);
var UndoRedoStack = (
  /** @class */
  function() {
    function UndoRedoStack2(maxStackSize) {
      this.actionStack = [];
      this.maxStackSize = maxStackSize ? maxStackSize : UndoRedoStack2.DEFAULT_STACK_SIZE;
      this.actionStack = new Array(this.maxStackSize);
    }
    UndoRedoStack2.prototype.pop = function() {
      return this.actionStack.pop();
    };
    UndoRedoStack2.prototype.push = function(item) {
      var shouldAddActions = item.cellValueChanges && item.cellValueChanges.length > 0;
      if (!shouldAddActions) {
        return;
      }
      if (this.actionStack.length === this.maxStackSize) {
        this.actionStack.shift();
      }
      this.actionStack.push(item);
    };
    UndoRedoStack2.prototype.clear = function() {
      this.actionStack = [];
    };
    UndoRedoStack2.prototype.getCurrentStackSize = function() {
      return this.actionStack.length;
    };
    UndoRedoStack2.DEFAULT_STACK_SIZE = 10;
    return UndoRedoStack2;
  }()
);
var __extends$p = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$2$1 = function() {
  __assign$2$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$2$1.apply(this, arguments);
};
var __decorate$r = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$6 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$5 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var UndoRedoService = (
  /** @class */
  function(_super) {
    __extends$p(UndoRedoService2, _super);
    function UndoRedoService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.cellValueChanges = [];
      _this.activeCellEdit = null;
      _this.activeRowEdit = null;
      _this.isPasting = false;
      _this.isRangeInAction = false;
      _this.onCellValueChanged = function(event) {
        var eventCell = { column: event.column, rowIndex: event.rowIndex, rowPinned: event.rowPinned };
        var isCellEditing = _this.activeCellEdit !== null && _this.cellPositionUtils.equals(_this.activeCellEdit, eventCell);
        var isRowEditing = _this.activeRowEdit !== null && _this.rowPositionUtils.sameRow(_this.activeRowEdit, eventCell);
        var shouldCaptureAction = isCellEditing || isRowEditing || _this.isPasting || _this.isRangeInAction;
        if (!shouldCaptureAction) {
          return;
        }
        var rowPinned = event.rowPinned, rowIndex = event.rowIndex, column = event.column, oldValue = event.oldValue, value = event.value;
        var cellValueChange = {
          rowPinned,
          rowIndex,
          columnId: column.getColId(),
          newValue: value,
          oldValue
        };
        _this.cellValueChanges.push(cellValueChange);
      };
      _this.clearStacks = function() {
        _this.undoStack.clear();
        _this.redoStack.clear();
      };
      return _this;
    }
    UndoRedoService2.prototype.init = function() {
      var _this = this;
      if (!this.gridOptionsService.is("undoRedoCellEditing")) {
        return;
      }
      var undoRedoLimit = this.gridOptionsService.getNum("undoRedoCellEditingLimit");
      if (undoRedoLimit <= 0) {
        return;
      }
      this.undoStack = new UndoRedoStack(undoRedoLimit);
      this.redoStack = new UndoRedoStack(undoRedoLimit);
      this.addRowEditingListeners();
      this.addCellEditingListeners();
      this.addPasteListeners();
      this.addFillListeners();
      this.addCellKeyListeners();
      this.addManagedListener(this.eventService, Events.EVENT_CELL_VALUE_CHANGED, this.onCellValueChanged);
      this.addManagedListener(this.eventService, Events.EVENT_MODEL_UPDATED, function(e) {
        if (!e.keepUndoRedoStack) {
          _this.clearStacks();
        }
      });
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_MODE_CHANGED, this.clearStacks);
      this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.clearStacks);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_GROUP_OPENED, this.clearStacks);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.clearStacks);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_MOVED, this.clearStacks);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PINNED, this.clearStacks);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VISIBLE, this.clearStacks);
      this.addManagedListener(this.eventService, Events.EVENT_ROW_DRAG_END, this.clearStacks);
      this.ctrlsService.whenReady(function() {
        _this.gridBodyCtrl = _this.ctrlsService.getGridBodyCtrl();
      });
    };
    UndoRedoService2.prototype.getCurrentUndoStackSize = function() {
      return this.undoStack ? this.undoStack.getCurrentStackSize() : 0;
    };
    UndoRedoService2.prototype.getCurrentRedoStackSize = function() {
      return this.redoStack ? this.redoStack.getCurrentStackSize() : 0;
    };
    UndoRedoService2.prototype.undo = function(source) {
      var startEvent = {
        type: Events.EVENT_UNDO_STARTED,
        source
      };
      this.eventService.dispatchEvent(startEvent);
      var operationPerformed = this.undoRedo(this.undoStack, this.redoStack, "initialRange", "oldValue", "undo");
      var endEvent = {
        type: Events.EVENT_UNDO_ENDED,
        source,
        operationPerformed
      };
      this.eventService.dispatchEvent(endEvent);
    };
    UndoRedoService2.prototype.redo = function(source) {
      var startEvent = {
        type: Events.EVENT_REDO_STARTED,
        source
      };
      this.eventService.dispatchEvent(startEvent);
      var operationPerformed = this.undoRedo(this.redoStack, this.undoStack, "finalRange", "newValue", "redo");
      var endEvent = {
        type: Events.EVENT_REDO_ENDED,
        source,
        operationPerformed
      };
      this.eventService.dispatchEvent(endEvent);
    };
    UndoRedoService2.prototype.undoRedo = function(undoRedoStack, opposingUndoRedoStack, rangeProperty, cellValueChangeProperty, source) {
      if (!undoRedoStack) {
        return false;
      }
      var undoRedoAction = undoRedoStack.pop();
      if (!undoRedoAction || !undoRedoAction.cellValueChanges) {
        return false;
      }
      this.processAction(undoRedoAction, function(cellValueChange) {
        return cellValueChange[cellValueChangeProperty];
      }, source);
      if (undoRedoAction instanceof RangeUndoRedoAction) {
        this.processRange(undoRedoAction.ranges || [undoRedoAction[rangeProperty]]);
      } else {
        this.processCell(undoRedoAction.cellValueChanges);
      }
      opposingUndoRedoStack.push(undoRedoAction);
      return true;
    };
    UndoRedoService2.prototype.processAction = function(action, valueExtractor, source) {
      var _this = this;
      action.cellValueChanges.forEach(function(cellValueChange) {
        var rowIndex = cellValueChange.rowIndex, rowPinned = cellValueChange.rowPinned, columnId = cellValueChange.columnId;
        var rowPosition = { rowIndex, rowPinned };
        var currentRow = _this.getRowNode(rowPosition);
        if (!currentRow.displayed) {
          return;
        }
        currentRow.setDataValue(columnId, valueExtractor(cellValueChange), source);
      });
    };
    UndoRedoService2.prototype.processRange = function(ranges) {
      var _this = this;
      var lastFocusedCell;
      this.rangeService.removeAllCellRanges(true);
      ranges.forEach(function(range, idx) {
        if (!range) {
          return;
        }
        var startRow = range.startRow;
        var endRow = range.endRow;
        if (idx === ranges.length - 1) {
          lastFocusedCell = {
            rowPinned: startRow.rowPinned,
            rowIndex: startRow.rowIndex,
            columnId: range.startColumn.getColId()
          };
          _this.setLastFocusedCell(lastFocusedCell);
        }
        var cellRangeParams = {
          rowStartIndex: startRow.rowIndex,
          rowStartPinned: startRow.rowPinned,
          rowEndIndex: endRow.rowIndex,
          rowEndPinned: endRow.rowPinned,
          columnStart: range.startColumn,
          columns: range.columns
        };
        _this.rangeService.addCellRange(cellRangeParams);
      });
    };
    UndoRedoService2.prototype.processCell = function(cellValueChanges) {
      var cellValueChange = cellValueChanges[0];
      var rowIndex = cellValueChange.rowIndex, rowPinned = cellValueChange.rowPinned;
      var rowPosition = { rowIndex, rowPinned };
      var row = this.getRowNode(rowPosition);
      var lastFocusedCell = {
        rowPinned: cellValueChange.rowPinned,
        rowIndex: row.rowIndex,
        columnId: cellValueChange.columnId
      };
      this.setLastFocusedCell(lastFocusedCell, !!this.rangeService);
    };
    UndoRedoService2.prototype.setLastFocusedCell = function(lastFocusedCell, setRangeToCell) {
      var rowIndex = lastFocusedCell.rowIndex, columnId = lastFocusedCell.columnId, rowPinned = lastFocusedCell.rowPinned;
      var scrollFeature = this.gridBodyCtrl.getScrollFeature();
      var column = this.columnModel.getGridColumn(columnId);
      if (!column) {
        return;
      }
      scrollFeature.ensureIndexVisible(rowIndex);
      scrollFeature.ensureColumnVisible(column);
      var cellPosition = { rowIndex, column, rowPinned };
      this.focusService.setFocusedCell(__assign$2$1(__assign$2$1({}, cellPosition), { forceBrowserFocus: true }));
      if (setRangeToCell) {
        this.rangeService.setRangeToCell(cellPosition);
      }
    };
    UndoRedoService2.prototype.addRowEditingListeners = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_ROW_EDITING_STARTED, function(e) {
        _this.activeRowEdit = { rowIndex: e.rowIndex, rowPinned: e.rowPinned };
      });
      this.addManagedListener(this.eventService, Events.EVENT_ROW_EDITING_STOPPED, function() {
        var action = new UndoRedoAction(_this.cellValueChanges);
        _this.pushActionsToUndoStack(action);
        _this.activeRowEdit = null;
      });
    };
    UndoRedoService2.prototype.addCellEditingListeners = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_CELL_EDITING_STARTED, function(e) {
        _this.activeCellEdit = { column: e.column, rowIndex: e.rowIndex, rowPinned: e.rowPinned };
      });
      this.addManagedListener(this.eventService, Events.EVENT_CELL_EDITING_STOPPED, function(e) {
        _this.activeCellEdit = null;
        var shouldPushAction = e.valueChanged && !_this.activeRowEdit && !_this.isPasting && !_this.isRangeInAction;
        if (shouldPushAction) {
          var action = new UndoRedoAction(_this.cellValueChanges);
          _this.pushActionsToUndoStack(action);
        }
      });
    };
    UndoRedoService2.prototype.addPasteListeners = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_PASTE_START, function() {
        _this.isPasting = true;
      });
      this.addManagedListener(this.eventService, Events.EVENT_PASTE_END, function() {
        var action = new UndoRedoAction(_this.cellValueChanges);
        _this.pushActionsToUndoStack(action);
        _this.isPasting = false;
      });
    };
    UndoRedoService2.prototype.addFillListeners = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_FILL_START, function() {
        _this.isRangeInAction = true;
      });
      this.addManagedListener(this.eventService, Events.EVENT_FILL_END, function(event) {
        var action = new RangeUndoRedoAction(_this.cellValueChanges, event.initialRange, event.finalRange);
        _this.pushActionsToUndoStack(action);
        _this.isRangeInAction = false;
      });
    };
    UndoRedoService2.prototype.addCellKeyListeners = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START, function() {
        _this.isRangeInAction = true;
      });
      this.addManagedListener(this.eventService, Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END, function() {
        var action;
        if (_this.rangeService && _this.gridOptionsService.isEnableRangeSelection()) {
          action = new RangeUndoRedoAction(_this.cellValueChanges, void 0, void 0, __spreadArray$5([], __read$6(_this.rangeService.getCellRanges())));
        } else {
          action = new UndoRedoAction(_this.cellValueChanges);
        }
        _this.pushActionsToUndoStack(action);
        _this.isRangeInAction = false;
      });
    };
    UndoRedoService2.prototype.pushActionsToUndoStack = function(action) {
      this.undoStack.push(action);
      this.cellValueChanges = [];
      this.redoStack.clear();
    };
    UndoRedoService2.prototype.getRowNode = function(gridRow) {
      switch (gridRow.rowPinned) {
        case "top":
          return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];
        case "bottom":
          return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];
        default:
          return this.rowModel.getRow(gridRow.rowIndex);
      }
    };
    __decorate$r([
      Autowired("focusService")
    ], UndoRedoService2.prototype, "focusService", void 0);
    __decorate$r([
      Autowired("ctrlsService")
    ], UndoRedoService2.prototype, "ctrlsService", void 0);
    __decorate$r([
      Autowired("rowModel")
    ], UndoRedoService2.prototype, "rowModel", void 0);
    __decorate$r([
      Autowired("pinnedRowModel")
    ], UndoRedoService2.prototype, "pinnedRowModel", void 0);
    __decorate$r([
      Autowired("cellPositionUtils")
    ], UndoRedoService2.prototype, "cellPositionUtils", void 0);
    __decorate$r([
      Autowired("rowPositionUtils")
    ], UndoRedoService2.prototype, "rowPositionUtils", void 0);
    __decorate$r([
      Autowired("columnModel")
    ], UndoRedoService2.prototype, "columnModel", void 0);
    __decorate$r([
      Optional("rangeService")
    ], UndoRedoService2.prototype, "rangeService", void 0);
    __decorate$r([
      PostConstruct
    ], UndoRedoService2.prototype, "init", null);
    UndoRedoService2 = __decorate$r([
      Bean("undoRedoService")
    ], UndoRedoService2);
    return UndoRedoService2;
  }(BeanStub)
);
var __extends$o = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$q = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var HeaderPositionUtils = (
  /** @class */
  function(_super) {
    __extends$o(HeaderPositionUtils2, _super);
    function HeaderPositionUtils2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    HeaderPositionUtils2.prototype.findHeader = function(focusedHeader, direction) {
      var nextColumn;
      var getGroupMethod;
      var getColMethod;
      if (focusedHeader.column instanceof ColumnGroup) {
        getGroupMethod = "getDisplayedGroup" + direction;
        nextColumn = this.columnModel[getGroupMethod](focusedHeader.column);
      } else {
        getColMethod = "getDisplayedCol" + direction;
        nextColumn = this.columnModel[getColMethod](focusedHeader.column);
      }
      if (!nextColumn) {
        return;
      }
      var headerRowIndex = focusedHeader.headerRowIndex;
      var currentRowType = this.getHeaderRowType(headerRowIndex);
      if (currentRowType === HeaderRowType.COLUMN_GROUP) {
        var columnGroup = nextColumn;
        if (columnGroup.isPadding() && this.isAnyChildSpanningHeaderHeight(columnGroup)) {
          var _a2 = this.getColumnVisibleChild(columnGroup, headerRowIndex, direction), nextFocusColumn = _a2.nextFocusColumn, nextRow = _a2.nextRow;
          if (nextFocusColumn) {
            nextColumn = nextFocusColumn;
            headerRowIndex = nextRow;
          }
        }
      }
      return {
        column: nextColumn,
        headerRowIndex
      };
    };
    HeaderPositionUtils2.prototype.isAnyChildSpanningHeaderHeight = function(columnGroup) {
      if (!columnGroup) {
        return false;
      }
      return columnGroup.getLeafColumns().some(function(col) {
        return col.isSpanHeaderHeight();
      });
    };
    HeaderPositionUtils2.prototype.getColumnVisibleParent = function(currentColumn, currentIndex) {
      var currentRowType = this.getHeaderRowType(currentIndex);
      var isFloatingFilter = currentRowType === HeaderRowType.FLOATING_FILTER;
      var isColumn = currentRowType === HeaderRowType.COLUMN;
      var nextFocusColumn = isFloatingFilter ? currentColumn : currentColumn.getParent();
      var nextRow = currentIndex - 1;
      if (isColumn && this.isAnyChildSpanningHeaderHeight(currentColumn.getParent())) {
        while (nextFocusColumn && nextFocusColumn.isPadding()) {
          nextFocusColumn = nextFocusColumn.getParent();
          nextRow--;
        }
        if (nextRow < 0) {
          nextFocusColumn = currentColumn;
          nextRow = currentIndex;
        }
      }
      return { nextFocusColumn, nextRow };
    };
    HeaderPositionUtils2.prototype.getColumnVisibleChild = function(column, currentIndex, direction) {
      if (direction === void 0) {
        direction = "After";
      }
      var currentRowType = this.getHeaderRowType(currentIndex);
      var nextFocusColumn = column;
      var nextRow = currentIndex + 1;
      if (currentRowType === HeaderRowType.COLUMN_GROUP) {
        var leafColumns = column.getLeafColumns();
        var leafChild = direction === "After" ? leafColumns[0] : last(leafColumns);
        if (this.isAnyChildSpanningHeaderHeight(leafChild.getParent())) {
          nextFocusColumn = leafChild;
          var currentColumn = leafChild.getParent();
          while (currentColumn && currentColumn !== column) {
            currentColumn = currentColumn.getParent();
            nextRow++;
          }
        } else {
          nextFocusColumn = column.getDisplayedChildren()[0];
        }
      }
      return { nextFocusColumn, nextRow };
    };
    HeaderPositionUtils2.prototype.getHeaderRowType = function(rowIndex) {
      var centerHeaderContainer = this.ctrlsService.getHeaderRowContainerCtrl();
      if (centerHeaderContainer) {
        return centerHeaderContainer.getRowType(rowIndex);
      }
    };
    HeaderPositionUtils2.prototype.findColAtEdgeForHeaderRow = function(level, position) {
      var displayedColumns = this.columnModel.getAllDisplayedColumns();
      var column = displayedColumns[position === "start" ? 0 : displayedColumns.length - 1];
      if (!column) {
        return;
      }
      var childContainer = this.ctrlsService.getHeaderRowContainerCtrl(column.getPinned());
      var type = childContainer.getRowType(level);
      if (type == HeaderRowType.COLUMN_GROUP) {
        var columnGroup = this.columnModel.getColumnGroupAtLevel(column, level);
        return {
          headerRowIndex: level,
          column: columnGroup
        };
      }
      return {
        // if type==null, means the header level didn't exist
        headerRowIndex: type == null ? -1 : level,
        column
      };
    };
    __decorate$q([
      Autowired("columnModel")
    ], HeaderPositionUtils2.prototype, "columnModel", void 0);
    __decorate$q([
      Autowired("ctrlsService")
    ], HeaderPositionUtils2.prototype, "ctrlsService", void 0);
    HeaderPositionUtils2 = __decorate$q([
      Bean("headerPositionUtils")
    ], HeaderPositionUtils2);
    return HeaderPositionUtils2;
  }(BeanStub)
);
var __decorate$p = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ColumnDefFactory = (
  /** @class */
  function() {
    function ColumnDefFactory2() {
    }
    ColumnDefFactory2.prototype.buildColumnDefs = function(cols, rowGroupColumns, pivotColumns) {
      var _this = this;
      var res = [];
      var colGroupDefs = {};
      cols.forEach(function(col) {
        var colDef = _this.createDefFromColumn(col, rowGroupColumns, pivotColumns);
        var addToResult = true;
        var childDef = colDef;
        var pointer = col.getOriginalParent();
        var lastPointer = null;
        while (pointer) {
          var parentDef = null;
          if (pointer.isPadding()) {
            pointer = pointer.getOriginalParent();
            continue;
          }
          var existingParentDef = colGroupDefs[pointer.getGroupId()];
          if (existingParentDef) {
            existingParentDef.children.push(childDef);
            addToResult = false;
            break;
          }
          parentDef = _this.createDefFromGroup(pointer);
          if (parentDef) {
            parentDef.children = [childDef];
            colGroupDefs[parentDef.groupId] = parentDef;
            childDef = parentDef;
            pointer = pointer.getOriginalParent();
          }
          if (pointer != null && lastPointer === pointer) {
            addToResult = false;
            break;
          }
          lastPointer = pointer;
        }
        if (addToResult) {
          res.push(childDef);
        }
      });
      return res;
    };
    ColumnDefFactory2.prototype.createDefFromGroup = function(group) {
      var defCloned = deepCloneDefinition(group.getColGroupDef(), ["children"]);
      if (defCloned) {
        defCloned.groupId = group.getGroupId();
      }
      return defCloned;
    };
    ColumnDefFactory2.prototype.createDefFromColumn = function(col, rowGroupColumns, pivotColumns) {
      var colDefCloned = deepCloneDefinition(col.getColDef());
      colDefCloned.colId = col.getColId();
      colDefCloned.width = col.getActualWidth();
      colDefCloned.rowGroup = col.isRowGroupActive();
      colDefCloned.rowGroupIndex = col.isRowGroupActive() ? rowGroupColumns.indexOf(col) : null;
      colDefCloned.pivot = col.isPivotActive();
      colDefCloned.pivotIndex = col.isPivotActive() ? pivotColumns.indexOf(col) : null;
      colDefCloned.aggFunc = col.isValueActive() ? col.getAggFunc() : null;
      colDefCloned.hide = col.isVisible() ? void 0 : true;
      colDefCloned.pinned = col.isPinned() ? col.getPinned() : null;
      colDefCloned.sort = col.getSort() ? col.getSort() : null;
      colDefCloned.sortIndex = col.getSortIndex() != null ? col.getSortIndex() : null;
      return colDefCloned;
    };
    ColumnDefFactory2 = __decorate$p([
      Bean("columnDefFactory")
    ], ColumnDefFactory2);
    return ColumnDefFactory2;
  }()
);
var __decorate$o = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var RowCssClassCalculator = (
  /** @class */
  function() {
    function RowCssClassCalculator2() {
    }
    RowCssClassCalculator2.prototype.getInitialRowClasses = function(params) {
      var classes = [];
      if (exists(params.extraCssClass)) {
        classes.push(params.extraCssClass);
      }
      classes.push("ag-row");
      classes.push(params.rowFocused ? "ag-row-focus" : "ag-row-no-focus");
      if (params.fadeRowIn) {
        classes.push("ag-opacity-zero");
      }
      classes.push(params.rowIsEven ? "ag-row-even" : "ag-row-odd");
      if (params.rowNode.isRowPinned()) {
        classes.push("ag-row-pinned");
      }
      if (params.rowNode.isSelected()) {
        classes.push("ag-row-selected");
      }
      if (params.rowNode.footer) {
        classes.push("ag-row-footer");
      }
      classes.push("ag-row-level-" + params.rowLevel);
      if (params.rowNode.stub) {
        classes.push("ag-row-loading");
      }
      if (params.fullWidthRow) {
        classes.push("ag-full-width-row");
      }
      if (params.expandable) {
        classes.push("ag-row-group");
        classes.push(params.rowNode.expanded ? "ag-row-group-expanded" : "ag-row-group-contracted");
      }
      if (params.rowNode.dragging) {
        classes.push("ag-row-dragging");
      }
      pushAll(classes, this.processClassesFromGridOptions(params.rowNode));
      pushAll(classes, this.preProcessRowClassRules(params.rowNode));
      classes.push(params.printLayout ? "ag-row-position-relative" : "ag-row-position-absolute");
      if (params.firstRowOnPage) {
        classes.push("ag-row-first");
      }
      if (params.lastRowOnPage) {
        classes.push("ag-row-last");
      }
      if (params.fullWidthRow) {
        if (params.pinned === "left") {
          classes.push("ag-cell-last-left-pinned");
        }
        if (params.pinned === "right") {
          classes.push("ag-cell-first-right-pinned");
        }
      }
      return classes;
    };
    RowCssClassCalculator2.prototype.processClassesFromGridOptions = function(rowNode) {
      var res = [];
      var process = function(rowCls) {
        if (typeof rowCls === "string") {
          res.push(rowCls);
        } else if (Array.isArray(rowCls)) {
          rowCls.forEach(function(e) {
            return res.push(e);
          });
        }
      };
      var rowClass = this.gridOptionsService.get("rowClass");
      if (rowClass) {
        if (typeof rowClass === "function") {
          console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead");
          return [];
        }
        process(rowClass);
      }
      var rowClassFunc = this.gridOptionsService.getCallback("getRowClass");
      if (rowClassFunc) {
        var params = {
          data: rowNode.data,
          node: rowNode,
          rowIndex: rowNode.rowIndex
        };
        var rowClassFuncResult = rowClassFunc(params);
        process(rowClassFuncResult);
      }
      return res;
    };
    RowCssClassCalculator2.prototype.preProcessRowClassRules = function(rowNode) {
      var res = [];
      this.processRowClassRules(rowNode, function(className) {
        res.push(className);
      }, function(className) {
      });
      return res;
    };
    RowCssClassCalculator2.prototype.processRowClassRules = function(rowNode, onApplicableClass, onNotApplicableClass) {
      var rowClassParams = {
        data: rowNode.data,
        node: rowNode,
        rowIndex: rowNode.rowIndex,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context
      };
      this.stylingService.processClassRules(this.gridOptionsService.get("rowClassRules"), rowClassParams, onApplicableClass, onNotApplicableClass);
    };
    RowCssClassCalculator2.prototype.calculateRowLevel = function(rowNode) {
      if (rowNode.group) {
        return rowNode.level;
      }
      return rowNode.parent ? rowNode.parent.level + 1 : 0;
    };
    __decorate$o([
      Autowired("stylingService")
    ], RowCssClassCalculator2.prototype, "stylingService", void 0);
    __decorate$o([
      Autowired("gridOptionsService")
    ], RowCssClassCalculator2.prototype, "gridOptionsService", void 0);
    RowCssClassCalculator2 = __decorate$o([
      Bean("rowCssClassCalculator")
    ], RowCssClassCalculator2);
    return RowCssClassCalculator2;
  }()
);
var __extends$n = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$n = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var RowNodeSorter = (
  /** @class */
  function(_super) {
    __extends$n(RowNodeSorter2, _super);
    function RowNodeSorter2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    RowNodeSorter2.prototype.init = function() {
      var _this = this;
      this.isAccentedSort = this.gridOptionsService.is("accentedSort");
      this.primaryColumnsSortGroups = this.gridOptionsService.isColumnsSortingCoupledToGroup();
      this.addManagedPropertyListener("accentedSort", function(propChange) {
        return _this.isAccentedSort = propChange.currentValue;
      });
      this.addManagedPropertyListener("autoGroupColumnDef", function() {
        return _this.primaryColumnsSortGroups = _this.gridOptionsService.isColumnsSortingCoupledToGroup();
      });
    };
    RowNodeSorter2.prototype.doFullSort = function(rowNodes, sortOptions) {
      var mapper = function(rowNode, pos) {
        return { currentPos: pos, rowNode };
      };
      var sortedRowNodes = rowNodes.map(mapper);
      sortedRowNodes.sort(this.compareRowNodes.bind(this, sortOptions));
      return sortedRowNodes.map(function(item) {
        return item.rowNode;
      });
    };
    RowNodeSorter2.prototype.compareRowNodes = function(sortOptions, sortedNodeA, sortedNodeB) {
      var nodeA = sortedNodeA.rowNode;
      var nodeB = sortedNodeB.rowNode;
      for (var i = 0, len = sortOptions.length; i < len; i++) {
        var sortOption = sortOptions[i];
        var isDescending = sortOption.sort === "desc";
        var valueA = this.getValue(nodeA, sortOption.column);
        var valueB = this.getValue(nodeB, sortOption.column);
        var comparatorResult = void 0;
        var providedComparator = this.getComparator(sortOption, nodeA);
        if (providedComparator) {
          comparatorResult = providedComparator(valueA, valueB, nodeA, nodeB, isDescending);
        } else {
          comparatorResult = _.defaultComparator(valueA, valueB, this.isAccentedSort);
        }
        var validResult = !isNaN(comparatorResult);
        if (validResult && comparatorResult !== 0) {
          return sortOption.sort === "asc" ? comparatorResult : comparatorResult * -1;
        }
      }
      return sortedNodeA.currentPos - sortedNodeB.currentPos;
    };
    RowNodeSorter2.prototype.getComparator = function(sortOption, rowNode) {
      var column = sortOption.column;
      var comparatorOnCol = column.getColDef().comparator;
      if (comparatorOnCol != null) {
        return comparatorOnCol;
      }
      if (!column.getColDef().showRowGroup) {
        return;
      }
      var groupLeafField = !rowNode.group && column.getColDef().field;
      if (!groupLeafField) {
        return;
      }
      var primaryColumn = this.columnModel.getPrimaryColumn(groupLeafField);
      if (!primaryColumn) {
        return;
      }
      return primaryColumn.getColDef().comparator;
    };
    RowNodeSorter2.prototype.getValue = function(node, column) {
      var _a2, _b2;
      if (!this.primaryColumnsSortGroups) {
        return this.valueService.getValue(column, node, false, false);
      }
      var isNodeGroupedAtLevel = node.rowGroupColumn === column;
      if (isNodeGroupedAtLevel) {
        var isGroupRows = this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive());
        if (isGroupRows) {
          var keyCreator = column.getColDef().keyCreator;
          if (keyCreator) {
            return node.key;
          }
          var leafChild = (_a2 = node.allLeafChildren) === null || _a2 === void 0 ? void 0 : _a2[0];
          if (leafChild) {
            return this.valueService.getValue(column, leafChild, false, false);
          }
          return void 0;
        }
        var displayCol = this.columnModel.getGroupDisplayColumnForGroup(column.getId());
        if (!displayCol) {
          return void 0;
        }
        return (_b2 = node.groupData) === null || _b2 === void 0 ? void 0 : _b2[displayCol.getId()];
      }
      if (node.group && column.getColDef().showRowGroup) {
        return void 0;
      }
      return this.valueService.getValue(column, node, false, false);
    };
    __decorate$n([
      Autowired("valueService")
    ], RowNodeSorter2.prototype, "valueService", void 0);
    __decorate$n([
      Autowired("columnModel")
    ], RowNodeSorter2.prototype, "columnModel", void 0);
    __decorate$n([
      PostConstruct
    ], RowNodeSorter2.prototype, "init", null);
    RowNodeSorter2 = __decorate$n([
      Bean("rowNodeSorter")
    ], RowNodeSorter2);
    return RowNodeSorter2;
  }(BeanStub)
);
var __extends$m = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$m = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var CtrlsService = (
  /** @class */
  function(_super) {
    __extends$m(CtrlsService2, _super);
    function CtrlsService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.ready = false;
      _this.readyCallbacks = [];
      return _this;
    }
    CtrlsService_1 = CtrlsService2;
    CtrlsService2.prototype.checkReady = function() {
      this.ready = this.gridCtrl != null && this.gridBodyCtrl != null && this.centerRowContainerCtrl != null && this.leftRowContainerCtrl != null && this.rightRowContainerCtrl != null && this.bottomCenterRowContainerCtrl != null && this.bottomLeftRowContainerCtrl != null && this.bottomRightRowContainerCtrl != null && this.topCenterRowContainerCtrl != null && this.topLeftRowContainerCtrl != null && this.topRightRowContainerCtrl != null && this.stickyTopCenterRowContainerCtrl != null && this.stickyTopLeftRowContainerCtrl != null && this.stickyTopRightRowContainerCtrl != null && this.centerHeaderRowContainerCtrl != null && this.leftHeaderRowContainerCtrl != null && this.rightHeaderRowContainerCtrl != null && this.fakeHScrollComp != null && this.fakeVScrollComp != null && this.gridHeaderCtrl != null;
      if (this.ready) {
        var p_1 = this.createReadyParams();
        this.readyCallbacks.forEach(function(c) {
          return c(p_1);
        });
        this.readyCallbacks.length = 0;
      }
    };
    CtrlsService2.prototype.whenReady = function(callback2) {
      if (this.ready) {
        callback2(this.createReadyParams());
      } else {
        this.readyCallbacks.push(callback2);
      }
    };
    CtrlsService2.prototype.createReadyParams = function() {
      return {
        centerRowContainerCtrl: this.centerRowContainerCtrl,
        leftRowContainerCtrl: this.leftRowContainerCtrl,
        rightRowContainerCtrl: this.rightRowContainerCtrl,
        bottomCenterRowContainerCtrl: this.bottomCenterRowContainerCtrl,
        bottomLeftRowContainerCtrl: this.bottomLeftRowContainerCtrl,
        bottomRightRowContainerCtrl: this.bottomRightRowContainerCtrl,
        topCenterRowContainerCtrl: this.topCenterRowContainerCtrl,
        topLeftRowContainerCtrl: this.topLeftRowContainerCtrl,
        topRightRowContainerCtrl: this.topRightRowContainerCtrl,
        stickyTopCenterRowContainerCtrl: this.stickyTopCenterRowContainerCtrl,
        stickyTopLeftRowContainerCtrl: this.stickyTopLeftRowContainerCtrl,
        stickyTopRightRowContainerCtrl: this.stickyTopRightRowContainerCtrl,
        centerHeaderRowContainerCtrl: this.centerHeaderRowContainerCtrl,
        leftHeaderRowContainerCtrl: this.leftHeaderRowContainerCtrl,
        rightHeaderRowContainerCtrl: this.rightHeaderRowContainerCtrl,
        fakeHScrollComp: this.fakeHScrollComp,
        fakeVScrollComp: this.fakeVScrollComp,
        gridBodyCtrl: this.gridBodyCtrl,
        gridCtrl: this.gridCtrl,
        gridHeaderCtrl: this.gridHeaderCtrl
      };
    };
    CtrlsService2.prototype.registerFakeHScrollComp = function(comp) {
      this.fakeHScrollComp = comp;
      this.checkReady();
    };
    CtrlsService2.prototype.registerFakeVScrollComp = function(comp) {
      this.fakeVScrollComp = comp;
      this.checkReady();
    };
    CtrlsService2.prototype.registerGridHeaderCtrl = function(gridHeaderCtrl) {
      this.gridHeaderCtrl = gridHeaderCtrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerCenterRowContainerCtrl = function(ctrl) {
      this.centerRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerLeftRowContainerCtrl = function(ctrl) {
      this.leftRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerRightRowContainerCtrl = function(ctrl) {
      this.rightRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerTopCenterRowContainerCtrl = function(ctrl) {
      this.topCenterRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerTopLeftRowContainerCon = function(ctrl) {
      this.topLeftRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerTopRightRowContainerCtrl = function(ctrl) {
      this.topRightRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerStickyTopCenterRowContainerCtrl = function(ctrl) {
      this.stickyTopCenterRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerStickyTopLeftRowContainerCon = function(ctrl) {
      this.stickyTopLeftRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerStickyTopRightRowContainerCtrl = function(ctrl) {
      this.stickyTopRightRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerBottomCenterRowContainerCtrl = function(ctrl) {
      this.bottomCenterRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerBottomLeftRowContainerCtrl = function(ctrl) {
      this.bottomLeftRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerBottomRightRowContainerCtrl = function(ctrl) {
      this.bottomRightRowContainerCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerHeaderContainer = function(ctrl, pinned) {
      switch (pinned) {
        case "left":
          this.leftHeaderRowContainerCtrl = ctrl;
          break;
        case "right":
          this.rightHeaderRowContainerCtrl = ctrl;
          break;
        default:
          this.centerHeaderRowContainerCtrl = ctrl;
          break;
      }
      this.checkReady();
    };
    CtrlsService2.prototype.registerGridBodyCtrl = function(ctrl) {
      this.gridBodyCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.registerGridCtrl = function(ctrl) {
      this.gridCtrl = ctrl;
      this.checkReady();
    };
    CtrlsService2.prototype.getFakeHScrollComp = function() {
      return this.fakeHScrollComp;
    };
    CtrlsService2.prototype.getFakeVScrollComp = function() {
      return this.fakeVScrollComp;
    };
    CtrlsService2.prototype.getGridHeaderCtrl = function() {
      return this.gridHeaderCtrl;
    };
    CtrlsService2.prototype.getGridCtrl = function() {
      return this.gridCtrl;
    };
    CtrlsService2.prototype.getCenterRowContainerCtrl = function() {
      return this.centerRowContainerCtrl;
    };
    CtrlsService2.prototype.getTopCenterRowContainerCtrl = function() {
      return this.topCenterRowContainerCtrl;
    };
    CtrlsService2.prototype.getBottomCenterRowContainerCtrl = function() {
      return this.bottomCenterRowContainerCtrl;
    };
    CtrlsService2.prototype.getStickyTopCenterRowContainerCtrl = function() {
      return this.stickyTopCenterRowContainerCtrl;
    };
    CtrlsService2.prototype.getGridBodyCtrl = function() {
      return this.gridBodyCtrl;
    };
    CtrlsService2.prototype.getHeaderRowContainerCtrls = function() {
      return [this.leftHeaderRowContainerCtrl, this.rightHeaderRowContainerCtrl, this.centerHeaderRowContainerCtrl];
    };
    CtrlsService2.prototype.getHeaderRowContainerCtrl = function(pinned) {
      switch (pinned) {
        case "left":
          return this.leftHeaderRowContainerCtrl;
        case "right":
          return this.rightHeaderRowContainerCtrl;
        default:
          return this.centerHeaderRowContainerCtrl;
      }
    };
    var CtrlsService_1;
    CtrlsService2.NAME = "ctrlsService";
    CtrlsService2 = CtrlsService_1 = __decorate$m([
      Bean(CtrlsService_1.NAME)
    ], CtrlsService2);
    return CtrlsService2;
  }(BeanStub)
);
var __extends$l = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$l = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var CtrlsFactory = (
  /** @class */
  function(_super) {
    __extends$l(CtrlsFactory2, _super);
    function CtrlsFactory2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.registry = {};
      return _this;
    }
    CtrlsFactory2.prototype.register = function(meta) {
      this.registry[meta.controllerName] = meta.controllerClass;
    };
    CtrlsFactory2.prototype.getInstance = function(name) {
      var ControllerClass = this.registry[name];
      if (ControllerClass == null) {
        return void 0;
      }
      return new ControllerClass();
    };
    CtrlsFactory2 = __decorate$l([
      Bean("ctrlsFactory")
    ], CtrlsFactory2);
    return CtrlsFactory2;
  }(BeanStub)
);
var __extends$k = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$k = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var AbstractFakeScrollComp = (
  /** @class */
  function(_super) {
    __extends$k(AbstractFakeScrollComp2, _super);
    function AbstractFakeScrollComp2(template, direction) {
      var _this = _super.call(this, template) || this;
      _this.direction = direction;
      _this.hideTimeout = null;
      return _this;
    }
    AbstractFakeScrollComp2.prototype.postConstruct = function() {
      this.addManagedListener(this.eventService, Events.EVENT_SCROLL_VISIBILITY_CHANGED, this.onScrollVisibilityChanged.bind(this));
      this.onScrollVisibilityChanged();
      this.addOrRemoveCssClass("ag-apple-scrollbar", isMacOsUserAgent() || isIOSUserAgent());
    };
    AbstractFakeScrollComp2.prototype.initialiseInvisibleScrollbar = function() {
      if (this.invisibleScrollbar !== void 0) {
        return;
      }
      this.invisibleScrollbar = isInvisibleScrollbar();
      if (this.invisibleScrollbar) {
        this.hideAndShowInvisibleScrollAsNeeded();
        this.addActiveListenerToggles();
      }
    };
    AbstractFakeScrollComp2.prototype.addActiveListenerToggles = function() {
      var _this = this;
      var activateEvents = ["mouseenter", "mousedown", "touchstart"];
      var deactivateEvents = ["mouseleave", "touchend"];
      var eGui = this.getGui();
      activateEvents.forEach(function(eventName) {
        return _this.addManagedListener(eGui, eventName, function() {
          return _this.addOrRemoveCssClass("ag-scrollbar-active", true);
        });
      });
      deactivateEvents.forEach(function(eventName) {
        return _this.addManagedListener(eGui, eventName, function() {
          return _this.addOrRemoveCssClass("ag-scrollbar-active", false);
        });
      });
    };
    AbstractFakeScrollComp2.prototype.onScrollVisibilityChanged = function() {
      var _this = this;
      if (this.invisibleScrollbar === void 0) {
        this.initialiseInvisibleScrollbar();
      }
      this.animationFrameService.requestAnimationFrame(function() {
        return _this.setScrollVisible();
      });
    };
    AbstractFakeScrollComp2.prototype.hideAndShowInvisibleScrollAsNeeded = function() {
      var _this = this;
      this.addManagedListener(this.eventService, Events.EVENT_BODY_SCROLL, function(params) {
        if (params.direction === _this.direction) {
          if (_this.hideTimeout !== null) {
            window.clearTimeout(_this.hideTimeout);
            _this.hideTimeout = null;
          }
          _this.addOrRemoveCssClass("ag-scrollbar-scrolling", true);
        }
      });
      this.addManagedListener(this.eventService, Events.EVENT_BODY_SCROLL_END, function() {
        _this.hideTimeout = window.setTimeout(function() {
          _this.addOrRemoveCssClass("ag-scrollbar-scrolling", false);
          _this.hideTimeout = null;
        }, 400);
      });
    };
    AbstractFakeScrollComp2.prototype.attemptSettingScrollPosition = function(value) {
      var _this = this;
      var viewport = this.getViewport();
      waitUntil(function() {
        return isVisible(viewport);
      }, function() {
        return _this.setScrollPosition(value);
      }, 100);
    };
    AbstractFakeScrollComp2.prototype.getViewport = function() {
      return this.eViewport;
    };
    AbstractFakeScrollComp2.prototype.getContainer = function() {
      return this.eContainer;
    };
    AbstractFakeScrollComp2.prototype.onScrollCallback = function(fn) {
      this.addManagedListener(this.getViewport(), "scroll", fn);
    };
    __decorate$k([
      RefSelector("eViewport")
    ], AbstractFakeScrollComp2.prototype, "eViewport", void 0);
    __decorate$k([
      RefSelector("eContainer")
    ], AbstractFakeScrollComp2.prototype, "eContainer", void 0);
    __decorate$k([
      Autowired("scrollVisibleService")
    ], AbstractFakeScrollComp2.prototype, "scrollVisibleService", void 0);
    __decorate$k([
      Autowired("ctrlsService")
    ], AbstractFakeScrollComp2.prototype, "ctrlsService", void 0);
    __decorate$k([
      Autowired("animationFrameService")
    ], AbstractFakeScrollComp2.prototype, "animationFrameService", void 0);
    return AbstractFakeScrollComp2;
  }(Component)
);
var __extends$j = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$j = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var FakeHScrollComp = (
  /** @class */
  function(_super) {
    __extends$j(FakeHScrollComp2, _super);
    function FakeHScrollComp2() {
      return _super.call(this, FakeHScrollComp2.TEMPLATE, "horizontal") || this;
    }
    FakeHScrollComp2.prototype.postConstruct = function() {
      var _this = this;
      _super.prototype.postConstruct.call(this);
      var spacerWidthsListener = this.setFakeHScrollSpacerWidths.bind(this);
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, spacerWidthsListener);
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, spacerWidthsListener);
      this.addManagedListener(this.eventService, Events.EVENT_PINNED_ROW_DATA_CHANGED, this.onPinnedRowDataChanged.bind(this));
      this.addManagedPropertyListener("domLayout", spacerWidthsListener);
      this.ctrlsService.registerFakeHScrollComp(this);
      this.createManagedBean(new CenterWidthFeature(function(width) {
        return _this.eContainer.style.width = width + "px";
      }));
    };
    FakeHScrollComp2.prototype.initialiseInvisibleScrollbar = function() {
      if (this.invisibleScrollbar !== void 0) {
        return;
      }
      this.enableRtl = this.gridOptionsService.is("enableRtl");
      _super.prototype.initialiseInvisibleScrollbar.call(this);
      if (this.invisibleScrollbar) {
        this.refreshCompBottom();
      }
    };
    FakeHScrollComp2.prototype.onPinnedRowDataChanged = function() {
      this.refreshCompBottom();
    };
    FakeHScrollComp2.prototype.refreshCompBottom = function() {
      if (!this.invisibleScrollbar) {
        return;
      }
      var bottomPinnedHeight = this.pinnedRowModel.getPinnedBottomTotalHeight();
      this.getGui().style.bottom = bottomPinnedHeight + "px";
    };
    FakeHScrollComp2.prototype.onScrollVisibilityChanged = function() {
      _super.prototype.onScrollVisibilityChanged.call(this);
      this.setFakeHScrollSpacerWidths();
    };
    FakeHScrollComp2.prototype.setFakeHScrollSpacerWidths = function() {
      var vScrollShowing = this.scrollVisibleService.isVerticalScrollShowing();
      var rightSpacing = this.columnModel.getDisplayedColumnsRightWidth();
      var scrollOnRight = !this.enableRtl && vScrollShowing;
      var scrollbarWidth = this.gridOptionsService.getScrollbarWidth();
      if (scrollOnRight) {
        rightSpacing += scrollbarWidth;
      }
      setFixedWidth(this.eRightSpacer, rightSpacing);
      this.eRightSpacer.classList.toggle("ag-scroller-corner", rightSpacing <= scrollbarWidth);
      var leftSpacing = this.columnModel.getDisplayedColumnsLeftWidth();
      var scrollOnLeft = this.enableRtl && vScrollShowing;
      if (scrollOnLeft) {
        leftSpacing += scrollbarWidth;
      }
      setFixedWidth(this.eLeftSpacer, leftSpacing);
      this.eLeftSpacer.classList.toggle("ag-scroller-corner", leftSpacing <= scrollbarWidth);
    };
    FakeHScrollComp2.prototype.setScrollVisible = function() {
      var hScrollShowing = this.scrollVisibleService.isHorizontalScrollShowing();
      var invisibleScrollbar2 = this.invisibleScrollbar;
      var isSuppressHorizontalScroll = this.gridOptionsService.is("suppressHorizontalScroll");
      var scrollbarWidth = hScrollShowing ? this.gridOptionsService.getScrollbarWidth() || 0 : 0;
      var adjustedScrollbarWidth = scrollbarWidth === 0 && invisibleScrollbar2 ? 16 : scrollbarWidth;
      var scrollContainerSize = !isSuppressHorizontalScroll ? adjustedScrollbarWidth : 0;
      this.addOrRemoveCssClass("ag-scrollbar-invisible", invisibleScrollbar2);
      setFixedHeight(this.getGui(), scrollContainerSize);
      setFixedHeight(this.eViewport, scrollContainerSize);
      setFixedHeight(this.eContainer, scrollContainerSize);
      this.setDisplayed(hScrollShowing, { skipAriaHidden: true });
    };
    FakeHScrollComp2.prototype.getScrollPosition = function() {
      return getScrollLeft(this.getViewport(), this.enableRtl);
    };
    FakeHScrollComp2.prototype.setScrollPosition = function(value) {
      if (!isVisible(this.getViewport())) {
        this.attemptSettingScrollPosition(value);
      }
      setScrollLeft(this.getViewport(), value, this.enableRtl);
    };
    FakeHScrollComp2.TEMPLATE = '<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>';
    __decorate$j([
      RefSelector("eLeftSpacer")
    ], FakeHScrollComp2.prototype, "eLeftSpacer", void 0);
    __decorate$j([
      RefSelector("eRightSpacer")
    ], FakeHScrollComp2.prototype, "eRightSpacer", void 0);
    __decorate$j([
      Autowired("columnModel")
    ], FakeHScrollComp2.prototype, "columnModel", void 0);
    __decorate$j([
      Autowired("pinnedRowModel")
    ], FakeHScrollComp2.prototype, "pinnedRowModel", void 0);
    __decorate$j([
      PostConstruct
    ], FakeHScrollComp2.prototype, "postConstruct", null);
    return FakeHScrollComp2;
  }(AbstractFakeScrollComp)
);
var __extends$i = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$i = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var PinnedWidthService = (
  /** @class */
  function(_super) {
    __extends$i(PinnedWidthService2, _super);
    function PinnedWidthService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    PinnedWidthService2.prototype.postConstruct = function() {
      var listener = this.checkContainerWidths.bind(this);
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_CHANGED, listener);
      this.addManagedListener(this.eventService, Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED, listener);
      this.addManagedPropertyListener("domLayout", listener);
    };
    PinnedWidthService2.prototype.checkContainerWidths = function() {
      var printLayout = this.gridOptionsService.isDomLayout("print");
      var newLeftWidth = printLayout ? 0 : this.columnModel.getDisplayedColumnsLeftWidth();
      var newRightWidth = printLayout ? 0 : this.columnModel.getDisplayedColumnsRightWidth();
      if (newLeftWidth != this.leftWidth) {
        this.leftWidth = newLeftWidth;
        this.eventService.dispatchEvent({ type: Events.EVENT_LEFT_PINNED_WIDTH_CHANGED });
      }
      if (newRightWidth != this.rightWidth) {
        this.rightWidth = newRightWidth;
        this.eventService.dispatchEvent({ type: Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED });
      }
    };
    PinnedWidthService2.prototype.getPinnedRightWidth = function() {
      return this.rightWidth;
    };
    PinnedWidthService2.prototype.getPinnedLeftWidth = function() {
      return this.leftWidth;
    };
    __decorate$i([
      Autowired("columnModel")
    ], PinnedWidthService2.prototype, "columnModel", void 0);
    __decorate$i([
      PostConstruct
    ], PinnedWidthService2.prototype, "postConstruct", null);
    PinnedWidthService2 = __decorate$i([
      Bean("pinnedWidthService")
    ], PinnedWidthService2);
    return PinnedWidthService2;
  }(BeanStub)
);
var __extends$h = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$h = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var RowNodeEventThrottle = (
  /** @class */
  function(_super) {
    __extends$h(RowNodeEventThrottle2, _super);
    function RowNodeEventThrottle2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.events = [];
      return _this;
    }
    RowNodeEventThrottle2.prototype.postConstruct = function() {
      if (this.rowModel.getType() == "clientSide") {
        this.clientSideRowModel = this.rowModel;
      }
    };
    RowNodeEventThrottle2.prototype.dispatchExpanded = function(event) {
      var _this = this;
      if (this.clientSideRowModel == null) {
        this.eventService.dispatchEvent(event);
        return;
      }
      this.events.push(event);
      var func = function() {
        if (_this.clientSideRowModel) {
          _this.clientSideRowModel.onRowGroupOpened();
        }
        _this.events.forEach(function(e) {
          return _this.eventService.dispatchEvent(e);
        });
        _this.events = [];
      };
      if (this.dispatchExpandedDebounced == null) {
        this.dispatchExpandedDebounced = this.animationFrameService.debounce(func);
      }
      this.dispatchExpandedDebounced();
    };
    __decorate$h([
      Autowired("animationFrameService")
    ], RowNodeEventThrottle2.prototype, "animationFrameService", void 0);
    __decorate$h([
      Autowired("rowModel")
    ], RowNodeEventThrottle2.prototype, "rowModel", void 0);
    __decorate$h([
      PostConstruct
    ], RowNodeEventThrottle2.prototype, "postConstruct", null);
    RowNodeEventThrottle2 = __decorate$h([
      Bean("rowNodeEventThrottle")
    ], RowNodeEventThrottle2);
    return RowNodeEventThrottle2;
  }(BeanStub)
);
var __assign$1$1 = function() {
  __assign$1$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$1$1.apply(this, arguments);
};
var __decorate$g = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param$1 = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var __read$5 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$4 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
function toNumber(value) {
  if (typeof value == "number") {
    return value;
  }
  if (typeof value == "string") {
    return parseInt(value, 10);
  }
}
function isTrue(value) {
  return value === true || value === "true";
}
var GridOptionsService = (
  /** @class */
  function() {
    function GridOptionsService2() {
      this.destroyed = false;
      this.domDataKey = "__AG_" + Math.random().toString();
      this.propertyEventService = new EventService();
    }
    Object.defineProperty(GridOptionsService2.prototype, "context", {
      // This is quicker then having code call gridOptionsService.get('context')
      get: function() {
        return this.gridOptions["context"];
      },
      enumerable: false,
      configurable: true
    });
    GridOptionsService2.prototype.agWire = function(gridApi, columnApi) {
      this.gridOptions.api = gridApi;
      this.gridOptions.columnApi = columnApi;
      this.api = gridApi;
      this.columnApi = columnApi;
    };
    GridOptionsService2.prototype.init = function() {
      this.gridOptionLookup = new Set(__spreadArray$4(__spreadArray$4([], __read$5(ComponentUtil.ALL_PROPERTIES)), __read$5(ComponentUtil.EVENT_CALLBACKS)));
      var async = !this.is("suppressAsyncEvents");
      this.eventService.addGlobalListener(this.globalEventHandler.bind(this), async);
      this.getScrollbarWidth();
    };
    GridOptionsService2.prototype.destroy = function() {
      this.gridOptions.api = null;
      this.gridOptions.columnApi = null;
      this.destroyed = true;
    };
    GridOptionsService2.prototype.is = function(property) {
      return isTrue(this.gridOptions[property]);
    };
    GridOptionsService2.prototype.get = function(property) {
      return this.gridOptions[property];
    };
    GridOptionsService2.prototype.getNum = function(property) {
      return toNumber(this.gridOptions[property]);
    };
    GridOptionsService2.prototype.getCallback = function(property) {
      return this.mergeGridCommonParams(this.gridOptions[property]);
    };
    GridOptionsService2.prototype.exists = function(property) {
      return exists(this.gridOptions[property]);
    };
    GridOptionsService2.prototype.mergeGridCommonParams = function(callback2) {
      var _this = this;
      if (callback2) {
        var wrapped = function(callbackParams) {
          var mergedParams = callbackParams;
          mergedParams.api = _this.api;
          mergedParams.columnApi = _this.columnApi;
          mergedParams.context = _this.context;
          return callback2(mergedParams);
        };
        return wrapped;
      }
      return callback2;
    };
    GridOptionsService2.prototype.set = function(key, newValue, force, eventParams) {
      if (force === void 0) {
        force = false;
      }
      if (eventParams === void 0) {
        eventParams = {};
      }
      if (this.gridOptionLookup.has(key)) {
        var previousValue = this.gridOptions[key];
        if (force || previousValue !== newValue) {
          this.gridOptions[key] = newValue;
          var event_1 = __assign$1$1({ type: key, currentValue: newValue, previousValue }, eventParams);
          this.propertyEventService.dispatchEvent(event_1);
        }
      }
    };
    GridOptionsService2.prototype.addEventListener = function(key, listener) {
      this.propertyEventService.addEventListener(key, listener);
    };
    GridOptionsService2.prototype.removeEventListener = function(key, listener) {
      this.propertyEventService.removeEventListener(key, listener);
    };
    GridOptionsService2.prototype.globalEventHandler = function(eventName, event) {
      if (this.destroyed) {
        return;
      }
      var callbackMethodName = ComponentUtil.getCallbackForEvent(eventName);
      if (typeof this.gridOptions[callbackMethodName] === "function") {
        this.gridOptions[callbackMethodName](event);
      }
    };
    GridOptionsService2.prototype.getGridId = function() {
      return this.api.getGridId();
    };
    GridOptionsService2.prototype.getScrollbarWidth = function() {
      if (this.scrollbarWidth == null) {
        var useGridOptions = typeof this.gridOptions.scrollbarWidth === "number" && this.gridOptions.scrollbarWidth >= 0;
        var scrollbarWidth = useGridOptions ? this.gridOptions.scrollbarWidth : getScrollbarWidth();
        if (scrollbarWidth != null) {
          this.scrollbarWidth = scrollbarWidth;
          this.eventService.dispatchEvent({
            type: Events.EVENT_SCROLLBAR_WIDTH_CHANGED
          });
        }
      }
      return this.scrollbarWidth;
    };
    GridOptionsService2.prototype.isRowModelType = function(rowModelType) {
      return this.gridOptions.rowModelType === rowModelType || rowModelType === "clientSide" && missing(this.gridOptions.rowModelType);
    };
    GridOptionsService2.prototype.isDomLayout = function(domLayout) {
      var _a2;
      var gridLayout = (_a2 = this.gridOptions.domLayout) !== null && _a2 !== void 0 ? _a2 : "normal";
      return gridLayout === domLayout;
    };
    GridOptionsService2.prototype.isRowSelection = function() {
      return this.gridOptions.rowSelection === "single" || this.gridOptions.rowSelection === "multiple";
    };
    GridOptionsService2.prototype.useAsyncEvents = function() {
      return !this.is("suppressAsyncEvents");
    };
    GridOptionsService2.prototype.isGetRowHeightFunction = function() {
      return typeof this.gridOptions.getRowHeight === "function";
    };
    GridOptionsService2.prototype.getRowHeightForNode = function(rowNode, allowEstimate, defaultRowHeight) {
      if (allowEstimate === void 0) {
        allowEstimate = false;
      }
      if (defaultRowHeight == null) {
        defaultRowHeight = this.environment.getDefaultRowHeight();
      }
      if (this.isGetRowHeightFunction()) {
        if (allowEstimate) {
          return { height: defaultRowHeight, estimated: true };
        }
        var params = {
          node: rowNode,
          data: rowNode.data
        };
        var height = this.getCallback("getRowHeight")(params);
        if (this.isNumeric(height)) {
          if (height === 0) {
            doOnce(function() {
              return console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.");
            }, "invalidRowHeight");
          }
          return { height: Math.max(1, height), estimated: false };
        }
      }
      if (rowNode.detail && this.is("masterDetail")) {
        return this.getMasterDetailRowHeight();
      }
      var rowHeight = this.gridOptions.rowHeight && this.isNumeric(this.gridOptions.rowHeight) ? this.gridOptions.rowHeight : defaultRowHeight;
      return { height: rowHeight, estimated: false };
    };
    GridOptionsService2.prototype.getMasterDetailRowHeight = function() {
      if (this.is("detailRowAutoHeight")) {
        return { height: 1, estimated: false };
      }
      if (this.isNumeric(this.gridOptions.detailRowHeight)) {
        return { height: this.gridOptions.detailRowHeight, estimated: false };
      }
      return { height: 300, estimated: false };
    };
    GridOptionsService2.prototype.getRowHeightAsNumber = function() {
      if (!this.gridOptions.rowHeight || missing(this.gridOptions.rowHeight)) {
        return this.environment.getDefaultRowHeight();
      }
      var rowHeight = this.gridOptions.rowHeight;
      if (rowHeight && this.isNumeric(rowHeight)) {
        this.environment.setRowHeightVariable(rowHeight);
        return rowHeight;
      }
      console.warn("AG Grid row height must be a number if not using standard row model");
      return this.environment.getDefaultRowHeight();
    };
    GridOptionsService2.prototype.isNumeric = function(value) {
      return !isNaN(value) && typeof value === "number" && isFinite(value);
    };
    GridOptionsService2.prototype.getDomDataKey = function() {
      return this.domDataKey;
    };
    GridOptionsService2.prototype.getDomData = function(element, key) {
      var domData = element[this.getDomDataKey()];
      return domData ? domData[key] : void 0;
    };
    GridOptionsService2.prototype.setDomData = function(element, key, value) {
      var domDataKey = this.getDomDataKey();
      var domData = element[domDataKey];
      if (missing(domData)) {
        domData = {};
        element[domDataKey] = domData;
      }
      domData[key] = value;
    };
    GridOptionsService2.prototype.getDocument = function() {
      var result = null;
      if (this.gridOptions.getDocument && exists(this.gridOptions.getDocument)) {
        result = this.gridOptions.getDocument();
      } else if (this.eGridDiv) {
        result = this.eGridDiv.ownerDocument;
      }
      if (result && exists(result)) {
        return result;
      }
      return document;
    };
    GridOptionsService2.prototype.getWindow = function() {
      var eDocument = this.getDocument();
      return eDocument.defaultView || window;
    };
    GridOptionsService2.prototype.getRootNode = function() {
      return this.eGridDiv.getRootNode();
    };
    GridOptionsService2.prototype.getAsyncTransactionWaitMillis = function() {
      return exists(this.gridOptions.asyncTransactionWaitMillis) ? this.gridOptions.asyncTransactionWaitMillis : 50;
    };
    GridOptionsService2.prototype.isAnimateRows = function() {
      if (this.is("ensureDomOrder")) {
        return false;
      }
      return this.is("animateRows");
    };
    GridOptionsService2.prototype.isGroupRowsSticky = function() {
      if (this.is("suppressGroupRowsSticky") || this.is("paginateChildRows") || this.is("groupHideOpenParents")) {
        return false;
      }
      return true;
    };
    GridOptionsService2.prototype.isTreeData = function() {
      return this.is("treeData") && ModuleRegistry.__assertRegistered(ModuleNames.RowGroupingModule, "Tree Data", this.api.getGridId());
    };
    GridOptionsService2.prototype.isMasterDetail = function() {
      return this.is("masterDetail") && ModuleRegistry.__assertRegistered(ModuleNames.MasterDetailModule, "masterDetail", this.api.getGridId());
    };
    GridOptionsService2.prototype.isEnableRangeSelection = function() {
      return this.is("enableRangeSelection") && ModuleRegistry.__isRegistered(ModuleNames.RangeSelectionModule, this.api.getGridId());
    };
    GridOptionsService2.prototype.isColumnsSortingCoupledToGroup = function() {
      var autoGroupColumnDef = this.gridOptions.autoGroupColumnDef;
      var isClientSideRowModel = this.isRowModelType("clientSide");
      return isClientSideRowModel && !(autoGroupColumnDef === null || autoGroupColumnDef === void 0 ? void 0 : autoGroupColumnDef.comparator) && !this.isTreeData();
    };
    GridOptionsService2.prototype.getGroupAggFiltering = function() {
      var userValue = this.gridOptions.groupAggFiltering;
      if (typeof userValue === "function") {
        return this.getCallback("groupAggFiltering");
      }
      if (isTrue(userValue)) {
        return function() {
          return true;
        };
      }
      return void 0;
    };
    GridOptionsService2.prototype.isGroupMultiAutoColumn = function() {
      if (this.gridOptions.groupDisplayType) {
        return matchesGroupDisplayType("multipleColumns", this.gridOptions.groupDisplayType);
      }
      return this.is("groupHideOpenParents");
    };
    GridOptionsService2.prototype.isGroupUseEntireRow = function(pivotMode) {
      if (pivotMode) {
        return false;
      }
      return this.gridOptions.groupDisplayType ? matchesGroupDisplayType("groupRows", this.gridOptions.groupDisplayType) : false;
    };
    __decorate$g([
      Autowired("gridOptions")
    ], GridOptionsService2.prototype, "gridOptions", void 0);
    __decorate$g([
      Autowired("eventService")
    ], GridOptionsService2.prototype, "eventService", void 0);
    __decorate$g([
      Autowired("environment")
    ], GridOptionsService2.prototype, "environment", void 0);
    __decorate$g([
      Autowired("eGridDiv")
    ], GridOptionsService2.prototype, "eGridDiv", void 0);
    __decorate$g([
      __param$1(0, Qualifier("gridApi")),
      __param$1(1, Qualifier("columnApi"))
    ], GridOptionsService2.prototype, "agWire", null);
    __decorate$g([
      PostConstruct
    ], GridOptionsService2.prototype, "init", null);
    __decorate$g([
      PreDestroy
    ], GridOptionsService2.prototype, "destroy", null);
    GridOptionsService2 = __decorate$g([
      Bean("gridOptionsService")
    ], GridOptionsService2);
    return GridOptionsService2;
  }()
);
var __extends$g = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$f = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var LocaleService = (
  /** @class */
  function(_super) {
    __extends$g(LocaleService2, _super);
    function LocaleService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    LocaleService2.prototype.getLocaleTextFunc = function() {
      var getLocaleText = this.gridOptionsService.getCallback("getLocaleText");
      if (getLocaleText) {
        return function(key, defaultValue, variableValues) {
          var params = {
            key,
            defaultValue,
            variableValues
          };
          return getLocaleText(params);
        };
      }
      var localeText = this.gridOptionsService.get("localeText");
      return function(key, defaultValue, variableValues) {
        var localisedText = localeText && localeText[key];
        if (localisedText && variableValues && variableValues.length) {
          var found = 0;
          while (true) {
            if (found >= variableValues.length) {
              break;
            }
            var idx = localisedText.indexOf("${variable}");
            if (idx === -1) {
              break;
            }
            localisedText = localisedText.replace("${variable}", variableValues[found++]);
          }
        }
        return localisedText !== null && localisedText !== void 0 ? localisedText : defaultValue;
      };
    };
    LocaleService2 = __decorate$f([
      Bean("localeService")
    ], LocaleService2);
    return LocaleService2;
  }(BeanStub)
);
var __extends$f = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$e = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var FakeVScrollComp = (
  /** @class */
  function(_super) {
    __extends$f(FakeVScrollComp2, _super);
    function FakeVScrollComp2() {
      return _super.call(this, FakeVScrollComp2.TEMPLATE, "vertical") || this;
    }
    FakeVScrollComp2.prototype.postConstruct = function() {
      _super.prototype.postConstruct.call(this);
      this.createManagedBean(new SetHeightFeature(this.eContainer));
      this.ctrlsService.registerFakeVScrollComp(this);
      this.addManagedListener(this.eventService, Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED, this.onRowContainerHeightChanged.bind(this));
    };
    FakeVScrollComp2.prototype.setScrollVisible = function() {
      var vScrollShowing = this.scrollVisibleService.isVerticalScrollShowing();
      var invisibleScrollbar2 = this.invisibleScrollbar;
      var scrollbarWidth = vScrollShowing ? this.gridOptionsService.getScrollbarWidth() || 0 : 0;
      var adjustedScrollbarWidth = scrollbarWidth === 0 && invisibleScrollbar2 ? 16 : scrollbarWidth;
      this.addOrRemoveCssClass("ag-scrollbar-invisible", invisibleScrollbar2);
      setFixedWidth(this.getGui(), adjustedScrollbarWidth);
      setFixedWidth(this.eViewport, adjustedScrollbarWidth);
      setFixedWidth(this.eContainer, adjustedScrollbarWidth);
      this.setDisplayed(vScrollShowing, { skipAriaHidden: true });
    };
    FakeVScrollComp2.prototype.onRowContainerHeightChanged = function() {
      var gridBodyCtrl = this.ctrlsService.getGridBodyCtrl();
      var gridBodyViewportEl = gridBodyCtrl.getBodyViewportElement();
      if (this.eViewport.scrollTop != gridBodyViewportEl.scrollTop) {
        this.eViewport.scrollTop = gridBodyViewportEl.scrollTop;
      }
    };
    FakeVScrollComp2.prototype.getScrollPosition = function() {
      return this.getViewport().scrollTop;
    };
    FakeVScrollComp2.prototype.setScrollPosition = function(value) {
      if (!isVisible(this.getViewport())) {
        this.attemptSettingScrollPosition(value);
      }
      this.getViewport().scrollTop = value;
    };
    FakeVScrollComp2.TEMPLATE = '<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>';
    __decorate$e([
      PostConstruct
    ], FakeVScrollComp2.prototype, "postConstruct", null);
    return FakeVScrollComp2;
  }(AbstractFakeScrollComp)
);
var __extends$e = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$m = function() {
  __assign$m = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$m.apply(this, arguments);
};
var __decorate$d = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$4 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$3$1 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var MONTH_LOCALE_TEXT = {
  january: "January",
  february: "February",
  march: "March",
  april: "April",
  may: "May",
  june: "June",
  july: "July",
  august: "August",
  september: "September",
  october: "October",
  november: "November",
  december: "December"
};
var MONTH_KEYS = ["january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december"];
var DataTypeService = (
  /** @class */
  function(_super) {
    __extends$e(DataTypeService2, _super);
    function DataTypeService2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.dataTypeDefinitions = {};
      _this.isWaitingForRowData = false;
      _this.isColumnTypeOverrideInDataTypeDefinitions = false;
      _this.columnStateUpdatesPendingInference = {};
      _this.columnStateUpdateListenerDestroyFuncs = [];
      return _this;
    }
    DataTypeService2.prototype.init = function() {
      var _this = this;
      this.groupHideOpenParents = this.gridOptionsService.is("groupHideOpenParents");
      this.addManagedPropertyListener("groupHideOpenParents", function() {
        _this.groupHideOpenParents = _this.gridOptionsService.is("groupHideOpenParents");
      });
      this.processDataTypeDefinitions();
      this.addManagedPropertyListener("dataTypeDefinitions", function() {
        _this.processDataTypeDefinitions();
        _this.columnModel.recreateColumnDefs("gridOptionsChanged");
      });
    };
    DataTypeService2.prototype.processDataTypeDefinitions = function() {
      var _this = this;
      var _a2;
      var defaultDataTypes = this.getDefaultDataTypes();
      this.dataTypeDefinitions = {};
      Object.entries(defaultDataTypes).forEach(function(_a3) {
        var _b2 = __read$4(_a3, 2), cellDataType = _b2[0], dataTypeDefinition = _b2[1];
        _this.dataTypeDefinitions[cellDataType] = __assign$m(__assign$m({}, dataTypeDefinition), { groupSafeValueFormatter: _this.createGroupSafeValueFormatter(dataTypeDefinition) });
      });
      var dataTypeDefinitions = (_a2 = this.gridOptionsService.get("dataTypeDefinitions")) !== null && _a2 !== void 0 ? _a2 : {};
      this.dataTypeMatchers = {};
      Object.entries(dataTypeDefinitions).forEach(function(_a3) {
        var _b2 = __read$4(_a3, 2), cellDataType = _b2[0], dataTypeDefinition = _b2[1];
        var mergedDataTypeDefinition = _this.processDataTypeDefinition(dataTypeDefinition, dataTypeDefinitions, [cellDataType], defaultDataTypes);
        if (mergedDataTypeDefinition) {
          _this.dataTypeDefinitions[cellDataType] = mergedDataTypeDefinition;
          if (dataTypeDefinition.dataTypeMatcher) {
            _this.dataTypeMatchers[cellDataType] = dataTypeDefinition.dataTypeMatcher;
          }
        }
      });
      this.checkObjectValueHandlers(defaultDataTypes);
      ["dateString", "text", "number", "boolean", "date"].forEach(function(cellDataType) {
        var overriddenDataTypeMatcher = _this.dataTypeMatchers[cellDataType];
        if (overriddenDataTypeMatcher) {
          delete _this.dataTypeMatchers[cellDataType];
        }
        _this.dataTypeMatchers[cellDataType] = overriddenDataTypeMatcher !== null && overriddenDataTypeMatcher !== void 0 ? overriddenDataTypeMatcher : defaultDataTypes[cellDataType].dataTypeMatcher;
      });
    };
    DataTypeService2.prototype.mergeDataTypeDefinitions = function(parentDataTypeDefinition, childDataTypeDefinition) {
      var mergedDataTypeDefinition = __assign$m(__assign$m({}, parentDataTypeDefinition), childDataTypeDefinition);
      if (parentDataTypeDefinition.columnTypes && childDataTypeDefinition.columnTypes && childDataTypeDefinition.appendColumnTypes) {
        mergedDataTypeDefinition.columnTypes = __spreadArray$3$1(__spreadArray$3$1([], __read$4(this.convertColumnTypes(parentDataTypeDefinition.columnTypes))), __read$4(this.convertColumnTypes(childDataTypeDefinition.columnTypes)));
      }
      return mergedDataTypeDefinition;
    };
    DataTypeService2.prototype.processDataTypeDefinition = function(dataTypeDefinition, dataTypeDefinitions, alreadyProcessedDataTypes, defaultDataTypes) {
      var mergedDataTypeDefinition;
      var extendsCellDataType = dataTypeDefinition.extendsDataType;
      if (dataTypeDefinition.columnTypes) {
        this.isColumnTypeOverrideInDataTypeDefinitions = true;
      }
      if (dataTypeDefinition.extendsDataType === dataTypeDefinition.baseDataType) {
        var baseDataTypeDefinition = defaultDataTypes[extendsCellDataType];
        if (!this.validateDataTypeDefinition(dataTypeDefinition, baseDataTypeDefinition, extendsCellDataType)) {
          return void 0;
        }
        mergedDataTypeDefinition = this.mergeDataTypeDefinitions(baseDataTypeDefinition, dataTypeDefinition);
      } else {
        if (alreadyProcessedDataTypes.includes(extendsCellDataType)) {
          doOnce(function() {
            return console.warn('AG Grid: Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');
          }, "dataTypeExtendsCircularRef");
          return void 0;
        }
        var extendedDataTypeDefinition = dataTypeDefinitions[extendsCellDataType];
        if (!this.validateDataTypeDefinition(dataTypeDefinition, extendedDataTypeDefinition, extendsCellDataType)) {
          return void 0;
        }
        var mergedExtendedDataTypeDefinition = this.processDataTypeDefinition(extendedDataTypeDefinition, dataTypeDefinitions, __spreadArray$3$1(__spreadArray$3$1([], __read$4(alreadyProcessedDataTypes)), [extendsCellDataType]), defaultDataTypes);
        if (!mergedExtendedDataTypeDefinition) {
          return void 0;
        }
        mergedDataTypeDefinition = this.mergeDataTypeDefinitions(mergedExtendedDataTypeDefinition, dataTypeDefinition);
      }
      return __assign$m(__assign$m({}, mergedDataTypeDefinition), { groupSafeValueFormatter: this.createGroupSafeValueFormatter(mergedDataTypeDefinition) });
    };
    DataTypeService2.prototype.validateDataTypeDefinition = function(dataTypeDefinition, parentDataTypeDefinition, parentCellDataType) {
      if (!parentDataTypeDefinition) {
        doOnce(function() {
          return console.warn("AG Grid: The data type definition " + parentCellDataType + " does not exist.");
        }, "dataTypeDefMissing" + parentCellDataType);
        return false;
      }
      if (parentDataTypeDefinition.baseDataType !== dataTypeDefinition.baseDataType) {
        doOnce(function() {
          return console.warn('AG Grid: The "baseDataType" property of a data type definition must match that of its parent.');
        }, "dataTypeBaseTypesMatch");
        return false;
      }
      return true;
    };
    DataTypeService2.prototype.createGroupSafeValueFormatter = function(dataTypeDefinition) {
      var _this = this;
      if (!dataTypeDefinition.valueFormatter) {
        return void 0;
      }
      return function(params) {
        var _a2, _b2;
        if ((_a2 = params.node) === null || _a2 === void 0 ? void 0 : _a2.group) {
          var aggFunc = params.column.getAggFunc();
          if (aggFunc) {
            if (aggFunc === "first" || aggFunc === "last") {
              return dataTypeDefinition.valueFormatter(params);
            }
            if (dataTypeDefinition.baseDataType === "number" && aggFunc !== "count") {
              if (typeof params.value === "number") {
                return dataTypeDefinition.valueFormatter(params);
              }
              if (typeof params.value === "object") {
                if (!params.value) {
                  return void 0;
                }
                if ("toNumber" in params.value) {
                  return dataTypeDefinition.valueFormatter(__assign$m(__assign$m({}, params), { value: params.value.toNumber() }));
                }
                if ("value" in params.value) {
                  return dataTypeDefinition.valueFormatter(__assign$m(__assign$m({}, params), { value: params.value.value }));
                }
              }
            }
          }
          return void 0;
        } else if (_this.groupHideOpenParents && params.column.isRowGroupActive()) {
          if (typeof params.value !== "string" || ((_b2 = dataTypeDefinition.dataTypeMatcher) === null || _b2 === void 0 ? void 0 : _b2.call(dataTypeDefinition, params.value))) {
            return dataTypeDefinition.valueFormatter(params);
          }
          return void 0;
        }
        return dataTypeDefinition.valueFormatter(params);
      };
    };
    DataTypeService2.prototype.updateColDefAndGetDataTypeDefinitionColumnType = function(colDef, userColDef, colId) {
      var cellDataType = userColDef.cellDataType;
      var field = userColDef.field;
      if (cellDataType === void 0) {
        cellDataType = colDef.cellDataType;
      }
      if (cellDataType == null || cellDataType === true) {
        cellDataType = this.canInferCellDataType(colDef, userColDef) ? this.inferCellDataType(field, colId) : false;
      }
      if (!cellDataType) {
        colDef.cellDataType = false;
        return void 0;
      }
      var dataTypeDefinition = this.dataTypeDefinitions[cellDataType];
      if (!dataTypeDefinition) {
        doOnce(function() {
          return console.warn('AG Grid: Missing data type definition - "' + cellDataType + '"');
        }, "dataTypeMissing" + cellDataType);
        return void 0;
      }
      colDef.cellDataType = cellDataType;
      if (dataTypeDefinition.groupSafeValueFormatter) {
        colDef.valueFormatter = dataTypeDefinition.groupSafeValueFormatter;
      }
      if (dataTypeDefinition.valueParser) {
        colDef.valueParser = dataTypeDefinition.valueParser;
      }
      if (!dataTypeDefinition.suppressDefaultProperties) {
        this.setColDefPropertiesForBaseDataType(colDef, dataTypeDefinition, colId);
      }
      return dataTypeDefinition.columnTypes;
    };
    DataTypeService2.prototype.updateColDefAndGetColumnType = function(colDef, userColDef, colId) {
      var _a2, _b2;
      var dataTypeDefinitionColumnType = this.updateColDefAndGetDataTypeDefinitionColumnType(colDef, userColDef, colId);
      var columnTypes = (_b2 = (_a2 = userColDef.type) !== null && _a2 !== void 0 ? _a2 : dataTypeDefinitionColumnType) !== null && _b2 !== void 0 ? _b2 : colDef.type;
      colDef.type = columnTypes;
      return columnTypes ? this.convertColumnTypes(columnTypes) : void 0;
    };
    DataTypeService2.prototype.addColumnListeners = function(column) {
      if (!this.isWaitingForRowData) {
        return;
      }
      var columnStateUpdates = this.columnStateUpdatesPendingInference[column.getColId()];
      if (!columnStateUpdates) {
        return;
      }
      var columnListener = function(event) {
        columnStateUpdates.add(event.key);
      };
      column.addEventListener(Column.EVENT_STATE_UPDATED, columnListener);
      this.columnStateUpdateListenerDestroyFuncs.push(function() {
        return column.removeEventListener(Column.EVENT_STATE_UPDATED, columnListener);
      });
    };
    DataTypeService2.prototype.canInferCellDataType = function(colDef, userColDef) {
      var _this = this;
      var _a2;
      if (this.rowModel.getType() !== "clientSide") {
        return false;
      }
      var propsToCheckForInference = { cellRenderer: true, valueGetter: true, valueParser: true, refData: true };
      if (this.doColDefPropsPreventInference(userColDef, propsToCheckForInference)) {
        return false;
      }
      var columnTypes = userColDef.type === null ? colDef.type : userColDef.type;
      if (columnTypes) {
        var columnTypeDefs_1 = (_a2 = this.gridOptionsService.get("columnTypes")) !== null && _a2 !== void 0 ? _a2 : {};
        var hasPropsPreventingInference = this.convertColumnTypes(columnTypes).some(function(columnType) {
          var columnTypeDef = columnTypeDefs_1[columnType.trim()];
          return columnTypeDef && _this.doColDefPropsPreventInference(columnTypeDef, propsToCheckForInference);
        });
        if (hasPropsPreventingInference) {
          return false;
        }
      }
      return !this.doColDefPropsPreventInference(colDef, propsToCheckForInference);
    };
    DataTypeService2.prototype.doColDefPropsPreventInference = function(colDef, propsToCheckForInference) {
      var _this = this;
      return [
        ["cellRenderer", "agSparklineCellRenderer"],
        ["valueGetter", void 0],
        ["valueParser", void 0],
        ["refData", void 0]
      ].some(function(_a2) {
        var _b2 = __read$4(_a2, 2), prop = _b2[0], comparisonValue = _b2[1];
        return _this.doesColDefPropPreventInference(colDef, propsToCheckForInference, prop, comparisonValue);
      });
    };
    DataTypeService2.prototype.doesColDefPropPreventInference = function(colDef, checkProps, prop, comparisonValue) {
      if (!checkProps[prop]) {
        return false;
      }
      var value = colDef[prop];
      if (value === null) {
        checkProps[prop] = false;
        return false;
      } else {
        return comparisonValue === void 0 ? !!value : value === comparisonValue;
      }
    };
    DataTypeService2.prototype.inferCellDataType = function(field, colId) {
      var _a2;
      if (!field) {
        return void 0;
      }
      var value;
      var initialData = this.getInitialData();
      if (initialData) {
        var fieldContainsDots = field.indexOf(".") >= 0 && !this.gridOptionsService.is("suppressFieldDotNotation");
        value = getValueUsingField(initialData, field, fieldContainsDots);
      } else {
        this.initWaitForRowData(colId);
      }
      if (value == null) {
        return void 0;
      }
      var _b2 = __read$4((_a2 = Object.entries(this.dataTypeMatchers).find(function(_a3) {
        var _b3 = __read$4(_a3, 2);
        _b3[0];
        var dataTypeMatcher = _b3[1];
        return dataTypeMatcher(value);
      })) !== null && _a2 !== void 0 ? _a2 : ["object"], 1), cellDataType = _b2[0];
      return cellDataType;
    };
    DataTypeService2.prototype.getInitialData = function() {
      var rowData = this.gridOptionsService.get("rowData");
      if (rowData === null || rowData === void 0 ? void 0 : rowData.length) {
        return rowData[0];
      } else if (this.initialData) {
        return this.initialData;
      } else {
        var rowNodes = this.rowModel.getRootNode().allLeafChildren;
        if (rowNodes === null || rowNodes === void 0 ? void 0 : rowNodes.length) {
          return rowNodes[0].data;
        }
      }
      return null;
    };
    DataTypeService2.prototype.initWaitForRowData = function(colId) {
      var _this = this;
      this.columnStateUpdatesPendingInference[colId] = /* @__PURE__ */ new Set();
      if (this.isWaitingForRowData) {
        return;
      }
      this.isWaitingForRowData = true;
      var columnTypeOverridesExist = this.isColumnTypeOverrideInDataTypeDefinitions;
      if (columnTypeOverridesExist) {
        this.columnModel.queueResizeOperations();
      }
      var destroyFunc = this.addManagedListener(this.eventService, Events.EVENT_ROW_DATA_UPDATE_STARTED, function(event) {
        var firstRowData = event.firstRowData;
        if (!firstRowData) {
          return;
        }
        destroyFunc === null || destroyFunc === void 0 ? void 0 : destroyFunc();
        _this.isWaitingForRowData = false;
        _this.processColumnsPendingInference(firstRowData, columnTypeOverridesExist);
        _this.columnStateUpdatesPendingInference = {};
        if (columnTypeOverridesExist) {
          _this.columnModel.processResizeOperations();
        }
      });
    };
    DataTypeService2.prototype.processColumnsPendingInference = function(firstRowData, columnTypeOverridesExist) {
      var _this = this;
      this.initialData = firstRowData;
      var state = [];
      this.columnStateUpdateListenerDestroyFuncs.forEach(function(destroyFunc) {
        return destroyFunc();
      });
      this.columnStateUpdateListenerDestroyFuncs = [];
      var newRowGroupColumnStateWithoutIndex = {};
      var newPivotColumnStateWithoutIndex = {};
      Object.entries(this.columnStateUpdatesPendingInference).forEach(function(_a2) {
        var _b2 = __read$4(_a2, 2), colId = _b2[0], columnStateUpdates = _b2[1];
        var column = _this.columnModel.getGridColumn(colId);
        if (!column) {
          return;
        }
        var oldColDef = column.getColDef();
        if (!_this.columnModel.resetColumnDefIntoColumn(column)) {
          return;
        }
        var newColDef = column.getColDef();
        if (columnTypeOverridesExist && newColDef.type && newColDef.type !== oldColDef.type) {
          var updatedColumnState = _this.getUpdatedColumnState(column, columnStateUpdates);
          if (updatedColumnState.rowGroup && updatedColumnState.rowGroupIndex == null) {
            newRowGroupColumnStateWithoutIndex[colId] = updatedColumnState;
          }
          if (updatedColumnState.pivot && updatedColumnState.pivotIndex == null) {
            newPivotColumnStateWithoutIndex[colId] = updatedColumnState;
          }
          state.push(updatedColumnState);
        }
      });
      if (columnTypeOverridesExist) {
        state.push.apply(state, __spreadArray$3$1([], __read$4(this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(newRowGroupColumnStateWithoutIndex, newPivotColumnStateWithoutIndex))));
      }
      if (state.length) {
        this.columnModel.applyColumnState({ state }, "cellDataTypeInferred");
      }
      this.initialData = null;
    };
    DataTypeService2.prototype.getUpdatedColumnState = function(column, columnStateUpdates) {
      var columnState = this.columnModel.getColumnStateFromColDef(column);
      columnStateUpdates.forEach(function(key) {
        delete columnState[key];
        if (key === "rowGroup") {
          delete columnState.rowGroupIndex;
        } else if (key === "pivot") {
          delete columnState.pivotIndex;
        }
      });
      return columnState;
    };
    DataTypeService2.prototype.checkObjectValueHandlers = function(defaultDataTypes) {
      var resolvedObjectDataTypeDefinition = this.dataTypeDefinitions.object;
      var defaultObjectDataTypeDefinition = defaultDataTypes.object;
      this.hasObjectValueParser = resolvedObjectDataTypeDefinition.valueParser !== defaultObjectDataTypeDefinition.valueParser;
      this.hasObjectValueFormatter = resolvedObjectDataTypeDefinition.valueFormatter !== defaultObjectDataTypeDefinition.valueFormatter;
    };
    DataTypeService2.prototype.convertColumnTypes = function(type) {
      var typeKeys = [];
      if (type instanceof Array) {
        var invalidArray = type.some(function(a) {
          return typeof a !== "string";
        });
        if (invalidArray) {
          console.warn("AG Grid: if colDef.type is supplied an array it should be of type 'string[]'");
        } else {
          typeKeys = type;
        }
      } else if (typeof type === "string") {
        typeKeys = type.split(",");
      } else {
        console.warn("AG Grid: colDef.type should be of type 'string' | 'string[]'");
      }
      return typeKeys;
    };
    DataTypeService2.prototype.getDateStringTypeDefinition = function() {
      return this.dataTypeDefinitions.dateString;
    };
    DataTypeService2.prototype.getDateParserFunction = function() {
      return this.getDateStringTypeDefinition().dateParser;
    };
    DataTypeService2.prototype.getDateFormatterFunction = function() {
      return this.getDateStringTypeDefinition().dateFormatter;
    };
    DataTypeService2.prototype.checkType = function(column, value) {
      var _a2;
      var colDef = column.getColDef();
      if (!colDef.cellDataType || value == null) {
        return true;
      }
      var dataTypeMatcher = (_a2 = this.dataTypeDefinitions[colDef.cellDataType]) === null || _a2 === void 0 ? void 0 : _a2.dataTypeMatcher;
      if (!dataTypeMatcher) {
        return true;
      }
      return dataTypeMatcher(value);
    };
    DataTypeService2.prototype.validateColDef = function(colDef) {
      if (colDef.cellDataType === "object") {
        if (colDef.valueFormatter === this.dataTypeDefinitions.object.groupSafeValueFormatter && !this.hasObjectValueFormatter) {
          doOnce(function() {
            return console.warn('AG Grid: Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"');
          }, "dataTypeObjectValueFormatter");
        }
        if (colDef.editable && colDef.valueParser === this.dataTypeDefinitions.object.valueParser && !this.hasObjectValueParser) {
          doOnce(function() {
            return console.warn('AG Grid: Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"');
          }, "dataTypeObjectValueParser");
        }
      }
    };
    DataTypeService2.prototype.setColDefPropertiesForBaseDataType = function(colDef, dataTypeDefinition, colId) {
      var _this = this;
      var formatValue = function(column, node, value) {
        var valueFormatter = column.getColDef().valueFormatter;
        if (valueFormatter === dataTypeDefinition.groupSafeValueFormatter) {
          valueFormatter = dataTypeDefinition.valueFormatter;
        }
        return _this.valueFormatterService.formatValue(column, node, value, valueFormatter);
      };
      var usingSetFilter = ModuleRegistry.__isRegistered(ModuleNames.SetFilterModule, this.context.getGridId());
      var translate = this.localeService.getLocaleTextFunc();
      var mergeFilterParams = function(params) {
        var filterParams = colDef.filterParams;
        colDef.filterParams = typeof filterParams === "object" ? __assign$m(__assign$m({}, filterParams), params) : params;
      };
      colDef.useValueFormatterForExport = true;
      colDef.useValueParserForImport = true;
      switch (dataTypeDefinition.baseDataType) {
        case "number": {
          colDef.cellEditor = "agNumberCellEditor";
          if (usingSetFilter) {
            mergeFilterParams({
              comparator: function(a, b) {
                var valA = a == null ? 0 : parseInt(a);
                var valB = b == null ? 0 : parseInt(b);
                if (valA === valB)
                  return 0;
                return valA > valB ? 1 : -1;
              }
            });
          }
          break;
        }
        case "boolean": {
          colDef.cellEditor = "agCheckboxCellEditor";
          colDef.cellRenderer = "agCheckboxCellRenderer";
          colDef.suppressKeyboardEvent = function(params) {
            return !!params.colDef.editable && params.event.key === KeyCode.SPACE;
          };
          if (usingSetFilter) {
            mergeFilterParams({
              valueFormatter: function(params) {
                if (!exists(params.value)) {
                  return translate("blanks", "(Blanks)");
                }
                return translate(String(params.value), params.value ? "True" : "False");
              }
            });
          } else {
            mergeFilterParams({
              maxNumConditions: 1,
              filterOptions: [
                "empty",
                {
                  displayKey: "true",
                  displayName: "True",
                  predicate: function(_filterValues, cellValue) {
                    return cellValue;
                  },
                  numberOfInputs: 0
                },
                {
                  displayKey: "false",
                  displayName: "False",
                  predicate: function(_filterValues, cellValue) {
                    return cellValue === false;
                  },
                  numberOfInputs: 0
                }
              ]
            });
          }
          break;
        }
        case "date": {
          colDef.cellEditor = "agDateCellEditor";
          colDef.keyCreator = function(params) {
            return formatValue(params.column, params.node, params.value);
          };
          if (usingSetFilter) {
            mergeFilterParams({
              valueFormatter: function(params) {
                var valueFormatted = formatValue(params.column, params.node, params.value);
                return exists(valueFormatted) ? valueFormatted : translate("blanks", "(Blanks)");
              },
              treeList: true,
              treeListFormatter: function(pathKey, level) {
                if (level === 1 && pathKey != null) {
                  var monthKey = MONTH_KEYS[Number(pathKey) - 1];
                  return translate(monthKey, MONTH_LOCALE_TEXT[monthKey]);
                }
                return pathKey !== null && pathKey !== void 0 ? pathKey : translate("blanks", "(Blanks)");
              }
            });
          }
          break;
        }
        case "dateString": {
          colDef.cellEditor = "agDateStringCellEditor";
          colDef.keyCreator = function(params) {
            return formatValue(params.column, params.node, params.value);
          };
          var convertToDate_1 = this.getDateParserFunction();
          if (usingSetFilter) {
            mergeFilterParams({
              valueFormatter: function(params) {
                var valueFormatted = formatValue(params.column, params.node, params.value);
                return exists(valueFormatted) ? valueFormatted : translate("blanks", "(Blanks)");
              },
              treeList: true,
              treeListPathGetter: function(value) {
                var date = convertToDate_1(value !== null && value !== void 0 ? value : void 0);
                return date ? [String(date.getFullYear()), String(date.getMonth() + 1), String(date.getDate())] : null;
              },
              treeListFormatter: function(pathKey, level) {
                if (level === 1 && pathKey != null) {
                  var monthKey = MONTH_KEYS[Number(pathKey) - 1];
                  return translate(monthKey, MONTH_LOCALE_TEXT[monthKey]);
                }
                return pathKey !== null && pathKey !== void 0 ? pathKey : translate("blanks", "(Blanks)");
              }
            });
          } else {
            mergeFilterParams({
              comparator: function(filterDate, cellValue) {
                var cellAsDate = convertToDate_1(cellValue);
                if (cellValue == null || cellAsDate < filterDate) {
                  return -1;
                }
                if (cellAsDate > filterDate) {
                  return 1;
                }
                return 0;
              }
            });
          }
          break;
        }
        case "object": {
          colDef.cellEditorParams = {
            useFormatter: true
          };
          colDef.comparator = function(a, b) {
            var column = _this.columnModel.getPrimaryColumn(colId);
            var colDef2 = column === null || column === void 0 ? void 0 : column.getColDef();
            if (!column || !colDef2) {
              return 0;
            }
            var valA = a == null ? "" : formatValue(column, null, a);
            var valB = b == null ? "" : formatValue(column, null, b);
            if (valA === valB)
              return 0;
            return valA > valB ? 1 : -1;
          };
          colDef.keyCreator = function(params) {
            return formatValue(params.column, params.node, params.value);
          };
          if (usingSetFilter) {
            mergeFilterParams({
              valueFormatter: function(params) {
                var valueFormatted = formatValue(params.column, params.node, params.value);
                return exists(valueFormatted) ? valueFormatted : translate("blanks", "(Blanks)");
              }
            });
          } else {
            colDef.filterValueGetter = function(params) {
              return formatValue(params.column, params.node, _this.valueService.getValue(params.column, params.node));
            };
          }
          break;
        }
      }
    };
    DataTypeService2.prototype.getDefaultDataTypes = function() {
      var defaultDateFormatMatcher = function(value) {
        return !!value.match("^\\d{4}-\\d{2}-\\d{2}$");
      };
      var translate = this.localeService.getLocaleTextFunc();
      return {
        number: {
          baseDataType: "number",
          valueParser: function(params) {
            return params.newValue === "" ? null : Number(params.newValue);
          },
          valueFormatter: function(params) {
            if (params.value == null) {
              return "";
            }
            if (typeof params.value !== "number" || isNaN(params.value)) {
              return translate("invalidNumber", "Invalid Number");
            }
            return String(params.value);
          },
          dataTypeMatcher: function(value) {
            return typeof value === "number";
          }
        },
        text: {
          baseDataType: "text",
          valueParser: function(params) {
            return params.newValue === "" ? null : toStringOrNull(params.newValue);
          },
          dataTypeMatcher: function(value) {
            return typeof value === "string";
          }
        },
        boolean: {
          baseDataType: "boolean",
          valueParser: function(params) {
            return params.newValue === "" ? null : String(params.newValue).toLowerCase() === "true";
          },
          valueFormatter: function(params) {
            return params.value == null ? "" : String(params.value);
          },
          dataTypeMatcher: function(value) {
            return typeof value === "boolean";
          }
        },
        date: {
          baseDataType: "date",
          valueParser: function(params) {
            return parseDateTimeFromString(params.newValue == null ? null : String(params.newValue));
          },
          valueFormatter: function(params) {
            var _a2;
            if (params.value == null) {
              return "";
            }
            if (!(params.value instanceof Date) || isNaN(params.value.getTime())) {
              return translate("invalidDate", "Invalid Date");
            }
            return (_a2 = serialiseDate(params.value, false)) !== null && _a2 !== void 0 ? _a2 : "";
          },
          dataTypeMatcher: function(value) {
            return value instanceof Date;
          }
        },
        dateString: {
          baseDataType: "dateString",
          dateParser: function(value) {
            var _a2;
            return (_a2 = parseDateTimeFromString(value)) !== null && _a2 !== void 0 ? _a2 : void 0;
          },
          dateFormatter: function(value) {
            var _a2;
            return (_a2 = serialiseDate(value !== null && value !== void 0 ? value : null, false)) !== null && _a2 !== void 0 ? _a2 : void 0;
          },
          valueParser: function(params) {
            return defaultDateFormatMatcher(String(params.newValue)) ? params.newValue : null;
          },
          valueFormatter: function(params) {
            return defaultDateFormatMatcher(String(params.value)) ? params.value : "";
          },
          dataTypeMatcher: function(value) {
            return typeof value === "string" && defaultDateFormatMatcher(value);
          }
        },
        object: {
          baseDataType: "object",
          valueParser: function() {
            return null;
          },
          valueFormatter: function(params) {
            var _a2;
            return (_a2 = toStringOrNull(params.value)) !== null && _a2 !== void 0 ? _a2 : "";
          }
        }
      };
    };
    __decorate$d([
      Autowired("rowModel")
    ], DataTypeService2.prototype, "rowModel", void 0);
    __decorate$d([
      Autowired("columnModel")
    ], DataTypeService2.prototype, "columnModel", void 0);
    __decorate$d([
      Autowired("columnUtils")
    ], DataTypeService2.prototype, "columnUtils", void 0);
    __decorate$d([
      Autowired("valueService")
    ], DataTypeService2.prototype, "valueService", void 0);
    __decorate$d([
      Autowired("valueFormatterService")
    ], DataTypeService2.prototype, "valueFormatterService", void 0);
    __decorate$d([
      PostConstruct
    ], DataTypeService2.prototype, "init", null);
    DataTypeService2 = __decorate$d([
      Bean("dataTypeService")
    ], DataTypeService2);
    return DataTypeService2;
  }(BeanStub)
);
var __extends$d = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$c = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var ValueParserService = (
  /** @class */
  function(_super) {
    __extends$d(ValueParserService2, _super);
    function ValueParserService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ValueParserService2.prototype.parseValue = function(column, rowNode, newValue, oldValue) {
      var colDef = column.getColDef();
      var params = {
        node: rowNode,
        data: rowNode === null || rowNode === void 0 ? void 0 : rowNode.data,
        oldValue,
        newValue,
        colDef,
        column,
        api: this.gridOptionsService.api,
        columnApi: this.gridOptionsService.columnApi,
        context: this.gridOptionsService.context
      };
      var valueParser = colDef.valueParser;
      if (exists(valueParser)) {
        if (typeof valueParser === "function") {
          return valueParser(params);
        }
        return this.expressionService.evaluate(valueParser, params);
      }
      return newValue;
    };
    __decorate$c([
      Autowired("expressionService")
    ], ValueParserService2.prototype, "expressionService", void 0);
    ValueParserService2 = __decorate$c([
      Bean("valueParserService")
    ], ValueParserService2);
    return ValueParserService2;
  }(BeanStub)
);
var __read$3 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$2$1 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var Grid = (
  /** @class */
  function() {
    function Grid2(eGridDiv, gridOptions, params) {
      if (!gridOptions) {
        console.error("AG Grid: no gridOptions provided to the grid");
        return;
      }
      this.gridOptions = gridOptions;
      new GridCoreCreator().create(eGridDiv, gridOptions, function(context) {
        var gridComp2 = new GridComp$1(eGridDiv);
        context.createBean(gridComp2);
      }, void 0, params);
    }
    Grid2.prototype.destroy = function() {
      if (this.gridOptions && this.gridOptions.api) {
        this.gridOptions.api.destroy();
      }
    };
    return Grid2;
  }()
);
var nextGridId = 1;
var GridCoreCreator = (
  /** @class */
  function() {
    function GridCoreCreator2() {
    }
    GridCoreCreator2.prototype.create = function(eGridDiv, gridOptions, createUi, acceptChanges, params) {
      var _this = this;
      var _a2;
      var debug = !!gridOptions.debug;
      var gridId = (_a2 = gridOptions.gridId) !== null && _a2 !== void 0 ? _a2 : String(nextGridId++);
      var registeredModules = this.getRegisteredModules(params, gridId);
      var beanClasses = this.createBeansList(gridOptions.rowModelType, registeredModules, gridId);
      var providedBeanInstances = this.createProvidedBeans(eGridDiv, gridOptions, params);
      if (!beanClasses) {
        return;
      }
      var contextParams = {
        providedBeanInstances,
        beanClasses,
        debug,
        gridId
      };
      var logger = new Logger("AG Grid", function() {
        return gridOptions.debug;
      });
      var contextLogger = new Logger("Context", function() {
        return contextParams.debug;
      });
      var context = new Context(contextParams, contextLogger);
      var beans = context.getBean("beans");
      this.registerModuleUserComponents(beans, registeredModules);
      this.registerStackComponents(beans, registeredModules);
      this.registerControllers(beans, registeredModules);
      createUi(context);
      beans.ctrlsService.whenReady(function() {
        _this.setColumnsAndData(beans);
        _this.dispatchGridReadyEvent(beans);
        var isEnterprise = ModuleRegistry.__isRegistered(ModuleNames.EnterpriseCoreModule, gridId);
        logger.log("initialised successfully, enterprise = " + isEnterprise);
      });
      if (acceptChanges) {
        acceptChanges(context);
      }
    };
    GridCoreCreator2.prototype.registerControllers = function(beans, registeredModules) {
      registeredModules.forEach(function(module2) {
        if (module2.controllers) {
          module2.controllers.forEach(function(meta) {
            return beans.ctrlsFactory.register(meta);
          });
        }
      });
    };
    GridCoreCreator2.prototype.registerStackComponents = function(beans, registeredModules) {
      var agStackComponents = this.createAgStackComponentsList(registeredModules);
      beans.agStackComponentsRegistry.setupComponents(agStackComponents);
    };
    GridCoreCreator2.prototype.getRegisteredModules = function(params, gridId) {
      var passedViaConstructor = params ? params.modules : null;
      var registered = ModuleRegistry.__getRegisteredModules(gridId);
      var allModules = [];
      var mapNames = {};
      var addModule = function(moduleBased, mod2, gridId2) {
        var addIndividualModule = function(currentModule) {
          if (!mapNames[currentModule.moduleName]) {
            mapNames[currentModule.moduleName] = true;
            allModules.push(currentModule);
            ModuleRegistry.__register(currentModule, moduleBased, gridId2);
          }
        };
        addIndividualModule(mod2);
        if (mod2.dependantModules) {
          mod2.dependantModules.forEach(function(m2) {
            return addModule(moduleBased, m2, gridId2);
          });
        }
      };
      if (passedViaConstructor) {
        passedViaConstructor.forEach(function(m2) {
          return addModule(true, m2, gridId);
        });
      }
      if (registered) {
        registered.forEach(function(m2) {
          return addModule(!ModuleRegistry.__isPackageBased(), m2, void 0);
        });
      }
      return allModules;
    };
    GridCoreCreator2.prototype.registerModuleUserComponents = function(beans, registeredModules) {
      var moduleUserComps = this.extractModuleEntity(registeredModules, function(module2) {
        return module2.userComponents ? module2.userComponents : [];
      });
      moduleUserComps.forEach(function(compMeta) {
        beans.userComponentRegistry.registerDefaultComponent(compMeta.componentName, compMeta.componentClass);
      });
    };
    GridCoreCreator2.prototype.createProvidedBeans = function(eGridDiv, gridOptions, params) {
      var frameworkOverrides = params ? params.frameworkOverrides : null;
      if (missing(frameworkOverrides)) {
        frameworkOverrides = new VanillaFrameworkOverrides();
      }
      var seed = {
        gridOptions,
        eGridDiv,
        globalEventListener: params ? params.globalEventListener : null,
        frameworkOverrides
      };
      if (params && params.providedBeanInstances) {
        Object.assign(seed, params.providedBeanInstances);
      }
      return seed;
    };
    GridCoreCreator2.prototype.createAgStackComponentsList = function(registeredModules) {
      var components = [
        { componentName: "AgCheckbox", componentClass: AgCheckbox },
        { componentName: "AgRadioButton", componentClass: AgRadioButton },
        { componentName: "AgToggleButton", componentClass: AgToggleButton },
        { componentName: "AgInputTextField", componentClass: AgInputTextField },
        { componentName: "AgInputTextArea", componentClass: AgInputTextArea },
        { componentName: "AgInputNumberField", componentClass: AgInputNumberField },
        { componentName: "AgInputDateField", componentClass: AgInputDateField },
        { componentName: "AgInputRange", componentClass: AgInputRange },
        { componentName: "AgSelect", componentClass: AgSelect },
        { componentName: "AgSlider", componentClass: AgSlider },
        { componentName: "AgGridBody", componentClass: GridBodyComp$1 },
        { componentName: "AgHeaderRoot", componentClass: GridHeaderComp$1 },
        { componentName: "AgSortIndicator", componentClass: SortIndicatorComp },
        { componentName: "AgPagination", componentClass: PaginationComp },
        { componentName: "AgOverlayWrapper", componentClass: OverlayWrapperComponent },
        { componentName: "AgGroupComponent", componentClass: AgGroupComponent },
        { componentName: "AgPanel", componentClass: AgPanel },
        { componentName: "AgDialog", componentClass: AgDialog },
        { componentName: "AgRowContainer", componentClass: RowContainerComp$1 },
        { componentName: "AgFakeHorizontalScroll", componentClass: FakeHScrollComp },
        { componentName: "AgFakeVerticalScroll", componentClass: FakeVScrollComp }
      ];
      var moduleAgStackComps = this.extractModuleEntity(registeredModules, function(module2) {
        return module2.agStackComponents ? module2.agStackComponents : [];
      });
      components = components.concat(moduleAgStackComps);
      return components;
    };
    GridCoreCreator2.prototype.createBeansList = function(rowModelType, registeredModules, gridId) {
      if (rowModelType === void 0) {
        rowModelType = "clientSide";
      }
      var rowModelModules = registeredModules.filter(function(module2) {
        return !module2.rowModel || module2.rowModel === rowModelType;
      });
      var rowModelModuleNames = {
        clientSide: ModuleNames.ClientSideRowModelModule,
        infinite: ModuleNames.InfiniteRowModelModule,
        serverSide: ModuleNames.ServerSideRowModelModule,
        viewport: ModuleNames.ViewportRowModelModule
      };
      if (!rowModelModuleNames[rowModelType]) {
        console.error("AG Grid: could not find row model for rowModelType = " + rowModelType);
        return;
      }
      if (!ModuleRegistry.__assertRegistered(rowModelModuleNames[rowModelType], "rowModelType = '" + rowModelType + "'", gridId)) {
        return;
      }
      var beans = [
        Beans,
        RowPositionUtils,
        CellPositionUtils,
        HeaderPositionUtils,
        PaginationAutoPageSizeService,
        GridApi,
        UserComponentRegistry,
        AgComponentUtils,
        ComponentMetadataProvider,
        ResizeObserverService,
        UserComponentFactory,
        RowContainerHeightService,
        HorizontalResizeService,
        LocaleService,
        GridOptionsValidator,
        PinnedRowModel,
        DragService,
        DisplayedGroupCreator,
        EventService,
        GridOptionsService,
        PopupService,
        SelectionService,
        FilterManager,
        ColumnModel,
        HeaderNavigationService,
        PaginationProxy,
        RowRenderer,
        ExpressionService,
        ColumnFactory,
        TemplateService,
        AlignedGridsService,
        NavigationService,
        ValueCache,
        ValueService,
        LoggerFactory,
        ColumnUtils,
        AutoWidthCalculator,
        StandardMenuFactory,
        DragAndDropService,
        ColumnApi,
        FocusService,
        MouseEventService,
        Environment,
        CellNavigationService,
        ValueFormatterService,
        StylingService,
        ScrollVisibleService,
        SortController,
        ColumnHoverService,
        ColumnAnimationService,
        SelectableService,
        AutoGroupColService,
        ChangeDetectionService,
        AnimationFrameService,
        UndoRedoService,
        AgStackComponentsRegistry,
        ColumnDefFactory,
        RowCssClassCalculator,
        RowNodeBlockLoader,
        RowNodeSorter,
        CtrlsService,
        PinnedWidthService,
        RowNodeEventThrottle,
        CtrlsFactory,
        DataTypeService,
        ValueParserService
      ];
      var moduleBeans = this.extractModuleEntity(rowModelModules, function(module2) {
        return module2.beans ? module2.beans : [];
      });
      beans.push.apply(beans, __spreadArray$2$1([], __read$3(moduleBeans)));
      var beansNoDuplicates = [];
      beans.forEach(function(bean) {
        if (beansNoDuplicates.indexOf(bean) < 0) {
          beansNoDuplicates.push(bean);
        }
      });
      return beansNoDuplicates;
    };
    GridCoreCreator2.prototype.extractModuleEntity = function(moduleEntities, extractor) {
      return [].concat.apply([], __spreadArray$2$1([], __read$3(moduleEntities.map(extractor))));
    };
    GridCoreCreator2.prototype.setColumnsAndData = function(beans) {
      var columnDefs = beans.gridOptionsService.get("columnDefs");
      beans.columnModel.setColumnDefs(columnDefs || [], "gridInitializing");
      beans.rowModel.start();
    };
    GridCoreCreator2.prototype.dispatchGridReadyEvent = function(beans) {
      var readyEvent = {
        type: Events.EVENT_GRID_READY
      };
      beans.eventService.dispatchEvent(readyEvent);
    };
    return GridCoreCreator2;
  }()
);
var BaseComponentWrapper = (
  /** @class */
  function() {
    function BaseComponentWrapper2() {
    }
    BaseComponentWrapper2.prototype.wrap = function(OriginalConstructor, mandatoryMethodList, optionalMethodList, componentType) {
      var _this = this;
      if (optionalMethodList === void 0) {
        optionalMethodList = [];
      }
      var wrapper = this.createWrapper(OriginalConstructor, componentType);
      mandatoryMethodList.forEach(function(methodName) {
        _this.createMethod(wrapper, methodName, true);
      });
      optionalMethodList.forEach(function(methodName) {
        _this.createMethod(wrapper, methodName, false);
      });
      return wrapper;
    };
    BaseComponentWrapper2.prototype.unwrap = function(comp) {
      return comp;
    };
    BaseComponentWrapper2.prototype.createMethod = function(wrapper, methodName, mandatory) {
      wrapper.addMethod(methodName, this.createMethodProxy(wrapper, methodName, mandatory));
    };
    BaseComponentWrapper2.prototype.createMethodProxy = function(wrapper, methodName, mandatory) {
      return function() {
        if (wrapper.hasMethod(methodName)) {
          return wrapper.callMethod(methodName, arguments);
        }
        if (mandatory) {
          console.warn("AG Grid: Framework component is missing the method " + methodName + "()");
        }
        return null;
      };
    };
    return BaseComponentWrapper2;
  }()
);
var DEFAULT_CHART_GROUPS = {
  columnGroup: [
    "column",
    "stackedColumn",
    "normalizedColumn"
  ],
  barGroup: [
    "bar",
    "stackedBar",
    "normalizedBar"
  ],
  pieGroup: [
    "pie",
    "doughnut"
  ],
  lineGroup: [
    "line"
  ],
  scatterGroup: [
    "scatter",
    "bubble"
  ],
  areaGroup: [
    "area",
    "stackedArea",
    "normalizedArea"
  ],
  histogramGroup: [
    "histogram"
  ],
  combinationGroup: [
    "columnLineCombo",
    "areaColumnCombo",
    "customCombo"
  ]
};
var CHART_TOOL_PANEL_ALLOW_LIST = [
  "chartSettings",
  "chartData",
  "chartFormat"
];
var CHART_TOOLBAR_ALLOW_LIST = [
  "chartUnlink",
  "chartLink",
  "chartDownload"
];
var CHART_TOOL_PANEL_MENU_OPTIONS = {
  settings: "chartSettings",
  data: "chartData",
  format: "chartFormat"
};
var __FORCE_MODULE_DETECTION = 0;
var BarColumnLabelPlacement;
(function(BarColumnLabelPlacement2) {
  BarColumnLabelPlacement2["InsideBase"] = "insideBase";
  BarColumnLabelPlacement2["InsideEnd"] = "insideEnd";
  BarColumnLabelPlacement2["Center"] = "center";
  BarColumnLabelPlacement2["OutsideEnd"] = "outsideEnd";
})(BarColumnLabelPlacement || (BarColumnLabelPlacement = {}));
/**
 * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue
 * @version v30.0.6
 * @link https://www.ag-grid.com/
 * @license MIT
 */
var globalObj = typeof global === "undefined" ? {} : global;
globalObj.HTMLElement = typeof HTMLElement === "undefined" ? {} : HTMLElement;
globalObj.HTMLButtonElement = typeof HTMLButtonElement === "undefined" ? {} : HTMLButtonElement;
globalObj.HTMLSelectElement = typeof HTMLSelectElement === "undefined" ? {} : HTMLSelectElement;
globalObj.HTMLInputElement = typeof HTMLInputElement === "undefined" ? {} : HTMLInputElement;
globalObj.Node = typeof Node === "undefined" ? {} : Node;
globalObj.MouseEvent = typeof MouseEvent === "undefined" ? {} : MouseEvent;
var __read$2 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$1$1 = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var ClientSideNodeManager = (
  /** @class */
  function() {
    function ClientSideNodeManager2(rootNode, gridOptionsService, eventService, columnModel, selectionService, beans) {
      this.nextId = 0;
      this.allNodesMap = {};
      this.rootNode = rootNode;
      this.gridOptionsService = gridOptionsService;
      this.eventService = eventService;
      this.columnModel = columnModel;
      this.beans = beans;
      this.selectionService = selectionService;
      this.rootNode.group = true;
      this.rootNode.level = -1;
      this.rootNode.id = ClientSideNodeManager2.ROOT_NODE_ID;
      this.rootNode.allLeafChildren = [];
      this.rootNode.childrenAfterGroup = [];
      this.rootNode.childrenAfterSort = [];
      this.rootNode.childrenAfterAggFilter = [];
      this.rootNode.childrenAfterFilter = [];
      this.postConstruct();
    }
    ClientSideNodeManager2.prototype.postConstruct = function() {
      this.suppressParentsInRowNodes = this.gridOptionsService.is("suppressParentsInRowNodes");
      this.isRowMasterFunc = this.gridOptionsService.get("isRowMaster");
      this.doingTreeData = this.gridOptionsService.isTreeData();
      this.doingMasterDetail = this.gridOptionsService.isMasterDetail();
    };
    ClientSideNodeManager2.prototype.getCopyOfNodesMap = function() {
      return _.cloneObject(this.allNodesMap);
    };
    ClientSideNodeManager2.prototype.getRowNode = function(id2) {
      return this.allNodesMap[id2];
    };
    ClientSideNodeManager2.prototype.setRowData = function(rowData) {
      var _this = this;
      if (typeof rowData === "string") {
        console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first");
        return;
      }
      this.dispatchRowDataUpdateStartedEvent(rowData);
      var rootNode = this.rootNode;
      var sibling = this.rootNode.sibling;
      rootNode.childrenAfterFilter = null;
      rootNode.childrenAfterGroup = null;
      rootNode.childrenAfterAggFilter = null;
      rootNode.childrenAfterSort = null;
      rootNode.childrenMapped = null;
      rootNode.updateHasChildren();
      this.nextId = 0;
      this.allNodesMap = {};
      if (rowData) {
        rootNode.allLeafChildren = rowData.map(function(dataItem) {
          return _this.createNode(dataItem, _this.rootNode, ClientSideNodeManager2.TOP_LEVEL);
        });
      } else {
        rootNode.allLeafChildren = [];
        rootNode.childrenAfterGroup = [];
      }
      if (sibling) {
        sibling.childrenAfterFilter = rootNode.childrenAfterFilter;
        sibling.childrenAfterGroup = rootNode.childrenAfterGroup;
        sibling.childrenAfterAggFilter = rootNode.childrenAfterAggFilter;
        sibling.childrenAfterSort = rootNode.childrenAfterSort;
        sibling.childrenMapped = rootNode.childrenMapped;
        sibling.allLeafChildren = rootNode.allLeafChildren;
      }
    };
    ClientSideNodeManager2.prototype.updateRowData = function(rowDataTran, rowNodeOrder) {
      this.dispatchRowDataUpdateStartedEvent(rowDataTran.add);
      var rowNodeTransaction = {
        remove: [],
        update: [],
        add: []
      };
      var nodesToUnselect = [];
      this.executeRemove(rowDataTran, rowNodeTransaction, nodesToUnselect);
      this.executeUpdate(rowDataTran, rowNodeTransaction, nodesToUnselect);
      this.executeAdd(rowDataTran, rowNodeTransaction);
      this.updateSelection(nodesToUnselect, "rowDataChanged");
      if (rowNodeOrder) {
        _.sortRowNodesByOrder(this.rootNode.allLeafChildren, rowNodeOrder);
      }
      return rowNodeTransaction;
    };
    ClientSideNodeManager2.prototype.dispatchRowDataUpdateStartedEvent = function(rowData) {
      var event = {
        type: Events.EVENT_ROW_DATA_UPDATE_STARTED,
        firstRowData: (rowData === null || rowData === void 0 ? void 0 : rowData.length) ? rowData[0] : null
      };
      this.eventService.dispatchEvent(event);
    };
    ClientSideNodeManager2.prototype.updateSelection = function(nodesToUnselect, source) {
      var selectionChanged = nodesToUnselect.length > 0;
      if (selectionChanged) {
        this.selectionService.setNodesSelected({
          newValue: false,
          nodes: nodesToUnselect,
          suppressFinishActions: true,
          source
        });
      }
      this.selectionService.updateGroupsFromChildrenSelections(source);
      if (selectionChanged) {
        var event_1 = {
          type: Events.EVENT_SELECTION_CHANGED,
          source
        };
        this.eventService.dispatchEvent(event_1);
      }
    };
    ClientSideNodeManager2.prototype.executeAdd = function(rowDataTran, rowNodeTransaction) {
      var _this = this;
      var _a2;
      var add2 = rowDataTran.add, addIndex = rowDataTran.addIndex;
      if (_.missingOrEmpty(add2)) {
        return;
      }
      var newNodes = add2.map(function(item) {
        return _this.createNode(item, _this.rootNode, ClientSideNodeManager2.TOP_LEVEL);
      });
      if (typeof addIndex === "number" && addIndex >= 0) {
        var allLeafChildren = this.rootNode.allLeafChildren;
        var len = allLeafChildren.length;
        var normalisedAddIndex = addIndex;
        if (this.doingTreeData && addIndex > 0 && len > 0) {
          for (var i = 0; i < len; i++) {
            if (((_a2 = allLeafChildren[i]) === null || _a2 === void 0 ? void 0 : _a2.rowIndex) == addIndex - 1) {
              normalisedAddIndex = i + 1;
              break;
            }
          }
        }
        var nodesBeforeIndex = allLeafChildren.slice(0, normalisedAddIndex);
        var nodesAfterIndex = allLeafChildren.slice(normalisedAddIndex, allLeafChildren.length);
        this.rootNode.allLeafChildren = __spreadArray$1$1(__spreadArray$1$1(__spreadArray$1$1([], __read$2(nodesBeforeIndex)), __read$2(newNodes)), __read$2(nodesAfterIndex));
      } else {
        this.rootNode.allLeafChildren = __spreadArray$1$1(__spreadArray$1$1([], __read$2(this.rootNode.allLeafChildren)), __read$2(newNodes));
      }
      if (this.rootNode.sibling) {
        this.rootNode.sibling.allLeafChildren = this.rootNode.allLeafChildren;
      }
      rowNodeTransaction.add = newNodes;
    };
    ClientSideNodeManager2.prototype.executeRemove = function(rowDataTran, rowNodeTransaction, nodesToUnselect) {
      var _this = this;
      var remove = rowDataTran.remove;
      if (_.missingOrEmpty(remove)) {
        return;
      }
      var rowIdsRemoved = {};
      remove.forEach(function(item) {
        var rowNode = _this.lookupRowNode(item);
        if (!rowNode) {
          return;
        }
        if (rowNode.isSelected()) {
          nodesToUnselect.push(rowNode);
        }
        rowNode.clearRowTopAndRowIndex();
        rowIdsRemoved[rowNode.id] = true;
        delete _this.allNodesMap[rowNode.id];
        rowNodeTransaction.remove.push(rowNode);
      });
      this.rootNode.allLeafChildren = this.rootNode.allLeafChildren.filter(function(rowNode) {
        return !rowIdsRemoved[rowNode.id];
      });
      if (this.rootNode.sibling) {
        this.rootNode.sibling.allLeafChildren = this.rootNode.allLeafChildren;
      }
    };
    ClientSideNodeManager2.prototype.executeUpdate = function(rowDataTran, rowNodeTransaction, nodesToUnselect) {
      var _this = this;
      var update = rowDataTran.update;
      if (_.missingOrEmpty(update)) {
        return;
      }
      update.forEach(function(item) {
        var rowNode = _this.lookupRowNode(item);
        if (!rowNode) {
          return;
        }
        rowNode.updateData(item);
        if (!rowNode.selectable && rowNode.isSelected()) {
          nodesToUnselect.push(rowNode);
        }
        _this.setMasterForRow(rowNode, item, ClientSideNodeManager2.TOP_LEVEL, false);
        rowNodeTransaction.update.push(rowNode);
      });
    };
    ClientSideNodeManager2.prototype.lookupRowNode = function(data) {
      var getRowIdFunc = this.gridOptionsService.getCallback("getRowId");
      var rowNode;
      if (getRowIdFunc) {
        var id2 = getRowIdFunc({ data, level: 0 });
        rowNode = this.allNodesMap[id2];
        if (!rowNode) {
          console.error("AG Grid: could not find row id=" + id2 + ", data item was not found for this id");
          return null;
        }
      } else {
        rowNode = this.rootNode.allLeafChildren.find(function(node) {
          return node.data === data;
        });
        if (!rowNode) {
          console.error("AG Grid: could not find data item as object was not found", data);
          console.error("Consider using getRowId to help the Grid find matching row data");
          return null;
        }
      }
      return rowNode || null;
    };
    ClientSideNodeManager2.prototype.createNode = function(dataItem, parent, level) {
      var node = new RowNode2(this.beans);
      node.group = false;
      this.setMasterForRow(node, dataItem, level, true);
      if (parent && !this.suppressParentsInRowNodes) {
        node.parent = parent;
      }
      node.level = level;
      node.setDataAndId(dataItem, this.nextId.toString());
      if (this.allNodesMap[node.id]) {
        console.warn("AG Grid: duplicate node id '" + node.id + "' detected from getRowId callback, this could cause issues in your grid.");
      }
      this.allNodesMap[node.id] = node;
      this.nextId++;
      return node;
    };
    ClientSideNodeManager2.prototype.setMasterForRow = function(rowNode, data, level, setExpanded) {
      if (this.doingTreeData) {
        rowNode.setMaster(false);
        if (setExpanded) {
          rowNode.expanded = false;
        }
      } else {
        if (this.doingMasterDetail) {
          if (this.isRowMasterFunc) {
            rowNode.setMaster(this.isRowMasterFunc(data));
          } else {
            rowNode.setMaster(true);
          }
        } else {
          rowNode.setMaster(false);
        }
        if (setExpanded) {
          var rowGroupColumns = this.columnModel.getRowGroupColumns();
          var numRowGroupColumns = rowGroupColumns ? rowGroupColumns.length : 0;
          var masterRowLevel = level + numRowGroupColumns;
          rowNode.expanded = rowNode.master ? this.isExpanded(masterRowLevel) : false;
        }
      }
    };
    ClientSideNodeManager2.prototype.isExpanded = function(level) {
      var expandByDefault = this.gridOptionsService.getNum("groupDefaultExpanded");
      if (expandByDefault === -1) {
        return true;
      }
      return level < expandByDefault;
    };
    ClientSideNodeManager2.TOP_LEVEL = 0;
    ClientSideNodeManager2.ROOT_NODE_ID = "ROOT_NODE_ID";
    return ClientSideNodeManager2;
  }()
);
var __extends$c = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$b = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read$1 = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var __spreadArray$s = function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var RecursionType;
(function(RecursionType2) {
  RecursionType2[RecursionType2["Normal"] = 0] = "Normal";
  RecursionType2[RecursionType2["AfterFilter"] = 1] = "AfterFilter";
  RecursionType2[RecursionType2["AfterFilterAndSort"] = 2] = "AfterFilterAndSort";
  RecursionType2[RecursionType2["PivotNodes"] = 3] = "PivotNodes";
})(RecursionType || (RecursionType = {}));
var ClientSideRowModel = (
  /** @class */
  function(_super) {
    __extends$c(ClientSideRowModel2, _super);
    function ClientSideRowModel2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.onRowHeightChanged_debounced = _.debounce(_this.onRowHeightChanged.bind(_this), 100);
      _this.rowsToDisplay = [];
      return _this;
    }
    ClientSideRowModel2.prototype.init = function() {
      var refreshEverythingFunc = this.refreshModel.bind(this, { step: ClientSideRowModelSteps.EVERYTHING });
      var animate = !this.gridOptionsService.is("suppressAnimationFrame");
      var refreshEverythingAfterColsChangedFunc = this.refreshModel.bind(this, {
        step: ClientSideRowModelSteps.EVERYTHING,
        afterColumnsChanged: true,
        keepRenderedRows: true,
        animate
      });
      this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, refreshEverythingAfterColsChangedFunc);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, refreshEverythingFunc);
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VALUE_CHANGED, this.onValueChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_CHANGED, this.refreshModel.bind(this, { step: ClientSideRowModelSteps.PIVOT }));
      this.addManagedListener(this.eventService, Events.EVENT_FILTER_CHANGED, this.onFilterChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, this.onSortChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_MODE_CHANGED, refreshEverythingFunc);
      this.addManagedListener(this.eventService, Events.EVENT_GRID_STYLES_CHANGED, this.onGridStylesChanges.bind(this));
      var refreshMapListener = this.refreshModel.bind(this, {
        step: ClientSideRowModelSteps.MAP,
        keepRenderedRows: true,
        animate
      });
      this.addManagedPropertyListener("groupRemoveSingleChildren", refreshMapListener);
      this.addManagedPropertyListener("groupRemoveLowestSingleChildren", refreshMapListener);
      this.rootNode = new RowNode2(this.beans);
      this.nodeManager = new ClientSideNodeManager(this.rootNode, this.gridOptionsService, this.eventService, this.columnModel, this.selectionService, this.beans);
    };
    ClientSideRowModel2.prototype.start = function() {
      var rowData = this.gridOptionsService.get("rowData");
      if (rowData) {
        this.setRowData(rowData);
      }
    };
    ClientSideRowModel2.prototype.ensureRowHeightsValid = function(startPixel, endPixel, startLimitIndex, endLimitIndex) {
      var atLeastOneChange;
      var res = false;
      do {
        atLeastOneChange = false;
        var rowAtStartPixel = this.getRowIndexAtPixel(startPixel);
        var rowAtEndPixel = this.getRowIndexAtPixel(endPixel);
        var firstRow = Math.max(rowAtStartPixel, startLimitIndex);
        var lastRow = Math.min(rowAtEndPixel, endLimitIndex);
        for (var rowIndex = firstRow; rowIndex <= lastRow; rowIndex++) {
          var rowNode = this.getRow(rowIndex);
          if (rowNode.rowHeightEstimated) {
            var rowHeight = this.gridOptionsService.getRowHeightForNode(rowNode);
            rowNode.setRowHeight(rowHeight.height);
            atLeastOneChange = true;
            res = true;
          }
        }
        if (atLeastOneChange) {
          this.setRowTopAndRowIndex();
        }
      } while (atLeastOneChange);
      return res;
    };
    ClientSideRowModel2.prototype.setRowTopAndRowIndex = function() {
      var defaultRowHeight = this.environment.getDefaultRowHeight();
      var nextRowTop = 0;
      var displayedRowsMapped = /* @__PURE__ */ new Set();
      var allowEstimate = this.gridOptionsService.isDomLayout("normal");
      for (var i = 0; i < this.rowsToDisplay.length; i++) {
        var rowNode = this.rowsToDisplay[i];
        if (rowNode.id != null) {
          displayedRowsMapped.add(rowNode.id);
        }
        if (rowNode.rowHeight == null) {
          var rowHeight = this.gridOptionsService.getRowHeightForNode(rowNode, allowEstimate, defaultRowHeight);
          rowNode.setRowHeight(rowHeight.height, rowHeight.estimated);
        }
        rowNode.setRowTop(nextRowTop);
        rowNode.setRowIndex(i);
        nextRowTop += rowNode.rowHeight;
      }
      return displayedRowsMapped;
    };
    ClientSideRowModel2.prototype.clearRowTopAndRowIndex = function(changedPath, displayedRowsMapped) {
      var changedPathActive = changedPath.isActive();
      var clearIfNotDisplayed = function(rowNode) {
        if (rowNode && rowNode.id != null && !displayedRowsMapped.has(rowNode.id)) {
          rowNode.clearRowTopAndRowIndex();
        }
      };
      var recurse = function(rowNode) {
        clearIfNotDisplayed(rowNode);
        clearIfNotDisplayed(rowNode.detailNode);
        clearIfNotDisplayed(rowNode.sibling);
        if (rowNode.hasChildren()) {
          if (rowNode.childrenAfterGroup) {
            var isRootNode = rowNode.level == -1;
            var skipChildren = changedPathActive && !isRootNode && !rowNode.expanded;
            if (!skipChildren) {
              rowNode.childrenAfterGroup.forEach(recurse);
            }
          }
        }
      };
      recurse(this.rootNode);
    };
    ClientSideRowModel2.prototype.ensureRowsAtPixel = function(rowNodes, pixel, increment) {
      var _this = this;
      if (increment === void 0) {
        increment = 0;
      }
      var indexAtPixelNow = this.getRowIndexAtPixel(pixel);
      var rowNodeAtPixelNow = this.getRow(indexAtPixelNow);
      var animate = !this.gridOptionsService.is("suppressAnimationFrame");
      if (rowNodeAtPixelNow === rowNodes[0]) {
        return false;
      }
      rowNodes.forEach(function(rowNode) {
        _.removeFromArray(_this.rootNode.allLeafChildren, rowNode);
      });
      rowNodes.forEach(function(rowNode, idx) {
        _.insertIntoArray(_this.rootNode.allLeafChildren, rowNode, Math.max(indexAtPixelNow + increment, 0) + idx);
      });
      this.refreshModel({
        step: ClientSideRowModelSteps.EVERYTHING,
        keepRenderedRows: true,
        keepEditingRows: true,
        animate
      });
      return true;
    };
    ClientSideRowModel2.prototype.highlightRowAtPixel = function(rowNode, pixel) {
      var indexAtPixelNow = pixel != null ? this.getRowIndexAtPixel(pixel) : null;
      var rowNodeAtPixelNow = indexAtPixelNow != null ? this.getRow(indexAtPixelNow) : null;
      if (!rowNodeAtPixelNow || !rowNode || rowNodeAtPixelNow === rowNode || pixel == null) {
        if (this.lastHighlightedRow) {
          this.lastHighlightedRow.setHighlighted(null);
          this.lastHighlightedRow = null;
        }
        return;
      }
      var highlight2 = this.getHighlightPosition(pixel, rowNodeAtPixelNow);
      if (this.lastHighlightedRow && this.lastHighlightedRow !== rowNodeAtPixelNow) {
        this.lastHighlightedRow.setHighlighted(null);
        this.lastHighlightedRow = null;
      }
      rowNodeAtPixelNow.setHighlighted(highlight2);
      this.lastHighlightedRow = rowNodeAtPixelNow;
    };
    ClientSideRowModel2.prototype.getHighlightPosition = function(pixel, rowNode) {
      if (!rowNode) {
        var index2 = this.getRowIndexAtPixel(pixel);
        rowNode = this.getRow(index2 || 0);
        if (!rowNode) {
          return RowHighlightPosition.Below;
        }
      }
      var rowTop = rowNode.rowTop, rowHeight = rowNode.rowHeight;
      return pixel - rowTop < rowHeight / 2 ? RowHighlightPosition.Above : RowHighlightPosition.Below;
    };
    ClientSideRowModel2.prototype.getLastHighlightedRowNode = function() {
      return this.lastHighlightedRow;
    };
    ClientSideRowModel2.prototype.isLastRowIndexKnown = function() {
      return true;
    };
    ClientSideRowModel2.prototype.getRowCount = function() {
      if (this.rowsToDisplay) {
        return this.rowsToDisplay.length;
      }
      return 0;
    };
    ClientSideRowModel2.prototype.getTopLevelRowCount = function() {
      var showingRootNode = this.rowsToDisplay && this.rowsToDisplay[0] === this.rootNode;
      if (showingRootNode) {
        return 1;
      }
      var filteredChildren = this.rootNode.childrenAfterAggFilter;
      return filteredChildren ? filteredChildren.length : 0;
    };
    ClientSideRowModel2.prototype.getTopLevelRowDisplayedIndex = function(topLevelIndex) {
      var showingRootNode = this.rowsToDisplay && this.rowsToDisplay[0] === this.rootNode;
      if (showingRootNode) {
        return topLevelIndex;
      }
      var rowNode = this.rootNode.childrenAfterSort[topLevelIndex];
      if (this.gridOptionsService.is("groupHideOpenParents")) {
        while (rowNode.expanded && rowNode.childrenAfterSort && rowNode.childrenAfterSort.length > 0) {
          rowNode = rowNode.childrenAfterSort[0];
        }
      }
      return rowNode.rowIndex;
    };
    ClientSideRowModel2.prototype.getRowBounds = function(index2) {
      if (_.missing(this.rowsToDisplay)) {
        return null;
      }
      var rowNode = this.rowsToDisplay[index2];
      if (rowNode) {
        return {
          rowTop: rowNode.rowTop,
          rowHeight: rowNode.rowHeight
        };
      }
      return null;
    };
    ClientSideRowModel2.prototype.onRowGroupOpened = function() {
      var animate = this.gridOptionsService.isAnimateRows();
      this.refreshModel({ step: ClientSideRowModelSteps.MAP, keepRenderedRows: true, animate });
    };
    ClientSideRowModel2.prototype.onFilterChanged = function(event) {
      if (event.afterDataChange) {
        return;
      }
      var animate = this.gridOptionsService.isAnimateRows();
      var primaryOrQuickFilterChanged = event.columns.length === 0 || event.columns.some(function(col) {
        return col.isPrimary();
      });
      var step = primaryOrQuickFilterChanged ? ClientSideRowModelSteps.FILTER : ClientSideRowModelSteps.FILTER_AGGREGATES;
      this.refreshModel({ step, keepRenderedRows: true, animate });
    };
    ClientSideRowModel2.prototype.onSortChanged = function() {
      var animate = this.gridOptionsService.isAnimateRows();
      this.refreshModel({ step: ClientSideRowModelSteps.SORT, keepRenderedRows: true, animate, keepEditingRows: true });
    };
    ClientSideRowModel2.prototype.getType = function() {
      return "clientSide";
    };
    ClientSideRowModel2.prototype.onValueChanged = function() {
      if (this.columnModel.isPivotActive()) {
        this.refreshModel({ step: ClientSideRowModelSteps.PIVOT });
      } else {
        this.refreshModel({ step: ClientSideRowModelSteps.AGGREGATE });
      }
    };
    ClientSideRowModel2.prototype.createChangePath = function(rowNodeTransactions) {
      var noTransactions = _.missingOrEmpty(rowNodeTransactions);
      var changedPath = new ChangedPath(false, this.rootNode);
      if (noTransactions || this.gridOptionsService.isTreeData()) {
        changedPath.setInactive();
      }
      return changedPath;
    };
    ClientSideRowModel2.prototype.isSuppressModelUpdateAfterUpdateTransaction = function(params) {
      if (!this.gridOptionsService.is("suppressModelUpdateAfterUpdateTransaction")) {
        return false;
      }
      if (params.rowNodeTransactions == null) {
        return false;
      }
      var transWithAddsOrDeletes = params.rowNodeTransactions.filter(function(tx) {
        return tx.add != null && tx.add.length > 0 || tx.remove != null && tx.remove.length > 0;
      });
      var transactionsContainUpdatesOnly = transWithAddsOrDeletes == null || transWithAddsOrDeletes.length == 0;
      return transactionsContainUpdatesOnly;
    };
    ClientSideRowModel2.prototype.buildRefreshModelParams = function(step) {
      var paramsStep = ClientSideRowModelSteps.EVERYTHING;
      var stepsMapped = {
        everything: ClientSideRowModelSteps.EVERYTHING,
        group: ClientSideRowModelSteps.EVERYTHING,
        filter: ClientSideRowModelSteps.FILTER,
        map: ClientSideRowModelSteps.MAP,
        aggregate: ClientSideRowModelSteps.AGGREGATE,
        sort: ClientSideRowModelSteps.SORT,
        pivot: ClientSideRowModelSteps.PIVOT
      };
      if (_.exists(step)) {
        paramsStep = stepsMapped[step];
      }
      if (_.missing(paramsStep)) {
        console.error("AG Grid: invalid step " + step + ", available steps are " + Object.keys(stepsMapped).join(", "));
        return void 0;
      }
      var animate = !this.gridOptionsService.is("suppressAnimationFrame");
      var modelParams = {
        step: paramsStep,
        keepRenderedRows: true,
        keepEditingRows: true,
        animate
      };
      return modelParams;
    };
    ClientSideRowModel2.prototype.refreshModel = function(paramsOrStep) {
      var params = typeof paramsOrStep === "object" && "step" in paramsOrStep ? paramsOrStep : this.buildRefreshModelParams(paramsOrStep);
      if (!params) {
        return;
      }
      if (this.isSuppressModelUpdateAfterUpdateTransaction(params)) {
        return;
      }
      var changedPath = this.createChangePath(params.rowNodeTransactions);
      switch (params.step) {
        case ClientSideRowModelSteps.EVERYTHING:
          this.doRowGrouping(params.groupState, params.rowNodeTransactions, params.rowNodeOrder, changedPath, !!params.afterColumnsChanged);
        case ClientSideRowModelSteps.FILTER:
          this.doFilter(changedPath);
        case ClientSideRowModelSteps.PIVOT:
          this.doPivot(changedPath);
        case ClientSideRowModelSteps.AGGREGATE:
          this.doAggregate(changedPath);
        case ClientSideRowModelSteps.FILTER_AGGREGATES:
          this.doFilterAggregates(changedPath);
        case ClientSideRowModelSteps.SORT:
          this.doSort(params.rowNodeTransactions, changedPath);
        case ClientSideRowModelSteps.MAP:
          this.doRowsToDisplay();
      }
      var displayedNodesMapped = this.setRowTopAndRowIndex();
      this.clearRowTopAndRowIndex(changedPath, displayedNodesMapped);
      var event = {
        type: Events.EVENT_MODEL_UPDATED,
        animate: params.animate,
        keepRenderedRows: params.keepRenderedRows,
        newData: params.newData,
        newPage: false,
        keepUndoRedoStack: params.keepUndoRedoStack
      };
      this.eventService.dispatchEvent(event);
    };
    ClientSideRowModel2.prototype.isEmpty = function() {
      var rowsMissing = _.missing(this.rootNode.allLeafChildren) || this.rootNode.allLeafChildren.length === 0;
      return _.missing(this.rootNode) || rowsMissing || !this.columnModel.isReady();
    };
    ClientSideRowModel2.prototype.isRowsToRender = function() {
      return _.exists(this.rowsToDisplay) && this.rowsToDisplay.length > 0;
    };
    ClientSideRowModel2.prototype.getNodesInRangeForSelection = function(firstInRange, lastInRange) {
      var started = !lastInRange;
      var finished = false;
      var result = [];
      var groupsSelectChildren = this.gridOptionsService.is("groupSelectsChildren");
      this.forEachNodeAfterFilterAndSort(function(rowNode) {
        if (finished) {
          return;
        }
        if (started) {
          if (rowNode === lastInRange || rowNode === firstInRange) {
            finished = true;
            if (rowNode.group && groupsSelectChildren) {
              result.push.apply(result, __spreadArray$s([], __read$1(rowNode.allLeafChildren)));
              return;
            }
          }
        }
        if (!started) {
          if (rowNode !== lastInRange && rowNode !== firstInRange) {
            return;
          }
          started = true;
        }
        var includeThisNode = !rowNode.group || !groupsSelectChildren;
        if (includeThisNode) {
          result.push(rowNode);
          return;
        }
      });
      return result;
    };
    ClientSideRowModel2.prototype.setDatasource = function(datasource) {
      console.error("AG Grid: should never call setDatasource on clientSideRowController");
    };
    ClientSideRowModel2.prototype.getTopLevelNodes = function() {
      return this.rootNode ? this.rootNode.childrenAfterGroup : null;
    };
    ClientSideRowModel2.prototype.getRootNode = function() {
      return this.rootNode;
    };
    ClientSideRowModel2.prototype.getRow = function(index2) {
      return this.rowsToDisplay[index2];
    };
    ClientSideRowModel2.prototype.isRowPresent = function(rowNode) {
      return this.rowsToDisplay.indexOf(rowNode) >= 0;
    };
    ClientSideRowModel2.prototype.getRowIndexAtPixel = function(pixelToMatch) {
      if (this.isEmpty() || this.rowsToDisplay.length === 0) {
        return -1;
      }
      var bottomPointer = 0;
      var topPointer = this.rowsToDisplay.length - 1;
      if (pixelToMatch <= 0) {
        return 0;
      }
      var lastNode = _.last(this.rowsToDisplay);
      if (lastNode.rowTop <= pixelToMatch) {
        return this.rowsToDisplay.length - 1;
      }
      var oldBottomPointer = -1;
      var oldTopPointer = -1;
      while (true) {
        var midPointer = Math.floor((bottomPointer + topPointer) / 2);
        var currentRowNode = this.rowsToDisplay[midPointer];
        if (this.isRowInPixel(currentRowNode, pixelToMatch)) {
          return midPointer;
        }
        if (currentRowNode.rowTop < pixelToMatch) {
          bottomPointer = midPointer + 1;
        } else if (currentRowNode.rowTop > pixelToMatch) {
          topPointer = midPointer - 1;
        }
        var caughtInInfiniteLoop = oldBottomPointer === bottomPointer && oldTopPointer === topPointer;
        if (caughtInInfiniteLoop) {
          return midPointer;
        }
        oldBottomPointer = bottomPointer;
        oldTopPointer = topPointer;
      }
    };
    ClientSideRowModel2.prototype.isRowInPixel = function(rowNode, pixelToMatch) {
      var topPixel = rowNode.rowTop;
      var bottomPixel = rowNode.rowTop + rowNode.rowHeight;
      var pixelInRow = topPixel <= pixelToMatch && bottomPixel > pixelToMatch;
      return pixelInRow;
    };
    ClientSideRowModel2.prototype.forEachLeafNode = function(callback2) {
      if (this.rootNode.allLeafChildren) {
        this.rootNode.allLeafChildren.forEach(function(rowNode, index2) {
          return callback2(rowNode, index2);
        });
      }
    };
    ClientSideRowModel2.prototype.forEachNode = function(callback2, includeFooterNodes) {
      if (includeFooterNodes === void 0) {
        includeFooterNodes = false;
      }
      this.recursivelyWalkNodesAndCallback({
        nodes: __spreadArray$s([], __read$1(this.rootNode.childrenAfterGroup || [])),
        callback: callback2,
        recursionType: RecursionType.Normal,
        index: 0,
        includeFooterNodes
      });
    };
    ClientSideRowModel2.prototype.forEachNodeAfterFilter = function(callback2, includeFooterNodes) {
      if (includeFooterNodes === void 0) {
        includeFooterNodes = false;
      }
      this.recursivelyWalkNodesAndCallback({
        nodes: __spreadArray$s([], __read$1(this.rootNode.childrenAfterAggFilter || [])),
        callback: callback2,
        recursionType: RecursionType.AfterFilter,
        index: 0,
        includeFooterNodes
      });
    };
    ClientSideRowModel2.prototype.forEachNodeAfterFilterAndSort = function(callback2, includeFooterNodes) {
      if (includeFooterNodes === void 0) {
        includeFooterNodes = false;
      }
      this.recursivelyWalkNodesAndCallback({
        nodes: __spreadArray$s([], __read$1(this.rootNode.childrenAfterSort || [])),
        callback: callback2,
        recursionType: RecursionType.AfterFilterAndSort,
        index: 0,
        includeFooterNodes
      });
    };
    ClientSideRowModel2.prototype.forEachPivotNode = function(callback2, includeFooterNodes) {
      if (includeFooterNodes === void 0) {
        includeFooterNodes = false;
      }
      this.recursivelyWalkNodesAndCallback({
        nodes: [this.rootNode],
        callback: callback2,
        recursionType: RecursionType.PivotNodes,
        index: 0,
        includeFooterNodes
      });
    };
    ClientSideRowModel2.prototype.recursivelyWalkNodesAndCallback = function(params) {
      var _a2;
      var nodes = params.nodes, callback2 = params.callback, recursionType = params.recursionType, includeFooterNodes = params.includeFooterNodes;
      var index2 = params.index;
      var firstNode = nodes[0];
      if (includeFooterNodes && ((_a2 = firstNode === null || firstNode === void 0 ? void 0 : firstNode.parent) === null || _a2 === void 0 ? void 0 : _a2.sibling)) {
        nodes.push(firstNode.parent.sibling);
      }
      for (var i = 0; i < nodes.length; i++) {
        var node = nodes[i];
        callback2(node, index2++);
        if (node.hasChildren() && !node.footer) {
          var nodeChildren = null;
          switch (recursionType) {
            case RecursionType.Normal:
              nodeChildren = node.childrenAfterGroup;
              break;
            case RecursionType.AfterFilter:
              nodeChildren = node.childrenAfterAggFilter;
              break;
            case RecursionType.AfterFilterAndSort:
              nodeChildren = node.childrenAfterSort;
              break;
            case RecursionType.PivotNodes:
              nodeChildren = !node.leafGroup ? node.childrenAfterSort : null;
              break;
          }
          if (nodeChildren) {
            index2 = this.recursivelyWalkNodesAndCallback({
              nodes: __spreadArray$s([], __read$1(nodeChildren)),
              callback: callback2,
              recursionType,
              index: index2,
              includeFooterNodes
            });
          }
        }
      }
      return index2;
    };
    ClientSideRowModel2.prototype.doAggregate = function(changedPath) {
      if (this.aggregationStage) {
        this.aggregationStage.execute({ rowNode: this.rootNode, changedPath });
      }
    };
    ClientSideRowModel2.prototype.doFilterAggregates = function(changedPath) {
      if (this.filterAggregatesStage) {
        this.filterAggregatesStage.execute({ rowNode: this.rootNode, changedPath });
      } else {
        this.rootNode.childrenAfterAggFilter = this.rootNode.childrenAfterFilter;
      }
    };
    ClientSideRowModel2.prototype.expandOrCollapseAll = function(expand) {
      var usingTreeData = this.gridOptionsService.isTreeData();
      var usingPivotMode = this.columnModel.isPivotActive();
      var recursiveExpandOrCollapse = function(rowNodes) {
        if (!rowNodes) {
          return;
        }
        rowNodes.forEach(function(rowNode) {
          var actionRow = function() {
            rowNode.expanded = expand;
            recursiveExpandOrCollapse(rowNode.childrenAfterGroup);
          };
          if (usingTreeData) {
            var hasChildren = _.exists(rowNode.childrenAfterGroup);
            if (hasChildren) {
              actionRow();
            }
            return;
          }
          if (usingPivotMode) {
            var notLeafGroup = !rowNode.leafGroup;
            if (notLeafGroup) {
              actionRow();
            }
            return;
          }
          var isRowGroup = rowNode.group;
          if (isRowGroup) {
            actionRow();
          }
        });
      };
      if (this.rootNode) {
        recursiveExpandOrCollapse(this.rootNode.childrenAfterGroup);
      }
      this.refreshModel({ step: ClientSideRowModelSteps.MAP });
      var eventSource = expand ? "expandAll" : "collapseAll";
      var event = {
        type: Events.EVENT_EXPAND_COLLAPSE_ALL,
        source: eventSource
      };
      this.eventService.dispatchEvent(event);
    };
    ClientSideRowModel2.prototype.doSort = function(rowNodeTransactions, changedPath) {
      this.sortStage.execute({
        rowNode: this.rootNode,
        rowNodeTransactions,
        changedPath
      });
    };
    ClientSideRowModel2.prototype.doRowGrouping = function(groupState, rowNodeTransactions, rowNodeOrder, changedPath, afterColumnsChanged) {
      if (this.groupStage) {
        if (rowNodeTransactions) {
          this.groupStage.execute({
            rowNode: this.rootNode,
            rowNodeTransactions,
            rowNodeOrder,
            changedPath
          });
        } else {
          this.groupStage.execute({
            rowNode: this.rootNode,
            changedPath,
            afterColumnsChanged
          });
          this.restoreGroupState(groupState);
        }
        if (this.gridOptionsService.is("groupSelectsChildren")) {
          var selectionChanged = this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged", changedPath);
          if (selectionChanged) {
            var event_1 = {
              type: Events.EVENT_SELECTION_CHANGED,
              source: "rowGroupChanged"
            };
            this.eventService.dispatchEvent(event_1);
          }
        }
      } else {
        this.rootNode.childrenAfterGroup = this.rootNode.allLeafChildren;
        if (this.rootNode.sibling) {
          this.rootNode.sibling.childrenAfterGroup = this.rootNode.childrenAfterGroup;
        }
        this.rootNode.updateHasChildren();
      }
    };
    ClientSideRowModel2.prototype.restoreGroupState = function(groupState) {
      if (!groupState) {
        return;
      }
      _.traverseNodesWithKey(this.rootNode.childrenAfterGroup, function(node, key) {
        if (typeof groupState[key] === "boolean") {
          node.expanded = groupState[key];
        }
      });
    };
    ClientSideRowModel2.prototype.doFilter = function(changedPath) {
      this.filterStage.execute({ rowNode: this.rootNode, changedPath });
    };
    ClientSideRowModel2.prototype.doPivot = function(changedPath) {
      if (this.pivotStage) {
        this.pivotStage.execute({ rowNode: this.rootNode, changedPath });
      }
    };
    ClientSideRowModel2.prototype.getGroupState = function() {
      if (!this.rootNode.childrenAfterGroup || !this.gridOptionsService.is("rememberGroupStateWhenNewData")) {
        return null;
      }
      var result = {};
      _.traverseNodesWithKey(this.rootNode.childrenAfterGroup, function(node, key) {
        return result[key] = node.expanded;
      });
      return result;
    };
    ClientSideRowModel2.prototype.getCopyOfNodesMap = function() {
      return this.nodeManager.getCopyOfNodesMap();
    };
    ClientSideRowModel2.prototype.getRowNode = function(id2) {
      var idIsGroup = typeof id2 == "string" && id2.indexOf(RowNode2.ID_PREFIX_ROW_GROUP) == 0;
      if (idIsGroup) {
        var res_1 = void 0;
        this.forEachNode(function(node) {
          if (node.id === id2) {
            res_1 = node;
          }
        });
        return res_1;
      }
      return this.nodeManager.getRowNode(id2);
    };
    ClientSideRowModel2.prototype.setRowData = function(rowData) {
      var groupState = this.getGroupState();
      this.nodeManager.setRowData(rowData);
      this.selectionService.reset();
      this.filterManager.onNewRowsLoaded("rowDataUpdated");
      var rowDataUpdatedEvent = {
        type: Events.EVENT_ROW_DATA_UPDATED
      };
      this.eventService.dispatchEvent(rowDataUpdatedEvent);
      this.refreshModel({
        step: ClientSideRowModelSteps.EVERYTHING,
        groupState,
        newData: true
      });
    };
    ClientSideRowModel2.prototype.batchUpdateRowData = function(rowDataTransaction, callback2) {
      var _this = this;
      if (this.applyAsyncTransactionsTimeout == null) {
        this.rowDataTransactionBatch = [];
        var waitMillis = this.gridOptionsService.getAsyncTransactionWaitMillis();
        this.applyAsyncTransactionsTimeout = window.setTimeout(function() {
          _this.executeBatchUpdateRowData();
        }, waitMillis);
      }
      this.rowDataTransactionBatch.push({ rowDataTransaction, callback: callback2 });
    };
    ClientSideRowModel2.prototype.flushAsyncTransactions = function() {
      if (this.applyAsyncTransactionsTimeout != null) {
        clearTimeout(this.applyAsyncTransactionsTimeout);
        this.executeBatchUpdateRowData();
      }
    };
    ClientSideRowModel2.prototype.executeBatchUpdateRowData = function() {
      var _this = this;
      this.valueCache.onDataChanged();
      var callbackFuncsBound = [];
      var rowNodeTrans = [];
      var forceRowNodeOrder = false;
      if (this.rowDataTransactionBatch) {
        this.rowDataTransactionBatch.forEach(function(tranItem) {
          var rowNodeTran = _this.nodeManager.updateRowData(tranItem.rowDataTransaction, void 0);
          rowNodeTrans.push(rowNodeTran);
          if (tranItem.callback) {
            callbackFuncsBound.push(tranItem.callback.bind(null, rowNodeTran));
          }
          if (typeof tranItem.rowDataTransaction.addIndex === "number") {
            forceRowNodeOrder = true;
          }
        });
      }
      this.commonUpdateRowData(rowNodeTrans, void 0, forceRowNodeOrder);
      if (callbackFuncsBound.length > 0) {
        window.setTimeout(function() {
          callbackFuncsBound.forEach(function(func) {
            return func();
          });
        }, 0);
      }
      if (rowNodeTrans.length > 0) {
        var event_2 = {
          type: Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED,
          results: rowNodeTrans
        };
        this.eventService.dispatchEvent(event_2);
      }
      this.rowDataTransactionBatch = null;
      this.applyAsyncTransactionsTimeout = void 0;
    };
    ClientSideRowModel2.prototype.updateRowData = function(rowDataTran, rowNodeOrder) {
      this.valueCache.onDataChanged();
      var rowNodeTran = this.nodeManager.updateRowData(rowDataTran, rowNodeOrder);
      var forceRowNodeOrder = typeof rowDataTran.addIndex === "number";
      this.commonUpdateRowData([rowNodeTran], rowNodeOrder, forceRowNodeOrder);
      return rowNodeTran;
    };
    ClientSideRowModel2.prototype.createRowNodeOrder = function() {
      var suppressSortOrder = this.gridOptionsService.is("suppressMaintainUnsortedOrder");
      if (suppressSortOrder) {
        return;
      }
      var orderMap = {};
      if (this.rootNode && this.rootNode.allLeafChildren) {
        for (var index2 = 0; index2 < this.rootNode.allLeafChildren.length; index2++) {
          var node = this.rootNode.allLeafChildren[index2];
          orderMap[node.id] = index2;
        }
      }
      return orderMap;
    };
    ClientSideRowModel2.prototype.commonUpdateRowData = function(rowNodeTrans, rowNodeOrder, forceRowNodeOrder) {
      var animate = !this.gridOptionsService.is("suppressAnimationFrame");
      if (forceRowNodeOrder) {
        rowNodeOrder = this.createRowNodeOrder();
      }
      this.refreshModel({
        step: ClientSideRowModelSteps.EVERYTHING,
        rowNodeTransactions: rowNodeTrans,
        rowNodeOrder,
        keepRenderedRows: true,
        keepEditingRows: true,
        animate
      });
      this.filterManager.onNewRowsLoaded("rowDataUpdated");
      var event = {
        type: Events.EVENT_ROW_DATA_UPDATED
      };
      this.eventService.dispatchEvent(event);
    };
    ClientSideRowModel2.prototype.doRowsToDisplay = function() {
      this.rowsToDisplay = this.flattenStage.execute({ rowNode: this.rootNode });
    };
    ClientSideRowModel2.prototype.onRowHeightChanged = function() {
      this.refreshModel({ step: ClientSideRowModelSteps.MAP, keepRenderedRows: true, keepEditingRows: true, keepUndoRedoStack: true });
    };
    ClientSideRowModel2.prototype.onRowHeightChangedDebounced = function() {
      this.onRowHeightChanged_debounced();
    };
    ClientSideRowModel2.prototype.resetRowHeights = function() {
      var atLeastOne = this.resetRowHeightsForAllRowNodes();
      this.rootNode.setRowHeight(this.rootNode.rowHeight, true);
      if (atLeastOne) {
        this.onRowHeightChanged();
      }
    };
    ClientSideRowModel2.prototype.resetRowHeightsForAllRowNodes = function() {
      var atLeastOne = false;
      this.forEachNode(function(rowNode) {
        rowNode.setRowHeight(rowNode.rowHeight, true);
        var detailNode = rowNode.detailNode;
        if (detailNode) {
          detailNode.setRowHeight(detailNode.rowHeight, true);
        }
        atLeastOne = true;
      });
      return atLeastOne;
    };
    ClientSideRowModel2.prototype.onGridStylesChanges = function() {
      if (this.columnModel.isAutoRowHeightActive()) {
        return;
      }
      this.resetRowHeights();
    };
    __decorate$b([
      Autowired("columnModel")
    ], ClientSideRowModel2.prototype, "columnModel", void 0);
    __decorate$b([
      Autowired("selectionService")
    ], ClientSideRowModel2.prototype, "selectionService", void 0);
    __decorate$b([
      Autowired("filterManager")
    ], ClientSideRowModel2.prototype, "filterManager", void 0);
    __decorate$b([
      Autowired("valueCache")
    ], ClientSideRowModel2.prototype, "valueCache", void 0);
    __decorate$b([
      Autowired("beans")
    ], ClientSideRowModel2.prototype, "beans", void 0);
    __decorate$b([
      Autowired("filterStage")
    ], ClientSideRowModel2.prototype, "filterStage", void 0);
    __decorate$b([
      Autowired("sortStage")
    ], ClientSideRowModel2.prototype, "sortStage", void 0);
    __decorate$b([
      Autowired("flattenStage")
    ], ClientSideRowModel2.prototype, "flattenStage", void 0);
    __decorate$b([
      Optional("groupStage")
    ], ClientSideRowModel2.prototype, "groupStage", void 0);
    __decorate$b([
      Optional("aggregationStage")
    ], ClientSideRowModel2.prototype, "aggregationStage", void 0);
    __decorate$b([
      Optional("pivotStage")
    ], ClientSideRowModel2.prototype, "pivotStage", void 0);
    __decorate$b([
      Optional("filterAggregatesStage")
    ], ClientSideRowModel2.prototype, "filterAggregatesStage", void 0);
    __decorate$b([
      PostConstruct
    ], ClientSideRowModel2.prototype, "init", null);
    ClientSideRowModel2 = __decorate$b([
      Bean("rowModel")
    ], ClientSideRowModel2);
    return ClientSideRowModel2;
  }(BeanStub)
);
var __extends$b = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$a = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var FilterStage = (
  /** @class */
  function(_super) {
    __extends$b(FilterStage2, _super);
    function FilterStage2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    FilterStage2.prototype.execute = function(params) {
      var changedPath = params.changedPath;
      this.filterService.filter(changedPath);
    };
    __decorate$a([
      Autowired("filterService")
    ], FilterStage2.prototype, "filterService", void 0);
    FilterStage2 = __decorate$a([
      Bean("filterStage")
    ], FilterStage2);
    return FilterStage2;
  }(BeanStub)
);
var __extends$a = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$9 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SortStage = (
  /** @class */
  function(_super) {
    __extends$a(SortStage2, _super);
    function SortStage2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    SortStage2.prototype.execute = function(params) {
      var _this = this;
      var sortOptions = this.sortController.getSortOptions();
      var sortActive = _.exists(sortOptions) && sortOptions.length > 0;
      var deltaSort = sortActive && _.exists(params.rowNodeTransactions) && this.gridOptionsService.is("deltaSort");
      var sortContainsGroupColumns = sortOptions.some(function(opt) {
        return !!_this.columnModel.getGroupDisplayColumnForGroup(opt.column.getId());
      });
      this.sortService.sort(sortOptions, sortActive, deltaSort, params.rowNodeTransactions, params.changedPath, sortContainsGroupColumns);
    };
    __decorate$9([
      Autowired("sortService")
    ], SortStage2.prototype, "sortService", void 0);
    __decorate$9([
      Autowired("sortController")
    ], SortStage2.prototype, "sortController", void 0);
    __decorate$9([
      Autowired("columnModel")
    ], SortStage2.prototype, "columnModel", void 0);
    SortStage2 = __decorate$9([
      Bean("sortStage")
    ], SortStage2);
    return SortStage2;
  }(BeanStub)
);
var __extends$9 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$8 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var FlattenStage = (
  /** @class */
  function(_super) {
    __extends$9(FlattenStage2, _super);
    function FlattenStage2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    FlattenStage2.prototype.execute = function(params) {
      var rootNode = params.rowNode;
      var result = [];
      var nextRowTop = { value: 0 };
      var skipLeafNodes = this.columnModel.isPivotMode();
      var showRootNode = skipLeafNodes && rootNode.leafGroup;
      var topList = showRootNode ? [rootNode] : rootNode.childrenAfterSort;
      this.recursivelyAddToRowsToDisplay(topList, result, nextRowTop, skipLeafNodes, 0);
      var atLeastOneRowPresent = result.length > 0;
      var includeGroupTotalFooter = !showRootNode && atLeastOneRowPresent && this.gridOptionsService.is("groupIncludeTotalFooter");
      if (includeGroupTotalFooter) {
        rootNode.createFooter();
        this.addRowNodeToRowsToDisplay(rootNode.sibling, result, nextRowTop, 0);
      }
      return result;
    };
    FlattenStage2.prototype.recursivelyAddToRowsToDisplay = function(rowsToFlatten, result, nextRowTop, skipLeafNodes, uiLevel) {
      if (_.missingOrEmpty(rowsToFlatten)) {
        return;
      }
      var hideOpenParents = this.gridOptionsService.is("groupHideOpenParents");
      var groupRemoveSingleChildren = this.gridOptionsService.is("groupRemoveSingleChildren");
      var groupRemoveLowestSingleChildren = !groupRemoveSingleChildren && this.gridOptionsService.is("groupRemoveLowestSingleChildren");
      for (var i = 0; i < rowsToFlatten.length; i++) {
        var rowNode = rowsToFlatten[i];
        var isParent = rowNode.hasChildren();
        var isSkippedLeafNode = skipLeafNodes && !isParent;
        var isRemovedSingleChildrenGroup = groupRemoveSingleChildren && isParent && rowNode.childrenAfterGroup.length === 1;
        var isRemovedLowestSingleChildrenGroup = groupRemoveLowestSingleChildren && isParent && rowNode.leafGroup && rowNode.childrenAfterGroup.length === 1;
        var neverAllowToExpand = skipLeafNodes && rowNode.leafGroup;
        var isHiddenOpenParent = hideOpenParents && rowNode.expanded && !rowNode.master && !neverAllowToExpand;
        var thisRowShouldBeRendered = !isSkippedLeafNode && !isHiddenOpenParent && !isRemovedSingleChildrenGroup && !isRemovedLowestSingleChildrenGroup;
        if (thisRowShouldBeRendered) {
          this.addRowNodeToRowsToDisplay(rowNode, result, nextRowTop, uiLevel);
        }
        if (skipLeafNodes && rowNode.leafGroup) {
          continue;
        }
        if (isParent) {
          var excludedParent = isRemovedSingleChildrenGroup || isRemovedLowestSingleChildrenGroup;
          if (rowNode.expanded || excludedParent) {
            var uiLevelForChildren = excludedParent ? uiLevel : uiLevel + 1;
            this.recursivelyAddToRowsToDisplay(rowNode.childrenAfterSort, result, nextRowTop, skipLeafNodes, uiLevelForChildren);
            if (this.gridOptionsService.is("groupIncludeFooter")) {
              this.addRowNodeToRowsToDisplay(rowNode.sibling, result, nextRowTop, uiLevelForChildren);
            }
          }
        } else if (rowNode.master && rowNode.expanded) {
          var detailNode = this.createDetailNode(rowNode);
          this.addRowNodeToRowsToDisplay(detailNode, result, nextRowTop, uiLevel);
        }
      }
    };
    FlattenStage2.prototype.addRowNodeToRowsToDisplay = function(rowNode, result, nextRowTop, uiLevel) {
      var isGroupMultiAutoColumn = this.gridOptionsService.isGroupMultiAutoColumn();
      result.push(rowNode);
      rowNode.setUiLevel(isGroupMultiAutoColumn ? 0 : uiLevel);
    };
    FlattenStage2.prototype.createDetailNode = function(masterNode) {
      if (_.exists(masterNode.detailNode)) {
        return masterNode.detailNode;
      }
      var detailNode = new RowNode2(this.beans);
      detailNode.detail = true;
      detailNode.selectable = false;
      detailNode.parent = masterNode;
      if (_.exists(masterNode.id)) {
        detailNode.id = "detail_" + masterNode.id;
      }
      detailNode.data = masterNode.data;
      detailNode.level = masterNode.level + 1;
      masterNode.detailNode = detailNode;
      return detailNode;
    };
    __decorate$8([
      Autowired("columnModel")
    ], FlattenStage2.prototype, "columnModel", void 0);
    __decorate$8([
      Autowired("beans")
    ], FlattenStage2.prototype, "beans", void 0);
    FlattenStage2 = __decorate$8([
      Bean("flattenStage")
    ], FlattenStage2);
    return FlattenStage2;
  }(BeanStub)
);
var __extends$8 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$7 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var SortService = (
  /** @class */
  function(_super) {
    __extends$8(SortService2, _super);
    function SortService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    SortService2.prototype.init = function() {
      this.postSortFunc = this.gridOptionsService.getCallback("postSortRows");
    };
    SortService2.prototype.sort = function(sortOptions, sortActive, useDeltaSort, rowNodeTransactions, changedPath, sortContainsGroupColumns) {
      var _this = this;
      var groupMaintainOrder = this.gridOptionsService.is("groupMaintainOrder");
      var groupColumnsPresent = this.columnModel.getAllGridColumns().some(function(c) {
        return c.isRowGroupActive();
      });
      var allDirtyNodes = {};
      if (useDeltaSort && rowNodeTransactions) {
        allDirtyNodes = this.calculateDirtyNodes(rowNodeTransactions);
      }
      var isPivotMode = this.columnModel.isPivotMode();
      var callback2 = function(rowNode) {
        _this.pullDownGroupDataForHideOpenParents(rowNode.childrenAfterAggFilter, true);
        var skipSortingPivotLeafs = isPivotMode && rowNode.leafGroup;
        var skipSortingGroups = groupMaintainOrder && groupColumnsPresent && !rowNode.leafGroup && !sortContainsGroupColumns;
        if (skipSortingGroups) {
          var childrenToBeSorted = rowNode.childrenAfterAggFilter.slice(0);
          if (rowNode.childrenAfterSort) {
            var indexedOrders_1 = {};
            rowNode.childrenAfterSort.forEach(function(node, idx) {
              indexedOrders_1[node.id] = idx;
            });
            childrenToBeSorted.sort(function(row1, row2) {
              var _a2, _b2;
              return ((_a2 = indexedOrders_1[row1.id]) !== null && _a2 !== void 0 ? _a2 : 0) - ((_b2 = indexedOrders_1[row2.id]) !== null && _b2 !== void 0 ? _b2 : 0);
            });
          }
          rowNode.childrenAfterSort = childrenToBeSorted;
        } else if (!sortActive || skipSortingPivotLeafs) {
          rowNode.childrenAfterSort = rowNode.childrenAfterAggFilter.slice(0);
        } else if (useDeltaSort) {
          rowNode.childrenAfterSort = _this.doDeltaSort(rowNode, allDirtyNodes, changedPath, sortOptions);
        } else {
          rowNode.childrenAfterSort = _this.rowNodeSorter.doFullSort(rowNode.childrenAfterAggFilter, sortOptions);
        }
        if (rowNode.sibling) {
          rowNode.sibling.childrenAfterSort = rowNode.childrenAfterSort;
        }
        _this.updateChildIndexes(rowNode);
        if (_this.postSortFunc) {
          var params = { nodes: rowNode.childrenAfterSort };
          _this.postSortFunc(params);
        }
      };
      if (changedPath) {
        changedPath.forEachChangedNodeDepthFirst(callback2);
      }
      this.updateGroupDataForHideOpenParents(changedPath);
    };
    SortService2.prototype.calculateDirtyNodes = function(rowNodeTransactions) {
      var dirtyNodes = {};
      var addNodesFunc = function(rowNodes) {
        if (rowNodes) {
          rowNodes.forEach(function(rowNode) {
            return dirtyNodes[rowNode.id] = true;
          });
        }
      };
      if (rowNodeTransactions) {
        rowNodeTransactions.forEach(function(tran) {
          addNodesFunc(tran.add);
          addNodesFunc(tran.update);
          addNodesFunc(tran.remove);
        });
      }
      return dirtyNodes;
    };
    SortService2.prototype.doDeltaSort = function(rowNode, allTouchedNodes, changedPath, sortOptions) {
      var _this = this;
      var unsortedRows = rowNode.childrenAfterAggFilter;
      var oldSortedRows = rowNode.childrenAfterSort;
      if (!oldSortedRows) {
        return this.rowNodeSorter.doFullSort(unsortedRows, sortOptions);
      }
      var untouchedRowsMap = {};
      var touchedRows = [];
      unsortedRows.forEach(function(row) {
        if (allTouchedNodes[row.id] || !changedPath.canSkip(row)) {
          touchedRows.push(row);
        } else {
          untouchedRowsMap[row.id] = true;
        }
      });
      var sortedUntouchedRows = oldSortedRows.filter(function(child) {
        return untouchedRowsMap[child.id];
      });
      var mapNodeToSortedNode = function(rowNode2, pos) {
        return { currentPos: pos, rowNode: rowNode2 };
      };
      var sortedChangedRows = touchedRows.map(mapNodeToSortedNode).sort(function(a, b) {
        return _this.rowNodeSorter.compareRowNodes(sortOptions, a, b);
      });
      return this.mergeSortedArrays(sortOptions, sortedChangedRows, sortedUntouchedRows.map(mapNodeToSortedNode)).map(function(_a2) {
        var rowNode2 = _a2.rowNode;
        return rowNode2;
      });
    };
    SortService2.prototype.mergeSortedArrays = function(sortOptions, arr1, arr2) {
      var res = [];
      var i = 0;
      var j = 0;
      while (i < arr1.length && j < arr2.length) {
        var compareResult = this.rowNodeSorter.compareRowNodes(sortOptions, arr1[i], arr2[j]);
        if (compareResult < 0) {
          res.push(arr1[i++]);
        } else {
          res.push(arr2[j++]);
        }
      }
      while (i < arr1.length) {
        res.push(arr1[i++]);
      }
      while (j < arr2.length) {
        res.push(arr2[j++]);
      }
      return res;
    };
    SortService2.prototype.updateChildIndexes = function(rowNode) {
      if (_.missing(rowNode.childrenAfterSort)) {
        return;
      }
      var listToSort = rowNode.childrenAfterSort;
      for (var i = 0; i < listToSort.length; i++) {
        var child = listToSort[i];
        var firstChild = i === 0;
        var lastChild = i === rowNode.childrenAfterSort.length - 1;
        child.setFirstChild(firstChild);
        child.setLastChild(lastChild);
        child.setChildIndex(i);
      }
    };
    SortService2.prototype.updateGroupDataForHideOpenParents = function(changedPath) {
      var _this = this;
      if (!this.gridOptionsService.is("groupHideOpenParents")) {
        return;
      }
      if (this.gridOptionsService.isTreeData()) {
        var msg_1 = "AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).";
        _.doOnce(function() {
          return console.warn(msg_1);
        }, "sortService.hideOpenParentsWithTreeData");
        return false;
      }
      var callback2 = function(rowNode) {
        _this.pullDownGroupDataForHideOpenParents(rowNode.childrenAfterSort, false);
        rowNode.childrenAfterSort.forEach(function(child) {
          if (child.hasChildren()) {
            callback2(child);
          }
        });
      };
      if (changedPath) {
        changedPath.executeFromRootNode(function(rowNode) {
          return callback2(rowNode);
        });
      }
    };
    SortService2.prototype.pullDownGroupDataForHideOpenParents = function(rowNodes, clearOperation) {
      var _this = this;
      if (!this.gridOptionsService.is("groupHideOpenParents") || _.missing(rowNodes)) {
        return;
      }
      rowNodes.forEach(function(childRowNode) {
        var groupDisplayCols = _this.columnModel.getGroupDisplayColumns();
        groupDisplayCols.forEach(function(groupDisplayCol) {
          var showRowGroup = groupDisplayCol.getColDef().showRowGroup;
          if (typeof showRowGroup !== "string") {
            console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");
            return;
          }
          var displayingGroupKey = showRowGroup;
          var rowGroupColumn = _this.columnModel.getPrimaryColumn(displayingGroupKey);
          var thisRowNodeMatches = rowGroupColumn === childRowNode.rowGroupColumn;
          if (thisRowNodeMatches) {
            return;
          }
          if (clearOperation) {
            childRowNode.setGroupValue(groupDisplayCol.getId(), void 0);
          } else {
            var parentToStealFrom = childRowNode.getFirstChildOfFirstChild(rowGroupColumn);
            if (parentToStealFrom) {
              childRowNode.setGroupValue(groupDisplayCol.getId(), parentToStealFrom.key);
            }
          }
        });
      });
    };
    __decorate$7([
      Autowired("columnModel")
    ], SortService2.prototype, "columnModel", void 0);
    __decorate$7([
      Autowired("rowNodeSorter")
    ], SortService2.prototype, "rowNodeSorter", void 0);
    __decorate$7([
      PostConstruct
    ], SortService2.prototype, "init", null);
    SortService2 = __decorate$7([
      Bean("sortService")
    ], SortService2);
    return SortService2;
  }(BeanStub)
);
var __extends$7 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$6 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var FilterService = (
  /** @class */
  function(_super) {
    __extends$7(FilterService2, _super);
    function FilterService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    FilterService2.prototype.filter = function(changedPath) {
      var filterActive = this.filterManager.isColumnFilterPresent() || this.filterManager.isQuickFilterPresent() || this.filterManager.isExternalFilterPresent();
      this.filterNodes(filterActive, changedPath);
    };
    FilterService2.prototype.filterNodes = function(filterActive, changedPath) {
      var _this = this;
      var filterCallback = function(rowNode, includeChildNodes) {
        if (rowNode.hasChildren()) {
          if (filterActive && !includeChildNodes) {
            rowNode.childrenAfterFilter = rowNode.childrenAfterGroup.filter(function(childNode) {
              var passBecauseChildren = childNode.childrenAfterFilter && childNode.childrenAfterFilter.length > 0;
              var passBecauseDataPasses = childNode.data && _this.filterManager.doesRowPassFilter({ rowNode: childNode });
              return passBecauseChildren || passBecauseDataPasses;
            });
          } else {
            rowNode.childrenAfterFilter = rowNode.childrenAfterGroup;
          }
        } else {
          rowNode.childrenAfterFilter = rowNode.childrenAfterGroup;
        }
        if (rowNode.sibling) {
          rowNode.sibling.childrenAfterFilter = rowNode.childrenAfterFilter;
        }
      };
      if (this.doingTreeDataFiltering()) {
        var treeDataDepthFirstFilter_1 = function(rowNode, alreadyFoundInParent) {
          if (rowNode.childrenAfterGroup) {
            for (var i = 0; i < rowNode.childrenAfterGroup.length; i++) {
              var childNode = rowNode.childrenAfterGroup[i];
              var foundInParent = alreadyFoundInParent || _this.filterManager.doesRowPassFilter({ rowNode: childNode });
              if (childNode.childrenAfterGroup) {
                treeDataDepthFirstFilter_1(rowNode.childrenAfterGroup[i], foundInParent);
              } else {
                filterCallback(childNode, foundInParent);
              }
            }
          }
          filterCallback(rowNode, alreadyFoundInParent);
        };
        var treeDataFilterCallback = function(rowNode) {
          return treeDataDepthFirstFilter_1(rowNode, false);
        };
        changedPath.executeFromRootNode(treeDataFilterCallback);
      } else {
        var defaultFilterCallback = function(rowNode) {
          return filterCallback(rowNode, false);
        };
        changedPath.forEachChangedNodeDepthFirst(defaultFilterCallback, true);
      }
    };
    FilterService2.prototype.doingTreeDataFiltering = function() {
      return this.gridOptionsService.isTreeData() && !this.gridOptionsService.is("excludeChildrenWhenTreeDataFiltering");
    };
    __decorate$6([
      Autowired("filterManager")
    ], FilterService2.prototype, "filterManager", void 0);
    FilterService2 = __decorate$6([
      Bean("filterService")
    ], FilterService2);
    return FilterService2;
  }(BeanStub)
);
var __extends$6 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$5 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __read = function(o, n2) {
  var m2 = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m2)
    return o;
  var i = m2.call(o), r2, ar = [], e;
  try {
    while ((n2 === void 0 || n2-- > 0) && !(r2 = i.next()).done)
      ar.push(r2.value);
  } catch (error) {
    e = { error };
  } finally {
    try {
      if (r2 && !r2.done && (m2 = i["return"]))
        m2.call(i);
    } finally {
      if (e)
        throw e.error;
    }
  }
  return ar;
};
var ImmutableService = (
  /** @class */
  function(_super) {
    __extends$6(ImmutableService2, _super);
    function ImmutableService2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    ImmutableService2.prototype.postConstruct = function() {
      if (this.rowModel.getType() === "clientSide") {
        this.clientSideRowModel = this.rowModel;
      }
    };
    ImmutableService2.prototype.isActive = function() {
      var getRowIdProvided = this.gridOptionsService.exists("getRowId");
      var resetRowDataOnUpdate = this.gridOptionsService.is("resetRowDataOnUpdate");
      if (resetRowDataOnUpdate) {
        return false;
      }
      return getRowIdProvided;
    };
    ImmutableService2.prototype.setRowData = function(rowData) {
      var transactionAndMap = this.createTransactionForRowData(rowData);
      if (!transactionAndMap) {
        return;
      }
      var _a2 = __read(transactionAndMap, 2), transaction = _a2[0], orderIdMap = _a2[1];
      this.clientSideRowModel.updateRowData(transaction, orderIdMap);
    };
    ImmutableService2.prototype.createTransactionForRowData = function(rowData) {
      if (_.missing(this.clientSideRowModel)) {
        console.error("AG Grid: ImmutableService only works with ClientSideRowModel");
        return;
      }
      var getRowIdFunc = this.gridOptionsService.getCallback("getRowId");
      if (getRowIdFunc == null) {
        console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");
        return;
      }
      var transaction = {
        remove: [],
        update: [],
        add: []
      };
      var existingNodesMap = this.clientSideRowModel.getCopyOfNodesMap();
      var suppressSortOrder = this.gridOptionsService.is("suppressMaintainUnsortedOrder");
      var orderMap = suppressSortOrder ? void 0 : {};
      if (_.exists(rowData)) {
        rowData.forEach(function(data, index2) {
          var id2 = getRowIdFunc({ data, level: 0 });
          var existingNode = existingNodesMap[id2];
          if (orderMap) {
            orderMap[id2] = index2;
          }
          if (existingNode) {
            var dataHasChanged = existingNode.data !== data;
            if (dataHasChanged) {
              transaction.update.push(data);
            }
            existingNodesMap[id2] = void 0;
          } else {
            transaction.add.push(data);
          }
        });
      }
      _.iterateObject(existingNodesMap, function(id2, rowNode) {
        if (rowNode) {
          transaction.remove.push(rowNode.data);
        }
      });
      return [transaction, orderMap];
    };
    __decorate$5([
      Autowired("rowModel")
    ], ImmutableService2.prototype, "rowModel", void 0);
    __decorate$5([
      Autowired("rowRenderer")
    ], ImmutableService2.prototype, "rowRenderer", void 0);
    __decorate$5([
      PostConstruct
    ], ImmutableService2.prototype, "postConstruct", null);
    ImmutableService2 = __decorate$5([
      Bean("immutableService")
    ], ImmutableService2);
    return ImmutableService2;
  }(BeanStub)
);
var VERSION$2 = "30.0.6";
var ClientSideRowModelModule = {
  version: VERSION$2,
  moduleName: ModuleNames.ClientSideRowModelModule,
  rowModel: "clientSide",
  beans: [ClientSideRowModel, FilterStage, SortStage, FlattenStage, SortService, FilterService, ImmutableService]
};
var __extends$5 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$4 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var InfiniteBlock = (
  /** @class */
  function(_super) {
    __extends$5(InfiniteBlock2, _super);
    function InfiniteBlock2(id2, parentCache, params) {
      var _this = _super.call(this, id2) || this;
      _this.parentCache = parentCache;
      _this.params = params;
      _this.startRow = id2 * params.blockSize;
      _this.endRow = _this.startRow + params.blockSize;
      return _this;
    }
    InfiniteBlock2.prototype.postConstruct = function() {
      this.createRowNodes();
    };
    InfiniteBlock2.prototype.getBlockStateJson = function() {
      return {
        id: "" + this.getId(),
        state: {
          blockNumber: this.getId(),
          startRow: this.getStartRow(),
          endRow: this.getEndRow(),
          pageStatus: this.getState()
        }
      };
    };
    InfiniteBlock2.prototype.setDataAndId = function(rowNode, data, index2) {
      if (_.exists(data)) {
        rowNode.setDataAndId(data, index2.toString());
      } else {
        rowNode.setDataAndId(void 0, void 0);
      }
    };
    InfiniteBlock2.prototype.loadFromDatasource = function() {
      var _this = this;
      var params = this.createLoadParams();
      if (_.missing(this.params.datasource.getRows)) {
        console.warn("AG Grid: datasource is missing getRows method");
        return;
      }
      window.setTimeout(function() {
        _this.params.datasource.getRows(params);
      }, 0);
    };
    InfiniteBlock2.prototype.processServerFail = function() {
    };
    InfiniteBlock2.prototype.createLoadParams = function() {
      var params = {
        startRow: this.getStartRow(),
        endRow: this.getEndRow(),
        successCallback: this.pageLoaded.bind(this, this.getVersion()),
        failCallback: this.pageLoadFailed.bind(this, this.getVersion()),
        sortModel: this.params.sortModel,
        filterModel: this.params.filterModel,
        context: this.gridOptionsService.context
      };
      return params;
    };
    InfiniteBlock2.prototype.forEachNode = function(callback2, sequence, rowCount) {
      var _this = this;
      this.rowNodes.forEach(function(rowNode, index2) {
        var rowIndex = _this.startRow + index2;
        if (rowIndex < rowCount) {
          callback2(rowNode, sequence.next());
        }
      });
    };
    InfiniteBlock2.prototype.getLastAccessed = function() {
      return this.lastAccessed;
    };
    InfiniteBlock2.prototype.getRow = function(rowIndex, dontTouchLastAccessed) {
      if (dontTouchLastAccessed === void 0) {
        dontTouchLastAccessed = false;
      }
      if (!dontTouchLastAccessed) {
        this.lastAccessed = this.params.lastAccessedSequence.next();
      }
      var localIndex = rowIndex - this.startRow;
      return this.rowNodes[localIndex];
    };
    InfiniteBlock2.prototype.getStartRow = function() {
      return this.startRow;
    };
    InfiniteBlock2.prototype.getEndRow = function() {
      return this.endRow;
    };
    InfiniteBlock2.prototype.createRowNodes = function() {
      this.rowNodes = [];
      for (var i = 0; i < this.params.blockSize; i++) {
        var rowIndex = this.startRow + i;
        var rowNode = new RowNode2(this.beans);
        rowNode.setRowHeight(this.params.rowHeight);
        rowNode.uiLevel = 0;
        rowNode.setRowIndex(rowIndex);
        rowNode.setRowTop(this.params.rowHeight * rowIndex);
        this.rowNodes.push(rowNode);
      }
    };
    InfiniteBlock2.prototype.processServerResult = function(params) {
      var _this = this;
      this.rowNodes.forEach(function(rowNode, index2) {
        var data = params.rowData ? params.rowData[index2] : void 0;
        if (!rowNode.id && rowNode.alreadyRendered && data) {
          _this.rowNodes[index2] = new RowNode2(_this.beans);
          _this.rowNodes[index2].setRowIndex(rowNode.rowIndex);
          _this.rowNodes[index2].setRowTop(rowNode.rowTop);
          rowNode.clearRowTopAndRowIndex();
        }
        _this.setDataAndId(_this.rowNodes[index2], data, _this.startRow + index2);
      });
      var finalRowCount = params.rowCount != null && params.rowCount >= 0 ? params.rowCount : void 0;
      this.parentCache.pageLoaded(this, finalRowCount);
    };
    InfiniteBlock2.prototype.destroyRowNodes = function() {
      this.rowNodes.forEach(function(rowNode) {
        rowNode.clearRowTopAndRowIndex();
      });
    };
    __decorate$4([
      Autowired("beans")
    ], InfiniteBlock2.prototype, "beans", void 0);
    __decorate$4([
      PostConstruct
    ], InfiniteBlock2.prototype, "postConstruct", null);
    __decorate$4([
      PreDestroy
    ], InfiniteBlock2.prototype, "destroyRowNodes", null);
    return InfiniteBlock2;
  }(RowNodeBlock)
);
var __extends$4$1 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$3 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var __param = function(paramIndex, decorator) {
  return function(target, key) {
    decorator(target, key, paramIndex);
  };
};
var InfiniteCache = (
  /** @class */
  function(_super) {
    __extends$4$1(InfiniteCache2, _super);
    function InfiniteCache2(params) {
      var _this = _super.call(this) || this;
      _this.lastRowIndexKnown = false;
      _this.blocks = {};
      _this.blockCount = 0;
      _this.rowCount = params.initialRowCount;
      _this.params = params;
      return _this;
    }
    InfiniteCache2.prototype.setBeans = function(loggerFactory) {
      this.logger = loggerFactory.create("InfiniteCache");
    };
    InfiniteCache2.prototype.getRow = function(rowIndex, dontCreatePage) {
      if (dontCreatePage === void 0) {
        dontCreatePage = false;
      }
      var blockId = Math.floor(rowIndex / this.params.blockSize);
      var block = this.blocks[blockId];
      if (!block) {
        if (dontCreatePage) {
          return void 0;
        }
        block = this.createBlock(blockId);
      }
      return block.getRow(rowIndex);
    };
    InfiniteCache2.prototype.createBlock = function(blockNumber) {
      var newBlock = this.createBean(new InfiniteBlock(blockNumber, this, this.params));
      this.blocks[newBlock.getId()] = newBlock;
      this.blockCount++;
      this.purgeBlocksIfNeeded(newBlock);
      this.params.rowNodeBlockLoader.addBlock(newBlock);
      return newBlock;
    };
    InfiniteCache2.prototype.refreshCache = function() {
      var nothingToRefresh = this.blockCount == 0;
      if (nothingToRefresh) {
        this.purgeCache();
        return;
      }
      this.getBlocksInOrder().forEach(function(block) {
        return block.setStateWaitingToLoad();
      });
      this.params.rowNodeBlockLoader.checkBlockToLoad();
    };
    InfiniteCache2.prototype.destroyAllBlocks = function() {
      var _this = this;
      this.getBlocksInOrder().forEach(function(block) {
        return _this.destroyBlock(block);
      });
    };
    InfiniteCache2.prototype.getRowCount = function() {
      return this.rowCount;
    };
    InfiniteCache2.prototype.isLastRowIndexKnown = function() {
      return this.lastRowIndexKnown;
    };
    InfiniteCache2.prototype.pageLoaded = function(block, lastRow) {
      if (!this.isAlive()) {
        return;
      }
      this.logger.log("onPageLoaded: page = " + block.getId() + ", lastRow = " + lastRow);
      this.checkRowCount(block, lastRow);
      this.onCacheUpdated();
    };
    InfiniteCache2.prototype.purgeBlocksIfNeeded = function(blockToExclude) {
      var _this = this;
      var blocksForPurging = this.getBlocksInOrder().filter(function(b) {
        return b != blockToExclude;
      });
      var lastAccessedComparator = function(a, b) {
        return b.getLastAccessed() - a.getLastAccessed();
      };
      blocksForPurging.sort(lastAccessedComparator);
      var maxBlocksProvided = this.params.maxBlocksInCache > 0;
      var blocksToKeep = maxBlocksProvided ? this.params.maxBlocksInCache - 1 : null;
      var emptyBlocksToKeep = InfiniteCache2.MAX_EMPTY_BLOCKS_TO_KEEP - 1;
      blocksForPurging.forEach(function(block, index2) {
        var purgeBecauseBlockEmpty = block.getState() === InfiniteBlock.STATE_WAITING_TO_LOAD && index2 >= emptyBlocksToKeep;
        var purgeBecauseCacheFull = maxBlocksProvided ? index2 >= blocksToKeep : false;
        if (purgeBecauseBlockEmpty || purgeBecauseCacheFull) {
          if (_this.isBlockCurrentlyDisplayed(block)) {
            return;
          }
          if (_this.isBlockFocused(block)) {
            return;
          }
          _this.removeBlockFromCache(block);
        }
      });
    };
    InfiniteCache2.prototype.isBlockFocused = function(block) {
      var focusedCell = this.focusService.getFocusCellToUseAfterRefresh();
      if (!focusedCell) {
        return false;
      }
      if (focusedCell.rowPinned != null) {
        return false;
      }
      var blockIndexStart = block.getStartRow();
      var blockIndexEnd = block.getEndRow();
      var hasFocus = focusedCell.rowIndex >= blockIndexStart && focusedCell.rowIndex < blockIndexEnd;
      return hasFocus;
    };
    InfiniteCache2.prototype.isBlockCurrentlyDisplayed = function(block) {
      var startIndex = block.getStartRow();
      var endIndex = block.getEndRow() - 1;
      return this.rowRenderer.isRangeInRenderedViewport(startIndex, endIndex);
    };
    InfiniteCache2.prototype.removeBlockFromCache = function(blockToRemove) {
      if (!blockToRemove) {
        return;
      }
      this.destroyBlock(blockToRemove);
    };
    InfiniteCache2.prototype.checkRowCount = function(block, lastRow) {
      if (typeof lastRow === "number" && lastRow >= 0) {
        this.rowCount = lastRow;
        this.lastRowIndexKnown = true;
      } else if (!this.lastRowIndexKnown) {
        var lastRowIndex = (block.getId() + 1) * this.params.blockSize;
        var lastRowIndexPlusOverflow = lastRowIndex + this.params.overflowSize;
        if (this.rowCount < lastRowIndexPlusOverflow) {
          this.rowCount = lastRowIndexPlusOverflow;
        }
      }
    };
    InfiniteCache2.prototype.setRowCount = function(rowCount, lastRowIndexKnown) {
      this.rowCount = rowCount;
      if (_.exists(lastRowIndexKnown)) {
        this.lastRowIndexKnown = lastRowIndexKnown;
      }
      if (!this.lastRowIndexKnown) {
        if (this.rowCount % this.params.blockSize === 0) {
          this.rowCount++;
        }
      }
      this.onCacheUpdated();
    };
    InfiniteCache2.prototype.forEachNodeDeep = function(callback2) {
      var _this = this;
      var sequence = new NumberSequence();
      this.getBlocksInOrder().forEach(function(block) {
        return block.forEachNode(callback2, sequence, _this.rowCount);
      });
    };
    InfiniteCache2.prototype.getBlocksInOrder = function() {
      var blockComparator = function(a, b) {
        return a.getId() - b.getId();
      };
      var blocks = _.getAllValuesInObject(this.blocks).sort(blockComparator);
      return blocks;
    };
    InfiniteCache2.prototype.destroyBlock = function(block) {
      delete this.blocks[block.getId()];
      this.destroyBean(block);
      this.blockCount--;
      this.params.rowNodeBlockLoader.removeBlock(block);
    };
    InfiniteCache2.prototype.onCacheUpdated = function() {
      if (this.isAlive()) {
        this.destroyAllBlocksPastVirtualRowCount();
        var event_1 = {
          type: Events.EVENT_STORE_UPDATED
        };
        this.eventService.dispatchEvent(event_1);
      }
    };
    InfiniteCache2.prototype.destroyAllBlocksPastVirtualRowCount = function() {
      var _this = this;
      var blocksToDestroy = [];
      this.getBlocksInOrder().forEach(function(block) {
        var startRow = block.getId() * _this.params.blockSize;
        if (startRow >= _this.rowCount) {
          blocksToDestroy.push(block);
        }
      });
      if (blocksToDestroy.length > 0) {
        blocksToDestroy.forEach(function(block) {
          return _this.destroyBlock(block);
        });
      }
    };
    InfiniteCache2.prototype.purgeCache = function() {
      var _this = this;
      this.getBlocksInOrder().forEach(function(block) {
        return _this.removeBlockFromCache(block);
      });
      this.lastRowIndexKnown = false;
      if (this.rowCount === 0) {
        this.rowCount = this.params.initialRowCount;
      }
      this.onCacheUpdated();
    };
    InfiniteCache2.prototype.getRowNodesInRange = function(firstInRange, lastInRange) {
      var _this = this;
      var result = [];
      var lastBlockId = -1;
      var inActiveRange = false;
      var numberSequence = new NumberSequence();
      if (_.missing(firstInRange)) {
        inActiveRange = true;
      }
      var foundGapInSelection = false;
      this.getBlocksInOrder().forEach(function(block) {
        if (foundGapInSelection) {
          return;
        }
        if (inActiveRange && lastBlockId + 1 !== block.getId()) {
          foundGapInSelection = true;
          return;
        }
        lastBlockId = block.getId();
        block.forEachNode(function(rowNode) {
          var hitFirstOrLast = rowNode === firstInRange || rowNode === lastInRange;
          if (inActiveRange || hitFirstOrLast) {
            result.push(rowNode);
          }
          if (hitFirstOrLast) {
            inActiveRange = !inActiveRange;
          }
        }, numberSequence, _this.rowCount);
      });
      var invalidRange = foundGapInSelection || inActiveRange;
      return invalidRange ? [] : result;
    };
    InfiniteCache2.MAX_EMPTY_BLOCKS_TO_KEEP = 2;
    __decorate$3([
      Autowired("rowRenderer")
    ], InfiniteCache2.prototype, "rowRenderer", void 0);
    __decorate$3([
      Autowired("focusService")
    ], InfiniteCache2.prototype, "focusService", void 0);
    __decorate$3([
      __param(0, Qualifier("loggerFactory"))
    ], InfiniteCache2.prototype, "setBeans", null);
    __decorate$3([
      PreDestroy
    ], InfiniteCache2.prototype, "destroyAllBlocks", null);
    return InfiniteCache2;
  }(BeanStub)
);
var __extends$3$1 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$2 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var InfiniteRowModel = (
  /** @class */
  function(_super) {
    __extends$3$1(InfiniteRowModel2, _super);
    function InfiniteRowModel2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    InfiniteRowModel2.prototype.getRowBounds = function(index2) {
      return {
        rowHeight: this.rowHeight,
        rowTop: this.rowHeight * index2
      };
    };
    InfiniteRowModel2.prototype.ensureRowHeightsValid = function(startPixel, endPixel, startLimitIndex, endLimitIndex) {
      return false;
    };
    InfiniteRowModel2.prototype.init = function() {
      var _this = this;
      if (!this.gridOptionsService.isRowModelType("infinite")) {
        return;
      }
      this.rowHeight = this.gridOptionsService.getRowHeightAsNumber();
      this.addEventListeners();
      this.addDestroyFunc(function() {
        return _this.destroyCache();
      });
      this.verifyProps();
    };
    InfiniteRowModel2.prototype.verifyProps = function() {
      if (this.gridOptionsService.exists("initialGroupOrderComparator")) {
        var message_1 = "AG Grid: initialGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.";
        _.doOnce(function() {
          return console.warn(message_1);
        }, "IRM.InitialGroupOrderComparator");
      }
    };
    InfiniteRowModel2.prototype.start = function() {
      this.setDatasource(this.gridOptionsService.get("datasource"));
    };
    InfiniteRowModel2.prototype.destroyDatasource = function() {
      if (this.datasource) {
        this.getContext().destroyBean(this.datasource);
        this.rowRenderer.datasourceChanged();
        this.datasource = null;
      }
    };
    InfiniteRowModel2.prototype.addEventListeners = function() {
      this.addManagedListener(this.eventService, Events.EVENT_FILTER_CHANGED, this.onFilterChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, this.onSortChanged.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_NEW_COLUMNS_LOADED, this.onColumnEverything.bind(this));
      this.addManagedListener(this.eventService, Events.EVENT_STORE_UPDATED, this.onCacheUpdated.bind(this));
    };
    InfiniteRowModel2.prototype.onFilterChanged = function() {
      this.reset();
    };
    InfiniteRowModel2.prototype.onSortChanged = function() {
      this.reset();
    };
    InfiniteRowModel2.prototype.onColumnEverything = function() {
      var resetRequired;
      if (this.cacheParams) {
        resetRequired = this.isSortModelDifferent();
      } else {
        resetRequired = true;
      }
      if (resetRequired) {
        this.reset();
      }
    };
    InfiniteRowModel2.prototype.isSortModelDifferent = function() {
      return !_.jsonEquals(this.cacheParams.sortModel, this.sortController.getSortModel());
    };
    InfiniteRowModel2.prototype.getType = function() {
      return "infinite";
    };
    InfiniteRowModel2.prototype.setDatasource = function(datasource) {
      this.destroyDatasource();
      this.datasource = datasource;
      if (datasource) {
        this.reset();
      }
    };
    InfiniteRowModel2.prototype.isEmpty = function() {
      return !this.infiniteCache;
    };
    InfiniteRowModel2.prototype.isRowsToRender = function() {
      return !!this.infiniteCache;
    };
    InfiniteRowModel2.prototype.getNodesInRangeForSelection = function(firstInRange, lastInRange) {
      return this.infiniteCache ? this.infiniteCache.getRowNodesInRange(firstInRange, lastInRange) : [];
    };
    InfiniteRowModel2.prototype.reset = function() {
      if (!this.datasource) {
        return;
      }
      var getRowIdFunc = this.gridOptionsService.getCallback("getRowId");
      var userGeneratingIds = getRowIdFunc != null;
      if (!userGeneratingIds) {
        this.selectionService.reset();
      }
      this.resetCache();
      var event = this.createModelUpdatedEvent();
      this.eventService.dispatchEvent(event);
    };
    InfiniteRowModel2.prototype.createModelUpdatedEvent = function() {
      return {
        type: Events.EVENT_MODEL_UPDATED,
        // not sure if these should all be false - noticed if after implementing,
        // maybe they should be true?
        newPage: false,
        newData: false,
        keepRenderedRows: true,
        animate: false
      };
    };
    InfiniteRowModel2.prototype.resetCache = function() {
      this.destroyCache();
      this.cacheParams = {
        // the user provided datasource
        datasource: this.datasource,
        // sort and filter model
        filterModel: this.filterManager.getFilterModel(),
        sortModel: this.sortController.getSortModel(),
        rowNodeBlockLoader: this.rowNodeBlockLoader,
        // properties - this way we take a snapshot of them, so if user changes any, they will be
        // used next time we create a new cache, which is generally after a filter or sort change,
        // or a new datasource is set
        initialRowCount: this.defaultIfInvalid(this.gridOptionsService.getNum("infiniteInitialRowCount"), 1),
        maxBlocksInCache: this.gridOptionsService.getNum("maxBlocksInCache"),
        rowHeight: this.gridOptionsService.getRowHeightAsNumber(),
        // if user doesn't provide overflow, we use default overflow of 1, so user can scroll past
        // the current page and request first row of next page
        overflowSize: this.defaultIfInvalid(this.gridOptionsService.getNum("cacheOverflowSize"), 1),
        // page size needs to be 1 or greater. having it at 1 would be silly, as you would be hitting the
        // server for one page at a time. so the default if not specified is 100.
        blockSize: this.defaultIfInvalid(this.gridOptionsService.getNum("cacheBlockSize"), 100),
        // the cache could create this, however it is also used by the pages, so handy to create it
        // here as the settings are also passed to the pages
        lastAccessedSequence: new NumberSequence()
      };
      this.infiniteCache = this.createBean(new InfiniteCache(this.cacheParams));
    };
    InfiniteRowModel2.prototype.defaultIfInvalid = function(value, defaultValue) {
      return value > 0 ? value : defaultValue;
    };
    InfiniteRowModel2.prototype.destroyCache = function() {
      if (this.infiniteCache) {
        this.infiniteCache = this.destroyBean(this.infiniteCache);
      }
    };
    InfiniteRowModel2.prototype.onCacheUpdated = function() {
      var event = this.createModelUpdatedEvent();
      this.eventService.dispatchEvent(event);
    };
    InfiniteRowModel2.prototype.getRow = function(rowIndex) {
      if (!this.infiniteCache) {
        return void 0;
      }
      if (rowIndex >= this.infiniteCache.getRowCount()) {
        return void 0;
      }
      return this.infiniteCache.getRow(rowIndex);
    };
    InfiniteRowModel2.prototype.getRowNode = function(id2) {
      var result;
      this.forEachNode(function(rowNode) {
        if (rowNode.id === id2) {
          result = rowNode;
        }
      });
      return result;
    };
    InfiniteRowModel2.prototype.forEachNode = function(callback2) {
      if (this.infiniteCache) {
        this.infiniteCache.forEachNodeDeep(callback2);
      }
    };
    InfiniteRowModel2.prototype.getTopLevelRowCount = function() {
      return this.getRowCount();
    };
    InfiniteRowModel2.prototype.getTopLevelRowDisplayedIndex = function(topLevelIndex) {
      return topLevelIndex;
    };
    InfiniteRowModel2.prototype.getRowIndexAtPixel = function(pixel) {
      if (this.rowHeight !== 0) {
        var rowIndexForPixel = Math.floor(pixel / this.rowHeight);
        var lastRowIndex = this.getRowCount() - 1;
        if (rowIndexForPixel > lastRowIndex) {
          return lastRowIndex;
        }
        return rowIndexForPixel;
      }
      return 0;
    };
    InfiniteRowModel2.prototype.getRowCount = function() {
      return this.infiniteCache ? this.infiniteCache.getRowCount() : 0;
    };
    InfiniteRowModel2.prototype.isRowPresent = function(rowNode) {
      var foundRowNode = this.getRowNode(rowNode.id);
      return !!foundRowNode;
    };
    InfiniteRowModel2.prototype.refreshCache = function() {
      if (this.infiniteCache) {
        this.infiniteCache.refreshCache();
      }
    };
    InfiniteRowModel2.prototype.purgeCache = function() {
      if (this.infiniteCache) {
        this.infiniteCache.purgeCache();
      }
    };
    InfiniteRowModel2.prototype.isLastRowIndexKnown = function() {
      if (this.infiniteCache) {
        return this.infiniteCache.isLastRowIndexKnown();
      }
      return false;
    };
    InfiniteRowModel2.prototype.setRowCount = function(rowCount, lastRowIndexKnown) {
      if (this.infiniteCache) {
        this.infiniteCache.setRowCount(rowCount, lastRowIndexKnown);
      }
    };
    __decorate$2([
      Autowired("filterManager")
    ], InfiniteRowModel2.prototype, "filterManager", void 0);
    __decorate$2([
      Autowired("sortController")
    ], InfiniteRowModel2.prototype, "sortController", void 0);
    __decorate$2([
      Autowired("selectionService")
    ], InfiniteRowModel2.prototype, "selectionService", void 0);
    __decorate$2([
      Autowired("rowRenderer")
    ], InfiniteRowModel2.prototype, "rowRenderer", void 0);
    __decorate$2([
      Autowired("rowNodeBlockLoader")
    ], InfiniteRowModel2.prototype, "rowNodeBlockLoader", void 0);
    __decorate$2([
      PostConstruct
    ], InfiniteRowModel2.prototype, "init", null);
    __decorate$2([
      PreDestroy
    ], InfiniteRowModel2.prototype, "destroyDatasource", null);
    InfiniteRowModel2 = __decorate$2([
      Bean("rowModel")
    ], InfiniteRowModel2);
    return InfiniteRowModel2;
  }(BeanStub)
);
var VERSION$1 = "30.0.6";
var InfiniteRowModelModule = {
  version: VERSION$1,
  moduleName: ModuleNames.InfiniteRowModelModule,
  rowModel: "infinite",
  beans: [InfiniteRowModel]
};
var BaseCreator = (
  /** @class */
  function() {
    function BaseCreator2() {
    }
    BaseCreator2.prototype.setBeans = function(beans) {
      this.beans = beans;
    };
    BaseCreator2.prototype.getFileName = function(fileName) {
      var extension = this.getDefaultFileExtension();
      if (fileName == null || !fileName.length) {
        fileName = this.getDefaultFileName();
      }
      return fileName.indexOf(".") === -1 ? fileName + "." + extension : fileName;
    };
    BaseCreator2.prototype.getData = function(params) {
      var serializingSession = this.createSerializingSession(params);
      var data = this.beans.gridSerializer.serialize(serializingSession, params);
      return data;
    };
    return BaseCreator2;
  }()
);
var BaseGridSerializingSession = (
  /** @class */
  function() {
    function BaseGridSerializingSession2(config) {
      this.groupColumns = [];
      var columnModel = config.columnModel, valueService = config.valueService, gridOptionsService = config.gridOptionsService, valueFormatterService = config.valueFormatterService, valueParserService = config.valueParserService, processCellCallback = config.processCellCallback, processHeaderCallback = config.processHeaderCallback, processGroupHeaderCallback = config.processGroupHeaderCallback, processRowGroupCallback = config.processRowGroupCallback;
      this.columnModel = columnModel;
      this.valueService = valueService;
      this.gridOptionsService = gridOptionsService;
      this.valueFormatterService = valueFormatterService;
      this.valueParserService = valueParserService;
      this.processCellCallback = processCellCallback;
      this.processHeaderCallback = processHeaderCallback;
      this.processGroupHeaderCallback = processGroupHeaderCallback;
      this.processRowGroupCallback = processRowGroupCallback;
    }
    BaseGridSerializingSession2.prototype.prepare = function(columnsToExport) {
      this.groupColumns = columnsToExport.filter(function(col) {
        return !!col.getColDef().showRowGroup;
      });
    };
    BaseGridSerializingSession2.prototype.extractHeaderValue = function(column) {
      var value = this.getHeaderName(this.processHeaderCallback, column);
      return value != null ? value : "";
    };
    BaseGridSerializingSession2.prototype.extractRowCellValue = function(column, index2, accumulatedRowIndex, type, node) {
      var hideOpenParents = this.gridOptionsService.is("groupHideOpenParents");
      var value = (!hideOpenParents || node.footer) && this.shouldRenderGroupSummaryCell(node, column, index2) ? this.createValueForGroupNode(node) : this.valueService.getValue(column, node);
      var processedValue = this.processCell({
        accumulatedRowIndex,
        rowNode: node,
        column,
        value,
        processCellCallback: this.processCellCallback,
        type
      });
      return processedValue;
    };
    BaseGridSerializingSession2.prototype.shouldRenderGroupSummaryCell = function(node, column, currentColumnIndex) {
      var _a2;
      var isGroupNode = node && node.group;
      if (!isGroupNode) {
        return false;
      }
      var currentColumnGroupIndex = this.groupColumns.indexOf(column);
      if (currentColumnGroupIndex !== -1) {
        if (((_a2 = node.groupData) === null || _a2 === void 0 ? void 0 : _a2[column.getId()]) != null) {
          return true;
        }
        if (node.footer && node.level === -1) {
          var colDef = column.getColDef();
          var isFullWidth = colDef == null || colDef.showRowGroup === true;
          return isFullWidth || colDef.showRowGroup === this.columnModel.getRowGroupColumns()[0].getId();
        }
      }
      var isGroupUseEntireRow = this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());
      return currentColumnIndex === 0 && isGroupUseEntireRow;
    };
    BaseGridSerializingSession2.prototype.getHeaderName = function(callback2, column) {
      if (callback2) {
        return callback2({
          column,
          api: this.gridOptionsService.api,
          columnApi: this.gridOptionsService.columnApi,
          context: this.gridOptionsService.context
        });
      }
      return this.columnModel.getDisplayNameForColumn(column, "csv", true);
    };
    BaseGridSerializingSession2.prototype.createValueForGroupNode = function(node) {
      if (this.processRowGroupCallback) {
        return this.processRowGroupCallback({
          node,
          api: this.gridOptionsService.api,
          columnApi: this.gridOptionsService.columnApi,
          context: this.gridOptionsService.context
        });
      }
      var isFooter = node.footer;
      var keys2 = [node.key];
      if (!this.gridOptionsService.isGroupMultiAutoColumn()) {
        while (node.parent) {
          node = node.parent;
          keys2.push(node.key);
        }
      }
      var groupValue = keys2.reverse().join(" -> ");
      return isFooter ? "Total " + groupValue : groupValue;
    };
    BaseGridSerializingSession2.prototype.processCell = function(params) {
      var _this = this;
      var _a2;
      var accumulatedRowIndex = params.accumulatedRowIndex, rowNode = params.rowNode, column = params.column, value = params.value, processCellCallback = params.processCellCallback, type = params.type;
      if (processCellCallback) {
        return {
          value: (_a2 = processCellCallback({
            accumulatedRowIndex,
            column,
            node: rowNode,
            value,
            api: this.gridOptionsService.api,
            columnApi: this.gridOptionsService.columnApi,
            context: this.gridOptionsService.context,
            type,
            parseValue: function(valueToParse) {
              return _this.valueParserService.parseValue(column, rowNode, valueToParse, _this.valueService.getValue(column, rowNode));
            },
            formatValue: function(valueToFormat) {
              var _a3;
              return (_a3 = _this.valueFormatterService.formatValue(column, rowNode, valueToFormat)) !== null && _a3 !== void 0 ? _a3 : valueToFormat;
            }
          })) !== null && _a2 !== void 0 ? _a2 : ""
        };
      }
      if (column.getColDef().useValueFormatterForExport) {
        return {
          value: value !== null && value !== void 0 ? value : "",
          valueFormatted: this.valueFormatterService.formatValue(column, rowNode, value)
        };
      }
      return { value: value !== null && value !== void 0 ? value : "" };
    };
    return BaseGridSerializingSession2;
  }()
);
var Downloader = (
  /** @class */
  function() {
    function Downloader2() {
    }
    Downloader2.download = function(fileName, content) {
      var win = document.defaultView || window;
      if (!win) {
        console.warn("AG Grid: There is no `window` associated with the current `document`");
        return;
      }
      var element = document.createElement("a");
      var url = win.URL.createObjectURL(content);
      element.setAttribute("href", url);
      element.setAttribute("download", fileName);
      element.style.display = "none";
      document.body.appendChild(element);
      element.dispatchEvent(new MouseEvent("click", {
        bubbles: false,
        cancelable: true,
        view: win
      }));
      document.body.removeChild(element);
      win.setTimeout(function() {
        win.URL.revokeObjectURL(url);
      }, 0);
    };
    return Downloader2;
  }()
);
var __extends$2$1 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var LINE_SEPARATOR$1 = "\r\n";
var CsvSerializingSession = (
  /** @class */
  function(_super) {
    __extends$2$1(CsvSerializingSession2, _super);
    function CsvSerializingSession2(config) {
      var _this = _super.call(this, config) || this;
      _this.isFirstLine = true;
      _this.result = "";
      var suppressQuotes = config.suppressQuotes, columnSeparator = config.columnSeparator;
      _this.suppressQuotes = suppressQuotes;
      _this.columnSeparator = columnSeparator;
      return _this;
    }
    CsvSerializingSession2.prototype.addCustomContent = function(content) {
      var _this = this;
      if (!content) {
        return;
      }
      if (typeof content === "string") {
        if (!/^\s*\n/.test(content)) {
          this.beginNewLine();
        }
        content = content.replace(/\r?\n/g, LINE_SEPARATOR$1);
        this.result += content;
      } else {
        content.forEach(function(row) {
          _this.beginNewLine();
          row.forEach(function(cell, index2) {
            if (index2 !== 0) {
              _this.result += _this.columnSeparator;
            }
            _this.result += _this.putInQuotes(cell.data.value || "");
            if (cell.mergeAcross) {
              _this.appendEmptyCells(cell.mergeAcross);
            }
          });
        });
      }
    };
    CsvSerializingSession2.prototype.onNewHeaderGroupingRow = function() {
      this.beginNewLine();
      return {
        onColumn: this.onNewHeaderGroupingRowColumn.bind(this)
      };
    };
    CsvSerializingSession2.prototype.onNewHeaderGroupingRowColumn = function(columnGroup, header, index2, span) {
      if (index2 != 0) {
        this.result += this.columnSeparator;
      }
      this.result += this.putInQuotes(header);
      this.appendEmptyCells(span);
    };
    CsvSerializingSession2.prototype.appendEmptyCells = function(count) {
      for (var i = 1; i <= count; i++) {
        this.result += this.columnSeparator + this.putInQuotes("");
      }
    };
    CsvSerializingSession2.prototype.onNewHeaderRow = function() {
      this.beginNewLine();
      return {
        onColumn: this.onNewHeaderRowColumn.bind(this)
      };
    };
    CsvSerializingSession2.prototype.onNewHeaderRowColumn = function(column, index2) {
      if (index2 != 0) {
        this.result += this.columnSeparator;
      }
      this.result += this.putInQuotes(this.extractHeaderValue(column));
    };
    CsvSerializingSession2.prototype.onNewBodyRow = function() {
      this.beginNewLine();
      return {
        onColumn: this.onNewBodyRowColumn.bind(this)
      };
    };
    CsvSerializingSession2.prototype.onNewBodyRowColumn = function(column, index2, node) {
      var _a2;
      if (index2 != 0) {
        this.result += this.columnSeparator;
      }
      var rowCellValue = this.extractRowCellValue(column, index2, index2, "csv", node);
      this.result += this.putInQuotes((_a2 = rowCellValue.valueFormatted) !== null && _a2 !== void 0 ? _a2 : rowCellValue.value);
    };
    CsvSerializingSession2.prototype.putInQuotes = function(value) {
      if (this.suppressQuotes) {
        return value;
      }
      if (value === null || value === void 0) {
        return '""';
      }
      var stringValue;
      if (typeof value === "string") {
        stringValue = value;
      } else if (typeof value.toString === "function") {
        stringValue = value.toString();
      } else {
        console.warn("AG Grid: unknown value type during csv conversion");
        stringValue = "";
      }
      var valueEscaped = stringValue.replace(/"/g, '""');
      return '"' + valueEscaped + '"';
    };
    CsvSerializingSession2.prototype.parse = function() {
      return this.result;
    };
    CsvSerializingSession2.prototype.beginNewLine = function() {
      if (!this.isFirstLine) {
        this.result += LINE_SEPARATOR$1;
      }
      this.isFirstLine = false;
    };
    return CsvSerializingSession2;
  }(BaseGridSerializingSession)
);
var __extends$1$1 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate$1 = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var CsvCreator = (
  /** @class */
  function(_super) {
    __extends$1$1(CsvCreator2, _super);
    function CsvCreator2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    CsvCreator2.prototype.postConstruct = function() {
      this.setBeans({
        gridSerializer: this.gridSerializer,
        gridOptionsService: this.gridOptionsService
      });
    };
    CsvCreator2.prototype.getMergedParams = function(params) {
      var baseParams = this.gridOptionsService.get("defaultCsvExportParams");
      return Object.assign({}, baseParams, params);
    };
    CsvCreator2.prototype.export = function(userParams) {
      if (this.isExportSuppressed()) {
        console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration.");
        return "";
      }
      var mergedParams = this.getMergedParams(userParams);
      var data = this.getData(mergedParams);
      var packagedFile = new Blob(["\uFEFF", data], { type: "text/plain" });
      Downloader.download(this.getFileName(mergedParams.fileName), packagedFile);
      return data;
    };
    CsvCreator2.prototype.exportDataAsCsv = function(params) {
      return this.export(params);
    };
    CsvCreator2.prototype.getDataAsCsv = function(params, skipDefaultParams) {
      if (skipDefaultParams === void 0) {
        skipDefaultParams = false;
      }
      var mergedParams = skipDefaultParams ? Object.assign({}, params) : this.getMergedParams(params);
      return this.getData(mergedParams);
    };
    CsvCreator2.prototype.getDefaultFileName = function() {
      return "export.csv";
    };
    CsvCreator2.prototype.getDefaultFileExtension = function() {
      return "csv";
    };
    CsvCreator2.prototype.createSerializingSession = function(params) {
      var _a2 = this, columnModel = _a2.columnModel, valueService = _a2.valueService, gridOptionsService = _a2.gridOptionsService, valueFormatterService = _a2.valueFormatterService, valueParserService = _a2.valueParserService;
      var _b2 = params, processCellCallback = _b2.processCellCallback, processHeaderCallback = _b2.processHeaderCallback, processGroupHeaderCallback = _b2.processGroupHeaderCallback, processRowGroupCallback = _b2.processRowGroupCallback, suppressQuotes = _b2.suppressQuotes, columnSeparator = _b2.columnSeparator;
      return new CsvSerializingSession({
        columnModel,
        valueService,
        gridOptionsService,
        valueFormatterService,
        valueParserService,
        processCellCallback: processCellCallback || void 0,
        processHeaderCallback: processHeaderCallback || void 0,
        processGroupHeaderCallback: processGroupHeaderCallback || void 0,
        processRowGroupCallback: processRowGroupCallback || void 0,
        suppressQuotes: suppressQuotes || false,
        columnSeparator: columnSeparator || ","
      });
    };
    CsvCreator2.prototype.isExportSuppressed = function() {
      return this.gridOptionsService.is("suppressCsvExport");
    };
    __decorate$1([
      Autowired("columnModel")
    ], CsvCreator2.prototype, "columnModel", void 0);
    __decorate$1([
      Autowired("valueService")
    ], CsvCreator2.prototype, "valueService", void 0);
    __decorate$1([
      Autowired("gridSerializer")
    ], CsvCreator2.prototype, "gridSerializer", void 0);
    __decorate$1([
      Autowired("gridOptionsService")
    ], CsvCreator2.prototype, "gridOptionsService", void 0);
    __decorate$1([
      Autowired("valueFormatterService")
    ], CsvCreator2.prototype, "valueFormatterService", void 0);
    __decorate$1([
      Autowired("valueParserService")
    ], CsvCreator2.prototype, "valueParserService", void 0);
    __decorate$1([
      PostConstruct
    ], CsvCreator2.prototype, "postConstruct", null);
    CsvCreator2 = __decorate$1([
      Bean("csvCreator")
    ], CsvCreator2);
    return CsvCreator2;
  }(BaseCreator)
);
var __extends$30 = function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __decorate = function(decorators, target, key, desc) {
  var c = arguments.length, r2 = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
    r2 = Reflect.decorate(decorators, target, key, desc);
  else
    for (var i = decorators.length - 1; i >= 0; i--)
      if (d = decorators[i])
        r2 = (c < 3 ? d(r2) : c > 3 ? d(target, key, r2) : d(target, key)) || r2;
  return c > 3 && r2 && Object.defineProperty(target, key, r2), r2;
};
var RowType;
(function(RowType2) {
  RowType2[RowType2["HEADER_GROUPING"] = 0] = "HEADER_GROUPING";
  RowType2[RowType2["HEADER"] = 1] = "HEADER";
  RowType2[RowType2["BODY"] = 2] = "BODY";
})(RowType || (RowType = {}));
var GridSerializer = (
  /** @class */
  function(_super) {
    __extends$30(GridSerializer2, _super);
    function GridSerializer2() {
      return _super !== null && _super.apply(this, arguments) || this;
    }
    GridSerializer2.prototype.serialize = function(gridSerializingSession, params) {
      if (params === void 0) {
        params = {};
      }
      var columnsToExport = this.getColumnsToExport(params.allColumns, params.columnKeys);
      var serializeChain = _.compose(
        // first pass, put in the header names of the cols
        this.prepareSession(columnsToExport),
        this.prependContent(params),
        this.exportColumnGroups(params, columnsToExport),
        this.exportHeaders(params, columnsToExport),
        this.processPinnedTopRows(params, columnsToExport),
        this.processRows(params, columnsToExport),
        this.processPinnedBottomRows(params, columnsToExport),
        this.appendContent(params)
      );
      return serializeChain(gridSerializingSession).parse();
    };
    GridSerializer2.prototype.processRow = function(gridSerializingSession, params, columnsToExport, node) {
      var rowSkipper = params.shouldRowBeSkipped || function() {
        return false;
      };
      var context = this.gridOptionsService.context;
      var api = this.gridOptionsService.api;
      var columnApi = this.gridOptionsService.columnApi;
      var skipSingleChildrenGroup = this.gridOptionsService.is("groupRemoveSingleChildren");
      var skipLowestSingleChildrenGroup = this.gridOptionsService.is("groupRemoveLowestSingleChildren");
      var isClipboardExport = params.rowPositions != null;
      var isExplicitExportSelection = isClipboardExport || !!params.onlySelected;
      var hideOpenParents = this.gridOptionsService.is("groupHideOpenParents") && !isExplicitExportSelection;
      var isLeafNode = this.columnModel.isPivotMode() ? node.leafGroup : !node.group;
      var isFooter = !!node.footer;
      var skipRowGroups = params.skipGroups || params.skipRowGroups;
      var shouldSkipLowestGroup = skipLowestSingleChildrenGroup && node.leafGroup;
      var shouldSkipCurrentGroup = node.allChildrenCount === 1 && (skipSingleChildrenGroup || shouldSkipLowestGroup);
      if (skipRowGroups && params.skipGroups) {
        _.doOnce(function() {
          return console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`.");
        }, "gridSerializer-skipGroups");
      }
      if (!isLeafNode && !isFooter && (params.skipRowGroups || shouldSkipCurrentGroup || hideOpenParents) || params.onlySelected && !node.isSelected() || params.skipPinnedTop && node.rowPinned === "top" || params.skipPinnedBottom && node.rowPinned === "bottom") {
        return;
      }
      var nodeIsRootNode = node.level === -1;
      if (nodeIsRootNode && !isLeafNode && !isFooter) {
        return;
      }
      var shouldRowBeSkipped = rowSkipper({ node, api, columnApi, context });
      if (shouldRowBeSkipped) {
        return;
      }
      var rowAccumulator = gridSerializingSession.onNewBodyRow(node);
      columnsToExport.forEach(function(column, index2) {
        rowAccumulator.onColumn(column, index2, node);
      });
      if (params.getCustomContentBelowRow) {
        var content = params.getCustomContentBelowRow({ node, api, columnApi, context });
        if (content) {
          gridSerializingSession.addCustomContent(content);
        }
      }
    };
    GridSerializer2.prototype.appendContent = function(params) {
      return function(gridSerializingSession) {
        var appendContent = params.customFooter || params.appendContent;
        if (appendContent) {
          if (params.customFooter) {
            _.doOnce(function() {
              return console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead.");
            }, "gridSerializer-customFooter");
          }
          gridSerializingSession.addCustomContent(appendContent);
        }
        return gridSerializingSession;
      };
    };
    GridSerializer2.prototype.prependContent = function(params) {
      return function(gridSerializingSession) {
        var prependContent = params.customHeader || params.prependContent;
        if (prependContent) {
          if (params.customHeader) {
            _.doOnce(function() {
              return console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead.");
            }, "gridSerializer-customHeader");
          }
          gridSerializingSession.addCustomContent(prependContent);
        }
        return gridSerializingSession;
      };
    };
    GridSerializer2.prototype.prepareSession = function(columnsToExport) {
      return function(gridSerializingSession) {
        gridSerializingSession.prepare(columnsToExport);
        return gridSerializingSession;
      };
    };
    GridSerializer2.prototype.exportColumnGroups = function(params, columnsToExport) {
      var _this = this;
      return function(gridSerializingSession) {
        if (!params.skipColumnGroupHeaders) {
          var groupInstanceIdCreator = new GroupInstanceIdCreator();
          var displayedGroups = _this.displayedGroupCreator.createDisplayedGroups(columnsToExport, _this.columnModel.getGridBalancedTree(), groupInstanceIdCreator, null);
          _this.recursivelyAddHeaderGroups(displayedGroups, gridSerializingSession, params.processGroupHeaderCallback);
        } else if (params.columnGroups) {
          _.doOnce(function() {
            return console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default.");
          }, "gridSerializer-columnGroups");
        }
        return gridSerializingSession;
      };
    };
    GridSerializer2.prototype.exportHeaders = function(params, columnsToExport) {
      return function(gridSerializingSession) {
        if (!params.skipHeader && !params.skipColumnHeaders) {
          var gridRowIterator_1 = gridSerializingSession.onNewHeaderRow();
          columnsToExport.forEach(function(column, index2) {
            gridRowIterator_1.onColumn(column, index2, void 0);
          });
        } else if (params.skipHeader) {
          _.doOnce(function() {
            return console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`.");
          }, "gridSerializer-skipHeader");
        }
        return gridSerializingSession;
      };
    };
    GridSerializer2.prototype.processPinnedTopRows = function(params, columnsToExport) {
      var _this = this;
      return function(gridSerializingSession) {
        var processRow = _this.processRow.bind(_this, gridSerializingSession, params, columnsToExport);
        if (params.rowPositions) {
          params.rowPositions.filter(function(position) {
            return position.rowPinned === "top";
          }).sort(function(a, b) {
            return a.rowIndex - b.rowIndex;
          }).map(function(position) {
            return _this.pinnedRowModel.getPinnedTopRow(position.rowIndex);
          }).forEach(processRow);
        } else {
          _this.pinnedRowModel.forEachPinnedTopRow(processRow);
        }
        return gridSerializingSession;
      };
    };
    GridSerializer2.prototype.processRows = function(params, columnsToExport) {
      var _this = this;
      return function(gridSerializingSession) {
        var rowModel = _this.rowModel;
        var rowModelType = rowModel.getType();
        var usingCsrm = rowModelType === "clientSide";
        var usingSsrm = rowModelType === "serverSide";
        var onlySelectedNonStandardModel = !usingCsrm && params.onlySelected;
        var processRow = _this.processRow.bind(_this, gridSerializingSession, params, columnsToExport);
        var _a2 = params.exportedRows, exportedRows = _a2 === void 0 ? "filteredAndSorted" : _a2;
        if (params.rowPositions) {
          params.rowPositions.filter(function(position) {
            return position.rowPinned == null;
          }).sort(function(a, b) {
            return a.rowIndex - b.rowIndex;
          }).map(function(position) {
            return rowModel.getRow(position.rowIndex);
          }).forEach(processRow);
        } else if (_this.columnModel.isPivotMode()) {
          if (usingCsrm) {
            rowModel.forEachPivotNode(processRow, true);
          } else {
            rowModel.forEachNode(processRow);
          }
        } else {
          if (params.onlySelectedAllPages || onlySelectedNonStandardModel) {
            var selectedNodes = _this.selectionService.getSelectedNodes();
            _this.replicateSortedOrder(selectedNodes);
            selectedNodes.forEach(processRow);
          } else {
            if (exportedRows === "all") {
              rowModel.forEachNode(processRow);
            } else if (usingCsrm) {
              rowModel.forEachNodeAfterFilterAndSort(processRow, true);
            } else if (usingSsrm) {
              rowModel.forEachNodeAfterFilterAndSort(processRow);
            } else {
              rowModel.forEachNode(processRow);
            }
          }
        }
        return gridSerializingSession;
      };
    };
    GridSerializer2.prototype.replicateSortedOrder = function(rows) {
      var _this = this;
      var sortOptions = this.sortController.getSortOptions();
      var compareNodes = function(rowA, rowB) {
        var _a2, _b2, _c, _d;
        if (rowA.rowIndex != null && rowB.rowIndex != null) {
          return rowA.rowIndex - rowB.rowIndex;
        }
        if (rowA.level === rowB.level) {
          if (((_a2 = rowA.parent) === null || _a2 === void 0 ? void 0 : _a2.id) === ((_b2 = rowB.parent) === null || _b2 === void 0 ? void 0 : _b2.id)) {
            return _this.rowNodeSorter.compareRowNodes(sortOptions, {
              rowNode: rowA,
              currentPos: (_c = rowA.rowIndex) !== null && _c !== void 0 ? _c : -1
            }, {
              rowNode: rowB,
              currentPos: (_d = rowB.rowIndex) !== null && _d !== void 0 ? _d : -1
            });
          }
          return compareNodes(rowA.parent, rowB.parent);
        }
        if (rowA.level > rowB.level) {
          return compareNodes(rowA.parent, rowB);
        }
        return compareNodes(rowA, rowB.parent);
      };
      rows.sort(compareNodes);
    };
    GridSerializer2.prototype.processPinnedBottomRows = function(params, columnsToExport) {
      var _this = this;
      return function(gridSerializingSession) {
        var processRow = _this.processRow.bind(_this, gridSerializingSession, params, columnsToExport);
        if (params.rowPositions) {
          params.rowPositions.filter(function(position) {
            return position.rowPinned === "bottom";
          }).sort(function(a, b) {
            return a.rowIndex - b.rowIndex;
          }).map(function(position) {
            return _this.pinnedRowModel.getPinnedBottomRow(position.rowIndex);
          }).forEach(processRow);
        } else {
          _this.pinnedRowModel.forEachPinnedBottomRow(processRow);
        }
        return gridSerializingSession;
      };
    };
    GridSerializer2.prototype.getColumnsToExport = function(allColumns, columnKeys) {
      if (allColumns === void 0) {
        allColumns = false;
      }
      var isPivotMode = this.columnModel.isPivotMode();
      if (columnKeys && columnKeys.length) {
        return this.columnModel.getGridColumns(columnKeys);
      }
      if (allColumns && !isPivotMode) {
        var columns = this.gridOptionsService.isTreeData() ? this.columnModel.getGridColumns([GROUP_AUTO_COLUMN_ID]) : [];
        return columns.concat(this.columnModel.getAllGridColumns() || []);
      }
      return this.columnModel.getAllDisplayedColumns();
    };
    GridSerializer2.prototype.recursivelyAddHeaderGroups = function(displayedGroups, gridSerializingSession, processGroupHeaderCallback) {
      var directChildrenHeaderGroups = [];
      displayedGroups.forEach(function(columnGroupChild) {
        var columnGroup = columnGroupChild;
        if (!columnGroup.getChildren) {
          return;
        }
        columnGroup.getChildren().forEach(function(it) {
          return directChildrenHeaderGroups.push(it);
        });
      });
      if (displayedGroups.length > 0 && displayedGroups[0] instanceof ColumnGroup) {
        this.doAddHeaderHeader(gridSerializingSession, displayedGroups, processGroupHeaderCallback);
      }
      if (directChildrenHeaderGroups && directChildrenHeaderGroups.length > 0) {
        this.recursivelyAddHeaderGroups(directChildrenHeaderGroups, gridSerializingSession, processGroupHeaderCallback);
      }
    };
    GridSerializer2.prototype.doAddHeaderHeader = function(gridSerializingSession, displayedGroups, processGroupHeaderCallback) {
      var _this = this;
      var gridRowIterator = gridSerializingSession.onNewHeaderGroupingRow();
      var columnIndex = 0;
      displayedGroups.forEach(function(columnGroupChild) {
        var columnGroup = columnGroupChild;
        var name;
        if (processGroupHeaderCallback) {
          name = processGroupHeaderCallback({
            columnGroup,
            api: _this.gridOptionsService.api,
            columnApi: _this.gridOptionsService.columnApi,
            context: _this.gridOptionsService.context
          });
        } else {
          name = _this.columnModel.getDisplayNameForColumnGroup(columnGroup, "header");
        }
        var collapsibleGroupRanges = columnGroup.getLeafColumns().reduce(function(collapsibleGroups, currentColumn, currentIdx, arr) {
          var lastGroup = _.last(collapsibleGroups);
          var groupShow = currentColumn.getColumnGroupShow() === "open";
          if (!groupShow) {
            if (lastGroup && lastGroup[1] == null) {
              lastGroup[1] = currentIdx - 1;
            }
          } else if (!lastGroup || lastGroup[1] != null) {
            lastGroup = [currentIdx];
            collapsibleGroups.push(lastGroup);
          }
          if (currentIdx === arr.length - 1 && lastGroup && lastGroup[1] == null) {
            lastGroup[1] = currentIdx;
          }
          return collapsibleGroups;
        }, []);
        gridRowIterator.onColumn(columnGroup, name || "", columnIndex++, columnGroup.getLeafColumns().length - 1, collapsibleGroupRanges);
      });
    };
    __decorate([
      Autowired("displayedGroupCreator")
    ], GridSerializer2.prototype, "displayedGroupCreator", void 0);
    __decorate([
      Autowired("columnModel")
    ], GridSerializer2.prototype, "columnModel", void 0);
    __decorate([
      Autowired("rowModel")
    ], GridSerializer2.prototype, "rowModel", void 0);
    __decorate([
      Autowired("pinnedRowModel")
    ], GridSerializer2.prototype, "pinnedRowModel", void 0);
    __decorate([
      Autowired("selectionService")
    ], GridSerializer2.prototype, "selectionService", void 0);
    __decorate([
      Autowired("rowNodeSorter")
    ], GridSerializer2.prototype, "rowNodeSorter", void 0);
    __decorate([
      Autowired("sortController")
    ], GridSerializer2.prototype, "sortController", void 0);
    GridSerializer2 = __decorate([
      Bean("gridSerializer")
    ], GridSerializer2);
    return GridSerializer2;
  }(BeanStub)
);
var VERSION = "30.0.6";
var CsvExportModule = {
  version: VERSION,
  moduleName: ModuleNames.CsvExportModule,
  beans: [CsvCreator, GridSerializer]
};
var LINE_SEPARATOR = "\r\n";
var XmlFactory = (
  /** @class */
  function() {
    function XmlFactory2() {
    }
    XmlFactory2.createHeader = function(headerElement) {
      if (headerElement === void 0) {
        headerElement = {};
      }
      var headerStart = "<?";
      var headerEnd = "?>";
      var keys2 = ["version"];
      if (!headerElement.version) {
        headerElement.version = "1.0";
      }
      if (headerElement.encoding) {
        keys2.push("encoding");
      }
      if (headerElement.standalone) {
        keys2.push("standalone");
      }
      var att = keys2.map(function(key) {
        return key + '="' + headerElement[key] + '"';
      }).join(" ");
      return headerStart + "xml " + att + " " + headerEnd;
    };
    XmlFactory2.createXml = function(xmlElement, booleanTransformer) {
      var _this = this;
      var props = "";
      if (xmlElement.properties) {
        if (xmlElement.properties.prefixedAttributes) {
          xmlElement.properties.prefixedAttributes.forEach(function(prefixedSet) {
            Object.keys(prefixedSet.map).forEach(function(key) {
              props += _this.returnAttributeIfPopulated(prefixedSet.prefix + key, prefixedSet.map[key], booleanTransformer);
            });
          });
        }
        if (xmlElement.properties.rawMap) {
          Object.keys(xmlElement.properties.rawMap).forEach(function(key) {
            props += _this.returnAttributeIfPopulated(key, xmlElement.properties.rawMap[key], booleanTransformer);
          });
        }
      }
      var result = "<" + xmlElement.name + props;
      if (!xmlElement.children && xmlElement.textNode == null) {
        return result + "/>" + LINE_SEPARATOR;
      }
      if (xmlElement.textNode != null) {
        return result + ">" + xmlElement.textNode + "</" + xmlElement.name + ">" + LINE_SEPARATOR;
      }
      result += ">" + LINE_SEPARATOR;
      if (xmlElement.children) {
        xmlElement.children.forEach(function(it) {
          result += _this.createXml(it, booleanTransformer);
        });
      }
      return result + "</" + xmlElement.name + ">" + LINE_SEPARATOR;
    };
    XmlFactory2.returnAttributeIfPopulated = function(key, value, booleanTransformer) {
      if (!value && value !== "" && value !== 0) {
        return "";
      }
      var xmlValue = value;
      if (typeof value === "boolean") {
        if (booleanTransformer) {
          xmlValue = booleanTransformer(value);
        }
      }
      return " " + key + '="' + xmlValue + '"';
    };
    return XmlFactory2;
  }()
);
var __values = function(o) {
  var s2 = typeof Symbol === "function" && Symbol.iterator, m2 = s2 && o[s2], i = 0;
  if (m2)
    return m2.call(o);
  if (o && typeof o.length === "number")
    return {
      next: function() {
        if (o && i >= o.length)
          o = void 0;
        return { value: o && o[i++], done: !o };
      }
    };
  throw new TypeError(s2 ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var crcTable = new Uint32Array([
  0,
  1996959894,
  3993919788,
  2567524794,
  124634137,
  1886057615,
  3915621685,
  2657392035,
  249268274,
  2044508324,
  3772115230,
  2547177864,
  162941995,
  2125561021,
  3887607047,
  2428444049,
  498536548,
  1789927666,
  4089016648,
  2227061214,
  450548861,
  1843258603,
  4107580753,
  2211677639,
  325883990,
  1684777152,
  4251122042,
  2321926636,
  335633487,
  1661365465,
  4195302755,
  2366115317,
  997073096,
  1281953886,
  3579855332,
  2724688242,
  1006888145,
  1258607687,
  3524101629,
  2768942443,
  901097722,
  1119000684,
  3686517206,
  2898065728,
  853044451,
  1172266101,
  3705015759,
  2882616665,
  651767980,
  1373503546,
  3369554304,
  3218104598,
  565507253,
  1454621731,
  3485111705,
  3099436303,
  671266974,
  1594198024,
  3322730930,
  2970347812,
  795835527,
  1483230225,
  3244367275,
  3060149565,
  1994146192,
  31158534,
  2563907772,
  4023717930,
  1907459465,
  112637215,
  2680153253,
  3904427059,
  2013776290,
  251722036,
  2517215374,
  3775830040,
  2137656763,
  141376813,
  2439277719,
  3865271297,
  1802195444,
  476864866,
  2238001368,
  4066508878,
  1812370925,
  453092731,
  2181625025,
  4111451223,
  1706088902,
  314042704,
  2344532202,
  4240017532,
  1658658271,
  366619977,
  2362670323,
  4224994405,
  1303535960,
  984961486,
  2747007092,
  3569037538,
  1256170817,
  1037604311,
  2765210733,
  3554079995,
  1131014506,
  879679996,
  2909243462,
  3663771856,
  1141124467,
  855842277,
  2852801631,
  3708648649,
  1342533948,
  654459306,
  3188396048,
  3373015174,
  1466479909,
  544179635,
  3110523913,
  3462522015,
  1591671054,
  702138776,
  2966460450,
  3352799412,
  1504918807,
  783551873,
  3082640443,
  3233442989,
  3988292384,
  2596254646,
  62317068,
  1957810842,
  3939845945,
  2647816111,
  81470997,
  1943803523,
  3814918930,
  2489596804,
  225274430,
  2053790376,
  3826175755,
  2466906013,
  167816743,
  2097651377,
  4027552580,
  2265490386,
  503444072,
  1762050814,
  4150417245,
  2154129355,
  426522225,
  1852507879,
  4275313526,
  2312317920,
  282753626,
  1742555852,
  4189708143,
  2394877945,
  397917763,
  1622183637,
  3604390888,
  2714866558,
  953729732,
  1340076626,
  3518719985,
  2797360999,
  1068828381,
  1219638859,
  3624741850,
  2936675148,
  906185462,
  1090812512,
  3747672003,
  2825379669,
  829329135,
  1181335161,
  3412177804,
  3160834842,
  628085408,
  1382605366,
  3423369109,
  3138078467,
  570562233,
  1426400815,
  3317316542,
  2998733608,
  733239954,
  1555261956,
  3268935591,
  3050360625,
  752459403,
  1541320221,
  2607071920,
  3965973030,
  1969922972,
  40735498,
  2617837225,
  3943577151,
  1913087877,
  83908371,
  2512341634,
  3803740692,
  2075208622,
  213261112,
  2463272603,
  3855990285,
  2094854071,
  198958881,
  2262029012,
  4057260610,
  1759359992,
  534414190,
  2176718541,
  4139329115,
  1873836001,
  414664567,
  2282248934,
  4279200368,
  1711684554,
  285281116,
  2405801727,
  4167216745,
  1634467795,
  376229701,
  2685067896,
  3608007406,
  1308918612,
  956543938,
  2808555105,
  3495958263,
  1231636301,
  1047427035,
  2932959818,
  3654703836,
  1088359270,
  936918e3,
  2847714899,
  3736837829,
  1202900863,
  817233897,
  3183342108,
  3401237130,
  1404277552,
  615818150,
  3134207493,
  3453421203,
  1423857449,
  601450431,
  3009837614,
  3294710456,
  1567103746,
  711928724,
  3020668471,
  3272380065,
  1510334235,
  755167117
]);
var ZipContainer = (
  /** @class */
  function() {
    function ZipContainer2() {
    }
    ZipContainer2.addFolders = function(paths) {
      paths.forEach(this.addFolder.bind(this));
    };
    ZipContainer2.addFolder = function(path) {
      this.folders.push({
        path,
        created: /* @__PURE__ */ new Date(),
        isBase64: false
      });
    };
    ZipContainer2.addFile = function(path, content, isBase64) {
      if (isBase64 === void 0) {
        isBase64 = false;
      }
      this.files.push({
        path,
        created: /* @__PURE__ */ new Date(),
        content,
        isBase64
      });
    };
    ZipContainer2.getContent = function(mimeType) {
      if (mimeType === void 0) {
        mimeType = "application/zip";
      }
      var textOutput = this.buildFileStream();
      var uInt8Output = this.buildUint8Array(textOutput);
      this.clearStream();
      return new Blob([uInt8Output], { type: mimeType });
    };
    ZipContainer2.clearStream = function() {
      this.folders = [];
      this.files = [];
    };
    ZipContainer2.buildFileStream = function(fData) {
      var e_1, _a2;
      if (fData === void 0) {
        fData = "";
      }
      var totalFiles = this.folders.concat(this.files);
      var len = totalFiles.length;
      var foData = "";
      var lL = 0;
      var cL = 0;
      try {
        for (var totalFiles_1 = __values(totalFiles), totalFiles_1_1 = totalFiles_1.next(); !totalFiles_1_1.done; totalFiles_1_1 = totalFiles_1.next()) {
          var currentFile = totalFiles_1_1.value;
          var _b2 = this.getHeader(currentFile, lL), fileHeader = _b2.fileHeader, folderHeader = _b2.folderHeader, content = _b2.content;
          lL += fileHeader.length + content.length;
          cL += folderHeader.length;
          fData += fileHeader + content;
          foData += folderHeader;
        }
      } catch (e_1_1) {
        e_1 = { error: e_1_1 };
      } finally {
        try {
          if (totalFiles_1_1 && !totalFiles_1_1.done && (_a2 = totalFiles_1.return))
            _a2.call(totalFiles_1);
        } finally {
          if (e_1)
            throw e_1.error;
        }
      }
      var foEnd = this.buildFolderEnd(len, cL, lL);
      return fData + foData + foEnd;
    };
    ZipContainer2.getHeader = function(currentFile, offset2) {
      var content = currentFile.content, path = currentFile.path, created = currentFile.created, isBase64 = currentFile.isBase64;
      var utf8_encode2 = _.utf8_encode, decToHex2 = _.decToHex;
      var utfPath = utf8_encode2(path);
      var isUTF8 = utfPath !== path;
      var time = this.convertTime(created);
      var dt = this.convertDate(created);
      var extraFields = "";
      if (isUTF8) {
        var uExtraFieldPath = decToHex2(1, 1) + decToHex2(this.getFromCrc32Table(utfPath), 4) + utfPath;
        extraFields = "up" + decToHex2(uExtraFieldPath.length, 2) + uExtraFieldPath;
      }
      var _a2 = !content ? { size: 0, content: "" } : this.getConvertedContent(content, isBase64), size = _a2.size, convertedContent = _a2.content;
      var header = "\n\0" + (isUTF8 ? "\0\b" : "\0\0") + "\0\0" + decToHex2(time, 2) + // last modified time
      decToHex2(dt, 2) + // last modified date
      decToHex2(size ? this.getFromCrc32Table(convertedContent) : 0, 4) + decToHex2(size, 4) + // compressed size
      decToHex2(size, 4) + // uncompressed size
      decToHex2(utfPath.length, 2) + // file name length
      decToHex2(extraFields.length, 2);
      var fileHeader = "PK" + header + utfPath + extraFields;
      var folderHeader = "PK\0" + header + // file header
      "\0\0\0\0\0\0" + (content ? "\0\0\0\0" : "\0\0\0") + // external file attributes
      decToHex2(offset2, 4) + // relative offset of local header
      utfPath + // file name
      extraFields;
      return { fileHeader, folderHeader, content: convertedContent || "" };
    };
    ZipContainer2.getConvertedContent = function(content, isBase64) {
      if (isBase64 === void 0) {
        isBase64 = false;
      }
      if (isBase64) {
        content = content.split(";base64,")[1];
      }
      content = isBase64 ? atob(content) : content;
      return {
        size: content.length,
        content
      };
    };
    ZipContainer2.buildFolderEnd = function(tLen, cLen, lLen) {
      var decToHex2 = _.decToHex;
      return "PK\0\0\0\0" + decToHex2(tLen, 2) + // total number of entries in the central folder
      decToHex2(tLen, 2) + // total number of entries in the central folder
      decToHex2(cLen, 4) + // size of the central folder
      decToHex2(lLen, 4) + // central folder start offset
      "\0\0";
    };
    ZipContainer2.buildUint8Array = function(content) {
      var uint8 = new Uint8Array(content.length);
      for (var i = 0; i < uint8.length; i++) {
        uint8[i] = content.charCodeAt(i);
      }
      return uint8;
    };
    ZipContainer2.getFromCrc32Table = function(content) {
      if (!content.length) {
        return 0;
      }
      var size = content.length;
      var iterable = new Uint8Array(size);
      for (var i = 0; i < size; i++) {
        iterable[i] = content.charCodeAt(i);
      }
      var crc = 0 ^ -1;
      var j = 0;
      var k2 = 0;
      var l2 = 0;
      for (var i = 0; i < size; i++) {
        j = iterable[i];
        k2 = (crc ^ j) & 255;
        l2 = crcTable[k2];
        crc = crc >>> 8 ^ l2;
      }
      return crc ^ -1;
    };
    ZipContainer2.convertTime = function(date) {
      var time = date.getHours();
      time <<= 6;
      time = time | date.getMinutes();
      time <<= 5;
      time = time | date.getSeconds() / 2;
      return time;
    };
    ZipContainer2.convertDate = function(date) {
      var dt = date.getFullYear() - 1980;
      dt <<= 4;
      dt = dt | date.getMonth() + 1;
      dt <<= 5;
      dt = dt | date.getDate();
      return dt;
    };
    ZipContainer2.folders = [];
    ZipContainer2.files = [];
    return ZipContainer2;
  }()
);
var AllCommunityModules = [ClientSideRowModelModule, InfiniteRowModelModule, CsvExportModule];
ModuleRegistry.registerModules(AllCommunityModules);
const agGridCommunity_auto_esm = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  AbstractHeaderCellCtrl,
  AgAbstractField,
  AgAbstractLabel,
  AgCheckbox,
  AgDialog,
  AgGroupComponent,
  AgInputDateField,
  AgInputNumberField,
  AgInputRange,
  AgInputTextArea,
  AgInputTextField,
  AgMenuItemComponent,
  AgMenuList,
  AgMenuPanel,
  AgPanel,
  AgPickerField,
  AgPromise,
  get AgPromiseStatus() {
    return AgPromiseStatus;
  },
  AgRadioButton,
  AgSelect,
  AgSlider,
  AgStackComponentsRegistry,
  AgToggleButton,
  AlignedGridsService,
  AllCommunityModules,
  AnimateShowChangeCellRenderer,
  AnimateSlideCellRenderer,
  AnimationFrameService,
  AutoScrollService,
  AutoWidthCalculator,
  Autowired,
  get BarColumnLabelPlacement() {
    return BarColumnLabelPlacement;
  },
  BaseComponentWrapper,
  BaseCreator,
  BaseGridSerializingSession,
  Bean,
  BeanStub,
  Beans,
  BodyDropPivotTarget,
  BodyDropTarget,
  CHART_TOOLBAR_ALLOW_LIST,
  CHART_TOOL_PANEL_ALLOW_LIST,
  CHART_TOOL_PANEL_MENU_OPTIONS,
  CellComp,
  CellCtrl,
  CellNavigationService,
  CellPositionUtils,
  get CellRangeType() {
    return CellRangeType;
  },
  ChangedPath,
  CheckboxCellEditor,
  CheckboxCellRenderer,
  CheckboxSelectionComponent,
  ClientSideRowModelModule,
  get ClientSideRowModelSteps() {
    return ClientSideRowModelSteps;
  },
  ColDefUtil,
  Column,
  ColumnApi,
  ColumnFactory,
  ColumnGroup,
  ColumnKeyCreator,
  ColumnModel,
  ColumnUtils,
  Component,
  ComponentUtil,
  Context,
  CssClassApplier,
  CssClassManager,
  CsvCreator,
  CsvExportModule,
  CtrlsService,
  CustomTooltipFeature,
  DEFAULT_CHART_GROUPS,
  DateCellEditor,
  DateFilter,
  DateStringCellEditor,
  DisplayedGroupCreator,
  Downloader,
  DragAndDropService,
  DragService,
  get DragSourceType() {
    return DragSourceType;
  },
  Environment,
  EventService,
  Events,
  get ExcelFactoryMode() {
    return ExcelFactoryMode;
  },
  ExpressionService,
  FilterManager,
  FloatingFilterMapper,
  FocusService,
  GROUP_AUTO_COLUMN_ID,
  Grid,
  GridApi,
  GridBodyComp: GridBodyComp$1,
  GridBodyCtrl,
  GridComp: GridComp$1,
  GridCoreCreator,
  GridCtrl,
  GridHeaderComp: GridHeaderComp$1,
  GridHeaderCtrl,
  GridOptionsService,
  GridSerializer,
  GroupCellRenderer: GroupCellRenderer$1,
  GroupCellRendererCtrl,
  GroupInstanceIdCreator,
  HeaderCellCtrl,
  HeaderFilterCellComp: HeaderFilterCellComp$1,
  HeaderFilterCellCtrl,
  HeaderGroupCellCtrl,
  get HeaderNavigationDirection() {
    return HeaderNavigationDirection;
  },
  HeaderNavigationService,
  HeaderPositionUtils,
  HeaderRowComp: HeaderRowComp$1,
  HeaderRowContainerComp: HeaderRowContainerComp$1,
  HeaderRowContainerCtrl,
  HeaderRowCtrl,
  get HeaderRowType() {
    return HeaderRowType;
  },
  get HorizontalDirection() {
    return HorizontalDirection;
  },
  HorizontalResizeService,
  InfiniteRowModelModule,
  KeyCode,
  LargeTextCellEditor,
  get LayoutCssClasses() {
    return LayoutCssClasses;
  },
  LocaleService,
  Logger,
  LoggerFactory,
  ManagedFocusFeature,
  get ModuleNames() {
    return ModuleNames;
  },
  ModuleRegistry,
  MouseEventService,
  MoveColumnFeature,
  NavigationService,
  NumberCellEditor,
  NumberFilter,
  NumberSequence,
  Optional,
  PaginationProxy,
  PinnedRowModel,
  PopupComponent,
  PopupEditorWrapper,
  PopupService,
  PositionableFeature,
  PostConstruct,
  PreConstruct,
  PreDestroy,
  PropertyKeys,
  ProvidedColumnGroup,
  ProvidedFilter,
  Qualifier,
  QuerySelector,
  RefSelector,
  ResizeObserverService,
  get RowAnimationCssClasses() {
    return RowAnimationCssClasses;
  },
  RowContainerComp: RowContainerComp$1,
  RowContainerCtrl,
  get RowContainerName() {
    return RowContainerName;
  },
  get RowContainerType() {
    return RowContainerType;
  },
  RowCtrl,
  get RowHighlightPosition() {
    return RowHighlightPosition;
  },
  RowNode: RowNode2,
  RowNodeBlock,
  RowNodeBlockLoader,
  RowNodeSorter,
  RowPositionUtils,
  RowRenderer,
  get RowType() {
    return RowType;
  },
  ScalarFilter,
  ScrollVisibleService,
  SelectCellEditor,
  SelectableService,
  get SelectionHandleType() {
    return SelectionHandleType;
  },
  get ServerSideTransactionResultStatus() {
    return ServerSideTransactionResultStatus;
  },
  SetLeftFeature,
  SimpleFilter,
  SortController,
  SortIndicatorComp,
  StandardMenuFactory,
  StylingService,
  get TabGuardClassNames() {
    return TabGuardClassNames;
  },
  TabGuardComp: TabGuardComp$1,
  TabGuardCtrl,
  TabbedLayout,
  TemplateService,
  TextCellEditor,
  TextFilter,
  TextFloatingFilter,
  Timer,
  TouchListener,
  UserComponentFactory,
  UserComponentRegistry,
  ValueCache,
  ValueFormatterService,
  ValueParserService,
  ValueService,
  VanillaFrameworkOverrides,
  get VerticalDirection() {
    return VerticalDirection;
  },
  VirtualList,
  XmlFactory,
  ZipContainer,
  _,
  __FORCE_MODULE_DETECTION,
  getRowContainerTypeForName,
  simpleHttpRequest
}, Symbol.toStringTag, { value: "Module" }));
const require$$0 = /* @__PURE__ */ getAugmentedNamespace(agGridCommunity_auto_esm);
var propTypes = { exports: {} };
var ReactPropTypesSecret$1 = "SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";
var ReactPropTypesSecret_1 = ReactPropTypesSecret$1;
var ReactPropTypesSecret = ReactPropTypesSecret_1;
function emptyFunction() {
}
function emptyFunctionWithReset() {
}
emptyFunctionWithReset.resetWarningCache = emptyFunction;
var factoryWithThrowingShims = function() {
  function shim(props, propName, componentName, location, propFullName, secret) {
    if (secret === ReactPropTypesSecret) {
      return;
    }
    var err = new Error(
      "Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types"
    );
    err.name = "Invariant Violation";
    throw err;
  }
  shim.isRequired = shim;
  function getShim() {
    return shim;
  }
  var ReactPropTypes = {
    array: shim,
    bigint: shim,
    bool: shim,
    func: shim,
    number: shim,
    object: shim,
    string: shim,
    symbol: shim,
    any: shim,
    arrayOf: getShim,
    element: shim,
    elementType: shim,
    instanceOf: getShim,
    node: shim,
    objectOf: getShim,
    oneOf: getShim,
    oneOfType: getShim,
    shape: getShim,
    exact: getShim,
    checkPropTypes: emptyFunctionWithReset,
    resetWarningCache: emptyFunction
  };
  ReactPropTypes.PropTypes = ReactPropTypes;
  return ReactPropTypes;
};
{
  propTypes.exports = factoryWithThrowingShims();
}
var propTypesExports = propTypes.exports;
var legacyReactComponent = {};
var reactComponent = {};
var __extends$4 = commonjsGlobal && commonjsGlobal.__extends || function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
Object.defineProperty(reactComponent, "__esModule", { value: true });
reactComponent.ReactComponent = void 0;
var BaseReactComponent = (
  /** @class */
  function() {
    function BaseReactComponent2() {
    }
    return BaseReactComponent2;
  }()
);
var ReactComponent = (
  /** @class */
  function(_super) {
    __extends$4(ReactComponent2, _super);
    function ReactComponent2(reactComponent2, portalManager2, componentType) {
      var _this = _super.call(this) || this;
      _this.portal = null;
      _this.reactComponent = reactComponent2;
      _this.portalManager = portalManager2;
      _this.componentType = componentType;
      _this.statelessComponent = _this.isStateless(_this.reactComponent);
      return _this;
    }
    ReactComponent2.prototype.getGui = function() {
      return this.eParentElement;
    };
    ReactComponent2.prototype.destroy = function() {
      if (this.componentInstance && typeof this.componentInstance.destroy == "function") {
        this.componentInstance.destroy();
      }
      return this.portalManager.destroyPortal(this.portal);
    };
    ReactComponent2.prototype.createParentElement = function(params) {
      var componentWrappingElement = this.portalManager.getComponentWrappingElement();
      var eParentElement = document.createElement(componentWrappingElement || "div");
      eParentElement.classList.add("ag-react-container");
      params.reactContainer = eParentElement;
      return eParentElement;
    };
    ReactComponent2.prototype.addParentContainerStyleAndClasses = function() {
      var _this = this;
      if (!this.componentInstance) {
        return;
      }
      if (this.componentInstance.getReactContainerStyle && this.componentInstance.getReactContainerStyle()) {
        Object.assign(this.eParentElement.style, this.componentInstance.getReactContainerStyle());
      }
      if (this.componentInstance.getReactContainerClasses && this.componentInstance.getReactContainerClasses()) {
        var parentContainerClasses = this.componentInstance.getReactContainerClasses();
        parentContainerClasses.forEach(function(className) {
          return _this.eParentElement.classList.add(className);
        });
      }
    };
    ReactComponent2.prototype.statelessComponentRendered = function() {
      return this.eParentElement.childElementCount > 0 || this.eParentElement.childNodes.length > 0;
    };
    ReactComponent2.prototype.getFrameworkComponentInstance = function() {
      return this.componentInstance;
    };
    ReactComponent2.prototype.isStatelessComponent = function() {
      return this.statelessComponent;
    };
    ReactComponent2.prototype.getReactComponentName = function() {
      return this.reactComponent.name;
    };
    ReactComponent2.prototype.getMemoType = function() {
      return this.hasSymbol() ? Symbol.for("react.memo") : 60115;
    };
    ReactComponent2.prototype.hasSymbol = function() {
      return typeof Symbol === "function" && Symbol.for;
    };
    ReactComponent2.prototype.isStateless = function(Component2) {
      return typeof Component2 === "function" && !(Component2.prototype && Component2.prototype.isReactComponent) || typeof Component2 === "object" && Component2.$$typeof === this.getMemoType();
    };
    ReactComponent2.prototype.hasMethod = function(name) {
      var frameworkComponentInstance = this.getFrameworkComponentInstance();
      return !!frameworkComponentInstance && frameworkComponentInstance[name] !== null || this.fallbackMethodAvailable(name);
    };
    ReactComponent2.prototype.callMethod = function(name, args) {
      var _this = this;
      var frameworkComponentInstance = this.getFrameworkComponentInstance();
      if (this.isStatelessComponent()) {
        return this.fallbackMethod(name, !!args && args[0] ? args[0] : {});
      } else if (!!!frameworkComponentInstance) {
        setTimeout(function() {
          return _this.callMethod(name, args);
        });
        return;
      }
      var method = frameworkComponentInstance[name];
      if (!!method) {
        return method.apply(frameworkComponentInstance, args);
      }
      if (this.fallbackMethodAvailable(name)) {
        return this.fallbackMethod(name, !!args && args[0] ? args[0] : {});
      }
    };
    ReactComponent2.prototype.addMethod = function(name, callback2) {
      this[name] = callback2;
    };
    return ReactComponent2;
  }(BaseReactComponent)
);
reactComponent.ReactComponent = ReactComponent;
var server_browser = {};
var reactDomServerLegacy_browser_production_min = {};
/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var aa$1 = reactExports;
function l$2(a) {
  for (var b = "https://reactjs.org/docs/error-decoder.html?invariant=" + a, c = 1; c < arguments.length; c++)
    b += "&args[]=" + encodeURIComponent(arguments[c]);
  return "Minified React error #" + a + "; visit " + b + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
}
var p$1 = Object.prototype.hasOwnProperty, fa$1 = /^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/, ha$1 = {}, ia$1 = {};
function ja$1(a) {
  if (p$1.call(ia$1, a))
    return true;
  if (p$1.call(ha$1, a))
    return false;
  if (fa$1.test(a))
    return ia$1[a] = true;
  ha$1[a] = true;
  return false;
}
function r(a, b, c, d, f2, e, g) {
  this.acceptsBooleans = 2 === b || 3 === b || 4 === b;
  this.attributeName = d;
  this.attributeNamespace = f2;
  this.mustUseProperty = c;
  this.propertyName = a;
  this.type = b;
  this.sanitizeURL = e;
  this.removeEmptyString = g;
}
var t$1 = {};
"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a) {
  t$1[a] = new r(a, 0, false, a, null, false, false);
});
[["acceptCharset", "accept-charset"], ["className", "class"], ["htmlFor", "for"], ["httpEquiv", "http-equiv"]].forEach(function(a) {
  var b = a[0];
  t$1[b] = new r(b, 1, false, a[1], null, false, false);
});
["contentEditable", "draggable", "spellCheck", "value"].forEach(function(a) {
  t$1[a] = new r(a, 2, false, a.toLowerCase(), null, false, false);
});
["autoReverse", "externalResourcesRequired", "focusable", "preserveAlpha"].forEach(function(a) {
  t$1[a] = new r(a, 2, false, a, null, false, false);
});
"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a) {
  t$1[a] = new r(a, 3, false, a.toLowerCase(), null, false, false);
});
["checked", "multiple", "muted", "selected"].forEach(function(a) {
  t$1[a] = new r(a, 3, true, a, null, false, false);
});
["capture", "download"].forEach(function(a) {
  t$1[a] = new r(a, 4, false, a, null, false, false);
});
["cols", "rows", "size", "span"].forEach(function(a) {
  t$1[a] = new r(a, 6, false, a, null, false, false);
});
["rowSpan", "start"].forEach(function(a) {
  t$1[a] = new r(a, 5, false, a.toLowerCase(), null, false, false);
});
var ka$1 = /[\-:]([a-z])/g;
function la$1(a) {
  return a[1].toUpperCase();
}
"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a) {
  var b = a.replace(
    ka$1,
    la$1
  );
  t$1[b] = new r(b, 1, false, a, null, false, false);
});
"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a) {
  var b = a.replace(ka$1, la$1);
  t$1[b] = new r(b, 1, false, a, "http://www.w3.org/1999/xlink", false, false);
});
["xml:base", "xml:lang", "xml:space"].forEach(function(a) {
  var b = a.replace(ka$1, la$1);
  t$1[b] = new r(b, 1, false, a, "http://www.w3.org/XML/1998/namespace", false, false);
});
["tabIndex", "crossOrigin"].forEach(function(a) {
  t$1[a] = new r(a, 1, false, a.toLowerCase(), null, false, false);
});
t$1.xlinkHref = new r("xlinkHref", 1, false, "xlink:href", "http://www.w3.org/1999/xlink", true, false);
["src", "href", "action", "formAction"].forEach(function(a) {
  t$1[a] = new r(a, 1, false, a.toLowerCase(), null, true, true);
});
var u$1 = {
  animationIterationCount: true,
  aspectRatio: true,
  borderImageOutset: true,
  borderImageSlice: true,
  borderImageWidth: true,
  boxFlex: true,
  boxFlexGroup: true,
  boxOrdinalGroup: true,
  columnCount: true,
  columns: true,
  flex: true,
  flexGrow: true,
  flexPositive: true,
  flexShrink: true,
  flexNegative: true,
  flexOrder: true,
  gridArea: true,
  gridRow: true,
  gridRowEnd: true,
  gridRowSpan: true,
  gridRowStart: true,
  gridColumn: true,
  gridColumnEnd: true,
  gridColumnSpan: true,
  gridColumnStart: true,
  fontWeight: true,
  lineClamp: true,
  lineHeight: true,
  opacity: true,
  order: true,
  orphans: true,
  tabSize: true,
  widows: true,
  zIndex: true,
  zoom: true,
  fillOpacity: true,
  floodOpacity: true,
  stopOpacity: true,
  strokeDasharray: true,
  strokeDashoffset: true,
  strokeMiterlimit: true,
  strokeOpacity: true,
  strokeWidth: true
}, ma = ["Webkit", "ms", "Moz", "O"];
Object.keys(u$1).forEach(function(a) {
  ma.forEach(function(b) {
    b = b + a.charAt(0).toUpperCase() + a.substring(1);
    u$1[b] = u$1[a];
  });
});
var na = /["'&<>]/;
function v(a) {
  if ("boolean" === typeof a || "number" === typeof a)
    return "" + a;
  a = "" + a;
  var b = na.exec(a);
  if (b) {
    var c = "", d, f2 = 0;
    for (d = b.index; d < a.length; d++) {
      switch (a.charCodeAt(d)) {
        case 34:
          b = "&quot;";
          break;
        case 38:
          b = "&amp;";
          break;
        case 39:
          b = "&#x27;";
          break;
        case 60:
          b = "&lt;";
          break;
        case 62:
          b = "&gt;";
          break;
        default:
          continue;
      }
      f2 !== d && (c += a.substring(f2, d));
      f2 = d + 1;
      c += b;
    }
    a = f2 !== d ? c + a.substring(f2, d) : c;
  }
  return a;
}
var oa$1 = /([A-Z])/g, pa$1 = /^ms-/, qa$1 = Array.isArray;
function w$1(a, b) {
  return { insertionMode: a, selectedValue: b };
}
function ra$1(a, b, c) {
  switch (b) {
    case "select":
      return w$1(1, null != c.value ? c.value : c.defaultValue);
    case "svg":
      return w$1(2, null);
    case "math":
      return w$1(3, null);
    case "foreignObject":
      return w$1(1, null);
    case "table":
      return w$1(4, null);
    case "thead":
    case "tbody":
    case "tfoot":
      return w$1(5, null);
    case "colgroup":
      return w$1(7, null);
    case "tr":
      return w$1(6, null);
  }
  return 4 <= a.insertionMode || 0 === a.insertionMode ? w$1(1, null) : a;
}
var sa$1 = /* @__PURE__ */ new Map();
function ta$1(a, b, c) {
  if ("object" !== typeof c)
    throw Error(l$2(62));
  b = true;
  for (var d in c)
    if (p$1.call(c, d)) {
      var f2 = c[d];
      if (null != f2 && "boolean" !== typeof f2 && "" !== f2) {
        if (0 === d.indexOf("--")) {
          var e = v(d);
          f2 = v(("" + f2).trim());
        } else {
          e = d;
          var g = sa$1.get(e);
          void 0 !== g ? e = g : (g = v(e.replace(oa$1, "-$1").toLowerCase().replace(pa$1, "-ms-")), sa$1.set(e, g), e = g);
          f2 = "number" === typeof f2 ? 0 === f2 || p$1.call(u$1, d) ? "" + f2 : f2 + "px" : v(("" + f2).trim());
        }
        b ? (b = false, a.push(' style="', e, ":", f2)) : a.push(";", e, ":", f2);
      }
    }
  b || a.push('"');
}
function x$1(a, b, c, d) {
  switch (c) {
    case "style":
      ta$1(a, b, d);
      return;
    case "defaultValue":
    case "defaultChecked":
    case "innerHTML":
    case "suppressContentEditableWarning":
    case "suppressHydrationWarning":
      return;
  }
  if (!(2 < c.length) || "o" !== c[0] && "O" !== c[0] || "n" !== c[1] && "N" !== c[1]) {
    if (b = t$1.hasOwnProperty(c) ? t$1[c] : null, null !== b) {
      switch (typeof d) {
        case "function":
        case "symbol":
          return;
        case "boolean":
          if (!b.acceptsBooleans)
            return;
      }
      c = b.attributeName;
      switch (b.type) {
        case 3:
          d && a.push(" ", c, '=""');
          break;
        case 4:
          true === d ? a.push(" ", c, '=""') : false !== d && a.push(" ", c, '="', v(d), '"');
          break;
        case 5:
          isNaN(d) || a.push(" ", c, '="', v(d), '"');
          break;
        case 6:
          !isNaN(d) && 1 <= d && a.push(" ", c, '="', v(d), '"');
          break;
        default:
          b.sanitizeURL && (d = "" + d), a.push(" ", c, '="', v(d), '"');
      }
    } else if (ja$1(c)) {
      switch (typeof d) {
        case "function":
        case "symbol":
          return;
        case "boolean":
          if (b = c.toLowerCase().slice(0, 5), "data-" !== b && "aria-" !== b)
            return;
      }
      a.push(" ", c, '="', v(d), '"');
    }
  }
}
function y$1(a, b, c) {
  if (null != b) {
    if (null != c)
      throw Error(l$2(60));
    if ("object" !== typeof b || !("__html" in b))
      throw Error(l$2(61));
    b = b.__html;
    null !== b && void 0 !== b && a.push("" + b);
  }
}
function ua$1(a) {
  var b = "";
  aa$1.Children.forEach(a, function(a2) {
    null != a2 && (b += a2);
  });
  return b;
}
function va$1(a, b, c, d) {
  a.push(A(c));
  var f2 = c = null, e;
  for (e in b)
    if (p$1.call(b, e)) {
      var g = b[e];
      if (null != g)
        switch (e) {
          case "children":
            c = g;
            break;
          case "dangerouslySetInnerHTML":
            f2 = g;
            break;
          default:
            x$1(a, d, e, g);
        }
    }
  a.push(">");
  y$1(a, f2, c);
  return "string" === typeof c ? (a.push(v(c)), null) : c;
}
var wa$1 = /^[a-zA-Z][a-zA-Z:_\.\-\d]*$/, xa$1 = /* @__PURE__ */ new Map();
function A(a) {
  var b = xa$1.get(a);
  if (void 0 === b) {
    if (!wa$1.test(a))
      throw Error(l$2(65, a));
    b = "<" + a;
    xa$1.set(a, b);
  }
  return b;
}
function ya$1(a, b, c, d, f2) {
  switch (b) {
    case "select":
      a.push(A("select"));
      var e = null, g = null;
      for (n2 in c)
        if (p$1.call(c, n2)) {
          var h = c[n2];
          if (null != h)
            switch (n2) {
              case "children":
                e = h;
                break;
              case "dangerouslySetInnerHTML":
                g = h;
                break;
              case "defaultValue":
              case "value":
                break;
              default:
                x$1(a, d, n2, h);
            }
        }
      a.push(">");
      y$1(a, g, e);
      return e;
    case "option":
      g = f2.selectedValue;
      a.push(A("option"));
      var k2 = h = null, m2 = null;
      var n2 = null;
      for (e in c)
        if (p$1.call(c, e)) {
          var q2 = c[e];
          if (null != q2)
            switch (e) {
              case "children":
                h = q2;
                break;
              case "selected":
                m2 = q2;
                break;
              case "dangerouslySetInnerHTML":
                n2 = q2;
                break;
              case "value":
                k2 = q2;
              default:
                x$1(a, d, e, q2);
            }
        }
      if (null != g)
        if (c = null !== k2 ? "" + k2 : ua$1(h), qa$1(g))
          for (d = 0; d < g.length; d++) {
            if ("" + g[d] === c) {
              a.push(' selected=""');
              break;
            }
          }
        else
          "" + g === c && a.push(' selected=""');
      else
        m2 && a.push(' selected=""');
      a.push(">");
      y$1(a, n2, h);
      return h;
    case "textarea":
      a.push(A("textarea"));
      n2 = g = e = null;
      for (h in c)
        if (p$1.call(c, h) && (k2 = c[h], null != k2))
          switch (h) {
            case "children":
              n2 = k2;
              break;
            case "value":
              e = k2;
              break;
            case "defaultValue":
              g = k2;
              break;
            case "dangerouslySetInnerHTML":
              throw Error(l$2(91));
            default:
              x$1(
                a,
                d,
                h,
                k2
              );
          }
      null === e && null !== g && (e = g);
      a.push(">");
      if (null != n2) {
        if (null != e)
          throw Error(l$2(92));
        if (qa$1(n2) && 1 < n2.length)
          throw Error(l$2(93));
        e = "" + n2;
      }
      "string" === typeof e && "\n" === e[0] && a.push("\n");
      null !== e && a.push(v("" + e));
      return null;
    case "input":
      a.push(A("input"));
      k2 = n2 = h = e = null;
      for (g in c)
        if (p$1.call(c, g) && (m2 = c[g], null != m2))
          switch (g) {
            case "children":
            case "dangerouslySetInnerHTML":
              throw Error(l$2(399, "input"));
            case "defaultChecked":
              k2 = m2;
              break;
            case "defaultValue":
              h = m2;
              break;
            case "checked":
              n2 = m2;
              break;
            case "value":
              e = m2;
              break;
            default:
              x$1(a, d, g, m2);
          }
      null !== n2 ? x$1(a, d, "checked", n2) : null !== k2 && x$1(a, d, "checked", k2);
      null !== e ? x$1(a, d, "value", e) : null !== h && x$1(a, d, "value", h);
      a.push("/>");
      return null;
    case "menuitem":
      a.push(A("menuitem"));
      for (var C2 in c)
        if (p$1.call(c, C2) && (e = c[C2], null != e))
          switch (C2) {
            case "children":
            case "dangerouslySetInnerHTML":
              throw Error(l$2(400));
            default:
              x$1(a, d, C2, e);
          }
      a.push(">");
      return null;
    case "title":
      a.push(A("title"));
      e = null;
      for (q2 in c)
        if (p$1.call(c, q2) && (g = c[q2], null != g))
          switch (q2) {
            case "children":
              e = g;
              break;
            case "dangerouslySetInnerHTML":
              throw Error(l$2(434));
            default:
              x$1(a, d, q2, g);
          }
      a.push(">");
      return e;
    case "listing":
    case "pre":
      a.push(A(b));
      g = e = null;
      for (k2 in c)
        if (p$1.call(c, k2) && (h = c[k2], null != h))
          switch (k2) {
            case "children":
              e = h;
              break;
            case "dangerouslySetInnerHTML":
              g = h;
              break;
            default:
              x$1(a, d, k2, h);
          }
      a.push(">");
      if (null != g) {
        if (null != e)
          throw Error(l$2(60));
        if ("object" !== typeof g || !("__html" in g))
          throw Error(l$2(61));
        c = g.__html;
        null !== c && void 0 !== c && ("string" === typeof c && 0 < c.length && "\n" === c[0] ? a.push("\n", c) : a.push("" + c));
      }
      "string" === typeof e && "\n" === e[0] && a.push("\n");
      return e;
    case "area":
    case "base":
    case "br":
    case "col":
    case "embed":
    case "hr":
    case "img":
    case "keygen":
    case "link":
    case "meta":
    case "param":
    case "source":
    case "track":
    case "wbr":
      a.push(A(b));
      for (var D2 in c)
        if (p$1.call(c, D2) && (e = c[D2], null != e))
          switch (D2) {
            case "children":
            case "dangerouslySetInnerHTML":
              throw Error(l$2(399, b));
            default:
              x$1(a, d, D2, e);
          }
      a.push("/>");
      return null;
    case "annotation-xml":
    case "color-profile":
    case "font-face":
    case "font-face-src":
    case "font-face-uri":
    case "font-face-format":
    case "font-face-name":
    case "missing-glyph":
      return va$1(
        a,
        c,
        b,
        d
      );
    case "html":
      return 0 === f2.insertionMode && a.push("<!DOCTYPE html>"), va$1(a, c, b, d);
    default:
      if (-1 === b.indexOf("-") && "string" !== typeof c.is)
        return va$1(a, c, b, d);
      a.push(A(b));
      g = e = null;
      for (m2 in c)
        if (p$1.call(c, m2) && (h = c[m2], null != h))
          switch (m2) {
            case "children":
              e = h;
              break;
            case "dangerouslySetInnerHTML":
              g = h;
              break;
            case "style":
              ta$1(a, d, h);
              break;
            case "suppressContentEditableWarning":
            case "suppressHydrationWarning":
              break;
            default:
              ja$1(m2) && "function" !== typeof h && "symbol" !== typeof h && a.push(" ", m2, '="', v(h), '"');
          }
      a.push(">");
      y$1(a, g, e);
      return e;
  }
}
function za$1(a, b, c) {
  a.push('<!--$?--><template id="');
  if (null === c)
    throw Error(l$2(395));
  a.push(c);
  return a.push('"></template>');
}
function Aa$1(a, b, c, d) {
  switch (c.insertionMode) {
    case 0:
    case 1:
      return a.push('<div hidden id="'), a.push(b.segmentPrefix), b = d.toString(16), a.push(b), a.push('">');
    case 2:
      return a.push('<svg aria-hidden="true" style="display:none" id="'), a.push(b.segmentPrefix), b = d.toString(16), a.push(b), a.push('">');
    case 3:
      return a.push('<math aria-hidden="true" style="display:none" id="'), a.push(b.segmentPrefix), b = d.toString(16), a.push(b), a.push('">');
    case 4:
      return a.push('<table hidden id="'), a.push(b.segmentPrefix), b = d.toString(16), a.push(b), a.push('">');
    case 5:
      return a.push('<table hidden><tbody id="'), a.push(b.segmentPrefix), b = d.toString(16), a.push(b), a.push('">');
    case 6:
      return a.push('<table hidden><tr id="'), a.push(b.segmentPrefix), b = d.toString(16), a.push(b), a.push('">');
    case 7:
      return a.push('<table hidden><colgroup id="'), a.push(b.segmentPrefix), b = d.toString(16), a.push(b), a.push('">');
    default:
      throw Error(l$2(397));
  }
}
function Ba$1(a, b) {
  switch (b.insertionMode) {
    case 0:
    case 1:
      return a.push("</div>");
    case 2:
      return a.push("</svg>");
    case 3:
      return a.push("</math>");
    case 4:
      return a.push("</table>");
    case 5:
      return a.push("</tbody></table>");
    case 6:
      return a.push("</tr></table>");
    case 7:
      return a.push("</colgroup></table>");
    default:
      throw Error(l$2(397));
  }
}
var Ca$1 = /[<\u2028\u2029]/g;
function Da$1(a) {
  return JSON.stringify(a).replace(Ca$1, function(a2) {
    switch (a2) {
      case "<":
        return "\\u003c";
      case "\u2028":
        return "\\u2028";
      case "\u2029":
        return "\\u2029";
      default:
        throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React");
    }
  });
}
function Ea$1(a, b) {
  b = void 0 === b ? "" : b;
  return { bootstrapChunks: [], startInlineScript: "<script>", placeholderPrefix: b + "P:", segmentPrefix: b + "S:", boundaryPrefix: b + "B:", idPrefix: b, nextSuspenseID: 0, sentCompleteSegmentFunction: false, sentCompleteBoundaryFunction: false, sentClientRenderFunction: false, generateStaticMarkup: a };
}
function Fa$1(a, b, c, d) {
  if (c.generateStaticMarkup)
    return a.push(v(b)), false;
  "" === b ? a = d : (d && a.push("<!-- -->"), a.push(v(b)), a = true);
  return a;
}
var B$1 = Object.assign, Ga$1 = Symbol.for("react.element"), Ha$1 = Symbol.for("react.portal"), Ia$1 = Symbol.for("react.fragment"), Ja$1 = Symbol.for("react.strict_mode"), Ka$1 = Symbol.for("react.profiler"), La$1 = Symbol.for("react.provider"), Ma$1 = Symbol.for("react.context"), Na$1 = Symbol.for("react.forward_ref"), Oa$1 = Symbol.for("react.suspense"), Pa$1 = Symbol.for("react.suspense_list"), Qa$1 = Symbol.for("react.memo"), Ra$1 = Symbol.for("react.lazy"), Sa$1 = Symbol.for("react.scope"), Ta$1 = Symbol.for("react.debug_trace_mode"), Ua$1 = Symbol.for("react.legacy_hidden"), Va$1 = Symbol.for("react.default_value"), Wa$1 = Symbol.iterator;
function Xa$1(a) {
  if (null == a)
    return null;
  if ("function" === typeof a)
    return a.displayName || a.name || null;
  if ("string" === typeof a)
    return a;
  switch (a) {
    case Ia$1:
      return "Fragment";
    case Ha$1:
      return "Portal";
    case Ka$1:
      return "Profiler";
    case Ja$1:
      return "StrictMode";
    case Oa$1:
      return "Suspense";
    case Pa$1:
      return "SuspenseList";
  }
  if ("object" === typeof a)
    switch (a.$$typeof) {
      case Ma$1:
        return (a.displayName || "Context") + ".Consumer";
      case La$1:
        return (a._context.displayName || "Context") + ".Provider";
      case Na$1:
        var b = a.render;
        a = a.displayName;
        a || (a = b.displayName || b.name || "", a = "" !== a ? "ForwardRef(" + a + ")" : "ForwardRef");
        return a;
      case Qa$1:
        return b = a.displayName || null, null !== b ? b : Xa$1(a.type) || "Memo";
      case Ra$1:
        b = a._payload;
        a = a._init;
        try {
          return Xa$1(a(b));
        } catch (c) {
        }
    }
  return null;
}
var Ya$1 = {};
function Za$1(a, b) {
  a = a.contextTypes;
  if (!a)
    return Ya$1;
  var c = {}, d;
  for (d in a)
    c[d] = b[d];
  return c;
}
var E$1 = null;
function F(a, b) {
  if (a !== b) {
    a.context._currentValue2 = a.parentValue;
    a = a.parent;
    var c = b.parent;
    if (null === a) {
      if (null !== c)
        throw Error(l$2(401));
    } else {
      if (null === c)
        throw Error(l$2(401));
      F(a, c);
    }
    b.context._currentValue2 = b.value;
  }
}
function $a$1(a) {
  a.context._currentValue2 = a.parentValue;
  a = a.parent;
  null !== a && $a$1(a);
}
function ab$1(a) {
  var b = a.parent;
  null !== b && ab$1(b);
  a.context._currentValue2 = a.value;
}
function bb$1(a, b) {
  a.context._currentValue2 = a.parentValue;
  a = a.parent;
  if (null === a)
    throw Error(l$2(402));
  a.depth === b.depth ? F(a, b) : bb$1(a, b);
}
function cb$1(a, b) {
  var c = b.parent;
  if (null === c)
    throw Error(l$2(402));
  a.depth === c.depth ? F(a, c) : cb$1(a, c);
  b.context._currentValue2 = b.value;
}
function G(a) {
  var b = E$1;
  b !== a && (null === b ? ab$1(a) : null === a ? $a$1(b) : b.depth === a.depth ? F(b, a) : b.depth > a.depth ? bb$1(b, a) : cb$1(b, a), E$1 = a);
}
var db$1 = { isMounted: function() {
  return false;
}, enqueueSetState: function(a, b) {
  a = a._reactInternals;
  null !== a.queue && a.queue.push(b);
}, enqueueReplaceState: function(a, b) {
  a = a._reactInternals;
  a.replace = true;
  a.queue = [b];
}, enqueueForceUpdate: function() {
} };
function eb$1(a, b, c, d) {
  var f2 = void 0 !== a.state ? a.state : null;
  a.updater = db$1;
  a.props = c;
  a.state = f2;
  var e = { queue: [], replace: false };
  a._reactInternals = e;
  var g = b.contextType;
  a.context = "object" === typeof g && null !== g ? g._currentValue2 : d;
  g = b.getDerivedStateFromProps;
  "function" === typeof g && (g = g(c, f2), f2 = null === g || void 0 === g ? f2 : B$1({}, f2, g), a.state = f2);
  if ("function" !== typeof b.getDerivedStateFromProps && "function" !== typeof a.getSnapshotBeforeUpdate && ("function" === typeof a.UNSAFE_componentWillMount || "function" === typeof a.componentWillMount))
    if (b = a.state, "function" === typeof a.componentWillMount && a.componentWillMount(), "function" === typeof a.UNSAFE_componentWillMount && a.UNSAFE_componentWillMount(), b !== a.state && db$1.enqueueReplaceState(a, a.state, null), null !== e.queue && 0 < e.queue.length)
      if (b = e.queue, g = e.replace, e.queue = null, e.replace = false, g && 1 === b.length)
        a.state = b[0];
      else {
        e = g ? b[0] : a.state;
        f2 = true;
        for (g = g ? 1 : 0; g < b.length; g++) {
          var h = b[g];
          h = "function" === typeof h ? h.call(a, e, c, d) : h;
          null != h && (f2 ? (f2 = false, e = B$1({}, e, h)) : B$1(e, h));
        }
        a.state = e;
      }
    else
      e.queue = null;
}
var fb$1 = { id: 1, overflow: "" };
function gb$1(a, b, c) {
  var d = a.id;
  a = a.overflow;
  var f2 = 32 - H$1(d) - 1;
  d &= ~(1 << f2);
  c += 1;
  var e = 32 - H$1(b) + f2;
  if (30 < e) {
    var g = f2 - f2 % 5;
    e = (d & (1 << g) - 1).toString(32);
    d >>= g;
    f2 -= g;
    return { id: 1 << 32 - H$1(b) + f2 | c << f2 | d, overflow: e + a };
  }
  return { id: 1 << e | c << f2 | d, overflow: a };
}
var H$1 = Math.clz32 ? Math.clz32 : hb$1, ib$1 = Math.log, jb$1 = Math.LN2;
function hb$1(a) {
  a >>>= 0;
  return 0 === a ? 32 : 31 - (ib$1(a) / jb$1 | 0) | 0;
}
function kb$1(a, b) {
  return a === b && (0 !== a || 1 / a === 1 / b) || a !== a && b !== b;
}
var lb$1 = "function" === typeof Object.is ? Object.is : kb$1, I$1 = null, ob$1 = null, J$1 = null, K$1 = null, L$1 = false, M$1 = false, N$1 = 0, O$1 = null, P$1 = 0;
function Q$1() {
  if (null === I$1)
    throw Error(l$2(321));
  return I$1;
}
function pb$1() {
  if (0 < P$1)
    throw Error(l$2(312));
  return { memoizedState: null, queue: null, next: null };
}
function qb$1() {
  null === K$1 ? null === J$1 ? (L$1 = false, J$1 = K$1 = pb$1()) : (L$1 = true, K$1 = J$1) : null === K$1.next ? (L$1 = false, K$1 = K$1.next = pb$1()) : (L$1 = true, K$1 = K$1.next);
  return K$1;
}
function rb$1() {
  ob$1 = I$1 = null;
  M$1 = false;
  J$1 = null;
  P$1 = 0;
  K$1 = O$1 = null;
}
function sb$1(a, b) {
  return "function" === typeof b ? b(a) : b;
}
function tb$1(a, b, c) {
  I$1 = Q$1();
  K$1 = qb$1();
  if (L$1) {
    var d = K$1.queue;
    b = d.dispatch;
    if (null !== O$1 && (c = O$1.get(d), void 0 !== c)) {
      O$1.delete(d);
      d = K$1.memoizedState;
      do
        d = a(d, c.action), c = c.next;
      while (null !== c);
      K$1.memoizedState = d;
      return [d, b];
    }
    return [K$1.memoizedState, b];
  }
  a = a === sb$1 ? "function" === typeof b ? b() : b : void 0 !== c ? c(b) : b;
  K$1.memoizedState = a;
  a = K$1.queue = { last: null, dispatch: null };
  a = a.dispatch = ub$1.bind(null, I$1, a);
  return [K$1.memoizedState, a];
}
function vb$1(a, b) {
  I$1 = Q$1();
  K$1 = qb$1();
  b = void 0 === b ? null : b;
  if (null !== K$1) {
    var c = K$1.memoizedState;
    if (null !== c && null !== b) {
      var d = c[1];
      a:
        if (null === d)
          d = false;
        else {
          for (var f2 = 0; f2 < d.length && f2 < b.length; f2++)
            if (!lb$1(b[f2], d[f2])) {
              d = false;
              break a;
            }
          d = true;
        }
      if (d)
        return c[0];
    }
  }
  a = a();
  K$1.memoizedState = [a, b];
  return a;
}
function ub$1(a, b, c) {
  if (25 <= P$1)
    throw Error(l$2(301));
  if (a === I$1)
    if (M$1 = true, a = { action: c, next: null }, null === O$1 && (O$1 = /* @__PURE__ */ new Map()), c = O$1.get(b), void 0 === c)
      O$1.set(b, a);
    else {
      for (b = c; null !== b.next; )
        b = b.next;
      b.next = a;
    }
}
function wb$1() {
  throw Error(l$2(394));
}
function R$1() {
}
var xb$1 = { readContext: function(a) {
  return a._currentValue2;
}, useContext: function(a) {
  Q$1();
  return a._currentValue2;
}, useMemo: vb$1, useReducer: tb$1, useRef: function(a) {
  I$1 = Q$1();
  K$1 = qb$1();
  var b = K$1.memoizedState;
  return null === b ? (a = { current: a }, K$1.memoizedState = a) : b;
}, useState: function(a) {
  return tb$1(sb$1, a);
}, useInsertionEffect: R$1, useLayoutEffect: function() {
}, useCallback: function(a, b) {
  return vb$1(function() {
    return a;
  }, b);
}, useImperativeHandle: R$1, useEffect: R$1, useDebugValue: R$1, useDeferredValue: function(a) {
  Q$1();
  return a;
}, useTransition: function() {
  Q$1();
  return [
    false,
    wb$1
  ];
}, useId: function() {
  var a = ob$1.treeContext;
  var b = a.overflow;
  a = a.id;
  a = (a & ~(1 << 32 - H$1(a) - 1)).toString(32) + b;
  var c = S$1;
  if (null === c)
    throw Error(l$2(404));
  b = N$1++;
  a = ":" + c.idPrefix + "R" + a;
  0 < b && (a += "H" + b.toString(32));
  return a + ":";
}, useMutableSource: function(a, b) {
  Q$1();
  return b(a._source);
}, useSyncExternalStore: function(a, b, c) {
  if (void 0 === c)
    throw Error(l$2(407));
  return c();
} }, S$1 = null, yb$1 = aa$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;
function zb$1(a) {
  console.error(a);
  return null;
}
function T$1() {
}
function Ab$1(a, b, c, d, f2, e, g, h, k2) {
  var m2 = [], n2 = /* @__PURE__ */ new Set();
  b = { destination: null, responseState: b, progressiveChunkSize: void 0 === d ? 12800 : d, status: 0, fatalError: null, nextSegmentId: 0, allPendingTasks: 0, pendingRootTasks: 0, completedRootSegment: null, abortableTasks: n2, pingedTasks: m2, clientRenderedBoundaries: [], completedBoundaries: [], partialBoundaries: [], onError: void 0 === f2 ? zb$1 : f2, onAllReady: void 0 === e ? T$1 : e, onShellReady: void 0 === g ? T$1 : g, onShellError: void 0 === h ? T$1 : h, onFatalError: void 0 === k2 ? T$1 : k2 };
  c = U$1(b, 0, null, c, false, false);
  c.parentFlushed = true;
  a = Bb$1(b, a, null, c, n2, Ya$1, null, fb$1);
  m2.push(a);
  return b;
}
function Bb$1(a, b, c, d, f2, e, g, h) {
  a.allPendingTasks++;
  null === c ? a.pendingRootTasks++ : c.pendingTasks++;
  var k2 = { node: b, ping: function() {
    var b2 = a.pingedTasks;
    b2.push(k2);
    1 === b2.length && Cb$1(a);
  }, blockedBoundary: c, blockedSegment: d, abortSet: f2, legacyContext: e, context: g, treeContext: h };
  f2.add(k2);
  return k2;
}
function U$1(a, b, c, d, f2, e) {
  return { status: 0, id: -1, index: b, parentFlushed: false, chunks: [], children: [], formatContext: d, boundary: c, lastPushedText: f2, textEmbedded: e };
}
function V$1(a, b) {
  a = a.onError(b);
  if (null != a && "string" !== typeof a)
    throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "' + typeof a + '" instead');
  return a;
}
function W$1(a, b) {
  var c = a.onShellError;
  c(b);
  c = a.onFatalError;
  c(b);
  null !== a.destination ? (a.status = 2, a.destination.destroy(b)) : (a.status = 1, a.fatalError = b);
}
function Db$1(a, b, c, d, f2) {
  I$1 = {};
  ob$1 = b;
  N$1 = 0;
  for (a = c(d, f2); M$1; )
    M$1 = false, N$1 = 0, P$1 += 1, K$1 = null, a = c(d, f2);
  rb$1();
  return a;
}
function Eb$1(a, b, c, d) {
  var f2 = c.render(), e = d.childContextTypes;
  if (null !== e && void 0 !== e) {
    var g = b.legacyContext;
    if ("function" !== typeof c.getChildContext)
      d = g;
    else {
      c = c.getChildContext();
      for (var h in c)
        if (!(h in e))
          throw Error(l$2(108, Xa$1(d) || "Unknown", h));
      d = B$1({}, g, c);
    }
    b.legacyContext = d;
    X$1(a, b, f2);
    b.legacyContext = g;
  } else
    X$1(a, b, f2);
}
function Fb(a, b) {
  if (a && a.defaultProps) {
    b = B$1({}, b);
    a = a.defaultProps;
    for (var c in a)
      void 0 === b[c] && (b[c] = a[c]);
    return b;
  }
  return b;
}
function Gb$1(a, b, c, d, f2) {
  if ("function" === typeof c)
    if (c.prototype && c.prototype.isReactComponent) {
      f2 = Za$1(c, b.legacyContext);
      var e = c.contextType;
      e = new c(d, "object" === typeof e && null !== e ? e._currentValue2 : f2);
      eb$1(e, c, d, f2);
      Eb$1(a, b, e, c);
    } else {
      e = Za$1(c, b.legacyContext);
      f2 = Db$1(a, b, c, d, e);
      var g = 0 !== N$1;
      if ("object" === typeof f2 && null !== f2 && "function" === typeof f2.render && void 0 === f2.$$typeof)
        eb$1(f2, c, d, e), Eb$1(a, b, f2, c);
      else if (g) {
        d = b.treeContext;
        b.treeContext = gb$1(d, 1, 0);
        try {
          X$1(a, b, f2);
        } finally {
          b.treeContext = d;
        }
      } else
        X$1(a, b, f2);
    }
  else if ("string" === typeof c) {
    f2 = b.blockedSegment;
    e = ya$1(f2.chunks, c, d, a.responseState, f2.formatContext);
    f2.lastPushedText = false;
    g = f2.formatContext;
    f2.formatContext = ra$1(g, c, d);
    Hb$1(a, b, e);
    f2.formatContext = g;
    switch (c) {
      case "area":
      case "base":
      case "br":
      case "col":
      case "embed":
      case "hr":
      case "img":
      case "input":
      case "keygen":
      case "link":
      case "meta":
      case "param":
      case "source":
      case "track":
      case "wbr":
        break;
      default:
        f2.chunks.push("</", c, ">");
    }
    f2.lastPushedText = false;
  } else {
    switch (c) {
      case Ua$1:
      case Ta$1:
      case Ja$1:
      case Ka$1:
      case Ia$1:
        X$1(a, b, d.children);
        return;
      case Pa$1:
        X$1(a, b, d.children);
        return;
      case Sa$1:
        throw Error(l$2(343));
      case Oa$1:
        a: {
          c = b.blockedBoundary;
          f2 = b.blockedSegment;
          e = d.fallback;
          d = d.children;
          g = /* @__PURE__ */ new Set();
          var h = { id: null, rootSegmentID: -1, parentFlushed: false, pendingTasks: 0, forceClientRender: false, completedSegments: [], byteSize: 0, fallbackAbortableTasks: g, errorDigest: null }, k2 = U$1(a, f2.chunks.length, h, f2.formatContext, false, false);
          f2.children.push(k2);
          f2.lastPushedText = false;
          var m2 = U$1(a, 0, null, f2.formatContext, false, false);
          m2.parentFlushed = true;
          b.blockedBoundary = h;
          b.blockedSegment = m2;
          try {
            if (Hb$1(
              a,
              b,
              d
            ), a.responseState.generateStaticMarkup || m2.lastPushedText && m2.textEmbedded && m2.chunks.push("<!-- -->"), m2.status = 1, Y$1(h, m2), 0 === h.pendingTasks)
              break a;
          } catch (n2) {
            m2.status = 4, h.forceClientRender = true, h.errorDigest = V$1(a, n2);
          } finally {
            b.blockedBoundary = c, b.blockedSegment = f2;
          }
          b = Bb$1(a, e, c, k2, g, b.legacyContext, b.context, b.treeContext);
          a.pingedTasks.push(b);
        }
        return;
    }
    if ("object" === typeof c && null !== c)
      switch (c.$$typeof) {
        case Na$1:
          d = Db$1(a, b, c.render, d, f2);
          if (0 !== N$1) {
            c = b.treeContext;
            b.treeContext = gb$1(c, 1, 0);
            try {
              X$1(a, b, d);
            } finally {
              b.treeContext = c;
            }
          } else
            X$1(a, b, d);
          return;
        case Qa$1:
          c = c.type;
          d = Fb(c, d);
          Gb$1(a, b, c, d, f2);
          return;
        case La$1:
          f2 = d.children;
          c = c._context;
          d = d.value;
          e = c._currentValue2;
          c._currentValue2 = d;
          g = E$1;
          E$1 = d = { parent: g, depth: null === g ? 0 : g.depth + 1, context: c, parentValue: e, value: d };
          b.context = d;
          X$1(a, b, f2);
          a = E$1;
          if (null === a)
            throw Error(l$2(403));
          d = a.parentValue;
          a.context._currentValue2 = d === Va$1 ? a.context._defaultValue : d;
          a = E$1 = a.parent;
          b.context = a;
          return;
        case Ma$1:
          d = d.children;
          d = d(c._currentValue2);
          X$1(a, b, d);
          return;
        case Ra$1:
          f2 = c._init;
          c = f2(c._payload);
          d = Fb(c, d);
          Gb$1(
            a,
            b,
            c,
            d,
            void 0
          );
          return;
      }
    throw Error(l$2(130, null == c ? c : typeof c, ""));
  }
}
function X$1(a, b, c) {
  b.node = c;
  if ("object" === typeof c && null !== c) {
    switch (c.$$typeof) {
      case Ga$1:
        Gb$1(a, b, c.type, c.props, c.ref);
        return;
      case Ha$1:
        throw Error(l$2(257));
      case Ra$1:
        var d = c._init;
        c = d(c._payload);
        X$1(a, b, c);
        return;
    }
    if (qa$1(c)) {
      Ib$1(a, b, c);
      return;
    }
    null === c || "object" !== typeof c ? d = null : (d = Wa$1 && c[Wa$1] || c["@@iterator"], d = "function" === typeof d ? d : null);
    if (d && (d = d.call(c))) {
      c = d.next();
      if (!c.done) {
        var f2 = [];
        do
          f2.push(c.value), c = d.next();
        while (!c.done);
        Ib$1(a, b, f2);
      }
      return;
    }
    a = Object.prototype.toString.call(c);
    throw Error(l$2(31, "[object Object]" === a ? "object with keys {" + Object.keys(c).join(", ") + "}" : a));
  }
  "string" === typeof c ? (d = b.blockedSegment, d.lastPushedText = Fa$1(b.blockedSegment.chunks, c, a.responseState, d.lastPushedText)) : "number" === typeof c && (d = b.blockedSegment, d.lastPushedText = Fa$1(b.blockedSegment.chunks, "" + c, a.responseState, d.lastPushedText));
}
function Ib$1(a, b, c) {
  for (var d = c.length, f2 = 0; f2 < d; f2++) {
    var e = b.treeContext;
    b.treeContext = gb$1(e, d, f2);
    try {
      Hb$1(a, b, c[f2]);
    } finally {
      b.treeContext = e;
    }
  }
}
function Hb$1(a, b, c) {
  var d = b.blockedSegment.formatContext, f2 = b.legacyContext, e = b.context;
  try {
    return X$1(a, b, c);
  } catch (k2) {
    if (rb$1(), "object" === typeof k2 && null !== k2 && "function" === typeof k2.then) {
      c = k2;
      var g = b.blockedSegment, h = U$1(a, g.chunks.length, null, g.formatContext, g.lastPushedText, true);
      g.children.push(h);
      g.lastPushedText = false;
      a = Bb$1(a, b.node, b.blockedBoundary, h, b.abortSet, b.legacyContext, b.context, b.treeContext).ping;
      c.then(a, a);
      b.blockedSegment.formatContext = d;
      b.legacyContext = f2;
      b.context = e;
      G(e);
    } else
      throw b.blockedSegment.formatContext = d, b.legacyContext = f2, b.context = e, G(e), k2;
  }
}
function Jb$1(a) {
  var b = a.blockedBoundary;
  a = a.blockedSegment;
  a.status = 3;
  Kb$1(this, b, a);
}
function Lb$1(a, b, c) {
  var d = a.blockedBoundary;
  a.blockedSegment.status = 3;
  null === d ? (b.allPendingTasks--, 2 !== b.status && (b.status = 2, null !== b.destination && b.destination.push(null))) : (d.pendingTasks--, d.forceClientRender || (d.forceClientRender = true, a = void 0 === c ? Error(l$2(432)) : c, d.errorDigest = b.onError(a), d.parentFlushed && b.clientRenderedBoundaries.push(d)), d.fallbackAbortableTasks.forEach(function(a2) {
    return Lb$1(a2, b, c);
  }), d.fallbackAbortableTasks.clear(), b.allPendingTasks--, 0 === b.allPendingTasks && (d = b.onAllReady, d()));
}
function Y$1(a, b) {
  if (0 === b.chunks.length && 1 === b.children.length && null === b.children[0].boundary) {
    var c = b.children[0];
    c.id = b.id;
    c.parentFlushed = true;
    1 === c.status && Y$1(a, c);
  } else
    a.completedSegments.push(b);
}
function Kb$1(a, b, c) {
  if (null === b) {
    if (c.parentFlushed) {
      if (null !== a.completedRootSegment)
        throw Error(l$2(389));
      a.completedRootSegment = c;
    }
    a.pendingRootTasks--;
    0 === a.pendingRootTasks && (a.onShellError = T$1, b = a.onShellReady, b());
  } else
    b.pendingTasks--, b.forceClientRender || (0 === b.pendingTasks ? (c.parentFlushed && 1 === c.status && Y$1(b, c), b.parentFlushed && a.completedBoundaries.push(b), b.fallbackAbortableTasks.forEach(Jb$1, a), b.fallbackAbortableTasks.clear()) : c.parentFlushed && 1 === c.status && (Y$1(b, c), 1 === b.completedSegments.length && b.parentFlushed && a.partialBoundaries.push(b)));
  a.allPendingTasks--;
  0 === a.allPendingTasks && (a = a.onAllReady, a());
}
function Cb$1(a) {
  if (2 !== a.status) {
    var b = E$1, c = yb$1.current;
    yb$1.current = xb$1;
    var d = S$1;
    S$1 = a.responseState;
    try {
      var f2 = a.pingedTasks, e;
      for (e = 0; e < f2.length; e++) {
        var g = f2[e];
        var h = a, k2 = g.blockedSegment;
        if (0 === k2.status) {
          G(g.context);
          try {
            X$1(h, g, g.node), h.responseState.generateStaticMarkup || k2.lastPushedText && k2.textEmbedded && k2.chunks.push("<!-- -->"), g.abortSet.delete(g), k2.status = 1, Kb$1(h, g.blockedBoundary, k2);
          } catch (z2) {
            if (rb$1(), "object" === typeof z2 && null !== z2 && "function" === typeof z2.then) {
              var m2 = g.ping;
              z2.then(m2, m2);
            } else {
              g.abortSet.delete(g);
              k2.status = 4;
              var n2 = g.blockedBoundary, q2 = z2, C2 = V$1(h, q2);
              null === n2 ? W$1(h, q2) : (n2.pendingTasks--, n2.forceClientRender || (n2.forceClientRender = true, n2.errorDigest = C2, n2.parentFlushed && h.clientRenderedBoundaries.push(n2)));
              h.allPendingTasks--;
              if (0 === h.allPendingTasks) {
                var D2 = h.onAllReady;
                D2();
              }
            }
          } finally {
          }
        }
      }
      f2.splice(0, e);
      null !== a.destination && Mb$1(a, a.destination);
    } catch (z2) {
      V$1(a, z2), W$1(a, z2);
    } finally {
      S$1 = d, yb$1.current = c, c === xb$1 && G(b);
    }
  }
}
function Z$1(a, b, c) {
  c.parentFlushed = true;
  switch (c.status) {
    case 0:
      var d = c.id = a.nextSegmentId++;
      c.lastPushedText = false;
      c.textEmbedded = false;
      a = a.responseState;
      b.push('<template id="');
      b.push(a.placeholderPrefix);
      a = d.toString(16);
      b.push(a);
      return b.push('"></template>');
    case 1:
      c.status = 2;
      var f2 = true;
      d = c.chunks;
      var e = 0;
      c = c.children;
      for (var g = 0; g < c.length; g++) {
        for (f2 = c[g]; e < f2.index; e++)
          b.push(d[e]);
        f2 = Nb$1(a, b, f2);
      }
      for (; e < d.length - 1; e++)
        b.push(d[e]);
      e < d.length && (f2 = b.push(d[e]));
      return f2;
    default:
      throw Error(l$2(390));
  }
}
function Nb$1(a, b, c) {
  var d = c.boundary;
  if (null === d)
    return Z$1(a, b, c);
  d.parentFlushed = true;
  if (d.forceClientRender)
    return a.responseState.generateStaticMarkup || (d = d.errorDigest, b.push("<!--$!-->"), b.push("<template"), d && (b.push(' data-dgst="'), d = v(d), b.push(d), b.push('"')), b.push("></template>")), Z$1(a, b, c), a = a.responseState.generateStaticMarkup ? true : b.push("<!--/$-->"), a;
  if (0 < d.pendingTasks) {
    d.rootSegmentID = a.nextSegmentId++;
    0 < d.completedSegments.length && a.partialBoundaries.push(d);
    var f2 = a.responseState;
    var e = f2.nextSuspenseID++;
    f2 = f2.boundaryPrefix + e.toString(16);
    d = d.id = f2;
    za$1(b, a.responseState, d);
    Z$1(a, b, c);
    return b.push("<!--/$-->");
  }
  if (d.byteSize > a.progressiveChunkSize)
    return d.rootSegmentID = a.nextSegmentId++, a.completedBoundaries.push(d), za$1(b, a.responseState, d.id), Z$1(a, b, c), b.push("<!--/$-->");
  a.responseState.generateStaticMarkup || b.push("<!--$-->");
  c = d.completedSegments;
  if (1 !== c.length)
    throw Error(l$2(391));
  Nb$1(a, b, c[0]);
  a = a.responseState.generateStaticMarkup ? true : b.push("<!--/$-->");
  return a;
}
function Ob$1(a, b, c) {
  Aa$1(b, a.responseState, c.formatContext, c.id);
  Nb$1(a, b, c);
  return Ba$1(b, c.formatContext);
}
function Pb$1(a, b, c) {
  for (var d = c.completedSegments, f2 = 0; f2 < d.length; f2++)
    Qb$1(a, b, c, d[f2]);
  d.length = 0;
  a = a.responseState;
  d = c.id;
  c = c.rootSegmentID;
  b.push(a.startInlineScript);
  a.sentCompleteBoundaryFunction ? b.push('$RC("') : (a.sentCompleteBoundaryFunction = true, b.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'));
  if (null === d)
    throw Error(l$2(395));
  c = c.toString(16);
  b.push(d);
  b.push('","');
  b.push(a.segmentPrefix);
  b.push(c);
  return b.push('")<\/script>');
}
function Qb$1(a, b, c, d) {
  if (2 === d.status)
    return true;
  var f2 = d.id;
  if (-1 === f2) {
    if (-1 === (d.id = c.rootSegmentID))
      throw Error(l$2(392));
    return Ob$1(a, b, d);
  }
  Ob$1(a, b, d);
  a = a.responseState;
  b.push(a.startInlineScript);
  a.sentCompleteSegmentFunction ? b.push('$RS("') : (a.sentCompleteSegmentFunction = true, b.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'));
  b.push(a.segmentPrefix);
  f2 = f2.toString(16);
  b.push(f2);
  b.push('","');
  b.push(a.placeholderPrefix);
  b.push(f2);
  return b.push('")<\/script>');
}
function Mb$1(a, b) {
  try {
    var c = a.completedRootSegment;
    if (null !== c && 0 === a.pendingRootTasks) {
      Nb$1(a, b, c);
      a.completedRootSegment = null;
      var d = a.responseState.bootstrapChunks;
      for (c = 0; c < d.length - 1; c++)
        b.push(d[c]);
      c < d.length && b.push(d[c]);
    }
    var f2 = a.clientRenderedBoundaries, e;
    for (e = 0; e < f2.length; e++) {
      var g = f2[e];
      d = b;
      var h = a.responseState, k2 = g.id, m2 = g.errorDigest, n2 = g.errorMessage, q2 = g.errorComponentStack;
      d.push(h.startInlineScript);
      h.sentClientRenderFunction ? d.push('$RX("') : (h.sentClientRenderFunction = true, d.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'));
      if (null === k2)
        throw Error(l$2(395));
      d.push(k2);
      d.push('"');
      if (m2 || n2 || q2) {
        d.push(",");
        var C2 = Da$1(m2 || "");
        d.push(C2);
      }
      if (n2 || q2) {
        d.push(",");
        var D2 = Da$1(n2 || "");
        d.push(D2);
      }
      if (q2) {
        d.push(",");
        var z2 = Da$1(q2);
        d.push(z2);
      }
      if (!d.push(")<\/script>")) {
        a.destination = null;
        e++;
        f2.splice(0, e);
        return;
      }
    }
    f2.splice(0, e);
    var ba2 = a.completedBoundaries;
    for (e = 0; e < ba2.length; e++)
      if (!Pb$1(a, b, ba2[e])) {
        a.destination = null;
        e++;
        ba2.splice(0, e);
        return;
      }
    ba2.splice(0, e);
    var ca2 = a.partialBoundaries;
    for (e = 0; e < ca2.length; e++) {
      var mb2 = ca2[e];
      a: {
        f2 = a;
        g = b;
        var da2 = mb2.completedSegments;
        for (h = 0; h < da2.length; h++)
          if (!Qb$1(f2, g, mb2, da2[h])) {
            h++;
            da2.splice(0, h);
            var nb2 = false;
            break a;
          }
        da2.splice(0, h);
        nb2 = true;
      }
      if (!nb2) {
        a.destination = null;
        e++;
        ca2.splice(0, e);
        return;
      }
    }
    ca2.splice(0, e);
    var ea2 = a.completedBoundaries;
    for (e = 0; e < ea2.length; e++)
      if (!Pb$1(a, b, ea2[e])) {
        a.destination = null;
        e++;
        ea2.splice(0, e);
        return;
      }
    ea2.splice(0, e);
  } finally {
    0 === a.allPendingTasks && 0 === a.pingedTasks.length && 0 === a.clientRenderedBoundaries.length && 0 === a.completedBoundaries.length && b.push(null);
  }
}
function Rb$1(a, b) {
  try {
    var c = a.abortableTasks;
    c.forEach(function(c2) {
      return Lb$1(c2, a, b);
    });
    c.clear();
    null !== a.destination && Mb$1(a, a.destination);
  } catch (d) {
    V$1(a, d), W$1(a, d);
  }
}
function Sb$1() {
}
function Tb$1(a, b, c, d) {
  var f2 = false, e = null, g = "", h = { push: function(a2) {
    null !== a2 && (g += a2);
    return true;
  }, destroy: function(a2) {
    f2 = true;
    e = a2;
  } }, k2 = false;
  a = Ab$1(a, Ea$1(c, b ? b.identifierPrefix : void 0), { insertionMode: 1, selectedValue: null }, Infinity, Sb$1, void 0, function() {
    k2 = true;
  }, void 0, void 0);
  Cb$1(a);
  Rb$1(a, d);
  if (1 === a.status)
    a.status = 2, h.destroy(a.fatalError);
  else if (2 !== a.status && null === a.destination) {
    a.destination = h;
    try {
      Mb$1(a, h);
    } catch (m2) {
      V$1(a, m2), W$1(a, m2);
    }
  }
  if (f2)
    throw e;
  if (!k2)
    throw Error(l$2(426));
  return g;
}
reactDomServerLegacy_browser_production_min.renderToNodeStream = function() {
  throw Error(l$2(207));
};
reactDomServerLegacy_browser_production_min.renderToStaticMarkup = function(a, b) {
  return Tb$1(a, b, true, 'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server');
};
reactDomServerLegacy_browser_production_min.renderToStaticNodeStream = function() {
  throw Error(l$2(208));
};
reactDomServerLegacy_browser_production_min.renderToString = function(a, b) {
  return Tb$1(a, b, false, 'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server');
};
reactDomServerLegacy_browser_production_min.version = "18.2.0";
var reactDomServer_browser_production_min = {};
/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var aa = reactExports;
function k(a) {
  for (var b = "https://reactjs.org/docs/error-decoder.html?invariant=" + a, c = 1; c < arguments.length; c++)
    b += "&args[]=" + encodeURIComponent(arguments[c]);
  return "Minified React error #" + a + "; visit " + b + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
}
var l$1 = null, n = 0;
function p(a, b) {
  if (0 !== b.length)
    if (512 < b.length)
      0 < n && (a.enqueue(new Uint8Array(l$1.buffer, 0, n)), l$1 = new Uint8Array(512), n = 0), a.enqueue(b);
    else {
      var c = l$1.length - n;
      c < b.length && (0 === c ? a.enqueue(l$1) : (l$1.set(b.subarray(0, c), n), a.enqueue(l$1), b = b.subarray(c)), l$1 = new Uint8Array(512), n = 0);
      l$1.set(b, n);
      n += b.length;
    }
}
function t(a, b) {
  p(a, b);
  return true;
}
function ba(a) {
  l$1 && 0 < n && (a.enqueue(new Uint8Array(l$1.buffer, 0, n)), l$1 = null, n = 0);
}
var ca = new TextEncoder();
function u(a) {
  return ca.encode(a);
}
function w(a) {
  return ca.encode(a);
}
function da(a, b) {
  "function" === typeof a.error ? a.error(b) : a.close();
}
var x = Object.prototype.hasOwnProperty, ea = /^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/, fa = {}, ha = {};
function ia(a) {
  if (x.call(ha, a))
    return true;
  if (x.call(fa, a))
    return false;
  if (ea.test(a))
    return ha[a] = true;
  fa[a] = true;
  return false;
}
function y(a, b, c, d, f2, e, g) {
  this.acceptsBooleans = 2 === b || 3 === b || 4 === b;
  this.attributeName = d;
  this.attributeNamespace = f2;
  this.mustUseProperty = c;
  this.propertyName = a;
  this.type = b;
  this.sanitizeURL = e;
  this.removeEmptyString = g;
}
var z = {};
"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a) {
  z[a] = new y(a, 0, false, a, null, false, false);
});
[["acceptCharset", "accept-charset"], ["className", "class"], ["htmlFor", "for"], ["httpEquiv", "http-equiv"]].forEach(function(a) {
  var b = a[0];
  z[b] = new y(b, 1, false, a[1], null, false, false);
});
["contentEditable", "draggable", "spellCheck", "value"].forEach(function(a) {
  z[a] = new y(a, 2, false, a.toLowerCase(), null, false, false);
});
["autoReverse", "externalResourcesRequired", "focusable", "preserveAlpha"].forEach(function(a) {
  z[a] = new y(a, 2, false, a, null, false, false);
});
"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a) {
  z[a] = new y(a, 3, false, a.toLowerCase(), null, false, false);
});
["checked", "multiple", "muted", "selected"].forEach(function(a) {
  z[a] = new y(a, 3, true, a, null, false, false);
});
["capture", "download"].forEach(function(a) {
  z[a] = new y(a, 4, false, a, null, false, false);
});
["cols", "rows", "size", "span"].forEach(function(a) {
  z[a] = new y(a, 6, false, a, null, false, false);
});
["rowSpan", "start"].forEach(function(a) {
  z[a] = new y(a, 5, false, a.toLowerCase(), null, false, false);
});
var ja = /[\-:]([a-z])/g;
function ka(a) {
  return a[1].toUpperCase();
}
"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a) {
  var b = a.replace(
    ja,
    ka
  );
  z[b] = new y(b, 1, false, a, null, false, false);
});
"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a) {
  var b = a.replace(ja, ka);
  z[b] = new y(b, 1, false, a, "http://www.w3.org/1999/xlink", false, false);
});
["xml:base", "xml:lang", "xml:space"].forEach(function(a) {
  var b = a.replace(ja, ka);
  z[b] = new y(b, 1, false, a, "http://www.w3.org/XML/1998/namespace", false, false);
});
["tabIndex", "crossOrigin"].forEach(function(a) {
  z[a] = new y(a, 1, false, a.toLowerCase(), null, false, false);
});
z.xlinkHref = new y("xlinkHref", 1, false, "xlink:href", "http://www.w3.org/1999/xlink", true, false);
["src", "href", "action", "formAction"].forEach(function(a) {
  z[a] = new y(a, 1, false, a.toLowerCase(), null, true, true);
});
var B = {
  animationIterationCount: true,
  aspectRatio: true,
  borderImageOutset: true,
  borderImageSlice: true,
  borderImageWidth: true,
  boxFlex: true,
  boxFlexGroup: true,
  boxOrdinalGroup: true,
  columnCount: true,
  columns: true,
  flex: true,
  flexGrow: true,
  flexPositive: true,
  flexShrink: true,
  flexNegative: true,
  flexOrder: true,
  gridArea: true,
  gridRow: true,
  gridRowEnd: true,
  gridRowSpan: true,
  gridRowStart: true,
  gridColumn: true,
  gridColumnEnd: true,
  gridColumnSpan: true,
  gridColumnStart: true,
  fontWeight: true,
  lineClamp: true,
  lineHeight: true,
  opacity: true,
  order: true,
  orphans: true,
  tabSize: true,
  widows: true,
  zIndex: true,
  zoom: true,
  fillOpacity: true,
  floodOpacity: true,
  stopOpacity: true,
  strokeDasharray: true,
  strokeDashoffset: true,
  strokeMiterlimit: true,
  strokeOpacity: true,
  strokeWidth: true
}, la = ["Webkit", "ms", "Moz", "O"];
Object.keys(B).forEach(function(a) {
  la.forEach(function(b) {
    b = b + a.charAt(0).toUpperCase() + a.substring(1);
    B[b] = B[a];
  });
});
var oa = /["'&<>]/;
function C(a) {
  if ("boolean" === typeof a || "number" === typeof a)
    return "" + a;
  a = "" + a;
  var b = oa.exec(a);
  if (b) {
    var c = "", d, f2 = 0;
    for (d = b.index; d < a.length; d++) {
      switch (a.charCodeAt(d)) {
        case 34:
          b = "&quot;";
          break;
        case 38:
          b = "&amp;";
          break;
        case 39:
          b = "&#x27;";
          break;
        case 60:
          b = "&lt;";
          break;
        case 62:
          b = "&gt;";
          break;
        default:
          continue;
      }
      f2 !== d && (c += a.substring(f2, d));
      f2 = d + 1;
      c += b;
    }
    a = f2 !== d ? c + a.substring(f2, d) : c;
  }
  return a;
}
var pa = /([A-Z])/g, qa = /^ms-/, ra = Array.isArray, sa = w("<script>"), ta = w("<\/script>"), ua = w('<script src="'), va = w('<script type="module" src="'), wa = w('" async=""><\/script>'), xa = /(<\/|<)(s)(cript)/gi;
function ya(a, b, c, d) {
  return "" + b + ("s" === c ? "\\u0073" : "\\u0053") + d;
}
function za(a, b, c, d, f2) {
  a = void 0 === a ? "" : a;
  b = void 0 === b ? sa : w('<script nonce="' + C(b) + '">');
  var e = [];
  void 0 !== c && e.push(b, u(("" + c).replace(xa, ya)), ta);
  if (void 0 !== d)
    for (c = 0; c < d.length; c++)
      e.push(ua, u(C(d[c])), wa);
  if (void 0 !== f2)
    for (d = 0; d < f2.length; d++)
      e.push(va, u(C(f2[d])), wa);
  return { bootstrapChunks: e, startInlineScript: b, placeholderPrefix: w(a + "P:"), segmentPrefix: w(a + "S:"), boundaryPrefix: a + "B:", idPrefix: a, nextSuspenseID: 0, sentCompleteSegmentFunction: false, sentCompleteBoundaryFunction: false, sentClientRenderFunction: false };
}
function D(a, b) {
  return { insertionMode: a, selectedValue: b };
}
function Aa(a) {
  return D("http://www.w3.org/2000/svg" === a ? 2 : "http://www.w3.org/1998/Math/MathML" === a ? 3 : 0, null);
}
function Ba(a, b, c) {
  switch (b) {
    case "select":
      return D(1, null != c.value ? c.value : c.defaultValue);
    case "svg":
      return D(2, null);
    case "math":
      return D(3, null);
    case "foreignObject":
      return D(1, null);
    case "table":
      return D(4, null);
    case "thead":
    case "tbody":
    case "tfoot":
      return D(5, null);
    case "colgroup":
      return D(7, null);
    case "tr":
      return D(6, null);
  }
  return 4 <= a.insertionMode || 0 === a.insertionMode ? D(1, null) : a;
}
var Ca = w("<!-- -->");
function Da(a, b, c, d) {
  if ("" === b)
    return d;
  d && a.push(Ca);
  a.push(u(C(b)));
  return true;
}
var Ea = /* @__PURE__ */ new Map(), Fa = w(' style="'), Ga = w(":"), Ha = w(";");
function Ia(a, b, c) {
  if ("object" !== typeof c)
    throw Error(k(62));
  b = true;
  for (var d in c)
    if (x.call(c, d)) {
      var f2 = c[d];
      if (null != f2 && "boolean" !== typeof f2 && "" !== f2) {
        if (0 === d.indexOf("--")) {
          var e = u(C(d));
          f2 = u(C(("" + f2).trim()));
        } else {
          e = d;
          var g = Ea.get(e);
          void 0 !== g ? e = g : (g = w(C(e.replace(pa, "-$1").toLowerCase().replace(qa, "-ms-"))), Ea.set(e, g), e = g);
          f2 = "number" === typeof f2 ? 0 === f2 || x.call(B, d) ? u("" + f2) : u(f2 + "px") : u(C(("" + f2).trim()));
        }
        b ? (b = false, a.push(Fa, e, Ga, f2)) : a.push(Ha, e, Ga, f2);
      }
    }
  b || a.push(E);
}
var H = w(" "), I = w('="'), E = w('"'), Ja = w('=""');
function J(a, b, c, d) {
  switch (c) {
    case "style":
      Ia(a, b, d);
      return;
    case "defaultValue":
    case "defaultChecked":
    case "innerHTML":
    case "suppressContentEditableWarning":
    case "suppressHydrationWarning":
      return;
  }
  if (!(2 < c.length) || "o" !== c[0] && "O" !== c[0] || "n" !== c[1] && "N" !== c[1]) {
    if (b = z.hasOwnProperty(c) ? z[c] : null, null !== b) {
      switch (typeof d) {
        case "function":
        case "symbol":
          return;
        case "boolean":
          if (!b.acceptsBooleans)
            return;
      }
      c = u(b.attributeName);
      switch (b.type) {
        case 3:
          d && a.push(H, c, Ja);
          break;
        case 4:
          true === d ? a.push(H, c, Ja) : false !== d && a.push(H, c, I, u(C(d)), E);
          break;
        case 5:
          isNaN(d) || a.push(H, c, I, u(C(d)), E);
          break;
        case 6:
          !isNaN(d) && 1 <= d && a.push(H, c, I, u(C(d)), E);
          break;
        default:
          b.sanitizeURL && (d = "" + d), a.push(H, c, I, u(C(d)), E);
      }
    } else if (ia(c)) {
      switch (typeof d) {
        case "function":
        case "symbol":
          return;
        case "boolean":
          if (b = c.toLowerCase().slice(0, 5), "data-" !== b && "aria-" !== b)
            return;
      }
      a.push(H, u(c), I, u(C(d)), E);
    }
  }
}
var K = w(">"), Ka = w("/>");
function L(a, b, c) {
  if (null != b) {
    if (null != c)
      throw Error(k(60));
    if ("object" !== typeof b || !("__html" in b))
      throw Error(k(61));
    b = b.__html;
    null !== b && void 0 !== b && a.push(u("" + b));
  }
}
function La(a) {
  var b = "";
  aa.Children.forEach(a, function(a2) {
    null != a2 && (b += a2);
  });
  return b;
}
var Ma = w(' selected=""');
function Na(a, b, c, d) {
  a.push(M(c));
  var f2 = c = null, e;
  for (e in b)
    if (x.call(b, e)) {
      var g = b[e];
      if (null != g)
        switch (e) {
          case "children":
            c = g;
            break;
          case "dangerouslySetInnerHTML":
            f2 = g;
            break;
          default:
            J(a, d, e, g);
        }
    }
  a.push(K);
  L(a, f2, c);
  return "string" === typeof c ? (a.push(u(C(c))), null) : c;
}
var Oa = w("\n"), Pa = /^[a-zA-Z][a-zA-Z:_\.\-\d]*$/, Qa = /* @__PURE__ */ new Map();
function M(a) {
  var b = Qa.get(a);
  if (void 0 === b) {
    if (!Pa.test(a))
      throw Error(k(65, a));
    b = w("<" + a);
    Qa.set(a, b);
  }
  return b;
}
var Ra = w("<!DOCTYPE html>");
function Sa(a, b, c, d, f2) {
  switch (b) {
    case "select":
      a.push(M("select"));
      var e = null, g = null;
      for (r2 in c)
        if (x.call(c, r2)) {
          var h = c[r2];
          if (null != h)
            switch (r2) {
              case "children":
                e = h;
                break;
              case "dangerouslySetInnerHTML":
                g = h;
                break;
              case "defaultValue":
              case "value":
                break;
              default:
                J(a, d, r2, h);
            }
        }
      a.push(K);
      L(a, g, e);
      return e;
    case "option":
      g = f2.selectedValue;
      a.push(M("option"));
      var m2 = h = null, q2 = null;
      var r2 = null;
      for (e in c)
        if (x.call(c, e)) {
          var v2 = c[e];
          if (null != v2)
            switch (e) {
              case "children":
                h = v2;
                break;
              case "selected":
                q2 = v2;
                break;
              case "dangerouslySetInnerHTML":
                r2 = v2;
                break;
              case "value":
                m2 = v2;
              default:
                J(a, d, e, v2);
            }
        }
      if (null != g)
        if (c = null !== m2 ? "" + m2 : La(h), ra(g))
          for (d = 0; d < g.length; d++) {
            if ("" + g[d] === c) {
              a.push(Ma);
              break;
            }
          }
        else
          "" + g === c && a.push(Ma);
      else
        q2 && a.push(Ma);
      a.push(K);
      L(a, r2, h);
      return h;
    case "textarea":
      a.push(M("textarea"));
      r2 = g = e = null;
      for (h in c)
        if (x.call(c, h) && (m2 = c[h], null != m2))
          switch (h) {
            case "children":
              r2 = m2;
              break;
            case "value":
              e = m2;
              break;
            case "defaultValue":
              g = m2;
              break;
            case "dangerouslySetInnerHTML":
              throw Error(k(91));
            default:
              J(a, d, h, m2);
          }
      null === e && null !== g && (e = g);
      a.push(K);
      if (null != r2) {
        if (null != e)
          throw Error(k(92));
        if (ra(r2) && 1 < r2.length)
          throw Error(k(93));
        e = "" + r2;
      }
      "string" === typeof e && "\n" === e[0] && a.push(Oa);
      null !== e && a.push(u(C("" + e)));
      return null;
    case "input":
      a.push(M("input"));
      m2 = r2 = h = e = null;
      for (g in c)
        if (x.call(c, g) && (q2 = c[g], null != q2))
          switch (g) {
            case "children":
            case "dangerouslySetInnerHTML":
              throw Error(k(399, "input"));
            case "defaultChecked":
              m2 = q2;
              break;
            case "defaultValue":
              h = q2;
              break;
            case "checked":
              r2 = q2;
              break;
            case "value":
              e = q2;
              break;
            default:
              J(a, d, g, q2);
          }
      null !== r2 ? J(
        a,
        d,
        "checked",
        r2
      ) : null !== m2 && J(a, d, "checked", m2);
      null !== e ? J(a, d, "value", e) : null !== h && J(a, d, "value", h);
      a.push(Ka);
      return null;
    case "menuitem":
      a.push(M("menuitem"));
      for (var A2 in c)
        if (x.call(c, A2) && (e = c[A2], null != e))
          switch (A2) {
            case "children":
            case "dangerouslySetInnerHTML":
              throw Error(k(400));
            default:
              J(a, d, A2, e);
          }
      a.push(K);
      return null;
    case "title":
      a.push(M("title"));
      e = null;
      for (v2 in c)
        if (x.call(c, v2) && (g = c[v2], null != g))
          switch (v2) {
            case "children":
              e = g;
              break;
            case "dangerouslySetInnerHTML":
              throw Error(k(434));
            default:
              J(a, d, v2, g);
          }
      a.push(K);
      return e;
    case "listing":
    case "pre":
      a.push(M(b));
      g = e = null;
      for (m2 in c)
        if (x.call(c, m2) && (h = c[m2], null != h))
          switch (m2) {
            case "children":
              e = h;
              break;
            case "dangerouslySetInnerHTML":
              g = h;
              break;
            default:
              J(a, d, m2, h);
          }
      a.push(K);
      if (null != g) {
        if (null != e)
          throw Error(k(60));
        if ("object" !== typeof g || !("__html" in g))
          throw Error(k(61));
        c = g.__html;
        null !== c && void 0 !== c && ("string" === typeof c && 0 < c.length && "\n" === c[0] ? a.push(Oa, u(c)) : a.push(u("" + c)));
      }
      "string" === typeof e && "\n" === e[0] && a.push(Oa);
      return e;
    case "area":
    case "base":
    case "br":
    case "col":
    case "embed":
    case "hr":
    case "img":
    case "keygen":
    case "link":
    case "meta":
    case "param":
    case "source":
    case "track":
    case "wbr":
      a.push(M(b));
      for (var F2 in c)
        if (x.call(c, F2) && (e = c[F2], null != e))
          switch (F2) {
            case "children":
            case "dangerouslySetInnerHTML":
              throw Error(k(399, b));
            default:
              J(a, d, F2, e);
          }
      a.push(Ka);
      return null;
    case "annotation-xml":
    case "color-profile":
    case "font-face":
    case "font-face-src":
    case "font-face-uri":
    case "font-face-format":
    case "font-face-name":
    case "missing-glyph":
      return Na(a, c, b, d);
    case "html":
      return 0 === f2.insertionMode && a.push(Ra), Na(a, c, b, d);
    default:
      if (-1 === b.indexOf("-") && "string" !== typeof c.is)
        return Na(a, c, b, d);
      a.push(M(b));
      g = e = null;
      for (q2 in c)
        if (x.call(c, q2) && (h = c[q2], null != h))
          switch (q2) {
            case "children":
              e = h;
              break;
            case "dangerouslySetInnerHTML":
              g = h;
              break;
            case "style":
              Ia(a, d, h);
              break;
            case "suppressContentEditableWarning":
            case "suppressHydrationWarning":
              break;
            default:
              ia(q2) && "function" !== typeof h && "symbol" !== typeof h && a.push(H, u(q2), I, u(C(h)), E);
          }
      a.push(K);
      L(a, g, e);
      return e;
  }
}
var Ta = w("</"), Ua = w(">"), Va = w('<template id="'), Wa = w('"></template>'), Xa = w("<!--$-->"), Ya = w('<!--$?--><template id="'), Za = w('"></template>'), $a = w("<!--$!-->"), ab = w("<!--/$-->"), bb = w("<template"), cb = w('"'), db = w(' data-dgst="');
w(' data-msg="');
w(' data-stck="');
var eb = w("></template>");
function fb(a, b, c) {
  p(a, Ya);
  if (null === c)
    throw Error(k(395));
  p(a, c);
  return t(a, Za);
}
var gb = w('<div hidden id="'), hb = w('">'), ib = w("</div>"), jb = w('<svg aria-hidden="true" style="display:none" id="'), kb = w('">'), lb = w("</svg>"), mb = w('<math aria-hidden="true" style="display:none" id="'), nb = w('">'), ob = w("</math>"), pb = w('<table hidden id="'), qb = w('">'), rb = w("</table>"), sb = w('<table hidden><tbody id="'), tb = w('">'), ub = w("</tbody></table>"), vb = w('<table hidden><tr id="'), wb = w('">'), xb = w("</tr></table>"), yb = w('<table hidden><colgroup id="'), zb = w('">'), Ab = w("</colgroup></table>");
function Bb(a, b, c, d) {
  switch (c.insertionMode) {
    case 0:
    case 1:
      return p(a, gb), p(a, b.segmentPrefix), p(a, u(d.toString(16))), t(a, hb);
    case 2:
      return p(a, jb), p(a, b.segmentPrefix), p(a, u(d.toString(16))), t(a, kb);
    case 3:
      return p(a, mb), p(a, b.segmentPrefix), p(a, u(d.toString(16))), t(a, nb);
    case 4:
      return p(a, pb), p(a, b.segmentPrefix), p(a, u(d.toString(16))), t(a, qb);
    case 5:
      return p(a, sb), p(a, b.segmentPrefix), p(a, u(d.toString(16))), t(a, tb);
    case 6:
      return p(a, vb), p(a, b.segmentPrefix), p(a, u(d.toString(16))), t(a, wb);
    case 7:
      return p(
        a,
        yb
      ), p(a, b.segmentPrefix), p(a, u(d.toString(16))), t(a, zb);
    default:
      throw Error(k(397));
  }
}
function Cb(a, b) {
  switch (b.insertionMode) {
    case 0:
    case 1:
      return t(a, ib);
    case 2:
      return t(a, lb);
    case 3:
      return t(a, ob);
    case 4:
      return t(a, rb);
    case 5:
      return t(a, ub);
    case 6:
      return t(a, xb);
    case 7:
      return t(a, Ab);
    default:
      throw Error(k(397));
  }
}
var Db = w('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'), Eb = w('$RS("'), Gb = w('","'), Hb = w('")<\/script>'), Ib = w('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'), Jb = w('$RC("'), Kb = w('","'), Lb = w('")<\/script>'), Mb = w('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'), Nb = w('$RX("'), Ob = w('"'), Pb = w(")<\/script>"), Qb = w(","), Rb = /[<\u2028\u2029]/g;
function Sb(a) {
  return JSON.stringify(a).replace(Rb, function(a2) {
    switch (a2) {
      case "<":
        return "\\u003c";
      case "\u2028":
        return "\\u2028";
      case "\u2029":
        return "\\u2029";
      default:
        throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React");
    }
  });
}
var N = Object.assign, Tb = Symbol.for("react.element"), Ub = Symbol.for("react.portal"), Vb = Symbol.for("react.fragment"), Wb = Symbol.for("react.strict_mode"), Xb = Symbol.for("react.profiler"), Yb = Symbol.for("react.provider"), Zb = Symbol.for("react.context"), $b = Symbol.for("react.forward_ref"), ac = Symbol.for("react.suspense"), bc = Symbol.for("react.suspense_list"), cc = Symbol.for("react.memo"), dc = Symbol.for("react.lazy"), ec = Symbol.for("react.scope"), fc = Symbol.for("react.debug_trace_mode"), gc = Symbol.for("react.legacy_hidden"), hc = Symbol.for("react.default_value"), ic = Symbol.iterator;
function jc(a) {
  if (null == a)
    return null;
  if ("function" === typeof a)
    return a.displayName || a.name || null;
  if ("string" === typeof a)
    return a;
  switch (a) {
    case Vb:
      return "Fragment";
    case Ub:
      return "Portal";
    case Xb:
      return "Profiler";
    case Wb:
      return "StrictMode";
    case ac:
      return "Suspense";
    case bc:
      return "SuspenseList";
  }
  if ("object" === typeof a)
    switch (a.$$typeof) {
      case Zb:
        return (a.displayName || "Context") + ".Consumer";
      case Yb:
        return (a._context.displayName || "Context") + ".Provider";
      case $b:
        var b = a.render;
        a = a.displayName;
        a || (a = b.displayName || b.name || "", a = "" !== a ? "ForwardRef(" + a + ")" : "ForwardRef");
        return a;
      case cc:
        return b = a.displayName || null, null !== b ? b : jc(a.type) || "Memo";
      case dc:
        b = a._payload;
        a = a._init;
        try {
          return jc(a(b));
        } catch (c) {
        }
    }
  return null;
}
var kc = {};
function lc(a, b) {
  a = a.contextTypes;
  if (!a)
    return kc;
  var c = {}, d;
  for (d in a)
    c[d] = b[d];
  return c;
}
var O = null;
function P(a, b) {
  if (a !== b) {
    a.context._currentValue = a.parentValue;
    a = a.parent;
    var c = b.parent;
    if (null === a) {
      if (null !== c)
        throw Error(k(401));
    } else {
      if (null === c)
        throw Error(k(401));
      P(a, c);
    }
    b.context._currentValue = b.value;
  }
}
function mc(a) {
  a.context._currentValue = a.parentValue;
  a = a.parent;
  null !== a && mc(a);
}
function nc(a) {
  var b = a.parent;
  null !== b && nc(b);
  a.context._currentValue = a.value;
}
function oc(a, b) {
  a.context._currentValue = a.parentValue;
  a = a.parent;
  if (null === a)
    throw Error(k(402));
  a.depth === b.depth ? P(a, b) : oc(a, b);
}
function pc(a, b) {
  var c = b.parent;
  if (null === c)
    throw Error(k(402));
  a.depth === c.depth ? P(a, c) : pc(a, c);
  b.context._currentValue = b.value;
}
function Q(a) {
  var b = O;
  b !== a && (null === b ? nc(a) : null === a ? mc(b) : b.depth === a.depth ? P(b, a) : b.depth > a.depth ? oc(b, a) : pc(b, a), O = a);
}
var qc = { isMounted: function() {
  return false;
}, enqueueSetState: function(a, b) {
  a = a._reactInternals;
  null !== a.queue && a.queue.push(b);
}, enqueueReplaceState: function(a, b) {
  a = a._reactInternals;
  a.replace = true;
  a.queue = [b];
}, enqueueForceUpdate: function() {
} };
function rc(a, b, c, d) {
  var f2 = void 0 !== a.state ? a.state : null;
  a.updater = qc;
  a.props = c;
  a.state = f2;
  var e = { queue: [], replace: false };
  a._reactInternals = e;
  var g = b.contextType;
  a.context = "object" === typeof g && null !== g ? g._currentValue : d;
  g = b.getDerivedStateFromProps;
  "function" === typeof g && (g = g(c, f2), f2 = null === g || void 0 === g ? f2 : N({}, f2, g), a.state = f2);
  if ("function" !== typeof b.getDerivedStateFromProps && "function" !== typeof a.getSnapshotBeforeUpdate && ("function" === typeof a.UNSAFE_componentWillMount || "function" === typeof a.componentWillMount))
    if (b = a.state, "function" === typeof a.componentWillMount && a.componentWillMount(), "function" === typeof a.UNSAFE_componentWillMount && a.UNSAFE_componentWillMount(), b !== a.state && qc.enqueueReplaceState(a, a.state, null), null !== e.queue && 0 < e.queue.length)
      if (b = e.queue, g = e.replace, e.queue = null, e.replace = false, g && 1 === b.length)
        a.state = b[0];
      else {
        e = g ? b[0] : a.state;
        f2 = true;
        for (g = g ? 1 : 0; g < b.length; g++) {
          var h = b[g];
          h = "function" === typeof h ? h.call(a, e, c, d) : h;
          null != h && (f2 ? (f2 = false, e = N({}, e, h)) : N(e, h));
        }
        a.state = e;
      }
    else
      e.queue = null;
}
var sc = { id: 1, overflow: "" };
function tc(a, b, c) {
  var d = a.id;
  a = a.overflow;
  var f2 = 32 - uc(d) - 1;
  d &= ~(1 << f2);
  c += 1;
  var e = 32 - uc(b) + f2;
  if (30 < e) {
    var g = f2 - f2 % 5;
    e = (d & (1 << g) - 1).toString(32);
    d >>= g;
    f2 -= g;
    return { id: 1 << 32 - uc(b) + f2 | c << f2 | d, overflow: e + a };
  }
  return { id: 1 << e | c << f2 | d, overflow: a };
}
var uc = Math.clz32 ? Math.clz32 : vc, wc = Math.log, xc = Math.LN2;
function vc(a) {
  a >>>= 0;
  return 0 === a ? 32 : 31 - (wc(a) / xc | 0) | 0;
}
function yc(a, b) {
  return a === b && (0 !== a || 1 / a === 1 / b) || a !== a && b !== b;
}
var zc = "function" === typeof Object.is ? Object.is : yc, R = null, Ac = null, Bc = null, S = null, T = false, Cc = false, U = 0, V = null, Dc = 0;
function W() {
  if (null === R)
    throw Error(k(321));
  return R;
}
function Ec() {
  if (0 < Dc)
    throw Error(k(312));
  return { memoizedState: null, queue: null, next: null };
}
function Fc() {
  null === S ? null === Bc ? (T = false, Bc = S = Ec()) : (T = true, S = Bc) : null === S.next ? (T = false, S = S.next = Ec()) : (T = true, S = S.next);
  return S;
}
function Gc() {
  Ac = R = null;
  Cc = false;
  Bc = null;
  Dc = 0;
  S = V = null;
}
function Hc(a, b) {
  return "function" === typeof b ? b(a) : b;
}
function Ic(a, b, c) {
  R = W();
  S = Fc();
  if (T) {
    var d = S.queue;
    b = d.dispatch;
    if (null !== V && (c = V.get(d), void 0 !== c)) {
      V.delete(d);
      d = S.memoizedState;
      do
        d = a(d, c.action), c = c.next;
      while (null !== c);
      S.memoizedState = d;
      return [d, b];
    }
    return [S.memoizedState, b];
  }
  a = a === Hc ? "function" === typeof b ? b() : b : void 0 !== c ? c(b) : b;
  S.memoizedState = a;
  a = S.queue = { last: null, dispatch: null };
  a = a.dispatch = Jc.bind(null, R, a);
  return [S.memoizedState, a];
}
function Kc(a, b) {
  R = W();
  S = Fc();
  b = void 0 === b ? null : b;
  if (null !== S) {
    var c = S.memoizedState;
    if (null !== c && null !== b) {
      var d = c[1];
      a:
        if (null === d)
          d = false;
        else {
          for (var f2 = 0; f2 < d.length && f2 < b.length; f2++)
            if (!zc(b[f2], d[f2])) {
              d = false;
              break a;
            }
          d = true;
        }
      if (d)
        return c[0];
    }
  }
  a = a();
  S.memoizedState = [a, b];
  return a;
}
function Jc(a, b, c) {
  if (25 <= Dc)
    throw Error(k(301));
  if (a === R)
    if (Cc = true, a = { action: c, next: null }, null === V && (V = /* @__PURE__ */ new Map()), c = V.get(b), void 0 === c)
      V.set(b, a);
    else {
      for (b = c; null !== b.next; )
        b = b.next;
      b.next = a;
    }
}
function Lc() {
  throw Error(k(394));
}
function Mc() {
}
var Oc = { readContext: function(a) {
  return a._currentValue;
}, useContext: function(a) {
  W();
  return a._currentValue;
}, useMemo: Kc, useReducer: Ic, useRef: function(a) {
  R = W();
  S = Fc();
  var b = S.memoizedState;
  return null === b ? (a = { current: a }, S.memoizedState = a) : b;
}, useState: function(a) {
  return Ic(Hc, a);
}, useInsertionEffect: Mc, useLayoutEffect: function() {
}, useCallback: function(a, b) {
  return Kc(function() {
    return a;
  }, b);
}, useImperativeHandle: Mc, useEffect: Mc, useDebugValue: Mc, useDeferredValue: function(a) {
  W();
  return a;
}, useTransition: function() {
  W();
  return [false, Lc];
}, useId: function() {
  var a = Ac.treeContext;
  var b = a.overflow;
  a = a.id;
  a = (a & ~(1 << 32 - uc(a) - 1)).toString(32) + b;
  var c = Nc;
  if (null === c)
    throw Error(k(404));
  b = U++;
  a = ":" + c.idPrefix + "R" + a;
  0 < b && (a += "H" + b.toString(32));
  return a + ":";
}, useMutableSource: function(a, b) {
  W();
  return b(a._source);
}, useSyncExternalStore: function(a, b, c) {
  if (void 0 === c)
    throw Error(k(407));
  return c();
} }, Nc = null, Pc = aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;
function Qc(a) {
  console.error(a);
  return null;
}
function X() {
}
function Rc(a, b, c, d, f2, e, g, h, m2) {
  var q2 = [], r2 = /* @__PURE__ */ new Set();
  b = { destination: null, responseState: b, progressiveChunkSize: void 0 === d ? 12800 : d, status: 0, fatalError: null, nextSegmentId: 0, allPendingTasks: 0, pendingRootTasks: 0, completedRootSegment: null, abortableTasks: r2, pingedTasks: q2, clientRenderedBoundaries: [], completedBoundaries: [], partialBoundaries: [], onError: void 0 === f2 ? Qc : f2, onAllReady: void 0 === e ? X : e, onShellReady: void 0 === g ? X : g, onShellError: void 0 === h ? X : h, onFatalError: void 0 === m2 ? X : m2 };
  c = Sc(b, 0, null, c, false, false);
  c.parentFlushed = true;
  a = Tc(b, a, null, c, r2, kc, null, sc);
  q2.push(a);
  return b;
}
function Tc(a, b, c, d, f2, e, g, h) {
  a.allPendingTasks++;
  null === c ? a.pendingRootTasks++ : c.pendingTasks++;
  var m2 = { node: b, ping: function() {
    var b2 = a.pingedTasks;
    b2.push(m2);
    1 === b2.length && Uc(a);
  }, blockedBoundary: c, blockedSegment: d, abortSet: f2, legacyContext: e, context: g, treeContext: h };
  f2.add(m2);
  return m2;
}
function Sc(a, b, c, d, f2, e) {
  return { status: 0, id: -1, index: b, parentFlushed: false, chunks: [], children: [], formatContext: d, boundary: c, lastPushedText: f2, textEmbedded: e };
}
function Y(a, b) {
  a = a.onError(b);
  if (null != a && "string" !== typeof a)
    throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "' + typeof a + '" instead');
  return a;
}
function Vc(a, b) {
  var c = a.onShellError;
  c(b);
  c = a.onFatalError;
  c(b);
  null !== a.destination ? (a.status = 2, da(a.destination, b)) : (a.status = 1, a.fatalError = b);
}
function Wc(a, b, c, d, f2) {
  R = {};
  Ac = b;
  U = 0;
  for (a = c(d, f2); Cc; )
    Cc = false, U = 0, Dc += 1, S = null, a = c(d, f2);
  Gc();
  return a;
}
function Xc(a, b, c, d) {
  var f2 = c.render(), e = d.childContextTypes;
  if (null !== e && void 0 !== e) {
    var g = b.legacyContext;
    if ("function" !== typeof c.getChildContext)
      d = g;
    else {
      c = c.getChildContext();
      for (var h in c)
        if (!(h in e))
          throw Error(k(108, jc(d) || "Unknown", h));
      d = N({}, g, c);
    }
    b.legacyContext = d;
    Z(a, b, f2);
    b.legacyContext = g;
  } else
    Z(a, b, f2);
}
function Yc(a, b) {
  if (a && a.defaultProps) {
    b = N({}, b);
    a = a.defaultProps;
    for (var c in a)
      void 0 === b[c] && (b[c] = a[c]);
    return b;
  }
  return b;
}
function Zc(a, b, c, d, f2) {
  if ("function" === typeof c)
    if (c.prototype && c.prototype.isReactComponent) {
      f2 = lc(c, b.legacyContext);
      var e = c.contextType;
      e = new c(d, "object" === typeof e && null !== e ? e._currentValue : f2);
      rc(e, c, d, f2);
      Xc(a, b, e, c);
    } else {
      e = lc(c, b.legacyContext);
      f2 = Wc(a, b, c, d, e);
      var g = 0 !== U;
      if ("object" === typeof f2 && null !== f2 && "function" === typeof f2.render && void 0 === f2.$$typeof)
        rc(f2, c, d, e), Xc(a, b, f2, c);
      else if (g) {
        d = b.treeContext;
        b.treeContext = tc(d, 1, 0);
        try {
          Z(a, b, f2);
        } finally {
          b.treeContext = d;
        }
      } else
        Z(a, b, f2);
    }
  else if ("string" === typeof c) {
    f2 = b.blockedSegment;
    e = Sa(f2.chunks, c, d, a.responseState, f2.formatContext);
    f2.lastPushedText = false;
    g = f2.formatContext;
    f2.formatContext = Ba(g, c, d);
    $c(a, b, e);
    f2.formatContext = g;
    switch (c) {
      case "area":
      case "base":
      case "br":
      case "col":
      case "embed":
      case "hr":
      case "img":
      case "input":
      case "keygen":
      case "link":
      case "meta":
      case "param":
      case "source":
      case "track":
      case "wbr":
        break;
      default:
        f2.chunks.push(Ta, u(c), Ua);
    }
    f2.lastPushedText = false;
  } else {
    switch (c) {
      case gc:
      case fc:
      case Wb:
      case Xb:
      case Vb:
        Z(a, b, d.children);
        return;
      case bc:
        Z(a, b, d.children);
        return;
      case ec:
        throw Error(k(343));
      case ac:
        a: {
          c = b.blockedBoundary;
          f2 = b.blockedSegment;
          e = d.fallback;
          d = d.children;
          g = /* @__PURE__ */ new Set();
          var h = { id: null, rootSegmentID: -1, parentFlushed: false, pendingTasks: 0, forceClientRender: false, completedSegments: [], byteSize: 0, fallbackAbortableTasks: g, errorDigest: null }, m2 = Sc(a, f2.chunks.length, h, f2.formatContext, false, false);
          f2.children.push(m2);
          f2.lastPushedText = false;
          var q2 = Sc(a, 0, null, f2.formatContext, false, false);
          q2.parentFlushed = true;
          b.blockedBoundary = h;
          b.blockedSegment = q2;
          try {
            if ($c(
              a,
              b,
              d
            ), q2.lastPushedText && q2.textEmbedded && q2.chunks.push(Ca), q2.status = 1, ad(h, q2), 0 === h.pendingTasks)
              break a;
          } catch (r2) {
            q2.status = 4, h.forceClientRender = true, h.errorDigest = Y(a, r2);
          } finally {
            b.blockedBoundary = c, b.blockedSegment = f2;
          }
          b = Tc(a, e, c, m2, g, b.legacyContext, b.context, b.treeContext);
          a.pingedTasks.push(b);
        }
        return;
    }
    if ("object" === typeof c && null !== c)
      switch (c.$$typeof) {
        case $b:
          d = Wc(a, b, c.render, d, f2);
          if (0 !== U) {
            c = b.treeContext;
            b.treeContext = tc(c, 1, 0);
            try {
              Z(a, b, d);
            } finally {
              b.treeContext = c;
            }
          } else
            Z(a, b, d);
          return;
        case cc:
          c = c.type;
          d = Yc(c, d);
          Zc(a, b, c, d, f2);
          return;
        case Yb:
          f2 = d.children;
          c = c._context;
          d = d.value;
          e = c._currentValue;
          c._currentValue = d;
          g = O;
          O = d = { parent: g, depth: null === g ? 0 : g.depth + 1, context: c, parentValue: e, value: d };
          b.context = d;
          Z(a, b, f2);
          a = O;
          if (null === a)
            throw Error(k(403));
          d = a.parentValue;
          a.context._currentValue = d === hc ? a.context._defaultValue : d;
          a = O = a.parent;
          b.context = a;
          return;
        case Zb:
          d = d.children;
          d = d(c._currentValue);
          Z(a, b, d);
          return;
        case dc:
          f2 = c._init;
          c = f2(c._payload);
          d = Yc(c, d);
          Zc(a, b, c, d, void 0);
          return;
      }
    throw Error(k(
      130,
      null == c ? c : typeof c,
      ""
    ));
  }
}
function Z(a, b, c) {
  b.node = c;
  if ("object" === typeof c && null !== c) {
    switch (c.$$typeof) {
      case Tb:
        Zc(a, b, c.type, c.props, c.ref);
        return;
      case Ub:
        throw Error(k(257));
      case dc:
        var d = c._init;
        c = d(c._payload);
        Z(a, b, c);
        return;
    }
    if (ra(c)) {
      bd(a, b, c);
      return;
    }
    null === c || "object" !== typeof c ? d = null : (d = ic && c[ic] || c["@@iterator"], d = "function" === typeof d ? d : null);
    if (d && (d = d.call(c))) {
      c = d.next();
      if (!c.done) {
        var f2 = [];
        do
          f2.push(c.value), c = d.next();
        while (!c.done);
        bd(a, b, f2);
      }
      return;
    }
    a = Object.prototype.toString.call(c);
    throw Error(k(31, "[object Object]" === a ? "object with keys {" + Object.keys(c).join(", ") + "}" : a));
  }
  "string" === typeof c ? (d = b.blockedSegment, d.lastPushedText = Da(b.blockedSegment.chunks, c, a.responseState, d.lastPushedText)) : "number" === typeof c && (d = b.blockedSegment, d.lastPushedText = Da(b.blockedSegment.chunks, "" + c, a.responseState, d.lastPushedText));
}
function bd(a, b, c) {
  for (var d = c.length, f2 = 0; f2 < d; f2++) {
    var e = b.treeContext;
    b.treeContext = tc(e, d, f2);
    try {
      $c(a, b, c[f2]);
    } finally {
      b.treeContext = e;
    }
  }
}
function $c(a, b, c) {
  var d = b.blockedSegment.formatContext, f2 = b.legacyContext, e = b.context;
  try {
    return Z(a, b, c);
  } catch (m2) {
    if (Gc(), "object" === typeof m2 && null !== m2 && "function" === typeof m2.then) {
      c = m2;
      var g = b.blockedSegment, h = Sc(a, g.chunks.length, null, g.formatContext, g.lastPushedText, true);
      g.children.push(h);
      g.lastPushedText = false;
      a = Tc(a, b.node, b.blockedBoundary, h, b.abortSet, b.legacyContext, b.context, b.treeContext).ping;
      c.then(a, a);
      b.blockedSegment.formatContext = d;
      b.legacyContext = f2;
      b.context = e;
      Q(e);
    } else
      throw b.blockedSegment.formatContext = d, b.legacyContext = f2, b.context = e, Q(e), m2;
  }
}
function cd(a) {
  var b = a.blockedBoundary;
  a = a.blockedSegment;
  a.status = 3;
  dd(this, b, a);
}
function ed(a, b, c) {
  var d = a.blockedBoundary;
  a.blockedSegment.status = 3;
  null === d ? (b.allPendingTasks--, 2 !== b.status && (b.status = 2, null !== b.destination && b.destination.close())) : (d.pendingTasks--, d.forceClientRender || (d.forceClientRender = true, a = void 0 === c ? Error(k(432)) : c, d.errorDigest = b.onError(a), d.parentFlushed && b.clientRenderedBoundaries.push(d)), d.fallbackAbortableTasks.forEach(function(a2) {
    return ed(a2, b, c);
  }), d.fallbackAbortableTasks.clear(), b.allPendingTasks--, 0 === b.allPendingTasks && (d = b.onAllReady, d()));
}
function ad(a, b) {
  if (0 === b.chunks.length && 1 === b.children.length && null === b.children[0].boundary) {
    var c = b.children[0];
    c.id = b.id;
    c.parentFlushed = true;
    1 === c.status && ad(a, c);
  } else
    a.completedSegments.push(b);
}
function dd(a, b, c) {
  if (null === b) {
    if (c.parentFlushed) {
      if (null !== a.completedRootSegment)
        throw Error(k(389));
      a.completedRootSegment = c;
    }
    a.pendingRootTasks--;
    0 === a.pendingRootTasks && (a.onShellError = X, b = a.onShellReady, b());
  } else
    b.pendingTasks--, b.forceClientRender || (0 === b.pendingTasks ? (c.parentFlushed && 1 === c.status && ad(b, c), b.parentFlushed && a.completedBoundaries.push(b), b.fallbackAbortableTasks.forEach(cd, a), b.fallbackAbortableTasks.clear()) : c.parentFlushed && 1 === c.status && (ad(b, c), 1 === b.completedSegments.length && b.parentFlushed && a.partialBoundaries.push(b)));
  a.allPendingTasks--;
  0 === a.allPendingTasks && (a = a.onAllReady, a());
}
function Uc(a) {
  if (2 !== a.status) {
    var b = O, c = Pc.current;
    Pc.current = Oc;
    var d = Nc;
    Nc = a.responseState;
    try {
      var f2 = a.pingedTasks, e;
      for (e = 0; e < f2.length; e++) {
        var g = f2[e];
        var h = a, m2 = g.blockedSegment;
        if (0 === m2.status) {
          Q(g.context);
          try {
            Z(h, g, g.node), m2.lastPushedText && m2.textEmbedded && m2.chunks.push(Ca), g.abortSet.delete(g), m2.status = 1, dd(h, g.blockedBoundary, m2);
          } catch (G2) {
            if (Gc(), "object" === typeof G2 && null !== G2 && "function" === typeof G2.then) {
              var q2 = g.ping;
              G2.then(q2, q2);
            } else {
              g.abortSet.delete(g);
              m2.status = 4;
              var r2 = g.blockedBoundary, v2 = G2, A2 = Y(h, v2);
              null === r2 ? Vc(h, v2) : (r2.pendingTasks--, r2.forceClientRender || (r2.forceClientRender = true, r2.errorDigest = A2, r2.parentFlushed && h.clientRenderedBoundaries.push(r2)));
              h.allPendingTasks--;
              if (0 === h.allPendingTasks) {
                var F2 = h.onAllReady;
                F2();
              }
            }
          } finally {
          }
        }
      }
      f2.splice(0, e);
      null !== a.destination && fd(a, a.destination);
    } catch (G2) {
      Y(a, G2), Vc(a, G2);
    } finally {
      Nc = d, Pc.current = c, c === Oc && Q(b);
    }
  }
}
function gd(a, b, c) {
  c.parentFlushed = true;
  switch (c.status) {
    case 0:
      var d = c.id = a.nextSegmentId++;
      c.lastPushedText = false;
      c.textEmbedded = false;
      a = a.responseState;
      p(b, Va);
      p(b, a.placeholderPrefix);
      a = u(d.toString(16));
      p(b, a);
      return t(b, Wa);
    case 1:
      c.status = 2;
      var f2 = true;
      d = c.chunks;
      var e = 0;
      c = c.children;
      for (var g = 0; g < c.length; g++) {
        for (f2 = c[g]; e < f2.index; e++)
          p(b, d[e]);
        f2 = hd(a, b, f2);
      }
      for (; e < d.length - 1; e++)
        p(b, d[e]);
      e < d.length && (f2 = t(b, d[e]));
      return f2;
    default:
      throw Error(k(390));
  }
}
function hd(a, b, c) {
  var d = c.boundary;
  if (null === d)
    return gd(a, b, c);
  d.parentFlushed = true;
  if (d.forceClientRender)
    d = d.errorDigest, t(b, $a), p(b, bb), d && (p(b, db), p(b, u(C(d))), p(b, cb)), t(b, eb), gd(a, b, c);
  else if (0 < d.pendingTasks) {
    d.rootSegmentID = a.nextSegmentId++;
    0 < d.completedSegments.length && a.partialBoundaries.push(d);
    var f2 = a.responseState;
    var e = f2.nextSuspenseID++;
    f2 = w(f2.boundaryPrefix + e.toString(16));
    d = d.id = f2;
    fb(b, a.responseState, d);
    gd(a, b, c);
  } else if (d.byteSize > a.progressiveChunkSize)
    d.rootSegmentID = a.nextSegmentId++, a.completedBoundaries.push(d), fb(b, a.responseState, d.id), gd(a, b, c);
  else {
    t(b, Xa);
    c = d.completedSegments;
    if (1 !== c.length)
      throw Error(k(391));
    hd(a, b, c[0]);
  }
  return t(b, ab);
}
function id(a, b, c) {
  Bb(b, a.responseState, c.formatContext, c.id);
  hd(a, b, c);
  return Cb(b, c.formatContext);
}
function jd(a, b, c) {
  for (var d = c.completedSegments, f2 = 0; f2 < d.length; f2++)
    kd(a, b, c, d[f2]);
  d.length = 0;
  a = a.responseState;
  d = c.id;
  c = c.rootSegmentID;
  p(b, a.startInlineScript);
  a.sentCompleteBoundaryFunction ? p(b, Jb) : (a.sentCompleteBoundaryFunction = true, p(b, Ib));
  if (null === d)
    throw Error(k(395));
  c = u(c.toString(16));
  p(b, d);
  p(b, Kb);
  p(b, a.segmentPrefix);
  p(b, c);
  return t(b, Lb);
}
function kd(a, b, c, d) {
  if (2 === d.status)
    return true;
  var f2 = d.id;
  if (-1 === f2) {
    if (-1 === (d.id = c.rootSegmentID))
      throw Error(k(392));
    return id(a, b, d);
  }
  id(a, b, d);
  a = a.responseState;
  p(b, a.startInlineScript);
  a.sentCompleteSegmentFunction ? p(b, Eb) : (a.sentCompleteSegmentFunction = true, p(b, Db));
  p(b, a.segmentPrefix);
  f2 = u(f2.toString(16));
  p(b, f2);
  p(b, Gb);
  p(b, a.placeholderPrefix);
  p(b, f2);
  return t(b, Hb);
}
function fd(a, b) {
  l$1 = new Uint8Array(512);
  n = 0;
  try {
    var c = a.completedRootSegment;
    if (null !== c && 0 === a.pendingRootTasks) {
      hd(a, b, c);
      a.completedRootSegment = null;
      var d = a.responseState.bootstrapChunks;
      for (c = 0; c < d.length - 1; c++)
        p(b, d[c]);
      c < d.length && t(b, d[c]);
    }
    var f2 = a.clientRenderedBoundaries, e;
    for (e = 0; e < f2.length; e++) {
      var g = f2[e];
      d = b;
      var h = a.responseState, m2 = g.id, q2 = g.errorDigest, r2 = g.errorMessage, v2 = g.errorComponentStack;
      p(d, h.startInlineScript);
      h.sentClientRenderFunction ? p(d, Nb) : (h.sentClientRenderFunction = true, p(
        d,
        Mb
      ));
      if (null === m2)
        throw Error(k(395));
      p(d, m2);
      p(d, Ob);
      if (q2 || r2 || v2)
        p(d, Qb), p(d, u(Sb(q2 || "")));
      if (r2 || v2)
        p(d, Qb), p(d, u(Sb(r2 || "")));
      v2 && (p(d, Qb), p(d, u(Sb(v2))));
      if (!t(d, Pb))
        ;
    }
    f2.splice(0, e);
    var A2 = a.completedBoundaries;
    for (e = 0; e < A2.length; e++)
      if (!jd(a, b, A2[e]))
        ;
    A2.splice(0, e);
    ba(b);
    l$1 = new Uint8Array(512);
    n = 0;
    var F2 = a.partialBoundaries;
    for (e = 0; e < F2.length; e++) {
      var G2 = F2[e];
      a: {
        f2 = a;
        g = b;
        var ma2 = G2.completedSegments;
        for (h = 0; h < ma2.length; h++)
          if (!kd(
            f2,
            g,
            G2,
            ma2[h]
          )) {
            h++;
            ma2.splice(0, h);
            var Fb2 = false;
            break a;
          }
        ma2.splice(0, h);
        Fb2 = true;
      }
      if (!Fb2) {
        a.destination = null;
        e++;
        F2.splice(0, e);
        return;
      }
    }
    F2.splice(0, e);
    var na2 = a.completedBoundaries;
    for (e = 0; e < na2.length; e++)
      if (!jd(a, b, na2[e]))
        ;
    na2.splice(0, e);
  } finally {
    ba(b), 0 === a.allPendingTasks && 0 === a.pingedTasks.length && 0 === a.clientRenderedBoundaries.length && 0 === a.completedBoundaries.length && b.close();
  }
}
function ld(a, b) {
  try {
    var c = a.abortableTasks;
    c.forEach(function(c2) {
      return ed(c2, a, b);
    });
    c.clear();
    null !== a.destination && fd(a, a.destination);
  } catch (d) {
    Y(a, d), Vc(a, d);
  }
}
reactDomServer_browser_production_min.renderToReadableStream = function(a, b) {
  return new Promise(function(c, d) {
    var f2, e, g = new Promise(function(a2, b2) {
      e = a2;
      f2 = b2;
    }), h = Rc(a, za(b ? b.identifierPrefix : void 0, b ? b.nonce : void 0, b ? b.bootstrapScriptContent : void 0, b ? b.bootstrapScripts : void 0, b ? b.bootstrapModules : void 0), Aa(b ? b.namespaceURI : void 0), b ? b.progressiveChunkSize : void 0, b ? b.onError : void 0, e, function() {
      var a2 = new ReadableStream({ type: "bytes", pull: function(a3) {
        if (1 === h.status)
          h.status = 2, da(a3, h.fatalError);
        else if (2 !== h.status && null === h.destination) {
          h.destination = a3;
          try {
            fd(h, a3);
          } catch (A2) {
            Y(h, A2), Vc(h, A2);
          }
        }
      }, cancel: function() {
        ld(h);
      } }, { highWaterMark: 0 });
      a2.allReady = g;
      c(a2);
    }, function(a2) {
      g.catch(function() {
      });
      d(a2);
    }, f2);
    if (b && b.signal) {
      var m2 = b.signal, q2 = function() {
        ld(h, m2.reason);
        m2.removeEventListener("abort", q2);
      };
      m2.addEventListener("abort", q2);
    }
    Uc(h);
  });
};
reactDomServer_browser_production_min.version = "18.2.0";
var l, s;
{
  l = reactDomServerLegacy_browser_production_min;
  s = reactDomServer_browser_production_min;
}
server_browser.version = l.version;
server_browser.renderToString = l.renderToString;
server_browser.renderToStaticMarkup = l.renderToStaticMarkup;
server_browser.renderToNodeStream = l.renderToNodeStream;
server_browser.renderToStaticNodeStream = l.renderToStaticNodeStream;
server_browser.renderToReadableStream = s.renderToReadableStream;
var keyGenerator = {};
Object.defineProperty(keyGenerator, "__esModule", { value: true });
var counter = 0;
function generateNewKey() {
  return "agPortalKey_" + ++counter;
}
keyGenerator.default = generateNewKey;
var __extends$3 = commonjsGlobal && commonjsGlobal.__extends || function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __importDefault$b = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(legacyReactComponent, "__esModule", { value: true });
legacyReactComponent.LegacyReactComponent = void 0;
var react_1$k = reactExports;
var react_dom_1$3 = reactDomExports;
var ag_grid_community_1$e = require$$0;
var reactComponent_1$1 = reactComponent;
var server_1$1 = server_browser;
var keyGenerator_1$1 = __importDefault$b(keyGenerator);
var LegacyReactComponent = (
  /** @class */
  function(_super) {
    __extends$3(LegacyReactComponent2, _super);
    function LegacyReactComponent2(reactComponent2, parentComponent, portalManager2, componentType) {
      var _this = _super.call(this, reactComponent2, portalManager2, componentType) || this;
      _this.staticMarkup = null;
      _this.staticRenderTime = 0;
      _this.parentComponent = parentComponent;
      return _this;
    }
    LegacyReactComponent2.prototype.init = function(params) {
      var _this = this;
      this.eParentElement = this.createParentElement(params);
      this.renderStaticMarkup(params);
      return new ag_grid_community_1$e.AgPromise(function(resolve2) {
        return _this.createReactComponent(params, resolve2);
      });
    };
    LegacyReactComponent2.prototype.createReactComponent = function(params, resolve2) {
      var _this = this;
      if (!this.isStatelessComponent()) {
        params.ref = function(element) {
          _this.componentInstance = element;
          _this.addParentContainerStyleAndClasses();
          _this.removeStaticMarkup();
        };
      }
      var reactComponent2 = react_1$k.createElement(this.reactComponent, params);
      var portal = react_dom_1$3.createPortal(
        reactComponent2,
        this.eParentElement,
        keyGenerator_1$1.default()
        // fixed deltaRowModeRefreshCompRenderer
      );
      this.portal = portal;
      this.portalManager.mountReactPortal(portal, this, function(value) {
        resolve2(value);
        if (_this.isStatelessComponent()) {
          if (_this.isSlowRenderer()) {
            _this.removeStaticMarkup();
          }
          setTimeout(function() {
            _this.removeStaticMarkup();
          });
        }
      });
    };
    LegacyReactComponent2.prototype.fallbackMethodAvailable = function(name) {
      return false;
    };
    LegacyReactComponent2.prototype.fallbackMethod = function(name, params) {
    };
    LegacyReactComponent2.prototype.isSlowRenderer = function() {
      return this.staticRenderTime >= LegacyReactComponent2.SLOW_RENDERING_THRESHOLD;
    };
    LegacyReactComponent2.prototype.isNullValue = function() {
      return this.staticMarkup === "";
    };
    LegacyReactComponent2.prototype.renderStaticMarkup = function(params) {
      if (this.parentComponent.isDisableStaticMarkup() || !this.componentType.cellRenderer) {
        return;
      }
      var originalConsoleError = console.error;
      var reactComponent2 = react_1$k.createElement(this.reactComponent, params);
      try {
        console.error = function() {
        };
        var start = Date.now();
        var staticMarkup = server_1$1.renderToStaticMarkup(reactComponent2);
        this.staticRenderTime = Date.now() - start;
        console.error = originalConsoleError;
        if (staticMarkup === "") {
          this.staticMarkup = staticMarkup;
        } else {
          if (staticMarkup) {
            this.staticMarkup = document.createElement("span");
            this.staticMarkup.innerHTML = staticMarkup;
            this.eParentElement.appendChild(this.staticMarkup);
          }
        }
      } catch (e) {
      } finally {
        console.error = originalConsoleError;
      }
    };
    LegacyReactComponent2.prototype.removeStaticMarkup = function() {
      if (this.parentComponent.isDisableStaticMarkup() || !this.componentType.cellRenderer) {
        return;
      }
      if (this.staticMarkup) {
        if (this.staticMarkup.remove) {
          this.staticMarkup.remove();
          this.staticMarkup = null;
        } else if (this.eParentElement.removeChild) {
          this.eParentElement.removeChild(this.staticMarkup);
          this.staticMarkup = null;
        }
      }
    };
    LegacyReactComponent2.prototype.rendered = function() {
      return this.isNullValue() || !!this.staticMarkup || this.isStatelessComponent() && this.statelessComponentRendered() || !!(!this.isStatelessComponent() && this.getFrameworkComponentInstance());
    };
    LegacyReactComponent2.SLOW_RENDERING_THRESHOLD = 3;
    return LegacyReactComponent2;
  }(reactComponent_1$1.ReactComponent)
);
legacyReactComponent.LegacyReactComponent = LegacyReactComponent;
var newReactComponent = {};
var __extends$2 = commonjsGlobal && commonjsGlobal.__extends || function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$8 = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign$8 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$8.apply(this, arguments);
};
var __importDefault$a = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(newReactComponent, "__esModule", { value: true });
newReactComponent.NewReactComponent = void 0;
var react_1$j = reactExports;
var react_dom_1$2 = reactDomExports;
var ag_grid_community_1$d = require$$0;
var reactComponent_1 = reactComponent;
var server_1 = server_browser;
var keyGenerator_1 = __importDefault$a(keyGenerator);
var NewReactComponent = (
  /** @class */
  function(_super) {
    __extends$2(NewReactComponent2, _super);
    function NewReactComponent2(reactComponent2, parentComponent, componentType) {
      var _this = _super.call(this, reactComponent2, parentComponent, componentType) || this;
      _this.oldPortal = null;
      _this.key = keyGenerator_1.default();
      _this.portalKey = keyGenerator_1.default();
      return _this;
    }
    NewReactComponent2.prototype.init = function(params) {
      var _this = this;
      this.eParentElement = this.createParentElement(params);
      this.params = params;
      this.createOrUpdatePortal(params);
      return new ag_grid_community_1$d.AgPromise(function(resolve2) {
        return _this.createReactComponent(resolve2);
      });
    };
    NewReactComponent2.prototype.createOrUpdatePortal = function(params) {
      var _this = this;
      if (!this.isStatelessComponent()) {
        params.ref = function(element) {
          _this.componentInstance = element;
          _this.addParentContainerStyleAndClasses();
        };
      }
      this.reactElement = react_1$j.createElement(this.reactComponent, __assign$8(__assign$8({}, params), { key: this.key }));
      this.portal = react_dom_1$2.createPortal(
        this.reactElement,
        this.eParentElement,
        this.portalKey
        // fixed deltaRowModeRefreshCompRenderer
      );
    };
    NewReactComponent2.prototype.createReactComponent = function(resolve2) {
      this.portalManager.mountReactPortal(this.portal, this, function(value) {
        resolve2(value);
      });
    };
    NewReactComponent2.prototype.isNullValue = function() {
      return this.valueRenderedIsNull(this.params);
    };
    NewReactComponent2.prototype.rendered = function() {
      return this.isStatelessComponent() && this.statelessComponentRendered() || !!(!this.isStatelessComponent() && this.getFrameworkComponentInstance());
    };
    NewReactComponent2.prototype.valueRenderedIsNull = function(params) {
      if (!this.componentType.cellRenderer) {
        return false;
      }
      var originalConsoleError = console.error;
      try {
        console.error = function() {
        };
        var staticMarkup = server_1.renderToStaticMarkup(react_1$j.createElement(this.reactComponent, params));
        return staticMarkup === "";
      } catch (ignore) {
      } finally {
        console.error = originalConsoleError;
      }
      return false;
    };
    NewReactComponent2.prototype.refreshComponent = function(args) {
      this.oldPortal = this.portal;
      this.createOrUpdatePortal(args);
      this.portalManager.updateReactPortal(this.oldPortal, this.portal);
    };
    NewReactComponent2.prototype.fallbackMethod = function(name, params) {
      var method = this[name + "Component"];
      if (!!method) {
        return method.bind(this)(params);
      }
    };
    NewReactComponent2.prototype.fallbackMethodAvailable = function(name) {
      var method = this[name + "Component"];
      return !!method;
    };
    return NewReactComponent2;
  }(reactComponent_1.ReactComponent)
);
newReactComponent.NewReactComponent = NewReactComponent;
var portalManager = {};
var __spreadArray$3 = commonjsGlobal && commonjsGlobal.__spreadArray || function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
Object.defineProperty(portalManager, "__esModule", { value: true });
portalManager.PortalManager = portalManager.LegacyPortalManager = void 0;
var LegacyPortalManager = (
  /** @class */
  function() {
    function LegacyPortalManager2(parent, wrappingElement, maxComponentCreationTimeMs) {
      this.destroyed = false;
      this.portals = [];
      this.hasPendingPortalUpdate = false;
      this.wrappingElement = wrappingElement ? wrappingElement : "div";
      this.parent = parent;
      this.maxComponentCreationTimeMs = maxComponentCreationTimeMs ? maxComponentCreationTimeMs : LegacyPortalManager2.MAX_COMPONENT_CREATION_TIME_IN_MS;
    }
    LegacyPortalManager2.prototype.getPortals = function() {
      return this.portals;
    };
    LegacyPortalManager2.prototype.destroy = function() {
      this.destroyed = true;
    };
    LegacyPortalManager2.prototype.destroyPortal = function(portal) {
      this.portals = this.portals.filter(function(curPortal) {
        return curPortal !== portal;
      });
      this.batchUpdate();
    };
    LegacyPortalManager2.prototype.getComponentWrappingElement = function() {
      return this.wrappingElement;
    };
    LegacyPortalManager2.prototype.mountReactPortal = function(portal, reactComponent2, resolve2) {
      this.portals = __spreadArray$3(__spreadArray$3([], this.portals), [portal]);
      this.waitForInstance(reactComponent2, resolve2);
      this.batchUpdate();
    };
    LegacyPortalManager2.prototype.updateReactPortal = function(oldPortal, newPortal) {
      this.portals[this.portals.indexOf(oldPortal)] = newPortal;
      this.batchUpdate();
    };
    LegacyPortalManager2.prototype.batchUpdate = function() {
      var _this = this;
      if (this.hasPendingPortalUpdate) {
        return;
      }
      setTimeout(function() {
        if (!_this.destroyed) {
          _this.parent.forceUpdate(function() {
            _this.hasPendingPortalUpdate = false;
          });
        }
      });
      this.hasPendingPortalUpdate = true;
    };
    LegacyPortalManager2.prototype.waitForInstance = function(reactComponent2, resolve2, startTime) {
      var _this = this;
      if (startTime === void 0) {
        startTime = Date.now();
      }
      if (this.destroyed) {
        resolve2(null);
        return;
      }
      if (reactComponent2.rendered()) {
        resolve2(reactComponent2);
      } else {
        if (Date.now() - startTime >= this.maxComponentCreationTimeMs && !this.hasPendingPortalUpdate) {
          if (reactComponent2.isNullValue()) {
            resolve2(reactComponent2);
            return;
          }
          console.error("AG Grid: React Component '" + reactComponent2.getReactComponentName() + "' not created within " + this.maxComponentCreationTimeMs + "ms");
          return;
        }
        window.setTimeout(function() {
          _this.waitForInstance(reactComponent2, resolve2, startTime);
        });
      }
    };
    LegacyPortalManager2.MAX_COMPONENT_CREATION_TIME_IN_MS = 1e3;
    return LegacyPortalManager2;
  }()
);
portalManager.LegacyPortalManager = LegacyPortalManager;
var PortalManager = (
  /** @class */
  function() {
    function PortalManager2(refresher, wrappingElement, maxComponentCreationTimeMs) {
      this.destroyed = false;
      this.portals = [];
      this.hasPendingPortalUpdate = false;
      this.wrappingElement = wrappingElement ? wrappingElement : "div";
      this.refresher = refresher;
      this.maxComponentCreationTimeMs = maxComponentCreationTimeMs ? maxComponentCreationTimeMs : PortalManager2.MAX_COMPONENT_CREATION_TIME_IN_MS;
    }
    PortalManager2.prototype.getPortals = function() {
      return this.portals;
    };
    PortalManager2.prototype.destroy = function() {
      this.destroyed = true;
    };
    PortalManager2.prototype.destroyPortal = function(portal) {
      this.portals = this.portals.filter(function(curPortal) {
        return curPortal !== portal;
      });
      this.batchUpdate();
    };
    PortalManager2.prototype.getComponentWrappingElement = function() {
      return this.wrappingElement;
    };
    PortalManager2.prototype.mountReactPortal = function(portal, reactComponent2, resolve2) {
      this.portals = __spreadArray$3(__spreadArray$3([], this.portals), [portal]);
      this.waitForInstance(reactComponent2, resolve2);
      this.batchUpdate();
    };
    PortalManager2.prototype.updateReactPortal = function(oldPortal, newPortal) {
      this.portals[this.portals.indexOf(oldPortal)] = newPortal;
      this.batchUpdate();
    };
    PortalManager2.prototype.batchUpdate = function() {
      var _this = this;
      if (this.hasPendingPortalUpdate) {
        return;
      }
      setTimeout(function() {
        if (!_this.destroyed) {
          _this.refresher();
          _this.hasPendingPortalUpdate = false;
        }
      });
      this.hasPendingPortalUpdate = true;
    };
    PortalManager2.prototype.waitForInstance = function(reactComponent2, resolve2, startTime) {
      var _this = this;
      if (startTime === void 0) {
        startTime = Date.now();
      }
      if (this.destroyed) {
        resolve2(null);
        return;
      }
      if (reactComponent2.rendered()) {
        resolve2(reactComponent2);
      } else {
        if (Date.now() - startTime >= this.maxComponentCreationTimeMs && !this.hasPendingPortalUpdate) {
          if (reactComponent2.isNullValue()) {
            resolve2(reactComponent2);
            return;
          }
          console.error("AG Grid: React Component '" + reactComponent2.getReactComponentName() + "' not created within " + this.maxComponentCreationTimeMs + "ms");
          return;
        }
        window.setTimeout(function() {
          _this.waitForInstance(reactComponent2, resolve2, startTime);
        });
      }
    };
    PortalManager2.MAX_COMPONENT_CREATION_TIME_IN_MS = 1e3;
    return PortalManager2;
  }()
);
portalManager.PortalManager = PortalManager;
var reactFrameworkOverrides = {};
var groupCellRenderer = {};
var beansContext = {};
var __importDefault$9 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(beansContext, "__esModule", { value: true });
beansContext.BeansContext = void 0;
var react_1$i = __importDefault$9(reactExports);
beansContext.BeansContext = react_1$i.default.createContext({});
var jsComp = {};
Object.defineProperty(jsComp, "__esModule", { value: true });
jsComp.createSyncJsComp = jsComp.showJsComp = void 0;
var showJsComp = function(compDetails, context, eParent, ref) {
  var doNothing = !compDetails || compDetails.componentFromFramework || context.isDestroyed();
  if (doNothing) {
    return;
  }
  var promise = compDetails.newAgStackInstance();
  if (!promise) {
    return;
  }
  var comp;
  var compGui;
  var destroyed = false;
  promise.then(function(c) {
    if (destroyed) {
      context.destroyBean(c);
      return;
    }
    comp = c;
    compGui = comp.getGui();
    eParent.appendChild(compGui);
    setRef(ref, comp);
  });
  return function() {
    destroyed = true;
    if (!comp) {
      return;
    }
    if (compGui && compGui.parentElement) {
      compGui.parentElement.removeChild(compGui);
    }
    context.destroyBean(comp);
    if (ref) {
      setRef(ref, void 0);
    }
  };
};
jsComp.showJsComp = showJsComp;
var setRef = function(ref, value) {
  if (!ref) {
    return;
  }
  if (ref instanceof Function) {
    var refCallback = ref;
    refCallback(value);
  } else {
    var refObj = ref;
    refObj.current = value;
  }
};
var createSyncJsComp = function(compDetails) {
  var promise = compDetails.newAgStackInstance();
  if (!promise) {
    return;
  }
  return promise.resolveNow(null, function(x2) {
    return x2;
  });
};
jsComp.createSyncJsComp = createSyncJsComp;
var useEffectOnce$1 = {};
Object.defineProperty(useEffectOnce$1, "__esModule", { value: true });
useEffectOnce$1.useLayoutEffectOnce = useEffectOnce$1.useEffectOnce = void 0;
var react_1$h = reactExports;
var useEffectOnce = function(effect) {
  var effectFn = react_1$h.useRef(effect);
  var destroyFn = react_1$h.useRef();
  var effectCalled = react_1$h.useRef(false);
  var rendered = react_1$h.useRef(false);
  var _a2 = react_1$h.useState(0), setVal = _a2[1];
  if (effectCalled.current) {
    rendered.current = true;
  }
  react_1$h.useEffect(function() {
    if (!effectCalled.current) {
      destroyFn.current = effectFn.current();
      effectCalled.current = true;
    }
    setVal(function(val) {
      return val + 1;
    });
    return function() {
      if (!rendered.current) {
        return;
      }
      if (destroyFn.current) {
        destroyFn.current();
      }
    };
  }, []);
};
useEffectOnce$1.useEffectOnce = useEffectOnce;
var useLayoutEffectOnce = function(effect) {
  var effectFn = react_1$h.useRef(effect);
  var destroyFn = react_1$h.useRef();
  var effectCalled = react_1$h.useRef(false);
  var rendered = react_1$h.useRef(false);
  var _a2 = react_1$h.useState(0), setVal = _a2[1];
  if (effectCalled.current) {
    rendered.current = true;
  }
  react_1$h.useLayoutEffect(function() {
    if (!effectCalled.current) {
      destroyFn.current = effectFn.current();
      effectCalled.current = true;
    }
    setVal(function(val) {
      return val + 1;
    });
    return function() {
      if (!rendered.current) {
        return;
      }
      if (destroyFn.current) {
        destroyFn.current();
      }
    };
  }, []);
};
useEffectOnce$1.useLayoutEffectOnce = useLayoutEffectOnce;
var utils = {};
var __assign$7 = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign$7 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$7.apply(this, arguments);
};
var __importDefault$8 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(utils, "__esModule", { value: true });
utils.agFlushSync = utils.isComponentStateless = utils.CssClasses = utils.classesList = void 0;
var react_dom_1$1 = __importDefault$8(reactDomExports);
var classesList = function() {
  var list = [];
  for (var _i = 0; _i < arguments.length; _i++) {
    list[_i] = arguments[_i];
  }
  var filtered = list.filter(function(s2) {
    return s2 != null && s2 !== "";
  });
  return filtered.join(" ");
};
utils.classesList = classesList;
var CssClasses = (
  /** @class */
  function() {
    function CssClasses2() {
      var _this = this;
      var initialClasses = [];
      for (var _i = 0; _i < arguments.length; _i++) {
        initialClasses[_i] = arguments[_i];
      }
      this.classesMap = {};
      initialClasses.forEach(function(className) {
        _this.classesMap[className] = true;
      });
    }
    CssClasses2.prototype.setClass = function(className, on) {
      var nothingHasChanged = !!this.classesMap[className] == on;
      if (nothingHasChanged) {
        return this;
      }
      var res = new CssClasses2();
      res.classesMap = __assign$7({}, this.classesMap);
      res.classesMap[className] = on;
      return res;
    };
    CssClasses2.prototype.toString = function() {
      var _this = this;
      var res = Object.keys(this.classesMap).filter(function(key) {
        return _this.classesMap[key];
      }).join(" ");
      return res;
    };
    return CssClasses2;
  }()
);
utils.CssClasses = CssClasses;
var isComponentStateless = function(Component2) {
  var hasSymbol = function() {
    return typeof Symbol === "function" && Symbol.for;
  };
  var getMemoType = function() {
    return hasSymbol() ? Symbol.for("react.memo") : 60115;
  };
  return typeof Component2 === "function" && !(Component2.prototype && Component2.prototype.isReactComponent) || typeof Component2 === "object" && Component2.$$typeof === getMemoType();
};
utils.isComponentStateless = isComponentStateless;
var createRootAndFlushSyncAvailable = react_dom_1$1.default.createRoot != null && react_dom_1$1.default.flushSync != null;
var agFlushSync = function(useFlushSync, fn) {
  if (createRootAndFlushSyncAvailable && useFlushSync) {
    react_dom_1$1.default.flushSync(fn);
  } else {
    fn();
  }
};
utils.agFlushSync = agFlushSync;
var __assign$6 = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign$6 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$6.apply(this, arguments);
};
var __createBinding$e = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$e = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$e = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$e(result, mod2, k2);
  }
  __setModuleDefault$e(result, mod2);
  return result;
};
Object.defineProperty(groupCellRenderer, "__esModule", { value: true });
var ag_grid_community_1$c = require$$0;
var react_1$g = __importStar$e(reactExports);
var beansContext_1$d = beansContext;
var jsComp_1$4 = jsComp;
var useEffectOnce_1$c = useEffectOnce$1;
var utils_1$9 = utils;
var GroupCellRenderer = react_1$g.forwardRef(function(props, ref) {
  var context = react_1$g.useContext(beansContext_1$d.BeansContext).context;
  var eGui = react_1$g.useRef(null);
  var eValueRef = react_1$g.useRef(null);
  var eCheckboxRef = react_1$g.useRef(null);
  var eExpandedRef = react_1$g.useRef(null);
  var eContractedRef = react_1$g.useRef(null);
  var _a2 = react_1$g.useState(), innerCompDetails = _a2[0], setInnerCompDetails = _a2[1];
  var _b2 = react_1$g.useState(), childCount = _b2[0], setChildCount = _b2[1];
  var _c = react_1$g.useState(), value = _c[0], setValue = _c[1];
  var _d = react_1$g.useState(new utils_1$9.CssClasses()), cssClasses = _d[0], setCssClasses = _d[1];
  var _e = react_1$g.useState(new utils_1$9.CssClasses("ag-hidden")), expandedCssClasses = _e[0], setExpandedCssClasses = _e[1];
  var _f = react_1$g.useState(new utils_1$9.CssClasses("ag-hidden")), contractedCssClasses = _f[0], setContractedCssClasses = _f[1];
  var _g = react_1$g.useState(new utils_1$9.CssClasses("ag-invisible")), checkboxCssClasses = _g[0], setCheckboxCssClasses = _g[1];
  react_1$g.useImperativeHandle(ref, function() {
    return {
      // force new instance when grid tries to refresh
      refresh: function() {
        return false;
      }
    };
  });
  react_1$g.useLayoutEffect(function() {
    return jsComp_1$4.showJsComp(innerCompDetails, context, eValueRef.current);
  }, [innerCompDetails]);
  useEffectOnce_1$c.useLayoutEffectOnce(function() {
    var compProxy = {
      setInnerRenderer: function(details, valueToDisplay) {
        setInnerCompDetails(details);
        setValue(valueToDisplay);
      },
      setChildCount: function(count) {
        return setChildCount(count);
      },
      addOrRemoveCssClass: function(name, on) {
        return setCssClasses(function(prev) {
          return prev.setClass(name, on);
        });
      },
      setContractedDisplayed: function(displayed) {
        return setContractedCssClasses(function(prev) {
          return prev.setClass("ag-hidden", !displayed);
        });
      },
      setExpandedDisplayed: function(displayed) {
        return setExpandedCssClasses(function(prev) {
          return prev.setClass("ag-hidden", !displayed);
        });
      },
      setCheckboxVisible: function(visible) {
        return setCheckboxCssClasses(function(prev) {
          return prev.setClass("ag-invisible", !visible);
        });
      }
    };
    var ctrl = context.createBean(new ag_grid_community_1$c.GroupCellRendererCtrl());
    ctrl.init(compProxy, eGui.current, eCheckboxRef.current, eExpandedRef.current, eContractedRef.current, GroupCellRenderer, props);
    return function() {
      context.destroyBean(ctrl);
    };
  });
  var className = react_1$g.useMemo(function() {
    return "ag-cell-wrapper " + cssClasses.toString();
  }, [cssClasses]);
  var expandedClassName = react_1$g.useMemo(function() {
    return "ag-group-expanded " + expandedCssClasses.toString();
  }, [expandedCssClasses]);
  var contractedClassName = react_1$g.useMemo(function() {
    return "ag-group-contracted " + contractedCssClasses.toString();
  }, [contractedCssClasses]);
  var checkboxClassName = react_1$g.useMemo(function() {
    return "ag-group-checkbox " + checkboxCssClasses.toString();
  }, [checkboxCssClasses]);
  var useFwRenderer = innerCompDetails && innerCompDetails.componentFromFramework;
  var FwRenderer = useFwRenderer ? innerCompDetails.componentClass : void 0;
  var useValue = innerCompDetails == null && value != null;
  var escapedValue = ag_grid_community_1$c._.escapeString(value, true);
  return react_1$g.default.createElement(
    "span",
    __assign$6({ className, ref: eGui }, !props.colDef ? { role: "gridcell" } : {}),
    react_1$g.default.createElement("span", { className: expandedClassName, ref: eExpandedRef }),
    react_1$g.default.createElement("span", { className: contractedClassName, ref: eContractedRef }),
    react_1$g.default.createElement("span", { className: checkboxClassName, ref: eCheckboxRef }),
    react_1$g.default.createElement(
      "span",
      { className: "ag-group-value", ref: eValueRef },
      useValue && react_1$g.default.createElement(react_1$g.default.Fragment, null, escapedValue),
      useFwRenderer && react_1$g.default.createElement(FwRenderer, __assign$6({}, innerCompDetails.params))
    ),
    react_1$g.default.createElement("span", { className: "ag-group-child-count" }, childCount)
  );
});
groupCellRenderer.default = GroupCellRenderer;
var detailCellRenderer = {};
var agGridReactUi = {};
var gridComp = {};
var gridBodyComp = {};
var gridHeaderComp = {};
var headerRowContainerComp = {};
var headerRowComp = {};
var headerCellComp = {};
var __assign$5 = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign$5 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$5.apply(this, arguments);
};
var __createBinding$d = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$d = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$d = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$d(result, mod2, k2);
  }
  __setModuleDefault$d(result, mod2);
  return result;
};
Object.defineProperty(headerCellComp, "__esModule", { value: true });
var react_1$f = __importStar$d(reactExports);
var beansContext_1$c = beansContext;
var ag_grid_community_1$b = require$$0;
var utils_1$8 = utils;
var jsComp_1$3 = jsComp;
var useEffectOnce_1$b = useEffectOnce$1;
var HeaderCellComp = function(props) {
  var context = react_1$f.useContext(beansContext_1$c.BeansContext).context;
  var _a2 = react_1$f.useState(), title = _a2[0], setTitle = _a2[1];
  var _b2 = react_1$f.useState(), colId = _b2[0], setColId = _b2[1];
  var _c = react_1$f.useState(), ariaSort = _c[0], setAriaSort2 = _c[1];
  var _d = react_1$f.useState(), ariaDescription = _d[0], setAriaDescription2 = _d[1];
  var _e = react_1$f.useState(), userCompDetails = _e[0], setUserCompDetails = _e[1];
  var eGui = react_1$f.useRef(null);
  var eResize = react_1$f.useRef(null);
  var eHeaderCompWrapper = react_1$f.useRef(null);
  var userCompRef = react_1$f.useRef();
  var ctrl = props.ctrl;
  var cssClassManager = react_1$f.useMemo(function() {
    return new ag_grid_community_1$b.CssClassManager(function() {
      return eGui.current;
    });
  }, []);
  useEffectOnce_1$b.useLayoutEffectOnce(function() {
    var _a3;
    var compProxy = {
      setWidth: function(width) {
        if (eGui.current) {
          eGui.current.style.width = width;
        }
      },
      addOrRemoveCssClass: function(name, on) {
        return cssClassManager.addOrRemoveCssClass(name, on);
      },
      setColId: function(id2) {
        return setColId(id2);
      },
      setTitle: function(title2) {
        return setTitle(title2);
      },
      setAriaDescription: function(description) {
        return setAriaDescription2(description);
      },
      setAriaSort: function(sort) {
        return setAriaSort2(sort);
      },
      setUserCompDetails: function(compDetails) {
        return setUserCompDetails(compDetails);
      },
      getUserCompInstance: function() {
        return userCompRef.current || void 0;
      }
    };
    ctrl.setComp(compProxy, eGui.current, eResize.current, eHeaderCompWrapper.current);
    var selectAllGui = ctrl.getSelectAllGui();
    (_a3 = eResize.current) === null || _a3 === void 0 ? void 0 : _a3.insertAdjacentElement("afterend", selectAllGui);
  });
  react_1$f.useLayoutEffect(function() {
    return jsComp_1$3.showJsComp(userCompDetails, context, eHeaderCompWrapper.current, userCompRef);
  }, [userCompDetails]);
  react_1$f.useEffect(function() {
    ctrl.setDragSource(eGui.current);
  }, [userCompDetails]);
  var userCompStateless = react_1$f.useMemo(function() {
    var res = (userCompDetails === null || userCompDetails === void 0 ? void 0 : userCompDetails.componentFromFramework) && utils_1$8.isComponentStateless(userCompDetails.componentClass);
    return !!res;
  }, [userCompDetails]);
  var reactUserComp = userCompDetails && userCompDetails.componentFromFramework;
  var UserCompClass = userCompDetails && userCompDetails.componentClass;
  return react_1$f.default.createElement(
    "div",
    { ref: eGui, className: "ag-header-cell", title, "col-id": colId, "aria-sort": ariaSort, role: "columnheader", tabIndex: -1, "aria-description": ariaDescription },
    react_1$f.default.createElement("div", { ref: eResize, className: "ag-header-cell-resize", role: "presentation" }),
    react_1$f.default.createElement(
      "div",
      { ref: eHeaderCompWrapper, className: "ag-header-cell-comp-wrapper", role: "presentation" },
      reactUserComp && userCompStateless && react_1$f.default.createElement(UserCompClass, __assign$5({}, userCompDetails.params)),
      reactUserComp && !userCompStateless && react_1$f.default.createElement(UserCompClass, __assign$5({}, userCompDetails.params, { ref: userCompRef }))
    )
  );
};
headerCellComp.default = react_1$f.memo(HeaderCellComp);
var headerGroupCellComp = {};
var __assign$4 = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign$4 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$4.apply(this, arguments);
};
var __createBinding$c = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$c = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$c = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$c(result, mod2, k2);
  }
  __setModuleDefault$c(result, mod2);
  return result;
};
Object.defineProperty(headerGroupCellComp, "__esModule", { value: true });
var react_1$e = __importStar$c(reactExports);
var beansContext_1$b = beansContext;
var jsComp_1$2 = jsComp;
var useEffectOnce_1$a = useEffectOnce$1;
var utils_1$7 = utils;
var HeaderGroupCellComp = function(props) {
  var context = react_1$e.useContext(beansContext_1$b.BeansContext).context;
  var _a2 = react_1$e.useState(new utils_1$7.CssClasses()), cssClasses = _a2[0], setCssClasses = _a2[1];
  var _b2 = react_1$e.useState(new utils_1$7.CssClasses()), cssResizableClasses = _b2[0], setResizableCssClasses = _b2[1];
  var _c = react_1$e.useState("false"), resizableAriaHidden = _c[0], setResizableAriaHidden = _c[1];
  var _d = react_1$e.useState(), title = _d[0], setTitle = _d[1];
  var _e = react_1$e.useState(), colId = _e[0], setColId = _e[1];
  var _f = react_1$e.useState(), ariaExpanded = _f[0], setAriaExpanded2 = _f[1];
  var _g = react_1$e.useState(), userCompDetails = _g[0], setUserCompDetails = _g[1];
  var eGui = react_1$e.useRef(null);
  var eResize = react_1$e.useRef(null);
  var ctrl = props.ctrl;
  useEffectOnce_1$a.useLayoutEffectOnce(function() {
    var compProxy = {
      setWidth: function(width) {
        if (eGui.current) {
          eGui.current.style.width = width;
        }
      },
      addOrRemoveCssClass: function(name, on) {
        return setCssClasses(function(prev) {
          return prev.setClass(name, on);
        });
      },
      setColId: function(id2) {
        return setColId(id2);
      },
      setTitle: function(title2) {
        return setTitle(title2);
      },
      setUserCompDetails: function(compDetails) {
        return setUserCompDetails(compDetails);
      },
      setResizableDisplayed: function(displayed) {
        setResizableCssClasses(function(prev) {
          return prev.setClass("ag-hidden", !displayed);
        });
        setResizableAriaHidden(!displayed ? "true" : "false");
      },
      setAriaExpanded: function(expanded) {
        return setAriaExpanded2(expanded);
      }
    };
    ctrl.setComp(compProxy, eGui.current, eResize.current);
  });
  react_1$e.useLayoutEffect(function() {
    return jsComp_1$2.showJsComp(userCompDetails, context, eGui.current);
  }, [userCompDetails]);
  react_1$e.useEffect(function() {
    if (eGui.current) {
      ctrl.setDragSource(eGui.current);
    }
  }, [userCompDetails]);
  var className = react_1$e.useMemo(function() {
    return "ag-header-group-cell " + cssClasses.toString();
  }, [cssClasses]);
  var resizableClassName = react_1$e.useMemo(function() {
    return "ag-header-cell-resize " + cssResizableClasses.toString();
  }, [cssResizableClasses]);
  var reactUserComp = userCompDetails && userCompDetails.componentFromFramework;
  var UserCompClass = userCompDetails && userCompDetails.componentClass;
  return react_1$e.default.createElement(
    "div",
    { ref: eGui, className, title, "col-id": colId, role: "columnheader", tabIndex: -1, "aria-expanded": ariaExpanded },
    reactUserComp && react_1$e.default.createElement(UserCompClass, __assign$4({}, userCompDetails.params)),
    react_1$e.default.createElement("div", { ref: eResize, "aria-hidden": resizableAriaHidden, className: resizableClassName })
  );
};
headerGroupCellComp.default = react_1$e.memo(HeaderGroupCellComp);
var headerFilterCellComp = {};
var __assign$3 = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign$3 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$3.apply(this, arguments);
};
var __createBinding$b = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$b = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$b = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$b(result, mod2, k2);
  }
  __setModuleDefault$b(result, mod2);
  return result;
};
Object.defineProperty(headerFilterCellComp, "__esModule", { value: true });
var react_1$d = __importStar$b(reactExports);
var beansContext_1$a = beansContext;
var ag_grid_community_1$a = require$$0;
var utils_1$6 = utils;
var jsComp_1$1 = jsComp;
var useEffectOnce_1$9 = useEffectOnce$1;
var HeaderFilterCellComp = function(props) {
  var context = react_1$d.useContext(beansContext_1$a.BeansContext).context;
  var _a2 = react_1$d.useState(new utils_1$6.CssClasses("ag-header-cell", "ag-floating-filter")), cssClasses = _a2[0], setCssClasses = _a2[1];
  var _b2 = react_1$d.useState(new utils_1$6.CssClasses()), cssBodyClasses = _b2[0], setBodyCssClasses = _b2[1];
  var _c = react_1$d.useState(new utils_1$6.CssClasses("ag-floating-filter-button", "ag-hidden")), cssButtonWrapperClasses = _c[0], setButtonWrapperCssClasses = _c[1];
  var _d = react_1$d.useState("false"), buttonWrapperAriaHidden = _d[0], setButtonWrapperAriaHidden = _d[1];
  var _e = react_1$d.useState(), userCompDetails = _e[0], setUserCompDetails = _e[1];
  var eGui = react_1$d.useRef(null);
  var eFloatingFilterBody = react_1$d.useRef(null);
  var eButtonWrapper = react_1$d.useRef(null);
  var eButtonShowMainFilter = react_1$d.useRef(null);
  var userCompResolve = react_1$d.useRef();
  var userCompPromise = react_1$d.useRef();
  var userCompRef = function(value) {
    if (value == null) {
      return;
    }
    userCompResolve.current && userCompResolve.current(value);
  };
  var ctrl = props.ctrl;
  useEffectOnce_1$9.useLayoutEffectOnce(function() {
    userCompPromise.current = new ag_grid_community_1$a.AgPromise(function(resolve2) {
      userCompResolve.current = resolve2;
    });
    var compProxy = {
      addOrRemoveCssClass: function(name, on) {
        return setCssClasses(function(prev) {
          return prev.setClass(name, on);
        });
      },
      addOrRemoveBodyCssClass: function(name, on) {
        return setBodyCssClasses(function(prev) {
          return prev.setClass(name, on);
        });
      },
      setButtonWrapperDisplayed: function(displayed) {
        setButtonWrapperCssClasses(function(prev) {
          return prev.setClass("ag-hidden", !displayed);
        });
        setButtonWrapperAriaHidden(!displayed ? "true" : "false");
      },
      setWidth: function(width) {
        if (eGui.current) {
          eGui.current.style.width = width;
        }
      },
      setCompDetails: function(compDetails) {
        return setUserCompDetails(compDetails);
      },
      getFloatingFilterComp: function() {
        return userCompPromise.current ? userCompPromise.current : null;
      },
      setMenuIcon: function(eIcon) {
        var _a3;
        return (_a3 = eButtonShowMainFilter.current) === null || _a3 === void 0 ? void 0 : _a3.appendChild(eIcon);
      }
    };
    ctrl.setComp(compProxy, eGui.current, eButtonShowMainFilter.current, eFloatingFilterBody.current);
  });
  react_1$d.useLayoutEffect(function() {
    return jsComp_1$1.showJsComp(userCompDetails, context, eFloatingFilterBody.current, userCompRef);
  }, [userCompDetails]);
  var className = react_1$d.useMemo(function() {
    return cssClasses.toString();
  }, [cssClasses]);
  var bodyClassName = react_1$d.useMemo(function() {
    return cssBodyClasses.toString();
  }, [cssBodyClasses]);
  var buttonWrapperClassName = react_1$d.useMemo(function() {
    return cssButtonWrapperClasses.toString();
  }, [cssButtonWrapperClasses]);
  var userCompStateless = react_1$d.useMemo(function() {
    var res = userCompDetails && userCompDetails.componentFromFramework && utils_1$6.isComponentStateless(userCompDetails.componentClass);
    return !!res;
  }, [userCompDetails]);
  var reactUserComp = userCompDetails && userCompDetails.componentFromFramework;
  var UserCompClass = userCompDetails && userCompDetails.componentClass;
  return react_1$d.default.createElement(
    "div",
    { ref: eGui, className, role: "gridcell", tabIndex: -1 },
    react_1$d.default.createElement(
      "div",
      { ref: eFloatingFilterBody, className: bodyClassName, role: "presentation" },
      reactUserComp && userCompStateless && react_1$d.default.createElement(UserCompClass, __assign$3({}, userCompDetails.params)),
      reactUserComp && !userCompStateless && react_1$d.default.createElement(UserCompClass, __assign$3({}, userCompDetails.params, { ref: userCompRef }))
    ),
    react_1$d.default.createElement(
      "div",
      { ref: eButtonWrapper, "aria-hidden": buttonWrapperAriaHidden, className: buttonWrapperClassName, role: "presentation" },
      react_1$d.default.createElement("button", { ref: eButtonShowMainFilter, type: "button", className: "ag-button ag-floating-filter-button-button", tabIndex: -1 })
    )
  );
};
headerFilterCellComp.default = react_1$d.memo(HeaderFilterCellComp);
var __createBinding$a = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$a = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$a = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$a(result, mod2, k2);
  }
  __setModuleDefault$a(result, mod2);
  return result;
};
var __spreadArray$2 = commonjsGlobal && commonjsGlobal.__spreadArray || function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var __importDefault$7 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(headerRowComp, "__esModule", { value: true });
var ag_grid_community_1$9 = require$$0;
var react_1$c = __importStar$a(reactExports);
var beansContext_1$9 = beansContext;
var headerCellComp_1 = __importDefault$7(headerCellComp);
var headerGroupCellComp_1 = __importDefault$7(headerGroupCellComp);
var headerFilterCellComp_1 = __importDefault$7(headerFilterCellComp);
var useEffectOnce_1$8 = useEffectOnce$1;
var HeaderRowComp = function(props) {
  var gridOptionsService = react_1$c.useContext(beansContext_1$9.BeansContext).gridOptionsService;
  var _a2 = react_1$c.useState(), transform = _a2[0], setTransform = _a2[1];
  var _b2 = react_1$c.useState(), height = _b2[0], setHeight = _b2[1];
  var _c = react_1$c.useState(), top = _c[0], setTop = _c[1];
  var _d = react_1$c.useState(), ariaRowIndex = _d[0], setAriaRowIndex2 = _d[1];
  var _e = react_1$c.useState([]), cellCtrls = _e[0], setCellCtrls = _e[1];
  var eGui = react_1$c.useRef(null);
  var ctrl = props.ctrl;
  var typeColumn = ctrl.getType() === ag_grid_community_1$9.HeaderRowType.COLUMN;
  var typeGroup = ctrl.getType() === ag_grid_community_1$9.HeaderRowType.COLUMN_GROUP;
  var typeFilter = ctrl.getType() === ag_grid_community_1$9.HeaderRowType.FLOATING_FILTER;
  var setCellCtrlsMaintainOrder = react_1$c.useCallback(function(prev, next) {
    var isEnsureDomOrder = gridOptionsService.is("ensureDomOrder");
    var isPrintLayout = gridOptionsService.isDomLayout("print");
    if (isEnsureDomOrder || isPrintLayout) {
      return next;
    }
    var prevMap = ag_grid_community_1$9._.mapById(prev, function(c) {
      return c.getInstanceId();
    });
    var nextMap = ag_grid_community_1$9._.mapById(next, function(c) {
      return c.getInstanceId();
    });
    var oldCtrlsWeAreKeeping = prev.filter(function(c) {
      return nextMap.has(c.getInstanceId());
    });
    var newCtrls = next.filter(function(c) {
      return !prevMap.has(c.getInstanceId());
    });
    return __spreadArray$2(__spreadArray$2([], oldCtrlsWeAreKeeping), newCtrls);
  }, []);
  useEffectOnce_1$8.useLayoutEffectOnce(function() {
    var compProxy = {
      setTransform: function(transform2) {
        return setTransform(transform2);
      },
      setHeight: function(height2) {
        return setHeight(height2);
      },
      setTop: function(top2) {
        return setTop(top2);
      },
      setHeaderCtrls: function(ctrls) {
        return setCellCtrls(function(prev) {
          return setCellCtrlsMaintainOrder(prev, ctrls);
        });
      },
      setWidth: function(width) {
        if (eGui.current) {
          eGui.current.style.width = width;
        }
      },
      setAriaRowIndex: function(rowIndex) {
        return setAriaRowIndex2(rowIndex);
      }
    };
    ctrl.setComp(compProxy);
  });
  var style2 = react_1$c.useMemo(function() {
    return {
      transform,
      height,
      top
    };
  }, [transform, height, top]);
  var className = react_1$c.useMemo(function() {
    var res = ["ag-header-row"];
    typeColumn && res.push("ag-header-row-column");
    typeGroup && res.push("ag-header-row-column-group");
    typeFilter && res.push("ag-header-row-column-filter");
    return res.join(" ");
  }, []);
  var createCellJsx = react_1$c.useCallback(function(cellCtrl) {
    switch (ctrl.getType()) {
      case ag_grid_community_1$9.HeaderRowType.COLUMN_GROUP:
        return react_1$c.default.createElement(headerGroupCellComp_1.default, { ctrl: cellCtrl, key: cellCtrl.getInstanceId() });
      case ag_grid_community_1$9.HeaderRowType.FLOATING_FILTER:
        return react_1$c.default.createElement(headerFilterCellComp_1.default, { ctrl: cellCtrl, key: cellCtrl.getInstanceId() });
      default:
        return react_1$c.default.createElement(headerCellComp_1.default, { ctrl: cellCtrl, key: cellCtrl.getInstanceId() });
    }
  }, []);
  return react_1$c.default.createElement("div", { ref: eGui, className, role: "row", style: style2, "aria-rowindex": ariaRowIndex }, cellCtrls.map(createCellJsx));
};
headerRowComp.default = react_1$c.memo(HeaderRowComp);
var __createBinding$9 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$9 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$9 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$9(result, mod2, k2);
  }
  __setModuleDefault$9(result, mod2);
  return result;
};
var __importDefault$6 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(headerRowContainerComp, "__esModule", { value: true });
var react_1$b = __importStar$9(reactExports);
var beansContext_1$8 = beansContext;
var ag_grid_community_1$8 = require$$0;
var utils_1$5 = utils;
var headerRowComp_1 = __importDefault$6(headerRowComp);
var useEffectOnce_1$7 = useEffectOnce$1;
var HeaderRowContainerComp = function(props) {
  var _a2 = react_1$b.useState(new utils_1$5.CssClasses()), cssClasses = _a2[0], setCssClasses = _a2[1];
  var _b2 = react_1$b.useState(false), ariaHidden = _b2[0], setAriaHidden2 = _b2[1];
  var _c = react_1$b.useState([]), headerRowCtrls = _c[0], setHeaderRowCtrls = _c[1];
  var context = react_1$b.useContext(beansContext_1$8.BeansContext).context;
  var eGui = react_1$b.useRef(null);
  var eCenterContainer = react_1$b.useRef(null);
  var pinnedLeft = props.pinned === "left";
  var pinnedRight = props.pinned === "right";
  var centre = !pinnedLeft && !pinnedRight;
  useEffectOnce_1$7.useLayoutEffectOnce(function() {
    var compProxy = {
      setDisplayed: function(displayed) {
        setCssClasses(function(prev) {
          return prev.setClass("ag-hidden", !displayed);
        });
        setAriaHidden2(!displayed);
      },
      setCtrls: function(ctrls) {
        return setHeaderRowCtrls(ctrls);
      },
      // centre only
      setCenterWidth: function(width) {
        if (eCenterContainer.current) {
          eCenterContainer.current.style.width = width;
        }
      },
      setViewportScrollLeft: function(left) {
        if (eGui.current) {
          eGui.current.scrollLeft = left;
        }
      },
      // pinned only
      setPinnedContainerWidth: function(width) {
        if (eGui.current) {
          eGui.current.style.width = width;
          eGui.current.style.minWidth = width;
          eGui.current.style.maxWidth = width;
        }
      }
    };
    var ctrl = context.createBean(new ag_grid_community_1$8.HeaderRowContainerCtrl(props.pinned));
    ctrl.setComp(compProxy, eGui.current);
    return function() {
      context.destroyBean(ctrl);
    };
  });
  var className = react_1$b.useMemo(function() {
    return cssClasses.toString();
  }, [cssClasses]);
  var insertRowsJsx = function() {
    return headerRowCtrls.map(function(ctrl) {
      return react_1$b.default.createElement(headerRowComp_1.default, { ctrl, key: ctrl.getInstanceId() });
    });
  };
  return react_1$b.default.createElement(
    react_1$b.default.Fragment,
    null,
    pinnedLeft && react_1$b.default.createElement("div", { ref: eGui, className: "ag-pinned-left-header " + className, "aria-hidden": ariaHidden, role: "presentation" }, insertRowsJsx()),
    pinnedRight && react_1$b.default.createElement("div", { ref: eGui, className: "ag-pinned-right-header " + className, "aria-hidden": ariaHidden, role: "presentation" }, insertRowsJsx()),
    centre && react_1$b.default.createElement(
      "div",
      { ref: eGui, className: "ag-header-viewport " + className, role: "presentation" },
      react_1$b.default.createElement("div", { ref: eCenterContainer, className: "ag-header-container", role: "rowgroup" }, insertRowsJsx())
    )
  );
};
headerRowContainerComp.default = react_1$b.memo(HeaderRowContainerComp);
var __createBinding$8 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$8 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$8 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$8(result, mod2, k2);
  }
  __setModuleDefault$8(result, mod2);
  return result;
};
var __importDefault$5 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(gridHeaderComp, "__esModule", { value: true });
var react_1$a = __importStar$8(reactExports);
var beansContext_1$7 = beansContext;
var ag_grid_community_1$7 = require$$0;
var utils_1$4 = utils;
var headerRowContainerComp_1 = __importDefault$5(headerRowContainerComp);
var useEffectOnce_1$6 = useEffectOnce$1;
var GridHeaderComp = function() {
  var _a2 = react_1$a.useState(new utils_1$4.CssClasses()), cssClasses = _a2[0], setCssClasses = _a2[1];
  var _b2 = react_1$a.useState(), height = _b2[0], setHeight = _b2[1];
  var context = react_1$a.useContext(beansContext_1$7.BeansContext).context;
  var eGui = react_1$a.useRef(null);
  useEffectOnce_1$6.useLayoutEffectOnce(function() {
    var compProxy = {
      addOrRemoveCssClass: function(name, on) {
        return setCssClasses(function(prev) {
          return prev.setClass(name, on);
        });
      },
      setHeightAndMinHeight: function(height2) {
        return setHeight(height2);
      }
    };
    var ctrl = context.createBean(new ag_grid_community_1$7.GridHeaderCtrl());
    ctrl.setComp(compProxy, eGui.current, eGui.current);
    return function() {
      context.destroyBean(ctrl);
    };
  });
  var className = react_1$a.useMemo(function() {
    var res = cssClasses.toString();
    return "ag-header " + res;
  }, [cssClasses]);
  var style2 = react_1$a.useMemo(function() {
    return {
      height,
      minHeight: height
    };
  }, [height]);
  return react_1$a.default.createElement(
    "div",
    { ref: eGui, className, style: style2, role: "presentation" },
    react_1$a.default.createElement(headerRowContainerComp_1.default, { pinned: "left" }),
    react_1$a.default.createElement(headerRowContainerComp_1.default, { pinned: null }),
    react_1$a.default.createElement(headerRowContainerComp_1.default, { pinned: "right" })
  );
};
gridHeaderComp.default = react_1$a.memo(GridHeaderComp);
var reactComment = {};
Object.defineProperty(reactComment, "__esModule", { value: true });
var react_1$9 = reactExports;
var useReactCommentEffect = function(comment, eForCommentRef) {
  react_1$9.useEffect(function() {
    var eForComment = eForCommentRef.current;
    if (eForComment) {
      var eParent_1 = eForComment.parentElement;
      if (eParent_1) {
        var eComment_1 = document.createComment(comment);
        eParent_1.insertBefore(eComment_1, eForComment);
        return function() {
          eParent_1.removeChild(eComment_1);
        };
      }
    }
  }, [comment]);
};
reactComment.default = useReactCommentEffect;
var rowContainerComp = {};
var rowComp = {};
var cellComp = {};
var popupEditorComp = {};
var __createBinding$7 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$7 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$7 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$7(result, mod2, k2);
  }
  __setModuleDefault$7(result, mod2);
  return result;
};
Object.defineProperty(popupEditorComp, "__esModule", { value: true });
var ag_grid_community_1$6 = require$$0;
var react_1$8 = __importStar$7(reactExports);
var react_dom_1 = reactDomExports;
var beansContext_1$6 = beansContext;
var useEffectOnce_1$5 = useEffectOnce$1;
var PopupEditorComp = function(props) {
  var _a2 = react_1$8.useState(), popupEditorWrapper = _a2[0], setPopupEditorWrapper = _a2[1];
  var _b2 = react_1$8.useContext(beansContext_1$6.BeansContext), context = _b2.context, popupService = _b2.popupService, localeService = _b2.localeService, gridOptionsService = _b2.gridOptionsService;
  useEffectOnce_1$5.useLayoutEffectOnce(function() {
    var editDetails = props.editDetails, cellCtrl = props.cellCtrl, eParentCell = props.eParentCell;
    var compDetails = editDetails.compDetails;
    var useModelPopup = gridOptionsService.is("stopEditingWhenCellsLoseFocus");
    var wrapper = context.createBean(new ag_grid_community_1$6.PopupEditorWrapper(compDetails.params));
    var ePopupGui = wrapper.getGui();
    if (props.jsChildComp) {
      var eChildGui = props.jsChildComp.getGui();
      if (eChildGui) {
        ePopupGui.appendChild(eChildGui);
      }
    }
    var positionParams = {
      column: cellCtrl.getColumn(),
      rowNode: cellCtrl.getRowNode(),
      type: "popupCellEditor",
      eventSource: eParentCell,
      ePopup: ePopupGui,
      position: editDetails.popupPosition,
      keepWithinBounds: true
    };
    var positionCallback = popupService.positionPopupByComponent.bind(popupService, positionParams);
    var translate = localeService.getLocaleTextFunc();
    var addPopupRes = popupService.addPopup({
      modal: useModelPopup,
      eChild: ePopupGui,
      closeOnEsc: true,
      closedCallback: function() {
        cellCtrl.onPopupEditorClosed();
      },
      anchorToElement: eParentCell,
      positionCallback,
      ariaLabel: translate("ariaLabelCellEditor", "Cell Editor")
    });
    var hideEditorPopup = addPopupRes ? addPopupRes.hideFunc : void 0;
    setPopupEditorWrapper(wrapper);
    props.jsChildComp && props.jsChildComp.afterGuiAttached && props.jsChildComp.afterGuiAttached();
    return function() {
      if (hideEditorPopup != null) {
        hideEditorPopup();
      }
      context.destroyBean(wrapper);
    };
  });
  return react_1$8.default.createElement(react_1$8.default.Fragment, null, popupEditorWrapper && props.wrappedContent && react_dom_1.createPortal(props.wrappedContent, popupEditorWrapper.getGui()));
};
popupEditorComp.default = react_1$8.memo(PopupEditorComp);
var showJsRenderer = {};
Object.defineProperty(showJsRenderer, "__esModule", { value: true });
var react_1$7 = reactExports;
var beansContext_1$5 = beansContext;
var useEffectOnce_1$4 = useEffectOnce$1;
var useJsCellRenderer = function(showDetails, showTools, eCellValue, cellValueVersion, jsCellRendererRef, eGui) {
  var _a2 = react_1$7.useContext(beansContext_1$5.BeansContext), context = _a2.context;
  _a2.userComponentFactory;
  var destroyCellRenderer = react_1$7.useCallback(function() {
    var comp = jsCellRendererRef.current;
    if (!comp) {
      return;
    }
    var compGui = comp.getGui();
    if (compGui && compGui.parentElement) {
      compGui.parentElement.removeChild(compGui);
    }
    context.destroyBean(comp);
    jsCellRendererRef.current = void 0;
  }, []);
  react_1$7.useEffect(function() {
    var showValue = showDetails != null;
    var jsCompDetails = showDetails && showDetails.compDetails && !showDetails.compDetails.componentFromFramework;
    var waitingForToolsSetup = showTools && eCellValue == null;
    var showComp = showValue && jsCompDetails && !waitingForToolsSetup;
    if (!showComp) {
      destroyCellRenderer();
      return;
    }
    var compDetails = showDetails.compDetails;
    if (jsCellRendererRef.current) {
      var comp_1 = jsCellRendererRef.current;
      var attemptRefresh = comp_1.refresh != null && showDetails.force == false;
      var refreshResult = attemptRefresh ? comp_1.refresh(compDetails.params) : false;
      var refreshWorked = refreshResult === true || refreshResult === void 0;
      if (refreshWorked) {
        return;
      }
      destroyCellRenderer();
    }
    var promise = compDetails.newAgStackInstance();
    if (!promise) {
      return;
    }
    var comp = promise.resolveNow(null, function(x2) {
      return x2;
    });
    if (!comp) {
      return;
    }
    var compGui = comp.getGui();
    if (!compGui) {
      return;
    }
    var parent = showTools ? eCellValue : eGui.current;
    parent.appendChild(compGui);
    jsCellRendererRef.current = comp;
  }, [showDetails, showTools, cellValueVersion]);
  useEffectOnce_1$4.useEffectOnce(function() {
    return destroyCellRenderer;
  });
};
showJsRenderer.default = useJsCellRenderer;
(function(exports) {
  var __assign2 = commonjsGlobal && commonjsGlobal.__assign || function() {
    __assign2 = Object.assign || function(t2) {
      for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
        s2 = arguments[i];
        for (var p2 in s2)
          if (Object.prototype.hasOwnProperty.call(s2, p2))
            t2[p2] = s2[p2];
      }
      return t2;
    };
    return __assign2.apply(this, arguments);
  };
  var __createBinding2 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
    if (k22 === void 0)
      k22 = k2;
    Object.defineProperty(o, k22, { enumerable: true, get: function() {
      return m2[k2];
    } });
  } : function(o, m2, k2, k22) {
    if (k22 === void 0)
      k22 = k2;
    o[k22] = m2[k2];
  });
  var __setModuleDefault2 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
    Object.defineProperty(o, "default", { enumerable: true, value: v2 });
  } : function(o, v2) {
    o["default"] = v2;
  });
  var __importStar2 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
    if (mod2 && mod2.__esModule)
      return mod2;
    var result = {};
    if (mod2 != null) {
      for (var k2 in mod2)
        if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
          __createBinding2(result, mod2, k2);
    }
    __setModuleDefault2(result, mod2);
    return result;
  };
  var __importDefault2 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
    return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
  };
  Object.defineProperty(exports, "__esModule", { value: true });
  exports.CellCompState = void 0;
  var ag_grid_community_12 = require$$0;
  var react_12 = __importStar2(reactExports);
  var utils_12 = utils;
  var popupEditorComp_1 = __importDefault2(popupEditorComp);
  var showJsRenderer_1 = __importDefault2(showJsRenderer);
  var beansContext_12 = beansContext;
  var jsComp_12 = jsComp;
  var useEffectOnce_12 = useEffectOnce$1;
  (function(CellCompState) {
    CellCompState[CellCompState["ShowValue"] = 0] = "ShowValue";
    CellCompState[CellCompState["EditValue"] = 1] = "EditValue";
  })(exports.CellCompState || (exports.CellCompState = {}));
  var checkCellEditorDeprecations = function(popup, cellEditor, cellCtrl) {
    var col = cellCtrl.getColumn();
    if (!popup && cellEditor.isPopup && cellEditor.isPopup()) {
      var msg_1 = "AG Grid: Found an issue in column " + col.getColId() + ". If using React, specify an editor is a popup using colDef.cellEditorPopup=true. AG Grid React cannot depend on the editor component specifying if it's in a popup (via the isPopup() method on the editor), as React needs to know this information BEFORE the component is created.";
      ag_grid_community_12._.doOnce(function() {
        return console.warn(msg_1);
      }, "jsEditorComp-isPopup-" + cellCtrl.getColumn().getColId());
    }
    if (popup && cellEditor.getPopupPosition && cellEditor.getPopupPosition() != null) {
      var msg_2 = "AG Grid: Found an issue in column " + col.getColId() + ". If using React, specify an editor popup position using colDef.cellEditorPopupPosition=true. AG Grid React cannot depend on the editor component specifying it's position (via the getPopupPosition() method on the editor), as React needs to know this information BEFORE the component is created.";
      ag_grid_community_12._.doOnce(function() {
        return console.warn(msg_2);
      }, "jsEditorComp-getPopupPosition-" + cellCtrl.getColumn().getColId());
    }
  };
  var jsxEditValue = function(editDetails, setInlineCellEditorRef, setPopupCellEditorRef, eGui, cellCtrl, jsEditorComp) {
    var compDetails = editDetails.compDetails;
    var CellEditorClass = compDetails.componentClass;
    var reactInlineEditor = compDetails.componentFromFramework && !editDetails.popup;
    var reactPopupEditor = compDetails.componentFromFramework && editDetails.popup;
    var jsPopupEditor = !compDetails.componentFromFramework && editDetails.popup;
    return react_12.default.createElement(
      react_12.default.Fragment,
      null,
      reactInlineEditor && react_12.default.createElement(CellEditorClass, __assign2({}, editDetails.compDetails.params, { ref: setInlineCellEditorRef })),
      reactPopupEditor && react_12.default.createElement(popupEditorComp_1.default, { editDetails, cellCtrl, eParentCell: eGui, wrappedContent: react_12.default.createElement(CellEditorClass, __assign2({}, editDetails.compDetails.params, { ref: setPopupCellEditorRef })) }),
      jsPopupEditor && jsEditorComp && react_12.default.createElement(popupEditorComp_1.default, { editDetails, cellCtrl, eParentCell: eGui, jsChildComp: jsEditorComp })
    );
  };
  var jsxShowValue = function(showDetails, key, parentId, cellRendererRef, showCellWrapper, reactCellRendererStateless, setECellValue) {
    var compDetails = showDetails.compDetails, value = showDetails.value;
    var noCellRenderer = !compDetails;
    var reactCellRenderer = compDetails && compDetails.componentFromFramework;
    var CellRendererClass = compDetails && compDetails.componentClass;
    var valueForNoCellRenderer = (value === null || value === void 0 ? void 0 : value.toString) ? value.toString() : value;
    var bodyJsxFunc = function() {
      return react_12.default.createElement(
        react_12.default.Fragment,
        null,
        noCellRenderer && react_12.default.createElement(react_12.default.Fragment, null, valueForNoCellRenderer),
        reactCellRenderer && !reactCellRendererStateless && react_12.default.createElement(CellRendererClass, __assign2({}, compDetails.params, { key, ref: cellRendererRef })),
        reactCellRenderer && reactCellRendererStateless && react_12.default.createElement(CellRendererClass, __assign2({}, compDetails.params, { key }))
      );
    };
    return react_12.default.createElement(react_12.default.Fragment, null, showCellWrapper ? react_12.default.createElement("span", { role: "presentation", id: "cell-" + parentId, className: "ag-cell-value", ref: setECellValue }, bodyJsxFunc()) : bodyJsxFunc());
  };
  var CellComp2 = function(props) {
    var context = react_12.useContext(beansContext_12.BeansContext).context;
    var cellCtrl = props.cellCtrl, printLayout = props.printLayout, editingRow = props.editingRow;
    var _a2 = react_12.useState(), renderDetails = _a2[0], setRenderDetails = _a2[1];
    var _b2 = react_12.useState(), editDetails = _b2[0], setEditDetails = _b2[1];
    var _c = react_12.useState(1), renderKey = _c[0], setRenderKey = _c[1];
    var _d = react_12.useState(), userStyles = _d[0], setUserStyles = _d[1];
    var _e = react_12.useState(), tabIndex = _e[0], setTabIndex = _e[1];
    var _f = react_12.useState(), role = _f[0], setRole = _f[1];
    var _g = react_12.useState(), colId = _g[0], setColId = _g[1];
    var _h = react_12.useState(), title = _h[0], setTitle = _h[1];
    var _j = react_12.useState(false), includeSelection = _j[0], setIncludeSelection = _j[1];
    var _k = react_12.useState(false), includeRowDrag = _k[0], setIncludeRowDrag = _k[1];
    var _l = react_12.useState(false), includeDndSource = _l[0], setIncludeDndSource = _l[1];
    var _m = react_12.useState(), jsEditorComp = _m[0], setJsEditorComp = _m[1];
    var forceWrapper = react_12.useMemo(function() {
      return cellCtrl.isForceWrapper();
    }, []);
    var eGui = react_12.useRef(null);
    var cellRendererRef = react_12.useRef(null);
    var jsCellRendererRef = react_12.useRef();
    var cellEditorRef = react_12.useRef();
    var eCellWrapper = react_12.useRef();
    var _o = react_12.useState(0), cellWrapperVersion = _o[0], setCellWrapperVersion = _o[1];
    var setCellWrapperRef = react_12.useCallback(function(ref) {
      eCellWrapper.current = ref;
      setCellWrapperVersion(function(v2) {
        return v2 + 1;
      });
    }, []);
    var eCellValue = react_12.useRef();
    var _p = react_12.useState(0), cellValueVersion = _p[0], setCellValueVersion = _p[1];
    var setCellValueRef = react_12.useCallback(function(ref) {
      eCellValue.current = ref;
      setCellValueVersion(function(v2) {
        return v2 + 1;
      });
    }, []);
    var showTools = renderDetails != null && (includeSelection || includeDndSource || includeRowDrag);
    var showCellWrapper = forceWrapper || showTools;
    var setCellEditorRef = react_12.useCallback(function(popup, cellEditor) {
      cellEditorRef.current = cellEditor;
      if (cellEditor) {
        checkCellEditorDeprecations(popup, cellEditor, cellCtrl);
        var editingCancelledByUserComp = cellEditor.isCancelBeforeStart && cellEditor.isCancelBeforeStart();
        if (editingCancelledByUserComp) {
          setTimeout(function() {
            cellCtrl.stopEditing(true);
            cellCtrl.focusCell(true);
          });
        }
      }
    }, []);
    var setPopupCellEditorRef = react_12.useCallback(function(cellRenderer) {
      return setCellEditorRef(true, cellRenderer);
    }, []);
    var setInlineCellEditorRef = react_12.useCallback(function(cellRenderer) {
      return setCellEditorRef(false, cellRenderer);
    }, []);
    var cssClassManager = react_12.useMemo(function() {
      return new ag_grid_community_12.CssClassManager(function() {
        return eGui.current;
      });
    }, []);
    showJsRenderer_1.default(renderDetails, showCellWrapper, eCellValue.current, cellValueVersion, jsCellRendererRef, eGui);
    var lastRenderDetails = react_12.useRef();
    react_12.useLayoutEffect(function() {
      var oldDetails = lastRenderDetails.current;
      var newDetails = renderDetails;
      lastRenderDetails.current = renderDetails;
      if (oldDetails == null || oldDetails.compDetails == null || newDetails == null || newDetails.compDetails == null) {
        return;
      }
      var oldCompDetails = oldDetails.compDetails;
      var newCompDetails = newDetails.compDetails;
      if (oldCompDetails.componentClass != newCompDetails.componentClass) {
        return;
      }
      if (cellRendererRef.current == null || cellRendererRef.current.refresh == null) {
        return;
      }
      var result = cellRendererRef.current.refresh(newCompDetails.params);
      if (result != true) {
        setRenderKey(function(prev) {
          return prev + 1;
        });
      }
    }, [renderDetails]);
    react_12.useLayoutEffect(function() {
      var doingJsEditor = editDetails && !editDetails.compDetails.componentFromFramework;
      if (!doingJsEditor) {
        return;
      }
      var compDetails = editDetails.compDetails;
      var isPopup = editDetails.popup === true;
      var cellEditor = jsComp_12.createSyncJsComp(compDetails);
      if (!cellEditor) {
        return;
      }
      var compGui = cellEditor.getGui();
      setCellEditorRef(isPopup, cellEditor);
      if (!isPopup) {
        var parentEl = (forceWrapper ? eCellWrapper : eGui).current;
        parentEl === null || parentEl === void 0 ? void 0 : parentEl.appendChild(compGui);
        cellEditor.afterGuiAttached && cellEditor.afterGuiAttached();
      }
      setJsEditorComp(cellEditor);
      return function() {
        context.destroyBean(cellEditor);
        setCellEditorRef(isPopup, void 0);
        setJsEditorComp(void 0);
        if (compGui && compGui.parentElement) {
          compGui.parentElement.removeChild(compGui);
        }
      };
    }, [editDetails]);
    react_12.useLayoutEffect(function() {
      if (!cellCtrl || !context) {
        return;
      }
      if (!eCellWrapper.current || !showCellWrapper) {
        return;
      }
      var destroyFuncs = [];
      var addComp = function(comp) {
        var _a3;
        if (comp) {
          var eGui_1 = comp.getGui();
          (_a3 = eCellWrapper.current) === null || _a3 === void 0 ? void 0 : _a3.insertAdjacentElement("afterbegin", eGui_1);
          destroyFuncs.push(function() {
            context.destroyBean(comp);
            ag_grid_community_12._.removeFromParent(eGui_1);
          });
        }
        return comp;
      };
      if (includeSelection) {
        var checkboxSelectionComp = cellCtrl.createSelectionCheckbox();
        addComp(checkboxSelectionComp);
      }
      if (includeDndSource) {
        addComp(cellCtrl.createDndSource());
      }
      if (includeRowDrag) {
        addComp(cellCtrl.createRowDragComp());
      }
      return function() {
        return destroyFuncs.forEach(function(f2) {
          return f2();
        });
      };
    }, [showCellWrapper, includeDndSource, includeRowDrag, includeSelection, cellWrapperVersion]);
    useEffectOnce_12.useLayoutEffectOnce(function() {
      if (!cellCtrl) {
        return;
      }
      var compProxy = {
        addOrRemoveCssClass: function(name, on) {
          return cssClassManager.addOrRemoveCssClass(name, on);
        },
        setUserStyles: function(styles) {
          return setUserStyles(styles);
        },
        getFocusableElement: function() {
          return eGui.current;
        },
        setTabIndex: function(tabIndex2) {
          return setTabIndex(tabIndex2);
        },
        setRole: function(role2) {
          return setRole(role2);
        },
        setColId: function(colId2) {
          return setColId(colId2);
        },
        setTitle: function(title2) {
          return setTitle(title2);
        },
        setIncludeSelection: function(include) {
          return setIncludeSelection(include);
        },
        setIncludeRowDrag: function(include) {
          return setIncludeRowDrag(include);
        },
        setIncludeDndSource: function(include) {
          return setIncludeDndSource(include);
        },
        getCellEditor: function() {
          return cellEditorRef.current || null;
        },
        getCellRenderer: function() {
          return cellRendererRef.current ? cellRendererRef.current : jsCellRendererRef.current;
        },
        getParentOfValue: function() {
          return eCellValue.current ? eCellValue.current : eCellWrapper.current ? eCellWrapper.current : eGui.current;
        },
        setRenderDetails: function(compDetails, value, force) {
          setRenderDetails({
            value,
            compDetails,
            force
          });
        },
        setEditDetails: function(compDetails, popup, popupPosition) {
          if (compDetails) {
            setEditDetails({
              compDetails,
              popup,
              popupPosition
            });
            if (!popup) {
              setRenderDetails(void 0);
            }
          } else {
            setEditDetails(void 0);
          }
        }
      };
      var cellWrapperOrUndefined = eCellWrapper.current || void 0;
      cellCtrl.setComp(compProxy, eGui.current, cellWrapperOrUndefined, printLayout, editingRow);
    });
    var reactCellRendererStateless = react_12.useMemo(function() {
      var res = renderDetails && renderDetails.compDetails && renderDetails.compDetails.componentFromFramework && utils_12.isComponentStateless(renderDetails.compDetails.componentClass);
      return !!res;
    }, [renderDetails]);
    react_12.useEffect(function() {
      var _a3;
      if (!eGui.current) {
        return;
      }
      cssClassManager.addOrRemoveCssClass("ag-cell-value", !showCellWrapper);
      cssClassManager.addOrRemoveCssClass("ag-cell-inline-editing", !!editDetails && !editDetails.popup);
      cssClassManager.addOrRemoveCssClass("ag-cell-popup-editing", !!editDetails && !!editDetails.popup);
      cssClassManager.addOrRemoveCssClass("ag-cell-not-inline-editing", !editDetails || !!editDetails.popup);
      (_a3 = cellCtrl.getRowCtrl()) === null || _a3 === void 0 ? void 0 : _a3.setInlineEditingCss(!!editDetails);
      if (cellCtrl.shouldRestoreFocus() && !cellCtrl.isEditing()) {
        eGui.current.focus({ preventScroll: true });
      }
    });
    var cellInstanceId = react_12.useMemo(function() {
      return cellCtrl.getInstanceId();
    }, []);
    var showContents = function() {
      return react_12.default.createElement(
        react_12.default.Fragment,
        null,
        renderDetails != null && jsxShowValue(renderDetails, renderKey, cellInstanceId, cellRendererRef, showCellWrapper, reactCellRendererStateless, setCellValueRef),
        editDetails != null && jsxEditValue(editDetails, setInlineCellEditorRef, setPopupCellEditorRef, eGui.current, cellCtrl, jsEditorComp)
      );
    };
    return react_12.default.createElement("div", { ref: eGui, style: userStyles, tabIndex, role, "col-id": colId, title }, showCellWrapper ? react_12.default.createElement("div", { className: "ag-cell-wrapper", role: "presentation", ref: setCellWrapperRef }, showContents()) : showContents());
  };
  exports.default = react_12.memo(CellComp2);
})(cellComp);
var __assign$2 = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign$2 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$2.apply(this, arguments);
};
var __createBinding$6 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$6 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$6 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$6(result, mod2, k2);
  }
  __setModuleDefault$6(result, mod2);
  return result;
};
var __spreadArray$1 = commonjsGlobal && commonjsGlobal.__spreadArray || function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var __importDefault$4 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(rowComp, "__esModule", { value: true });
var react_1$6 = __importStar$6(reactExports);
var ag_grid_community_1$5 = require$$0;
var jsComp_1 = jsComp;
var utils_1$3 = utils;
var beansContext_1$4 = beansContext;
var cellComp_1 = __importDefault$4(cellComp);
var useEffectOnce_1$3 = useEffectOnce$1;
var maintainOrderOnColumns = function(prev, next, domOrder) {
  if (domOrder) {
    var res_1 = { list: next, instanceIdMap: /* @__PURE__ */ new Map() };
    next.forEach(function(c) {
      return res_1.instanceIdMap.set(c.getInstanceId(), c);
    });
    return res_1;
  }
  var oldCellCtrls = [];
  var newCellCtrls = [];
  var newInstanceIdMap = /* @__PURE__ */ new Map();
  var tempMap = /* @__PURE__ */ new Map();
  next.forEach(function(c) {
    return tempMap.set(c.getInstanceId(), c);
  });
  prev.list.forEach(function(c) {
    var instanceId = c.getInstanceId();
    if (tempMap.has(instanceId)) {
      oldCellCtrls.push(c);
      newInstanceIdMap.set(instanceId, c);
    }
  });
  next.forEach(function(c) {
    var instanceId = c.getInstanceId();
    if (!prev.instanceIdMap.has(instanceId)) {
      newCellCtrls.push(c);
      newInstanceIdMap.set(instanceId, c);
    }
  });
  var res = {
    list: __spreadArray$1(__spreadArray$1([], oldCellCtrls), newCellCtrls),
    instanceIdMap: newInstanceIdMap
  };
  return res;
};
var RowComp = function(params) {
  var context = react_1$6.useContext(beansContext_1$4.BeansContext).context;
  var rowCtrl = params.rowCtrl, containerType = params.containerType;
  var _a2 = react_1$6.useState(), rowIndex = _a2[0], setRowIndex = _a2[1];
  var _b2 = react_1$6.useState(), rowId = _b2[0], setRowId = _b2[1];
  var _c = react_1$6.useState(), role = _c[0], setRole = _c[1];
  var _d = react_1$6.useState(), rowBusinessKey = _d[0], setRowBusinessKey = _d[1];
  var _e = react_1$6.useState(), tabIndex = _e[0], setTabIndex = _e[1];
  var _f = react_1$6.useState(), userStyles = _f[0], setUserStyles = _f[1];
  var _g = react_1$6.useState({ list: [], instanceIdMap: /* @__PURE__ */ new Map() }), cellCtrls = _g[0], setCellCtrls = _g[1];
  var _h = react_1$6.useState(), fullWidthCompDetails = _h[0], setFullWidthCompDetails = _h[1];
  var _j = react_1$6.useState(false), domOrder = _j[0], setDomOrder = _j[1];
  var _k = react_1$6.useState(rowCtrl.getInitialRowTop(containerType)), top = _k[0], setTop = _k[1];
  var _l = react_1$6.useState(rowCtrl.getInitialTransform(containerType)), transform = _l[0], setTransform = _l[1];
  var eGui = react_1$6.useRef(null);
  var fullWidthCompRef = react_1$6.useRef();
  var autoHeightSetup = react_1$6.useRef(false);
  var _m = react_1$6.useState(0), autoHeightSetupAttempt = _m[0], setAutoHeightSetupAttempt = _m[1];
  react_1$6.useEffect(function() {
    var _a3;
    if (autoHeightSetup.current) {
      return;
    }
    if (!fullWidthCompDetails) {
      return;
    }
    if (autoHeightSetupAttempt > 10) {
      return;
    }
    var eChild = (_a3 = eGui.current) === null || _a3 === void 0 ? void 0 : _a3.firstChild;
    if (eChild) {
      rowCtrl.setupDetailRowAutoHeight(eChild);
      autoHeightSetup.current = true;
    } else {
      setAutoHeightSetupAttempt(function(prev) {
        return prev + 1;
      });
    }
  }, [fullWidthCompDetails, autoHeightSetupAttempt]);
  var cssClassManager = react_1$6.useMemo(function() {
    return new ag_grid_community_1$5.CssClassManager(function() {
      return eGui.current;
    });
  }, []);
  useEffectOnce_1$3.useLayoutEffectOnce(function() {
    if (!rowCtrl.isAlive()) {
      return;
    }
    var compProxy = {
      // the rowTop is managed by state, instead of direct style manipulation by rowCtrl (like all the other styles)
      // as we need to have an initial value when it's placed into he DOM for the first time, for animation to work.
      setTop: function(value) {
        return setTop(value);
      },
      setTransform: function(value) {
        return setTransform(value);
      },
      // i found using React for managing classes at the row level was to slow, as modifying classes caused a lot of
      // React code to execute, so avoiding React for managing CSS Classes made the grid go much faster.
      addOrRemoveCssClass: function(name, on) {
        return cssClassManager.addOrRemoveCssClass(name, on);
      },
      setDomOrder: function(domOrder2) {
        return setDomOrder(domOrder2);
      },
      setRowIndex: function(value) {
        return setRowIndex(value);
      },
      setRowId: function(value) {
        return setRowId(value);
      },
      setRowBusinessKey: function(value) {
        return setRowBusinessKey(value);
      },
      setTabIndex: function(value) {
        return setTabIndex(value);
      },
      setUserStyles: function(styles) {
        return setUserStyles(styles);
      },
      setRole: function(value) {
        return setRole(value);
      },
      // if we don't maintain the order, then cols will be ripped out and into the dom
      // when cols reordered, which would stop the CSS transitions from working
      setCellCtrls: function(next, useFlushSync) {
        utils_1$3.agFlushSync(useFlushSync, function() {
          setCellCtrls(function(prev) {
            return maintainOrderOnColumns(prev, next, domOrder);
          });
        });
      },
      showFullWidth: function(compDetails) {
        return setFullWidthCompDetails(compDetails);
      },
      getFullWidthCellRenderer: function() {
        return fullWidthCompRef.current;
      }
    };
    rowCtrl.setComp(compProxy, eGui.current, containerType);
    return function() {
      rowCtrl.unsetComp(containerType);
    };
  });
  react_1$6.useLayoutEffect(function() {
    return jsComp_1.showJsComp(fullWidthCompDetails, context, eGui.current, fullWidthCompRef);
  }, [fullWidthCompDetails]);
  var rowStyles = react_1$6.useMemo(function() {
    var res = { top, transform };
    Object.assign(res, userStyles);
    return res;
  }, [top, transform, userStyles]);
  var showFullWidthFramework = fullWidthCompDetails && fullWidthCompDetails.componentFromFramework;
  var showCells = cellCtrls != null;
  var reactFullWidthCellRendererStateless = react_1$6.useMemo(function() {
    var res = (fullWidthCompDetails === null || fullWidthCompDetails === void 0 ? void 0 : fullWidthCompDetails.componentFromFramework) && utils_1$3.isComponentStateless(fullWidthCompDetails.componentClass);
    return !!res;
  }, [fullWidthCompDetails]);
  var showCellsJsx = function() {
    return cellCtrls.list.map(function(cellCtrl) {
      return react_1$6.default.createElement(cellComp_1.default, { cellCtrl, editingRow: rowCtrl.isEditing(), printLayout: rowCtrl.isPrintLayout(), key: cellCtrl.getInstanceId() });
    });
  };
  var showFullWidthFrameworkJsx = function() {
    var FullWidthComp = fullWidthCompDetails.componentClass;
    return react_1$6.default.createElement(
      react_1$6.default.Fragment,
      null,
      reactFullWidthCellRendererStateless && react_1$6.default.createElement(FullWidthComp, __assign$2({}, fullWidthCompDetails.params)),
      !reactFullWidthCellRendererStateless && react_1$6.default.createElement(FullWidthComp, __assign$2({}, fullWidthCompDetails.params, { ref: fullWidthCompRef }))
    );
  };
  return react_1$6.default.createElement(
    "div",
    { ref: eGui, role, style: rowStyles, "row-index": rowIndex, "row-id": rowId, "row-business-key": rowBusinessKey, tabIndex },
    showCells && showCellsJsx(),
    showFullWidthFramework && showFullWidthFrameworkJsx()
  );
};
rowComp.default = react_1$6.memo(RowComp);
var __createBinding$5 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$5 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$5 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$5(result, mod2, k2);
  }
  __setModuleDefault$5(result, mod2);
  return result;
};
var __spreadArray = commonjsGlobal && commonjsGlobal.__spreadArray || function(to2, from2) {
  for (var i = 0, il2 = from2.length, j = to2.length; i < il2; i++, j++)
    to2[j] = from2[i];
  return to2;
};
var __importDefault$3 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(rowContainerComp, "__esModule", { value: true });
var ag_grid_community_1$4 = require$$0;
var react_1$5 = __importStar$5(reactExports);
var utils_1$2 = utils;
var reactComment_1$2 = __importDefault$3(reactComment);
var rowComp_1 = __importDefault$3(rowComp);
var beansContext_1$3 = beansContext;
var useEffectOnce_1$2 = useEffectOnce$1;
var RowContainerComp = function(params) {
  var context = react_1$5.useContext(beansContext_1$3.BeansContext).context;
  var _a2 = react_1$5.useState([]), rowCtrlsOrdered = _a2[0], setRowCtrlsOrdered = _a2[1];
  var name = params.name;
  var containerType = react_1$5.useMemo(function() {
    return ag_grid_community_1$4.getRowContainerTypeForName(name);
  }, [name]);
  var eWrapper = react_1$5.useRef(null);
  var eViewport = react_1$5.useRef(null);
  var eContainer = react_1$5.useRef(null);
  var rowCtrlsRef = react_1$5.useRef([]);
  var domOrderRef = react_1$5.useRef(false);
  var cssClasses = react_1$5.useMemo(function() {
    return ag_grid_community_1$4.RowContainerCtrl.getRowContainerCssClasses(name);
  }, [name]);
  var wrapperClasses = react_1$5.useMemo(function() {
    return utils_1$2.classesList(cssClasses.wrapper);
  }, []);
  var viewportClasses = react_1$5.useMemo(function() {
    return utils_1$2.classesList(cssClasses.viewport);
  }, []);
  var containerClasses = react_1$5.useMemo(function() {
    return utils_1$2.classesList(cssClasses.container);
  }, []);
  var template1 = name === ag_grid_community_1$4.RowContainerName.CENTER;
  var template2 = name === ag_grid_community_1$4.RowContainerName.TOP_CENTER || name === ag_grid_community_1$4.RowContainerName.BOTTOM_CENTER || name === ag_grid_community_1$4.RowContainerName.STICKY_TOP_CENTER;
  var template3 = !template1 && !template2;
  var topLevelRef = template1 ? eWrapper : template2 ? eViewport : eContainer;
  reactComment_1$2.default(" AG Row Container " + name + " ", topLevelRef);
  function updateRowCtrlsOrdered(useFlushSync) {
    utils_1$2.agFlushSync(useFlushSync, function() {
      setRowCtrlsOrdered(function(prev) {
        var rowCtrls = rowCtrlsRef.current;
        if (domOrderRef.current) {
          return rowCtrls;
        }
        var oldRows = prev.filter(function(r2) {
          return rowCtrls.indexOf(r2) >= 0;
        });
        var newRows = rowCtrls.filter(function(r2) {
          return oldRows.indexOf(r2) < 0;
        });
        return __spreadArray(__spreadArray([], oldRows), newRows);
      });
    });
  }
  useEffectOnce_1$2.useLayoutEffectOnce(function() {
    var beansToDestroy = [];
    var compProxy = {
      setViewportHeight: function(height) {
        if (eViewport.current) {
          eViewport.current.style.height = height;
        }
      },
      setRowCtrls: function(rowCtrls, useFlushSync) {
        if (rowCtrlsRef.current !== rowCtrls) {
          var useFlush = useFlushSync && rowCtrlsRef.current.length > 0 && rowCtrls.length > 0;
          rowCtrlsRef.current = rowCtrls;
          updateRowCtrlsOrdered(useFlush);
        }
      },
      setDomOrder: function(domOrder) {
        if (domOrderRef.current != domOrder) {
          domOrderRef.current = domOrder;
          updateRowCtrlsOrdered(false);
        }
      },
      setContainerWidth: function(width) {
        if (eContainer.current) {
          eContainer.current.style.width = width;
        }
      }
    };
    var ctrl = context.createBean(new ag_grid_community_1$4.RowContainerCtrl(name));
    beansToDestroy.push(ctrl);
    ctrl.setComp(compProxy, eContainer.current, eViewport.current, eWrapper.current);
    return function() {
      context.destroyBeans(beansToDestroy);
    };
  });
  var buildContainer = function() {
    return react_1$5.default.createElement("div", { className: containerClasses, ref: eContainer, role: rowCtrlsOrdered.length ? "rowgroup" : "presentation" }, rowCtrlsOrdered.map(function(rowCtrl) {
      return react_1$5.default.createElement(rowComp_1.default, { rowCtrl, containerType, key: rowCtrl.getInstanceId() });
    }));
  };
  return react_1$5.default.createElement(
    react_1$5.default.Fragment,
    null,
    template1 && react_1$5.default.createElement(
      "div",
      { className: wrapperClasses, ref: eWrapper, role: "presentation" },
      react_1$5.default.createElement("div", { className: viewportClasses, ref: eViewport, role: "presentation" }, buildContainer())
    ),
    template2 && react_1$5.default.createElement("div", { className: viewportClasses, ref: eViewport, role: "presentation" }, buildContainer()),
    template3 && buildContainer()
  );
};
rowContainerComp.default = react_1$5.memo(RowContainerComp);
var __createBinding$4 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$4 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$4 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$4(result, mod2, k2);
  }
  __setModuleDefault$4(result, mod2);
  return result;
};
var __importDefault$2 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(gridBodyComp, "__esModule", { value: true });
var ag_grid_community_1$3 = require$$0;
var react_1$4 = __importStar$4(reactExports);
var beansContext_1$2 = beansContext;
var gridHeaderComp_1 = __importDefault$2(gridHeaderComp);
var reactComment_1$1 = __importDefault$2(reactComment);
var rowContainerComp_1 = __importDefault$2(rowContainerComp);
var useEffectOnce_1$1 = useEffectOnce$1;
var utils_1$1 = utils;
var GridBodyComp = function() {
  var _a2 = react_1$4.useContext(beansContext_1$2.BeansContext), context = _a2.context, agStackComponentsRegistry = _a2.agStackComponentsRegistry, resizeObserverService = _a2.resizeObserverService;
  var _b2 = react_1$4.useState(""), rowAnimationClass = _b2[0], setRowAnimationClass = _b2[1];
  var _c = react_1$4.useState(0), topHeight = _c[0], setTopHeight = _c[1];
  var _d = react_1$4.useState(0), bottomHeight = _d[0], setBottomHeight = _d[1];
  var _e = react_1$4.useState("0px"), stickyTopHeight = _e[0], setStickyTopHeight = _e[1];
  var _f = react_1$4.useState("0px"), stickyTopTop = _f[0], setStickyTopTop = _f[1];
  var _g = react_1$4.useState("100%"), stickyTopWidth = _g[0], setStickyTopWidth = _g[1];
  var _h = react_1$4.useState(""), topDisplay = _h[0], setTopDisplay = _h[1];
  var _j = react_1$4.useState(""), bottomDisplay = _j[0], setBottomDisplay = _j[1];
  var _k = react_1$4.useState(null), forceVerticalScrollClass = _k[0], setForceVerticalScrollClass = _k[1];
  var _l = react_1$4.useState(""), topAndBottomOverflowY = _l[0], setTopAndBottomOverflowY = _l[1];
  var _m = react_1$4.useState(null), cellSelectableCss = _m[0], setCellSelectableCss = _m[1];
  var _o = react_1$4.useState("ag-layout-normal"), layoutClass = _o[0], setLayoutClass = _o[1];
  var cssClassManager = react_1$4.useMemo(function() {
    return new ag_grid_community_1$3.CssClassManager(function() {
      return eRoot.current;
    });
  }, []);
  var eRoot = react_1$4.useRef(null);
  var eTop = react_1$4.useRef(null);
  var eStickyTop = react_1$4.useRef(null);
  var eBody = react_1$4.useRef(null);
  var eBodyViewport = react_1$4.useRef(null);
  var eBottom = react_1$4.useRef(null);
  reactComment_1$1.default(" AG Grid Body ", eRoot);
  reactComment_1$1.default(" AG Pinned Top ", eTop);
  reactComment_1$1.default(" AG Sticky Top ", eStickyTop);
  reactComment_1$1.default(" AG Middle ", eBodyViewport);
  reactComment_1$1.default(" AG Pinned Bottom ", eBottom);
  useEffectOnce_1$1.useLayoutEffectOnce(function() {
    var beansToDestroy = [];
    var destroyFuncs = [];
    if (!context) {
      return;
    }
    var newComp = function(tag) {
      var CompClass = agStackComponentsRegistry.getComponentClass(tag);
      var comp = context.createBean(new CompClass());
      beansToDestroy.push(comp);
      return comp;
    };
    if (eRoot.current) {
      eRoot.current.appendChild(document.createComment(" AG Fake Horizontal Scroll "));
      eRoot.current.appendChild(newComp("AG-FAKE-HORIZONTAL-SCROLL").getGui());
      eRoot.current.appendChild(document.createComment(" AG Overlay Wrapper "));
      eRoot.current.appendChild(newComp("AG-OVERLAY-WRAPPER").getGui());
    }
    if (eBody.current) {
      eBody.current.appendChild(document.createComment(" AG Fake Vertical Scroll "));
      eBody.current.appendChild(newComp("AG-FAKE-VERTICAL-SCROLL").getGui());
    }
    var compProxy = {
      setRowAnimationCssOnBodyViewport: setRowAnimationClass,
      setColumnCount: function(count) {
        return ag_grid_community_1$3._.setAriaColCount(eRoot.current, count);
      },
      setRowCount: function(count) {
        return ag_grid_community_1$3._.setAriaRowCount(eRoot.current, count);
      },
      setTopHeight,
      setBottomHeight,
      setStickyTopHeight,
      setStickyTopTop,
      setStickyTopWidth,
      setTopDisplay,
      setBottomDisplay,
      setColumnMovingCss: function(cssClass, flag) {
        return cssClassManager.addOrRemoveCssClass(cssClass, flag);
      },
      updateLayoutClasses: setLayoutClass,
      setAlwaysVerticalScrollClass: setForceVerticalScrollClass,
      setPinnedTopBottomOverflowY: setTopAndBottomOverflowY,
      setCellSelectableCss: function(cssClass, flag) {
        return setCellSelectableCss(flag ? cssClass : null);
      },
      setBodyViewportWidth: function(width) {
        if (eBodyViewport.current) {
          eBodyViewport.current.style.width = width;
        }
      },
      registerBodyViewportResizeListener: function(listener) {
        var unsubscribeFromResize = resizeObserverService.observeResize(eBodyViewport.current, listener);
        destroyFuncs.push(function() {
          return unsubscribeFromResize();
        });
      }
    };
    var ctrl = context.createBean(new ag_grid_community_1$3.GridBodyCtrl());
    beansToDestroy.push(ctrl);
    ctrl.setComp(compProxy, eRoot.current, eBodyViewport.current, eTop.current, eBottom.current, eStickyTop.current);
    return function() {
      context.destroyBeans(beansToDestroy);
      destroyFuncs.forEach(function(f2) {
        return f2();
      });
    };
  });
  var rootClasses = react_1$4.useMemo(function() {
    return utils_1$1.classesList("ag-root", "ag-unselectable", layoutClass);
  }, [layoutClass]);
  var bodyViewportClasses = react_1$4.useMemo(function() {
    return utils_1$1.classesList("ag-body-viewport", rowAnimationClass, layoutClass, forceVerticalScrollClass, cellSelectableCss);
  }, [rowAnimationClass, layoutClass, forceVerticalScrollClass, cellSelectableCss]);
  var bodyClasses = react_1$4.useMemo(function() {
    return utils_1$1.classesList("ag-body", layoutClass);
  }, [layoutClass]);
  var bodyClipperClasses = react_1$4.useMemo(function() {
    return utils_1$1.classesList("ag-body-clipper", layoutClass);
  }, [layoutClass]);
  var topClasses = react_1$4.useMemo(function() {
    return utils_1$1.classesList("ag-floating-top", cellSelectableCss);
  }, [cellSelectableCss]);
  var stickyTopClasses = react_1$4.useMemo(function() {
    return utils_1$1.classesList("ag-sticky-top", cellSelectableCss);
  }, [cellSelectableCss]);
  var bottomClasses = react_1$4.useMemo(function() {
    return utils_1$1.classesList("ag-floating-bottom", cellSelectableCss);
  }, [cellSelectableCss]);
  var topStyle = react_1$4.useMemo(function() {
    return {
      height: topHeight,
      minHeight: topHeight,
      display: topDisplay,
      overflowY: topAndBottomOverflowY
    };
  }, [topHeight, topDisplay, topAndBottomOverflowY]);
  var stickyTopStyle = react_1$4.useMemo(function() {
    return {
      height: stickyTopHeight,
      top: stickyTopTop,
      width: stickyTopWidth
    };
  }, [stickyTopHeight, stickyTopTop, stickyTopWidth]);
  var bottomStyle = react_1$4.useMemo(function() {
    return {
      height: bottomHeight,
      minHeight: bottomHeight,
      display: bottomDisplay,
      overflowY: topAndBottomOverflowY
    };
  }, [bottomHeight, bottomDisplay, topAndBottomOverflowY]);
  var createRowContainer = function(container) {
    return react_1$4.default.createElement(rowContainerComp_1.default, { name: container, key: container + "-container" });
  };
  var createSection = function(_a3) {
    var section = _a3.section, children = _a3.children, className = _a3.className, style2 = _a3.style;
    return react_1$4.default.createElement("div", { ref: section, className, role: "presentation", style: style2 }, children.map(createRowContainer));
  };
  return react_1$4.default.createElement(
    "div",
    { ref: eRoot, className: rootClasses, role: "treegrid" },
    react_1$4.default.createElement(gridHeaderComp_1.default, null),
    createSection({ section: eTop, className: topClasses, style: topStyle, children: [
      ag_grid_community_1$3.RowContainerName.TOP_LEFT,
      ag_grid_community_1$3.RowContainerName.TOP_CENTER,
      ag_grid_community_1$3.RowContainerName.TOP_RIGHT,
      ag_grid_community_1$3.RowContainerName.TOP_FULL_WIDTH
    ] }),
    react_1$4.default.createElement(
      "div",
      { className: bodyClasses, ref: eBody, role: "presentation" },
      react_1$4.default.createElement("div", { className: bodyClipperClasses, role: "presentation" }, createSection({
        section: eBodyViewport,
        className: bodyViewportClasses,
        children: [
          ag_grid_community_1$3.RowContainerName.LEFT,
          ag_grid_community_1$3.RowContainerName.CENTER,
          ag_grid_community_1$3.RowContainerName.RIGHT,
          ag_grid_community_1$3.RowContainerName.FULL_WIDTH
        ]
      }))
    ),
    createSection({ section: eStickyTop, className: stickyTopClasses, style: stickyTopStyle, children: [
      ag_grid_community_1$3.RowContainerName.STICKY_TOP_LEFT,
      ag_grid_community_1$3.RowContainerName.STICKY_TOP_CENTER,
      ag_grid_community_1$3.RowContainerName.STICKY_TOP_RIGHT,
      ag_grid_community_1$3.RowContainerName.STICKY_TOP_FULL_WIDTH
    ] }),
    createSection({ section: eBottom, className: bottomClasses, style: bottomStyle, children: [
      ag_grid_community_1$3.RowContainerName.BOTTOM_LEFT,
      ag_grid_community_1$3.RowContainerName.BOTTOM_CENTER,
      ag_grid_community_1$3.RowContainerName.BOTTOM_RIGHT,
      ag_grid_community_1$3.RowContainerName.BOTTOM_FULL_WIDTH
    ] })
  );
};
gridBodyComp.default = react_1$4.memo(GridBodyComp);
var tabGuardComp = {};
var __createBinding$3 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$3 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$3 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$3(result, mod2, k2);
  }
  __setModuleDefault$3(result, mod2);
  return result;
};
Object.defineProperty(tabGuardComp, "__esModule", { value: true });
var react_1$3 = __importStar$3(reactExports);
var ag_grid_community_1$2 = require$$0;
var beansContext_1$1 = beansContext;
var useEffectOnce_1 = useEffectOnce$1;
var TabGuardCompRef = function(props, forwardRef) {
  var children = props.children, eFocusableElement = props.eFocusableElement, onTabKeyDown = props.onTabKeyDown, gridCtrl = props.gridCtrl;
  var context = react_1$3.useContext(beansContext_1$1.BeansContext).context;
  var topTabGuardRef = react_1$3.useRef(null);
  var bottomTabGuardRef = react_1$3.useRef(null);
  var tabGuardCtrlRef = react_1$3.useRef();
  var setTabIndex = function(value) {
    var processedValue = value == null ? void 0 : parseInt(value, 10).toString();
    [topTabGuardRef, bottomTabGuardRef].forEach(function(tabGuard) {
      var _a2, _b2;
      if (processedValue === void 0) {
        (_a2 = tabGuard.current) === null || _a2 === void 0 ? void 0 : _a2.removeAttribute("tabindex");
      } else {
        (_b2 = tabGuard.current) === null || _b2 === void 0 ? void 0 : _b2.setAttribute("tabindex", processedValue);
      }
    });
  };
  react_1$3.useImperativeHandle(forwardRef, function() {
    return {
      forceFocusOutOfContainer: function() {
        var _a2;
        (_a2 = tabGuardCtrlRef.current) === null || _a2 === void 0 ? void 0 : _a2.forceFocusOutOfContainer();
      }
    };
  });
  useEffectOnce_1.useLayoutEffectOnce(function() {
    var eTopGuard = topTabGuardRef.current;
    var eBottomGuard = bottomTabGuardRef.current;
    var compProxy = {
      setTabIndex
    };
    var ctrl = tabGuardCtrlRef.current = context.createBean(new ag_grid_community_1$2.TabGuardCtrl({
      comp: compProxy,
      eTopGuard,
      eBottomGuard,
      eFocusableElement,
      onTabKeyDown,
      focusInnerElement: function(fromBottom) {
        return gridCtrl.focusInnerElement(fromBottom);
      }
    }));
    return function() {
      context.destroyBean(ctrl);
    };
  });
  var createTabGuard = function(side) {
    var className = side === "top" ? ag_grid_community_1$2.TabGuardClassNames.TAB_GUARD_TOP : ag_grid_community_1$2.TabGuardClassNames.TAB_GUARD_BOTTOM;
    return react_1$3.default.createElement("div", { className: ag_grid_community_1$2.TabGuardClassNames.TAB_GUARD + " " + className, role: "presentation", ref: side === "top" ? topTabGuardRef : bottomTabGuardRef });
  };
  return react_1$3.default.createElement(
    react_1$3.default.Fragment,
    null,
    createTabGuard("top"),
    children,
    createTabGuard("bottom")
  );
};
var TabGuardComp = react_1$3.forwardRef(TabGuardCompRef);
tabGuardComp.default = react_1$3.memo(TabGuardComp);
var __createBinding$2 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$2 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$2 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$2(result, mod2, k2);
  }
  __setModuleDefault$2(result, mod2);
  return result;
};
var __importDefault$1 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(gridComp, "__esModule", { value: true });
var ag_grid_community_1$1 = require$$0;
var react_1$2 = __importStar$2(reactExports);
var beansContext_1 = beansContext;
var gridBodyComp_1 = __importDefault$1(gridBodyComp);
var reactComment_1 = __importDefault$1(reactComment);
var tabGuardComp_1 = __importDefault$1(tabGuardComp);
var utils_1 = utils;
var GridComp = function(_a2) {
  var context = _a2.context;
  var _b2 = react_1$2.useState(""), rtlClass = _b2[0], setRtlClass = _b2[1];
  var _c = react_1$2.useState(""), keyboardFocusClass = _c[0], setKeyboardFocusClass = _c[1];
  var _d = react_1$2.useState(""), layoutClass = _d[0], setLayoutClass = _d[1];
  var _e = react_1$2.useState(null), cursor = _e[0], setCursor = _e[1];
  var _f = react_1$2.useState(null), userSelect = _f[0], setUserSelect = _f[1];
  var _g = react_1$2.useState(false), initialised = _g[0], setInitialised = _g[1];
  var _h = react_1$2.useState(), tabGuardReady = _h[0], setTabGuardReady = _h[1];
  var gridCtrlRef = react_1$2.useRef(null);
  var eRootWrapperRef = react_1$2.useRef(null);
  var tabGuardRef = react_1$2.useRef();
  var eGridBodyParentRef = react_1$2.useRef(null);
  var focusInnerElementRef = react_1$2.useRef(function() {
    return void 0;
  });
  var onTabKeyDown = react_1$2.useCallback(function() {
    return void 0;
  }, []);
  var beans = react_1$2.useMemo(function() {
    if (context.isDestroyed()) {
      return null;
    }
    return context.getBean("beans");
  }, [context]);
  reactComment_1.default(" AG Grid ", eRootWrapperRef);
  react_1$2.useLayoutEffect(function() {
    if (context.isDestroyed()) {
      return;
    }
    var currentController = gridCtrlRef.current = context.createBean(new ag_grid_community_1$1.GridCtrl());
    var gridCtrl = gridCtrlRef.current;
    focusInnerElementRef.current = gridCtrl.focusInnerElement.bind(gridCtrl);
    var compProxy = {
      destroyGridUi: function() {
      },
      setRtlClass,
      addOrRemoveKeyboardFocusClass: function(addOrRemove) {
        return setKeyboardFocusClass(addOrRemove ? ag_grid_community_1$1.FocusService.AG_KEYBOARD_FOCUS : "");
      },
      forceFocusOutOfContainer: function() {
        var _a3;
        (_a3 = tabGuardRef.current) === null || _a3 === void 0 ? void 0 : _a3.forceFocusOutOfContainer();
      },
      updateLayoutClasses: setLayoutClass,
      getFocusableContainers: function() {
        var _a3, _b3;
        var els = [];
        var gridBodyCompEl = (_a3 = eRootWrapperRef.current) === null || _a3 === void 0 ? void 0 : _a3.querySelector(".ag-root");
        var sideBarEl = (_b3 = eRootWrapperRef.current) === null || _b3 === void 0 ? void 0 : _b3.querySelector(".ag-side-bar:not(.ag-hidden)");
        if (gridBodyCompEl) {
          els.push(gridBodyCompEl);
        }
        if (sideBarEl) {
          els.push(sideBarEl);
        }
        return els;
      },
      setCursor,
      setUserSelect
    };
    gridCtrl.setComp(compProxy, eRootWrapperRef.current, eRootWrapperRef.current);
    setInitialised(true);
    return function() {
      context.destroyBean(currentController);
      gridCtrlRef.current = null;
    };
  }, [context]);
  react_1$2.useEffect(function() {
    if (!tabGuardReady || !beans || !gridCtrlRef.current) {
      return;
    }
    var gridCtrl = gridCtrlRef.current;
    var beansToDestroy = [];
    var agStackComponentsRegistry = beans.agStackComponentsRegistry;
    var HeaderDropZonesClass = agStackComponentsRegistry.getComponentClass("AG-GRID-HEADER-DROP-ZONES");
    var SideBarClass = agStackComponentsRegistry.getComponentClass("AG-SIDE-BAR");
    var StatusBarClass = agStackComponentsRegistry.getComponentClass("AG-STATUS-BAR");
    var WatermarkClass = agStackComponentsRegistry.getComponentClass("AG-WATERMARK");
    var PaginationClass = agStackComponentsRegistry.getComponentClass("AG-PAGINATION");
    var additionalEls = [];
    var eRootWrapper = eRootWrapperRef.current;
    var eGridBodyParent2 = eGridBodyParentRef.current;
    if (gridCtrl.showDropZones() && HeaderDropZonesClass) {
      var headerDropZonesComp = context.createBean(new HeaderDropZonesClass());
      var eGui = headerDropZonesComp.getGui();
      eRootWrapper.insertAdjacentElement("afterbegin", eGui);
      additionalEls.push(eGui);
      beansToDestroy.push(headerDropZonesComp);
    }
    if (gridCtrl.showSideBar() && SideBarClass) {
      var sideBarComp = context.createBean(new SideBarClass());
      var eGui = sideBarComp.getGui();
      var bottomTabGuard = eGridBodyParent2.querySelector(".ag-tab-guard-bottom");
      if (bottomTabGuard) {
        bottomTabGuard.insertAdjacentElement("beforebegin", eGui);
        additionalEls.push(eGui);
      }
      beansToDestroy.push(sideBarComp);
    }
    if (gridCtrl.showStatusBar() && StatusBarClass) {
      var statusBarComp = context.createBean(new StatusBarClass());
      var eGui = statusBarComp.getGui();
      eRootWrapper.insertAdjacentElement("beforeend", eGui);
      additionalEls.push(eGui);
      beansToDestroy.push(statusBarComp);
    }
    if (PaginationClass) {
      var paginationComp = context.createBean(new PaginationClass());
      var eGui = paginationComp.getGui();
      eRootWrapper.insertAdjacentElement("beforeend", eGui);
      additionalEls.push(eGui);
      beansToDestroy.push(paginationComp);
    }
    if (gridCtrl.showWatermark() && WatermarkClass) {
      var watermarkComp = context.createBean(new WatermarkClass());
      var eGui = watermarkComp.getGui();
      eRootWrapper.insertAdjacentElement("beforeend", eGui);
      additionalEls.push(eGui);
      beansToDestroy.push(watermarkComp);
    }
    return function() {
      context.destroyBeans(beansToDestroy);
      additionalEls.forEach(function(el2) {
        if (el2.parentElement) {
          el2.parentElement.removeChild(el2);
        }
      });
    };
  }, [tabGuardReady]);
  var rootWrapperClasses = react_1$2.useMemo(function() {
    return utils_1.classesList("ag-root-wrapper", rtlClass, keyboardFocusClass, layoutClass);
  }, [rtlClass, keyboardFocusClass, layoutClass]);
  var rootWrapperBodyClasses = react_1$2.useMemo(function() {
    return utils_1.classesList("ag-root-wrapper-body", "ag-focus-managed", layoutClass);
  }, [layoutClass]);
  var topStyle = react_1$2.useMemo(function() {
    return {
      userSelect: userSelect != null ? userSelect : "",
      WebkitUserSelect: userSelect != null ? userSelect : "",
      cursor: cursor != null ? cursor : ""
    };
  }, [userSelect, cursor]);
  var eGridBodyParent = eGridBodyParentRef.current;
  var setTabGuardCompRef = react_1$2.useCallback(function(ref) {
    tabGuardRef.current = ref;
    setTabGuardReady(ref !== null);
  }, []);
  return react_1$2.default.createElement(
    "div",
    { ref: eRootWrapperRef, className: rootWrapperClasses, style: topStyle, role: "presentation" },
    react_1$2.default.createElement("div", { className: rootWrapperBodyClasses, ref: eGridBodyParentRef, role: "presentation" }, initialised && eGridBodyParent && beans && react_1$2.default.createElement(
      beansContext_1.BeansContext.Provider,
      { value: beans },
      react_1$2.default.createElement(
        tabGuardComp_1.default,
        { ref: setTabGuardCompRef, eFocusableElement: eGridBodyParent, onTabKeyDown, gridCtrl: gridCtrlRef.current },
        // we wait for initialised before rending the children, so GridComp has created and registered with it's
        // GridCtrl before we create the child GridBodyComp. Otherwise the GridBodyComp would initialise first,
        // before we have set the the Layout CSS classes, causing the GridBodyComp to render rows to a grid that
        // doesn't have it's height specified, which would result if all the rows getting rendered (and if many rows,
        // hangs the UI)
        react_1$2.default.createElement(gridBodyComp_1.default, null)
      )
    ))
  );
};
gridComp.default = react_1$2.memo(GridComp);
var hasRequiredAgGridReactUi;
function requireAgGridReactUi() {
  if (hasRequiredAgGridReactUi)
    return agGridReactUi;
  hasRequiredAgGridReactUi = 1;
  var __extends2 = commonjsGlobal && commonjsGlobal.__extends || function() {
    var extendStatics = function(d, b) {
      extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
        d2.__proto__ = b2;
      } || function(d2, b2) {
        for (var p2 in b2)
          if (Object.prototype.hasOwnProperty.call(b2, p2))
            d2[p2] = b2[p2];
      };
      return extendStatics(d, b);
    };
    return function(d, b) {
      if (typeof b !== "function" && b !== null)
        throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
      extendStatics(d, b);
      function __() {
        this.constructor = d;
      }
      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
  }();
  var __assign2 = commonjsGlobal && commonjsGlobal.__assign || function() {
    __assign2 = Object.assign || function(t2) {
      for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
        s2 = arguments[i];
        for (var p2 in s2)
          if (Object.prototype.hasOwnProperty.call(s2, p2))
            t2[p2] = s2[p2];
      }
      return t2;
    };
    return __assign2.apply(this, arguments);
  };
  var __createBinding2 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
    if (k22 === void 0)
      k22 = k2;
    Object.defineProperty(o, k22, { enumerable: true, get: function() {
      return m2[k2];
    } });
  } : function(o, m2, k2, k22) {
    if (k22 === void 0)
      k22 = k2;
    o[k22] = m2[k2];
  });
  var __setModuleDefault2 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
    Object.defineProperty(o, "default", { enumerable: true, value: v2 });
  } : function(o, v2) {
    o["default"] = v2;
  });
  var __importStar2 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
    if (mod2 && mod2.__esModule)
      return mod2;
    var result = {};
    if (mod2 != null) {
      for (var k2 in mod2)
        if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
          __createBinding2(result, mod2, k2);
    }
    __setModuleDefault2(result, mod2);
    return result;
  };
  var __importDefault2 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
    return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
  };
  Object.defineProperty(agGridReactUi, "__esModule", { value: true });
  agGridReactUi.AgGridReactUi = void 0;
  var ag_grid_community_12 = require$$0;
  var react_12 = __importStar2(reactExports);
  var newReactComponent_12 = newReactComponent;
  var portalManager_12 = portalManager;
  var reactFrameworkOverrides_12 = requireReactFrameworkOverrides();
  var gridComp_1 = __importDefault2(gridComp);
  var AgGridReactUi = function(props) {
    var _a2, _b2;
    var gridOptionsRef = react_12.useRef(null);
    var eGui = react_12.useRef(null);
    var portalManager2 = react_12.useRef(null);
    var destroyFuncs = react_12.useRef([]);
    var whenReadyFuncs = react_12.useRef([]);
    var prevProps = react_12.useRef(props);
    var ready = react_12.useRef(false);
    var _c = react_12.useState(void 0), context = _c[0], setContext = _c[1];
    var checkForDeprecations = react_12.useCallback(function(props2) {
      if (props2.rowDataChangeDetectionStrategy) {
        ag_grid_community_12._.doOnce(function() {
          return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/");
        }, "rowDataChangeDetectionStrategy_Deprecation");
      }
    }, []);
    var _d = react_12.useState(0), setPortalRefresher = _d[1];
    react_12.useLayoutEffect(function() {
      var modules = props.modules || [];
      if (!portalManager2.current) {
        portalManager2.current = new portalManager_12.PortalManager(function() {
          return setPortalRefresher(function(prev) {
            return prev + 1;
          });
        }, props.componentWrappingElement, props.maxComponentCreationTimeMs);
        destroyFuncs.current.push(function() {
          var _a3;
          (_a3 = portalManager2.current) === null || _a3 === void 0 ? void 0 : _a3.destroy();
          portalManager2.current = null;
        });
      }
      var gridParams = {
        providedBeanInstances: {
          frameworkComponentWrapper: new ReactFrameworkComponentWrapper2(portalManager2.current)
        },
        modules,
        frameworkOverrides: new reactFrameworkOverrides_12.ReactFrameworkOverrides(true)
      };
      gridOptionsRef.current = props.gridOptions || {};
      gridOptionsRef.current = ag_grid_community_12.ComponentUtil.copyAttributesToGridOptions(gridOptionsRef.current, props);
      checkForDeprecations(props);
      var createUiCallback = function(context2) {
        setContext(context2);
        destroyFuncs.current.push(function() {
          context2.destroy();
        });
        var ctrlsService = context2.getBean(ag_grid_community_12.CtrlsService.NAME);
        ctrlsService.whenReady(function() {
          if (context2.isDestroyed()) {
            return;
          }
          if (gridOptionsRef.current) {
            var api_1 = gridOptionsRef.current.api;
            if (api_1) {
              if (props.setGridApi) {
                props.setGridApi(api_1, gridOptionsRef.current.columnApi);
              }
              destroyFuncs.current.push(function() {
                api_1.destroy();
              });
            }
          }
        });
      };
      var acceptChangesCallback = function(context2) {
        var ctrlsService = context2.getBean(ag_grid_community_12.CtrlsService.NAME);
        ctrlsService.whenReady(function() {
          whenReadyFuncs.current.forEach(function(f2) {
            return f2();
          });
          whenReadyFuncs.current.length = 0;
          ready.current = true;
        });
      };
      var gridCoreCreator = new ag_grid_community_12.GridCoreCreator();
      gridCoreCreator.create(eGui.current, gridOptionsRef.current, createUiCallback, acceptChangesCallback, gridParams);
      return function() {
        destroyFuncs.current.forEach(function(f2) {
          return f2();
        });
        destroyFuncs.current.length = 0;
      };
    }, []);
    var style2 = react_12.useMemo(function() {
      return __assign2({ height: "100%" }, props.containerStyle || {});
    }, [props.containerStyle]);
    var processWhenReady = react_12.useCallback(function(func) {
      if (ready.current) {
        func();
      } else {
        whenReadyFuncs.current.push(func);
      }
    }, []);
    react_12.useEffect(function() {
      var changes = {};
      extractGridPropertyChanges(prevProps.current, props, changes);
      prevProps.current = props;
      processWhenReady(function() {
        var _a3;
        if ((_a3 = gridOptionsRef.current) === null || _a3 === void 0 ? void 0 : _a3.api) {
          ag_grid_community_12.ComponentUtil.processOnChange(changes, gridOptionsRef.current.api);
        }
      });
    }, [props]);
    return react_12.default.createElement(
      "div",
      { style: style2, className: props.className, ref: eGui },
      context && !context.isDestroyed() ? react_12.default.createElement(gridComp_1.default, { context }) : null,
      (_b2 = (_a2 = portalManager2.current) === null || _a2 === void 0 ? void 0 : _a2.getPortals()) !== null && _b2 !== void 0 ? _b2 : null
    );
  };
  agGridReactUi.AgGridReactUi = AgGridReactUi;
  var ReactFrameworkComponentWrapper2 = (
    /** @class */
    function(_super) {
      __extends2(ReactFrameworkComponentWrapper3, _super);
      function ReactFrameworkComponentWrapper3(parent) {
        var _this = _super.call(this) || this;
        _this.parent = parent;
        return _this;
      }
      ReactFrameworkComponentWrapper3.prototype.createWrapper = function(UserReactComponent, componentType) {
        return new newReactComponent_12.NewReactComponent(UserReactComponent, this.parent, componentType);
      };
      return ReactFrameworkComponentWrapper3;
    }(ag_grid_community_12.BaseComponentWrapper)
  );
  function extractGridPropertyChanges(prevProps, nextProps, changes) {
    var debugLogging = !!nextProps.debug;
    Object.keys(nextProps).forEach(function(propKey) {
      if (ag_grid_community_12.ComponentUtil.ALL_PROPERTIES_SET.has(propKey)) {
        if (prevProps[propKey] !== nextProps[propKey]) {
          if (debugLogging) {
            console.log(" agGridReact: [" + propKey + "] property changed");
          }
          changes[propKey] = {
            previousValue: prevProps[propKey],
            currentValue: nextProps[propKey]
          };
        }
      }
    });
    ag_grid_community_12.ComponentUtil.EVENT_CALLBACKS.forEach(function(funcName) {
      if (prevProps[funcName] !== nextProps[funcName]) {
        if (debugLogging) {
          console.log("agGridReact: [" + funcName + "] event callback changed");
        }
        changes[funcName] = {
          previousValue: prevProps[funcName],
          currentValue: nextProps[funcName]
        };
      }
    });
  }
  return agGridReactUi;
}
var hasRequiredDetailCellRenderer;
function requireDetailCellRenderer() {
  if (hasRequiredDetailCellRenderer)
    return detailCellRenderer;
  hasRequiredDetailCellRenderer = 1;
  var __assign2 = commonjsGlobal && commonjsGlobal.__assign || function() {
    __assign2 = Object.assign || function(t2) {
      for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
        s2 = arguments[i];
        for (var p2 in s2)
          if (Object.prototype.hasOwnProperty.call(s2, p2))
            t2[p2] = s2[p2];
      }
      return t2;
    };
    return __assign2.apply(this, arguments);
  };
  var __createBinding2 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
    if (k22 === void 0)
      k22 = k2;
    Object.defineProperty(o, k22, { enumerable: true, get: function() {
      return m2[k2];
    } });
  } : function(o, m2, k2, k22) {
    if (k22 === void 0)
      k22 = k2;
    o[k22] = m2[k2];
  });
  var __setModuleDefault2 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
    Object.defineProperty(o, "default", { enumerable: true, value: v2 });
  } : function(o, v2) {
    o["default"] = v2;
  });
  var __importStar2 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
    if (mod2 && mod2.__esModule)
      return mod2;
    var result = {};
    if (mod2 != null) {
      for (var k2 in mod2)
        if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
          __createBinding2(result, mod2, k2);
    }
    __setModuleDefault2(result, mod2);
    return result;
  };
  Object.defineProperty(detailCellRenderer, "__esModule", { value: true });
  var react_12 = __importStar2(reactExports);
  var utils_12 = utils;
  var ag_grid_community_12 = require$$0;
  var beansContext_12 = beansContext;
  var agGridReactUi_12 = requireAgGridReactUi();
  var useEffectOnce_12 = useEffectOnce$1;
  var DetailCellRenderer = function(props, ref) {
    var _a2 = react_12.useContext(beansContext_12.BeansContext), ctrlsFactory = _a2.ctrlsFactory, context = _a2.context, gridOptionsService = _a2.gridOptionsService, resizeObserverService = _a2.resizeObserverService, clientSideRowModel = _a2.clientSideRowModel, serverSideRowModel = _a2.serverSideRowModel;
    var _b2 = react_12.useState(new utils_12.CssClasses()), cssClasses = _b2[0], setCssClasses = _b2[1];
    var _c = react_12.useState(new utils_12.CssClasses()), gridCssClasses = _c[0], setGridCssClasses = _c[1];
    var _d = react_12.useState(), detailGridOptions = _d[0], setDetailGridOptions = _d[1];
    var _e = react_12.useState(), detailRowData = _e[0], setDetailRowData = _e[1];
    var ctrlRef = react_12.useRef();
    var eGuiRef = react_12.useRef(null);
    var parentModules = react_12.useMemo(function() {
      return ag_grid_community_12.ModuleRegistry.__getGridRegisteredModules(props.api.getGridId());
    }, [props]);
    var topClassName = react_12.useMemo(function() {
      return cssClasses.toString() + " ag-details-row";
    }, [cssClasses]);
    var gridClassName = react_12.useMemo(function() {
      return gridCssClasses.toString() + " ag-details-grid";
    }, [gridCssClasses]);
    if (ref) {
      react_12.useImperativeHandle(ref, function() {
        return {
          refresh: function() {
            var _a3, _b3;
            return (_b3 = (_a3 = ctrlRef.current) === null || _a3 === void 0 ? void 0 : _a3.refresh()) !== null && _b3 !== void 0 ? _b3 : false;
          }
        };
      });
    }
    useEffectOnce_12.useLayoutEffectOnce(function() {
      if (props.template && typeof props.template === "string") {
        console.warn("AG Grid: detailCellRendererParams.template is not supported by React - this only works with frameworks that work against String templates. To change the template, please provide your own React Detail Cell Renderer.");
      }
    });
    useEffectOnce_12.useLayoutEffectOnce(function() {
      var compProxy = {
        addOrRemoveCssClass: function(name, on) {
          return setCssClasses(function(prev) {
            return prev.setClass(name, on);
          });
        },
        addOrRemoveDetailGridCssClass: function(name, on) {
          return setGridCssClasses(function(prev) {
            return prev.setClass(name, on);
          });
        },
        setDetailGrid: function(gridOptions) {
          return setDetailGridOptions(gridOptions);
        },
        setRowData: function(rowData) {
          return setDetailRowData(rowData);
        },
        getGui: function() {
          return eGuiRef.current;
        }
      };
      var ctrl = ctrlsFactory.getInstance("detailCellRenderer");
      if (!ctrl) {
        return;
      }
      context.createBean(ctrl);
      ctrl.init(compProxy, props);
      ctrlRef.current = ctrl;
      var resizeObserverDestroyFunc;
      if (gridOptionsService.is("detailRowAutoHeight")) {
        var checkRowSizeFunc = function() {
          if (eGuiRef.current == null) {
            return;
          }
          var clientHeight = eGuiRef.current.clientHeight;
          if (clientHeight != null && clientHeight > 0) {
            var updateRowHeightFunc = function() {
              props.node.setRowHeight(clientHeight);
              if (clientSideRowModel) {
                clientSideRowModel.onRowHeightChanged();
              } else if (serverSideRowModel) {
                serverSideRowModel.onRowHeightChanged();
              }
            };
            setTimeout(updateRowHeightFunc, 0);
          }
        };
        resizeObserverDestroyFunc = resizeObserverService.observeResize(eGuiRef.current, checkRowSizeFunc);
        checkRowSizeFunc();
      }
      return function() {
        context.destroyBean(ctrl);
        if (resizeObserverDestroyFunc) {
          resizeObserverDestroyFunc();
        }
      };
    });
    var setGridApi = react_12.useCallback(function(api, columnApi) {
      var _a3;
      (_a3 = ctrlRef.current) === null || _a3 === void 0 ? void 0 : _a3.registerDetailWithMaster(api, columnApi);
    }, []);
    return react_12.default.createElement("div", { className: topClassName, ref: eGuiRef }, detailGridOptions && react_12.default.createElement(agGridReactUi_12.AgGridReactUi, __assign2({ className: gridClassName }, detailGridOptions, { modules: parentModules, rowData: detailRowData, setGridApi })));
  };
  detailCellRenderer.default = react_12.forwardRef(DetailCellRenderer);
  return detailCellRenderer;
}
var hasRequiredReactFrameworkOverrides;
function requireReactFrameworkOverrides() {
  if (hasRequiredReactFrameworkOverrides)
    return reactFrameworkOverrides;
  hasRequiredReactFrameworkOverrides = 1;
  var __extends2 = commonjsGlobal && commonjsGlobal.__extends || function() {
    var extendStatics = function(d, b) {
      extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
        d2.__proto__ = b2;
      } || function(d2, b2) {
        for (var p2 in b2)
          if (Object.prototype.hasOwnProperty.call(b2, p2))
            d2[p2] = b2[p2];
      };
      return extendStatics(d, b);
    };
    return function(d, b) {
      if (typeof b !== "function" && b !== null)
        throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
      extendStatics(d, b);
      function __() {
        this.constructor = d;
      }
      d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
  }();
  var __importDefault2 = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
    return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
  };
  Object.defineProperty(reactFrameworkOverrides, "__esModule", { value: true });
  reactFrameworkOverrides.ReactFrameworkOverrides = void 0;
  var ag_grid_community_12 = require$$0;
  var groupCellRenderer_1 = __importDefault2(groupCellRenderer);
  var detailCellRenderer_1 = __importDefault2(requireDetailCellRenderer());
  var ReactFrameworkOverrides = (
    /** @class */
    function(_super) {
      __extends2(ReactFrameworkOverrides2, _super);
      function ReactFrameworkOverrides2(reactUi) {
        var _this = _super.call(this) || this;
        _this.frameworkComponents = {
          agGroupCellRenderer: groupCellRenderer_1.default,
          agGroupRowRenderer: groupCellRenderer_1.default,
          agDetailCellRenderer: detailCellRenderer_1.default
        };
        _this.reactUi = reactUi;
        _this.renderingEngine = reactUi ? "react" : "vanilla";
        return _this;
      }
      ReactFrameworkOverrides2.prototype.frameworkComponent = function(name) {
        if (!this.reactUi) {
          return;
        }
        return this.frameworkComponents[name];
      };
      ReactFrameworkOverrides2.prototype.isFrameworkComponent = function(comp) {
        if (!comp) {
          return false;
        }
        var prototype = comp.prototype;
        var isJsComp = prototype && "getGui" in prototype;
        return !isJsComp;
      };
      return ReactFrameworkOverrides2;
    }(ag_grid_community_12.VanillaFrameworkOverrides)
  );
  reactFrameworkOverrides.ReactFrameworkOverrides = ReactFrameworkOverrides;
  return reactFrameworkOverrides;
}
var __extends$1 = commonjsGlobal && commonjsGlobal.__extends || function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign$1 = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign$1 = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign$1.apply(this, arguments);
};
var __createBinding$1 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault$1 = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar$1 = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding$1(result, mod2, k2);
  }
  __setModuleDefault$1(result, mod2);
  return result;
};
var __importDefault = commonjsGlobal && commonjsGlobal.__importDefault || function(mod2) {
  return mod2 && mod2.__esModule ? mod2 : { "default": mod2 };
};
Object.defineProperty(agGridReactLegacy, "__esModule", { value: true });
agGridReactLegacy.AgGridReactLegacy = void 0;
var ag_grid_community_1 = require$$0;
var prop_types_1 = __importDefault(propTypesExports);
var react_1$1 = __importStar$1(reactExports);
var legacyReactComponent_1 = legacyReactComponent;
var newReactComponent_1 = newReactComponent;
var portalManager_1 = portalManager;
var reactFrameworkOverrides_1 = requireReactFrameworkOverrides();
var AgGridReactLegacy = (
  /** @class */
  function(_super) {
    __extends$1(AgGridReactLegacy2, _super);
    function AgGridReactLegacy2(props) {
      var _this = _super.call(this, props) || this;
      _this.props = props;
      _this.api = null;
      _this.destroyed = false;
      _this.SYNCHRONOUS_CHANGE_PROPERTIES = ["context"];
      _this.portalManager = new portalManager_1.LegacyPortalManager(_this, props.componentWrappingElement, props.maxComponentCreationTimeMs);
      return _this;
    }
    AgGridReactLegacy2.prototype.render = function() {
      var _this = this;
      return react_1$1.default.createElement("div", {
        style: this.createStyleForDiv(),
        className: this.props.className,
        ref: function(e) {
          _this.eGridDiv = e;
        }
      }, this.portalManager.getPortals());
    };
    AgGridReactLegacy2.prototype.createStyleForDiv = function() {
      return __assign$1({ height: "100%" }, this.props.containerStyle || {});
    };
    AgGridReactLegacy2.prototype.componentDidMount = function() {
      var modules = this.props.modules || [];
      var gridParams = {
        providedBeanInstances: {
          agGridReact: this,
          frameworkComponentWrapper: new ReactFrameworkComponentWrapper(this, this.portalManager)
        },
        modules,
        frameworkOverrides: new reactFrameworkOverrides_1.ReactFrameworkOverrides(false)
      };
      var gridOptions = this.props.gridOptions || {};
      this.gridOptions = ag_grid_community_1.ComponentUtil.copyAttributesToGridOptions(gridOptions, this.props);
      this.checkForDeprecations(this.props);
      new ag_grid_community_1.Grid(this.eGridDiv, this.gridOptions, gridParams);
      this.api = this.gridOptions.api;
      this.columnApi = this.gridOptions.columnApi;
      this.props.setGridApi(this.api, this.columnApi);
    };
    AgGridReactLegacy2.prototype.checkForDeprecations = function(props) {
      if (props.rowDataChangeDetectionStrategy) {
        ag_grid_community_1._.doOnce(function() {
          return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/");
        }, "rowDataChangeDetectionStrategy_Deprecation");
      }
    };
    AgGridReactLegacy2.prototype.shouldComponentUpdate = function(nextProps) {
      this.processPropsChanges(this.props, nextProps);
      return false;
    };
    AgGridReactLegacy2.prototype.componentDidUpdate = function(prevProps) {
      this.processPropsChanges(prevProps, this.props);
    };
    AgGridReactLegacy2.prototype.processPropsChanges = function(prevProps, nextProps) {
      var changes = {};
      this.extractGridPropertyChanges(prevProps, nextProps, changes);
      this.processSynchronousChanges(changes);
      this.processAsynchronousChanges(changes);
    };
    AgGridReactLegacy2.prototype.extractGridPropertyChanges = function(prevProps, nextProps, changes) {
      var debugLogging = !!nextProps.debug;
      Object.keys(nextProps).forEach(function(propKey) {
        if (ag_grid_community_1.ComponentUtil.ALL_PROPERTIES_SET.has(propKey)) {
          if (prevProps[propKey] !== nextProps[propKey]) {
            if (debugLogging) {
              console.log("agGridReact: [" + propKey + "] property changed");
            }
            changes[propKey] = {
              previousValue: prevProps[propKey],
              currentValue: nextProps[propKey]
            };
          }
        }
      });
      ag_grid_community_1.ComponentUtil.EVENT_CALLBACKS.forEach(function(funcName) {
        if (prevProps[funcName] !== nextProps[funcName]) {
          if (debugLogging) {
            console.log("agGridReact: [" + funcName + "] event callback changed");
          }
          changes[funcName] = {
            previousValue: prevProps[funcName],
            currentValue: nextProps[funcName]
          };
        }
      });
    };
    AgGridReactLegacy2.prototype.componentWillUnmount = function() {
      if (this.api) {
        this.api.destroy();
        this.api = null;
      }
      this.destroyed = true;
      this.portalManager.destroy();
    };
    AgGridReactLegacy2.prototype.isDisableStaticMarkup = function() {
      return this.props.disableStaticMarkup === true;
    };
    AgGridReactLegacy2.prototype.isLegacyComponentRendering = function() {
      return this.props.legacyComponentRendering === true;
    };
    AgGridReactLegacy2.prototype.processSynchronousChanges = function(changes) {
      var asyncChanges = __assign$1({}, changes);
      if (Object.keys(asyncChanges).length > 0) {
        var synchronousChanges_1 = {};
        this.SYNCHRONOUS_CHANGE_PROPERTIES.forEach(function(synchronousChangeProperty) {
          if (asyncChanges[synchronousChangeProperty]) {
            synchronousChanges_1[synchronousChangeProperty] = asyncChanges[synchronousChangeProperty];
            delete asyncChanges[synchronousChangeProperty];
          }
        });
        if (Object.keys(synchronousChanges_1).length > 0 && !!this.api) {
          ag_grid_community_1.ComponentUtil.processOnChange(synchronousChanges_1, this.api);
        }
      }
      return asyncChanges;
    };
    AgGridReactLegacy2.prototype.processAsynchronousChanges = function(changes) {
      var _this = this;
      if (Object.keys(changes).length > 0) {
        window.setTimeout(function() {
          if (_this.api) {
            ag_grid_community_1.ComponentUtil.processOnChange(changes, _this.api);
          }
        });
      }
    };
    AgGridReactLegacy2.MAX_COMPONENT_CREATION_TIME_IN_MS = 1e3;
    AgGridReactLegacy2.defaultProps = {
      legacyComponentRendering: false,
      disableStaticMarkup: false,
      maxComponentCreationTimeMs: AgGridReactLegacy2.MAX_COMPONENT_CREATION_TIME_IN_MS
    };
    return AgGridReactLegacy2;
  }(react_1$1.Component)
);
agGridReactLegacy.AgGridReactLegacy = AgGridReactLegacy;
AgGridReactLegacy.propTypes = {
  gridOptions: prop_types_1.default.object
};
addProperties(ag_grid_community_1.ComponentUtil.EVENT_CALLBACKS, prop_types_1.default.func);
addProperties(ag_grid_community_1.ComponentUtil.BOOLEAN_PROPERTIES, prop_types_1.default.bool);
addProperties(ag_grid_community_1.ComponentUtil.STRING_PROPERTIES, prop_types_1.default.string);
addProperties(ag_grid_community_1.ComponentUtil.OBJECT_PROPERTIES, prop_types_1.default.object);
addProperties(ag_grid_community_1.ComponentUtil.ARRAY_PROPERTIES, prop_types_1.default.array);
addProperties(ag_grid_community_1.ComponentUtil.NUMBER_PROPERTIES, prop_types_1.default.number);
addProperties(ag_grid_community_1.ComponentUtil.FUNCTION_PROPERTIES, prop_types_1.default.func);
function addProperties(listOfProps, propType) {
  listOfProps.forEach(function(propKey) {
    AgGridReactLegacy[propKey] = propType;
  });
}
var ReactFrameworkComponentWrapper = (
  /** @class */
  function(_super) {
    __extends$1(ReactFrameworkComponentWrapper2, _super);
    function ReactFrameworkComponentWrapper2(agGridReact2, portalManager2) {
      var _this = _super.call(this) || this;
      _this.agGridReact = agGridReact2;
      _this.portalManager = portalManager2;
      return _this;
    }
    ReactFrameworkComponentWrapper2.prototype.createWrapper = function(UserReactComponent, componentType) {
      if (this.agGridReact.isLegacyComponentRendering()) {
        return new legacyReactComponent_1.LegacyReactComponent(UserReactComponent, this.agGridReact, this.portalManager, componentType);
      } else {
        return new newReactComponent_1.NewReactComponent(UserReactComponent, this.portalManager, componentType);
      }
    };
    return ReactFrameworkComponentWrapper2;
  }(ag_grid_community_1.BaseComponentWrapper)
);
var __extends = commonjsGlobal && commonjsGlobal.__extends || function() {
  var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d2, b2) {
      d2.__proto__ = b2;
    } || function(d2, b2) {
      for (var p2 in b2)
        if (Object.prototype.hasOwnProperty.call(b2, p2))
          d2[p2] = b2[p2];
    };
    return extendStatics(d, b);
  };
  return function(d, b) {
    if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
var __assign = commonjsGlobal && commonjsGlobal.__assign || function() {
  __assign = Object.assign || function(t2) {
    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {
      s2 = arguments[i];
      for (var p2 in s2)
        if (Object.prototype.hasOwnProperty.call(s2, p2))
          t2[p2] = s2[p2];
    }
    return t2;
  };
  return __assign.apply(this, arguments);
};
var __createBinding = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  Object.defineProperty(o, k22, { enumerable: true, get: function() {
    return m2[k2];
  } });
} : function(o, m2, k2, k22) {
  if (k22 === void 0)
    k22 = k2;
  o[k22] = m2[k2];
});
var __setModuleDefault = commonjsGlobal && commonjsGlobal.__setModuleDefault || (Object.create ? function(o, v2) {
  Object.defineProperty(o, "default", { enumerable: true, value: v2 });
} : function(o, v2) {
  o["default"] = v2;
});
var __importStar = commonjsGlobal && commonjsGlobal.__importStar || function(mod2) {
  if (mod2 && mod2.__esModule)
    return mod2;
  var result = {};
  if (mod2 != null) {
    for (var k2 in mod2)
      if (k2 !== "default" && Object.prototype.hasOwnProperty.call(mod2, k2))
        __createBinding(result, mod2, k2);
  }
  __setModuleDefault(result, mod2);
  return result;
};
Object.defineProperty(agGridReact, "__esModule", { value: true });
agGridReact.AgGridReact = void 0;
var react_1 = __importStar(reactExports);
var agGridReactLegacy_1 = agGridReactLegacy;
var agGridReactUi_1 = requireAgGridReactUi();
var AgGridReact = (
  /** @class */
  function(_super) {
    __extends(AgGridReact2, _super);
    function AgGridReact2() {
      var _this = _super !== null && _super.apply(this, arguments) || this;
      _this.setGridApi = function(api, columnApi) {
        _this.api = api;
        _this.columnApi = columnApi;
      };
      return _this;
    }
    AgGridReact2.prototype.render = function() {
      var ReactComponentToUse = this.props.suppressReactUi ? react_1.default.createElement(agGridReactLegacy_1.AgGridReactLegacy, __assign({}, this.props, { setGridApi: this.setGridApi })) : react_1.default.createElement(agGridReactUi_1.AgGridReactUi, __assign({}, this.props, { setGridApi: this.setGridApi }));
      return ReactComponentToUse;
    };
    return AgGridReact2;
  }(react_1.Component)
);
agGridReact.AgGridReact = AgGridReact;
var interfaces = {};
(function(exports) {
  Object.defineProperty(exports, "__esModule", { value: true });
  exports.ChangeDetectionStrategyType = void 0;
  (function(ChangeDetectionStrategyType) {
    ChangeDetectionStrategyType["IdentityCheck"] = "IdentityCheck";
    ChangeDetectionStrategyType["DeepValueCheck"] = "DeepValueCheck";
    ChangeDetectionStrategyType["NoCheck"] = "NoCheck";
  })(exports.ChangeDetectionStrategyType || (exports.ChangeDetectionStrategyType = {}));
})(interfaces);
(function(exports) {
  var __createBinding2 = commonjsGlobal && commonjsGlobal.__createBinding || (Object.create ? function(o, m2, k2, k22) {
    if (k22 === void 0)
      k22 = k2;
    Object.defineProperty(o, k22, { enumerable: true, get: function() {
      return m2[k2];
    } });
  } : function(o, m2, k2, k22) {
    if (k22 === void 0)
      k22 = k2;
    o[k22] = m2[k2];
  });
  var __exportStar = commonjsGlobal && commonjsGlobal.__exportStar || function(m2, exports2) {
    for (var p2 in m2)
      if (p2 !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p2))
        __createBinding2(exports2, m2, p2);
  };
  Object.defineProperty(exports, "__esModule", { value: true });
  exports.AgGridReactFire = exports.AgGridReactLegacy = exports.AgGridReact = void 0;
  var agGridReact_1 = agGridReact;
  Object.defineProperty(exports, "AgGridReact", { enumerable: true, get: function() {
    return agGridReact_1.AgGridReact;
  } });
  var agGridReactLegacy_12 = agGridReactLegacy;
  Object.defineProperty(exports, "AgGridReactLegacy", { enumerable: true, get: function() {
    return agGridReactLegacy_12.AgGridReactLegacy;
  } });
  var agGridReactUi_12 = requireAgGridReactUi();
  Object.defineProperty(exports, "AgGridReactFire", { enumerable: true, get: function() {
    return agGridReactUi_12.AgGridReactUi;
  } });
  __exportStar(interfaces, exports);
})(main);
const agGrid = "";
const agThemeAlpine = "";
const showApiLines = "" + new URL("show_api_lines-c7468f01.png", import.meta.url).href;
const ROW_HEIGHT$3 = 25;
function Subscriptions$1({ parentModel }) {
  const [subscriptions, setSubscriptions] = reactExports.useState(store.subscriptions);
  const gridApi = reactExports.useRef(null);
  const [columnDefs] = reactExports.useState([
    {
      field: "subscriptionTime",
      headerName: "Created",
      width: 130,
      resizable: true,
      cellStyle: { textAlign: "left" },
      enableCellChangeFlash: true,
      sortable: true,
      valueFormatter: (p2) => {
        return p2.data.subscriptionTime.substring(11, 24);
      }
    },
    {
      field: "updateTime",
      headerName: "Updated",
      width: 130,
      resizable: true,
      cellStyle: { textAlign: "left" },
      enableCellChangeFlash: true,
      sortable: true,
      valueFormatter: (p2) => {
        return p2.data.updateTime.substring(11, 24);
      }
    },
    { field: "subject", width: 400, resizable: true, cellStyle: { textAlign: "left" }, sortable: true },
    { field: "type", width: 80, resizable: true, cellStyle: { textAlign: "left" }, sortable: true },
    {
      field: "updateCount",
      headerName: "Updates",
      width: 100,
      resizable: true,
      cellStyle: { textAlign: "left" },
      enableCellChangeFlash: true,
      sortable: true
    },
    {
      field: "elementCount",
      headerName: "Count",
      width: 100,
      resizable: true,
      cellStyle: { textAlign: "left" },
      enableCellChangeFlash: true,
      sortable: true,
      valueFormatter: (p2) => {
        return p2.data.type === "container" ? String(p2.data.elementCount) : "";
      }
    },
    {
      field: "params",
      headerName: "Parameters",
      width: 1e3,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true,
      valueFormatter: (p2) => {
        const { subscriptionId, subject, ...rest } = p2.data.params;
        return JSON.stringify(rest);
      }
    }
  ]);
  reactExports.useEffect(() => {
    const listener = (message) => {
      setSubscriptions(message.subscriptions);
    };
    events.on("initial", listener);
    events.on("update", listener);
    return () => {
      events.off("initial", listener);
      events.off("update", listener);
    };
  }, []);
  const onRowSelected = (event) => {
    if (event.node.isSelected()) {
      const rowData = event.data;
      if (chrome && chrome.devtools) {
        store.port.postMessage({ type: "setSubscriptionId", subscriptionId: rowData.subscriptionId });
      } else {
        store.portToStreamLink.postMessage({
          type: "setSubscriptionId",
          subscriptionId: rowData.subscriptionId
        });
      }
    }
  };
  const getRowId = (r2) => {
    return r2.data.subscriptionId;
  };
  const onRowDoubleClicked = (r2) => {
    showAPILines(r2.data.subscriptionId);
  };
  const showAPILines = (subscriptionId) => {
    parentModel.doAction(Actions.selectTab("apilog"));
    setTimeout(() => {
      events.emit("externalFilterChange", subscriptionId);
    }, 0);
  };
  const onShowAPILines = () => {
    const selectedData = gridApi.current.getSelectedRows();
    if (selectedData.length === 1) {
      showAPILines(selectedData[0].subscriptionId);
    }
  };
  const getRowStyle = (params) => {
    const data = params.data;
    if (data.type === "container") {
      return { background: "#E4F9F5" };
    }
    return { background: "transparent" };
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "container ag-theme-alpine", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "toolbar-outer", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        className: "toolbar-button",
        title: "Show related API Lines",
        onClick: onShowAPILines,
        children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { className: "toolbar-icon", tabIndex: -1, src: showApiLines })
      }
    ) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      main.AgGridReact,
      {
        rowData: subscriptions,
        rowSelection: "single",
        onRowSelected,
        onRowDoubleClicked,
        rowHeight: ROW_HEIGHT$3,
        getRowId,
        headerHeight: ROW_HEIGHT$3,
        columnDefs,
        onGridReady: (p2) => gridApi.current = p2.api,
        gridOptions: {
          getRowStyle
        }
      }
    )
  ] });
}
var __create = Object.create;
var __defProp2 = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __commonJS = (cb2, mod2) => function __require() {
  return mod2 || (0, cb2[__getOwnPropNames(cb2)[0]])((mod2 = { exports: {} }).exports, mod2), mod2.exports;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp2(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to2, from2, except, desc) => {
  if (from2 && typeof from2 === "object" || typeof from2 === "function") {
    for (let key of __getOwnPropNames(from2))
      if (!__hasOwnProp.call(to2, key) && key !== except)
        __defProp2(to2, key, { get: () => from2[key], enumerable: !(desc = __getOwnPropDesc(from2, key)) || desc.enumerable });
  }
  return to2;
};
var __toESM = (mod2, isNodeMode, target) => (target = mod2 != null ? __create(__getProtoOf(mod2)) : {}, __copyProps(isNodeMode || !mod2 || !mod2.__esModule ? __defProp2(target, "default", { value: mod2, enumerable: true }) : target, mod2));
var require_is_object = __commonJS({
  "node_modules/is-object/index.js"(exports, module2) {
    module2.exports = function isObject2(x2) {
      return typeof x2 === "object" && x2 !== null;
    };
  }
});
var require_is_window = __commonJS({
  "node_modules/is-window/index.js"(exports, module2) {
    module2.exports = function(obj) {
      if (obj == null) {
        return false;
      }
      var o = Object(obj);
      return o === o.window;
    };
  }
});
var require_is_dom = __commonJS({
  "node_modules/is-dom/index.js"(exports, module2) {
    var isObject2 = require_is_object();
    var isWindow = require_is_window();
    function isNode(val) {
      if (!isObject2(val) || !isWindow(window) || typeof window.Node !== "function") {
        return false;
      }
      return typeof val.nodeType === "number" && typeof val.nodeName === "string";
    }
    module2.exports = isNode;
  }
});
var themes_exports = {};
__export(themes_exports, {
  chromeDark: () => theme,
  chromeLight: () => theme2
});
var theme = {
  BASE_FONT_FAMILY: "Menlo, monospace",
  BASE_FONT_SIZE: "11px",
  BASE_LINE_HEIGHT: 1.2,
  BASE_BACKGROUND_COLOR: "rgb(36, 36, 36)",
  BASE_COLOR: "rgb(213, 213, 213)",
  OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES: 10,
  OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES: 5,
  OBJECT_NAME_COLOR: "rgb(227, 110, 236)",
  OBJECT_VALUE_NULL_COLOR: "rgb(127, 127, 127)",
  OBJECT_VALUE_UNDEFINED_COLOR: "rgb(127, 127, 127)",
  OBJECT_VALUE_REGEXP_COLOR: "rgb(233, 63, 59)",
  OBJECT_VALUE_STRING_COLOR: "rgb(233, 63, 59)",
  OBJECT_VALUE_SYMBOL_COLOR: "rgb(233, 63, 59)",
  OBJECT_VALUE_NUMBER_COLOR: "hsl(252, 100%, 75%)",
  OBJECT_VALUE_BOOLEAN_COLOR: "hsl(252, 100%, 75%)",
  OBJECT_VALUE_FUNCTION_PREFIX_COLOR: "rgb(85, 106, 242)",
  HTML_TAG_COLOR: "rgb(93, 176, 215)",
  HTML_TAGNAME_COLOR: "rgb(93, 176, 215)",
  HTML_TAGNAME_TEXT_TRANSFORM: "lowercase",
  HTML_ATTRIBUTE_NAME_COLOR: "rgb(155, 187, 220)",
  HTML_ATTRIBUTE_VALUE_COLOR: "rgb(242, 151, 102)",
  HTML_COMMENT_COLOR: "rgb(137, 137, 137)",
  HTML_DOCTYPE_COLOR: "rgb(192, 192, 192)",
  ARROW_COLOR: "rgb(145, 145, 145)",
  ARROW_MARGIN_RIGHT: 3,
  ARROW_FONT_SIZE: 12,
  ARROW_ANIMATION_DURATION: "0",
  TREENODE_FONT_FAMILY: "Menlo, monospace",
  TREENODE_FONT_SIZE: "11px",
  TREENODE_LINE_HEIGHT: 1.2,
  TREENODE_PADDING_LEFT: 12,
  TABLE_BORDER_COLOR: "rgb(85, 85, 85)",
  TABLE_TH_BACKGROUND_COLOR: "rgb(44, 44, 44)",
  TABLE_TH_HOVER_COLOR: "rgb(48, 48, 48)",
  TABLE_SORT_ICON_COLOR: "black",
  TABLE_DATA_BACKGROUND_IMAGE: "linear-gradient(rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(51, 139, 255, 0.0980392) 50%, rgba(51, 139, 255, 0.0980392))",
  TABLE_DATA_BACKGROUND_SIZE: "128px 32px"
};
var theme2 = {
  BASE_FONT_FAMILY: "Menlo, monospace",
  BASE_FONT_SIZE: "11px",
  BASE_LINE_HEIGHT: 1.2,
  BASE_BACKGROUND_COLOR: "white",
  BASE_COLOR: "black",
  OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES: 10,
  OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES: 5,
  OBJECT_NAME_COLOR: "rgb(136, 19, 145)",
  OBJECT_VALUE_NULL_COLOR: "rgb(128, 128, 128)",
  OBJECT_VALUE_UNDEFINED_COLOR: "rgb(128, 128, 128)",
  OBJECT_VALUE_REGEXP_COLOR: "rgb(196, 26, 22)",
  OBJECT_VALUE_STRING_COLOR: "rgb(196, 26, 22)",
  OBJECT_VALUE_SYMBOL_COLOR: "rgb(196, 26, 22)",
  OBJECT_VALUE_NUMBER_COLOR: "rgb(28, 0, 207)",
  OBJECT_VALUE_BOOLEAN_COLOR: "rgb(28, 0, 207)",
  OBJECT_VALUE_FUNCTION_PREFIX_COLOR: "rgb(13, 34, 170)",
  HTML_TAG_COLOR: "rgb(168, 148, 166)",
  HTML_TAGNAME_COLOR: "rgb(136, 18, 128)",
  HTML_TAGNAME_TEXT_TRANSFORM: "lowercase",
  HTML_ATTRIBUTE_NAME_COLOR: "rgb(153, 69, 0)",
  HTML_ATTRIBUTE_VALUE_COLOR: "rgb(26, 26, 166)",
  HTML_COMMENT_COLOR: "rgb(35, 110, 37)",
  HTML_DOCTYPE_COLOR: "rgb(192, 192, 192)",
  ARROW_COLOR: "#6e6e6e",
  ARROW_MARGIN_RIGHT: 3,
  ARROW_FONT_SIZE: 12,
  ARROW_ANIMATION_DURATION: "0",
  TREENODE_FONT_FAMILY: "Menlo, monospace",
  TREENODE_FONT_SIZE: "11px",
  TREENODE_LINE_HEIGHT: 1.2,
  TREENODE_PADDING_LEFT: 12,
  TABLE_BORDER_COLOR: "#aaa",
  TABLE_TH_BACKGROUND_COLOR: "#eee",
  TABLE_TH_HOVER_COLOR: "hsla(0, 0%, 90%, 1)",
  TABLE_SORT_ICON_COLOR: "#6e6e6e",
  TABLE_DATA_BACKGROUND_IMAGE: "linear-gradient(to bottom, white, white 50%, rgb(234, 243, 255) 50%, rgb(234, 243, 255))",
  TABLE_DATA_BACKGROUND_SIZE: "128px 32px"
};
var ExpandedPathsContext = reactExports.createContext([{}, () => {
}]);
var unselectable = {
  WebkitTouchCallout: "none",
  WebkitUserSelect: "none",
  KhtmlUserSelect: "none",
  MozUserSelect: "none",
  msUserSelect: "none",
  OUserSelect: "none",
  userSelect: "none"
};
var createTheme = (theme3) => ({
  DOMNodePreview: {
    htmlOpenTag: {
      base: {
        color: theme3.HTML_TAG_COLOR
      },
      tagName: {
        color: theme3.HTML_TAGNAME_COLOR,
        textTransform: theme3.HTML_TAGNAME_TEXT_TRANSFORM
      },
      htmlAttributeName: {
        color: theme3.HTML_ATTRIBUTE_NAME_COLOR
      },
      htmlAttributeValue: {
        color: theme3.HTML_ATTRIBUTE_VALUE_COLOR
      }
    },
    htmlCloseTag: {
      base: {
        color: theme3.HTML_TAG_COLOR
      },
      offsetLeft: {
        marginLeft: -theme3.TREENODE_PADDING_LEFT
      },
      tagName: {
        color: theme3.HTML_TAGNAME_COLOR,
        textTransform: theme3.HTML_TAGNAME_TEXT_TRANSFORM
      }
    },
    htmlComment: {
      color: theme3.HTML_COMMENT_COLOR
    },
    htmlDoctype: {
      color: theme3.HTML_DOCTYPE_COLOR
    }
  },
  ObjectPreview: {
    objectDescription: {
      fontStyle: "italic"
    },
    preview: {
      fontStyle: "italic"
    },
    arrayMaxProperties: theme3.OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES,
    objectMaxProperties: theme3.OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES
  },
  ObjectName: {
    base: {
      color: theme3.OBJECT_NAME_COLOR
    },
    dimmed: {
      opacity: 0.6
    }
  },
  ObjectValue: {
    objectValueNull: {
      color: theme3.OBJECT_VALUE_NULL_COLOR
    },
    objectValueUndefined: {
      color: theme3.OBJECT_VALUE_UNDEFINED_COLOR
    },
    objectValueRegExp: {
      color: theme3.OBJECT_VALUE_REGEXP_COLOR
    },
    objectValueString: {
      color: theme3.OBJECT_VALUE_STRING_COLOR
    },
    objectValueSymbol: {
      color: theme3.OBJECT_VALUE_SYMBOL_COLOR
    },
    objectValueNumber: {
      color: theme3.OBJECT_VALUE_NUMBER_COLOR
    },
    objectValueBoolean: {
      color: theme3.OBJECT_VALUE_BOOLEAN_COLOR
    },
    objectValueFunctionPrefix: {
      color: theme3.OBJECT_VALUE_FUNCTION_PREFIX_COLOR,
      fontStyle: "italic"
    },
    objectValueFunctionName: {
      fontStyle: "italic"
    }
  },
  TreeView: {
    treeViewOutline: {
      padding: 0,
      margin: 0,
      listStyleType: "none"
    }
  },
  TreeNode: {
    treeNodeBase: {
      color: theme3.BASE_COLOR,
      backgroundColor: theme3.BASE_BACKGROUND_COLOR,
      lineHeight: theme3.TREENODE_LINE_HEIGHT,
      cursor: "default",
      boxSizing: "border-box",
      listStyle: "none",
      fontFamily: theme3.TREENODE_FONT_FAMILY,
      fontSize: theme3.TREENODE_FONT_SIZE
    },
    treeNodePreviewContainer: {},
    treeNodePlaceholder: {
      whiteSpace: "pre",
      fontSize: theme3.ARROW_FONT_SIZE,
      marginRight: theme3.ARROW_MARGIN_RIGHT,
      ...unselectable
    },
    treeNodeArrow: {
      base: {
        color: theme3.ARROW_COLOR,
        display: "inline-block",
        fontSize: theme3.ARROW_FONT_SIZE,
        marginRight: theme3.ARROW_MARGIN_RIGHT,
        ...parseFloat(theme3.ARROW_ANIMATION_DURATION) > 0 ? {
          transition: `transform ${theme3.ARROW_ANIMATION_DURATION} ease 0s`
        } : {},
        ...unselectable
      },
      expanded: {
        WebkitTransform: "rotateZ(90deg)",
        MozTransform: "rotateZ(90deg)",
        transform: "rotateZ(90deg)"
      },
      collapsed: {
        WebkitTransform: "rotateZ(0deg)",
        MozTransform: "rotateZ(0deg)",
        transform: "rotateZ(0deg)"
      }
    },
    treeNodeChildNodesContainer: {
      margin: 0,
      paddingLeft: theme3.TREENODE_PADDING_LEFT
    }
  },
  TableInspector: {
    base: {
      color: theme3.BASE_COLOR,
      position: "relative",
      border: `1px solid ${theme3.TABLE_BORDER_COLOR}`,
      fontFamily: theme3.BASE_FONT_FAMILY,
      fontSize: theme3.BASE_FONT_SIZE,
      lineHeight: "120%",
      boxSizing: "border-box",
      cursor: "default"
    }
  },
  TableInspectorHeaderContainer: {
    base: {
      top: 0,
      height: "17px",
      left: 0,
      right: 0,
      overflowX: "hidden"
    },
    table: {
      tableLayout: "fixed",
      borderSpacing: 0,
      borderCollapse: "separate",
      height: "100%",
      width: "100%",
      margin: 0
    }
  },
  TableInspectorDataContainer: {
    tr: {
      display: "table-row"
    },
    td: {
      boxSizing: "border-box",
      border: "none",
      height: "16px",
      verticalAlign: "top",
      padding: "1px 4px",
      WebkitUserSelect: "text",
      whiteSpace: "nowrap",
      textOverflow: "ellipsis",
      overflow: "hidden",
      lineHeight: "14px"
    },
    div: {
      position: "static",
      top: "17px",
      bottom: 0,
      overflowY: "overlay",
      transform: "translateZ(0)",
      left: 0,
      right: 0,
      overflowX: "hidden"
    },
    table: {
      positon: "static",
      left: 0,
      top: 0,
      right: 0,
      bottom: 0,
      borderTop: "0 none transparent",
      margin: 0,
      backgroundImage: theme3.TABLE_DATA_BACKGROUND_IMAGE,
      backgroundSize: theme3.TABLE_DATA_BACKGROUND_SIZE,
      tableLayout: "fixed",
      borderSpacing: 0,
      borderCollapse: "separate",
      width: "100%",
      fontSize: theme3.BASE_FONT_SIZE,
      lineHeight: "120%"
    }
  },
  TableInspectorTH: {
    base: {
      position: "relative",
      height: "auto",
      textAlign: "left",
      backgroundColor: theme3.TABLE_TH_BACKGROUND_COLOR,
      borderBottom: `1px solid ${theme3.TABLE_BORDER_COLOR}`,
      fontWeight: "normal",
      verticalAlign: "middle",
      padding: "0 4px",
      whiteSpace: "nowrap",
      textOverflow: "ellipsis",
      overflow: "hidden",
      lineHeight: "14px",
      ":hover": {
        backgroundColor: theme3.TABLE_TH_HOVER_COLOR
      }
    },
    div: {
      whiteSpace: "nowrap",
      textOverflow: "ellipsis",
      overflow: "hidden",
      fontSize: theme3.BASE_FONT_SIZE,
      lineHeight: "120%"
    }
  },
  TableInspectorLeftBorder: {
    none: {
      borderLeft: "none"
    },
    solid: {
      borderLeft: `1px solid ${theme3.TABLE_BORDER_COLOR}`
    }
  },
  TableInspectorSortIcon: {
    display: "block",
    marginRight: 3,
    width: 8,
    height: 7,
    marginTop: -7,
    color: theme3.TABLE_SORT_ICON_COLOR,
    fontSize: 12,
    ...unselectable
  }
});
var DEFAULT_THEME_NAME = "chromeLight";
var ThemeContext = reactExports.createContext(createTheme(themes_exports[DEFAULT_THEME_NAME]));
var useStyles = (baseStylesKey) => {
  const themeStyles = reactExports.useContext(ThemeContext);
  return themeStyles[baseStylesKey];
};
var themeAcceptor = (WrappedComponent) => {
  const ThemeAcceptor = ({ theme: theme3 = DEFAULT_THEME_NAME, ...restProps }) => {
    const themeStyles = reactExports.useMemo(() => {
      switch (Object.prototype.toString.call(theme3)) {
        case "[object String]":
          return createTheme(themes_exports[theme3]);
        case "[object Object]":
          return createTheme(theme3);
        default:
          return createTheme(themes_exports[DEFAULT_THEME_NAME]);
      }
    }, [theme3]);
    return /* @__PURE__ */ React.createElement(ThemeContext.Provider, {
      value: themeStyles
    }, /* @__PURE__ */ React.createElement(WrappedComponent, {
      ...restProps
    }));
  };
  return ThemeAcceptor;
};
var Arrow = ({ expanded, styles }) => /* @__PURE__ */ React.createElement("span", {
  style: {
    ...styles.base,
    ...expanded ? styles.expanded : styles.collapsed
  }
}, "▶");
var TreeNode = reactExports.memo((props) => {
  props = {
    expanded: true,
    nodeRenderer: ({ name }) => /* @__PURE__ */ React.createElement("span", null, name),
    onClick: () => {
    },
    shouldShowArrow: false,
    shouldShowPlaceholder: true,
    ...props
  };
  const { expanded, onClick, children, nodeRenderer, title, shouldShowArrow, shouldShowPlaceholder } = props;
  const styles = useStyles("TreeNode");
  const NodeRenderer = nodeRenderer;
  return /* @__PURE__ */ React.createElement("li", {
    "aria-expanded": expanded,
    role: "treeitem",
    style: styles.treeNodeBase,
    title
  }, /* @__PURE__ */ React.createElement("div", {
    style: styles.treeNodePreviewContainer,
    onClick
  }, shouldShowArrow || reactExports.Children.count(children) > 0 ? /* @__PURE__ */ React.createElement(Arrow, {
    expanded,
    styles: styles.treeNodeArrow
  }) : shouldShowPlaceholder && /* @__PURE__ */ React.createElement("span", {
    style: styles.treeNodePlaceholder
  }, " "), /* @__PURE__ */ React.createElement(NodeRenderer, {
    ...props
  })), /* @__PURE__ */ React.createElement("ol", {
    role: "group",
    style: styles.treeNodeChildNodesContainer
  }, expanded ? children : void 0));
});
var DEFAULT_ROOT_PATH = "$";
var WILDCARD = "*";
function hasChildNodes(data, dataIterator) {
  return !dataIterator(data).next().done;
}
var wildcardPathsFromLevel = (level) => {
  return Array.from({ length: level }, (_2, i) => [DEFAULT_ROOT_PATH].concat(Array.from({ length: i }, () => "*")).join("."));
};
var getExpandedPaths = (data, dataIterator, expandPaths, expandLevel, prevExpandedPaths) => {
  const wildcardPaths = [].concat(wildcardPathsFromLevel(expandLevel)).concat(expandPaths).filter((path) => typeof path === "string");
  const expandedPaths = [];
  wildcardPaths.forEach((wildcardPath) => {
    const keyPaths = wildcardPath.split(".");
    const populatePaths = (curData, curPath, depth) => {
      if (depth === keyPaths.length) {
        expandedPaths.push(curPath);
        return;
      }
      const key = keyPaths[depth];
      if (depth === 0) {
        if (hasChildNodes(curData, dataIterator) && (key === DEFAULT_ROOT_PATH || key === WILDCARD)) {
          populatePaths(curData, DEFAULT_ROOT_PATH, depth + 1);
        }
      } else {
        if (key === WILDCARD) {
          for (const { name, data: data2 } of dataIterator(curData)) {
            if (hasChildNodes(data2, dataIterator)) {
              populatePaths(data2, `${curPath}.${name}`, depth + 1);
            }
          }
        } else {
          const value = curData[key];
          if (hasChildNodes(value, dataIterator)) {
            populatePaths(value, `${curPath}.${key}`, depth + 1);
          }
        }
      }
    };
    populatePaths(data, "", 0);
  });
  return expandedPaths.reduce((obj, path) => {
    obj[path] = true;
    return obj;
  }, { ...prevExpandedPaths });
};
var ConnectedTreeNode = reactExports.memo((props) => {
  const { data, dataIterator, path, depth, nodeRenderer } = props;
  const [expandedPaths, setExpandedPaths] = reactExports.useContext(ExpandedPathsContext);
  const nodeHasChildNodes = hasChildNodes(data, dataIterator);
  const expanded = !!expandedPaths[path];
  const handleClick = reactExports.useCallback(() => nodeHasChildNodes && setExpandedPaths((prevExpandedPaths) => ({
    ...prevExpandedPaths,
    [path]: !expanded
  })), [nodeHasChildNodes, setExpandedPaths, path, expanded]);
  return /* @__PURE__ */ React.createElement(TreeNode, {
    expanded,
    onClick: handleClick,
    shouldShowArrow: nodeHasChildNodes,
    shouldShowPlaceholder: depth > 0,
    nodeRenderer,
    ...props
  }, expanded ? [...dataIterator(data)].map(({ name, data: data2, ...renderNodeProps }) => {
    return /* @__PURE__ */ React.createElement(ConnectedTreeNode, {
      name,
      data: data2,
      depth: depth + 1,
      path: `${path}.${name}`,
      key: name,
      dataIterator,
      nodeRenderer,
      ...renderNodeProps
    });
  }) : null);
});
var TreeView = reactExports.memo(({ name, data, dataIterator, nodeRenderer, expandPaths, expandLevel }) => {
  const styles = useStyles("TreeView");
  const stateAndSetter = reactExports.useState({});
  const [, setExpandedPaths] = stateAndSetter;
  reactExports.useLayoutEffect(() => setExpandedPaths((prevExpandedPaths) => getExpandedPaths(data, dataIterator, expandPaths, expandLevel, prevExpandedPaths)), [data, dataIterator, expandPaths, expandLevel]);
  return /* @__PURE__ */ React.createElement(ExpandedPathsContext.Provider, {
    value: stateAndSetter
  }, /* @__PURE__ */ React.createElement("ol", {
    role: "tree",
    style: styles.treeViewOutline
  }, /* @__PURE__ */ React.createElement(ConnectedTreeNode, {
    name,
    data,
    dataIterator,
    depth: 0,
    path: DEFAULT_ROOT_PATH,
    nodeRenderer
  })));
});
var ObjectName = ({ name, dimmed = false, styles = {} }) => {
  const themeStyles = useStyles("ObjectName");
  const appliedStyles = {
    ...themeStyles.base,
    ...dimmed ? themeStyles["dimmed"] : {},
    ...styles
  };
  return /* @__PURE__ */ React.createElement("span", {
    style: appliedStyles
  }, name);
};
var ObjectValue = ({ object, styles }) => {
  const themeStyles = useStyles("ObjectValue");
  const mkStyle = (key) => ({ ...themeStyles[key], ...styles });
  switch (typeof object) {
    case "bigint":
      return /* @__PURE__ */ React.createElement("span", {
        style: mkStyle("objectValueNumber")
      }, String(object), "n");
    case "number":
      return /* @__PURE__ */ React.createElement("span", {
        style: mkStyle("objectValueNumber")
      }, String(object));
    case "string":
      return /* @__PURE__ */ React.createElement("span", {
        style: mkStyle("objectValueString")
      }, '"', object, '"');
    case "boolean":
      return /* @__PURE__ */ React.createElement("span", {
        style: mkStyle("objectValueBoolean")
      }, String(object));
    case "undefined":
      return /* @__PURE__ */ React.createElement("span", {
        style: mkStyle("objectValueUndefined")
      }, "undefined");
    case "object":
      if (object === null) {
        return /* @__PURE__ */ React.createElement("span", {
          style: mkStyle("objectValueNull")
        }, "null");
      }
      if (object instanceof Date) {
        return /* @__PURE__ */ React.createElement("span", null, object.toString());
      }
      if (object instanceof RegExp) {
        return /* @__PURE__ */ React.createElement("span", {
          style: mkStyle("objectValueRegExp")
        }, object.toString());
      }
      if (Array.isArray(object)) {
        return /* @__PURE__ */ React.createElement("span", null, `Array(${object.length})`);
      }
      if (!object.constructor) {
        return /* @__PURE__ */ React.createElement("span", null, "Object");
      }
      if (typeof object.constructor.isBuffer === "function" && object.constructor.isBuffer(object)) {
        return /* @__PURE__ */ React.createElement("span", null, `Buffer[${object.length}]`);
      }
      return /* @__PURE__ */ React.createElement("span", null, object.constructor.name);
    case "function":
      return /* @__PURE__ */ React.createElement("span", null, /* @__PURE__ */ React.createElement("span", {
        style: mkStyle("objectValueFunctionPrefix")
      }, "ƒ "), /* @__PURE__ */ React.createElement("span", {
        style: mkStyle("objectValueFunctionName")
      }, object.name, "()"));
    case "symbol":
      return /* @__PURE__ */ React.createElement("span", {
        style: mkStyle("objectValueSymbol")
      }, object.toString());
    default:
      return /* @__PURE__ */ React.createElement("span", null);
  }
};
var hasOwnProperty = Object.prototype.hasOwnProperty;
var propertyIsEnumerable = Object.prototype.propertyIsEnumerable;
function getPropertyValue(object, propertyName) {
  const propertyDescriptor = Object.getOwnPropertyDescriptor(object, propertyName);
  if (propertyDescriptor.get) {
    try {
      return propertyDescriptor.get();
    } catch {
      return propertyDescriptor.get;
    }
  }
  return object[propertyName];
}
function intersperse(arr, sep) {
  if (arr.length === 0) {
    return [];
  }
  return arr.slice(1).reduce((xs, x2) => xs.concat([sep, x2]), [arr[0]]);
}
var ObjectPreview = ({ data }) => {
  const styles = useStyles("ObjectPreview");
  const object = data;
  if (typeof object !== "object" || object === null || object instanceof Date || object instanceof RegExp) {
    return /* @__PURE__ */ React.createElement(ObjectValue, {
      object
    });
  }
  if (Array.isArray(object)) {
    const maxProperties = styles.arrayMaxProperties;
    const previewArray = object.slice(0, maxProperties).map((element, index2) => /* @__PURE__ */ React.createElement(ObjectValue, {
      key: index2,
      object: element
    }));
    if (object.length > maxProperties) {
      previewArray.push(/* @__PURE__ */ React.createElement("span", {
        key: "ellipsis"
      }, "…"));
    }
    const arrayLength = object.length;
    return /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement("span", {
      style: styles.objectDescription
    }, arrayLength === 0 ? `` : `(${arrayLength}) `), /* @__PURE__ */ React.createElement("span", {
      style: styles.preview
    }, "[", intersperse(previewArray, ", "), "]"));
  } else {
    const maxProperties = styles.objectMaxProperties;
    const propertyNodes = [];
    for (const propertyName in object) {
      if (hasOwnProperty.call(object, propertyName)) {
        let ellipsis;
        if (propertyNodes.length === maxProperties - 1 && Object.keys(object).length > maxProperties) {
          ellipsis = /* @__PURE__ */ React.createElement("span", {
            key: "ellipsis"
          }, "…");
        }
        const propertyValue = getPropertyValue(object, propertyName);
        propertyNodes.push(/* @__PURE__ */ React.createElement("span", {
          key: propertyName
        }, /* @__PURE__ */ React.createElement(ObjectName, {
          name: propertyName || `""`
        }), ": ", /* @__PURE__ */ React.createElement(ObjectValue, {
          object: propertyValue
        }), ellipsis));
        if (ellipsis)
          break;
      }
    }
    const objectConstructorName = object.constructor ? object.constructor.name : "Object";
    return /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement("span", {
      style: styles.objectDescription
    }, objectConstructorName === "Object" ? "" : `${objectConstructorName} `), /* @__PURE__ */ React.createElement("span", {
      style: styles.preview
    }, "{", intersperse(propertyNodes, ", "), "}"));
  }
};
var ObjectRootLabel = ({ name, data }) => {
  if (typeof name === "string") {
    return /* @__PURE__ */ React.createElement("span", null, /* @__PURE__ */ React.createElement(ObjectName, {
      name
    }), /* @__PURE__ */ React.createElement("span", null, ": "), /* @__PURE__ */ React.createElement(ObjectPreview, {
      data
    }));
  } else {
    return /* @__PURE__ */ React.createElement(ObjectPreview, {
      data
    });
  }
};
var ObjectLabel = ({ name, data, isNonenumerable = false }) => {
  const object = data;
  return /* @__PURE__ */ React.createElement("span", null, typeof name === "string" ? /* @__PURE__ */ React.createElement(ObjectName, {
    name,
    dimmed: isNonenumerable
  }) : /* @__PURE__ */ React.createElement(ObjectPreview, {
    data: name
  }), /* @__PURE__ */ React.createElement("span", null, ": "), /* @__PURE__ */ React.createElement(ObjectValue, {
    object
  }));
};
var createIterator = (showNonenumerable, sortObjectKeys) => {
  const objectIterator = function* (data) {
    const shouldIterate = typeof data === "object" && data !== null || typeof data === "function";
    if (!shouldIterate)
      return;
    const dataIsArray = Array.isArray(data);
    if (!dataIsArray && data[Symbol.iterator]) {
      let i = 0;
      for (const entry of data) {
        if (Array.isArray(entry) && entry.length === 2) {
          const [k2, v2] = entry;
          yield {
            name: k2,
            data: v2
          };
        } else {
          yield {
            name: i.toString(),
            data: entry
          };
        }
        i++;
      }
    } else {
      const keys2 = Object.getOwnPropertyNames(data);
      if (sortObjectKeys === true && !dataIsArray) {
        keys2.sort();
      } else if (typeof sortObjectKeys === "function") {
        keys2.sort(sortObjectKeys);
      }
      for (const propertyName of keys2) {
        if (propertyIsEnumerable.call(data, propertyName)) {
          const propertyValue = getPropertyValue(data, propertyName);
          yield {
            name: propertyName || `""`,
            data: propertyValue
          };
        } else if (showNonenumerable) {
          let propertyValue;
          try {
            propertyValue = getPropertyValue(data, propertyName);
          } catch (e) {
          }
          if (propertyValue !== void 0) {
            yield {
              name: propertyName,
              data: propertyValue,
              isNonenumerable: true
            };
          }
        }
      }
      if (showNonenumerable && data !== Object.prototype) {
        yield {
          name: "__proto__",
          data: Object.getPrototypeOf(data),
          isNonenumerable: true
        };
      }
    }
  };
  return objectIterator;
};
var defaultNodeRenderer = ({ depth, name, data, isNonenumerable }) => depth === 0 ? /* @__PURE__ */ React.createElement(ObjectRootLabel, {
  name,
  data
}) : /* @__PURE__ */ React.createElement(ObjectLabel, {
  name,
  data,
  isNonenumerable
});
var ObjectInspector = ({ showNonenumerable = false, sortObjectKeys, nodeRenderer, ...treeViewProps }) => {
  const dataIterator = createIterator(showNonenumerable, sortObjectKeys);
  const renderer = nodeRenderer ? nodeRenderer : defaultNodeRenderer;
  return /* @__PURE__ */ React.createElement(TreeView, {
    nodeRenderer: renderer,
    dataIterator,
    ...treeViewProps
  });
};
var themedObjectInspector = themeAcceptor(ObjectInspector);
__toESM(require_is_dom());
function JsonTree() {
  const [subscription, setSubscription] = reactExports.useState(store.subscription);
  reactExports.useEffect(() => {
    const listener = (message) => {
      setSubscription(message.subscription);
    };
    events.on("updateSubscription", listener);
    return () => {
      events.off("updateSubscription", listener);
    };
  }, []);
  const defaultNodeRenderer2 = ({ depth, name, data, isNonenumerable }) => depth === 0 ? /* @__PURE__ */ jsxRuntimeExports.jsx(ObjectRootLabel, { name, data }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ObjectLabel, { name, data, isNonenumerable });
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { style: { position: "absolute", top: 0, left: 0, height: "100%", width: "100%", textAlign: "left" }, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
    themedObjectInspector,
    {
      data: subscription,
      nodeRenderer: defaultNodeRenderer2,
      expandPaths: ["$"]
    }
  ) });
}
const layoutJson$2 = {
  "global": {
    "tabSetEnableTabStrip": false,
    "rootOrientationVertical": true,
    "tabSetMinHeight": 25,
    "tabSetMinWidth": 25
  },
  "layout": {
    "type": "row",
    "children": []
  }
};
function Splitter({ components }) {
  const prevComponentCount = reactExports.useRef(0);
  const flexModel = reactExports.useRef(Model.fromJson(layoutJson$2));
  if (prevComponentCount.current != components.length) {
    const children = components.map((_2, i) => ({
      type: "tabset",
      id: "tabset" + String(i),
      children: [
        {
          type: "tab",
          id: "tab" + String(i),
          component: String(i)
        }
      ]
    }));
    layoutJson$2.layout.children = children;
    flexModel.current = Model.fromJson(layoutJson$2);
    prevComponentCount.current = components.length;
  }
  const factory = (node) => {
    return components[parseInt(node.getComponent())];
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "container", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Layout, { model: flexModel.current, factory }) });
}
const detailToggleImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAS9JREFUaEPtmVsSgjAMRS8rU1emrkxdmU4+OtPBkgfQhtL0h5+25OQxN4EJna+pc/sRAN4RjAgcPQJXAHcA9PRYbwAfAI+ll3MpRIfI+COsGwCC+VscwMvR83NDyXiCMAF8s91exS7awBkmHm6QW6INAVA5ChGB5OBhizgJ0KIQCSnomkK5ED45NWUg3ABKKr4GwgWAa0GsEM0BNP2TBaIpgMb4lO5aiGYAqe226BpBFDvM7JJmABbDLXsDYHgltqRLaW+k0GlSqDiPbs0PxXmay1knaicyxbuqbynaOgyApJi13J9/UNsUgWEnsq2RCR04jQ5EDawshrFroPvP6yQieS+yMgt2ObY4Q0vFSYP6xfFHB3UA7OwsAezivpqXBEBN72rujghovFRzT/cR+AE9pVUxB0r0IgAAAABJRU5ErkJggg==";
const App$1 = "";
function DataToolbar(props) {
  const [showDetail, setShowDetail] = reactExports.useState(false);
  const onShowDetail = () => {
    const newShowDetail = !showDetail;
    setShowDetail(newShowDetail);
    props.onShowDetail(newShowDetail);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "toolbar-outer", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
    "button",
    {
      className: "toolbar-toggle-button",
      title: "Show Detail",
      onClick: onShowDetail,
      style: { backgroundColor: showDetail ? "#fefefe" : "transparent" },
      children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { className: "toolbar-icon", src: detailToggleImage })
    }
  ) });
}
const ROW_HEIGHT$2 = 25;
function DataView({ subscription, enableDetail }) {
  const [selectedRowId, setSelectedRowId] = reactExports.useState(void 0);
  const [showDetail, setShowDetail] = reactExports.useState(false);
  const columns = reactExports.useRef([]);
  let gridData = void 0;
  let json = void 0;
  let message = "";
  try {
    if (subscription != null) {
      switch (subscription.type) {
        case "record":
        case "record (channel)":
          if (subscription.data.recordType3) {
            gridData = mapRecordType3(subscription);
          } else if (subscription.data.recordType2) {
            gridData = mapRecordType2(subscription);
          } else if (subscription.data.recordType1) {
            gridData = mapRecord(subscription);
          } else if (subscription.data.permission) {
            gridData = mapPermission(subscription);
          }
          break;
        case "permission":
          gridData = mapPermission(subscription);
          break;
        case "container":
          gridData = mapContainer(subscription);
          break;
        case "json":
        case "json (channel)":
          json = subscription.data.json;
          break;
      }
    }
    if (gridData !== void 0) {
      const set1 = /* @__PURE__ */ new Set();
      const set2 = /* @__PURE__ */ new Set();
      columns.current.forEach((c) => set1.add(c.field));
      gridData.columns.forEach((c) => set2.add(c.field));
      if (!eqSet(set1, set2)) {
        columns.current = gridData.columns;
      }
    }
  } catch (e) {
    console.log(e);
    columns.current = [];
    message = "Unable to map subscription data";
  }
  const onShowDetail = (show) => {
    setShowDetail(show);
  };
  const onRowSelected = (event) => {
    if (event.node.isSelected()) {
      if (event.node.data !== void 0) {
        setSelectedRowId(event.node.data._id_);
      } else {
        setSelectedRowId(void 0);
      }
    }
  };
  const getRowId = (row) => {
    return row.data._id_;
  };
  let content;
  if (json) {
    content = /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "jsonView", children: /* @__PURE__ */ jsxRuntimeExports.jsx("pre", { className: "jsonValue", children: JSON.stringify(json, null, "	") }) });
  } else if (gridData) {
    content = /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "container ag-theme-alpine", children: [
      enableDetail && /* @__PURE__ */ jsxRuntimeExports.jsx(
        DataToolbar,
        {
          onShowDetail
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        main.AgGridReact,
        {
          columnDefs: columns.current,
          rowData: gridData.rows,
          rowSelection: "single",
          rowHeight: ROW_HEIGHT$2,
          getRowId,
          onRowSelected,
          headerHeight: ROW_HEIGHT$2,
          enableCellChangeFlash: true
        }
      )
    ] });
  } else {
    content = /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "noData", children: message });
  }
  const splitterComponents = [];
  splitterComponents.push(content);
  if (showDetail) {
    let detailComponent = /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "noData", children: message });
    if (subscription && selectedRowId !== void 0) {
      if (subscription.data.container) {
        const childSubscription = subscription.data.container.elements.find((e) => e.subject === selectedRowId) || null;
        detailComponent = /* @__PURE__ */ jsxRuntimeExports.jsx(DataView, { subscription: childSubscription, enableDetail: false });
      } else if (subscription.data.recordType1) {
        const fieldValue = subscription.data.recordType1.fields[selectedRowId] || null;
        if (fieldValue !== null) {
          detailComponent = /* @__PURE__ */ jsxRuntimeExports.jsx("textarea", { className: "detail-panel-textarea", value: fieldValue });
        }
      }
    }
    splitterComponents.push(detailComponent);
  }
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Splitter, { components: splitterComponents });
}
const eqSet = (xs, ys) => xs.size === ys.size && [...xs].every((x2) => ys.has(x2));
function mapContainer(subscriptionRef) {
  const columns = [];
  const rows = [];
  const columnSet = /* @__PURE__ */ new Set();
  columns.push({
    field: "_line_",
    headerName: "Line",
    width: 150,
    resizable: true,
    cellStyle: { textAlign: "left" },
    sortable: true
  });
  columns.push({
    field: "_id_",
    headerName: "subject",
    width: 200,
    resizable: true,
    sortable: true,
    cellStyle: { textAlign: "left" }
  });
  const elements2 = subscriptionRef.data.container.elements;
  elements2.forEach((r2, i) => {
    const row = {};
    if (r2.data.recordType1 && r2.data.recordType1.fields) {
      const fields = r2.data.recordType1.fields;
      for (const name in fields) {
        row[name] = fields[name];
        if (!columnSet.has(name)) {
          columnSet.add(name);
          columns.push({
            field: name,
            width: 200,
            resizable: true,
            cellStyle: { textAlign: "left" },
            sortable: true
          });
        }
      }
    } else if (r2.data.json) {
      row["json"] = JSON.stringify(r2.data.json);
      if (!columnSet.has("json")) {
        columnSet.add("json");
        columns.push({
          field: "json",
          width: 500,
          resizable: true,
          cellStyle: { textAlign: "left" },
          sortable: true
        });
      }
    }
    row["_line_"] = String(subscriptionRef.windowStart !== void 0 ? subscriptionRef.windowStart + i : i);
    row["_id_"] = r2.subject;
    rows.push(row);
  });
  return { rows, columns };
}
function mapRecord(subscriptionRef) {
  const rows = [];
  const columns = [
    {
      field: "_id_",
      headerName: "Name",
      width: 300,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true
    },
    { field: "value", width: 600, resizable: true, cellStyle: { textAlign: "left" }, sortable: true }
  ];
  for (const name in subscriptionRef.data.recordType1.fields) {
    rows.push({ _id_: name, value: subscriptionRef.data.recordType1.fields[name] });
  }
  return { rows, columns };
}
function mapRecordType2(subscriptionRef) {
  const columns = [];
  const rows = [];
  const columnSet = /* @__PURE__ */ new Set();
  columns.push({
    field: "_id_",
    headerName: "Key",
    width: 150,
    resizable: true,
    cellStyle: { textAlign: "left" },
    sortable: true
  });
  const elements2 = subscriptionRef.data.recordType2.elements;
  Object.keys(elements2).forEach((k2) => {
    const fields = elements2[k2].fields;
    const row = { ...fields, _id_: k2 };
    for (const name in fields) {
      if (!columnSet.has(name)) {
        columnSet.add(name);
        columns.push({
          field: name,
          width: 200,
          resizable: true,
          cellStyle: { textAlign: "left" },
          sortable: true,
          valueGetter: (params) => {
            return params.data[name];
          }
        });
      }
    }
    rows.push(row);
  });
  return { rows, columns };
}
function mapRecordType3(subscriptionRef) {
  const columns = [];
  const rows = [];
  const columnSet = /* @__PURE__ */ new Set();
  columns.push({
    field: "_id_",
    headerName: "Line",
    width: 150,
    resizable: true,
    cellStyle: { textAlign: "left" },
    sortable: true
  });
  const elements2 = subscriptionRef.data.recordType3.elements;
  elements2.forEach((element, i) => {
    const row = { ...element.fields, _id_: String(i) };
    for (const name in element.fields) {
      if (!columnSet.has(name)) {
        columnSet.add(name);
        columns.push({
          field: name,
          width: 200,
          resizable: true,
          cellStyle: { textAlign: "left" },
          sortable: true,
          valueGetter: (params) => {
            return params.data[name];
          }
        });
      }
    }
    rows.push(row);
  });
  return { rows, columns };
}
function mapPermission(subscriptionRef) {
  const columns = [];
  const rows = [];
  const columnSet = /* @__PURE__ */ new Set();
  columns.push({
    field: "_id_",
    headerName: "Key",
    width: 150,
    resizable: true,
    cellStyle: { textAlign: "left" },
    sortable: true
  });
  const elements2 = subscriptionRef.data.permission.elements;
  Object.keys(elements2).forEach((k2) => {
    const fields = elements2[k2].fields;
    const row = { ...fields, _id_: k2 };
    for (const name in fields) {
      if (!columnSet.has(name)) {
        columnSet.add(name);
        columns.push({
          field: name,
          width: 200,
          resizable: true,
          cellStyle: { textAlign: "left" },
          sortable: true,
          valueGetter: (params) => {
            return params.data[name];
          }
        });
      }
    }
    rows.push(row);
  });
  return { rows, columns };
}
function DataViewPanel() {
  const [subscription, setSubscription] = reactExports.useState(store.subscription);
  reactExports.useEffect(() => {
    const listener = (message) => {
      setSubscription(message.subscription);
    };
    events.on("updateSubscription", listener);
    return () => {
      events.off("updateSubscription", listener);
    };
  }, []);
  return /* @__PURE__ */ jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(DataView, { subscription, enableDetail: true }) });
}
const layoutJson$1 = {
  "global": {
    "tabEnableClose": false,
    "tabEnableRename": false,
    "enableEdgeDock": false,
    "tabSetMinHeight": 25,
    "tabSetMinWidth": 25
    // "tabSetTabLocation": "bottom"
  },
  "layout": {
    "type": "row",
    "children": [
      {
        "type": "tabset",
        "enableTabStrip": false,
        "enableDrop": false,
        "weight": 50,
        "children": [
          {
            "type": "tab",
            "component": "subscriptions"
          }
        ]
      },
      {
        "type": "tabset",
        "weight": 50,
        "children": [
          {
            "type": "tab",
            "name": "Data",
            "component": "dataview"
          },
          {
            "type": "tab",
            "name": "Subscription",
            "component": "jsontree"
          }
        ]
      }
    ]
  }
};
function SubscriptionPanel({ parentModel }) {
  const [flexModel] = reactExports.useState(Model.fromJson(layoutJson$1));
  const factory = (node) => {
    switch (node.getComponent()) {
      case "subscriptions":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(Subscriptions$1, { parentModel });
      case "jsontree":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(JsonTree, {});
      case "dataview":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(DataViewPanel, {});
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Layout, { model: flexModel, factory });
}
const addImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAAAXNSR0IArs4c6QAAATZJREFUeF7t2UEOgjAURVHYma7EgROXxISBK5GdaYw4MZFveDVBcxi3pL3c/5p++s6zSKDHZ5kAQIUhAAGUhQiDGMSgjACDMn4yiEEMyggwKOMngxjEoIwAgzJ+MugXDDocT5eu63Yva53O47DPvn8+exMGAVR8SIAAymqdQQxiUEaAQRk/GcQgBmUEGJTxk0EMYlBJYC6TctybAa+tjuewae0LW7VKmrU7DsfTde1mvjHvPA5N9tbkJfcNAlQHLYOWGDGoNujeV177/H9IryUz55emfVGeAAEU1Ji72GcB78fhO04MYlAQQI9rilPMKRZIxCAZFOgjg2p4SkyJ1ZY4xTJGm53drCe92R2GCwOoAAgQQFmNMYhBDMoIMCjjJ4MYxKCMAIMyfjKIQQzKCDAo4yeDCn43OYCwSZeA5CoAAAAASUVORK5CYII=";
const deleteImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAAAXNSR0IArs4c6QAAAhJJREFUeF7tm1FSwyAQhuFk6knsjH3ILay3yEOdqSexniyGiA6mEJaFZmL9+tjZlPTj35+FbKzhs0jAwmeZAIAyCgEQgOpMBAWhIBRURwAF1fHDg7aooN2+u9fM6+nYnzXX1VyzuoIcnGEw75qbttY8rA0JQFtLsX+jIO8jxV4yptedMab4OjfR1poXTWqO4521qalOsd2+OwyDeVbe8KqXObCnY3/QDAqga3kQCsqQBVAekKtnQg+KGe8ahV3K8H/GHuunj9U9aM7v8akb5t/VmKPUUFNKfnvt1f4ajt3kR9wPAigzpQACkDTr43EoqJGC/F7sogL3hj6tPJKY79u5OZNObVbDowxJDIAiZ0ax8yAUFKQ2gPyRKimWSR8AAejLOGJ7MYk6JDGsYqxivytP6iDPQ5I+khhSjBQjxVjFQg1Ijzsk/iKJwYPwIDwID8KDCo6pMem2Z9IXHWZsNdhqyB49S2ocSQx1EHUQdVCyDor1KIbtKan+x1gLy8099imoHEShAMpgAhCARJmUDPrTCnIN3BXN31Jy817J6bottuC57YOqg15KoiQOQAu0WjaPNmvirHlJpUQZktiWr001A+RufAvN5S3VMz0+l8xISYyHpH6jp2SsWey0IGjf6kmN2xxQOJD21ctSSK2hhONfFVDpH91iPIAyswIgANUlLgpCQSiojgAKquOHB6GgOgV9ArZRWHbXfzqeAAAAAElFTkSuQmCC";
function ToolsPanel() {
  const [config, setConfig] = reactExports.useState({});
  const [changed, setChanged] = reactExports.useState(true);
  const previousJsonRef = reactExports.useRef(JSON.stringify(config));
  const timerRef = reactExports.useRef();
  const latestConfig = reactExports.useRef(config);
  latestConfig.current = config;
  reactExports.useEffect(() => {
    const listener = () => {
      setConfig(store.toolsConfig);
      setChanged(!store.toolsConfigApplied);
      previousJsonRef.current = store.toolsConfigApplied ? JSON.stringify(store.toolsConfig) : "";
    };
    events.on("initial", listener);
    return () => {
      events.off("initial", listener);
    };
  }, []);
  reactExports.useEffect(() => {
    setConfig(store.toolsConfig);
    setChanged(!store.toolsConfigApplied);
    previousJsonRef.current = store.toolsConfigApplied ? JSON.stringify(store.toolsConfig) : "";
    timerRef.current = setInterval(() => {
      const json = JSON.stringify(latestConfig.current);
      setChanged(json !== previousJsonRef.current);
    }, 300);
    return () => {
      clearInterval(timerRef.current);
    };
  }, []);
  const onClick = () => {
    var _a2, _b2;
    if (chrome && chrome.devtools) {
      (_a2 = store.port) == null ? void 0 : _a2.postMessage({
        source: "__caplin_streamlink_devtools__",
        type: "setToolsConfig",
        toolsConfig: config
      });
    } else {
      (_b2 = store.portToStreamLink) == null ? void 0 : _b2.postMessage({
        source: "__caplin_streamlink_devtools__",
        type: "setToolsConfig",
        toolsConfig: config
      });
    }
    previousJsonRef.current = JSON.stringify(config);
    setChanged(false);
  };
  if (!("intercepts" in config)) {
    config.intercepts = [];
  }
  if (!("subscriptions" in config)) {
    config.subscriptions = [];
  }
  if (!("logMessages" in config)) {
    config.logMessages = [];
  }
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_container", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_inner_container", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Intercepts, { intercepts: config.intercepts }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Subscriptions, { subscriptions: config.subscriptions }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(LogMessages, { logMessages: config.logMessages })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "tools_button_bar", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        style: { color: changed ? "white" : "lightgray", backgroundColor: changed ? "#2051d7" : "gray" },
        className: "tools_apply_button",
        onClick,
        children: "Apply"
      }
    ) })
  ] });
}
function Intercepts({ intercepts }) {
  const [key, setKey] = reactExports.useState(0);
  const forceUpdate = reactExports.useCallback(() => setKey((v2) => v2 + 1), []);
  const remove = (index2) => {
    intercepts.splice(index2, 1);
    forceUpdate();
  };
  const onAdd = () => {
    intercepts.push({
      type: "input",
      subject: "",
      isRegEx: false,
      enabled: true,
      fields: [
        { name: "", value: "" }
      ],
      where: []
    });
    forceUpdate();
  };
  const interceptComponents = intercepts.map((item, i) => {
    return /* @__PURE__ */ jsxRuntimeExports.jsx(Intercept, { index: i, item, remove }, i);
  });
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_intercepts", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_intercepts_header", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("b", { children: "Message Intercepts" }),
      " ",
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: onAdd, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
        "img",
        {
          src: addImage,
          height: "18"
        }
      ) })
    ] }),
    interceptComponents
  ] }, key);
}
function Intercept({ index: index2, item, remove }) {
  const onDelete = () => {
    remove(index2);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_intercept", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_tools_header", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        TextBox,
        {
          title: "Subject",
          propValue: item.subject,
          onChange: (value) => item.subject = value,
          width: 500
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Checkbox, { title: "RegEx", propValue: item.isRegEx, onChange: (value) => item.isRegEx = value }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(Select, { propValue: item.type, title: "Type", onChange: (value) => item.type = value, children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "input", children: "input" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "output", children: "output" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Checkbox, { title: "Enabled", propValue: item.enabled, onChange: (value) => item.enabled = value }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { space: 10, onClick: onDelete, children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { src: deleteImage, height: "18" }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Fields, { item: item.fields }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Where, { item: item.where })
  ] });
}
function Fields({ item }) {
  const [key, setKey] = reactExports.useState(0);
  const forceUpdate = reactExports.useCallback(() => setKey((v2) => v2 + 1), []);
  const onAdd = () => {
    item.push({ name: "", value: "" });
    forceUpdate();
  };
  const remove = (index2) => {
    item.splice(index2, 1);
    forceUpdate();
  };
  const fieldComponents = item.map((item2, i) => {
    return /* @__PURE__ */ jsxRuntimeExports.jsx(Field, { index: i, item: item2, remove }, i);
  });
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_fields", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_fields_header", children: [
      "Set Fields",
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: onAdd, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
        "img",
        {
          src: addImage,
          height: "18"
        }
      ) })
    ] }, "header"),
    fieldComponents
  ] }, key);
}
function Where({ item }) {
  const [key, setKey] = reactExports.useState(0);
  const forceUpdate = reactExports.useCallback(() => setKey((v2) => v2 + 1), []);
  const onAdd = () => {
    item.push({ name: "", value: "" });
    forceUpdate();
  };
  const remove = (index2) => {
    item.splice(index2, 1);
    forceUpdate();
  };
  const fieldComponents = item.map((item2, i) => {
    return /* @__PURE__ */ jsxRuntimeExports.jsx(WhereField, { index: i, item: item2, remove }, i);
  });
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_fields", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_fields_header", children: [
      "Where ",
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: onAdd, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
        "img",
        {
          src: addImage,
          height: "18"
        }
      ) })
    ] }, "header"),
    fieldComponents
  ] }, key);
}
function Field({ index: index2, item, remove }) {
  const onDelete = () => {
    remove(index2);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_field", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(TextBox, { title: "Field", propValue: item.name, onChange: (value) => item.name = value }),
    "=",
    /* @__PURE__ */ jsxRuntimeExports.jsx(TextBox, { title: "Value", propValue: item.value, onChange: (value) => item.value = value }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { space: 10, onClick: onDelete, children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { src: deleteImage, height: "18" }) })
  ] });
}
function WhereField({ index: index2, item, remove }) {
  const onDelete = () => {
    remove(index2);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_field", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(TextBox, { title: "Field", propValue: item.name, onChange: (value) => item.name = value }),
    "===",
    /* @__PURE__ */ jsxRuntimeExports.jsx(TextBox, { title: "Value", propValue: item.value, onChange: (value) => item.value = value }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { space: 10, onClick: onDelete, children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { src: deleteImage, height: "18" }) })
  ] });
}
function Subscriptions({ subscriptions }) {
  const [key, setKey] = reactExports.useState(0);
  const forceUpdate = reactExports.useCallback(() => setKey((v2) => v2 + 1), []);
  const remove = (index2) => {
    subscriptions.splice(index2, 1);
    forceUpdate();
  };
  const onAdd = () => {
    subscriptions.push({
      id: randomUUID(),
      subject: "",
      enabled: true
    });
    forceUpdate();
  };
  const subscriptionComponents = subscriptions.map((item, i) => {
    return /* @__PURE__ */ jsxRuntimeExports.jsx(Subscription, { index: i, item, remove }, i);
  });
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_subscriptions", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_subscriptions_header", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("b", { children: "Extra Subscriptions" }),
      " ",
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: onAdd, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
        "img",
        {
          src: addImage,
          height: "18"
        }
      ) })
    ] }),
    subscriptionComponents
  ] }, key);
}
function Subscription({ index: index2, item, remove }) {
  const onDelete = () => {
    remove(index2);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_subscription", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(TextBox, { title: "Subject", width: 500, propValue: item.subject, onChange: (value) => item.subject = value }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Checkbox, { title: "Enabled", propValue: item.enabled, onChange: (value) => item.enabled = value }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { space: 10, onClick: onDelete, children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { src: deleteImage, height: "18" }) })
  ] });
}
function LogMessages({ logMessages }) {
  const [key, setKey] = reactExports.useState(0);
  const forceUpdate = reactExports.useCallback(() => setKey((v2) => v2 + 1), []);
  const remove = (index2) => {
    logMessages.splice(index2, 1);
    forceUpdate();
  };
  const onAdd = () => {
    logMessages.push({
      id: randomUUID(),
      subject: "",
      enabled: true
    });
    forceUpdate();
  };
  const logMessageComponents = logMessages.map((item, i) => {
    return /* @__PURE__ */ jsxRuntimeExports.jsx(LogMessage, { index: i, item, remove }, i);
  });
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_logmessages", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_logmessages_header", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("b", { children: "Log Messages To Console" }),
      " ",
      /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { onClick: onAdd, children: /* @__PURE__ */ jsxRuntimeExports.jsx(
        "img",
        {
          src: addImage,
          height: "18"
        }
      ) })
    ] }),
    logMessageComponents
  ] }, key);
}
function LogMessage({ index: index2, item, remove }) {
  const onDelete = () => {
    remove(index2);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "tools_logmessage", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(TextBox, { title: "Subject", width: 500, propValue: item.subject, onChange: (value) => item.subject = value }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Checkbox, { title: "Enabled", propValue: item.enabled, onChange: (value) => item.enabled = value }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Button, { space: 10, onClick: onDelete, children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { src: deleteImage, height: "18" }) })
  ] });
}
function Button({ children, onClick, space }) {
  return /* @__PURE__ */ jsxRuntimeExports.jsx(
    "button",
    {
      onClick,
      style: { marginLeft: space ? space : 0 },
      className: "tools_button",
      children
    }
  );
}
function TextBox({ title, propValue, onChange, width }) {
  const [value, setValue] = reactExports.useState(propValue);
  reactExports.useEffect(() => {
    setValue(propValue);
  }, [propValue]);
  const onChangeInternal = (event) => {
    setValue(event.target.value);
    onChange(event.target.value);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { style: { display: "flex", gap: 5, alignItems: "center" }, children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { children: title }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "input",
      {
        style: { width: width ? width : 300, paddingLeft: 5 },
        type: "text",
        value,
        onChange: onChangeInternal
      }
    )
  ] });
}
function Checkbox({ title, propValue, onChange }) {
  const [value, setValue] = reactExports.useState(propValue);
  reactExports.useEffect(() => {
    setValue(propValue);
  }, [propValue]);
  const onChangeInternal = () => {
    setValue(!value);
    onChange(!value);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { style: { display: "flex", gap: 3, alignItems: "center" }, children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "input",
      {
        type: "checkbox",
        checked: value,
        onChange: onChangeInternal
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { children: title })
  ] });
}
function Select({ propValue, onChange, children, title }) {
  const [value, setValue] = reactExports.useState(propValue);
  reactExports.useEffect(() => {
    setValue(propValue);
  }, [propValue]);
  const onChangeInternal = (event) => {
    setValue(event.target.value);
    onChange(event.target.value);
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { style: { display: "flex", gap: 5, alignItems: "center" }, children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { children: title }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("select", { value, onChange: onChangeInternal, children })
  ] });
}
function randomUUID() {
  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(
    /[018]/g,
    (c) => (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
  );
}
const findUpImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAURJREFUaEPtl2sOwyAMg9Ob7WbbbrajVZHKhBgQhxBNldw/3QOIPztQ9ZCbX8fN9QsB/p0gE2ACQQfYQoaBr+v/cg/6/Ts9MwEV/bxKvkUkBSILoBZfbEuByADoiU+D2A0wE58CsRNgJv4jIo9qC25rp10ArXgVqFe9ievv+nkLxA6Annj9rXcKjcYuH69RgJmg0TG6FSICYAmZPQesuXAiqwCIAOtBhqxhgqwAoIUtABWHrjUE8QJ4CiIAYQgPgEd8K8w6Mr1rfxNBAVYKoAkUMSs1oJf6pYUHzwFrU7prIQl4new5arVQDeaqhwCUfq7vlpPePdCupxBQPRQAEdwTcdsXmmgCsGFMYGKVazPCljcDmQATWO2dax5biC3EFgo6wBYKGshTKGhgeHpmAmFxyAIEQFzKHMMEMt1F1mYCiEuZY06eq2wxICPD7wAAAABJRU5ErkJggg==";
const findDownImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAATtJREFUaEPtmGsOwyAMg9Ob7WbbbrajVUjrhBgPm4RNSO6fqi0Ef3F4qIdtfh2b6zcB/NtBOSAHnBlQCXUS+DCz+/v708zSc/i10gEBIHbJAc0BpE46bVRCKiGVkDMDKiFnArUK7VJC10mSOVF6DnPweEgJzQr5ST8WIFUMerafAcj7QGMhACkQHbjog0DPjEH9F2IHYBxgY3/WDtSBqwMzEArAxPxa9FgAppwQAJf4JGYGAIUYAbjFewAQiB5AiHgvwAiiBRAmPgKgB1EDCBUfBdCCSO/zH1v5M7RJIQfV2Ulci11m92Vmt4YIZGND9E+vQq3gJUStXZj4yBLKhfYgQsWvAqjNibCaLy2NnANl7NFGBtX4qNFKgMuJ/D7SQ39fDUALYjsIgM1YdHs5EJ1RNp4cYDMW3X57B07FjWwxrTscjwAAAABJRU5ErkJggg==";
const matchCaseImage = "" + new URL("match_case-4598482c.png", import.meta.url).href;
const regexImage = "" + new URL("regex-24b17c5e.png", import.meta.url).href;
const filterImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAWxJREFUaEPtWFsOwiAQ3N5MT6aeTG+mGdMmBKH7YIg2Lp8NC/PaQFnk4GM5OH5JAt92MB1IBwYV+IsIXUXkMihUtPwmIti/OzQHTiJyj+5OqjuLyKO3lkYAdU8SkOgyuxgtBOoIqbZGka5xKeOq7mUhADw1iV1bgwTquKrgsY+VAOaiF7DJNjy1Fk5lVJF5iKQOL4jQJiqKT4fNuMwTVxAhmxUCQz3mJdDqB1NWOySGwHt7oMTAaGqKmxEHNiJlU5ubrlCB0k8jBGoFPSQYDr61GCGA+kgMhnNfZnmUgPeQo4JnONDqB3xrndQRt9QjhOGAtamnnORMAnsK05q2toRJoHfI4bvrhqnmZuKFDEtr/w9U0aiLrcIkgYyQR4HG3IyQR8Bs4oyQJy+NuRmhjNAPRqi+NpcQPb+dJmozegDXatw+y1c8gAF4PMF0X5pNiKtJMwhEcIRrkkBYOlJhOkASMrxMOhCWjlR4eAde3FVOMXj7rt0AAAAASUVORK5CYII=";
const clearImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAkxJREFUaEPtmX1OwzAMxbuTAScDTgacDPSkejKuHX/EaTVp/Wfa1ibv92wnbnvbHvy4Pbj+7QlwdQQ7I/C6w7wzKPrte//tZ//86ALvAPjaxZDYqDZAAWgKZgYAE3O3o8K18z6rIBUAOE2uSzFwFWLooNTBd1ynpRkfIw2SBdBcJ9FcbCQaVgRTEBkAOWFVuITTQMIQUQA5SXiCSCjYysRrKjRHBOAM8WAoRcIDuFI8Be9t2zazvjyAX5YCoZAmUoZO1Ux6YSsWzjN1jgD4wHAATnQfVoTlUm2aNwJY7b6XnvJ/VasFwC9ekTqeeIo0N1HNAgsAOy3tmt0AUfFyZUoBcHKv0DN1kRGvReGwImniVqVPRTwgeDZcBlAVT00gNY+HNNIiMCTO5MtMi8Dm4UtqGmA2/2ecJ4Y0QFcBd4jXCvmfqZrDHQCd4gFhalpRA93iOUC6BoadoFLQK8Sna6C6Cq0QL3fjQ1egpdCQ2FhGV4mfBhj24k3rvLe1DBeV2WZupfNTzRyvAysKq8W76eOlx6gXP1u8qTV6S4kBaEk9Q7zsQku3lHIHpIex6Wc3XpUG9pPSTb1sZeU83XdqNH4qwpFus/TAqeC6LFp8d02KAJQGLgCknKfxowAaRMihAAh2ftQVf0HiOl8BGEHQfwG991M04WlTMhGwioyLppcbWLHkyw06T7rNr892v1OvWbXizkRAgmO89FGJgJwEE8uHsREhFKGpZ64dAFwsuQggHPI1K+U4PrOvpFRTugEizree8wRotbMw2MNH4A9eRbkxtKmscAAAAABJRU5ErkJggg==";
const cancelImage = "" + new URL("cancel-b7363bec.png", import.meta.url).href;
const Toolbar = reactExports.forwardRef((props, ref) => {
  const [level, setLevel] = reactExports.useState(props.level || 9);
  const [filterText, setFilterText] = reactExports.useState("");
  const [filterMatchCase, setFilterMatchCase] = reactExports.useState(false);
  const [filterRegex, setFilterRegex] = reactExports.useState(false);
  const [findText, setFindText] = reactExports.useState("");
  const [findMatchCase, setFindMatchCase] = reactExports.useState(false);
  const [findRegex, setFindRegex] = reactExports.useState(false);
  reactExports.useImperativeHandle(ref, () => {
    return {
      updateFilterText(text) {
        setFilterText(text);
      }
    };
  }, []);
  const doFilter = (filterText2, filterMatchCase2, filterRegex2) => {
    let regex = null;
    if (filterText2 !== "") {
      let regexStr = filterText2;
      if (!filterRegex2) {
        regexStr = escapeRegex(filterText2);
      }
      regex = new RegExp(regexStr, filterMatchCase2 ? "g" : "ig");
    }
    props.onFilter(regex);
  };
  const doFind = (findText2, findMatchCase2, findRegex2, down) => {
    let regex = null;
    if (findText2 !== "") {
      let regexStr = findText2;
      if (!findRegex2) {
        regexStr = escapeRegex(findText2);
      }
      regex = new RegExp(regexStr, findMatchCase2 ? "g" : "ig");
    }
    props.onFind(regex, down);
  };
  const onFilterKeyDown = (event) => {
    if (event.keyCode === 13) {
      doFilter(filterText, filterMatchCase, filterRegex);
    }
  };
  const onFindKeyDown = (event) => {
    if (event.keyCode === 13) {
      doFind(findText, findMatchCase, findRegex, !event.shiftKey);
    }
  };
  const onFilterChange = (event) => {
    setFilterText(event.target.value);
  };
  const onFindChange = (event) => {
    setFindText(event.target.value);
  };
  const onLevelChange = (event) => {
    setLevel(parseInt(event.target.value));
    props.onLevelChange(parseInt(event.target.value));
  };
  const onFindMatchCaseClick = () => {
    setFindMatchCase(!findMatchCase);
  };
  const onFindRegexClick = () => {
    setFindRegex(!findRegex);
  };
  const onFilterMatchCaseClick = () => {
    setFilterMatchCase(!filterMatchCase);
  };
  const onFilterRegexClick = () => {
    setFilterRegex(!filterRegex);
  };
  const onFilterClearClick = () => {
    setFilterText("");
    props.onFilter(null);
  };
  const onFindClearClick = () => {
    setFindText("");
    props.onFind(null, true);
  };
  let levelSection = null;
  if (props.showLevel) {
    levelSection = /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "toolbar-divider" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "toolbar-label", children: "Level:" }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        "select",
        {
          className: "toolbar-level",
          value: level,
          onChange: onLevelChange,
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "9", children: "FINEST" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "8", children: "FINER" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "7", children: "FINE" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "6", children: "INFO" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "5", children: "NOTIFY" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "4", children: "WARN" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "3", children: "ERROR" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "2", children: "CRITICAL" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("option", { value: "1", children: "CONFIG" })
          ]
        }
      )
    ] });
  }
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "toolbar-outer", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        className: "toolbar-button",
        title: "Clear log",
        onClick: props.onClear,
        children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { className: "toolbar-icon", tabIndex: -1, src: clearImage })
      }
    ),
    levelSection,
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "toolbar-divider" }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "toolbar-group", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "toolbar-label", children: "Filter:" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        SearchInput,
        {
          findText: filterText,
          onFindKeyDown: onFilterKeyDown,
          onFindChange: onFilterChange,
          onMatchCaseClick: onFilterMatchCaseClick,
          matchCase: filterMatchCase,
          onRegexClick: onFilterRegexClick,
          onClearClick: onFilterClearClick,
          regex: filterRegex
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        className: "toolbar-button",
        title: "Filter",
        onClick: () => doFilter(filterText, filterMatchCase, filterRegex),
        children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { className: "toolbar-icon", tabIndex: -1, src: filterImage })
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "toolbar-divider" }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "toolbar-group", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "toolbar-label", children: "Find:" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        SearchInput,
        {
          findText,
          onFindKeyDown,
          onFindChange,
          onMatchCaseClick: onFindMatchCaseClick,
          matchCase: findMatchCase,
          onRegexClick: onFindRegexClick,
          regex: findRegex,
          onClearClick: onFindClearClick
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "button",
        {
          className: "toolbar-button",
          title: "Find Down",
          onClick: () => doFind(findText, findMatchCase, findRegex, true),
          children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { className: "toolbar-icon", tabIndex: -1, src: findDownImage })
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "button",
        {
          className: "toolbar-button",
          title: "Find Up",
          onClick: () => doFind(findText, findMatchCase, findRegex, false),
          children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { className: "toolbar-icon", src: findUpImage })
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "toolbar-divider" })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        className: "toolbar-toggle-button",
        title: "Show Detail",
        onClick: props.toggleShowDetail,
        style: { backgroundColor: props.showDetail ? "#fefefe" : "transparent" },
        children: /* @__PURE__ */ jsxRuntimeExports.jsx("img", { className: "toolbar-icon", src: detailToggleImage })
      }
    ),
    props.showPrettify !== void 0 && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "toolbar-prettify", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "input",
        {
          type: "checkbox",
          title: "Show Prettify",
          checked: props.showPrettify,
          onClick: props.toggleShowPrettify
        }
      ),
      "Prettify"
    ] })
  ] });
});
function SearchInput({
  findText,
  onFindKeyDown,
  onFindChange,
  onMatchCaseClick,
  matchCase,
  onRegexClick,
  regex,
  onClearClick
}) {
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "toolbar-search-container", onKeyDown: onFindKeyDown, children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "input",
      {
        className: "toolbar-search-input",
        type: "text",
        value: findText,
        onChange: onFindChange
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "img",
      {
        src: matchCaseImage,
        title: "Match Case",
        className: "toolbar-search-inline-image",
        tabIndex: -1,
        onClick: onMatchCaseClick,
        style: { backgroundColor: matchCase ? "#ddd" : "transparent" }
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "img",
      {
        src: regexImage,
        title: "Use Regular Expression",
        className: "toolbar-search-inline-image",
        tabIndex: -1,
        onClick: onRegexClick,
        style: { backgroundColor: regex ? "#ddd" : "transparent" }
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "img",
      {
        src: cancelImage,
        title: "Clear Field",
        className: "toolbar-search-inline-image-cancel",
        tabIndex: -1,
        onClick: onClearClick
      }
    )
  ] });
}
function escapeRegex(s2) {
  return s2.replace(/[/\-\\^$*+?.()|[\]{}]/g, "\\$&");
}
function highlight(match) {
  return '<font color="blue">' + match + "</font>";
}
function highlightCellRenderer(value, findRegEx) {
  if (value != void 0 && findRegEx != null && value.match(findRegEx)) {
    value = value.replace(/</g, "&lt;").replace(/>/g, "&gt;");
    value = value.replace(findRegEx, highlight);
    return /* @__PURE__ */ jsxRuntimeExports.jsx("span", { dangerouslySetInnerHTML: { __html: value.toString() } });
  }
  return /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: value });
}
function backgroundHighlight(input, findRegEx) {
  if (findRegEx && input) {
    return input.replace(
      findRegEx,
      (match) => {
        return `<span class="backgroundHighlight">${match}</span>`;
      }
    );
  }
  return input;
}
function parseText(input = "", findRegEx, skipParse = false) {
  if (!input || skipParse)
    return {
      initialString: highlightCellRenderer(input, findRegEx ?? null),
      parsedData: void 0
    };
  const bracketIndex = input.indexOf("[");
  if (bracketIndex === -1)
    return {
      initialString: highlightCellRenderer(input, findRegEx ?? null),
      parsedData: void 0
    };
  const initialString = backgroundHighlight(input.substring(0, bracketIndex).trim(), findRegEx);
  const bracketContent = input.substring(bracketIndex + 1, input.length - 1);
  const parsedData = parseContent(bracketContent, findRegEx);
  return { initialString, parsedData };
}
function parseContent(content, findRegEx) {
  let currentKey = "";
  let currentValue = "";
  let isParsingKey = true;
  let depthSquareBracket = 0;
  let depthCurlyBracket = 0;
  const result = {};
  for (let i = 0; i < content.length; i++) {
    const char = content[i];
    if (char === "[")
      depthSquareBracket++;
    if (char === "]")
      depthSquareBracket--;
    if (char === "{")
      depthCurlyBracket++;
    if (char === "}")
      depthCurlyBracket--;
    if (char === "=" && isParsingKey) {
      isParsingKey = false;
      continue;
    }
    if (char === "," && depthSquareBracket === 0 && depthCurlyBracket === 0) {
      isParsingKey = true;
      result[backgroundHighlight(currentKey.trim(), findRegEx)] = parseValue$1(currentValue.trim(), findRegEx) || "";
      currentKey = "";
      currentValue = "";
      continue;
    }
    if (isParsingKey)
      currentKey += char;
    else
      currentValue += char;
  }
  if (currentKey) {
    result[backgroundHighlight(currentKey.trim(), findRegEx)] = parseValue$1(currentValue.trim(), findRegEx);
  }
  return result;
}
function parseValue$1(value, findRegEx) {
  if (!value || value === "[]")
    return "";
  if (value.startsWith("[") && value.endsWith("]")) {
    if (value[1] === '"' || value[1] === "[")
      return value;
    return parseContent(value.slice(1, -1), findRegEx);
  }
  return backgroundHighlight(value, findRegEx);
}
function copyTextToClipboard(text) {
  const copyFrom = document.createElement("textarea");
  copyFrom.innerHTML = text;
  document.body.appendChild(copyFrom);
  copyFrom.select();
  document.execCommand("copy");
  copyFrom.blur();
  document.body.removeChild(copyFrom);
}
function useFind(lines, findFn, gridApi, scrollToBottom) {
  const lastFoundId = reactExports.useRef("");
  const lastFindRegEx = reactExports.useRef(null);
  const findRegEx = reactExports.useRef(null);
  const onFind = (regex, down) => {
    if (!gridApi.current) {
      return -1;
    }
    findRegEx.current = regex;
    if (findRegEx.current === null) {
      lastFoundId.current = "";
      lastFindRegEx.current = null;
      gridApi.current.refreshCells({ force: true });
      return;
    }
    const selected = gridApi.current.getSelectedNodes();
    let selectedIndex = -1;
    if (selected.length > 0) {
      selectedIndex = selected[0].rowIndex;
    }
    let lastFoundIndex = -1;
    const lastFoundNode = gridApi.current.getRowNode(lastFoundId.current);
    if (lastFoundNode) {
      lastFoundIndex = lastFoundNode.rowIndex;
    }
    const continueFind = findRegEx.current !== null && lastFindRegEx.current !== null && findRegEx.current.toString() === lastFindRegEx.current.toString();
    const foundIndex = find(
      findRegEx.current,
      continueFind,
      lines.length,
      selectedIndex,
      lastFoundIndex,
      down,
      (i) => {
        const r2 = gridApi.current.getDisplayedRowAtIndex(i);
        if (r2 && r2.rowIndex != null) {
          return findFn(lines[r2.rowIndex]);
        }
        return "";
      }
    );
    lastFoundId.current = "";
    lastFindRegEx.current = findRegEx.current;
    if (foundIndex !== -1) {
      const node = gridApi.current.getDisplayedRowAtIndex(foundIndex);
      lastFoundId.current = node.id;
      scrollToBottom.current = false;
      gridApi.current.deselectAll();
      gridApi.current.setNodesSelected({ nodes: [node], newValue: true });
      gridApi.current.ensureIndexVisible(foundIndex);
    } else {
      window.alert("Not Found");
    }
    gridApi.current.refreshCells({ force: true });
    return foundIndex;
  };
  return { onFind, findRegEx };
}
function find(findRegEx, continueFind, lineCount, selectedIndex, lastFoundIndex, findDown, fnGetLineText) {
  if (lineCount === 0) {
    return -1;
  }
  if (lastFoundIndex >= lineCount) {
    lastFoundIndex = -1;
  }
  let start;
  if (!continueFind) {
    if (selectedIndex === -1) {
      start = findDown ? 0 : lineCount - 1;
    } else {
      start = selectedIndex;
    }
  } else {
    if (selectedIndex === -1) {
      if (lastFoundIndex != -1) {
        start = findDown ? lastFoundIndex + 1 : lastFoundIndex - 1;
      } else {
        start = findDown ? 0 : lineCount - 1;
      }
    } else {
      if (lastFoundIndex === selectedIndex) {
        start = findDown ? selectedIndex + 1 : selectedIndex - 1;
      } else {
        start = selectedIndex;
      }
    }
  }
  if (start > lineCount - 1) {
    start = 0;
  } else if (start < 0) {
    start = lineCount - 1;
  }
  const foundLine = findNext(findRegEx, lineCount, start, findDown, fnGetLineText);
  return foundLine;
}
function findNext(findRegEx, lineCount, start, findDown, fnGetLineText) {
  let i = start;
  let findPos = -1;
  if (findDown) {
    do {
      if (fnGetLineText(i).match(findRegEx)) {
        findPos = i;
        break;
      }
      i++;
      if (i > lineCount - 1) {
        i = 0;
      }
    } while (i !== start);
  } else {
    do {
      if (fnGetLineText(i).match(findRegEx)) {
        findPos = i;
        break;
      }
      i--;
      if (i < 0) {
        i = lineCount - 1;
      }
    } while (i !== start);
  }
  return findPos;
}
const ObjectExplorer = ({ objectName, data }) => {
  const [isExpanded, setIsExpanded] = reactExports.useState(true);
  const toggleExpanded = () => setIsExpanded(!isExpanded);
  return /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
    objectName && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "object-explorer-object-name-container", onClick: toggleExpanded, children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "object-explorer-arrow", children: isExpanded ? "▼" : "▶" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "object-explorer-property-name", children: objectName }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "object-explorer-property-value", children: !isExpanded && " {...}" })
    ] }),
    isExpanded && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { style: { paddingLeft: objectName ? "20px" : "0px" }, children: Object.entries(data).map(([key, value]) => /* @__PURE__ */ jsxRuntimeExports.jsx(Property, { propertyName: key, data: value }, key)) })
  ] });
};
const Property = ({ propertyName, data }) => {
  return /* @__PURE__ */ jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment, { children: data && typeof data === "object" ? /* @__PURE__ */ jsxRuntimeExports.jsx(ObjectExplorer, { objectName: propertyName, data }) : /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "object-explorer-property-container", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "object-explorer-property-name", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "span",
        {
          dangerouslySetInnerHTML: { __html: propertyName }
        }
      ),
      ":"
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "object-explorer-property-value", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
      "span",
      {
        dangerouslySetInnerHTML: { __html: `"${data}"` }
      }
    ) })
  ] }) });
};
const ROW_HEIGHT$1 = 20;
function StreamLinkLog() {
  const [selectedRow, setSelectedRow] = reactExports.useState(void 0);
  const [logLines, setLogLines] = reactExports.useState(store.logLines);
  const [showDetail, setShowDetail] = reactExports.useState(false);
  const [showPrettify, setShowPrettify] = reactExports.useState(true);
  const gridApi = reactExports.useRef(null);
  const scrollToBottom = reactExports.useRef(false);
  const {
    onFind,
    findRegEx
  } = useFind(logLines, (logLine) => logLine.line, gridApi, scrollToBottom);
  const logLinesRef = reactExports.useRef(logLines);
  const onFindRef = reactExports.useRef(null);
  const level = reactExports.useRef(7);
  const filter = reactExports.useRef(null);
  logLinesRef.current = logLines;
  const [columnDefs] = reactExports.useState([
    {
      headerName: "Line",
      field: "lineNumber",
      width: 100,
      resizable: true,
      cellStyle: { textAlign: "left", fontFamily: "monospace", fontSize: "14px" }
    },
    {
      headerName: "Log Line",
      field: "line",
      width: 2e4,
      resizable: true,
      cellStyle: { textAlign: "left", fontFamily: "monospace", fontSize: "14px" },
      cellRenderer: (p2) => {
        return highlightCellRenderer(p2.data.line, findRegEx.current);
      }
    }
  ]);
  reactExports.useEffect(() => {
    const listener = (message) => {
      if (message.type === "initial") {
        const addLines = filterLogLines(store.logLines, level.current, filter.current);
        setLogLines(addLines);
      } else {
        const addLines = filterLogLines(message.logLines, level.current, filter.current);
        setLogLines((logLines2) => {
          return [...logLines2, ...addLines];
        });
      }
    };
    events.on("initial", listener);
    events.on("update", listener);
    return () => {
      events.off("initial", listener);
      events.off("update", listener);
    };
  }, []);
  reactExports.useEffect(() => {
    if (scrollToBottom.current && gridApi.current && logLines.length > 0) {
      gridApi.current.ensureIndexVisible(logLines.length - 1);
    }
  });
  function onLevelChange(newLevel) {
    level.current = newLevel;
    setLogLines(filterLogLines(store.logLines, level.current, filter.current));
  }
  function onFilter(regex) {
    filter.current = regex;
    setLogLines(filterLogLines(store.logLines, level.current, filter.current));
  }
  function onClear() {
    store.onClearLog();
    setLogLines([]);
  }
  onFindRef.current = onFind;
  const onKeyDown = (evt) => {
    const event = evt.event;
    if (event.code === "Enter") {
      onFindRef.current(findRegEx.current, !event.shiftKey);
    } else if (event.metaKey || event.ctrlKey) {
      if (event.code === "KeyC") {
        const selected = gridApi.current.getSelectedNodes();
        const lines = selected.map((r2) => logLinesRef.current[r2.rowIndex].line);
        copyTextToClipboard(lines.join("\n"));
      } else if (event.code === "KeyA") {
        gridApi.current.selectAll();
      }
    }
  };
  const onCellDoubleClicked = () => {
    setShowDetail(true);
  };
  const toggleShowDetail = () => {
    setShowDetail(!showDetail);
  };
  const toggleShowPrettify = () => {
    setShowPrettify(!showPrettify);
  };
  const onRowSelected = (event) => {
    if (event.node.isSelected()) {
      setSelectedRow(event.node.data);
    }
  };
  const getRowId = (r2) => {
    return String(r2.data.index);
  };
  const onBodyScroll = (p2) => {
    if (p2.direction === "vertical") {
      const gridBottom = gridApi.current.getVerticalPixelRange().bottom;
      if (gridBottom !== 0) {
        scrollToBottom.current = Math.abs(gridBottom - logLinesRef.current.length * ROW_HEIGHT$1) < ROW_HEIGHT$1;
      }
    }
  };
  function filterLogLines(logLines2, level2, regex) {
    if (level2 === 9 && regex === null) {
      return logLines2;
    }
    const filteredLines = logLines2.filter((l2) => l2.level <= level2 && (regex === null || l2.line.match(regex)));
    return filteredLines;
  }
  const splitterComponents = [];
  splitterComponents.push(/* @__PURE__ */ jsxRuntimeExports.jsx(
    main.AgGridReact,
    {
      rowData: logLines,
      rowSelection: "multiple",
      rowHeight: ROW_HEIGHT$1,
      getRowId,
      headerHeight: 0,
      onRowSelected,
      columnDefs,
      onGridReady: (p2) => gridApi.current = p2.api,
      gridOptions: {
        onBodyScroll,
        onCellKeyDown: onKeyDown,
        onCellDoubleClicked
      }
    }
  ));
  if (showDetail) {
    const {
      initialString,
      parsedData
    } = parseText(selectedRow == null ? void 0 : selectedRow.line, findRegEx.current || void 0, !showPrettify || (selectedRow == null ? void 0 : selectedRow.level) !== 7);
    splitterComponents.push(
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "detail-panel", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
        "pre",
        {
          className: "detail-panel-pre",
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: initialString }),
            parsedData && /* @__PURE__ */ jsxRuntimeExports.jsx(ObjectExplorer, { data: parsedData })
          ]
        }
      ) })
    );
  }
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "container ag-theme-alpine", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      Toolbar,
      {
        showLevel: true,
        onFind,
        onLevelChange,
        onFilter,
        onClear,
        toggleShowDetail,
        showDetail,
        toggleShowPrettify,
        showPrettify,
        level: 7
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Splitter, { components: splitterComponents })
  ] });
}
/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */
function round$1(v2) {
  return v2 + 0.5 | 0;
}
const lim = (v2, l2, h) => Math.max(Math.min(v2, h), l2);
function p2b(v2) {
  return lim(round$1(v2 * 2.55), 0, 255);
}
function n2b(v2) {
  return lim(round$1(v2 * 255), 0, 255);
}
function b2n(v2) {
  return lim(round$1(v2 / 2.55) / 100, 0, 1);
}
function n2p(v2) {
  return lim(round$1(v2 * 100), 0, 100);
}
const map$1$1 = { 0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9, A: 10, B: 11, C: 12, D: 13, E: 14, F: 15, a: 10, b: 11, c: 12, d: 13, e: 14, f: 15 };
const hex = [..."0123456789ABCDEF"];
const h1 = (b) => hex[b & 15];
const h2 = (b) => hex[(b & 240) >> 4] + hex[b & 15];
const eq = (b) => (b & 240) >> 4 === (b & 15);
const isShort = (v2) => eq(v2.r) && eq(v2.g) && eq(v2.b) && eq(v2.a);
function hexParse(str) {
  var len = str.length;
  var ret;
  if (str[0] === "#") {
    if (len === 4 || len === 5) {
      ret = {
        r: 255 & map$1$1[str[1]] * 17,
        g: 255 & map$1$1[str[2]] * 17,
        b: 255 & map$1$1[str[3]] * 17,
        a: len === 5 ? map$1$1[str[4]] * 17 : 255
      };
    } else if (len === 7 || len === 9) {
      ret = {
        r: map$1$1[str[1]] << 4 | map$1$1[str[2]],
        g: map$1$1[str[3]] << 4 | map$1$1[str[4]],
        b: map$1$1[str[5]] << 4 | map$1$1[str[6]],
        a: len === 9 ? map$1$1[str[7]] << 4 | map$1$1[str[8]] : 255
      };
    }
  }
  return ret;
}
const alpha = (a, f2) => a < 255 ? f2(a) : "";
function hexString(v2) {
  var f2 = isShort(v2) ? h1 : h2;
  return v2 ? "#" + f2(v2.r) + f2(v2.g) + f2(v2.b) + alpha(v2.a, f2) : void 0;
}
const HUE_RE = /^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;
function hsl2rgbn(h, s2, l2) {
  const a = s2 * Math.min(l2, 1 - l2);
  const f2 = (n2, k2 = (n2 + h / 30) % 12) => l2 - a * Math.max(Math.min(k2 - 3, 9 - k2, 1), -1);
  return [f2(0), f2(8), f2(4)];
}
function hsv2rgbn(h, s2, v2) {
  const f2 = (n2, k2 = (n2 + h / 60) % 6) => v2 - v2 * s2 * Math.max(Math.min(k2, 4 - k2, 1), 0);
  return [f2(5), f2(3), f2(1)];
}
function hwb2rgbn(h, w2, b) {
  const rgb = hsl2rgbn(h, 1, 0.5);
  let i;
  if (w2 + b > 1) {
    i = 1 / (w2 + b);
    w2 *= i;
    b *= i;
  }
  for (i = 0; i < 3; i++) {
    rgb[i] *= 1 - w2 - b;
    rgb[i] += w2;
  }
  return rgb;
}
function hueValue(r2, g, b, d, max2) {
  if (r2 === max2) {
    return (g - b) / d + (g < b ? 6 : 0);
  }
  if (g === max2) {
    return (b - r2) / d + 2;
  }
  return (r2 - g) / d + 4;
}
function rgb2hsl(v2) {
  const range = 255;
  const r2 = v2.r / range;
  const g = v2.g / range;
  const b = v2.b / range;
  const max2 = Math.max(r2, g, b);
  const min2 = Math.min(r2, g, b);
  const l2 = (max2 + min2) / 2;
  let h, s2, d;
  if (max2 !== min2) {
    d = max2 - min2;
    s2 = l2 > 0.5 ? d / (2 - max2 - min2) : d / (max2 + min2);
    h = hueValue(r2, g, b, d, max2);
    h = h * 60 + 0.5;
  }
  return [h | 0, s2 || 0, l2];
}
function calln(f2, a, b, c) {
  return (Array.isArray(a) ? f2(a[0], a[1], a[2]) : f2(a, b, c)).map(n2b);
}
function hsl2rgb(h, s2, l2) {
  return calln(hsl2rgbn, h, s2, l2);
}
function hwb2rgb(h, w2, b) {
  return calln(hwb2rgbn, h, w2, b);
}
function hsv2rgb(h, s2, v2) {
  return calln(hsv2rgbn, h, s2, v2);
}
function hue(h) {
  return (h % 360 + 360) % 360;
}
function hueParse(str) {
  const m2 = HUE_RE.exec(str);
  let a = 255;
  let v2;
  if (!m2) {
    return;
  }
  if (m2[5] !== v2) {
    a = m2[6] ? p2b(+m2[5]) : n2b(+m2[5]);
  }
  const h = hue(+m2[2]);
  const p1 = +m2[3] / 100;
  const p2 = +m2[4] / 100;
  if (m2[1] === "hwb") {
    v2 = hwb2rgb(h, p1, p2);
  } else if (m2[1] === "hsv") {
    v2 = hsv2rgb(h, p1, p2);
  } else {
    v2 = hsl2rgb(h, p1, p2);
  }
  return {
    r: v2[0],
    g: v2[1],
    b: v2[2],
    a
  };
}
function rotate(v2, deg) {
  var h = rgb2hsl(v2);
  h[0] = hue(h[0] + deg);
  h = hsl2rgb(h);
  v2.r = h[0];
  v2.g = h[1];
  v2.b = h[2];
}
function hslString(v2) {
  if (!v2) {
    return;
  }
  const a = rgb2hsl(v2);
  const h = a[0];
  const s2 = n2p(a[1]);
  const l2 = n2p(a[2]);
  return v2.a < 255 ? `hsla(${h}, ${s2}%, ${l2}%, ${b2n(v2.a)})` : `hsl(${h}, ${s2}%, ${l2}%)`;
}
const map$2 = {
  x: "dark",
  Z: "light",
  Y: "re",
  X: "blu",
  W: "gr",
  V: "medium",
  U: "slate",
  A: "ee",
  T: "ol",
  S: "or",
  B: "ra",
  C: "lateg",
  D: "ights",
  R: "in",
  Q: "turquois",
  E: "hi",
  P: "ro",
  O: "al",
  N: "le",
  M: "de",
  L: "yello",
  F: "en",
  K: "ch",
  G: "arks",
  H: "ea",
  I: "ightg",
  J: "wh"
};
const names$1 = {
  OiceXe: "f0f8ff",
  antiquewEte: "faebd7",
  aqua: "ffff",
  aquamarRe: "7fffd4",
  azuY: "f0ffff",
  beige: "f5f5dc",
  bisque: "ffe4c4",
  black: "0",
  blanKedOmond: "ffebcd",
  Xe: "ff",
  XeviTet: "8a2be2",
  bPwn: "a52a2a",
  burlywood: "deb887",
  caMtXe: "5f9ea0",
  KartYuse: "7fff00",
  KocTate: "d2691e",
  cSO: "ff7f50",
  cSnflowerXe: "6495ed",
  cSnsilk: "fff8dc",
  crimson: "dc143c",
  cyan: "ffff",
  xXe: "8b",
  xcyan: "8b8b",
  xgTMnPd: "b8860b",
  xWay: "a9a9a9",
  xgYF: "6400",
  xgYy: "a9a9a9",
  xkhaki: "bdb76b",
  xmagFta: "8b008b",
  xTivegYF: "556b2f",
  xSange: "ff8c00",
  xScEd: "9932cc",
  xYd: "8b0000",
  xsOmon: "e9967a",
  xsHgYF: "8fbc8f",
  xUXe: "483d8b",
  xUWay: "2f4f4f",
  xUgYy: "2f4f4f",
  xQe: "ced1",
  xviTet: "9400d3",
  dAppRk: "ff1493",
  dApskyXe: "bfff",
  dimWay: "696969",
  dimgYy: "696969",
  dodgerXe: "1e90ff",
  fiYbrick: "b22222",
  flSOwEte: "fffaf0",
  foYstWAn: "228b22",
  fuKsia: "ff00ff",
  gaRsbSo: "dcdcdc",
  ghostwEte: "f8f8ff",
  gTd: "ffd700",
  gTMnPd: "daa520",
  Way: "808080",
  gYF: "8000",
  gYFLw: "adff2f",
  gYy: "808080",
  honeyMw: "f0fff0",
  hotpRk: "ff69b4",
  RdianYd: "cd5c5c",
  Rdigo: "4b0082",
  ivSy: "fffff0",
  khaki: "f0e68c",
  lavFMr: "e6e6fa",
  lavFMrXsh: "fff0f5",
  lawngYF: "7cfc00",
  NmoncEffon: "fffacd",
  ZXe: "add8e6",
  ZcSO: "f08080",
  Zcyan: "e0ffff",
  ZgTMnPdLw: "fafad2",
  ZWay: "d3d3d3",
  ZgYF: "90ee90",
  ZgYy: "d3d3d3",
  ZpRk: "ffb6c1",
  ZsOmon: "ffa07a",
  ZsHgYF: "20b2aa",
  ZskyXe: "87cefa",
  ZUWay: "778899",
  ZUgYy: "778899",
  ZstAlXe: "b0c4de",
  ZLw: "ffffe0",
  lime: "ff00",
  limegYF: "32cd32",
  lRF: "faf0e6",
  magFta: "ff00ff",
  maPon: "800000",
  VaquamarRe: "66cdaa",
  VXe: "cd",
  VScEd: "ba55d3",
  VpurpN: "9370db",
  VsHgYF: "3cb371",
  VUXe: "7b68ee",
  VsprRggYF: "fa9a",
  VQe: "48d1cc",
  VviTetYd: "c71585",
  midnightXe: "191970",
  mRtcYam: "f5fffa",
  mistyPse: "ffe4e1",
  moccasR: "ffe4b5",
  navajowEte: "ffdead",
  navy: "80",
  Tdlace: "fdf5e6",
  Tive: "808000",
  TivedBb: "6b8e23",
  Sange: "ffa500",
  SangeYd: "ff4500",
  ScEd: "da70d6",
  pOegTMnPd: "eee8aa",
  pOegYF: "98fb98",
  pOeQe: "afeeee",
  pOeviTetYd: "db7093",
  papayawEp: "ffefd5",
  pHKpuff: "ffdab9",
  peru: "cd853f",
  pRk: "ffc0cb",
  plum: "dda0dd",
  powMrXe: "b0e0e6",
  purpN: "800080",
  YbeccapurpN: "663399",
  Yd: "ff0000",
  Psybrown: "bc8f8f",
  PyOXe: "4169e1",
  saddNbPwn: "8b4513",
  sOmon: "fa8072",
  sandybPwn: "f4a460",
  sHgYF: "2e8b57",
  sHshell: "fff5ee",
  siFna: "a0522d",
  silver: "c0c0c0",
  skyXe: "87ceeb",
  UXe: "6a5acd",
  UWay: "708090",
  UgYy: "708090",
  snow: "fffafa",
  sprRggYF: "ff7f",
  stAlXe: "4682b4",
  tan: "d2b48c",
  teO: "8080",
  tEstN: "d8bfd8",
  tomato: "ff6347",
  Qe: "40e0d0",
  viTet: "ee82ee",
  JHt: "f5deb3",
  wEte: "ffffff",
  wEtesmoke: "f5f5f5",
  Lw: "ffff00",
  LwgYF: "9acd32"
};
function unpack() {
  const unpacked = {};
  const keys2 = Object.keys(names$1);
  const tkeys = Object.keys(map$2);
  let i, j, k2, ok2, nk2;
  for (i = 0; i < keys2.length; i++) {
    ok2 = nk2 = keys2[i];
    for (j = 0; j < tkeys.length; j++) {
      k2 = tkeys[j];
      nk2 = nk2.replace(k2, map$2[k2]);
    }
    k2 = parseInt(names$1[ok2], 16);
    unpacked[nk2] = [k2 >> 16 & 255, k2 >> 8 & 255, k2 & 255];
  }
  return unpacked;
}
let names;
function nameParse(str) {
  if (!names) {
    names = unpack();
    names.transparent = [0, 0, 0, 0];
  }
  const a = names[str.toLowerCase()];
  return a && {
    r: a[0],
    g: a[1],
    b: a[2],
    a: a.length === 4 ? a[3] : 255
  };
}
const RGB_RE = /^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;
function rgbParse(str) {
  const m2 = RGB_RE.exec(str);
  let a = 255;
  let r2, g, b;
  if (!m2) {
    return;
  }
  if (m2[7] !== r2) {
    const v2 = +m2[7];
    a = m2[8] ? p2b(v2) : lim(v2 * 255, 0, 255);
  }
  r2 = +m2[1];
  g = +m2[3];
  b = +m2[5];
  r2 = 255 & (m2[2] ? p2b(r2) : lim(r2, 0, 255));
  g = 255 & (m2[4] ? p2b(g) : lim(g, 0, 255));
  b = 255 & (m2[6] ? p2b(b) : lim(b, 0, 255));
  return {
    r: r2,
    g,
    b,
    a
  };
}
function rgbString(v2) {
  return v2 && (v2.a < 255 ? `rgba(${v2.r}, ${v2.g}, ${v2.b}, ${b2n(v2.a)})` : `rgb(${v2.r}, ${v2.g}, ${v2.b})`);
}
const to$1 = (v2) => v2 <= 31308e-7 ? v2 * 12.92 : Math.pow(v2, 1 / 2.4) * 1.055 - 0.055;
const from$1 = (v2) => v2 <= 0.04045 ? v2 / 12.92 : Math.pow((v2 + 0.055) / 1.055, 2.4);
function interpolate$1(rgb1, rgb2, t2) {
  const r2 = from$1(b2n(rgb1.r));
  const g = from$1(b2n(rgb1.g));
  const b = from$1(b2n(rgb1.b));
  return {
    r: n2b(to$1(r2 + t2 * (from$1(b2n(rgb2.r)) - r2))),
    g: n2b(to$1(g + t2 * (from$1(b2n(rgb2.g)) - g))),
    b: n2b(to$1(b + t2 * (from$1(b2n(rgb2.b)) - b))),
    a: rgb1.a + t2 * (rgb2.a - rgb1.a)
  };
}
function modHSL(v2, i, ratio) {
  if (v2) {
    let tmp = rgb2hsl(v2);
    tmp[i] = Math.max(0, Math.min(tmp[i] + tmp[i] * ratio, i === 0 ? 360 : 1));
    tmp = hsl2rgb(tmp);
    v2.r = tmp[0];
    v2.g = tmp[1];
    v2.b = tmp[2];
  }
}
function clone$3(v2, proto2) {
  return v2 ? Object.assign(proto2 || {}, v2) : v2;
}
function fromObject(input) {
  var v2 = { r: 0, g: 0, b: 0, a: 255 };
  if (Array.isArray(input)) {
    if (input.length >= 3) {
      v2 = { r: input[0], g: input[1], b: input[2], a: 255 };
      if (input.length > 3) {
        v2.a = n2b(input[3]);
      }
    }
  } else {
    v2 = clone$3(input, { r: 0, g: 0, b: 0, a: 1 });
    v2.a = n2b(v2.a);
  }
  return v2;
}
function functionParse(str) {
  if (str.charAt(0) === "r") {
    return rgbParse(str);
  }
  return hueParse(str);
}
class Color {
  constructor(input) {
    if (input instanceof Color) {
      return input;
    }
    const type = typeof input;
    let v2;
    if (type === "object") {
      v2 = fromObject(input);
    } else if (type === "string") {
      v2 = hexParse(input) || nameParse(input) || functionParse(input);
    }
    this._rgb = v2;
    this._valid = !!v2;
  }
  get valid() {
    return this._valid;
  }
  get rgb() {
    var v2 = clone$3(this._rgb);
    if (v2) {
      v2.a = b2n(v2.a);
    }
    return v2;
  }
  set rgb(obj) {
    this._rgb = fromObject(obj);
  }
  rgbString() {
    return this._valid ? rgbString(this._rgb) : void 0;
  }
  hexString() {
    return this._valid ? hexString(this._rgb) : void 0;
  }
  hslString() {
    return this._valid ? hslString(this._rgb) : void 0;
  }
  mix(color2, weight) {
    if (color2) {
      const c1 = this.rgb;
      const c2 = color2.rgb;
      let w2;
      const p2 = weight === w2 ? 0.5 : weight;
      const w3 = 2 * p2 - 1;
      const a = c1.a - c2.a;
      const w1 = ((w3 * a === -1 ? w3 : (w3 + a) / (1 + w3 * a)) + 1) / 2;
      w2 = 1 - w1;
      c1.r = 255 & w1 * c1.r + w2 * c2.r + 0.5;
      c1.g = 255 & w1 * c1.g + w2 * c2.g + 0.5;
      c1.b = 255 & w1 * c1.b + w2 * c2.b + 0.5;
      c1.a = p2 * c1.a + (1 - p2) * c2.a;
      this.rgb = c1;
    }
    return this;
  }
  interpolate(color2, t2) {
    if (color2) {
      this._rgb = interpolate$1(this._rgb, color2._rgb, t2);
    }
    return this;
  }
  clone() {
    return new Color(this.rgb);
  }
  alpha(a) {
    this._rgb.a = n2b(a);
    return this;
  }
  clearer(ratio) {
    const rgb = this._rgb;
    rgb.a *= 1 - ratio;
    return this;
  }
  greyscale() {
    const rgb = this._rgb;
    const val = round$1(rgb.r * 0.3 + rgb.g * 0.59 + rgb.b * 0.11);
    rgb.r = rgb.g = rgb.b = val;
    return this;
  }
  opaquer(ratio) {
    const rgb = this._rgb;
    rgb.a *= 1 + ratio;
    return this;
  }
  negate() {
    const v2 = this._rgb;
    v2.r = 255 - v2.r;
    v2.g = 255 - v2.g;
    v2.b = 255 - v2.b;
    return this;
  }
  lighten(ratio) {
    modHSL(this._rgb, 2, ratio);
    return this;
  }
  darken(ratio) {
    modHSL(this._rgb, 2, -ratio);
    return this;
  }
  saturate(ratio) {
    modHSL(this._rgb, 1, ratio);
    return this;
  }
  desaturate(ratio) {
    modHSL(this._rgb, 1, -ratio);
    return this;
  }
  rotate(deg) {
    rotate(this._rgb, deg);
    return this;
  }
}
/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */
function noop() {
}
const uid = (() => {
  let id2 = 0;
  return () => id2++;
})();
function isNullOrUndef(value) {
  return value === null || typeof value === "undefined";
}
function isArray$1(value) {
  if (Array.isArray && Array.isArray(value)) {
    return true;
  }
  const type = Object.prototype.toString.call(value);
  if (type.slice(0, 7) === "[object" && type.slice(-6) === "Array]") {
    return true;
  }
  return false;
}
function isObject$1(value) {
  return value !== null && Object.prototype.toString.call(value) === "[object Object]";
}
function isNumberFinite(value) {
  return (typeof value === "number" || value instanceof Number) && isFinite(+value);
}
function finiteOrDefault(value, defaultValue) {
  return isNumberFinite(value) ? value : defaultValue;
}
function valueOrDefault(value, defaultValue) {
  return typeof value === "undefined" ? defaultValue : value;
}
const toPercentage = (value, dimension) => typeof value === "string" && value.endsWith("%") ? parseFloat(value) / 100 : +value / dimension;
const toDimension = (value, dimension) => typeof value === "string" && value.endsWith("%") ? parseFloat(value) / 100 * dimension : +value;
function callback(fn, args, thisArg) {
  if (fn && typeof fn.call === "function") {
    return fn.apply(thisArg, args);
  }
}
function each(loopable, fn, thisArg, reverse) {
  let i, len, keys2;
  if (isArray$1(loopable)) {
    len = loopable.length;
    if (reverse) {
      for (i = len - 1; i >= 0; i--) {
        fn.call(thisArg, loopable[i], i);
      }
    } else {
      for (i = 0; i < len; i++) {
        fn.call(thisArg, loopable[i], i);
      }
    }
  } else if (isObject$1(loopable)) {
    keys2 = Object.keys(loopable);
    len = keys2.length;
    for (i = 0; i < len; i++) {
      fn.call(thisArg, loopable[keys2[i]], keys2[i]);
    }
  }
}
function _elementsEqual(a0, a1) {
  let i, ilen, v0, v1;
  if (!a0 || !a1 || a0.length !== a1.length) {
    return false;
  }
  for (i = 0, ilen = a0.length; i < ilen; ++i) {
    v0 = a0[i];
    v1 = a1[i];
    if (v0.datasetIndex !== v1.datasetIndex || v0.index !== v1.index) {
      return false;
    }
  }
  return true;
}
function clone$2(source) {
  if (isArray$1(source)) {
    return source.map(clone$2);
  }
  if (isObject$1(source)) {
    const target = /* @__PURE__ */ Object.create(null);
    const keys2 = Object.keys(source);
    const klen = keys2.length;
    let k2 = 0;
    for (; k2 < klen; ++k2) {
      target[keys2[k2]] = clone$2(source[keys2[k2]]);
    }
    return target;
  }
  return source;
}
function isValidKey(key) {
  return [
    "__proto__",
    "prototype",
    "constructor"
  ].indexOf(key) === -1;
}
function _merger(key, target, source, options) {
  if (!isValidKey(key)) {
    return;
  }
  const tval = target[key];
  const sval = source[key];
  if (isObject$1(tval) && isObject$1(sval)) {
    merge(tval, sval, options);
  } else {
    target[key] = clone$2(sval);
  }
}
function merge(target, source, options) {
  const sources = isArray$1(source) ? source : [
    source
  ];
  const ilen = sources.length;
  if (!isObject$1(target)) {
    return target;
  }
  options = options || {};
  const merger = options.merger || _merger;
  let current;
  for (let i = 0; i < ilen; ++i) {
    current = sources[i];
    if (!isObject$1(current)) {
      continue;
    }
    const keys2 = Object.keys(current);
    for (let k2 = 0, klen = keys2.length; k2 < klen; ++k2) {
      merger(keys2[k2], target, current, options);
    }
  }
  return target;
}
function mergeIf(target, source) {
  return merge(target, source, {
    merger: _mergerIf
  });
}
function _mergerIf(key, target, source) {
  if (!isValidKey(key)) {
    return;
  }
  const tval = target[key];
  const sval = source[key];
  if (isObject$1(tval) && isObject$1(sval)) {
    mergeIf(tval, sval);
  } else if (!Object.prototype.hasOwnProperty.call(target, key)) {
    target[key] = clone$2(sval);
  }
}
const keyResolvers = {
  // Chart.helpers.core resolveObjectKey should resolve empty key to root object
  "": (v2) => v2,
  // default resolvers
  x: (o) => o.x,
  y: (o) => o.y
};
function _splitKey(key) {
  const parts = key.split(".");
  const keys2 = [];
  let tmp = "";
  for (const part of parts) {
    tmp += part;
    if (tmp.endsWith("\\")) {
      tmp = tmp.slice(0, -1) + ".";
    } else {
      keys2.push(tmp);
      tmp = "";
    }
  }
  return keys2;
}
function _getKeyResolver(key) {
  const keys2 = _splitKey(key);
  return (obj) => {
    for (const k2 of keys2) {
      if (k2 === "") {
        break;
      }
      obj = obj && obj[k2];
    }
    return obj;
  };
}
function resolveObjectKey(obj, key) {
  const resolver = keyResolvers[key] || (keyResolvers[key] = _getKeyResolver(key));
  return resolver(obj);
}
function _capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}
const defined = (value) => typeof value !== "undefined";
const isFunction$1 = (value) => typeof value === "function";
const setsEqual = (a, b) => {
  if (a.size !== b.size) {
    return false;
  }
  for (const item of a) {
    if (!b.has(item)) {
      return false;
    }
  }
  return true;
};
function _isClickEvent(e) {
  return e.type === "mouseup" || e.type === "click" || e.type === "contextmenu";
}
const PI = Math.PI;
const TAU = 2 * PI;
const PITAU = TAU + PI;
const INFINITY = Number.POSITIVE_INFINITY;
const RAD_PER_DEG = PI / 180;
const HALF_PI = PI / 2;
const QUARTER_PI = PI / 4;
const TWO_THIRDS_PI = PI * 2 / 3;
const log10 = Math.log10;
const sign$1 = Math.sign;
function almostEquals(x2, y2, epsilon) {
  return Math.abs(x2 - y2) < epsilon;
}
function niceNum(range) {
  const roundedRange = Math.round(range);
  range = almostEquals(range, roundedRange, range / 1e3) ? roundedRange : range;
  const niceRange = Math.pow(10, Math.floor(log10(range)));
  const fraction = range / niceRange;
  const niceFraction = fraction <= 1 ? 1 : fraction <= 2 ? 2 : fraction <= 5 ? 5 : 10;
  return niceFraction * niceRange;
}
function _factorize(value) {
  const result = [];
  const sqrt = Math.sqrt(value);
  let i;
  for (i = 1; i < sqrt; i++) {
    if (value % i === 0) {
      result.push(i);
      result.push(value / i);
    }
  }
  if (sqrt === (sqrt | 0)) {
    result.push(sqrt);
  }
  result.sort((a, b) => a - b).pop();
  return result;
}
function isNumber$1(n2) {
  return !isNaN(parseFloat(n2)) && isFinite(n2);
}
function almostWhole(x2, epsilon) {
  const rounded = Math.round(x2);
  return rounded - epsilon <= x2 && rounded + epsilon >= x2;
}
function _setMinAndMaxByKey(array, target, property) {
  let i, ilen, value;
  for (i = 0, ilen = array.length; i < ilen; i++) {
    value = array[i][property];
    if (!isNaN(value)) {
      target.min = Math.min(target.min, value);
      target.max = Math.max(target.max, value);
    }
  }
}
function toRadians(degrees) {
  return degrees * (PI / 180);
}
function toDegrees(radians) {
  return radians * (180 / PI);
}
function _decimalPlaces(x2) {
  if (!isNumberFinite(x2)) {
    return;
  }
  let e = 1;
  let p2 = 0;
  while (Math.round(x2 * e) / e !== x2) {
    e *= 10;
    p2++;
  }
  return p2;
}
function getAngleFromPoint(centrePoint, anglePoint) {
  const distanceFromXCenter = anglePoint.x - centrePoint.x;
  const distanceFromYCenter = anglePoint.y - centrePoint.y;
  const radialDistanceFromCenter = Math.sqrt(distanceFromXCenter * distanceFromXCenter + distanceFromYCenter * distanceFromYCenter);
  let angle = Math.atan2(distanceFromYCenter, distanceFromXCenter);
  if (angle < -0.5 * PI) {
    angle += TAU;
  }
  return {
    angle,
    distance: radialDistanceFromCenter
  };
}
function distanceBetweenPoints(pt1, pt2) {
  return Math.sqrt(Math.pow(pt2.x - pt1.x, 2) + Math.pow(pt2.y - pt1.y, 2));
}
function _angleDiff(a, b) {
  return (a - b + PITAU) % TAU - PI;
}
function _normalizeAngle(a) {
  return (a % TAU + TAU) % TAU;
}
function _angleBetween(angle, start, end, sameAngleIsFullCircle) {
  const a = _normalizeAngle(angle);
  const s2 = _normalizeAngle(start);
  const e = _normalizeAngle(end);
  const angleToStart = _normalizeAngle(s2 - a);
  const angleToEnd = _normalizeAngle(e - a);
  const startToAngle = _normalizeAngle(a - s2);
  const endToAngle = _normalizeAngle(a - e);
  return a === s2 || a === e || sameAngleIsFullCircle && s2 === e || angleToStart > angleToEnd && startToAngle < endToAngle;
}
function _limitValue(value, min2, max2) {
  return Math.max(min2, Math.min(max2, value));
}
function _int16Range(value) {
  return _limitValue(value, -32768, 32767);
}
function _isBetween(value, start, end, epsilon = 1e-6) {
  return value >= Math.min(start, end) - epsilon && value <= Math.max(start, end) + epsilon;
}
function _lookup(table, value, cmp) {
  cmp = cmp || ((index2) => table[index2] < value);
  let hi2 = table.length - 1;
  let lo = 0;
  let mid;
  while (hi2 - lo > 1) {
    mid = lo + hi2 >> 1;
    if (cmp(mid)) {
      lo = mid;
    } else {
      hi2 = mid;
    }
  }
  return {
    lo,
    hi: hi2
  };
}
const _lookupByKey = (table, key, value, last2) => _lookup(table, value, last2 ? (index2) => {
  const ti2 = table[index2][key];
  return ti2 < value || ti2 === value && table[index2 + 1][key] === value;
} : (index2) => table[index2][key] < value);
const _rlookupByKey = (table, key, value) => _lookup(table, value, (index2) => table[index2][key] >= value);
function _filterBetween(values2, min2, max2) {
  let start = 0;
  let end = values2.length;
  while (start < end && values2[start] < min2) {
    start++;
  }
  while (end > start && values2[end - 1] > max2) {
    end--;
  }
  return start > 0 || end < values2.length ? values2.slice(start, end) : values2;
}
const arrayEvents = [
  "push",
  "pop",
  "shift",
  "splice",
  "unshift"
];
function listenArrayEvents(array, listener) {
  if (array._chartjs) {
    array._chartjs.listeners.push(listener);
    return;
  }
  Object.defineProperty(array, "_chartjs", {
    configurable: true,
    enumerable: false,
    value: {
      listeners: [
        listener
      ]
    }
  });
  arrayEvents.forEach((key) => {
    const method = "_onData" + _capitalize(key);
    const base = array[key];
    Object.defineProperty(array, key, {
      configurable: true,
      enumerable: false,
      value(...args) {
        const res = base.apply(this, args);
        array._chartjs.listeners.forEach((object) => {
          if (typeof object[method] === "function") {
            object[method](...args);
          }
        });
        return res;
      }
    });
  });
}
function unlistenArrayEvents(array, listener) {
  const stub = array._chartjs;
  if (!stub) {
    return;
  }
  const listeners2 = stub.listeners;
  const index2 = listeners2.indexOf(listener);
  if (index2 !== -1) {
    listeners2.splice(index2, 1);
  }
  if (listeners2.length > 0) {
    return;
  }
  arrayEvents.forEach((key) => {
    delete array[key];
  });
  delete array._chartjs;
}
function _arrayUnique(items) {
  const set2 = new Set(items);
  if (set2.size === items.length) {
    return items;
  }
  return Array.from(set2);
}
const requestAnimFrame = function() {
  if (typeof window === "undefined") {
    return function(callback2) {
      return callback2();
    };
  }
  return window.requestAnimationFrame;
}();
function throttled(fn, thisArg) {
  let argsToUse = [];
  let ticking = false;
  return function(...args) {
    argsToUse = args;
    if (!ticking) {
      ticking = true;
      requestAnimFrame.call(window, () => {
        ticking = false;
        fn.apply(thisArg, argsToUse);
      });
    }
  };
}
function debounce(fn, delay) {
  let timeout;
  return function(...args) {
    if (delay) {
      clearTimeout(timeout);
      timeout = setTimeout(fn, delay, args);
    } else {
      fn.apply(this, args);
    }
    return delay;
  };
}
const _toLeftRightCenter = (align) => align === "start" ? "left" : align === "end" ? "right" : "center";
const _alignStartEnd = (align, start, end) => align === "start" ? start : align === "end" ? end : (start + end) / 2;
const _textX = (align, left, right, rtl) => {
  const check = rtl ? "left" : "right";
  return align === check ? right : align === "center" ? (left + right) / 2 : left;
};
function _getStartAndCountOfVisiblePoints(meta, points, animationsDisabled) {
  const pointCount = points.length;
  let start = 0;
  let count = pointCount;
  if (meta._sorted) {
    const { iScale, _parsed } = meta;
    const axis = iScale.axis;
    const { min: min2, max: max2, minDefined, maxDefined } = iScale.getUserBounds();
    if (minDefined) {
      start = _limitValue(Math.min(
        // @ts-expect-error Need to type _parsed
        _lookupByKey(_parsed, axis, min2).lo,
        // @ts-expect-error Need to fix types on _lookupByKey
        animationsDisabled ? pointCount : _lookupByKey(points, axis, iScale.getPixelForValue(min2)).lo
      ), 0, pointCount - 1);
    }
    if (maxDefined) {
      count = _limitValue(Math.max(
        // @ts-expect-error Need to type _parsed
        _lookupByKey(_parsed, iScale.axis, max2, true).hi + 1,
        // @ts-expect-error Need to fix types on _lookupByKey
        animationsDisabled ? 0 : _lookupByKey(points, axis, iScale.getPixelForValue(max2), true).hi + 1
      ), start, pointCount) - start;
    } else {
      count = pointCount - start;
    }
  }
  return {
    start,
    count
  };
}
function _scaleRangesChanged(meta) {
  const { xScale, yScale, _scaleRanges } = meta;
  const newRanges = {
    xmin: xScale.min,
    xmax: xScale.max,
    ymin: yScale.min,
    ymax: yScale.max
  };
  if (!_scaleRanges) {
    meta._scaleRanges = newRanges;
    return true;
  }
  const changed = _scaleRanges.xmin !== xScale.min || _scaleRanges.xmax !== xScale.max || _scaleRanges.ymin !== yScale.min || _scaleRanges.ymax !== yScale.max;
  Object.assign(_scaleRanges, newRanges);
  return changed;
}
const atEdge = (t2) => t2 === 0 || t2 === 1;
const elasticIn = (t2, s2, p2) => -(Math.pow(2, 10 * (t2 -= 1)) * Math.sin((t2 - s2) * TAU / p2));
const elasticOut = (t2, s2, p2) => Math.pow(2, -10 * t2) * Math.sin((t2 - s2) * TAU / p2) + 1;
const effects = {
  linear: (t2) => t2,
  easeInQuad: (t2) => t2 * t2,
  easeOutQuad: (t2) => -t2 * (t2 - 2),
  easeInOutQuad: (t2) => (t2 /= 0.5) < 1 ? 0.5 * t2 * t2 : -0.5 * (--t2 * (t2 - 2) - 1),
  easeInCubic: (t2) => t2 * t2 * t2,
  easeOutCubic: (t2) => (t2 -= 1) * t2 * t2 + 1,
  easeInOutCubic: (t2) => (t2 /= 0.5) < 1 ? 0.5 * t2 * t2 * t2 : 0.5 * ((t2 -= 2) * t2 * t2 + 2),
  easeInQuart: (t2) => t2 * t2 * t2 * t2,
  easeOutQuart: (t2) => -((t2 -= 1) * t2 * t2 * t2 - 1),
  easeInOutQuart: (t2) => (t2 /= 0.5) < 1 ? 0.5 * t2 * t2 * t2 * t2 : -0.5 * ((t2 -= 2) * t2 * t2 * t2 - 2),
  easeInQuint: (t2) => t2 * t2 * t2 * t2 * t2,
  easeOutQuint: (t2) => (t2 -= 1) * t2 * t2 * t2 * t2 + 1,
  easeInOutQuint: (t2) => (t2 /= 0.5) < 1 ? 0.5 * t2 * t2 * t2 * t2 * t2 : 0.5 * ((t2 -= 2) * t2 * t2 * t2 * t2 + 2),
  easeInSine: (t2) => -Math.cos(t2 * HALF_PI) + 1,
  easeOutSine: (t2) => Math.sin(t2 * HALF_PI),
  easeInOutSine: (t2) => -0.5 * (Math.cos(PI * t2) - 1),
  easeInExpo: (t2) => t2 === 0 ? 0 : Math.pow(2, 10 * (t2 - 1)),
  easeOutExpo: (t2) => t2 === 1 ? 1 : -Math.pow(2, -10 * t2) + 1,
  easeInOutExpo: (t2) => atEdge(t2) ? t2 : t2 < 0.5 ? 0.5 * Math.pow(2, 10 * (t2 * 2 - 1)) : 0.5 * (-Math.pow(2, -10 * (t2 * 2 - 1)) + 2),
  easeInCirc: (t2) => t2 >= 1 ? t2 : -(Math.sqrt(1 - t2 * t2) - 1),
  easeOutCirc: (t2) => Math.sqrt(1 - (t2 -= 1) * t2),
  easeInOutCirc: (t2) => (t2 /= 0.5) < 1 ? -0.5 * (Math.sqrt(1 - t2 * t2) - 1) : 0.5 * (Math.sqrt(1 - (t2 -= 2) * t2) + 1),
  easeInElastic: (t2) => atEdge(t2) ? t2 : elasticIn(t2, 0.075, 0.3),
  easeOutElastic: (t2) => atEdge(t2) ? t2 : elasticOut(t2, 0.075, 0.3),
  easeInOutElastic(t2) {
    const s2 = 0.1125;
    const p2 = 0.45;
    return atEdge(t2) ? t2 : t2 < 0.5 ? 0.5 * elasticIn(t2 * 2, s2, p2) : 0.5 + 0.5 * elasticOut(t2 * 2 - 1, s2, p2);
  },
  easeInBack(t2) {
    const s2 = 1.70158;
    return t2 * t2 * ((s2 + 1) * t2 - s2);
  },
  easeOutBack(t2) {
    const s2 = 1.70158;
    return (t2 -= 1) * t2 * ((s2 + 1) * t2 + s2) + 1;
  },
  easeInOutBack(t2) {
    let s2 = 1.70158;
    if ((t2 /= 0.5) < 1) {
      return 0.5 * (t2 * t2 * (((s2 *= 1.525) + 1) * t2 - s2));
    }
    return 0.5 * ((t2 -= 2) * t2 * (((s2 *= 1.525) + 1) * t2 + s2) + 2);
  },
  easeInBounce: (t2) => 1 - effects.easeOutBounce(1 - t2),
  easeOutBounce(t2) {
    const m2 = 7.5625;
    const d = 2.75;
    if (t2 < 1 / d) {
      return m2 * t2 * t2;
    }
    if (t2 < 2 / d) {
      return m2 * (t2 -= 1.5 / d) * t2 + 0.75;
    }
    if (t2 < 2.5 / d) {
      return m2 * (t2 -= 2.25 / d) * t2 + 0.9375;
    }
    return m2 * (t2 -= 2.625 / d) * t2 + 0.984375;
  },
  easeInOutBounce: (t2) => t2 < 0.5 ? effects.easeInBounce(t2 * 2) * 0.5 : effects.easeOutBounce(t2 * 2 - 1) * 0.5 + 0.5
};
function isPatternOrGradient(value) {
  if (value && typeof value === "object") {
    const type = value.toString();
    return type === "[object CanvasPattern]" || type === "[object CanvasGradient]";
  }
  return false;
}
function color(value) {
  return isPatternOrGradient(value) ? value : new Color(value);
}
function getHoverColor(value) {
  return isPatternOrGradient(value) ? value : new Color(value).saturate(0.5).darken(0.1).hexString();
}
const numbers = [
  "x",
  "y",
  "borderWidth",
  "radius",
  "tension"
];
const colors = [
  "color",
  "borderColor",
  "backgroundColor"
];
function applyAnimationsDefaults(defaults2) {
  defaults2.set("animation", {
    delay: void 0,
    duration: 1e3,
    easing: "easeOutQuart",
    fn: void 0,
    from: void 0,
    loop: void 0,
    to: void 0,
    type: void 0
  });
  defaults2.describe("animation", {
    _fallback: false,
    _indexable: false,
    _scriptable: (name) => name !== "onProgress" && name !== "onComplete" && name !== "fn"
  });
  defaults2.set("animations", {
    colors: {
      type: "color",
      properties: colors
    },
    numbers: {
      type: "number",
      properties: numbers
    }
  });
  defaults2.describe("animations", {
    _fallback: "animation"
  });
  defaults2.set("transitions", {
    active: {
      animation: {
        duration: 400
      }
    },
    resize: {
      animation: {
        duration: 0
      }
    },
    show: {
      animations: {
        colors: {
          from: "transparent"
        },
        visible: {
          type: "boolean",
          duration: 0
        }
      }
    },
    hide: {
      animations: {
        colors: {
          to: "transparent"
        },
        visible: {
          type: "boolean",
          easing: "linear",
          fn: (v2) => v2 | 0
        }
      }
    }
  });
}
function applyLayoutsDefaults(defaults2) {
  defaults2.set("layout", {
    autoPadding: true,
    padding: {
      top: 0,
      right: 0,
      bottom: 0,
      left: 0
    }
  });
}
const intlCache = /* @__PURE__ */ new Map();
function getNumberFormat(locale2, options) {
  options = options || {};
  const cacheKey = locale2 + JSON.stringify(options);
  let formatter = intlCache.get(cacheKey);
  if (!formatter) {
    formatter = new Intl.NumberFormat(locale2, options);
    intlCache.set(cacheKey, formatter);
  }
  return formatter;
}
function formatNumber(num, locale2, options) {
  return getNumberFormat(locale2, options).format(num);
}
const formatters = {
  values(value) {
    return isArray$1(value) ? value : "" + value;
  },
  numeric(tickValue, index2, ticks) {
    if (tickValue === 0) {
      return "0";
    }
    const locale2 = this.chart.options.locale;
    let notation;
    let delta = tickValue;
    if (ticks.length > 1) {
      const maxTick = Math.max(Math.abs(ticks[0].value), Math.abs(ticks[ticks.length - 1].value));
      if (maxTick < 1e-4 || maxTick > 1e15) {
        notation = "scientific";
      }
      delta = calculateDelta(tickValue, ticks);
    }
    const logDelta = log10(Math.abs(delta));
    const numDecimal = isNaN(logDelta) ? 1 : Math.max(Math.min(-1 * Math.floor(logDelta), 20), 0);
    const options = {
      notation,
      minimumFractionDigits: numDecimal,
      maximumFractionDigits: numDecimal
    };
    Object.assign(options, this.options.ticks.format);
    return formatNumber(tickValue, locale2, options);
  },
  logarithmic(tickValue, index2, ticks) {
    if (tickValue === 0) {
      return "0";
    }
    const remain = ticks[index2].significand || tickValue / Math.pow(10, Math.floor(log10(tickValue)));
    if ([
      1,
      2,
      3,
      5,
      10,
      15
    ].includes(remain) || index2 > 0.8 * ticks.length) {
      return formatters.numeric.call(this, tickValue, index2, ticks);
    }
    return "";
  }
};
function calculateDelta(tickValue, ticks) {
  let delta = ticks.length > 3 ? ticks[2].value - ticks[1].value : ticks[1].value - ticks[0].value;
  if (Math.abs(delta) >= 1 && tickValue !== Math.floor(tickValue)) {
    delta = tickValue - Math.floor(tickValue);
  }
  return delta;
}
var Ticks = {
  formatters
};
function applyScaleDefaults(defaults2) {
  defaults2.set("scale", {
    display: true,
    offset: false,
    reverse: false,
    beginAtZero: false,
    bounds: "ticks",
    clip: true,
    grace: 0,
    grid: {
      display: true,
      lineWidth: 1,
      drawOnChartArea: true,
      drawTicks: true,
      tickLength: 8,
      tickWidth: (_ctx, options) => options.lineWidth,
      tickColor: (_ctx, options) => options.color,
      offset: false
    },
    border: {
      display: true,
      dash: [],
      dashOffset: 0,
      width: 1
    },
    title: {
      display: false,
      text: "",
      padding: {
        top: 4,
        bottom: 4
      }
    },
    ticks: {
      minRotation: 0,
      maxRotation: 50,
      mirror: false,
      textStrokeWidth: 0,
      textStrokeColor: "",
      padding: 3,
      display: true,
      autoSkip: true,
      autoSkipPadding: 3,
      labelOffset: 0,
      callback: Ticks.formatters.values,
      minor: {},
      major: {},
      align: "center",
      crossAlign: "near",
      showLabelBackdrop: false,
      backdropColor: "rgba(255, 255, 255, 0.75)",
      backdropPadding: 2
    }
  });
  defaults2.route("scale.ticks", "color", "", "color");
  defaults2.route("scale.grid", "color", "", "borderColor");
  defaults2.route("scale.border", "color", "", "borderColor");
  defaults2.route("scale.title", "color", "", "color");
  defaults2.describe("scale", {
    _fallback: false,
    _scriptable: (name) => !name.startsWith("before") && !name.startsWith("after") && name !== "callback" && name !== "parser",
    _indexable: (name) => name !== "borderDash" && name !== "tickBorderDash" && name !== "dash"
  });
  defaults2.describe("scales", {
    _fallback: "scale"
  });
  defaults2.describe("scale.ticks", {
    _scriptable: (name) => name !== "backdropPadding" && name !== "callback",
    _indexable: (name) => name !== "backdropPadding"
  });
}
const overrides = /* @__PURE__ */ Object.create(null);
const descriptors = /* @__PURE__ */ Object.create(null);
function getScope$1(node, key) {
  if (!key) {
    return node;
  }
  const keys2 = key.split(".");
  for (let i = 0, n2 = keys2.length; i < n2; ++i) {
    const k2 = keys2[i];
    node = node[k2] || (node[k2] = /* @__PURE__ */ Object.create(null));
  }
  return node;
}
function set$2(root, scope, values2) {
  if (typeof scope === "string") {
    return merge(getScope$1(root, scope), values2);
  }
  return merge(getScope$1(root, ""), scope);
}
class Defaults {
  constructor(_descriptors2, _appliers) {
    this.animation = void 0;
    this.backgroundColor = "rgba(0,0,0,0.1)";
    this.borderColor = "rgba(0,0,0,0.1)";
    this.color = "#666";
    this.datasets = {};
    this.devicePixelRatio = (context) => context.chart.platform.getDevicePixelRatio();
    this.elements = {};
    this.events = [
      "mousemove",
      "mouseout",
      "click",
      "touchstart",
      "touchmove"
    ];
    this.font = {
      family: "'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",
      size: 12,
      style: "normal",
      lineHeight: 1.2,
      weight: null
    };
    this.hover = {};
    this.hoverBackgroundColor = (ctx, options) => getHoverColor(options.backgroundColor);
    this.hoverBorderColor = (ctx, options) => getHoverColor(options.borderColor);
    this.hoverColor = (ctx, options) => getHoverColor(options.color);
    this.indexAxis = "x";
    this.interaction = {
      mode: "nearest",
      intersect: true,
      includeInvisible: false
    };
    this.maintainAspectRatio = true;
    this.onHover = null;
    this.onClick = null;
    this.parsing = true;
    this.plugins = {};
    this.responsive = true;
    this.scale = void 0;
    this.scales = {};
    this.showLine = true;
    this.drawActiveElementsOnTop = true;
    this.describe(_descriptors2);
    this.apply(_appliers);
  }
  set(scope, values2) {
    return set$2(this, scope, values2);
  }
  get(scope) {
    return getScope$1(this, scope);
  }
  describe(scope, values2) {
    return set$2(descriptors, scope, values2);
  }
  override(scope, values2) {
    return set$2(overrides, scope, values2);
  }
  route(scope, name, targetScope, targetName) {
    const scopeObject = getScope$1(this, scope);
    const targetScopeObject = getScope$1(this, targetScope);
    const privateName = "_" + name;
    Object.defineProperties(scopeObject, {
      [privateName]: {
        value: scopeObject[name],
        writable: true
      },
      [name]: {
        enumerable: true,
        get() {
          const local = this[privateName];
          const target = targetScopeObject[targetName];
          if (isObject$1(local)) {
            return Object.assign({}, target, local);
          }
          return valueOrDefault(local, target);
        },
        set(value) {
          this[privateName] = value;
        }
      }
    });
  }
  apply(appliers) {
    appliers.forEach((apply) => apply(this));
  }
}
var defaults$1 = /* @__PURE__ */ new Defaults({
  _scriptable: (name) => !name.startsWith("on"),
  _indexable: (name) => name !== "events",
  hover: {
    _fallback: "interaction"
  },
  interaction: {
    _scriptable: false,
    _indexable: false
  }
}, [
  applyAnimationsDefaults,
  applyLayoutsDefaults,
  applyScaleDefaults
]);
function toFontString(font) {
  if (!font || isNullOrUndef(font.size) || isNullOrUndef(font.family)) {
    return null;
  }
  return (font.style ? font.style + " " : "") + (font.weight ? font.weight + " " : "") + font.size + "px " + font.family;
}
function _measureText(ctx, data, gc2, longest, string) {
  let textWidth = data[string];
  if (!textWidth) {
    textWidth = data[string] = ctx.measureText(string).width;
    gc2.push(string);
  }
  if (textWidth > longest) {
    longest = textWidth;
  }
  return longest;
}
function _longestText(ctx, font, arrayOfThings, cache) {
  cache = cache || {};
  let data = cache.data = cache.data || {};
  let gc2 = cache.garbageCollect = cache.garbageCollect || [];
  if (cache.font !== font) {
    data = cache.data = {};
    gc2 = cache.garbageCollect = [];
    cache.font = font;
  }
  ctx.save();
  ctx.font = font;
  let longest = 0;
  const ilen = arrayOfThings.length;
  let i, j, jlen, thing, nestedThing;
  for (i = 0; i < ilen; i++) {
    thing = arrayOfThings[i];
    if (thing !== void 0 && thing !== null && !isArray$1(thing)) {
      longest = _measureText(ctx, data, gc2, longest, thing);
    } else if (isArray$1(thing)) {
      for (j = 0, jlen = thing.length; j < jlen; j++) {
        nestedThing = thing[j];
        if (nestedThing !== void 0 && nestedThing !== null && !isArray$1(nestedThing)) {
          longest = _measureText(ctx, data, gc2, longest, nestedThing);
        }
      }
    }
  }
  ctx.restore();
  const gcLen = gc2.length / 2;
  if (gcLen > arrayOfThings.length) {
    for (i = 0; i < gcLen; i++) {
      delete data[gc2[i]];
    }
    gc2.splice(0, gcLen);
  }
  return longest;
}
function _alignPixel(chart, pixel, width) {
  const devicePixelRatio = chart.currentDevicePixelRatio;
  const halfWidth = width !== 0 ? Math.max(width / 2, 0.5) : 0;
  return Math.round((pixel - halfWidth) * devicePixelRatio) / devicePixelRatio + halfWidth;
}
function clearCanvas(canvas, ctx) {
  ctx = ctx || canvas.getContext("2d");
  ctx.save();
  ctx.resetTransform();
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.restore();
}
function drawPoint(ctx, options, x2, y2) {
  drawPointLegend(ctx, options, x2, y2, null);
}
function drawPointLegend(ctx, options, x2, y2, w2) {
  let type, xOffset, yOffset, size, cornerRadius, width, xOffsetW, yOffsetW;
  const style2 = options.pointStyle;
  const rotation = options.rotation;
  const radius = options.radius;
  let rad = (rotation || 0) * RAD_PER_DEG;
  if (style2 && typeof style2 === "object") {
    type = style2.toString();
    if (type === "[object HTMLImageElement]" || type === "[object HTMLCanvasElement]") {
      ctx.save();
      ctx.translate(x2, y2);
      ctx.rotate(rad);
      ctx.drawImage(style2, -style2.width / 2, -style2.height / 2, style2.width, style2.height);
      ctx.restore();
      return;
    }
  }
  if (isNaN(radius) || radius <= 0) {
    return;
  }
  ctx.beginPath();
  switch (style2) {
    default:
      if (w2) {
        ctx.ellipse(x2, y2, w2 / 2, radius, 0, 0, TAU);
      } else {
        ctx.arc(x2, y2, radius, 0, TAU);
      }
      ctx.closePath();
      break;
    case "triangle":
      width = w2 ? w2 / 2 : radius;
      ctx.moveTo(x2 + Math.sin(rad) * width, y2 - Math.cos(rad) * radius);
      rad += TWO_THIRDS_PI;
      ctx.lineTo(x2 + Math.sin(rad) * width, y2 - Math.cos(rad) * radius);
      rad += TWO_THIRDS_PI;
      ctx.lineTo(x2 + Math.sin(rad) * width, y2 - Math.cos(rad) * radius);
      ctx.closePath();
      break;
    case "rectRounded":
      cornerRadius = radius * 0.516;
      size = radius - cornerRadius;
      xOffset = Math.cos(rad + QUARTER_PI) * size;
      xOffsetW = Math.cos(rad + QUARTER_PI) * (w2 ? w2 / 2 - cornerRadius : size);
      yOffset = Math.sin(rad + QUARTER_PI) * size;
      yOffsetW = Math.sin(rad + QUARTER_PI) * (w2 ? w2 / 2 - cornerRadius : size);
      ctx.arc(x2 - xOffsetW, y2 - yOffset, cornerRadius, rad - PI, rad - HALF_PI);
      ctx.arc(x2 + yOffsetW, y2 - xOffset, cornerRadius, rad - HALF_PI, rad);
      ctx.arc(x2 + xOffsetW, y2 + yOffset, cornerRadius, rad, rad + HALF_PI);
      ctx.arc(x2 - yOffsetW, y2 + xOffset, cornerRadius, rad + HALF_PI, rad + PI);
      ctx.closePath();
      break;
    case "rect":
      if (!rotation) {
        size = Math.SQRT1_2 * radius;
        width = w2 ? w2 / 2 : size;
        ctx.rect(x2 - width, y2 - size, 2 * width, 2 * size);
        break;
      }
      rad += QUARTER_PI;
    case "rectRot":
      xOffsetW = Math.cos(rad) * (w2 ? w2 / 2 : radius);
      xOffset = Math.cos(rad) * radius;
      yOffset = Math.sin(rad) * radius;
      yOffsetW = Math.sin(rad) * (w2 ? w2 / 2 : radius);
      ctx.moveTo(x2 - xOffsetW, y2 - yOffset);
      ctx.lineTo(x2 + yOffsetW, y2 - xOffset);
      ctx.lineTo(x2 + xOffsetW, y2 + yOffset);
      ctx.lineTo(x2 - yOffsetW, y2 + xOffset);
      ctx.closePath();
      break;
    case "crossRot":
      rad += QUARTER_PI;
    case "cross":
      xOffsetW = Math.cos(rad) * (w2 ? w2 / 2 : radius);
      xOffset = Math.cos(rad) * radius;
      yOffset = Math.sin(rad) * radius;
      yOffsetW = Math.sin(rad) * (w2 ? w2 / 2 : radius);
      ctx.moveTo(x2 - xOffsetW, y2 - yOffset);
      ctx.lineTo(x2 + xOffsetW, y2 + yOffset);
      ctx.moveTo(x2 + yOffsetW, y2 - xOffset);
      ctx.lineTo(x2 - yOffsetW, y2 + xOffset);
      break;
    case "star":
      xOffsetW = Math.cos(rad) * (w2 ? w2 / 2 : radius);
      xOffset = Math.cos(rad) * radius;
      yOffset = Math.sin(rad) * radius;
      yOffsetW = Math.sin(rad) * (w2 ? w2 / 2 : radius);
      ctx.moveTo(x2 - xOffsetW, y2 - yOffset);
      ctx.lineTo(x2 + xOffsetW, y2 + yOffset);
      ctx.moveTo(x2 + yOffsetW, y2 - xOffset);
      ctx.lineTo(x2 - yOffsetW, y2 + xOffset);
      rad += QUARTER_PI;
      xOffsetW = Math.cos(rad) * (w2 ? w2 / 2 : radius);
      xOffset = Math.cos(rad) * radius;
      yOffset = Math.sin(rad) * radius;
      yOffsetW = Math.sin(rad) * (w2 ? w2 / 2 : radius);
      ctx.moveTo(x2 - xOffsetW, y2 - yOffset);
      ctx.lineTo(x2 + xOffsetW, y2 + yOffset);
      ctx.moveTo(x2 + yOffsetW, y2 - xOffset);
      ctx.lineTo(x2 - yOffsetW, y2 + xOffset);
      break;
    case "line":
      xOffset = w2 ? w2 / 2 : Math.cos(rad) * radius;
      yOffset = Math.sin(rad) * radius;
      ctx.moveTo(x2 - xOffset, y2 - yOffset);
      ctx.lineTo(x2 + xOffset, y2 + yOffset);
      break;
    case "dash":
      ctx.moveTo(x2, y2);
      ctx.lineTo(x2 + Math.cos(rad) * (w2 ? w2 / 2 : radius), y2 + Math.sin(rad) * radius);
      break;
    case false:
      ctx.closePath();
      break;
  }
  ctx.fill();
  if (options.borderWidth > 0) {
    ctx.stroke();
  }
}
function _isPointInArea(point, area, margin) {
  margin = margin || 0.5;
  return !area || point && point.x > area.left - margin && point.x < area.right + margin && point.y > area.top - margin && point.y < area.bottom + margin;
}
function clipArea(ctx, area) {
  ctx.save();
  ctx.beginPath();
  ctx.rect(area.left, area.top, area.right - area.left, area.bottom - area.top);
  ctx.clip();
}
function unclipArea(ctx) {
  ctx.restore();
}
function _steppedLineTo(ctx, previous, target, flip, mode) {
  if (!previous) {
    return ctx.lineTo(target.x, target.y);
  }
  if (mode === "middle") {
    const midpoint = (previous.x + target.x) / 2;
    ctx.lineTo(midpoint, previous.y);
    ctx.lineTo(midpoint, target.y);
  } else if (mode === "after" !== !!flip) {
    ctx.lineTo(previous.x, target.y);
  } else {
    ctx.lineTo(target.x, previous.y);
  }
  ctx.lineTo(target.x, target.y);
}
function _bezierCurveTo(ctx, previous, target, flip) {
  if (!previous) {
    return ctx.lineTo(target.x, target.y);
  }
  ctx.bezierCurveTo(flip ? previous.cp1x : previous.cp2x, flip ? previous.cp1y : previous.cp2y, flip ? target.cp2x : target.cp1x, flip ? target.cp2y : target.cp1y, target.x, target.y);
}
function setRenderOpts(ctx, opts) {
  if (opts.translation) {
    ctx.translate(opts.translation[0], opts.translation[1]);
  }
  if (!isNullOrUndef(opts.rotation)) {
    ctx.rotate(opts.rotation);
  }
  if (opts.color) {
    ctx.fillStyle = opts.color;
  }
  if (opts.textAlign) {
    ctx.textAlign = opts.textAlign;
  }
  if (opts.textBaseline) {
    ctx.textBaseline = opts.textBaseline;
  }
}
function decorateText(ctx, x2, y2, line, opts) {
  if (opts.strikethrough || opts.underline) {
    const metrics = ctx.measureText(line);
    const left = x2 - metrics.actualBoundingBoxLeft;
    const right = x2 + metrics.actualBoundingBoxRight;
    const top = y2 - metrics.actualBoundingBoxAscent;
    const bottom = y2 + metrics.actualBoundingBoxDescent;
    const yDecoration = opts.strikethrough ? (top + bottom) / 2 : bottom;
    ctx.strokeStyle = ctx.fillStyle;
    ctx.beginPath();
    ctx.lineWidth = opts.decorationWidth || 2;
    ctx.moveTo(left, yDecoration);
    ctx.lineTo(right, yDecoration);
    ctx.stroke();
  }
}
function drawBackdrop(ctx, opts) {
  const oldColor = ctx.fillStyle;
  ctx.fillStyle = opts.color;
  ctx.fillRect(opts.left, opts.top, opts.width, opts.height);
  ctx.fillStyle = oldColor;
}
function renderText(ctx, text, x2, y2, font, opts = {}) {
  const lines = isArray$1(text) ? text : [
    text
  ];
  const stroke = opts.strokeWidth > 0 && opts.strokeColor !== "";
  let i, line;
  ctx.save();
  ctx.font = font.string;
  setRenderOpts(ctx, opts);
  for (i = 0; i < lines.length; ++i) {
    line = lines[i];
    if (opts.backdrop) {
      drawBackdrop(ctx, opts.backdrop);
    }
    if (stroke) {
      if (opts.strokeColor) {
        ctx.strokeStyle = opts.strokeColor;
      }
      if (!isNullOrUndef(opts.strokeWidth)) {
        ctx.lineWidth = opts.strokeWidth;
      }
      ctx.strokeText(line, x2, y2, opts.maxWidth);
    }
    ctx.fillText(line, x2, y2, opts.maxWidth);
    decorateText(ctx, x2, y2, line, opts);
    y2 += Number(font.lineHeight);
  }
  ctx.restore();
}
function addRoundedRectPath(ctx, rect) {
  const { x: x2, y: y2, w: w2, h, radius } = rect;
  ctx.arc(x2 + radius.topLeft, y2 + radius.topLeft, radius.topLeft, 1.5 * PI, PI, true);
  ctx.lineTo(x2, y2 + h - radius.bottomLeft);
  ctx.arc(x2 + radius.bottomLeft, y2 + h - radius.bottomLeft, radius.bottomLeft, PI, HALF_PI, true);
  ctx.lineTo(x2 + w2 - radius.bottomRight, y2 + h);
  ctx.arc(x2 + w2 - radius.bottomRight, y2 + h - radius.bottomRight, radius.bottomRight, HALF_PI, 0, true);
  ctx.lineTo(x2 + w2, y2 + radius.topRight);
  ctx.arc(x2 + w2 - radius.topRight, y2 + radius.topRight, radius.topRight, 0, -HALF_PI, true);
  ctx.lineTo(x2 + radius.topLeft, y2);
}
const LINE_HEIGHT = /^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/;
const FONT_STYLE = /^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;
function toLineHeight(value, size) {
  const matches = ("" + value).match(LINE_HEIGHT);
  if (!matches || matches[1] === "normal") {
    return size * 1.2;
  }
  value = +matches[2];
  switch (matches[3]) {
    case "px":
      return value;
    case "%":
      value /= 100;
      break;
  }
  return size * value;
}
const numberOrZero = (v2) => +v2 || 0;
function _readValueToProps(value, props) {
  const ret = {};
  const objProps = isObject$1(props);
  const keys2 = objProps ? Object.keys(props) : props;
  const read = isObject$1(value) ? objProps ? (prop) => valueOrDefault(value[prop], value[props[prop]]) : (prop) => value[prop] : () => value;
  for (const prop of keys2) {
    ret[prop] = numberOrZero(read(prop));
  }
  return ret;
}
function toTRBL(value) {
  return _readValueToProps(value, {
    top: "y",
    right: "x",
    bottom: "y",
    left: "x"
  });
}
function toTRBLCorners(value) {
  return _readValueToProps(value, [
    "topLeft",
    "topRight",
    "bottomLeft",
    "bottomRight"
  ]);
}
function toPadding(value) {
  const obj = toTRBL(value);
  obj.width = obj.left + obj.right;
  obj.height = obj.top + obj.bottom;
  return obj;
}
function toFont(options, fallback) {
  options = options || {};
  fallback = fallback || defaults$1.font;
  let size = valueOrDefault(options.size, fallback.size);
  if (typeof size === "string") {
    size = parseInt(size, 10);
  }
  let style2 = valueOrDefault(options.style, fallback.style);
  if (style2 && !("" + style2).match(FONT_STYLE)) {
    console.warn('Invalid font style specified: "' + style2 + '"');
    style2 = void 0;
  }
  const font = {
    family: valueOrDefault(options.family, fallback.family),
    lineHeight: toLineHeight(valueOrDefault(options.lineHeight, fallback.lineHeight), size),
    size,
    style: style2,
    weight: valueOrDefault(options.weight, fallback.weight),
    string: ""
  };
  font.string = toFontString(font);
  return font;
}
function resolve(inputs, context, index2, info) {
  let cacheable = true;
  let i, ilen, value;
  for (i = 0, ilen = inputs.length; i < ilen; ++i) {
    value = inputs[i];
    if (value === void 0) {
      continue;
    }
    if (context !== void 0 && typeof value === "function") {
      value = value(context);
      cacheable = false;
    }
    if (index2 !== void 0 && isArray$1(value)) {
      value = value[index2 % value.length];
      cacheable = false;
    }
    if (value !== void 0) {
      if (info && !cacheable) {
        info.cacheable = false;
      }
      return value;
    }
  }
}
function _addGrace(minmax, grace, beginAtZero) {
  const { min: min2, max: max2 } = minmax;
  const change = toDimension(grace, (max2 - min2) / 2);
  const keepZero = (value, add2) => beginAtZero && value === 0 ? 0 : value + add2;
  return {
    min: keepZero(min2, -Math.abs(change)),
    max: keepZero(max2, change)
  };
}
function createContext(parentContext, context) {
  return Object.assign(Object.create(parentContext), context);
}
function _createResolver(scopes, prefixes = [
  ""
], rootScopes, fallback, getTarget = () => scopes[0]) {
  const finalRootScopes = rootScopes || scopes;
  if (typeof fallback === "undefined") {
    fallback = _resolve("_fallback", scopes);
  }
  const cache = {
    [Symbol.toStringTag]: "Object",
    _cacheable: true,
    _scopes: scopes,
    _rootScopes: finalRootScopes,
    _fallback: fallback,
    _getTarget: getTarget,
    override: (scope) => _createResolver([
      scope,
      ...scopes
    ], prefixes, finalRootScopes, fallback)
  };
  return new Proxy(cache, {
    /**
    * A trap for the delete operator.
    */
    deleteProperty(target, prop) {
      delete target[prop];
      delete target._keys;
      delete scopes[0][prop];
      return true;
    },
    /**
    * A trap for getting property values.
    */
    get(target, prop) {
      return _cached(target, prop, () => _resolveWithPrefixes(prop, prefixes, scopes, target));
    },
    /**
    * A trap for Object.getOwnPropertyDescriptor.
    * Also used by Object.hasOwnProperty.
    */
    getOwnPropertyDescriptor(target, prop) {
      return Reflect.getOwnPropertyDescriptor(target._scopes[0], prop);
    },
    /**
    * A trap for Object.getPrototypeOf.
    */
    getPrototypeOf() {
      return Reflect.getPrototypeOf(scopes[0]);
    },
    /**
    * A trap for the in operator.
    */
    has(target, prop) {
      return getKeysFromAllScopes(target).includes(prop);
    },
    /**
    * A trap for Object.getOwnPropertyNames and Object.getOwnPropertySymbols.
    */
    ownKeys(target) {
      return getKeysFromAllScopes(target);
    },
    /**
    * A trap for setting property values.
    */
    set(target, prop, value) {
      const storage = target._storage || (target._storage = getTarget());
      target[prop] = storage[prop] = value;
      delete target._keys;
      return true;
    }
  });
}
function _attachContext(proxy, context, subProxy, descriptorDefaults) {
  const cache = {
    _cacheable: false,
    _proxy: proxy,
    _context: context,
    _subProxy: subProxy,
    _stack: /* @__PURE__ */ new Set(),
    _descriptors: _descriptors(proxy, descriptorDefaults),
    setContext: (ctx) => _attachContext(proxy, ctx, subProxy, descriptorDefaults),
    override: (scope) => _attachContext(proxy.override(scope), context, subProxy, descriptorDefaults)
  };
  return new Proxy(cache, {
    /**
    * A trap for the delete operator.
    */
    deleteProperty(target, prop) {
      delete target[prop];
      delete proxy[prop];
      return true;
    },
    /**
    * A trap for getting property values.
    */
    get(target, prop, receiver) {
      return _cached(target, prop, () => _resolveWithContext(target, prop, receiver));
    },
    /**
    * A trap for Object.getOwnPropertyDescriptor.
    * Also used by Object.hasOwnProperty.
    */
    getOwnPropertyDescriptor(target, prop) {
      return target._descriptors.allKeys ? Reflect.has(proxy, prop) ? {
        enumerable: true,
        configurable: true
      } : void 0 : Reflect.getOwnPropertyDescriptor(proxy, prop);
    },
    /**
    * A trap for Object.getPrototypeOf.
    */
    getPrototypeOf() {
      return Reflect.getPrototypeOf(proxy);
    },
    /**
    * A trap for the in operator.
    */
    has(target, prop) {
      return Reflect.has(proxy, prop);
    },
    /**
    * A trap for Object.getOwnPropertyNames and Object.getOwnPropertySymbols.
    */
    ownKeys() {
      return Reflect.ownKeys(proxy);
    },
    /**
    * A trap for setting property values.
    */
    set(target, prop, value) {
      proxy[prop] = value;
      delete target[prop];
      return true;
    }
  });
}
function _descriptors(proxy, defaults2 = {
  scriptable: true,
  indexable: true
}) {
  const { _scriptable = defaults2.scriptable, _indexable = defaults2.indexable, _allKeys = defaults2.allKeys } = proxy;
  return {
    allKeys: _allKeys,
    scriptable: _scriptable,
    indexable: _indexable,
    isScriptable: isFunction$1(_scriptable) ? _scriptable : () => _scriptable,
    isIndexable: isFunction$1(_indexable) ? _indexable : () => _indexable
  };
}
const readKey = (prefix, name) => prefix ? prefix + _capitalize(name) : name;
const needsSubResolver = (prop, value) => isObject$1(value) && prop !== "adapters" && (Object.getPrototypeOf(value) === null || value.constructor === Object);
function _cached(target, prop, resolve2) {
  if (Object.prototype.hasOwnProperty.call(target, prop)) {
    return target[prop];
  }
  const value = resolve2();
  target[prop] = value;
  return value;
}
function _resolveWithContext(target, prop, receiver) {
  const { _proxy, _context, _subProxy, _descriptors: descriptors2 } = target;
  let value = _proxy[prop];
  if (isFunction$1(value) && descriptors2.isScriptable(prop)) {
    value = _resolveScriptable(prop, value, target, receiver);
  }
  if (isArray$1(value) && value.length) {
    value = _resolveArray(prop, value, target, descriptors2.isIndexable);
  }
  if (needsSubResolver(prop, value)) {
    value = _attachContext(value, _context, _subProxy && _subProxy[prop], descriptors2);
  }
  return value;
}
function _resolveScriptable(prop, getValue, target, receiver) {
  const { _proxy, _context, _subProxy, _stack } = target;
  if (_stack.has(prop)) {
    throw new Error("Recursion detected: " + Array.from(_stack).join("->") + "->" + prop);
  }
  _stack.add(prop);
  let value = getValue(_context, _subProxy || receiver);
  _stack.delete(prop);
  if (needsSubResolver(prop, value)) {
    value = createSubResolver(_proxy._scopes, _proxy, prop, value);
  }
  return value;
}
function _resolveArray(prop, value, target, isIndexable) {
  const { _proxy, _context, _subProxy, _descriptors: descriptors2 } = target;
  if (typeof _context.index !== "undefined" && isIndexable(prop)) {
    return value[_context.index % value.length];
  } else if (isObject$1(value[0])) {
    const arr = value;
    const scopes = _proxy._scopes.filter((s2) => s2 !== arr);
    value = [];
    for (const item of arr) {
      const resolver = createSubResolver(scopes, _proxy, prop, item);
      value.push(_attachContext(resolver, _context, _subProxy && _subProxy[prop], descriptors2));
    }
  }
  return value;
}
function resolveFallback(fallback, prop, value) {
  return isFunction$1(fallback) ? fallback(prop, value) : fallback;
}
const getScope = (key, parent) => key === true ? parent : typeof key === "string" ? resolveObjectKey(parent, key) : void 0;
function addScopes(set2, parentScopes, key, parentFallback, value) {
  for (const parent of parentScopes) {
    const scope = getScope(key, parent);
    if (scope) {
      set2.add(scope);
      const fallback = resolveFallback(scope._fallback, key, value);
      if (typeof fallback !== "undefined" && fallback !== key && fallback !== parentFallback) {
        return fallback;
      }
    } else if (scope === false && typeof parentFallback !== "undefined" && key !== parentFallback) {
      return null;
    }
  }
  return false;
}
function createSubResolver(parentScopes, resolver, prop, value) {
  const rootScopes = resolver._rootScopes;
  const fallback = resolveFallback(resolver._fallback, prop, value);
  const allScopes = [
    ...parentScopes,
    ...rootScopes
  ];
  const set2 = /* @__PURE__ */ new Set();
  set2.add(value);
  let key = addScopesFromKey(set2, allScopes, prop, fallback || prop, value);
  if (key === null) {
    return false;
  }
  if (typeof fallback !== "undefined" && fallback !== prop) {
    key = addScopesFromKey(set2, allScopes, fallback, key, value);
    if (key === null) {
      return false;
    }
  }
  return _createResolver(Array.from(set2), [
    ""
  ], rootScopes, fallback, () => subGetTarget(resolver, prop, value));
}
function addScopesFromKey(set2, allScopes, key, fallback, item) {
  while (key) {
    key = addScopes(set2, allScopes, key, fallback, item);
  }
  return key;
}
function subGetTarget(resolver, prop, value) {
  const parent = resolver._getTarget();
  if (!(prop in parent)) {
    parent[prop] = {};
  }
  const target = parent[prop];
  if (isArray$1(target) && isObject$1(value)) {
    return value;
  }
  return target || {};
}
function _resolveWithPrefixes(prop, prefixes, scopes, proxy) {
  let value;
  for (const prefix of prefixes) {
    value = _resolve(readKey(prefix, prop), scopes);
    if (typeof value !== "undefined") {
      return needsSubResolver(prop, value) ? createSubResolver(scopes, proxy, prop, value) : value;
    }
  }
}
function _resolve(key, scopes) {
  for (const scope of scopes) {
    if (!scope) {
      continue;
    }
    const value = scope[key];
    if (typeof value !== "undefined") {
      return value;
    }
  }
}
function getKeysFromAllScopes(target) {
  let keys2 = target._keys;
  if (!keys2) {
    keys2 = target._keys = resolveKeysFromAllScopes(target._scopes);
  }
  return keys2;
}
function resolveKeysFromAllScopes(scopes) {
  const set2 = /* @__PURE__ */ new Set();
  for (const scope of scopes) {
    for (const key of Object.keys(scope).filter((k2) => !k2.startsWith("_"))) {
      set2.add(key);
    }
  }
  return Array.from(set2);
}
function _parseObjectDataRadialScale(meta, data, start, count) {
  const { iScale } = meta;
  const { key = "r" } = this._parsing;
  const parsed = new Array(count);
  let i, ilen, index2, item;
  for (i = 0, ilen = count; i < ilen; ++i) {
    index2 = i + start;
    item = data[index2];
    parsed[i] = {
      r: iScale.parse(resolveObjectKey(item, key), index2)
    };
  }
  return parsed;
}
const EPSILON = Number.EPSILON || 1e-14;
const getPoint = (points, i) => i < points.length && !points[i].skip && points[i];
const getValueAxis = (indexAxis) => indexAxis === "x" ? "y" : "x";
function splineCurve(firstPoint, middlePoint, afterPoint, t2) {
  const previous = firstPoint.skip ? middlePoint : firstPoint;
  const current = middlePoint;
  const next = afterPoint.skip ? middlePoint : afterPoint;
  const d01 = distanceBetweenPoints(current, previous);
  const d12 = distanceBetweenPoints(next, current);
  let s01 = d01 / (d01 + d12);
  let s12 = d12 / (d01 + d12);
  s01 = isNaN(s01) ? 0 : s01;
  s12 = isNaN(s12) ? 0 : s12;
  const fa2 = t2 * s01;
  const fb2 = t2 * s12;
  return {
    previous: {
      x: current.x - fa2 * (next.x - previous.x),
      y: current.y - fa2 * (next.y - previous.y)
    },
    next: {
      x: current.x + fb2 * (next.x - previous.x),
      y: current.y + fb2 * (next.y - previous.y)
    }
  };
}
function monotoneAdjust(points, deltaK, mK) {
  const pointsLen = points.length;
  let alphaK, betaK, tauK, squaredMagnitude, pointCurrent;
  let pointAfter = getPoint(points, 0);
  for (let i = 0; i < pointsLen - 1; ++i) {
    pointCurrent = pointAfter;
    pointAfter = getPoint(points, i + 1);
    if (!pointCurrent || !pointAfter) {
      continue;
    }
    if (almostEquals(deltaK[i], 0, EPSILON)) {
      mK[i] = mK[i + 1] = 0;
      continue;
    }
    alphaK = mK[i] / deltaK[i];
    betaK = mK[i + 1] / deltaK[i];
    squaredMagnitude = Math.pow(alphaK, 2) + Math.pow(betaK, 2);
    if (squaredMagnitude <= 9) {
      continue;
    }
    tauK = 3 / Math.sqrt(squaredMagnitude);
    mK[i] = alphaK * tauK * deltaK[i];
    mK[i + 1] = betaK * tauK * deltaK[i];
  }
}
function monotoneCompute(points, mK, indexAxis = "x") {
  const valueAxis = getValueAxis(indexAxis);
  const pointsLen = points.length;
  let delta, pointBefore, pointCurrent;
  let pointAfter = getPoint(points, 0);
  for (let i = 0; i < pointsLen; ++i) {
    pointBefore = pointCurrent;
    pointCurrent = pointAfter;
    pointAfter = getPoint(points, i + 1);
    if (!pointCurrent) {
      continue;
    }
    const iPixel = pointCurrent[indexAxis];
    const vPixel = pointCurrent[valueAxis];
    if (pointBefore) {
      delta = (iPixel - pointBefore[indexAxis]) / 3;
      pointCurrent[`cp1${indexAxis}`] = iPixel - delta;
      pointCurrent[`cp1${valueAxis}`] = vPixel - delta * mK[i];
    }
    if (pointAfter) {
      delta = (pointAfter[indexAxis] - iPixel) / 3;
      pointCurrent[`cp2${indexAxis}`] = iPixel + delta;
      pointCurrent[`cp2${valueAxis}`] = vPixel + delta * mK[i];
    }
  }
}
function splineCurveMonotone(points, indexAxis = "x") {
  const valueAxis = getValueAxis(indexAxis);
  const pointsLen = points.length;
  const deltaK = Array(pointsLen).fill(0);
  const mK = Array(pointsLen);
  let i, pointBefore, pointCurrent;
  let pointAfter = getPoint(points, 0);
  for (i = 0; i < pointsLen; ++i) {
    pointBefore = pointCurrent;
    pointCurrent = pointAfter;
    pointAfter = getPoint(points, i + 1);
    if (!pointCurrent) {
      continue;
    }
    if (pointAfter) {
      const slopeDelta = pointAfter[indexAxis] - pointCurrent[indexAxis];
      deltaK[i] = slopeDelta !== 0 ? (pointAfter[valueAxis] - pointCurrent[valueAxis]) / slopeDelta : 0;
    }
    mK[i] = !pointBefore ? deltaK[i] : !pointAfter ? deltaK[i - 1] : sign$1(deltaK[i - 1]) !== sign$1(deltaK[i]) ? 0 : (deltaK[i - 1] + deltaK[i]) / 2;
  }
  monotoneAdjust(points, deltaK, mK);
  monotoneCompute(points, mK, indexAxis);
}
function capControlPoint(pt, min2, max2) {
  return Math.max(Math.min(pt, max2), min2);
}
function capBezierPoints(points, area) {
  let i, ilen, point, inArea, inAreaPrev;
  let inAreaNext = _isPointInArea(points[0], area);
  for (i = 0, ilen = points.length; i < ilen; ++i) {
    inAreaPrev = inArea;
    inArea = inAreaNext;
    inAreaNext = i < ilen - 1 && _isPointInArea(points[i + 1], area);
    if (!inArea) {
      continue;
    }
    point = points[i];
    if (inAreaPrev) {
      point.cp1x = capControlPoint(point.cp1x, area.left, area.right);
      point.cp1y = capControlPoint(point.cp1y, area.top, area.bottom);
    }
    if (inAreaNext) {
      point.cp2x = capControlPoint(point.cp2x, area.left, area.right);
      point.cp2y = capControlPoint(point.cp2y, area.top, area.bottom);
    }
  }
}
function _updateBezierControlPoints(points, options, area, loop, indexAxis) {
  let i, ilen, point, controlPoints;
  if (options.spanGaps) {
    points = points.filter((pt) => !pt.skip);
  }
  if (options.cubicInterpolationMode === "monotone") {
    splineCurveMonotone(points, indexAxis);
  } else {
    let prev = loop ? points[points.length - 1] : points[0];
    for (i = 0, ilen = points.length; i < ilen; ++i) {
      point = points[i];
      controlPoints = splineCurve(prev, point, points[Math.min(i + 1, ilen - (loop ? 0 : 1)) % ilen], options.tension);
      point.cp1x = controlPoints.previous.x;
      point.cp1y = controlPoints.previous.y;
      point.cp2x = controlPoints.next.x;
      point.cp2y = controlPoints.next.y;
      prev = point;
    }
  }
  if (options.capBezierPoints) {
    capBezierPoints(points, area);
  }
}
function _isDomSupported() {
  return typeof window !== "undefined" && typeof document !== "undefined";
}
function _getParentNode(domNode) {
  let parent = domNode.parentNode;
  if (parent && parent.toString() === "[object ShadowRoot]") {
    parent = parent.host;
  }
  return parent;
}
function parseMaxStyle(styleValue, node, parentProperty) {
  let valueInPixels;
  if (typeof styleValue === "string") {
    valueInPixels = parseInt(styleValue, 10);
    if (styleValue.indexOf("%") !== -1) {
      valueInPixels = valueInPixels / 100 * node.parentNode[parentProperty];
    }
  } else {
    valueInPixels = styleValue;
  }
  return valueInPixels;
}
const getComputedStyle$1 = (element) => element.ownerDocument.defaultView.getComputedStyle(element, null);
function getStyle(el2, property) {
  return getComputedStyle$1(el2).getPropertyValue(property);
}
const positions = [
  "top",
  "right",
  "bottom",
  "left"
];
function getPositionedStyle(styles, style2, suffix) {
  const result = {};
  suffix = suffix ? "-" + suffix : "";
  for (let i = 0; i < 4; i++) {
    const pos = positions[i];
    result[pos] = parseFloat(styles[style2 + "-" + pos + suffix]) || 0;
  }
  result.width = result.left + result.right;
  result.height = result.top + result.bottom;
  return result;
}
const useOffsetPos = (x2, y2, target) => (x2 > 0 || y2 > 0) && (!target || !target.shadowRoot);
function getCanvasPosition(e, canvas) {
  const touches = e.touches;
  const source = touches && touches.length ? touches[0] : e;
  const { offsetX, offsetY } = source;
  let box = false;
  let x2, y2;
  if (useOffsetPos(offsetX, offsetY, e.target)) {
    x2 = offsetX;
    y2 = offsetY;
  } else {
    const rect = canvas.getBoundingClientRect();
    x2 = source.clientX - rect.left;
    y2 = source.clientY - rect.top;
    box = true;
  }
  return {
    x: x2,
    y: y2,
    box
  };
}
function getRelativePosition(event, chart) {
  if ("native" in event) {
    return event;
  }
  const { canvas, currentDevicePixelRatio } = chart;
  const style2 = getComputedStyle$1(canvas);
  const borderBox = style2.boxSizing === "border-box";
  const paddings = getPositionedStyle(style2, "padding");
  const borders = getPositionedStyle(style2, "border", "width");
  const { x: x2, y: y2, box } = getCanvasPosition(event, canvas);
  const xOffset = paddings.left + (box && borders.left);
  const yOffset = paddings.top + (box && borders.top);
  let { width, height } = chart;
  if (borderBox) {
    width -= paddings.width + borders.width;
    height -= paddings.height + borders.height;
  }
  return {
    x: Math.round((x2 - xOffset) / width * canvas.width / currentDevicePixelRatio),
    y: Math.round((y2 - yOffset) / height * canvas.height / currentDevicePixelRatio)
  };
}
function getContainerSize(canvas, width, height) {
  let maxWidth, maxHeight;
  if (width === void 0 || height === void 0) {
    const container = _getParentNode(canvas);
    if (!container) {
      width = canvas.clientWidth;
      height = canvas.clientHeight;
    } else {
      const rect = container.getBoundingClientRect();
      const containerStyle = getComputedStyle$1(container);
      const containerBorder = getPositionedStyle(containerStyle, "border", "width");
      const containerPadding = getPositionedStyle(containerStyle, "padding");
      width = rect.width - containerPadding.width - containerBorder.width;
      height = rect.height - containerPadding.height - containerBorder.height;
      maxWidth = parseMaxStyle(containerStyle.maxWidth, container, "clientWidth");
      maxHeight = parseMaxStyle(containerStyle.maxHeight, container, "clientHeight");
    }
  }
  return {
    width,
    height,
    maxWidth: maxWidth || INFINITY,
    maxHeight: maxHeight || INFINITY
  };
}
const round1 = (v2) => Math.round(v2 * 10) / 10;
function getMaximumSize(canvas, bbWidth, bbHeight, aspectRatio) {
  const style2 = getComputedStyle$1(canvas);
  const margins = getPositionedStyle(style2, "margin");
  const maxWidth = parseMaxStyle(style2.maxWidth, canvas, "clientWidth") || INFINITY;
  const maxHeight = parseMaxStyle(style2.maxHeight, canvas, "clientHeight") || INFINITY;
  const containerSize = getContainerSize(canvas, bbWidth, bbHeight);
  let { width, height } = containerSize;
  if (style2.boxSizing === "content-box") {
    const borders = getPositionedStyle(style2, "border", "width");
    const paddings = getPositionedStyle(style2, "padding");
    width -= paddings.width + borders.width;
    height -= paddings.height + borders.height;
  }
  width = Math.max(0, width - margins.width);
  height = Math.max(0, aspectRatio ? width / aspectRatio : height - margins.height);
  width = round1(Math.min(width, maxWidth, containerSize.maxWidth));
  height = round1(Math.min(height, maxHeight, containerSize.maxHeight));
  if (width && !height) {
    height = round1(width / 2);
  }
  const maintainHeight = bbWidth !== void 0 || bbHeight !== void 0;
  if (maintainHeight && aspectRatio && containerSize.height && height > containerSize.height) {
    height = containerSize.height;
    width = round1(Math.floor(height * aspectRatio));
  }
  return {
    width,
    height
  };
}
function retinaScale(chart, forceRatio, forceStyle) {
  const pixelRatio = forceRatio || 1;
  const deviceHeight = Math.floor(chart.height * pixelRatio);
  const deviceWidth = Math.floor(chart.width * pixelRatio);
  chart.height = Math.floor(chart.height);
  chart.width = Math.floor(chart.width);
  const canvas = chart.canvas;
  if (canvas.style && (forceStyle || !canvas.style.height && !canvas.style.width)) {
    canvas.style.height = `${chart.height}px`;
    canvas.style.width = `${chart.width}px`;
  }
  if (chart.currentDevicePixelRatio !== pixelRatio || canvas.height !== deviceHeight || canvas.width !== deviceWidth) {
    chart.currentDevicePixelRatio = pixelRatio;
    canvas.height = deviceHeight;
    canvas.width = deviceWidth;
    chart.ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);
    return true;
  }
  return false;
}
const supportsEventListenerOptions = function() {
  let passiveSupported = false;
  try {
    const options = {
      get passive() {
        passiveSupported = true;
        return false;
      }
    };
    window.addEventListener("test", null, options);
    window.removeEventListener("test", null, options);
  } catch (e) {
  }
  return passiveSupported;
}();
function readUsedSize(element, property) {
  const value = getStyle(element, property);
  const matches = value && value.match(/^(\d+)(\.\d+)?px$/);
  return matches ? +matches[1] : void 0;
}
function _pointInLine(p1, p2, t2, mode) {
  return {
    x: p1.x + t2 * (p2.x - p1.x),
    y: p1.y + t2 * (p2.y - p1.y)
  };
}
function _steppedInterpolation(p1, p2, t2, mode) {
  return {
    x: p1.x + t2 * (p2.x - p1.x),
    y: mode === "middle" ? t2 < 0.5 ? p1.y : p2.y : mode === "after" ? t2 < 1 ? p1.y : p2.y : t2 > 0 ? p2.y : p1.y
  };
}
function _bezierInterpolation(p1, p2, t2, mode) {
  const cp1 = {
    x: p1.cp2x,
    y: p1.cp2y
  };
  const cp2 = {
    x: p2.cp1x,
    y: p2.cp1y
  };
  const a = _pointInLine(p1, cp1, t2);
  const b = _pointInLine(cp1, cp2, t2);
  const c = _pointInLine(cp2, p2, t2);
  const d = _pointInLine(a, b, t2);
  const e = _pointInLine(b, c, t2);
  return _pointInLine(d, e, t2);
}
const getRightToLeftAdapter = function(rectX, width) {
  return {
    x(x2) {
      return rectX + rectX + width - x2;
    },
    setWidth(w2) {
      width = w2;
    },
    textAlign(align) {
      if (align === "center") {
        return align;
      }
      return align === "right" ? "left" : "right";
    },
    xPlus(x2, value) {
      return x2 - value;
    },
    leftForLtr(x2, itemWidth) {
      return x2 - itemWidth;
    }
  };
};
const getLeftToRightAdapter = function() {
  return {
    x(x2) {
      return x2;
    },
    setWidth(w2) {
    },
    textAlign(align) {
      return align;
    },
    xPlus(x2, value) {
      return x2 + value;
    },
    leftForLtr(x2, _itemWidth) {
      return x2;
    }
  };
};
function getRtlAdapter(rtl, rectX, width) {
  return rtl ? getRightToLeftAdapter(rectX, width) : getLeftToRightAdapter();
}
function overrideTextDirection(ctx, direction) {
  let style2, original;
  if (direction === "ltr" || direction === "rtl") {
    style2 = ctx.canvas.style;
    original = [
      style2.getPropertyValue("direction"),
      style2.getPropertyPriority("direction")
    ];
    style2.setProperty("direction", direction, "important");
    ctx.prevTextDirection = original;
  }
}
function restoreTextDirection(ctx, original) {
  if (original !== void 0) {
    delete ctx.prevTextDirection;
    ctx.canvas.style.setProperty("direction", original[0], original[1]);
  }
}
function propertyFn(property) {
  if (property === "angle") {
    return {
      between: _angleBetween,
      compare: _angleDiff,
      normalize: _normalizeAngle
    };
  }
  return {
    between: _isBetween,
    compare: (a, b) => a - b,
    normalize: (x2) => x2
  };
}
function normalizeSegment({ start, end, count, loop, style: style2 }) {
  return {
    start: start % count,
    end: end % count,
    loop: loop && (end - start + 1) % count === 0,
    style: style2
  };
}
function getSegment(segment, points, bounds) {
  const { property, start: startBound, end: endBound } = bounds;
  const { between, normalize } = propertyFn(property);
  const count = points.length;
  let { start, end, loop } = segment;
  let i, ilen;
  if (loop) {
    start += count;
    end += count;
    for (i = 0, ilen = count; i < ilen; ++i) {
      if (!between(normalize(points[start % count][property]), startBound, endBound)) {
        break;
      }
      start--;
      end--;
    }
    start %= count;
    end %= count;
  }
  if (end < start) {
    end += count;
  }
  return {
    start,
    end,
    loop,
    style: segment.style
  };
}
function _boundSegment(segment, points, bounds) {
  if (!bounds) {
    return [
      segment
    ];
  }
  const { property, start: startBound, end: endBound } = bounds;
  const count = points.length;
  const { compare, between, normalize } = propertyFn(property);
  const { start, end, loop, style: style2 } = getSegment(segment, points, bounds);
  const result = [];
  let inside = false;
  let subStart = null;
  let value, point, prevValue;
  const startIsBefore = () => between(startBound, prevValue, value) && compare(startBound, prevValue) !== 0;
  const endIsBefore = () => compare(endBound, value) === 0 || between(endBound, prevValue, value);
  const shouldStart = () => inside || startIsBefore();
  const shouldStop = () => !inside || endIsBefore();
  for (let i = start, prev = start; i <= end; ++i) {
    point = points[i % count];
    if (point.skip) {
      continue;
    }
    value = normalize(point[property]);
    if (value === prevValue) {
      continue;
    }
    inside = between(value, startBound, endBound);
    if (subStart === null && shouldStart()) {
      subStart = compare(value, startBound) === 0 ? i : prev;
    }
    if (subStart !== null && shouldStop()) {
      result.push(normalizeSegment({
        start: subStart,
        end: i,
        loop,
        count,
        style: style2
      }));
      subStart = null;
    }
    prev = i;
    prevValue = value;
  }
  if (subStart !== null) {
    result.push(normalizeSegment({
      start: subStart,
      end,
      loop,
      count,
      style: style2
    }));
  }
  return result;
}
function _boundSegments(line, bounds) {
  const result = [];
  const segments = line.segments;
  for (let i = 0; i < segments.length; i++) {
    const sub = _boundSegment(segments[i], line.points, bounds);
    if (sub.length) {
      result.push(...sub);
    }
  }
  return result;
}
function findStartAndEnd(points, count, loop, spanGaps) {
  let start = 0;
  let end = count - 1;
  if (loop && !spanGaps) {
    while (start < count && !points[start].skip) {
      start++;
    }
  }
  while (start < count && points[start].skip) {
    start++;
  }
  start %= count;
  if (loop) {
    end += start;
  }
  while (end > start && points[end % count].skip) {
    end--;
  }
  end %= count;
  return {
    start,
    end
  };
}
function solidSegments(points, start, max2, loop) {
  const count = points.length;
  const result = [];
  let last2 = start;
  let prev = points[start];
  let end;
  for (end = start + 1; end <= max2; ++end) {
    const cur = points[end % count];
    if (cur.skip || cur.stop) {
      if (!prev.skip) {
        loop = false;
        result.push({
          start: start % count,
          end: (end - 1) % count,
          loop
        });
        start = last2 = cur.stop ? end : null;
      }
    } else {
      last2 = end;
      if (prev.skip) {
        start = end;
      }
    }
    prev = cur;
  }
  if (last2 !== null) {
    result.push({
      start: start % count,
      end: last2 % count,
      loop
    });
  }
  return result;
}
function _computeSegments(line, segmentOptions) {
  const points = line.points;
  const spanGaps = line.options.spanGaps;
  const count = points.length;
  if (!count) {
    return [];
  }
  const loop = !!line._loop;
  const { start, end } = findStartAndEnd(points, count, loop, spanGaps);
  if (spanGaps === true) {
    return splitByStyles(line, [
      {
        start,
        end,
        loop
      }
    ], points, segmentOptions);
  }
  const max2 = end < start ? end + count : end;
  const completeLoop = !!line._fullLoop && start === 0 && end === count - 1;
  return splitByStyles(line, solidSegments(points, start, max2, completeLoop), points, segmentOptions);
}
function splitByStyles(line, segments, points, segmentOptions) {
  if (!segmentOptions || !segmentOptions.setContext || !points) {
    return segments;
  }
  return doSplitByStyles(line, segments, points, segmentOptions);
}
function doSplitByStyles(line, segments, points, segmentOptions) {
  const chartContext = line._chart.getContext();
  const baseStyle = readStyle(line.options);
  const { _datasetIndex: datasetIndex, options: { spanGaps } } = line;
  const count = points.length;
  const result = [];
  let prevStyle = baseStyle;
  let start = segments[0].start;
  let i = start;
  function addStyle(s2, e, l2, st) {
    const dir = spanGaps ? -1 : 1;
    if (s2 === e) {
      return;
    }
    s2 += count;
    while (points[s2 % count].skip) {
      s2 -= dir;
    }
    while (points[e % count].skip) {
      e += dir;
    }
    if (s2 % count !== e % count) {
      result.push({
        start: s2 % count,
        end: e % count,
        loop: l2,
        style: st
      });
      prevStyle = st;
      start = e % count;
    }
  }
  for (const segment of segments) {
    start = spanGaps ? start : segment.start;
    let prev = points[start % count];
    let style2;
    for (i = start + 1; i <= segment.end; i++) {
      const pt = points[i % count];
      style2 = readStyle(segmentOptions.setContext(createContext(chartContext, {
        type: "segment",
        p0: prev,
        p1: pt,
        p0DataIndex: (i - 1) % count,
        p1DataIndex: i % count,
        datasetIndex
      })));
      if (styleChanged(style2, prevStyle)) {
        addStyle(start, i - 1, segment.loop, prevStyle);
      }
      prev = pt;
      prevStyle = style2;
    }
    if (start < i - 1) {
      addStyle(start, i - 1, segment.loop, prevStyle);
    }
  }
  return result;
}
function readStyle(options) {
  return {
    backgroundColor: options.backgroundColor,
    borderCapStyle: options.borderCapStyle,
    borderDash: options.borderDash,
    borderDashOffset: options.borderDashOffset,
    borderJoinStyle: options.borderJoinStyle,
    borderWidth: options.borderWidth,
    borderColor: options.borderColor
  };
}
function styleChanged(style2, prevStyle) {
  if (!prevStyle) {
    return false;
  }
  const cache = [];
  const replacer = function(key, value) {
    if (!isPatternOrGradient(value)) {
      return value;
    }
    if (!cache.includes(value)) {
      cache.push(value);
    }
    return cache.indexOf(value);
  };
  return JSON.stringify(style2, replacer) !== JSON.stringify(prevStyle, replacer);
}
/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */
class Animator {
  constructor() {
    this._request = null;
    this._charts = /* @__PURE__ */ new Map();
    this._running = false;
    this._lastDate = void 0;
  }
  _notify(chart, anims, date, type) {
    const callbacks = anims.listeners[type];
    const numSteps = anims.duration;
    callbacks.forEach((fn) => fn({
      chart,
      initial: anims.initial,
      numSteps,
      currentStep: Math.min(date - anims.start, numSteps)
    }));
  }
  _refresh() {
    if (this._request) {
      return;
    }
    this._running = true;
    this._request = requestAnimFrame.call(window, () => {
      this._update();
      this._request = null;
      if (this._running) {
        this._refresh();
      }
    });
  }
  _update(date = Date.now()) {
    let remaining = 0;
    this._charts.forEach((anims, chart) => {
      if (!anims.running || !anims.items.length) {
        return;
      }
      const items = anims.items;
      let i = items.length - 1;
      let draw2 = false;
      let item;
      for (; i >= 0; --i) {
        item = items[i];
        if (item._active) {
          if (item._total > anims.duration) {
            anims.duration = item._total;
          }
          item.tick(date);
          draw2 = true;
        } else {
          items[i] = items[items.length - 1];
          items.pop();
        }
      }
      if (draw2) {
        chart.draw();
        this._notify(chart, anims, date, "progress");
      }
      if (!items.length) {
        anims.running = false;
        this._notify(chart, anims, date, "complete");
        anims.initial = false;
      }
      remaining += items.length;
    });
    this._lastDate = date;
    if (remaining === 0) {
      this._running = false;
    }
  }
  _getAnims(chart) {
    const charts = this._charts;
    let anims = charts.get(chart);
    if (!anims) {
      anims = {
        running: false,
        initial: true,
        items: [],
        listeners: {
          complete: [],
          progress: []
        }
      };
      charts.set(chart, anims);
    }
    return anims;
  }
  listen(chart, event, cb2) {
    this._getAnims(chart).listeners[event].push(cb2);
  }
  add(chart, items) {
    if (!items || !items.length) {
      return;
    }
    this._getAnims(chart).items.push(...items);
  }
  has(chart) {
    return this._getAnims(chart).items.length > 0;
  }
  start(chart) {
    const anims = this._charts.get(chart);
    if (!anims) {
      return;
    }
    anims.running = true;
    anims.start = Date.now();
    anims.duration = anims.items.reduce((acc, cur) => Math.max(acc, cur._duration), 0);
    this._refresh();
  }
  running(chart) {
    if (!this._running) {
      return false;
    }
    const anims = this._charts.get(chart);
    if (!anims || !anims.running || !anims.items.length) {
      return false;
    }
    return true;
  }
  stop(chart) {
    const anims = this._charts.get(chart);
    if (!anims || !anims.items.length) {
      return;
    }
    const items = anims.items;
    let i = items.length - 1;
    for (; i >= 0; --i) {
      items[i].cancel();
    }
    anims.items = [];
    this._notify(chart, anims, Date.now(), "complete");
  }
  remove(chart) {
    return this._charts.delete(chart);
  }
}
var animator = /* @__PURE__ */ new Animator();
const transparent = "transparent";
const interpolators = {
  boolean(from2, to2, factor) {
    return factor > 0.5 ? to2 : from2;
  },
  color(from2, to2, factor) {
    const c0 = color(from2 || transparent);
    const c1 = c0.valid && color(to2 || transparent);
    return c1 && c1.valid ? c1.mix(c0, factor).hexString() : to2;
  },
  number(from2, to2, factor) {
    return from2 + (to2 - from2) * factor;
  }
};
class Animation {
  constructor(cfg, target, prop, to2) {
    const currentValue = target[prop];
    to2 = resolve([
      cfg.to,
      to2,
      currentValue,
      cfg.from
    ]);
    const from2 = resolve([
      cfg.from,
      currentValue,
      to2
    ]);
    this._active = true;
    this._fn = cfg.fn || interpolators[cfg.type || typeof from2];
    this._easing = effects[cfg.easing] || effects.linear;
    this._start = Math.floor(Date.now() + (cfg.delay || 0));
    this._duration = this._total = Math.floor(cfg.duration);
    this._loop = !!cfg.loop;
    this._target = target;
    this._prop = prop;
    this._from = from2;
    this._to = to2;
    this._promises = void 0;
  }
  active() {
    return this._active;
  }
  update(cfg, to2, date) {
    if (this._active) {
      this._notify(false);
      const currentValue = this._target[this._prop];
      const elapsed = date - this._start;
      const remain = this._duration - elapsed;
      this._start = date;
      this._duration = Math.floor(Math.max(remain, cfg.duration));
      this._total += elapsed;
      this._loop = !!cfg.loop;
      this._to = resolve([
        cfg.to,
        to2,
        currentValue,
        cfg.from
      ]);
      this._from = resolve([
        cfg.from,
        currentValue,
        to2
      ]);
    }
  }
  cancel() {
    if (this._active) {
      this.tick(Date.now());
      this._active = false;
      this._notify(false);
    }
  }
  tick(date) {
    const elapsed = date - this._start;
    const duration = this._duration;
    const prop = this._prop;
    const from2 = this._from;
    const loop = this._loop;
    const to2 = this._to;
    let factor;
    this._active = from2 !== to2 && (loop || elapsed < duration);
    if (!this._active) {
      this._target[prop] = to2;
      this._notify(true);
      return;
    }
    if (elapsed < 0) {
      this._target[prop] = from2;
      return;
    }
    factor = elapsed / duration % 2;
    factor = loop && factor > 1 ? 2 - factor : factor;
    factor = this._easing(Math.min(1, Math.max(0, factor)));
    this._target[prop] = this._fn(from2, to2, factor);
  }
  wait() {
    const promises = this._promises || (this._promises = []);
    return new Promise((res, rej) => {
      promises.push({
        res,
        rej
      });
    });
  }
  _notify(resolved) {
    const method = resolved ? "res" : "rej";
    const promises = this._promises || [];
    for (let i = 0; i < promises.length; i++) {
      promises[i][method]();
    }
  }
}
class Animations {
  constructor(chart, config) {
    this._chart = chart;
    this._properties = /* @__PURE__ */ new Map();
    this.configure(config);
  }
  configure(config) {
    if (!isObject$1(config)) {
      return;
    }
    const animationOptions = Object.keys(defaults$1.animation);
    const animatedProps = this._properties;
    Object.getOwnPropertyNames(config).forEach((key) => {
      const cfg = config[key];
      if (!isObject$1(cfg)) {
        return;
      }
      const resolved = {};
      for (const option of animationOptions) {
        resolved[option] = cfg[option];
      }
      (isArray$1(cfg.properties) && cfg.properties || [
        key
      ]).forEach((prop) => {
        if (prop === key || !animatedProps.has(prop)) {
          animatedProps.set(prop, resolved);
        }
      });
    });
  }
  _animateOptions(target, values2) {
    const newOptions = values2.options;
    const options = resolveTargetOptions(target, newOptions);
    if (!options) {
      return [];
    }
    const animations = this._createAnimations(options, newOptions);
    if (newOptions.$shared) {
      awaitAll(target.options.$animations, newOptions).then(() => {
        target.options = newOptions;
      }, () => {
      });
    }
    return animations;
  }
  _createAnimations(target, values2) {
    const animatedProps = this._properties;
    const animations = [];
    const running = target.$animations || (target.$animations = {});
    const props = Object.keys(values2);
    const date = Date.now();
    let i;
    for (i = props.length - 1; i >= 0; --i) {
      const prop = props[i];
      if (prop.charAt(0) === "$") {
        continue;
      }
      if (prop === "options") {
        animations.push(...this._animateOptions(target, values2));
        continue;
      }
      const value = values2[prop];
      let animation = running[prop];
      const cfg = animatedProps.get(prop);
      if (animation) {
        if (cfg && animation.active()) {
          animation.update(cfg, value, date);
          continue;
        } else {
          animation.cancel();
        }
      }
      if (!cfg || !cfg.duration) {
        target[prop] = value;
        continue;
      }
      running[prop] = animation = new Animation(cfg, target, prop, value);
      animations.push(animation);
    }
    return animations;
  }
  update(target, values2) {
    if (this._properties.size === 0) {
      Object.assign(target, values2);
      return;
    }
    const animations = this._createAnimations(target, values2);
    if (animations.length) {
      animator.add(this._chart, animations);
      return true;
    }
  }
}
function awaitAll(animations, properties) {
  const running = [];
  const keys2 = Object.keys(properties);
  for (let i = 0; i < keys2.length; i++) {
    const anim = animations[keys2[i]];
    if (anim && anim.active()) {
      running.push(anim.wait());
    }
  }
  return Promise.all(running);
}
function resolveTargetOptions(target, newOptions) {
  if (!newOptions) {
    return;
  }
  let options = target.options;
  if (!options) {
    target.options = newOptions;
    return;
  }
  if (options.$shared) {
    target.options = options = Object.assign({}, options, {
      $shared: false,
      $animations: {}
    });
  }
  return options;
}
function scaleClip(scale, allowedOverflow) {
  const opts = scale && scale.options || {};
  const reverse = opts.reverse;
  const min2 = opts.min === void 0 ? allowedOverflow : 0;
  const max2 = opts.max === void 0 ? allowedOverflow : 0;
  return {
    start: reverse ? max2 : min2,
    end: reverse ? min2 : max2
  };
}
function defaultClip(xScale, yScale, allowedOverflow) {
  if (allowedOverflow === false) {
    return false;
  }
  const x2 = scaleClip(xScale, allowedOverflow);
  const y2 = scaleClip(yScale, allowedOverflow);
  return {
    top: y2.end,
    right: x2.end,
    bottom: y2.start,
    left: x2.start
  };
}
function toClip(value) {
  let t2, r2, b, l2;
  if (isObject$1(value)) {
    t2 = value.top;
    r2 = value.right;
    b = value.bottom;
    l2 = value.left;
  } else {
    t2 = r2 = b = l2 = value;
  }
  return {
    top: t2,
    right: r2,
    bottom: b,
    left: l2,
    disabled: value === false
  };
}
function getSortedDatasetIndices(chart, filterVisible) {
  const keys2 = [];
  const metasets = chart._getSortedDatasetMetas(filterVisible);
  let i, ilen;
  for (i = 0, ilen = metasets.length; i < ilen; ++i) {
    keys2.push(metasets[i].index);
  }
  return keys2;
}
function applyStack(stack, value, dsIndex, options = {}) {
  const keys2 = stack.keys;
  const singleMode = options.mode === "single";
  let i, ilen, datasetIndex, otherValue;
  if (value === null) {
    return;
  }
  for (i = 0, ilen = keys2.length; i < ilen; ++i) {
    datasetIndex = +keys2[i];
    if (datasetIndex === dsIndex) {
      if (options.all) {
        continue;
      }
      break;
    }
    otherValue = stack.values[datasetIndex];
    if (isNumberFinite(otherValue) && (singleMode || value === 0 || sign$1(value) === sign$1(otherValue))) {
      value += otherValue;
    }
  }
  return value;
}
function convertObjectDataToArray(data) {
  const keys2 = Object.keys(data);
  const adata = new Array(keys2.length);
  let i, ilen, key;
  for (i = 0, ilen = keys2.length; i < ilen; ++i) {
    key = keys2[i];
    adata[i] = {
      x: key,
      y: data[key]
    };
  }
  return adata;
}
function isStacked(scale, meta) {
  const stacked = scale && scale.options.stacked;
  return stacked || stacked === void 0 && meta.stack !== void 0;
}
function getStackKey(indexScale, valueScale, meta) {
  return `${indexScale.id}.${valueScale.id}.${meta.stack || meta.type}`;
}
function getUserBounds(scale) {
  const { min: min2, max: max2, minDefined, maxDefined } = scale.getUserBounds();
  return {
    min: minDefined ? min2 : Number.NEGATIVE_INFINITY,
    max: maxDefined ? max2 : Number.POSITIVE_INFINITY
  };
}
function getOrCreateStack(stacks, stackKey, indexValue) {
  const subStack = stacks[stackKey] || (stacks[stackKey] = {});
  return subStack[indexValue] || (subStack[indexValue] = {});
}
function getLastIndexInStack(stack, vScale, positive, type) {
  for (const meta of vScale.getMatchingVisibleMetas(type).reverse()) {
    const value = stack[meta.index];
    if (positive && value > 0 || !positive && value < 0) {
      return meta.index;
    }
  }
  return null;
}
function updateStacks(controller, parsed) {
  const { chart, _cachedMeta: meta } = controller;
  const stacks = chart._stacks || (chart._stacks = {});
  const { iScale, vScale, index: datasetIndex } = meta;
  const iAxis = iScale.axis;
  const vAxis = vScale.axis;
  const key = getStackKey(iScale, vScale, meta);
  const ilen = parsed.length;
  let stack;
  for (let i = 0; i < ilen; ++i) {
    const item = parsed[i];
    const { [iAxis]: index2, [vAxis]: value } = item;
    const itemStacks = item._stacks || (item._stacks = {});
    stack = itemStacks[vAxis] = getOrCreateStack(stacks, key, index2);
    stack[datasetIndex] = value;
    stack._top = getLastIndexInStack(stack, vScale, true, meta.type);
    stack._bottom = getLastIndexInStack(stack, vScale, false, meta.type);
    const visualValues = stack._visualValues || (stack._visualValues = {});
    visualValues[datasetIndex] = value;
  }
}
function getFirstScaleId(chart, axis) {
  const scales2 = chart.scales;
  return Object.keys(scales2).filter((key) => scales2[key].axis === axis).shift();
}
function createDatasetContext(parent, index2) {
  return createContext(parent, {
    active: false,
    dataset: void 0,
    datasetIndex: index2,
    index: index2,
    mode: "default",
    type: "dataset"
  });
}
function createDataContext(parent, index2, element) {
  return createContext(parent, {
    active: false,
    dataIndex: index2,
    parsed: void 0,
    raw: void 0,
    element,
    index: index2,
    mode: "default",
    type: "data"
  });
}
function clearStacks(meta, items) {
  const datasetIndex = meta.controller.index;
  const axis = meta.vScale && meta.vScale.axis;
  if (!axis) {
    return;
  }
  items = items || meta._parsed;
  for (const parsed of items) {
    const stacks = parsed._stacks;
    if (!stacks || stacks[axis] === void 0 || stacks[axis][datasetIndex] === void 0) {
      return;
    }
    delete stacks[axis][datasetIndex];
    if (stacks[axis]._visualValues !== void 0 && stacks[axis]._visualValues[datasetIndex] !== void 0) {
      delete stacks[axis]._visualValues[datasetIndex];
    }
  }
}
const isDirectUpdateMode = (mode) => mode === "reset" || mode === "none";
const cloneIfNotShared = (cached, shared) => shared ? cached : Object.assign({}, cached);
const createStack = (canStack, meta, chart) => canStack && !meta.hidden && meta._stacked && {
  keys: getSortedDatasetIndices(chart, true),
  values: null
};
class DatasetController {
  constructor(chart, datasetIndex) {
    this.chart = chart;
    this._ctx = chart.ctx;
    this.index = datasetIndex;
    this._cachedDataOpts = {};
    this._cachedMeta = this.getMeta();
    this._type = this._cachedMeta.type;
    this.options = void 0;
    this._parsing = false;
    this._data = void 0;
    this._objectData = void 0;
    this._sharedOptions = void 0;
    this._drawStart = void 0;
    this._drawCount = void 0;
    this.enableOptionSharing = false;
    this.supportsDecimation = false;
    this.$context = void 0;
    this._syncList = [];
    this.datasetElementType = new.target.datasetElementType;
    this.dataElementType = new.target.dataElementType;
    this.initialize();
  }
  initialize() {
    const meta = this._cachedMeta;
    this.configure();
    this.linkScales();
    meta._stacked = isStacked(meta.vScale, meta);
    this.addElements();
    if (this.options.fill && !this.chart.isPluginEnabled("filler")) {
      console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options");
    }
  }
  updateIndex(datasetIndex) {
    if (this.index !== datasetIndex) {
      clearStacks(this._cachedMeta);
    }
    this.index = datasetIndex;
  }
  linkScales() {
    const chart = this.chart;
    const meta = this._cachedMeta;
    const dataset = this.getDataset();
    const chooseId = (axis, x2, y2, r2) => axis === "x" ? x2 : axis === "r" ? r2 : y2;
    const xid = meta.xAxisID = valueOrDefault(dataset.xAxisID, getFirstScaleId(chart, "x"));
    const yid = meta.yAxisID = valueOrDefault(dataset.yAxisID, getFirstScaleId(chart, "y"));
    const rid = meta.rAxisID = valueOrDefault(dataset.rAxisID, getFirstScaleId(chart, "r"));
    const indexAxis = meta.indexAxis;
    const iid = meta.iAxisID = chooseId(indexAxis, xid, yid, rid);
    const vid = meta.vAxisID = chooseId(indexAxis, yid, xid, rid);
    meta.xScale = this.getScaleForId(xid);
    meta.yScale = this.getScaleForId(yid);
    meta.rScale = this.getScaleForId(rid);
    meta.iScale = this.getScaleForId(iid);
    meta.vScale = this.getScaleForId(vid);
  }
  getDataset() {
    return this.chart.data.datasets[this.index];
  }
  getMeta() {
    return this.chart.getDatasetMeta(this.index);
  }
  getScaleForId(scaleID) {
    return this.chart.scales[scaleID];
  }
  _getOtherScale(scale) {
    const meta = this._cachedMeta;
    return scale === meta.iScale ? meta.vScale : meta.iScale;
  }
  reset() {
    this._update("reset");
  }
  _destroy() {
    const meta = this._cachedMeta;
    if (this._data) {
      unlistenArrayEvents(this._data, this);
    }
    if (meta._stacked) {
      clearStacks(meta);
    }
  }
  _dataCheck() {
    const dataset = this.getDataset();
    const data = dataset.data || (dataset.data = []);
    const _data = this._data;
    if (isObject$1(data)) {
      this._data = convertObjectDataToArray(data);
    } else if (_data !== data) {
      if (_data) {
        unlistenArrayEvents(_data, this);
        const meta = this._cachedMeta;
        clearStacks(meta);
        meta._parsed = [];
      }
      if (data && Object.isExtensible(data)) {
        listenArrayEvents(data, this);
      }
      this._syncList = [];
      this._data = data;
    }
  }
  addElements() {
    const meta = this._cachedMeta;
    this._dataCheck();
    if (this.datasetElementType) {
      meta.dataset = new this.datasetElementType();
    }
  }
  buildOrUpdateElements(resetNewElements) {
    const meta = this._cachedMeta;
    const dataset = this.getDataset();
    let stackChanged = false;
    this._dataCheck();
    const oldStacked = meta._stacked;
    meta._stacked = isStacked(meta.vScale, meta);
    if (meta.stack !== dataset.stack) {
      stackChanged = true;
      clearStacks(meta);
      meta.stack = dataset.stack;
    }
    this._resyncElements(resetNewElements);
    if (stackChanged || oldStacked !== meta._stacked) {
      updateStacks(this, meta._parsed);
    }
  }
  configure() {
    const config = this.chart.config;
    const scopeKeys = config.datasetScopeKeys(this._type);
    const scopes = config.getOptionScopes(this.getDataset(), scopeKeys, true);
    this.options = config.createResolver(scopes, this.getContext());
    this._parsing = this.options.parsing;
    this._cachedDataOpts = {};
  }
  parse(start, count) {
    const { _cachedMeta: meta, _data: data } = this;
    const { iScale, _stacked } = meta;
    const iAxis = iScale.axis;
    let sorted = start === 0 && count === data.length ? true : meta._sorted;
    let prev = start > 0 && meta._parsed[start - 1];
    let i, cur, parsed;
    if (this._parsing === false) {
      meta._parsed = data;
      meta._sorted = true;
      parsed = data;
    } else {
      if (isArray$1(data[start])) {
        parsed = this.parseArrayData(meta, data, start, count);
      } else if (isObject$1(data[start])) {
        parsed = this.parseObjectData(meta, data, start, count);
      } else {
        parsed = this.parsePrimitiveData(meta, data, start, count);
      }
      const isNotInOrderComparedToPrev = () => cur[iAxis] === null || prev && cur[iAxis] < prev[iAxis];
      for (i = 0; i < count; ++i) {
        meta._parsed[i + start] = cur = parsed[i];
        if (sorted) {
          if (isNotInOrderComparedToPrev()) {
            sorted = false;
          }
          prev = cur;
        }
      }
      meta._sorted = sorted;
    }
    if (_stacked) {
      updateStacks(this, parsed);
    }
  }
  parsePrimitiveData(meta, data, start, count) {
    const { iScale, vScale } = meta;
    const iAxis = iScale.axis;
    const vAxis = vScale.axis;
    const labels = iScale.getLabels();
    const singleScale = iScale === vScale;
    const parsed = new Array(count);
    let i, ilen, index2;
    for (i = 0, ilen = count; i < ilen; ++i) {
      index2 = i + start;
      parsed[i] = {
        [iAxis]: singleScale || iScale.parse(labels[index2], index2),
        [vAxis]: vScale.parse(data[index2], index2)
      };
    }
    return parsed;
  }
  parseArrayData(meta, data, start, count) {
    const { xScale, yScale } = meta;
    const parsed = new Array(count);
    let i, ilen, index2, item;
    for (i = 0, ilen = count; i < ilen; ++i) {
      index2 = i + start;
      item = data[index2];
      parsed[i] = {
        x: xScale.parse(item[0], index2),
        y: yScale.parse(item[1], index2)
      };
    }
    return parsed;
  }
  parseObjectData(meta, data, start, count) {
    const { xScale, yScale } = meta;
    const { xAxisKey = "x", yAxisKey = "y" } = this._parsing;
    const parsed = new Array(count);
    let i, ilen, index2, item;
    for (i = 0, ilen = count; i < ilen; ++i) {
      index2 = i + start;
      item = data[index2];
      parsed[i] = {
        x: xScale.parse(resolveObjectKey(item, xAxisKey), index2),
        y: yScale.parse(resolveObjectKey(item, yAxisKey), index2)
      };
    }
    return parsed;
  }
  getParsed(index2) {
    return this._cachedMeta._parsed[index2];
  }
  getDataElement(index2) {
    return this._cachedMeta.data[index2];
  }
  applyStack(scale, parsed, mode) {
    const chart = this.chart;
    const meta = this._cachedMeta;
    const value = parsed[scale.axis];
    const stack = {
      keys: getSortedDatasetIndices(chart, true),
      values: parsed._stacks[scale.axis]._visualValues
    };
    return applyStack(stack, value, meta.index, {
      mode
    });
  }
  updateRangeFromParsed(range, scale, parsed, stack) {
    const parsedValue = parsed[scale.axis];
    let value = parsedValue === null ? NaN : parsedValue;
    const values2 = stack && parsed._stacks[scale.axis];
    if (stack && values2) {
      stack.values = values2;
      value = applyStack(stack, parsedValue, this._cachedMeta.index);
    }
    range.min = Math.min(range.min, value);
    range.max = Math.max(range.max, value);
  }
  getMinMax(scale, canStack) {
    const meta = this._cachedMeta;
    const _parsed = meta._parsed;
    const sorted = meta._sorted && scale === meta.iScale;
    const ilen = _parsed.length;
    const otherScale = this._getOtherScale(scale);
    const stack = createStack(canStack, meta, this.chart);
    const range = {
      min: Number.POSITIVE_INFINITY,
      max: Number.NEGATIVE_INFINITY
    };
    const { min: otherMin, max: otherMax } = getUserBounds(otherScale);
    let i, parsed;
    function _skip() {
      parsed = _parsed[i];
      const otherValue = parsed[otherScale.axis];
      return !isNumberFinite(parsed[scale.axis]) || otherMin > otherValue || otherMax < otherValue;
    }
    for (i = 0; i < ilen; ++i) {
      if (_skip()) {
        continue;
      }
      this.updateRangeFromParsed(range, scale, parsed, stack);
      if (sorted) {
        break;
      }
    }
    if (sorted) {
      for (i = ilen - 1; i >= 0; --i) {
        if (_skip()) {
          continue;
        }
        this.updateRangeFromParsed(range, scale, parsed, stack);
        break;
      }
    }
    return range;
  }
  getAllParsedValues(scale) {
    const parsed = this._cachedMeta._parsed;
    const values2 = [];
    let i, ilen, value;
    for (i = 0, ilen = parsed.length; i < ilen; ++i) {
      value = parsed[i][scale.axis];
      if (isNumberFinite(value)) {
        values2.push(value);
      }
    }
    return values2;
  }
  getMaxOverflow() {
    return false;
  }
  getLabelAndValue(index2) {
    const meta = this._cachedMeta;
    const iScale = meta.iScale;
    const vScale = meta.vScale;
    const parsed = this.getParsed(index2);
    return {
      label: iScale ? "" + iScale.getLabelForValue(parsed[iScale.axis]) : "",
      value: vScale ? "" + vScale.getLabelForValue(parsed[vScale.axis]) : ""
    };
  }
  _update(mode) {
    const meta = this._cachedMeta;
    this.update(mode || "default");
    meta._clip = toClip(valueOrDefault(this.options.clip, defaultClip(meta.xScale, meta.yScale, this.getMaxOverflow())));
  }
  update(mode) {
  }
  draw() {
    const ctx = this._ctx;
    const chart = this.chart;
    const meta = this._cachedMeta;
    const elements2 = meta.data || [];
    const area = chart.chartArea;
    const active = [];
    const start = this._drawStart || 0;
    const count = this._drawCount || elements2.length - start;
    const drawActiveElementsOnTop = this.options.drawActiveElementsOnTop;
    let i;
    if (meta.dataset) {
      meta.dataset.draw(ctx, area, start, count);
    }
    for (i = start; i < start + count; ++i) {
      const element = elements2[i];
      if (element.hidden) {
        continue;
      }
      if (element.active && drawActiveElementsOnTop) {
        active.push(element);
      } else {
        element.draw(ctx, area);
      }
    }
    for (i = 0; i < active.length; ++i) {
      active[i].draw(ctx, area);
    }
  }
  getStyle(index2, active) {
    const mode = active ? "active" : "default";
    return index2 === void 0 && this._cachedMeta.dataset ? this.resolveDatasetElementOptions(mode) : this.resolveDataElementOptions(index2 || 0, mode);
  }
  getContext(index2, active, mode) {
    const dataset = this.getDataset();
    let context;
    if (index2 >= 0 && index2 < this._cachedMeta.data.length) {
      const element = this._cachedMeta.data[index2];
      context = element.$context || (element.$context = createDataContext(this.getContext(), index2, element));
      context.parsed = this.getParsed(index2);
      context.raw = dataset.data[index2];
      context.index = context.dataIndex = index2;
    } else {
      context = this.$context || (this.$context = createDatasetContext(this.chart.getContext(), this.index));
      context.dataset = dataset;
      context.index = context.datasetIndex = this.index;
    }
    context.active = !!active;
    context.mode = mode;
    return context;
  }
  resolveDatasetElementOptions(mode) {
    return this._resolveElementOptions(this.datasetElementType.id, mode);
  }
  resolveDataElementOptions(index2, mode) {
    return this._resolveElementOptions(this.dataElementType.id, mode, index2);
  }
  _resolveElementOptions(elementType, mode = "default", index2) {
    const active = mode === "active";
    const cache = this._cachedDataOpts;
    const cacheKey = elementType + "-" + mode;
    const cached = cache[cacheKey];
    const sharing = this.enableOptionSharing && defined(index2);
    if (cached) {
      return cloneIfNotShared(cached, sharing);
    }
    const config = this.chart.config;
    const scopeKeys = config.datasetElementScopeKeys(this._type, elementType);
    const prefixes = active ? [
      `${elementType}Hover`,
      "hover",
      elementType,
      ""
    ] : [
      elementType,
      ""
    ];
    const scopes = config.getOptionScopes(this.getDataset(), scopeKeys);
    const names2 = Object.keys(defaults$1.elements[elementType]);
    const context = () => this.getContext(index2, active, mode);
    const values2 = config.resolveNamedOptions(scopes, names2, context, prefixes);
    if (values2.$shared) {
      values2.$shared = sharing;
      cache[cacheKey] = Object.freeze(cloneIfNotShared(values2, sharing));
    }
    return values2;
  }
  _resolveAnimations(index2, transition, active) {
    const chart = this.chart;
    const cache = this._cachedDataOpts;
    const cacheKey = `animation-${transition}`;
    const cached = cache[cacheKey];
    if (cached) {
      return cached;
    }
    let options;
    if (chart.options.animation !== false) {
      const config = this.chart.config;
      const scopeKeys = config.datasetAnimationScopeKeys(this._type, transition);
      const scopes = config.getOptionScopes(this.getDataset(), scopeKeys);
      options = config.createResolver(scopes, this.getContext(index2, active, transition));
    }
    const animations = new Animations(chart, options && options.animations);
    if (options && options._cacheable) {
      cache[cacheKey] = Object.freeze(animations);
    }
    return animations;
  }
  getSharedOptions(options) {
    if (!options.$shared) {
      return;
    }
    return this._sharedOptions || (this._sharedOptions = Object.assign({}, options));
  }
  includeOptions(mode, sharedOptions) {
    return !sharedOptions || isDirectUpdateMode(mode) || this.chart._animationsDisabled;
  }
  _getSharedOptions(start, mode) {
    const firstOpts = this.resolveDataElementOptions(start, mode);
    const previouslySharedOptions = this._sharedOptions;
    const sharedOptions = this.getSharedOptions(firstOpts);
    const includeOptions = this.includeOptions(mode, sharedOptions) || sharedOptions !== previouslySharedOptions;
    this.updateSharedOptions(sharedOptions, mode, firstOpts);
    return {
      sharedOptions,
      includeOptions
    };
  }
  updateElement(element, index2, properties, mode) {
    if (isDirectUpdateMode(mode)) {
      Object.assign(element, properties);
    } else {
      this._resolveAnimations(index2, mode).update(element, properties);
    }
  }
  updateSharedOptions(sharedOptions, mode, newOptions) {
    if (sharedOptions && !isDirectUpdateMode(mode)) {
      this._resolveAnimations(void 0, mode).update(sharedOptions, newOptions);
    }
  }
  _setStyle(element, index2, mode, active) {
    element.active = active;
    const options = this.getStyle(index2, active);
    this._resolveAnimations(index2, mode, active).update(element, {
      options: !active && this.getSharedOptions(options) || options
    });
  }
  removeHoverStyle(element, datasetIndex, index2) {
    this._setStyle(element, index2, "active", false);
  }
  setHoverStyle(element, datasetIndex, index2) {
    this._setStyle(element, index2, "active", true);
  }
  _removeDatasetHoverStyle() {
    const element = this._cachedMeta.dataset;
    if (element) {
      this._setStyle(element, void 0, "active", false);
    }
  }
  _setDatasetHoverStyle() {
    const element = this._cachedMeta.dataset;
    if (element) {
      this._setStyle(element, void 0, "active", true);
    }
  }
  _resyncElements(resetNewElements) {
    const data = this._data;
    const elements2 = this._cachedMeta.data;
    for (const [method, arg1, arg2] of this._syncList) {
      this[method](arg1, arg2);
    }
    this._syncList = [];
    const numMeta = elements2.length;
    const numData = data.length;
    const count = Math.min(numData, numMeta);
    if (count) {
      this.parse(0, count);
    }
    if (numData > numMeta) {
      this._insertElements(numMeta, numData - numMeta, resetNewElements);
    } else if (numData < numMeta) {
      this._removeElements(numData, numMeta - numData);
    }
  }
  _insertElements(start, count, resetNewElements = true) {
    const meta = this._cachedMeta;
    const data = meta.data;
    const end = start + count;
    let i;
    const move = (arr) => {
      arr.length += count;
      for (i = arr.length - 1; i >= end; i--) {
        arr[i] = arr[i - count];
      }
    };
    move(data);
    for (i = start; i < end; ++i) {
      data[i] = new this.dataElementType();
    }
    if (this._parsing) {
      move(meta._parsed);
    }
    this.parse(start, count);
    if (resetNewElements) {
      this.updateElements(data, start, count, "reset");
    }
  }
  updateElements(element, start, count, mode) {
  }
  _removeElements(start, count) {
    const meta = this._cachedMeta;
    if (this._parsing) {
      const removed = meta._parsed.splice(start, count);
      if (meta._stacked) {
        clearStacks(meta, removed);
      }
    }
    meta.data.splice(start, count);
  }
  _sync(args) {
    if (this._parsing) {
      this._syncList.push(args);
    } else {
      const [method, arg1, arg2] = args;
      this[method](arg1, arg2);
    }
    this.chart._dataChanges.push([
      this.index,
      ...args
    ]);
  }
  _onDataPush() {
    const count = arguments.length;
    this._sync([
      "_insertElements",
      this.getDataset().data.length - count,
      count
    ]);
  }
  _onDataPop() {
    this._sync([
      "_removeElements",
      this._cachedMeta.data.length - 1,
      1
    ]);
  }
  _onDataShift() {
    this._sync([
      "_removeElements",
      0,
      1
    ]);
  }
  _onDataSplice(start, count) {
    if (count) {
      this._sync([
        "_removeElements",
        start,
        count
      ]);
    }
    const newCount = arguments.length - 2;
    if (newCount) {
      this._sync([
        "_insertElements",
        start,
        newCount
      ]);
    }
  }
  _onDataUnshift() {
    this._sync([
      "_insertElements",
      0,
      arguments.length
    ]);
  }
}
__publicField(DatasetController, "defaults", {});
__publicField(DatasetController, "datasetElementType", null);
__publicField(DatasetController, "dataElementType", null);
function getAllScaleValues(scale, type) {
  if (!scale._cache.$bar) {
    const visibleMetas = scale.getMatchingVisibleMetas(type);
    let values2 = [];
    for (let i = 0, ilen = visibleMetas.length; i < ilen; i++) {
      values2 = values2.concat(visibleMetas[i].controller.getAllParsedValues(scale));
    }
    scale._cache.$bar = _arrayUnique(values2.sort((a, b) => a - b));
  }
  return scale._cache.$bar;
}
function computeMinSampleSize(meta) {
  const scale = meta.iScale;
  const values2 = getAllScaleValues(scale, meta.type);
  let min2 = scale._length;
  let i, ilen, curr, prev;
  const updateMinAndPrev = () => {
    if (curr === 32767 || curr === -32768) {
      return;
    }
    if (defined(prev)) {
      min2 = Math.min(min2, Math.abs(curr - prev) || min2);
    }
    prev = curr;
  };
  for (i = 0, ilen = values2.length; i < ilen; ++i) {
    curr = scale.getPixelForValue(values2[i]);
    updateMinAndPrev();
  }
  prev = void 0;
  for (i = 0, ilen = scale.ticks.length; i < ilen; ++i) {
    curr = scale.getPixelForTick(i);
    updateMinAndPrev();
  }
  return min2;
}
function computeFitCategoryTraits(index2, ruler, options, stackCount) {
  const thickness = options.barThickness;
  let size, ratio;
  if (isNullOrUndef(thickness)) {
    size = ruler.min * options.categoryPercentage;
    ratio = options.barPercentage;
  } else {
    size = thickness * stackCount;
    ratio = 1;
  }
  return {
    chunk: size / stackCount,
    ratio,
    start: ruler.pixels[index2] - size / 2
  };
}
function computeFlexCategoryTraits(index2, ruler, options, stackCount) {
  const pixels = ruler.pixels;
  const curr = pixels[index2];
  let prev = index2 > 0 ? pixels[index2 - 1] : null;
  let next = index2 < pixels.length - 1 ? pixels[index2 + 1] : null;
  const percent = options.categoryPercentage;
  if (prev === null) {
    prev = curr - (next === null ? ruler.end - ruler.start : next - curr);
  }
  if (next === null) {
    next = curr + curr - prev;
  }
  const start = curr - (curr - Math.min(prev, next)) / 2 * percent;
  const size = Math.abs(next - prev) / 2 * percent;
  return {
    chunk: size / stackCount,
    ratio: options.barPercentage,
    start
  };
}
function parseFloatBar(entry, item, vScale, i) {
  const startValue = vScale.parse(entry[0], i);
  const endValue = vScale.parse(entry[1], i);
  const min2 = Math.min(startValue, endValue);
  const max2 = Math.max(startValue, endValue);
  let barStart = min2;
  let barEnd = max2;
  if (Math.abs(min2) > Math.abs(max2)) {
    barStart = max2;
    barEnd = min2;
  }
  item[vScale.axis] = barEnd;
  item._custom = {
    barStart,
    barEnd,
    start: startValue,
    end: endValue,
    min: min2,
    max: max2
  };
}
function parseValue(entry, item, vScale, i) {
  if (isArray$1(entry)) {
    parseFloatBar(entry, item, vScale, i);
  } else {
    item[vScale.axis] = vScale.parse(entry, i);
  }
  return item;
}
function parseArrayOrPrimitive(meta, data, start, count) {
  const iScale = meta.iScale;
  const vScale = meta.vScale;
  const labels = iScale.getLabels();
  const singleScale = iScale === vScale;
  const parsed = [];
  let i, ilen, item, entry;
  for (i = start, ilen = start + count; i < ilen; ++i) {
    entry = data[i];
    item = {};
    item[iScale.axis] = singleScale || iScale.parse(labels[i], i);
    parsed.push(parseValue(entry, item, vScale, i));
  }
  return parsed;
}
function isFloatBar(custom) {
  return custom && custom.barStart !== void 0 && custom.barEnd !== void 0;
}
function barSign(size, vScale, actualBase) {
  if (size !== 0) {
    return sign$1(size);
  }
  return (vScale.isHorizontal() ? 1 : -1) * (vScale.min >= actualBase ? 1 : -1);
}
function borderProps(properties) {
  let reverse, start, end, top, bottom;
  if (properties.horizontal) {
    reverse = properties.base > properties.x;
    start = "left";
    end = "right";
  } else {
    reverse = properties.base < properties.y;
    start = "bottom";
    end = "top";
  }
  if (reverse) {
    top = "end";
    bottom = "start";
  } else {
    top = "start";
    bottom = "end";
  }
  return {
    start,
    end,
    reverse,
    top,
    bottom
  };
}
function setBorderSkipped(properties, options, stack, index2) {
  let edge = options.borderSkipped;
  const res = {};
  if (!edge) {
    properties.borderSkipped = res;
    return;
  }
  if (edge === true) {
    properties.borderSkipped = {
      top: true,
      right: true,
      bottom: true,
      left: true
    };
    return;
  }
  const { start, end, reverse, top, bottom } = borderProps(properties);
  if (edge === "middle" && stack) {
    properties.enableBorderRadius = true;
    if ((stack._top || 0) === index2) {
      edge = top;
    } else if ((stack._bottom || 0) === index2) {
      edge = bottom;
    } else {
      res[parseEdge(bottom, start, end, reverse)] = true;
      edge = top;
    }
  }
  res[parseEdge(edge, start, end, reverse)] = true;
  properties.borderSkipped = res;
}
function parseEdge(edge, a, b, reverse) {
  if (reverse) {
    edge = swap(edge, a, b);
    edge = startEnd(edge, b, a);
  } else {
    edge = startEnd(edge, a, b);
  }
  return edge;
}
function swap(orig, v1, v2) {
  return orig === v1 ? v2 : orig === v2 ? v1 : orig;
}
function startEnd(v2, start, end) {
  return v2 === "start" ? start : v2 === "end" ? end : v2;
}
function setInflateAmount(properties, { inflateAmount }, ratio) {
  properties.inflateAmount = inflateAmount === "auto" ? ratio === 1 ? 0.33 : 0 : inflateAmount;
}
class BarController extends DatasetController {
  parsePrimitiveData(meta, data, start, count) {
    return parseArrayOrPrimitive(meta, data, start, count);
  }
  parseArrayData(meta, data, start, count) {
    return parseArrayOrPrimitive(meta, data, start, count);
  }
  parseObjectData(meta, data, start, count) {
    const { iScale, vScale } = meta;
    const { xAxisKey = "x", yAxisKey = "y" } = this._parsing;
    const iAxisKey = iScale.axis === "x" ? xAxisKey : yAxisKey;
    const vAxisKey = vScale.axis === "x" ? xAxisKey : yAxisKey;
    const parsed = [];
    let i, ilen, item, obj;
    for (i = start, ilen = start + count; i < ilen; ++i) {
      obj = data[i];
      item = {};
      item[iScale.axis] = iScale.parse(resolveObjectKey(obj, iAxisKey), i);
      parsed.push(parseValue(resolveObjectKey(obj, vAxisKey), item, vScale, i));
    }
    return parsed;
  }
  updateRangeFromParsed(range, scale, parsed, stack) {
    super.updateRangeFromParsed(range, scale, parsed, stack);
    const custom = parsed._custom;
    if (custom && scale === this._cachedMeta.vScale) {
      range.min = Math.min(range.min, custom.min);
      range.max = Math.max(range.max, custom.max);
    }
  }
  getMaxOverflow() {
    return 0;
  }
  getLabelAndValue(index2) {
    const meta = this._cachedMeta;
    const { iScale, vScale } = meta;
    const parsed = this.getParsed(index2);
    const custom = parsed._custom;
    const value = isFloatBar(custom) ? "[" + custom.start + ", " + custom.end + "]" : "" + vScale.getLabelForValue(parsed[vScale.axis]);
    return {
      label: "" + iScale.getLabelForValue(parsed[iScale.axis]),
      value
    };
  }
  initialize() {
    this.enableOptionSharing = true;
    super.initialize();
    const meta = this._cachedMeta;
    meta.stack = this.getDataset().stack;
  }
  update(mode) {
    const meta = this._cachedMeta;
    this.updateElements(meta.data, 0, meta.data.length, mode);
  }
  updateElements(bars, start, count, mode) {
    const reset = mode === "reset";
    const { index: index2, _cachedMeta: { vScale } } = this;
    const base = vScale.getBasePixel();
    const horizontal = vScale.isHorizontal();
    const ruler = this._getRuler();
    const { sharedOptions, includeOptions } = this._getSharedOptions(start, mode);
    for (let i = start; i < start + count; i++) {
      const parsed = this.getParsed(i);
      const vpixels = reset || isNullOrUndef(parsed[vScale.axis]) ? {
        base,
        head: base
      } : this._calculateBarValuePixels(i);
      const ipixels = this._calculateBarIndexPixels(i, ruler);
      const stack = (parsed._stacks || {})[vScale.axis];
      const properties = {
        horizontal,
        base: vpixels.base,
        enableBorderRadius: !stack || isFloatBar(parsed._custom) || index2 === stack._top || index2 === stack._bottom,
        x: horizontal ? vpixels.head : ipixels.center,
        y: horizontal ? ipixels.center : vpixels.head,
        height: horizontal ? ipixels.size : Math.abs(vpixels.size),
        width: horizontal ? Math.abs(vpixels.size) : ipixels.size
      };
      if (includeOptions) {
        properties.options = sharedOptions || this.resolveDataElementOptions(i, bars[i].active ? "active" : mode);
      }
      const options = properties.options || bars[i].options;
      setBorderSkipped(properties, options, stack, index2);
      setInflateAmount(properties, options, ruler.ratio);
      this.updateElement(bars[i], i, properties, mode);
    }
  }
  _getStacks(last2, dataIndex) {
    const { iScale } = this._cachedMeta;
    const metasets = iScale.getMatchingVisibleMetas(this._type).filter((meta) => meta.controller.options.grouped);
    const stacked = iScale.options.stacked;
    const stacks = [];
    const skipNull = (meta) => {
      const parsed = meta.controller.getParsed(dataIndex);
      const val = parsed && parsed[meta.vScale.axis];
      if (isNullOrUndef(val) || isNaN(val)) {
        return true;
      }
    };
    for (const meta of metasets) {
      if (dataIndex !== void 0 && skipNull(meta)) {
        continue;
      }
      if (stacked === false || stacks.indexOf(meta.stack) === -1 || stacked === void 0 && meta.stack === void 0) {
        stacks.push(meta.stack);
      }
      if (meta.index === last2) {
        break;
      }
    }
    if (!stacks.length) {
      stacks.push(void 0);
    }
    return stacks;
  }
  _getStackCount(index2) {
    return this._getStacks(void 0, index2).length;
  }
  _getStackIndex(datasetIndex, name, dataIndex) {
    const stacks = this._getStacks(datasetIndex, dataIndex);
    const index2 = name !== void 0 ? stacks.indexOf(name) : -1;
    return index2 === -1 ? stacks.length - 1 : index2;
  }
  _getRuler() {
    const opts = this.options;
    const meta = this._cachedMeta;
    const iScale = meta.iScale;
    const pixels = [];
    let i, ilen;
    for (i = 0, ilen = meta.data.length; i < ilen; ++i) {
      pixels.push(iScale.getPixelForValue(this.getParsed(i)[iScale.axis], i));
    }
    const barThickness = opts.barThickness;
    const min2 = barThickness || computeMinSampleSize(meta);
    return {
      min: min2,
      pixels,
      start: iScale._startPixel,
      end: iScale._endPixel,
      stackCount: this._getStackCount(),
      scale: iScale,
      grouped: opts.grouped,
      ratio: barThickness ? 1 : opts.categoryPercentage * opts.barPercentage
    };
  }
  _calculateBarValuePixels(index2) {
    const { _cachedMeta: { vScale, _stacked, index: datasetIndex }, options: { base: baseValue, minBarLength } } = this;
    const actualBase = baseValue || 0;
    const parsed = this.getParsed(index2);
    const custom = parsed._custom;
    const floating = isFloatBar(custom);
    let value = parsed[vScale.axis];
    let start = 0;
    let length = _stacked ? this.applyStack(vScale, parsed, _stacked) : value;
    let head, size;
    if (length !== value) {
      start = length - value;
      length = value;
    }
    if (floating) {
      value = custom.barStart;
      length = custom.barEnd - custom.barStart;
      if (value !== 0 && sign$1(value) !== sign$1(custom.barEnd)) {
        start = 0;
      }
      start += value;
    }
    const startValue = !isNullOrUndef(baseValue) && !floating ? baseValue : start;
    let base = vScale.getPixelForValue(startValue);
    if (this.chart.getDataVisibility(index2)) {
      head = vScale.getPixelForValue(start + length);
    } else {
      head = base;
    }
    size = head - base;
    if (Math.abs(size) < minBarLength) {
      size = barSign(size, vScale, actualBase) * minBarLength;
      if (value === actualBase) {
        base -= size / 2;
      }
      const startPixel = vScale.getPixelForDecimal(0);
      const endPixel = vScale.getPixelForDecimal(1);
      const min2 = Math.min(startPixel, endPixel);
      const max2 = Math.max(startPixel, endPixel);
      base = Math.max(Math.min(base, max2), min2);
      head = base + size;
      if (_stacked && !floating) {
        parsed._stacks[vScale.axis]._visualValues[datasetIndex] = vScale.getValueForPixel(head) - vScale.getValueForPixel(base);
      }
    }
    if (base === vScale.getPixelForValue(actualBase)) {
      const halfGrid = sign$1(size) * vScale.getLineWidthForValue(actualBase) / 2;
      base += halfGrid;
      size -= halfGrid;
    }
    return {
      size,
      base,
      head,
      center: head + size / 2
    };
  }
  _calculateBarIndexPixels(index2, ruler) {
    const scale = ruler.scale;
    const options = this.options;
    const skipNull = options.skipNull;
    const maxBarThickness = valueOrDefault(options.maxBarThickness, Infinity);
    let center, size;
    if (ruler.grouped) {
      const stackCount = skipNull ? this._getStackCount(index2) : ruler.stackCount;
      const range = options.barThickness === "flex" ? computeFlexCategoryTraits(index2, ruler, options, stackCount) : computeFitCategoryTraits(index2, ruler, options, stackCount);
      const stackIndex = this._getStackIndex(this.index, this._cachedMeta.stack, skipNull ? index2 : void 0);
      center = range.start + range.chunk * stackIndex + range.chunk / 2;
      size = Math.min(maxBarThickness, range.chunk * range.ratio);
    } else {
      center = scale.getPixelForValue(this.getParsed(index2)[scale.axis], index2);
      size = Math.min(maxBarThickness, ruler.min * ruler.ratio);
    }
    return {
      base: center - size / 2,
      head: center + size / 2,
      center,
      size
    };
  }
  draw() {
    const meta = this._cachedMeta;
    const vScale = meta.vScale;
    const rects = meta.data;
    const ilen = rects.length;
    let i = 0;
    for (; i < ilen; ++i) {
      if (this.getParsed(i)[vScale.axis] !== null) {
        rects[i].draw(this._ctx);
      }
    }
  }
}
__publicField(BarController, "id", "bar");
__publicField(BarController, "defaults", {
  datasetElementType: false,
  dataElementType: "bar",
  categoryPercentage: 0.8,
  barPercentage: 0.9,
  grouped: true,
  animations: {
    numbers: {
      type: "number",
      properties: [
        "x",
        "y",
        "base",
        "width",
        "height"
      ]
    }
  }
});
__publicField(BarController, "overrides", {
  scales: {
    _index_: {
      type: "category",
      offset: true,
      grid: {
        offset: true
      }
    },
    _value_: {
      type: "linear",
      beginAtZero: true
    }
  }
});
class BubbleController extends DatasetController {
  initialize() {
    this.enableOptionSharing = true;
    super.initialize();
  }
  parsePrimitiveData(meta, data, start, count) {
    const parsed = super.parsePrimitiveData(meta, data, start, count);
    for (let i = 0; i < parsed.length; i++) {
      parsed[i]._custom = this.resolveDataElementOptions(i + start).radius;
    }
    return parsed;
  }
  parseArrayData(meta, data, start, count) {
    const parsed = super.parseArrayData(meta, data, start, count);
    for (let i = 0; i < parsed.length; i++) {
      const item = data[start + i];
      parsed[i]._custom = valueOrDefault(item[2], this.resolveDataElementOptions(i + start).radius);
    }
    return parsed;
  }
  parseObjectData(meta, data, start, count) {
    const parsed = super.parseObjectData(meta, data, start, count);
    for (let i = 0; i < parsed.length; i++) {
      const item = data[start + i];
      parsed[i]._custom = valueOrDefault(item && item.r && +item.r, this.resolveDataElementOptions(i + start).radius);
    }
    return parsed;
  }
  getMaxOverflow() {
    const data = this._cachedMeta.data;
    let max2 = 0;
    for (let i = data.length - 1; i >= 0; --i) {
      max2 = Math.max(max2, data[i].size(this.resolveDataElementOptions(i)) / 2);
    }
    return max2 > 0 && max2;
  }
  getLabelAndValue(index2) {
    const meta = this._cachedMeta;
    const labels = this.chart.data.labels || [];
    const { xScale, yScale } = meta;
    const parsed = this.getParsed(index2);
    const x2 = xScale.getLabelForValue(parsed.x);
    const y2 = yScale.getLabelForValue(parsed.y);
    const r2 = parsed._custom;
    return {
      label: labels[index2] || "",
      value: "(" + x2 + ", " + y2 + (r2 ? ", " + r2 : "") + ")"
    };
  }
  update(mode) {
    const points = this._cachedMeta.data;
    this.updateElements(points, 0, points.length, mode);
  }
  updateElements(points, start, count, mode) {
    const reset = mode === "reset";
    const { iScale, vScale } = this._cachedMeta;
    const { sharedOptions, includeOptions } = this._getSharedOptions(start, mode);
    const iAxis = iScale.axis;
    const vAxis = vScale.axis;
    for (let i = start; i < start + count; i++) {
      const point = points[i];
      const parsed = !reset && this.getParsed(i);
      const properties = {};
      const iPixel = properties[iAxis] = reset ? iScale.getPixelForDecimal(0.5) : iScale.getPixelForValue(parsed[iAxis]);
      const vPixel = properties[vAxis] = reset ? vScale.getBasePixel() : vScale.getPixelForValue(parsed[vAxis]);
      properties.skip = isNaN(iPixel) || isNaN(vPixel);
      if (includeOptions) {
        properties.options = sharedOptions || this.resolveDataElementOptions(i, point.active ? "active" : mode);
        if (reset) {
          properties.options.radius = 0;
        }
      }
      this.updateElement(point, i, properties, mode);
    }
  }
  resolveDataElementOptions(index2, mode) {
    const parsed = this.getParsed(index2);
    let values2 = super.resolveDataElementOptions(index2, mode);
    if (values2.$shared) {
      values2 = Object.assign({}, values2, {
        $shared: false
      });
    }
    const radius = values2.radius;
    if (mode !== "active") {
      values2.radius = 0;
    }
    values2.radius += valueOrDefault(parsed && parsed._custom, radius);
    return values2;
  }
}
__publicField(BubbleController, "id", "bubble");
__publicField(BubbleController, "defaults", {
  datasetElementType: false,
  dataElementType: "point",
  animations: {
    numbers: {
      type: "number",
      properties: [
        "x",
        "y",
        "borderWidth",
        "radius"
      ]
    }
  }
});
__publicField(BubbleController, "overrides", {
  scales: {
    x: {
      type: "linear"
    },
    y: {
      type: "linear"
    }
  }
});
function getRatioAndOffset(rotation, circumference, cutout) {
  let ratioX = 1;
  let ratioY = 1;
  let offsetX = 0;
  let offsetY = 0;
  if (circumference < TAU) {
    const startAngle = rotation;
    const endAngle = startAngle + circumference;
    const startX = Math.cos(startAngle);
    const startY = Math.sin(startAngle);
    const endX = Math.cos(endAngle);
    const endY = Math.sin(endAngle);
    const calcMax = (angle, a, b) => _angleBetween(angle, startAngle, endAngle, true) ? 1 : Math.max(a, a * cutout, b, b * cutout);
    const calcMin = (angle, a, b) => _angleBetween(angle, startAngle, endAngle, true) ? -1 : Math.min(a, a * cutout, b, b * cutout);
    const maxX = calcMax(0, startX, endX);
    const maxY = calcMax(HALF_PI, startY, endY);
    const minX = calcMin(PI, startX, endX);
    const minY = calcMin(PI + HALF_PI, startY, endY);
    ratioX = (maxX - minX) / 2;
    ratioY = (maxY - minY) / 2;
    offsetX = -(maxX + minX) / 2;
    offsetY = -(maxY + minY) / 2;
  }
  return {
    ratioX,
    ratioY,
    offsetX,
    offsetY
  };
}
class DoughnutController extends DatasetController {
  constructor(chart, datasetIndex) {
    super(chart, datasetIndex);
    this.enableOptionSharing = true;
    this.innerRadius = void 0;
    this.outerRadius = void 0;
    this.offsetX = void 0;
    this.offsetY = void 0;
  }
  linkScales() {
  }
  parse(start, count) {
    const data = this.getDataset().data;
    const meta = this._cachedMeta;
    if (this._parsing === false) {
      meta._parsed = data;
    } else {
      let getter = (i2) => +data[i2];
      if (isObject$1(data[start])) {
        const { key = "value" } = this._parsing;
        getter = (i2) => +resolveObjectKey(data[i2], key);
      }
      let i, ilen;
      for (i = start, ilen = start + count; i < ilen; ++i) {
        meta._parsed[i] = getter(i);
      }
    }
  }
  _getRotation() {
    return toRadians(this.options.rotation - 90);
  }
  _getCircumference() {
    return toRadians(this.options.circumference);
  }
  _getRotationExtents() {
    let min2 = TAU;
    let max2 = -TAU;
    for (let i = 0; i < this.chart.data.datasets.length; ++i) {
      if (this.chart.isDatasetVisible(i) && this.chart.getDatasetMeta(i).type === this._type) {
        const controller = this.chart.getDatasetMeta(i).controller;
        const rotation = controller._getRotation();
        const circumference = controller._getCircumference();
        min2 = Math.min(min2, rotation);
        max2 = Math.max(max2, rotation + circumference);
      }
    }
    return {
      rotation: min2,
      circumference: max2 - min2
    };
  }
  update(mode) {
    const chart = this.chart;
    const { chartArea } = chart;
    const meta = this._cachedMeta;
    const arcs = meta.data;
    const spacing = this.getMaxBorderWidth() + this.getMaxOffset(arcs) + this.options.spacing;
    const maxSize = Math.max((Math.min(chartArea.width, chartArea.height) - spacing) / 2, 0);
    const cutout = Math.min(toPercentage(this.options.cutout, maxSize), 1);
    const chartWeight = this._getRingWeight(this.index);
    const { circumference, rotation } = this._getRotationExtents();
    const { ratioX, ratioY, offsetX, offsetY } = getRatioAndOffset(rotation, circumference, cutout);
    const maxWidth = (chartArea.width - spacing) / ratioX;
    const maxHeight = (chartArea.height - spacing) / ratioY;
    const maxRadius = Math.max(Math.min(maxWidth, maxHeight) / 2, 0);
    const outerRadius = toDimension(this.options.radius, maxRadius);
    const innerRadius = Math.max(outerRadius * cutout, 0);
    const radiusLength = (outerRadius - innerRadius) / this._getVisibleDatasetWeightTotal();
    this.offsetX = offsetX * outerRadius;
    this.offsetY = offsetY * outerRadius;
    meta.total = this.calculateTotal();
    this.outerRadius = outerRadius - radiusLength * this._getRingWeightOffset(this.index);
    this.innerRadius = Math.max(this.outerRadius - radiusLength * chartWeight, 0);
    this.updateElements(arcs, 0, arcs.length, mode);
  }
  _circumference(i, reset) {
    const opts = this.options;
    const meta = this._cachedMeta;
    const circumference = this._getCircumference();
    if (reset && opts.animation.animateRotate || !this.chart.getDataVisibility(i) || meta._parsed[i] === null || meta.data[i].hidden) {
      return 0;
    }
    return this.calculateCircumference(meta._parsed[i] * circumference / TAU);
  }
  updateElements(arcs, start, count, mode) {
    const reset = mode === "reset";
    const chart = this.chart;
    const chartArea = chart.chartArea;
    const opts = chart.options;
    const animationOpts = opts.animation;
    const centerX = (chartArea.left + chartArea.right) / 2;
    const centerY = (chartArea.top + chartArea.bottom) / 2;
    const animateScale = reset && animationOpts.animateScale;
    const innerRadius = animateScale ? 0 : this.innerRadius;
    const outerRadius = animateScale ? 0 : this.outerRadius;
    const { sharedOptions, includeOptions } = this._getSharedOptions(start, mode);
    let startAngle = this._getRotation();
    let i;
    for (i = 0; i < start; ++i) {
      startAngle += this._circumference(i, reset);
    }
    for (i = start; i < start + count; ++i) {
      const circumference = this._circumference(i, reset);
      const arc = arcs[i];
      const properties = {
        x: centerX + this.offsetX,
        y: centerY + this.offsetY,
        startAngle,
        endAngle: startAngle + circumference,
        circumference,
        outerRadius,
        innerRadius
      };
      if (includeOptions) {
        properties.options = sharedOptions || this.resolveDataElementOptions(i, arc.active ? "active" : mode);
      }
      startAngle += circumference;
      this.updateElement(arc, i, properties, mode);
    }
  }
  calculateTotal() {
    const meta = this._cachedMeta;
    const metaData = meta.data;
    let total = 0;
    let i;
    for (i = 0; i < metaData.length; i++) {
      const value = meta._parsed[i];
      if (value !== null && !isNaN(value) && this.chart.getDataVisibility(i) && !metaData[i].hidden) {
        total += Math.abs(value);
      }
    }
    return total;
  }
  calculateCircumference(value) {
    const total = this._cachedMeta.total;
    if (total > 0 && !isNaN(value)) {
      return TAU * (Math.abs(value) / total);
    }
    return 0;
  }
  getLabelAndValue(index2) {
    const meta = this._cachedMeta;
    const chart = this.chart;
    const labels = chart.data.labels || [];
    const value = formatNumber(meta._parsed[index2], chart.options.locale);
    return {
      label: labels[index2] || "",
      value
    };
  }
  getMaxBorderWidth(arcs) {
    let max2 = 0;
    const chart = this.chart;
    let i, ilen, meta, controller, options;
    if (!arcs) {
      for (i = 0, ilen = chart.data.datasets.length; i < ilen; ++i) {
        if (chart.isDatasetVisible(i)) {
          meta = chart.getDatasetMeta(i);
          arcs = meta.data;
          controller = meta.controller;
          break;
        }
      }
    }
    if (!arcs) {
      return 0;
    }
    for (i = 0, ilen = arcs.length; i < ilen; ++i) {
      options = controller.resolveDataElementOptions(i);
      if (options.borderAlign !== "inner") {
        max2 = Math.max(max2, options.borderWidth || 0, options.hoverBorderWidth || 0);
      }
    }
    return max2;
  }
  getMaxOffset(arcs) {
    let max2 = 0;
    for (let i = 0, ilen = arcs.length; i < ilen; ++i) {
      const options = this.resolveDataElementOptions(i);
      max2 = Math.max(max2, options.offset || 0, options.hoverOffset || 0);
    }
    return max2;
  }
  _getRingWeightOffset(datasetIndex) {
    let ringWeightOffset = 0;
    for (let i = 0; i < datasetIndex; ++i) {
      if (this.chart.isDatasetVisible(i)) {
        ringWeightOffset += this._getRingWeight(i);
      }
    }
    return ringWeightOffset;
  }
  _getRingWeight(datasetIndex) {
    return Math.max(valueOrDefault(this.chart.data.datasets[datasetIndex].weight, 1), 0);
  }
  _getVisibleDatasetWeightTotal() {
    return this._getRingWeightOffset(this.chart.data.datasets.length) || 1;
  }
}
__publicField(DoughnutController, "id", "doughnut");
__publicField(DoughnutController, "defaults", {
  datasetElementType: false,
  dataElementType: "arc",
  animation: {
    animateRotate: true,
    animateScale: false
  },
  animations: {
    numbers: {
      type: "number",
      properties: [
        "circumference",
        "endAngle",
        "innerRadius",
        "outerRadius",
        "startAngle",
        "x",
        "y",
        "offset",
        "borderWidth",
        "spacing"
      ]
    }
  },
  cutout: "50%",
  rotation: 0,
  circumference: 360,
  radius: "100%",
  spacing: 0,
  indexAxis: "r"
});
__publicField(DoughnutController, "descriptors", {
  _scriptable: (name) => name !== "spacing",
  _indexable: (name) => name !== "spacing" && !name.startsWith("borderDash") && !name.startsWith("hoverBorderDash")
});
__publicField(DoughnutController, "overrides", {
  aspectRatio: 1,
  plugins: {
    legend: {
      labels: {
        generateLabels(chart) {
          const data = chart.data;
          if (data.labels.length && data.datasets.length) {
            const { labels: { pointStyle, color: color2 } } = chart.legend.options;
            return data.labels.map((label, i) => {
              const meta = chart.getDatasetMeta(0);
              const style2 = meta.controller.getStyle(i);
              return {
                text: label,
                fillStyle: style2.backgroundColor,
                strokeStyle: style2.borderColor,
                fontColor: color2,
                lineWidth: style2.borderWidth,
                pointStyle,
                hidden: !chart.getDataVisibility(i),
                index: i
              };
            });
          }
          return [];
        }
      },
      onClick(e, legendItem, legend) {
        legend.chart.toggleDataVisibility(legendItem.index);
        legend.chart.update();
      }
    }
  }
});
class LineController extends DatasetController {
  initialize() {
    this.enableOptionSharing = true;
    this.supportsDecimation = true;
    super.initialize();
  }
  update(mode) {
    const meta = this._cachedMeta;
    const { dataset: line, data: points = [], _dataset } = meta;
    const animationsDisabled = this.chart._animationsDisabled;
    let { start, count } = _getStartAndCountOfVisiblePoints(meta, points, animationsDisabled);
    this._drawStart = start;
    this._drawCount = count;
    if (_scaleRangesChanged(meta)) {
      start = 0;
      count = points.length;
    }
    line._chart = this.chart;
    line._datasetIndex = this.index;
    line._decimated = !!_dataset._decimated;
    line.points = points;
    const options = this.resolveDatasetElementOptions(mode);
    if (!this.options.showLine) {
      options.borderWidth = 0;
    }
    options.segment = this.options.segment;
    this.updateElement(line, void 0, {
      animated: !animationsDisabled,
      options
    }, mode);
    this.updateElements(points, start, count, mode);
  }
  updateElements(points, start, count, mode) {
    const reset = mode === "reset";
    const { iScale, vScale, _stacked, _dataset } = this._cachedMeta;
    const { sharedOptions, includeOptions } = this._getSharedOptions(start, mode);
    const iAxis = iScale.axis;
    const vAxis = vScale.axis;
    const { spanGaps, segment } = this.options;
    const maxGapLength = isNumber$1(spanGaps) ? spanGaps : Number.POSITIVE_INFINITY;
    const directUpdate = this.chart._animationsDisabled || reset || mode === "none";
    const end = start + count;
    const pointsCount = points.length;
    let prevParsed = start > 0 && this.getParsed(start - 1);
    for (let i = 0; i < pointsCount; ++i) {
      const point = points[i];
      const properties = directUpdate ? point : {};
      if (i < start || i >= end) {
        properties.skip = true;
        continue;
      }
      const parsed = this.getParsed(i);
      const nullData = isNullOrUndef(parsed[vAxis]);
      const iPixel = properties[iAxis] = iScale.getPixelForValue(parsed[iAxis], i);
      const vPixel = properties[vAxis] = reset || nullData ? vScale.getBasePixel() : vScale.getPixelForValue(_stacked ? this.applyStack(vScale, parsed, _stacked) : parsed[vAxis], i);
      properties.skip = isNaN(iPixel) || isNaN(vPixel) || nullData;
      properties.stop = i > 0 && Math.abs(parsed[iAxis] - prevParsed[iAxis]) > maxGapLength;
      if (segment) {
        properties.parsed = parsed;
        properties.raw = _dataset.data[i];
      }
      if (includeOptions) {
        properties.options = sharedOptions || this.resolveDataElementOptions(i, point.active ? "active" : mode);
      }
      if (!directUpdate) {
        this.updateElement(point, i, properties, mode);
      }
      prevParsed = parsed;
    }
  }
  getMaxOverflow() {
    const meta = this._cachedMeta;
    const dataset = meta.dataset;
    const border = dataset.options && dataset.options.borderWidth || 0;
    const data = meta.data || [];
    if (!data.length) {
      return border;
    }
    const firstPoint = data[0].size(this.resolveDataElementOptions(0));
    const lastPoint = data[data.length - 1].size(this.resolveDataElementOptions(data.length - 1));
    return Math.max(border, firstPoint, lastPoint) / 2;
  }
  draw() {
    const meta = this._cachedMeta;
    meta.dataset.updateControlPoints(this.chart.chartArea, meta.iScale.axis);
    super.draw();
  }
}
__publicField(LineController, "id", "line");
__publicField(LineController, "defaults", {
  datasetElementType: "line",
  dataElementType: "point",
  showLine: true,
  spanGaps: false
});
__publicField(LineController, "overrides", {
  scales: {
    _index_: {
      type: "category"
    },
    _value_: {
      type: "linear"
    }
  }
});
class PolarAreaController extends DatasetController {
  constructor(chart, datasetIndex) {
    super(chart, datasetIndex);
    this.innerRadius = void 0;
    this.outerRadius = void 0;
  }
  getLabelAndValue(index2) {
    const meta = this._cachedMeta;
    const chart = this.chart;
    const labels = chart.data.labels || [];
    const value = formatNumber(meta._parsed[index2].r, chart.options.locale);
    return {
      label: labels[index2] || "",
      value
    };
  }
  parseObjectData(meta, data, start, count) {
    return _parseObjectDataRadialScale.bind(this)(meta, data, start, count);
  }
  update(mode) {
    const arcs = this._cachedMeta.data;
    this._updateRadius();
    this.updateElements(arcs, 0, arcs.length, mode);
  }
  getMinMax() {
    const meta = this._cachedMeta;
    const range = {
      min: Number.POSITIVE_INFINITY,
      max: Number.NEGATIVE_INFINITY
    };
    meta.data.forEach((element, index2) => {
      const parsed = this.getParsed(index2).r;
      if (!isNaN(parsed) && this.chart.getDataVisibility(index2)) {
        if (parsed < range.min) {
          range.min = parsed;
        }
        if (parsed > range.max) {
          range.max = parsed;
        }
      }
    });
    return range;
  }
  _updateRadius() {
    const chart = this.chart;
    const chartArea = chart.chartArea;
    const opts = chart.options;
    const minSize = Math.min(chartArea.right - chartArea.left, chartArea.bottom - chartArea.top);
    const outerRadius = Math.max(minSize / 2, 0);
    const innerRadius = Math.max(opts.cutoutPercentage ? outerRadius / 100 * opts.cutoutPercentage : 1, 0);
    const radiusLength = (outerRadius - innerRadius) / chart.getVisibleDatasetCount();
    this.outerRadius = outerRadius - radiusLength * this.index;
    this.innerRadius = this.outerRadius - radiusLength;
  }
  updateElements(arcs, start, count, mode) {
    const reset = mode === "reset";
    const chart = this.chart;
    const opts = chart.options;
    const animationOpts = opts.animation;
    const scale = this._cachedMeta.rScale;
    const centerX = scale.xCenter;
    const centerY = scale.yCenter;
    const datasetStartAngle = scale.getIndexAngle(0) - 0.5 * PI;
    let angle = datasetStartAngle;
    let i;
    const defaultAngle = 360 / this.countVisibleElements();
    for (i = 0; i < start; ++i) {
      angle += this._computeAngle(i, mode, defaultAngle);
    }
    for (i = start; i < start + count; i++) {
      const arc = arcs[i];
      let startAngle = angle;
      let endAngle = angle + this._computeAngle(i, mode, defaultAngle);
      let outerRadius = chart.getDataVisibility(i) ? scale.getDistanceFromCenterForValue(this.getParsed(i).r) : 0;
      angle = endAngle;
      if (reset) {
        if (animationOpts.animateScale) {
          outerRadius = 0;
        }
        if (animationOpts.animateRotate) {
          startAngle = endAngle = datasetStartAngle;
        }
      }
      const properties = {
        x: centerX,
        y: centerY,
        innerRadius: 0,
        outerRadius,
        startAngle,
        endAngle,
        options: this.resolveDataElementOptions(i, arc.active ? "active" : mode)
      };
      this.updateElement(arc, i, properties, mode);
    }
  }
  countVisibleElements() {
    const meta = this._cachedMeta;
    let count = 0;
    meta.data.forEach((element, index2) => {
      if (!isNaN(this.getParsed(index2).r) && this.chart.getDataVisibility(index2)) {
        count++;
      }
    });
    return count;
  }
  _computeAngle(index2, mode, defaultAngle) {
    return this.chart.getDataVisibility(index2) ? toRadians(this.resolveDataElementOptions(index2, mode).angle || defaultAngle) : 0;
  }
}
__publicField(PolarAreaController, "id", "polarArea");
__publicField(PolarAreaController, "defaults", {
  dataElementType: "arc",
  animation: {
    animateRotate: true,
    animateScale: true
  },
  animations: {
    numbers: {
      type: "number",
      properties: [
        "x",
        "y",
        "startAngle",
        "endAngle",
        "innerRadius",
        "outerRadius"
      ]
    }
  },
  indexAxis: "r",
  startAngle: 0
});
__publicField(PolarAreaController, "overrides", {
  aspectRatio: 1,
  plugins: {
    legend: {
      labels: {
        generateLabels(chart) {
          const data = chart.data;
          if (data.labels.length && data.datasets.length) {
            const { labels: { pointStyle, color: color2 } } = chart.legend.options;
            return data.labels.map((label, i) => {
              const meta = chart.getDatasetMeta(0);
              const style2 = meta.controller.getStyle(i);
              return {
                text: label,
                fillStyle: style2.backgroundColor,
                strokeStyle: style2.borderColor,
                fontColor: color2,
                lineWidth: style2.borderWidth,
                pointStyle,
                hidden: !chart.getDataVisibility(i),
                index: i
              };
            });
          }
          return [];
        }
      },
      onClick(e, legendItem, legend) {
        legend.chart.toggleDataVisibility(legendItem.index);
        legend.chart.update();
      }
    }
  },
  scales: {
    r: {
      type: "radialLinear",
      angleLines: {
        display: false
      },
      beginAtZero: true,
      grid: {
        circular: true
      },
      pointLabels: {
        display: false
      },
      startAngle: 0
    }
  }
});
class PieController extends DoughnutController {
}
__publicField(PieController, "id", "pie");
__publicField(PieController, "defaults", {
  cutout: 0,
  rotation: 0,
  circumference: 360,
  radius: "100%"
});
class RadarController extends DatasetController {
  getLabelAndValue(index2) {
    const vScale = this._cachedMeta.vScale;
    const parsed = this.getParsed(index2);
    return {
      label: vScale.getLabels()[index2],
      value: "" + vScale.getLabelForValue(parsed[vScale.axis])
    };
  }
  parseObjectData(meta, data, start, count) {
    return _parseObjectDataRadialScale.bind(this)(meta, data, start, count);
  }
  update(mode) {
    const meta = this._cachedMeta;
    const line = meta.dataset;
    const points = meta.data || [];
    const labels = meta.iScale.getLabels();
    line.points = points;
    if (mode !== "resize") {
      const options = this.resolveDatasetElementOptions(mode);
      if (!this.options.showLine) {
        options.borderWidth = 0;
      }
      const properties = {
        _loop: true,
        _fullLoop: labels.length === points.length,
        options
      };
      this.updateElement(line, void 0, properties, mode);
    }
    this.updateElements(points, 0, points.length, mode);
  }
  updateElements(points, start, count, mode) {
    const scale = this._cachedMeta.rScale;
    const reset = mode === "reset";
    for (let i = start; i < start + count; i++) {
      const point = points[i];
      const options = this.resolveDataElementOptions(i, point.active ? "active" : mode);
      const pointPosition = scale.getPointPositionForValue(i, this.getParsed(i).r);
      const x2 = reset ? scale.xCenter : pointPosition.x;
      const y2 = reset ? scale.yCenter : pointPosition.y;
      const properties = {
        x: x2,
        y: y2,
        angle: pointPosition.angle,
        skip: isNaN(x2) || isNaN(y2),
        options
      };
      this.updateElement(point, i, properties, mode);
    }
  }
}
__publicField(RadarController, "id", "radar");
__publicField(RadarController, "defaults", {
  datasetElementType: "line",
  dataElementType: "point",
  indexAxis: "r",
  showLine: true,
  elements: {
    line: {
      fill: "start"
    }
  }
});
__publicField(RadarController, "overrides", {
  aspectRatio: 1,
  scales: {
    r: {
      type: "radialLinear"
    }
  }
});
class ScatterController extends DatasetController {
  getLabelAndValue(index2) {
    const meta = this._cachedMeta;
    const labels = this.chart.data.labels || [];
    const { xScale, yScale } = meta;
    const parsed = this.getParsed(index2);
    const x2 = xScale.getLabelForValue(parsed.x);
    const y2 = yScale.getLabelForValue(parsed.y);
    return {
      label: labels[index2] || "",
      value: "(" + x2 + ", " + y2 + ")"
    };
  }
  update(mode) {
    const meta = this._cachedMeta;
    const { data: points = [] } = meta;
    const animationsDisabled = this.chart._animationsDisabled;
    let { start, count } = _getStartAndCountOfVisiblePoints(meta, points, animationsDisabled);
    this._drawStart = start;
    this._drawCount = count;
    if (_scaleRangesChanged(meta)) {
      start = 0;
      count = points.length;
    }
    if (this.options.showLine) {
      if (!this.datasetElementType) {
        this.addElements();
      }
      const { dataset: line, _dataset } = meta;
      line._chart = this.chart;
      line._datasetIndex = this.index;
      line._decimated = !!_dataset._decimated;
      line.points = points;
      const options = this.resolveDatasetElementOptions(mode);
      options.segment = this.options.segment;
      this.updateElement(line, void 0, {
        animated: !animationsDisabled,
        options
      }, mode);
    } else if (this.datasetElementType) {
      delete meta.dataset;
      this.datasetElementType = false;
    }
    this.updateElements(points, start, count, mode);
  }
  addElements() {
    const { showLine } = this.options;
    if (!this.datasetElementType && showLine) {
      this.datasetElementType = this.chart.registry.getElement("line");
    }
    super.addElements();
  }
  updateElements(points, start, count, mode) {
    const reset = mode === "reset";
    const { iScale, vScale, _stacked, _dataset } = this._cachedMeta;
    const firstOpts = this.resolveDataElementOptions(start, mode);
    const sharedOptions = this.getSharedOptions(firstOpts);
    const includeOptions = this.includeOptions(mode, sharedOptions);
    const iAxis = iScale.axis;
    const vAxis = vScale.axis;
    const { spanGaps, segment } = this.options;
    const maxGapLength = isNumber$1(spanGaps) ? spanGaps : Number.POSITIVE_INFINITY;
    const directUpdate = this.chart._animationsDisabled || reset || mode === "none";
    let prevParsed = start > 0 && this.getParsed(start - 1);
    for (let i = start; i < start + count; ++i) {
      const point = points[i];
      const parsed = this.getParsed(i);
      const properties = directUpdate ? point : {};
      const nullData = isNullOrUndef(parsed[vAxis]);
      const iPixel = properties[iAxis] = iScale.getPixelForValue(parsed[iAxis], i);
      const vPixel = properties[vAxis] = reset || nullData ? vScale.getBasePixel() : vScale.getPixelForValue(_stacked ? this.applyStack(vScale, parsed, _stacked) : parsed[vAxis], i);
      properties.skip = isNaN(iPixel) || isNaN(vPixel) || nullData;
      properties.stop = i > 0 && Math.abs(parsed[iAxis] - prevParsed[iAxis]) > maxGapLength;
      if (segment) {
        properties.parsed = parsed;
        properties.raw = _dataset.data[i];
      }
      if (includeOptions) {
        properties.options = sharedOptions || this.resolveDataElementOptions(i, point.active ? "active" : mode);
      }
      if (!directUpdate) {
        this.updateElement(point, i, properties, mode);
      }
      prevParsed = parsed;
    }
    this.updateSharedOptions(sharedOptions, mode, firstOpts);
  }
  getMaxOverflow() {
    const meta = this._cachedMeta;
    const data = meta.data || [];
    if (!this.options.showLine) {
      let max2 = 0;
      for (let i = data.length - 1; i >= 0; --i) {
        max2 = Math.max(max2, data[i].size(this.resolveDataElementOptions(i)) / 2);
      }
      return max2 > 0 && max2;
    }
    const dataset = meta.dataset;
    const border = dataset.options && dataset.options.borderWidth || 0;
    if (!data.length) {
      return border;
    }
    const firstPoint = data[0].size(this.resolveDataElementOptions(0));
    const lastPoint = data[data.length - 1].size(this.resolveDataElementOptions(data.length - 1));
    return Math.max(border, firstPoint, lastPoint) / 2;
  }
}
__publicField(ScatterController, "id", "scatter");
__publicField(ScatterController, "defaults", {
  datasetElementType: false,
  dataElementType: "point",
  showLine: false,
  fill: false
});
__publicField(ScatterController, "overrides", {
  interaction: {
    mode: "point"
  },
  scales: {
    x: {
      type: "linear"
    },
    y: {
      type: "linear"
    }
  }
});
var controllers = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  BarController,
  BubbleController,
  DoughnutController,
  LineController,
  PieController,
  PolarAreaController,
  RadarController,
  ScatterController
});
function abstract() {
  throw new Error("This method is not implemented: Check that a complete date adapter is provided.");
}
class DateAdapterBase {
  constructor(options) {
    __publicField(this, "options");
    this.options = options || {};
  }
  /**
  * Override default date adapter methods.
  * Accepts type parameter to define options type.
  * @example
  * Chart._adapters._date.override<{myAdapterOption: string}>({
  *   init() {
  *     console.log(this.options.myAdapterOption);
  *   }
  * })
  */
  static override(members) {
    Object.assign(DateAdapterBase.prototype, members);
  }
  // eslint-disable-next-line @typescript-eslint/no-empty-function
  init() {
  }
  formats() {
    return abstract();
  }
  parse() {
    return abstract();
  }
  format() {
    return abstract();
  }
  add() {
    return abstract();
  }
  diff() {
    return abstract();
  }
  startOf() {
    return abstract();
  }
  endOf() {
    return abstract();
  }
}
var adapters = {
  _date: DateAdapterBase
};
function binarySearch(metaset, axis, value, intersect) {
  const { controller, data, _sorted } = metaset;
  const iScale = controller._cachedMeta.iScale;
  if (iScale && axis === iScale.axis && axis !== "r" && _sorted && data.length) {
    const lookupMethod = iScale._reversePixels ? _rlookupByKey : _lookupByKey;
    if (!intersect) {
      return lookupMethod(data, axis, value);
    } else if (controller._sharedOptions) {
      const el2 = data[0];
      const range = typeof el2.getRange === "function" && el2.getRange(axis);
      if (range) {
        const start = lookupMethod(data, axis, value - range);
        const end = lookupMethod(data, axis, value + range);
        return {
          lo: start.lo,
          hi: end.hi
        };
      }
    }
  }
  return {
    lo: 0,
    hi: data.length - 1
  };
}
function evaluateInteractionItems(chart, axis, position, handler, intersect) {
  const metasets = chart.getSortedVisibleDatasetMetas();
  const value = position[axis];
  for (let i = 0, ilen = metasets.length; i < ilen; ++i) {
    const { index: index2, data } = metasets[i];
    const { lo, hi: hi2 } = binarySearch(metasets[i], axis, value, intersect);
    for (let j = lo; j <= hi2; ++j) {
      const element = data[j];
      if (!element.skip) {
        handler(element, index2, j);
      }
    }
  }
}
function getDistanceMetricForAxis(axis) {
  const useX = axis.indexOf("x") !== -1;
  const useY = axis.indexOf("y") !== -1;
  return function(pt1, pt2) {
    const deltaX = useX ? Math.abs(pt1.x - pt2.x) : 0;
    const deltaY = useY ? Math.abs(pt1.y - pt2.y) : 0;
    return Math.sqrt(Math.pow(deltaX, 2) + Math.pow(deltaY, 2));
  };
}
function getIntersectItems(chart, position, axis, useFinalPosition, includeInvisible) {
  const items = [];
  if (!includeInvisible && !chart.isPointInArea(position)) {
    return items;
  }
  const evaluationFunc = function(element, datasetIndex, index2) {
    if (!includeInvisible && !_isPointInArea(element, chart.chartArea, 0)) {
      return;
    }
    if (element.inRange(position.x, position.y, useFinalPosition)) {
      items.push({
        element,
        datasetIndex,
        index: index2
      });
    }
  };
  evaluateInteractionItems(chart, axis, position, evaluationFunc, true);
  return items;
}
function getNearestRadialItems(chart, position, axis, useFinalPosition) {
  let items = [];
  function evaluationFunc(element, datasetIndex, index2) {
    const { startAngle, endAngle } = element.getProps([
      "startAngle",
      "endAngle"
    ], useFinalPosition);
    const { angle } = getAngleFromPoint(element, {
      x: position.x,
      y: position.y
    });
    if (_angleBetween(angle, startAngle, endAngle)) {
      items.push({
        element,
        datasetIndex,
        index: index2
      });
    }
  }
  evaluateInteractionItems(chart, axis, position, evaluationFunc);
  return items;
}
function getNearestCartesianItems(chart, position, axis, intersect, useFinalPosition, includeInvisible) {
  let items = [];
  const distanceMetric = getDistanceMetricForAxis(axis);
  let minDistance = Number.POSITIVE_INFINITY;
  function evaluationFunc(element, datasetIndex, index2) {
    const inRange2 = element.inRange(position.x, position.y, useFinalPosition);
    if (intersect && !inRange2) {
      return;
    }
    const center = element.getCenterPoint(useFinalPosition);
    const pointInArea = !!includeInvisible || chart.isPointInArea(center);
    if (!pointInArea && !inRange2) {
      return;
    }
    const distance = distanceMetric(position, center);
    if (distance < minDistance) {
      items = [
        {
          element,
          datasetIndex,
          index: index2
        }
      ];
      minDistance = distance;
    } else if (distance === minDistance) {
      items.push({
        element,
        datasetIndex,
        index: index2
      });
    }
  }
  evaluateInteractionItems(chart, axis, position, evaluationFunc);
  return items;
}
function getNearestItems(chart, position, axis, intersect, useFinalPosition, includeInvisible) {
  if (!includeInvisible && !chart.isPointInArea(position)) {
    return [];
  }
  return axis === "r" && !intersect ? getNearestRadialItems(chart, position, axis, useFinalPosition) : getNearestCartesianItems(chart, position, axis, intersect, useFinalPosition, includeInvisible);
}
function getAxisItems(chart, position, axis, intersect, useFinalPosition) {
  const items = [];
  const rangeMethod = axis === "x" ? "inXRange" : "inYRange";
  let intersectsItem = false;
  evaluateInteractionItems(chart, axis, position, (element, datasetIndex, index2) => {
    if (element[rangeMethod](position[axis], useFinalPosition)) {
      items.push({
        element,
        datasetIndex,
        index: index2
      });
      intersectsItem = intersectsItem || element.inRange(position.x, position.y, useFinalPosition);
    }
  });
  if (intersect && !intersectsItem) {
    return [];
  }
  return items;
}
var Interaction = {
  evaluateInteractionItems,
  modes: {
    index(chart, e, options, useFinalPosition) {
      const position = getRelativePosition(e, chart);
      const axis = options.axis || "x";
      const includeInvisible = options.includeInvisible || false;
      const items = options.intersect ? getIntersectItems(chart, position, axis, useFinalPosition, includeInvisible) : getNearestItems(chart, position, axis, false, useFinalPosition, includeInvisible);
      const elements2 = [];
      if (!items.length) {
        return [];
      }
      chart.getSortedVisibleDatasetMetas().forEach((meta) => {
        const index2 = items[0].index;
        const element = meta.data[index2];
        if (element && !element.skip) {
          elements2.push({
            element,
            datasetIndex: meta.index,
            index: index2
          });
        }
      });
      return elements2;
    },
    dataset(chart, e, options, useFinalPosition) {
      const position = getRelativePosition(e, chart);
      const axis = options.axis || "xy";
      const includeInvisible = options.includeInvisible || false;
      let items = options.intersect ? getIntersectItems(chart, position, axis, useFinalPosition, includeInvisible) : getNearestItems(chart, position, axis, false, useFinalPosition, includeInvisible);
      if (items.length > 0) {
        const datasetIndex = items[0].datasetIndex;
        const data = chart.getDatasetMeta(datasetIndex).data;
        items = [];
        for (let i = 0; i < data.length; ++i) {
          items.push({
            element: data[i],
            datasetIndex,
            index: i
          });
        }
      }
      return items;
    },
    point(chart, e, options, useFinalPosition) {
      const position = getRelativePosition(e, chart);
      const axis = options.axis || "xy";
      const includeInvisible = options.includeInvisible || false;
      return getIntersectItems(chart, position, axis, useFinalPosition, includeInvisible);
    },
    nearest(chart, e, options, useFinalPosition) {
      const position = getRelativePosition(e, chart);
      const axis = options.axis || "xy";
      const includeInvisible = options.includeInvisible || false;
      return getNearestItems(chart, position, axis, options.intersect, useFinalPosition, includeInvisible);
    },
    x(chart, e, options, useFinalPosition) {
      const position = getRelativePosition(e, chart);
      return getAxisItems(chart, position, "x", options.intersect, useFinalPosition);
    },
    y(chart, e, options, useFinalPosition) {
      const position = getRelativePosition(e, chart);
      return getAxisItems(chart, position, "y", options.intersect, useFinalPosition);
    }
  }
};
const STATIC_POSITIONS = [
  "left",
  "top",
  "right",
  "bottom"
];
function filterByPosition(array, position) {
  return array.filter((v2) => v2.pos === position);
}
function filterDynamicPositionByAxis(array, axis) {
  return array.filter((v2) => STATIC_POSITIONS.indexOf(v2.pos) === -1 && v2.box.axis === axis);
}
function sortByWeight(array, reverse) {
  return array.sort((a, b) => {
    const v0 = reverse ? b : a;
    const v1 = reverse ? a : b;
    return v0.weight === v1.weight ? v0.index - v1.index : v0.weight - v1.weight;
  });
}
function wrapBoxes(boxes) {
  const layoutBoxes = [];
  let i, ilen, box, pos, stack, stackWeight;
  for (i = 0, ilen = (boxes || []).length; i < ilen; ++i) {
    box = boxes[i];
    ({ position: pos, options: { stack, stackWeight = 1 } } = box);
    layoutBoxes.push({
      index: i,
      box,
      pos,
      horizontal: box.isHorizontal(),
      weight: box.weight,
      stack: stack && pos + stack,
      stackWeight
    });
  }
  return layoutBoxes;
}
function buildStacks(layouts2) {
  const stacks = {};
  for (const wrap of layouts2) {
    const { stack, pos, stackWeight } = wrap;
    if (!stack || !STATIC_POSITIONS.includes(pos)) {
      continue;
    }
    const _stack = stacks[stack] || (stacks[stack] = {
      count: 0,
      placed: 0,
      weight: 0,
      size: 0
    });
    _stack.count++;
    _stack.weight += stackWeight;
  }
  return stacks;
}
function setLayoutDims(layouts2, params) {
  const stacks = buildStacks(layouts2);
  const { vBoxMaxWidth, hBoxMaxHeight } = params;
  let i, ilen, layout;
  for (i = 0, ilen = layouts2.length; i < ilen; ++i) {
    layout = layouts2[i];
    const { fullSize } = layout.box;
    const stack = stacks[layout.stack];
    const factor = stack && layout.stackWeight / stack.weight;
    if (layout.horizontal) {
      layout.width = factor ? factor * vBoxMaxWidth : fullSize && params.availableWidth;
      layout.height = hBoxMaxHeight;
    } else {
      layout.width = vBoxMaxWidth;
      layout.height = factor ? factor * hBoxMaxHeight : fullSize && params.availableHeight;
    }
  }
  return stacks;
}
function buildLayoutBoxes(boxes) {
  const layoutBoxes = wrapBoxes(boxes);
  const fullSize = sortByWeight(layoutBoxes.filter((wrap) => wrap.box.fullSize), true);
  const left = sortByWeight(filterByPosition(layoutBoxes, "left"), true);
  const right = sortByWeight(filterByPosition(layoutBoxes, "right"));
  const top = sortByWeight(filterByPosition(layoutBoxes, "top"), true);
  const bottom = sortByWeight(filterByPosition(layoutBoxes, "bottom"));
  const centerHorizontal = filterDynamicPositionByAxis(layoutBoxes, "x");
  const centerVertical = filterDynamicPositionByAxis(layoutBoxes, "y");
  return {
    fullSize,
    leftAndTop: left.concat(top),
    rightAndBottom: right.concat(centerVertical).concat(bottom).concat(centerHorizontal),
    chartArea: filterByPosition(layoutBoxes, "chartArea"),
    vertical: left.concat(right).concat(centerVertical),
    horizontal: top.concat(bottom).concat(centerHorizontal)
  };
}
function getCombinedMax(maxPadding, chartArea, a, b) {
  return Math.max(maxPadding[a], chartArea[a]) + Math.max(maxPadding[b], chartArea[b]);
}
function updateMaxPadding(maxPadding, boxPadding) {
  maxPadding.top = Math.max(maxPadding.top, boxPadding.top);
  maxPadding.left = Math.max(maxPadding.left, boxPadding.left);
  maxPadding.bottom = Math.max(maxPadding.bottom, boxPadding.bottom);
  maxPadding.right = Math.max(maxPadding.right, boxPadding.right);
}
function updateDims(chartArea, params, layout, stacks) {
  const { pos, box } = layout;
  const maxPadding = chartArea.maxPadding;
  if (!isObject$1(pos)) {
    if (layout.size) {
      chartArea[pos] -= layout.size;
    }
    const stack = stacks[layout.stack] || {
      size: 0,
      count: 1
    };
    stack.size = Math.max(stack.size, layout.horizontal ? box.height : box.width);
    layout.size = stack.size / stack.count;
    chartArea[pos] += layout.size;
  }
  if (box.getPadding) {
    updateMaxPadding(maxPadding, box.getPadding());
  }
  const newWidth = Math.max(0, params.outerWidth - getCombinedMax(maxPadding, chartArea, "left", "right"));
  const newHeight = Math.max(0, params.outerHeight - getCombinedMax(maxPadding, chartArea, "top", "bottom"));
  const widthChanged = newWidth !== chartArea.w;
  const heightChanged = newHeight !== chartArea.h;
  chartArea.w = newWidth;
  chartArea.h = newHeight;
  return layout.horizontal ? {
    same: widthChanged,
    other: heightChanged
  } : {
    same: heightChanged,
    other: widthChanged
  };
}
function handleMaxPadding(chartArea) {
  const maxPadding = chartArea.maxPadding;
  function updatePos(pos) {
    const change = Math.max(maxPadding[pos] - chartArea[pos], 0);
    chartArea[pos] += change;
    return change;
  }
  chartArea.y += updatePos("top");
  chartArea.x += updatePos("left");
  updatePos("right");
  updatePos("bottom");
}
function getMargins(horizontal, chartArea) {
  const maxPadding = chartArea.maxPadding;
  function marginForPositions(positions2) {
    const margin = {
      left: 0,
      top: 0,
      right: 0,
      bottom: 0
    };
    positions2.forEach((pos) => {
      margin[pos] = Math.max(chartArea[pos], maxPadding[pos]);
    });
    return margin;
  }
  return horizontal ? marginForPositions([
    "left",
    "right"
  ]) : marginForPositions([
    "top",
    "bottom"
  ]);
}
function fitBoxes(boxes, chartArea, params, stacks) {
  const refitBoxes = [];
  let i, ilen, layout, box, refit, changed;
  for (i = 0, ilen = boxes.length, refit = 0; i < ilen; ++i) {
    layout = boxes[i];
    box = layout.box;
    box.update(layout.width || chartArea.w, layout.height || chartArea.h, getMargins(layout.horizontal, chartArea));
    const { same, other } = updateDims(chartArea, params, layout, stacks);
    refit |= same && refitBoxes.length;
    changed = changed || other;
    if (!box.fullSize) {
      refitBoxes.push(layout);
    }
  }
  return refit && fitBoxes(refitBoxes, chartArea, params, stacks) || changed;
}
function setBoxDims(box, left, top, width, height) {
  box.top = top;
  box.left = left;
  box.right = left + width;
  box.bottom = top + height;
  box.width = width;
  box.height = height;
}
function placeBoxes(boxes, chartArea, params, stacks) {
  const userPadding = params.padding;
  let { x: x2, y: y2 } = chartArea;
  for (const layout of boxes) {
    const box = layout.box;
    const stack = stacks[layout.stack] || {
      count: 1,
      placed: 0,
      weight: 1
    };
    const weight = layout.stackWeight / stack.weight || 1;
    if (layout.horizontal) {
      const width = chartArea.w * weight;
      const height = stack.size || box.height;
      if (defined(stack.start)) {
        y2 = stack.start;
      }
      if (box.fullSize) {
        setBoxDims(box, userPadding.left, y2, params.outerWidth - userPadding.right - userPadding.left, height);
      } else {
        setBoxDims(box, chartArea.left + stack.placed, y2, width, height);
      }
      stack.start = y2;
      stack.placed += width;
      y2 = box.bottom;
    } else {
      const height = chartArea.h * weight;
      const width = stack.size || box.width;
      if (defined(stack.start)) {
        x2 = stack.start;
      }
      if (box.fullSize) {
        setBoxDims(box, x2, userPadding.top, width, params.outerHeight - userPadding.bottom - userPadding.top);
      } else {
        setBoxDims(box, x2, chartArea.top + stack.placed, width, height);
      }
      stack.start = x2;
      stack.placed += height;
      x2 = box.right;
    }
  }
  chartArea.x = x2;
  chartArea.y = y2;
}
var layouts = {
  addBox(chart, item) {
    if (!chart.boxes) {
      chart.boxes = [];
    }
    item.fullSize = item.fullSize || false;
    item.position = item.position || "top";
    item.weight = item.weight || 0;
    item._layers = item._layers || function() {
      return [
        {
          z: 0,
          draw(chartArea) {
            item.draw(chartArea);
          }
        }
      ];
    };
    chart.boxes.push(item);
  },
  removeBox(chart, layoutItem) {
    const index2 = chart.boxes ? chart.boxes.indexOf(layoutItem) : -1;
    if (index2 !== -1) {
      chart.boxes.splice(index2, 1);
    }
  },
  configure(chart, item, options) {
    item.fullSize = options.fullSize;
    item.position = options.position;
    item.weight = options.weight;
  },
  update(chart, width, height, minPadding) {
    if (!chart) {
      return;
    }
    const padding = toPadding(chart.options.layout.padding);
    const availableWidth = Math.max(width - padding.width, 0);
    const availableHeight = Math.max(height - padding.height, 0);
    const boxes = buildLayoutBoxes(chart.boxes);
    const verticalBoxes = boxes.vertical;
    const horizontalBoxes = boxes.horizontal;
    each(chart.boxes, (box) => {
      if (typeof box.beforeLayout === "function") {
        box.beforeLayout();
      }
    });
    const visibleVerticalBoxCount = verticalBoxes.reduce((total, wrap) => wrap.box.options && wrap.box.options.display === false ? total : total + 1, 0) || 1;
    const params = Object.freeze({
      outerWidth: width,
      outerHeight: height,
      padding,
      availableWidth,
      availableHeight,
      vBoxMaxWidth: availableWidth / 2 / visibleVerticalBoxCount,
      hBoxMaxHeight: availableHeight / 2
    });
    const maxPadding = Object.assign({}, padding);
    updateMaxPadding(maxPadding, toPadding(minPadding));
    const chartArea = Object.assign({
      maxPadding,
      w: availableWidth,
      h: availableHeight,
      x: padding.left,
      y: padding.top
    }, padding);
    const stacks = setLayoutDims(verticalBoxes.concat(horizontalBoxes), params);
    fitBoxes(boxes.fullSize, chartArea, params, stacks);
    fitBoxes(verticalBoxes, chartArea, params, stacks);
    if (fitBoxes(horizontalBoxes, chartArea, params, stacks)) {
      fitBoxes(verticalBoxes, chartArea, params, stacks);
    }
    handleMaxPadding(chartArea);
    placeBoxes(boxes.leftAndTop, chartArea, params, stacks);
    chartArea.x += chartArea.w;
    chartArea.y += chartArea.h;
    placeBoxes(boxes.rightAndBottom, chartArea, params, stacks);
    chart.chartArea = {
      left: chartArea.left,
      top: chartArea.top,
      right: chartArea.left + chartArea.w,
      bottom: chartArea.top + chartArea.h,
      height: chartArea.h,
      width: chartArea.w
    };
    each(boxes.chartArea, (layout) => {
      const box = layout.box;
      Object.assign(box, chart.chartArea);
      box.update(chartArea.w, chartArea.h, {
        left: 0,
        top: 0,
        right: 0,
        bottom: 0
      });
    });
  }
};
class BasePlatform {
  acquireContext(canvas, aspectRatio) {
  }
  releaseContext(context) {
    return false;
  }
  addEventListener(chart, type, listener) {
  }
  removeEventListener(chart, type, listener) {
  }
  getDevicePixelRatio() {
    return 1;
  }
  getMaximumSize(element, width, height, aspectRatio) {
    width = Math.max(0, width || element.width);
    height = height || element.height;
    return {
      width,
      height: Math.max(0, aspectRatio ? Math.floor(width / aspectRatio) : height)
    };
  }
  isAttached(canvas) {
    return true;
  }
  updateConfig(config) {
  }
}
class BasicPlatform extends BasePlatform {
  acquireContext(item) {
    return item && item.getContext && item.getContext("2d") || null;
  }
  updateConfig(config) {
    config.options.animation = false;
  }
}
const EXPANDO_KEY = "$chartjs";
const EVENT_TYPES = {
  touchstart: "mousedown",
  touchmove: "mousemove",
  touchend: "mouseup",
  pointerenter: "mouseenter",
  pointerdown: "mousedown",
  pointermove: "mousemove",
  pointerup: "mouseup",
  pointerleave: "mouseout",
  pointerout: "mouseout"
};
const isNullOrEmpty = (value) => value === null || value === "";
function initCanvas(canvas, aspectRatio) {
  const style2 = canvas.style;
  const renderHeight = canvas.getAttribute("height");
  const renderWidth = canvas.getAttribute("width");
  canvas[EXPANDO_KEY] = {
    initial: {
      height: renderHeight,
      width: renderWidth,
      style: {
        display: style2.display,
        height: style2.height,
        width: style2.width
      }
    }
  };
  style2.display = style2.display || "block";
  style2.boxSizing = style2.boxSizing || "border-box";
  if (isNullOrEmpty(renderWidth)) {
    const displayWidth = readUsedSize(canvas, "width");
    if (displayWidth !== void 0) {
      canvas.width = displayWidth;
    }
  }
  if (isNullOrEmpty(renderHeight)) {
    if (canvas.style.height === "") {
      canvas.height = canvas.width / (aspectRatio || 2);
    } else {
      const displayHeight = readUsedSize(canvas, "height");
      if (displayHeight !== void 0) {
        canvas.height = displayHeight;
      }
    }
  }
  return canvas;
}
const eventListenerOptions = supportsEventListenerOptions ? {
  passive: true
} : false;
function addListener2(node, type, listener) {
  node.addEventListener(type, listener, eventListenerOptions);
}
function removeListener2(chart, type, listener) {
  chart.canvas.removeEventListener(type, listener, eventListenerOptions);
}
function fromNativeEvent(event, chart) {
  const type = EVENT_TYPES[event.type] || event.type;
  const { x: x2, y: y2 } = getRelativePosition(event, chart);
  return {
    type,
    chart,
    native: event,
    x: x2 !== void 0 ? x2 : null,
    y: y2 !== void 0 ? y2 : null
  };
}
function nodeListContains(nodeList, canvas) {
  for (const node of nodeList) {
    if (node === canvas || node.contains(canvas)) {
      return true;
    }
  }
}
function createAttachObserver(chart, type, listener) {
  const canvas = chart.canvas;
  const observer = new MutationObserver((entries) => {
    let trigger = false;
    for (const entry of entries) {
      trigger = trigger || nodeListContains(entry.addedNodes, canvas);
      trigger = trigger && !nodeListContains(entry.removedNodes, canvas);
    }
    if (trigger) {
      listener();
    }
  });
  observer.observe(document, {
    childList: true,
    subtree: true
  });
  return observer;
}
function createDetachObserver(chart, type, listener) {
  const canvas = chart.canvas;
  const observer = new MutationObserver((entries) => {
    let trigger = false;
    for (const entry of entries) {
      trigger = trigger || nodeListContains(entry.removedNodes, canvas);
      trigger = trigger && !nodeListContains(entry.addedNodes, canvas);
    }
    if (trigger) {
      listener();
    }
  });
  observer.observe(document, {
    childList: true,
    subtree: true
  });
  return observer;
}
const drpListeningCharts = /* @__PURE__ */ new Map();
let oldDevicePixelRatio = 0;
function onWindowResize() {
  const dpr = window.devicePixelRatio;
  if (dpr === oldDevicePixelRatio) {
    return;
  }
  oldDevicePixelRatio = dpr;
  drpListeningCharts.forEach((resize, chart) => {
    if (chart.currentDevicePixelRatio !== dpr) {
      resize();
    }
  });
}
function listenDevicePixelRatioChanges(chart, resize) {
  if (!drpListeningCharts.size) {
    window.addEventListener("resize", onWindowResize);
  }
  drpListeningCharts.set(chart, resize);
}
function unlistenDevicePixelRatioChanges(chart) {
  drpListeningCharts.delete(chart);
  if (!drpListeningCharts.size) {
    window.removeEventListener("resize", onWindowResize);
  }
}
function createResizeObserver(chart, type, listener) {
  const canvas = chart.canvas;
  const container = canvas && _getParentNode(canvas);
  if (!container) {
    return;
  }
  const resize = throttled((width, height) => {
    const w2 = container.clientWidth;
    listener(width, height);
    if (w2 < container.clientWidth) {
      listener();
    }
  }, window);
  const observer = new ResizeObserver((entries) => {
    const entry = entries[0];
    const width = entry.contentRect.width;
    const height = entry.contentRect.height;
    if (width === 0 && height === 0) {
      return;
    }
    resize(width, height);
  });
  observer.observe(container);
  listenDevicePixelRatioChanges(chart, resize);
  return observer;
}
function releaseObserver(chart, type, observer) {
  if (observer) {
    observer.disconnect();
  }
  if (type === "resize") {
    unlistenDevicePixelRatioChanges(chart);
  }
}
function createProxyAndListen(chart, type, listener) {
  const canvas = chart.canvas;
  const proxy = throttled((event) => {
    if (chart.ctx !== null) {
      listener(fromNativeEvent(event, chart));
    }
  }, chart);
  addListener2(canvas, type, proxy);
  return proxy;
}
class DomPlatform extends BasePlatform {
  acquireContext(canvas, aspectRatio) {
    const context = canvas && canvas.getContext && canvas.getContext("2d");
    if (context && context.canvas === canvas) {
      initCanvas(canvas, aspectRatio);
      return context;
    }
    return null;
  }
  releaseContext(context) {
    const canvas = context.canvas;
    if (!canvas[EXPANDO_KEY]) {
      return false;
    }
    const initial = canvas[EXPANDO_KEY].initial;
    [
      "height",
      "width"
    ].forEach((prop) => {
      const value = initial[prop];
      if (isNullOrUndef(value)) {
        canvas.removeAttribute(prop);
      } else {
        canvas.setAttribute(prop, value);
      }
    });
    const style2 = initial.style || {};
    Object.keys(style2).forEach((key) => {
      canvas.style[key] = style2[key];
    });
    canvas.width = canvas.width;
    delete canvas[EXPANDO_KEY];
    return true;
  }
  addEventListener(chart, type, listener) {
    this.removeEventListener(chart, type);
    const proxies = chart.$proxies || (chart.$proxies = {});
    const handlers = {
      attach: createAttachObserver,
      detach: createDetachObserver,
      resize: createResizeObserver
    };
    const handler = handlers[type] || createProxyAndListen;
    proxies[type] = handler(chart, type, listener);
  }
  removeEventListener(chart, type) {
    const proxies = chart.$proxies || (chart.$proxies = {});
    const proxy = proxies[type];
    if (!proxy) {
      return;
    }
    const handlers = {
      attach: releaseObserver,
      detach: releaseObserver,
      resize: releaseObserver
    };
    const handler = handlers[type] || removeListener2;
    handler(chart, type, proxy);
    proxies[type] = void 0;
  }
  getDevicePixelRatio() {
    return window.devicePixelRatio;
  }
  getMaximumSize(canvas, width, height, aspectRatio) {
    return getMaximumSize(canvas, width, height, aspectRatio);
  }
  isAttached(canvas) {
    const container = _getParentNode(canvas);
    return !!(container && container.isConnected);
  }
}
function _detectPlatform(canvas) {
  if (!_isDomSupported() || typeof OffscreenCanvas !== "undefined" && canvas instanceof OffscreenCanvas) {
    return BasicPlatform;
  }
  return DomPlatform;
}
let Element$1 = (_a = class {
  constructor() {
    __publicField(this, "x");
    __publicField(this, "y");
    __publicField(this, "active", false);
    __publicField(this, "options");
    __publicField(this, "$animations");
  }
  tooltipPosition(useFinalPosition) {
    const { x: x2, y: y2 } = this.getProps([
      "x",
      "y"
    ], useFinalPosition);
    return {
      x: x2,
      y: y2
    };
  }
  hasValue() {
    return isNumber$1(this.x) && isNumber$1(this.y);
  }
  getProps(props, final) {
    const anims = this.$animations;
    if (!final || !anims) {
      return this;
    }
    const ret = {};
    props.forEach((prop) => {
      ret[prop] = anims[prop] && anims[prop].active() ? anims[prop]._to : this[prop];
    });
    return ret;
  }
}, __publicField(_a, "defaults", {}), __publicField(_a, "defaultRoutes"), _a);
function autoSkip(scale, ticks) {
  const tickOpts = scale.options.ticks;
  const determinedMaxTicks = determineMaxTicks(scale);
  const ticksLimit = Math.min(tickOpts.maxTicksLimit || determinedMaxTicks, determinedMaxTicks);
  const majorIndices = tickOpts.major.enabled ? getMajorIndices(ticks) : [];
  const numMajorIndices = majorIndices.length;
  const first = majorIndices[0];
  const last2 = majorIndices[numMajorIndices - 1];
  const newTicks = [];
  if (numMajorIndices > ticksLimit) {
    skipMajors(ticks, newTicks, majorIndices, numMajorIndices / ticksLimit);
    return newTicks;
  }
  const spacing = calculateSpacing(majorIndices, ticks, ticksLimit);
  if (numMajorIndices > 0) {
    let i, ilen;
    const avgMajorSpacing = numMajorIndices > 1 ? Math.round((last2 - first) / (numMajorIndices - 1)) : null;
    skip(ticks, newTicks, spacing, isNullOrUndef(avgMajorSpacing) ? 0 : first - avgMajorSpacing, first);
    for (i = 0, ilen = numMajorIndices - 1; i < ilen; i++) {
      skip(ticks, newTicks, spacing, majorIndices[i], majorIndices[i + 1]);
    }
    skip(ticks, newTicks, spacing, last2, isNullOrUndef(avgMajorSpacing) ? ticks.length : last2 + avgMajorSpacing);
    return newTicks;
  }
  skip(ticks, newTicks, spacing);
  return newTicks;
}
function determineMaxTicks(scale) {
  const offset2 = scale.options.offset;
  const tickLength = scale._tickSize();
  const maxScale = scale._length / tickLength + (offset2 ? 0 : 1);
  const maxChart = scale._maxLength / tickLength;
  return Math.floor(Math.min(maxScale, maxChart));
}
function calculateSpacing(majorIndices, ticks, ticksLimit) {
  const evenMajorSpacing = getEvenSpacing(majorIndices);
  const spacing = ticks.length / ticksLimit;
  if (!evenMajorSpacing) {
    return Math.max(spacing, 1);
  }
  const factors = _factorize(evenMajorSpacing);
  for (let i = 0, ilen = factors.length - 1; i < ilen; i++) {
    const factor = factors[i];
    if (factor > spacing) {
      return factor;
    }
  }
  return Math.max(spacing, 1);
}
function getMajorIndices(ticks) {
  const result = [];
  let i, ilen;
  for (i = 0, ilen = ticks.length; i < ilen; i++) {
    if (ticks[i].major) {
      result.push(i);
    }
  }
  return result;
}
function skipMajors(ticks, newTicks, majorIndices, spacing) {
  let count = 0;
  let next = majorIndices[0];
  let i;
  spacing = Math.ceil(spacing);
  for (i = 0; i < ticks.length; i++) {
    if (i === next) {
      newTicks.push(ticks[i]);
      count++;
      next = majorIndices[count * spacing];
    }
  }
}
function skip(ticks, newTicks, spacing, majorStart, majorEnd) {
  const start = valueOrDefault(majorStart, 0);
  const end = Math.min(valueOrDefault(majorEnd, ticks.length), ticks.length);
  let count = 0;
  let length, i, next;
  spacing = Math.ceil(spacing);
  if (majorEnd) {
    length = majorEnd - majorStart;
    spacing = length / Math.floor(length / spacing);
  }
  next = start;
  while (next < 0) {
    count++;
    next = Math.round(start + count * spacing);
  }
  for (i = Math.max(start, 0); i < end; i++) {
    if (i === next) {
      newTicks.push(ticks[i]);
      count++;
      next = Math.round(start + count * spacing);
    }
  }
}
function getEvenSpacing(arr) {
  const len = arr.length;
  let i, diff2;
  if (len < 2) {
    return false;
  }
  for (diff2 = arr[0], i = 1; i < len; ++i) {
    if (arr[i] - arr[i - 1] !== diff2) {
      return false;
    }
  }
  return diff2;
}
const reverseAlign = (align) => align === "left" ? "right" : align === "right" ? "left" : align;
const offsetFromEdge = (scale, edge, offset2) => edge === "top" || edge === "left" ? scale[edge] + offset2 : scale[edge] - offset2;
const getTicksLimit = (ticksLength, maxTicksLimit) => Math.min(maxTicksLimit || ticksLength, ticksLength);
function sample(arr, numItems) {
  const result = [];
  const increment = arr.length / numItems;
  const len = arr.length;
  let i = 0;
  for (; i < len; i += increment) {
    result.push(arr[Math.floor(i)]);
  }
  return result;
}
function getPixelForGridLine(scale, index2, offsetGridLines) {
  const length = scale.ticks.length;
  const validIndex2 = Math.min(index2, length - 1);
  const start = scale._startPixel;
  const end = scale._endPixel;
  const epsilon = 1e-6;
  let lineValue = scale.getPixelForTick(validIndex2);
  let offset2;
  if (offsetGridLines) {
    if (length === 1) {
      offset2 = Math.max(lineValue - start, end - lineValue);
    } else if (index2 === 0) {
      offset2 = (scale.getPixelForTick(1) - lineValue) / 2;
    } else {
      offset2 = (lineValue - scale.getPixelForTick(validIndex2 - 1)) / 2;
    }
    lineValue += validIndex2 < index2 ? offset2 : -offset2;
    if (lineValue < start - epsilon || lineValue > end + epsilon) {
      return;
    }
  }
  return lineValue;
}
function garbageCollect(caches, length) {
  each(caches, (cache) => {
    const gc2 = cache.gc;
    const gcLen = gc2.length / 2;
    let i;
    if (gcLen > length) {
      for (i = 0; i < gcLen; ++i) {
        delete cache.data[gc2[i]];
      }
      gc2.splice(0, gcLen);
    }
  });
}
function getTickMarkLength(options) {
  return options.drawTicks ? options.tickLength : 0;
}
function getTitleHeight(options, fallback) {
  if (!options.display) {
    return 0;
  }
  const font = toFont(options.font, fallback);
  const padding = toPadding(options.padding);
  const lines = isArray$1(options.text) ? options.text.length : 1;
  return lines * font.lineHeight + padding.height;
}
function createScaleContext(parent, scale) {
  return createContext(parent, {
    scale,
    type: "scale"
  });
}
function createTickContext(parent, index2, tick) {
  return createContext(parent, {
    tick,
    index: index2,
    type: "tick"
  });
}
function titleAlign(align, position, reverse) {
  let ret = _toLeftRightCenter(align);
  if (reverse && position !== "right" || !reverse && position === "right") {
    ret = reverseAlign(ret);
  }
  return ret;
}
function titleArgs(scale, offset2, position, align) {
  const { top, left, bottom, right, chart } = scale;
  const { chartArea, scales: scales2 } = chart;
  let rotation = 0;
  let maxWidth, titleX, titleY;
  const height = bottom - top;
  const width = right - left;
  if (scale.isHorizontal()) {
    titleX = _alignStartEnd(align, left, right);
    if (isObject$1(position)) {
      const positionAxisID = Object.keys(position)[0];
      const value = position[positionAxisID];
      titleY = scales2[positionAxisID].getPixelForValue(value) + height - offset2;
    } else if (position === "center") {
      titleY = (chartArea.bottom + chartArea.top) / 2 + height - offset2;
    } else {
      titleY = offsetFromEdge(scale, position, offset2);
    }
    maxWidth = right - left;
  } else {
    if (isObject$1(position)) {
      const positionAxisID = Object.keys(position)[0];
      const value = position[positionAxisID];
      titleX = scales2[positionAxisID].getPixelForValue(value) - width + offset2;
    } else if (position === "center") {
      titleX = (chartArea.left + chartArea.right) / 2 - width + offset2;
    } else {
      titleX = offsetFromEdge(scale, position, offset2);
    }
    titleY = _alignStartEnd(align, bottom, top);
    rotation = position === "left" ? -HALF_PI : HALF_PI;
  }
  return {
    titleX,
    titleY,
    maxWidth,
    rotation
  };
}
class Scale extends Element$1 {
  constructor(cfg) {
    super();
    this.id = cfg.id;
    this.type = cfg.type;
    this.options = void 0;
    this.ctx = cfg.ctx;
    this.chart = cfg.chart;
    this.top = void 0;
    this.bottom = void 0;
    this.left = void 0;
    this.right = void 0;
    this.width = void 0;
    this.height = void 0;
    this._margins = {
      left: 0,
      right: 0,
      top: 0,
      bottom: 0
    };
    this.maxWidth = void 0;
    this.maxHeight = void 0;
    this.paddingTop = void 0;
    this.paddingBottom = void 0;
    this.paddingLeft = void 0;
    this.paddingRight = void 0;
    this.axis = void 0;
    this.labelRotation = void 0;
    this.min = void 0;
    this.max = void 0;
    this._range = void 0;
    this.ticks = [];
    this._gridLineItems = null;
    this._labelItems = null;
    this._labelSizes = null;
    this._length = 0;
    this._maxLength = 0;
    this._longestTextCache = {};
    this._startPixel = void 0;
    this._endPixel = void 0;
    this._reversePixels = false;
    this._userMax = void 0;
    this._userMin = void 0;
    this._suggestedMax = void 0;
    this._suggestedMin = void 0;
    this._ticksLength = 0;
    this._borderValue = 0;
    this._cache = {};
    this._dataLimitsCached = false;
    this.$context = void 0;
  }
  init(options) {
    this.options = options.setContext(this.getContext());
    this.axis = options.axis;
    this._userMin = this.parse(options.min);
    this._userMax = this.parse(options.max);
    this._suggestedMin = this.parse(options.suggestedMin);
    this._suggestedMax = this.parse(options.suggestedMax);
  }
  parse(raw, index2) {
    return raw;
  }
  getUserBounds() {
    let { _userMin, _userMax, _suggestedMin, _suggestedMax } = this;
    _userMin = finiteOrDefault(_userMin, Number.POSITIVE_INFINITY);
    _userMax = finiteOrDefault(_userMax, Number.NEGATIVE_INFINITY);
    _suggestedMin = finiteOrDefault(_suggestedMin, Number.POSITIVE_INFINITY);
    _suggestedMax = finiteOrDefault(_suggestedMax, Number.NEGATIVE_INFINITY);
    return {
      min: finiteOrDefault(_userMin, _suggestedMin),
      max: finiteOrDefault(_userMax, _suggestedMax),
      minDefined: isNumberFinite(_userMin),
      maxDefined: isNumberFinite(_userMax)
    };
  }
  getMinMax(canStack) {
    let { min: min2, max: max2, minDefined, maxDefined } = this.getUserBounds();
    let range;
    if (minDefined && maxDefined) {
      return {
        min: min2,
        max: max2
      };
    }
    const metas = this.getMatchingVisibleMetas();
    for (let i = 0, ilen = metas.length; i < ilen; ++i) {
      range = metas[i].controller.getMinMax(this, canStack);
      if (!minDefined) {
        min2 = Math.min(min2, range.min);
      }
      if (!maxDefined) {
        max2 = Math.max(max2, range.max);
      }
    }
    min2 = maxDefined && min2 > max2 ? max2 : min2;
    max2 = minDefined && min2 > max2 ? min2 : max2;
    return {
      min: finiteOrDefault(min2, finiteOrDefault(max2, min2)),
      max: finiteOrDefault(max2, finiteOrDefault(min2, max2))
    };
  }
  getPadding() {
    return {
      left: this.paddingLeft || 0,
      top: this.paddingTop || 0,
      right: this.paddingRight || 0,
      bottom: this.paddingBottom || 0
    };
  }
  getTicks() {
    return this.ticks;
  }
  getLabels() {
    const data = this.chart.data;
    return this.options.labels || (this.isHorizontal() ? data.xLabels : data.yLabels) || data.labels || [];
  }
  getLabelItems(chartArea = this.chart.chartArea) {
    const items = this._labelItems || (this._labelItems = this._computeLabelItems(chartArea));
    return items;
  }
  beforeLayout() {
    this._cache = {};
    this._dataLimitsCached = false;
  }
  beforeUpdate() {
    callback(this.options.beforeUpdate, [
      this
    ]);
  }
  update(maxWidth, maxHeight, margins) {
    const { beginAtZero, grace, ticks: tickOpts } = this.options;
    const sampleSize = tickOpts.sampleSize;
    this.beforeUpdate();
    this.maxWidth = maxWidth;
    this.maxHeight = maxHeight;
    this._margins = margins = Object.assign({
      left: 0,
      right: 0,
      top: 0,
      bottom: 0
    }, margins);
    this.ticks = null;
    this._labelSizes = null;
    this._gridLineItems = null;
    this._labelItems = null;
    this.beforeSetDimensions();
    this.setDimensions();
    this.afterSetDimensions();
    this._maxLength = this.isHorizontal() ? this.width + margins.left + margins.right : this.height + margins.top + margins.bottom;
    if (!this._dataLimitsCached) {
      this.beforeDataLimits();
      this.determineDataLimits();
      this.afterDataLimits();
      this._range = _addGrace(this, grace, beginAtZero);
      this._dataLimitsCached = true;
    }
    this.beforeBuildTicks();
    this.ticks = this.buildTicks() || [];
    this.afterBuildTicks();
    const samplingEnabled = sampleSize < this.ticks.length;
    this._convertTicksToLabels(samplingEnabled ? sample(this.ticks, sampleSize) : this.ticks);
    this.configure();
    this.beforeCalculateLabelRotation();
    this.calculateLabelRotation();
    this.afterCalculateLabelRotation();
    if (tickOpts.display && (tickOpts.autoSkip || tickOpts.source === "auto")) {
      this.ticks = autoSkip(this, this.ticks);
      this._labelSizes = null;
      this.afterAutoSkip();
    }
    if (samplingEnabled) {
      this._convertTicksToLabels(this.ticks);
    }
    this.beforeFit();
    this.fit();
    this.afterFit();
    this.afterUpdate();
  }
  configure() {
    let reversePixels = this.options.reverse;
    let startPixel, endPixel;
    if (this.isHorizontal()) {
      startPixel = this.left;
      endPixel = this.right;
    } else {
      startPixel = this.top;
      endPixel = this.bottom;
      reversePixels = !reversePixels;
    }
    this._startPixel = startPixel;
    this._endPixel = endPixel;
    this._reversePixels = reversePixels;
    this._length = endPixel - startPixel;
    this._alignToPixels = this.options.alignToPixels;
  }
  afterUpdate() {
    callback(this.options.afterUpdate, [
      this
    ]);
  }
  beforeSetDimensions() {
    callback(this.options.beforeSetDimensions, [
      this
    ]);
  }
  setDimensions() {
    if (this.isHorizontal()) {
      this.width = this.maxWidth;
      this.left = 0;
      this.right = this.width;
    } else {
      this.height = this.maxHeight;
      this.top = 0;
      this.bottom = this.height;
    }
    this.paddingLeft = 0;
    this.paddingTop = 0;
    this.paddingRight = 0;
    this.paddingBottom = 0;
  }
  afterSetDimensions() {
    callback(this.options.afterSetDimensions, [
      this
    ]);
  }
  _callHooks(name) {
    this.chart.notifyPlugins(name, this.getContext());
    callback(this.options[name], [
      this
    ]);
  }
  beforeDataLimits() {
    this._callHooks("beforeDataLimits");
  }
  determineDataLimits() {
  }
  afterDataLimits() {
    this._callHooks("afterDataLimits");
  }
  beforeBuildTicks() {
    this._callHooks("beforeBuildTicks");
  }
  buildTicks() {
    return [];
  }
  afterBuildTicks() {
    this._callHooks("afterBuildTicks");
  }
  beforeTickToLabelConversion() {
    callback(this.options.beforeTickToLabelConversion, [
      this
    ]);
  }
  generateTickLabels(ticks) {
    const tickOpts = this.options.ticks;
    let i, ilen, tick;
    for (i = 0, ilen = ticks.length; i < ilen; i++) {
      tick = ticks[i];
      tick.label = callback(tickOpts.callback, [
        tick.value,
        i,
        ticks
      ], this);
    }
  }
  afterTickToLabelConversion() {
    callback(this.options.afterTickToLabelConversion, [
      this
    ]);
  }
  beforeCalculateLabelRotation() {
    callback(this.options.beforeCalculateLabelRotation, [
      this
    ]);
  }
  calculateLabelRotation() {
    const options = this.options;
    const tickOpts = options.ticks;
    const numTicks = getTicksLimit(this.ticks.length, options.ticks.maxTicksLimit);
    const minRotation = tickOpts.minRotation || 0;
    const maxRotation = tickOpts.maxRotation;
    let labelRotation = minRotation;
    let tickWidth, maxHeight, maxLabelDiagonal;
    if (!this._isVisible() || !tickOpts.display || minRotation >= maxRotation || numTicks <= 1 || !this.isHorizontal()) {
      this.labelRotation = minRotation;
      return;
    }
    const labelSizes = this._getLabelSizes();
    const maxLabelWidth = labelSizes.widest.width;
    const maxLabelHeight = labelSizes.highest.height;
    const maxWidth = _limitValue(this.chart.width - maxLabelWidth, 0, this.maxWidth);
    tickWidth = options.offset ? this.maxWidth / numTicks : maxWidth / (numTicks - 1);
    if (maxLabelWidth + 6 > tickWidth) {
      tickWidth = maxWidth / (numTicks - (options.offset ? 0.5 : 1));
      maxHeight = this.maxHeight - getTickMarkLength(options.grid) - tickOpts.padding - getTitleHeight(options.title, this.chart.options.font);
      maxLabelDiagonal = Math.sqrt(maxLabelWidth * maxLabelWidth + maxLabelHeight * maxLabelHeight);
      labelRotation = toDegrees(Math.min(Math.asin(_limitValue((labelSizes.highest.height + 6) / tickWidth, -1, 1)), Math.asin(_limitValue(maxHeight / maxLabelDiagonal, -1, 1)) - Math.asin(_limitValue(maxLabelHeight / maxLabelDiagonal, -1, 1))));
      labelRotation = Math.max(minRotation, Math.min(maxRotation, labelRotation));
    }
    this.labelRotation = labelRotation;
  }
  afterCalculateLabelRotation() {
    callback(this.options.afterCalculateLabelRotation, [
      this
    ]);
  }
  afterAutoSkip() {
  }
  beforeFit() {
    callback(this.options.beforeFit, [
      this
    ]);
  }
  fit() {
    const minSize = {
      width: 0,
      height: 0
    };
    const { chart, options: { ticks: tickOpts, title: titleOpts, grid: gridOpts } } = this;
    const display = this._isVisible();
    const isHorizontal = this.isHorizontal();
    if (display) {
      const titleHeight = getTitleHeight(titleOpts, chart.options.font);
      if (isHorizontal) {
        minSize.width = this.maxWidth;
        minSize.height = getTickMarkLength(gridOpts) + titleHeight;
      } else {
        minSize.height = this.maxHeight;
        minSize.width = getTickMarkLength(gridOpts) + titleHeight;
      }
      if (tickOpts.display && this.ticks.length) {
        const { first, last: last2, widest, highest } = this._getLabelSizes();
        const tickPadding = tickOpts.padding * 2;
        const angleRadians = toRadians(this.labelRotation);
        const cos = Math.cos(angleRadians);
        const sin = Math.sin(angleRadians);
        if (isHorizontal) {
          const labelHeight = tickOpts.mirror ? 0 : sin * widest.width + cos * highest.height;
          minSize.height = Math.min(this.maxHeight, minSize.height + labelHeight + tickPadding);
        } else {
          const labelWidth = tickOpts.mirror ? 0 : cos * widest.width + sin * highest.height;
          minSize.width = Math.min(this.maxWidth, minSize.width + labelWidth + tickPadding);
        }
        this._calculatePadding(first, last2, sin, cos);
      }
    }
    this._handleMargins();
    if (isHorizontal) {
      this.width = this._length = chart.width - this._margins.left - this._margins.right;
      this.height = minSize.height;
    } else {
      this.width = minSize.width;
      this.height = this._length = chart.height - this._margins.top - this._margins.bottom;
    }
  }
  _calculatePadding(first, last2, sin, cos) {
    const { ticks: { align, padding }, position } = this.options;
    const isRotated = this.labelRotation !== 0;
    const labelsBelowTicks = position !== "top" && this.axis === "x";
    if (this.isHorizontal()) {
      const offsetLeft = this.getPixelForTick(0) - this.left;
      const offsetRight = this.right - this.getPixelForTick(this.ticks.length - 1);
      let paddingLeft = 0;
      let paddingRight = 0;
      if (isRotated) {
        if (labelsBelowTicks) {
          paddingLeft = cos * first.width;
          paddingRight = sin * last2.height;
        } else {
          paddingLeft = sin * first.height;
          paddingRight = cos * last2.width;
        }
      } else if (align === "start") {
        paddingRight = last2.width;
      } else if (align === "end") {
        paddingLeft = first.width;
      } else if (align !== "inner") {
        paddingLeft = first.width / 2;
        paddingRight = last2.width / 2;
      }
      this.paddingLeft = Math.max((paddingLeft - offsetLeft + padding) * this.width / (this.width - offsetLeft), 0);
      this.paddingRight = Math.max((paddingRight - offsetRight + padding) * this.width / (this.width - offsetRight), 0);
    } else {
      let paddingTop = last2.height / 2;
      let paddingBottom = first.height / 2;
      if (align === "start") {
        paddingTop = 0;
        paddingBottom = first.height;
      } else if (align === "end") {
        paddingTop = last2.height;
        paddingBottom = 0;
      }
      this.paddingTop = paddingTop + padding;
      this.paddingBottom = paddingBottom + padding;
    }
  }
  _handleMargins() {
    if (this._margins) {
      this._margins.left = Math.max(this.paddingLeft, this._margins.left);
      this._margins.top = Math.max(this.paddingTop, this._margins.top);
      this._margins.right = Math.max(this.paddingRight, this._margins.right);
      this._margins.bottom = Math.max(this.paddingBottom, this._margins.bottom);
    }
  }
  afterFit() {
    callback(this.options.afterFit, [
      this
    ]);
  }
  isHorizontal() {
    const { axis, position } = this.options;
    return position === "top" || position === "bottom" || axis === "x";
  }
  isFullSize() {
    return this.options.fullSize;
  }
  _convertTicksToLabels(ticks) {
    this.beforeTickToLabelConversion();
    this.generateTickLabels(ticks);
    let i, ilen;
    for (i = 0, ilen = ticks.length; i < ilen; i++) {
      if (isNullOrUndef(ticks[i].label)) {
        ticks.splice(i, 1);
        ilen--;
        i--;
      }
    }
    this.afterTickToLabelConversion();
  }
  _getLabelSizes() {
    let labelSizes = this._labelSizes;
    if (!labelSizes) {
      const sampleSize = this.options.ticks.sampleSize;
      let ticks = this.ticks;
      if (sampleSize < ticks.length) {
        ticks = sample(ticks, sampleSize);
      }
      this._labelSizes = labelSizes = this._computeLabelSizes(ticks, ticks.length, this.options.ticks.maxTicksLimit);
    }
    return labelSizes;
  }
  _computeLabelSizes(ticks, length, maxTicksLimit) {
    const { ctx, _longestTextCache: caches } = this;
    const widths = [];
    const heights = [];
    const increment = Math.floor(length / getTicksLimit(length, maxTicksLimit));
    let widestLabelSize = 0;
    let highestLabelSize = 0;
    let i, j, jlen, label, tickFont, fontString, cache, lineHeight, width, height, nestedLabel;
    for (i = 0; i < length; i += increment) {
      label = ticks[i].label;
      tickFont = this._resolveTickFontOptions(i);
      ctx.font = fontString = tickFont.string;
      cache = caches[fontString] = caches[fontString] || {
        data: {},
        gc: []
      };
      lineHeight = tickFont.lineHeight;
      width = height = 0;
      if (!isNullOrUndef(label) && !isArray$1(label)) {
        width = _measureText(ctx, cache.data, cache.gc, width, label);
        height = lineHeight;
      } else if (isArray$1(label)) {
        for (j = 0, jlen = label.length; j < jlen; ++j) {
          nestedLabel = label[j];
          if (!isNullOrUndef(nestedLabel) && !isArray$1(nestedLabel)) {
            width = _measureText(ctx, cache.data, cache.gc, width, nestedLabel);
            height += lineHeight;
          }
        }
      }
      widths.push(width);
      heights.push(height);
      widestLabelSize = Math.max(width, widestLabelSize);
      highestLabelSize = Math.max(height, highestLabelSize);
    }
    garbageCollect(caches, length);
    const widest = widths.indexOf(widestLabelSize);
    const highest = heights.indexOf(highestLabelSize);
    const valueAt = (idx) => ({
      width: widths[idx] || 0,
      height: heights[idx] || 0
    });
    return {
      first: valueAt(0),
      last: valueAt(length - 1),
      widest: valueAt(widest),
      highest: valueAt(highest),
      widths,
      heights
    };
  }
  getLabelForValue(value) {
    return value;
  }
  getPixelForValue(value, index2) {
    return NaN;
  }
  getValueForPixel(pixel) {
  }
  getPixelForTick(index2) {
    const ticks = this.ticks;
    if (index2 < 0 || index2 > ticks.length - 1) {
      return null;
    }
    return this.getPixelForValue(ticks[index2].value);
  }
  getPixelForDecimal(decimal) {
    if (this._reversePixels) {
      decimal = 1 - decimal;
    }
    const pixel = this._startPixel + decimal * this._length;
    return _int16Range(this._alignToPixels ? _alignPixel(this.chart, pixel, 0) : pixel);
  }
  getDecimalForPixel(pixel) {
    const decimal = (pixel - this._startPixel) / this._length;
    return this._reversePixels ? 1 - decimal : decimal;
  }
  getBasePixel() {
    return this.getPixelForValue(this.getBaseValue());
  }
  getBaseValue() {
    const { min: min2, max: max2 } = this;
    return min2 < 0 && max2 < 0 ? max2 : min2 > 0 && max2 > 0 ? min2 : 0;
  }
  getContext(index2) {
    const ticks = this.ticks || [];
    if (index2 >= 0 && index2 < ticks.length) {
      const tick = ticks[index2];
      return tick.$context || (tick.$context = createTickContext(this.getContext(), index2, tick));
    }
    return this.$context || (this.$context = createScaleContext(this.chart.getContext(), this));
  }
  _tickSize() {
    const optionTicks = this.options.ticks;
    const rot = toRadians(this.labelRotation);
    const cos = Math.abs(Math.cos(rot));
    const sin = Math.abs(Math.sin(rot));
    const labelSizes = this._getLabelSizes();
    const padding = optionTicks.autoSkipPadding || 0;
    const w2 = labelSizes ? labelSizes.widest.width + padding : 0;
    const h = labelSizes ? labelSizes.highest.height + padding : 0;
    return this.isHorizontal() ? h * cos > w2 * sin ? w2 / cos : h / sin : h * sin < w2 * cos ? h / cos : w2 / sin;
  }
  _isVisible() {
    const display = this.options.display;
    if (display !== "auto") {
      return !!display;
    }
    return this.getMatchingVisibleMetas().length > 0;
  }
  _computeGridLineItems(chartArea) {
    const axis = this.axis;
    const chart = this.chart;
    const options = this.options;
    const { grid, position, border } = options;
    const offset2 = grid.offset;
    const isHorizontal = this.isHorizontal();
    const ticks = this.ticks;
    const ticksLength = ticks.length + (offset2 ? 1 : 0);
    const tl2 = getTickMarkLength(grid);
    const items = [];
    const borderOpts = border.setContext(this.getContext());
    const axisWidth = borderOpts.display ? borderOpts.width : 0;
    const axisHalfWidth = axisWidth / 2;
    const alignBorderValue = function(pixel) {
      return _alignPixel(chart, pixel, axisWidth);
    };
    let borderValue, i, lineValue, alignedLineValue;
    let tx1, ty1, tx2, ty2, x1, y1, x2, y2;
    if (position === "top") {
      borderValue = alignBorderValue(this.bottom);
      ty1 = this.bottom - tl2;
      ty2 = borderValue - axisHalfWidth;
      y1 = alignBorderValue(chartArea.top) + axisHalfWidth;
      y2 = chartArea.bottom;
    } else if (position === "bottom") {
      borderValue = alignBorderValue(this.top);
      y1 = chartArea.top;
      y2 = alignBorderValue(chartArea.bottom) - axisHalfWidth;
      ty1 = borderValue + axisHalfWidth;
      ty2 = this.top + tl2;
    } else if (position === "left") {
      borderValue = alignBorderValue(this.right);
      tx1 = this.right - tl2;
      tx2 = borderValue - axisHalfWidth;
      x1 = alignBorderValue(chartArea.left) + axisHalfWidth;
      x2 = chartArea.right;
    } else if (position === "right") {
      borderValue = alignBorderValue(this.left);
      x1 = chartArea.left;
      x2 = alignBorderValue(chartArea.right) - axisHalfWidth;
      tx1 = borderValue + axisHalfWidth;
      tx2 = this.left + tl2;
    } else if (axis === "x") {
      if (position === "center") {
        borderValue = alignBorderValue((chartArea.top + chartArea.bottom) / 2 + 0.5);
      } else if (isObject$1(position)) {
        const positionAxisID = Object.keys(position)[0];
        const value = position[positionAxisID];
        borderValue = alignBorderValue(this.chart.scales[positionAxisID].getPixelForValue(value));
      }
      y1 = chartArea.top;
      y2 = chartArea.bottom;
      ty1 = borderValue + axisHalfWidth;
      ty2 = ty1 + tl2;
    } else if (axis === "y") {
      if (position === "center") {
        borderValue = alignBorderValue((chartArea.left + chartArea.right) / 2);
      } else if (isObject$1(position)) {
        const positionAxisID = Object.keys(position)[0];
        const value = position[positionAxisID];
        borderValue = alignBorderValue(this.chart.scales[positionAxisID].getPixelForValue(value));
      }
      tx1 = borderValue - axisHalfWidth;
      tx2 = tx1 - tl2;
      x1 = chartArea.left;
      x2 = chartArea.right;
    }
    const limit = valueOrDefault(options.ticks.maxTicksLimit, ticksLength);
    const step = Math.max(1, Math.ceil(ticksLength / limit));
    for (i = 0; i < ticksLength; i += step) {
      const context = this.getContext(i);
      const optsAtIndex = grid.setContext(context);
      const optsAtIndexBorder = border.setContext(context);
      const lineWidth = optsAtIndex.lineWidth;
      const lineColor = optsAtIndex.color;
      const borderDash = optsAtIndexBorder.dash || [];
      const borderDashOffset = optsAtIndexBorder.dashOffset;
      const tickWidth = optsAtIndex.tickWidth;
      const tickColor = optsAtIndex.tickColor;
      const tickBorderDash = optsAtIndex.tickBorderDash || [];
      const tickBorderDashOffset = optsAtIndex.tickBorderDashOffset;
      lineValue = getPixelForGridLine(this, i, offset2);
      if (lineValue === void 0) {
        continue;
      }
      alignedLineValue = _alignPixel(chart, lineValue, lineWidth);
      if (isHorizontal) {
        tx1 = tx2 = x1 = x2 = alignedLineValue;
      } else {
        ty1 = ty2 = y1 = y2 = alignedLineValue;
      }
      items.push({
        tx1,
        ty1,
        tx2,
        ty2,
        x1,
        y1,
        x2,
        y2,
        width: lineWidth,
        color: lineColor,
        borderDash,
        borderDashOffset,
        tickWidth,
        tickColor,
        tickBorderDash,
        tickBorderDashOffset
      });
    }
    this._ticksLength = ticksLength;
    this._borderValue = borderValue;
    return items;
  }
  _computeLabelItems(chartArea) {
    const axis = this.axis;
    const options = this.options;
    const { position, ticks: optionTicks } = options;
    const isHorizontal = this.isHorizontal();
    const ticks = this.ticks;
    const { align, crossAlign, padding, mirror } = optionTicks;
    const tl2 = getTickMarkLength(options.grid);
    const tickAndPadding = tl2 + padding;
    const hTickAndPadding = mirror ? -padding : tickAndPadding;
    const rotation = -toRadians(this.labelRotation);
    const items = [];
    let i, ilen, tick, label, x2, y2, textAlign, pixel, font, lineHeight, lineCount, textOffset;
    let textBaseline = "middle";
    if (position === "top") {
      y2 = this.bottom - hTickAndPadding;
      textAlign = this._getXAxisLabelAlignment();
    } else if (position === "bottom") {
      y2 = this.top + hTickAndPadding;
      textAlign = this._getXAxisLabelAlignment();
    } else if (position === "left") {
      const ret = this._getYAxisLabelAlignment(tl2);
      textAlign = ret.textAlign;
      x2 = ret.x;
    } else if (position === "right") {
      const ret = this._getYAxisLabelAlignment(tl2);
      textAlign = ret.textAlign;
      x2 = ret.x;
    } else if (axis === "x") {
      if (position === "center") {
        y2 = (chartArea.top + chartArea.bottom) / 2 + tickAndPadding;
      } else if (isObject$1(position)) {
        const positionAxisID = Object.keys(position)[0];
        const value = position[positionAxisID];
        y2 = this.chart.scales[positionAxisID].getPixelForValue(value) + tickAndPadding;
      }
      textAlign = this._getXAxisLabelAlignment();
    } else if (axis === "y") {
      if (position === "center") {
        x2 = (chartArea.left + chartArea.right) / 2 - tickAndPadding;
      } else if (isObject$1(position)) {
        const positionAxisID = Object.keys(position)[0];
        const value = position[positionAxisID];
        x2 = this.chart.scales[positionAxisID].getPixelForValue(value);
      }
      textAlign = this._getYAxisLabelAlignment(tl2).textAlign;
    }
    if (axis === "y") {
      if (align === "start") {
        textBaseline = "top";
      } else if (align === "end") {
        textBaseline = "bottom";
      }
    }
    const labelSizes = this._getLabelSizes();
    for (i = 0, ilen = ticks.length; i < ilen; ++i) {
      tick = ticks[i];
      label = tick.label;
      const optsAtIndex = optionTicks.setContext(this.getContext(i));
      pixel = this.getPixelForTick(i) + optionTicks.labelOffset;
      font = this._resolveTickFontOptions(i);
      lineHeight = font.lineHeight;
      lineCount = isArray$1(label) ? label.length : 1;
      const halfCount = lineCount / 2;
      const color2 = optsAtIndex.color;
      const strokeColor = optsAtIndex.textStrokeColor;
      const strokeWidth = optsAtIndex.textStrokeWidth;
      let tickTextAlign = textAlign;
      if (isHorizontal) {
        x2 = pixel;
        if (textAlign === "inner") {
          if (i === ilen - 1) {
            tickTextAlign = !this.options.reverse ? "right" : "left";
          } else if (i === 0) {
            tickTextAlign = !this.options.reverse ? "left" : "right";
          } else {
            tickTextAlign = "center";
          }
        }
        if (position === "top") {
          if (crossAlign === "near" || rotation !== 0) {
            textOffset = -lineCount * lineHeight + lineHeight / 2;
          } else if (crossAlign === "center") {
            textOffset = -labelSizes.highest.height / 2 - halfCount * lineHeight + lineHeight;
          } else {
            textOffset = -labelSizes.highest.height + lineHeight / 2;
          }
        } else {
          if (crossAlign === "near" || rotation !== 0) {
            textOffset = lineHeight / 2;
          } else if (crossAlign === "center") {
            textOffset = labelSizes.highest.height / 2 - halfCount * lineHeight;
          } else {
            textOffset = labelSizes.highest.height - lineCount * lineHeight;
          }
        }
        if (mirror) {
          textOffset *= -1;
        }
        if (rotation !== 0 && !optsAtIndex.showLabelBackdrop) {
          x2 += lineHeight / 2 * Math.sin(rotation);
        }
      } else {
        y2 = pixel;
        textOffset = (1 - lineCount) * lineHeight / 2;
      }
      let backdrop;
      if (optsAtIndex.showLabelBackdrop) {
        const labelPadding = toPadding(optsAtIndex.backdropPadding);
        const height = labelSizes.heights[i];
        const width = labelSizes.widths[i];
        let top = textOffset - labelPadding.top;
        let left = 0 - labelPadding.left;
        switch (textBaseline) {
          case "middle":
            top -= height / 2;
            break;
          case "bottom":
            top -= height;
            break;
        }
        switch (textAlign) {
          case "center":
            left -= width / 2;
            break;
          case "right":
            left -= width;
            break;
        }
        backdrop = {
          left,
          top,
          width: width + labelPadding.width,
          height: height + labelPadding.height,
          color: optsAtIndex.backdropColor
        };
      }
      items.push({
        label,
        font,
        textOffset,
        options: {
          rotation,
          color: color2,
          strokeColor,
          strokeWidth,
          textAlign: tickTextAlign,
          textBaseline,
          translation: [
            x2,
            y2
          ],
          backdrop
        }
      });
    }
    return items;
  }
  _getXAxisLabelAlignment() {
    const { position, ticks } = this.options;
    const rotation = -toRadians(this.labelRotation);
    if (rotation) {
      return position === "top" ? "left" : "right";
    }
    let align = "center";
    if (ticks.align === "start") {
      align = "left";
    } else if (ticks.align === "end") {
      align = "right";
    } else if (ticks.align === "inner") {
      align = "inner";
    }
    return align;
  }
  _getYAxisLabelAlignment(tl2) {
    const { position, ticks: { crossAlign, mirror, padding } } = this.options;
    const labelSizes = this._getLabelSizes();
    const tickAndPadding = tl2 + padding;
    const widest = labelSizes.widest.width;
    let textAlign;
    let x2;
    if (position === "left") {
      if (mirror) {
        x2 = this.right + padding;
        if (crossAlign === "near") {
          textAlign = "left";
        } else if (crossAlign === "center") {
          textAlign = "center";
          x2 += widest / 2;
        } else {
          textAlign = "right";
          x2 += widest;
        }
      } else {
        x2 = this.right - tickAndPadding;
        if (crossAlign === "near") {
          textAlign = "right";
        } else if (crossAlign === "center") {
          textAlign = "center";
          x2 -= widest / 2;
        } else {
          textAlign = "left";
          x2 = this.left;
        }
      }
    } else if (position === "right") {
      if (mirror) {
        x2 = this.left + padding;
        if (crossAlign === "near") {
          textAlign = "right";
        } else if (crossAlign === "center") {
          textAlign = "center";
          x2 -= widest / 2;
        } else {
          textAlign = "left";
          x2 -= widest;
        }
      } else {
        x2 = this.left + tickAndPadding;
        if (crossAlign === "near") {
          textAlign = "left";
        } else if (crossAlign === "center") {
          textAlign = "center";
          x2 += widest / 2;
        } else {
          textAlign = "right";
          x2 = this.right;
        }
      }
    } else {
      textAlign = "right";
    }
    return {
      textAlign,
      x: x2
    };
  }
  _computeLabelArea() {
    if (this.options.ticks.mirror) {
      return;
    }
    const chart = this.chart;
    const position = this.options.position;
    if (position === "left" || position === "right") {
      return {
        top: 0,
        left: this.left,
        bottom: chart.height,
        right: this.right
      };
    }
    if (position === "top" || position === "bottom") {
      return {
        top: this.top,
        left: 0,
        bottom: this.bottom,
        right: chart.width
      };
    }
  }
  drawBackground() {
    const { ctx, options: { backgroundColor }, left, top, width, height } = this;
    if (backgroundColor) {
      ctx.save();
      ctx.fillStyle = backgroundColor;
      ctx.fillRect(left, top, width, height);
      ctx.restore();
    }
  }
  getLineWidthForValue(value) {
    const grid = this.options.grid;
    if (!this._isVisible() || !grid.display) {
      return 0;
    }
    const ticks = this.ticks;
    const index2 = ticks.findIndex((t2) => t2.value === value);
    if (index2 >= 0) {
      const opts = grid.setContext(this.getContext(index2));
      return opts.lineWidth;
    }
    return 0;
  }
  drawGrid(chartArea) {
    const grid = this.options.grid;
    const ctx = this.ctx;
    const items = this._gridLineItems || (this._gridLineItems = this._computeGridLineItems(chartArea));
    let i, ilen;
    const drawLine = (p1, p2, style2) => {
      if (!style2.width || !style2.color) {
        return;
      }
      ctx.save();
      ctx.lineWidth = style2.width;
      ctx.strokeStyle = style2.color;
      ctx.setLineDash(style2.borderDash || []);
      ctx.lineDashOffset = style2.borderDashOffset;
      ctx.beginPath();
      ctx.moveTo(p1.x, p1.y);
      ctx.lineTo(p2.x, p2.y);
      ctx.stroke();
      ctx.restore();
    };
    if (grid.display) {
      for (i = 0, ilen = items.length; i < ilen; ++i) {
        const item = items[i];
        if (grid.drawOnChartArea) {
          drawLine({
            x: item.x1,
            y: item.y1
          }, {
            x: item.x2,
            y: item.y2
          }, item);
        }
        if (grid.drawTicks) {
          drawLine({
            x: item.tx1,
            y: item.ty1
          }, {
            x: item.tx2,
            y: item.ty2
          }, {
            color: item.tickColor,
            width: item.tickWidth,
            borderDash: item.tickBorderDash,
            borderDashOffset: item.tickBorderDashOffset
          });
        }
      }
    }
  }
  drawBorder() {
    const { chart, ctx, options: { border, grid } } = this;
    const borderOpts = border.setContext(this.getContext());
    const axisWidth = border.display ? borderOpts.width : 0;
    if (!axisWidth) {
      return;
    }
    const lastLineWidth = grid.setContext(this.getContext(0)).lineWidth;
    const borderValue = this._borderValue;
    let x1, x2, y1, y2;
    if (this.isHorizontal()) {
      x1 = _alignPixel(chart, this.left, axisWidth) - axisWidth / 2;
      x2 = _alignPixel(chart, this.right, lastLineWidth) + lastLineWidth / 2;
      y1 = y2 = borderValue;
    } else {
      y1 = _alignPixel(chart, this.top, axisWidth) - axisWidth / 2;
      y2 = _alignPixel(chart, this.bottom, lastLineWidth) + lastLineWidth / 2;
      x1 = x2 = borderValue;
    }
    ctx.save();
    ctx.lineWidth = borderOpts.width;
    ctx.strokeStyle = borderOpts.color;
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.stroke();
    ctx.restore();
  }
  drawLabels(chartArea) {
    const optionTicks = this.options.ticks;
    if (!optionTicks.display) {
      return;
    }
    const ctx = this.ctx;
    const area = this._computeLabelArea();
    if (area) {
      clipArea(ctx, area);
    }
    const items = this.getLabelItems(chartArea);
    for (const item of items) {
      const renderTextOptions = item.options;
      const tickFont = item.font;
      const label = item.label;
      const y2 = item.textOffset;
      renderText(ctx, label, 0, y2, tickFont, renderTextOptions);
    }
    if (area) {
      unclipArea(ctx);
    }
  }
  drawTitle() {
    const { ctx, options: { position, title, reverse } } = this;
    if (!title.display) {
      return;
    }
    const font = toFont(title.font);
    const padding = toPadding(title.padding);
    const align = title.align;
    let offset2 = font.lineHeight / 2;
    if (position === "bottom" || position === "center" || isObject$1(position)) {
      offset2 += padding.bottom;
      if (isArray$1(title.text)) {
        offset2 += font.lineHeight * (title.text.length - 1);
      }
    } else {
      offset2 += padding.top;
    }
    const { titleX, titleY, maxWidth, rotation } = titleArgs(this, offset2, position, align);
    renderText(ctx, title.text, 0, 0, font, {
      color: title.color,
      maxWidth,
      rotation,
      textAlign: titleAlign(align, position, reverse),
      textBaseline: "middle",
      translation: [
        titleX,
        titleY
      ]
    });
  }
  draw(chartArea) {
    if (!this._isVisible()) {
      return;
    }
    this.drawBackground();
    this.drawGrid(chartArea);
    this.drawBorder();
    this.drawTitle();
    this.drawLabels(chartArea);
  }
  _layers() {
    const opts = this.options;
    const tz = opts.ticks && opts.ticks.z || 0;
    const gz = valueOrDefault(opts.grid && opts.grid.z, -1);
    const bz = valueOrDefault(opts.border && opts.border.z, 0);
    if (!this._isVisible() || this.draw !== Scale.prototype.draw) {
      return [
        {
          z: tz,
          draw: (chartArea) => {
            this.draw(chartArea);
          }
        }
      ];
    }
    return [
      {
        z: gz,
        draw: (chartArea) => {
          this.drawBackground();
          this.drawGrid(chartArea);
          this.drawTitle();
        }
      },
      {
        z: bz,
        draw: () => {
          this.drawBorder();
        }
      },
      {
        z: tz,
        draw: (chartArea) => {
          this.drawLabels(chartArea);
        }
      }
    ];
  }
  getMatchingVisibleMetas(type) {
    const metas = this.chart.getSortedVisibleDatasetMetas();
    const axisID = this.axis + "AxisID";
    const result = [];
    let i, ilen;
    for (i = 0, ilen = metas.length; i < ilen; ++i) {
      const meta = metas[i];
      if (meta[axisID] === this.id && (!type || meta.type === type)) {
        result.push(meta);
      }
    }
    return result;
  }
  _resolveTickFontOptions(index2) {
    const opts = this.options.ticks.setContext(this.getContext(index2));
    return toFont(opts.font);
  }
  _maxDigits() {
    const fontSize = this._resolveTickFontOptions(0).lineHeight;
    return (this.isHorizontal() ? this.width : this.height) / fontSize;
  }
}
class TypedRegistry {
  constructor(type, scope, override) {
    this.type = type;
    this.scope = scope;
    this.override = override;
    this.items = /* @__PURE__ */ Object.create(null);
  }
  isForType(type) {
    return Object.prototype.isPrototypeOf.call(this.type.prototype, type.prototype);
  }
  register(item) {
    const proto2 = Object.getPrototypeOf(item);
    let parentScope;
    if (isIChartComponent(proto2)) {
      parentScope = this.register(proto2);
    }
    const items = this.items;
    const id2 = item.id;
    const scope = this.scope + "." + id2;
    if (!id2) {
      throw new Error("class does not have id: " + item);
    }
    if (id2 in items) {
      return scope;
    }
    items[id2] = item;
    registerDefaults(item, scope, parentScope);
    if (this.override) {
      defaults$1.override(item.id, item.overrides);
    }
    return scope;
  }
  get(id2) {
    return this.items[id2];
  }
  unregister(item) {
    const items = this.items;
    const id2 = item.id;
    const scope = this.scope;
    if (id2 in items) {
      delete items[id2];
    }
    if (scope && id2 in defaults$1[scope]) {
      delete defaults$1[scope][id2];
      if (this.override) {
        delete overrides[id2];
      }
    }
  }
}
function registerDefaults(item, scope, parentScope) {
  const itemDefaults = merge(/* @__PURE__ */ Object.create(null), [
    parentScope ? defaults$1.get(parentScope) : {},
    defaults$1.get(scope),
    item.defaults
  ]);
  defaults$1.set(scope, itemDefaults);
  if (item.defaultRoutes) {
    routeDefaults(scope, item.defaultRoutes);
  }
  if (item.descriptors) {
    defaults$1.describe(scope, item.descriptors);
  }
}
function routeDefaults(scope, routes) {
  Object.keys(routes).forEach((property) => {
    const propertyParts = property.split(".");
    const sourceName = propertyParts.pop();
    const sourceScope = [
      scope
    ].concat(propertyParts).join(".");
    const parts = routes[property].split(".");
    const targetName = parts.pop();
    const targetScope = parts.join(".");
    defaults$1.route(sourceScope, sourceName, targetScope, targetName);
  });
}
function isIChartComponent(proto2) {
  return "id" in proto2 && "defaults" in proto2;
}
class Registry {
  constructor() {
    this.controllers = new TypedRegistry(DatasetController, "datasets", true);
    this.elements = new TypedRegistry(Element$1, "elements");
    this.plugins = new TypedRegistry(Object, "plugins");
    this.scales = new TypedRegistry(Scale, "scales");
    this._typedRegistries = [
      this.controllers,
      this.scales,
      this.elements
    ];
  }
  add(...args) {
    this._each("register", args);
  }
  remove(...args) {
    this._each("unregister", args);
  }
  addControllers(...args) {
    this._each("register", args, this.controllers);
  }
  addElements(...args) {
    this._each("register", args, this.elements);
  }
  addPlugins(...args) {
    this._each("register", args, this.plugins);
  }
  addScales(...args) {
    this._each("register", args, this.scales);
  }
  getController(id2) {
    return this._get(id2, this.controllers, "controller");
  }
  getElement(id2) {
    return this._get(id2, this.elements, "element");
  }
  getPlugin(id2) {
    return this._get(id2, this.plugins, "plugin");
  }
  getScale(id2) {
    return this._get(id2, this.scales, "scale");
  }
  removeControllers(...args) {
    this._each("unregister", args, this.controllers);
  }
  removeElements(...args) {
    this._each("unregister", args, this.elements);
  }
  removePlugins(...args) {
    this._each("unregister", args, this.plugins);
  }
  removeScales(...args) {
    this._each("unregister", args, this.scales);
  }
  _each(method, args, typedRegistry) {
    [
      ...args
    ].forEach((arg) => {
      const reg = typedRegistry || this._getRegistryForType(arg);
      if (typedRegistry || reg.isForType(arg) || reg === this.plugins && arg.id) {
        this._exec(method, reg, arg);
      } else {
        each(arg, (item) => {
          const itemReg = typedRegistry || this._getRegistryForType(item);
          this._exec(method, itemReg, item);
        });
      }
    });
  }
  _exec(method, registry2, component) {
    const camelMethod = _capitalize(method);
    callback(component["before" + camelMethod], [], component);
    registry2[method](component);
    callback(component["after" + camelMethod], [], component);
  }
  _getRegistryForType(type) {
    for (let i = 0; i < this._typedRegistries.length; i++) {
      const reg = this._typedRegistries[i];
      if (reg.isForType(type)) {
        return reg;
      }
    }
    return this.plugins;
  }
  _get(id2, typedRegistry, type) {
    const item = typedRegistry.get(id2);
    if (item === void 0) {
      throw new Error('"' + id2 + '" is not a registered ' + type + ".");
    }
    return item;
  }
}
var registry = /* @__PURE__ */ new Registry();
class PluginService {
  constructor() {
    this._init = [];
  }
  notify(chart, hook, args, filter) {
    if (hook === "beforeInit") {
      this._init = this._createDescriptors(chart, true);
      this._notify(this._init, chart, "install");
    }
    const descriptors2 = filter ? this._descriptors(chart).filter(filter) : this._descriptors(chart);
    const result = this._notify(descriptors2, chart, hook, args);
    if (hook === "afterDestroy") {
      this._notify(descriptors2, chart, "stop");
      this._notify(this._init, chart, "uninstall");
    }
    return result;
  }
  _notify(descriptors2, chart, hook, args) {
    args = args || {};
    for (const descriptor of descriptors2) {
      const plugin = descriptor.plugin;
      const method = plugin[hook];
      const params = [
        chart,
        args,
        descriptor.options
      ];
      if (callback(method, params, plugin) === false && args.cancelable) {
        return false;
      }
    }
    return true;
  }
  invalidate() {
    if (!isNullOrUndef(this._cache)) {
      this._oldCache = this._cache;
      this._cache = void 0;
    }
  }
  _descriptors(chart) {
    if (this._cache) {
      return this._cache;
    }
    const descriptors2 = this._cache = this._createDescriptors(chart);
    this._notifyStateChanges(chart);
    return descriptors2;
  }
  _createDescriptors(chart, all) {
    const config = chart && chart.config;
    const options = valueOrDefault(config.options && config.options.plugins, {});
    const plugins2 = allPlugins(config);
    return options === false && !all ? [] : createDescriptors(chart, plugins2, options, all);
  }
  _notifyStateChanges(chart) {
    const previousDescriptors = this._oldCache || [];
    const descriptors2 = this._cache;
    const diff2 = (a, b) => a.filter((x2) => !b.some((y2) => x2.plugin.id === y2.plugin.id));
    this._notify(diff2(previousDescriptors, descriptors2), chart, "stop");
    this._notify(diff2(descriptors2, previousDescriptors), chart, "start");
  }
}
function allPlugins(config) {
  const localIds = {};
  const plugins2 = [];
  const keys2 = Object.keys(registry.plugins.items);
  for (let i = 0; i < keys2.length; i++) {
    plugins2.push(registry.getPlugin(keys2[i]));
  }
  const local = config.plugins || [];
  for (let i = 0; i < local.length; i++) {
    const plugin = local[i];
    if (plugins2.indexOf(plugin) === -1) {
      plugins2.push(plugin);
      localIds[plugin.id] = true;
    }
  }
  return {
    plugins: plugins2,
    localIds
  };
}
function getOpts(options, all) {
  if (!all && options === false) {
    return null;
  }
  if (options === true) {
    return {};
  }
  return options;
}
function createDescriptors(chart, { plugins: plugins2, localIds }, options, all) {
  const result = [];
  const context = chart.getContext();
  for (const plugin of plugins2) {
    const id2 = plugin.id;
    const opts = getOpts(options[id2], all);
    if (opts === null) {
      continue;
    }
    result.push({
      plugin,
      options: pluginOpts(chart.config, {
        plugin,
        local: localIds[id2]
      }, opts, context)
    });
  }
  return result;
}
function pluginOpts(config, { plugin, local }, opts, context) {
  const keys2 = config.pluginScopeKeys(plugin);
  const scopes = config.getOptionScopes(opts, keys2);
  if (local && plugin.defaults) {
    scopes.push(plugin.defaults);
  }
  return config.createResolver(scopes, context, [
    ""
  ], {
    scriptable: false,
    indexable: false,
    allKeys: true
  });
}
function getIndexAxis(type, options) {
  const datasetDefaults = defaults$1.datasets[type] || {};
  const datasetOptions = (options.datasets || {})[type] || {};
  return datasetOptions.indexAxis || options.indexAxis || datasetDefaults.indexAxis || "x";
}
function getAxisFromDefaultScaleID(id2, indexAxis) {
  let axis = id2;
  if (id2 === "_index_") {
    axis = indexAxis;
  } else if (id2 === "_value_") {
    axis = indexAxis === "x" ? "y" : "x";
  }
  return axis;
}
function getDefaultScaleIDFromAxis(axis, indexAxis) {
  return axis === indexAxis ? "_index_" : "_value_";
}
function idMatchesAxis(id2) {
  if (id2 === "x" || id2 === "y" || id2 === "r") {
    return id2;
  }
}
function axisFromPosition(position) {
  if (position === "top" || position === "bottom") {
    return "x";
  }
  if (position === "left" || position === "right") {
    return "y";
  }
}
function determineAxis(id2, ...scaleOptions) {
  if (idMatchesAxis(id2)) {
    return id2;
  }
  for (const opts of scaleOptions) {
    const axis = opts.axis || axisFromPosition(opts.position) || id2.length > 1 && idMatchesAxis(id2[0].toLowerCase());
    if (axis) {
      return axis;
    }
  }
  throw new Error(`Cannot determine type of '${id2}' axis. Please provide 'axis' or 'position' option.`);
}
function getAxisFromDataset(id2, axis, dataset) {
  if (dataset[axis + "AxisID"] === id2) {
    return {
      axis
    };
  }
}
function retrieveAxisFromDatasets(id2, config) {
  if (config.data && config.data.datasets) {
    const boundDs = config.data.datasets.filter((d) => d.xAxisID === id2 || d.yAxisID === id2);
    if (boundDs.length) {
      return getAxisFromDataset(id2, "x", boundDs[0]) || getAxisFromDataset(id2, "y", boundDs[0]);
    }
  }
  return {};
}
function mergeScaleConfig(config, options) {
  const chartDefaults = overrides[config.type] || {
    scales: {}
  };
  const configScales = options.scales || {};
  const chartIndexAxis = getIndexAxis(config.type, options);
  const scales2 = /* @__PURE__ */ Object.create(null);
  Object.keys(configScales).forEach((id2) => {
    const scaleConf = configScales[id2];
    if (!isObject$1(scaleConf)) {
      return console.error(`Invalid scale configuration for scale: ${id2}`);
    }
    if (scaleConf._proxy) {
      return console.warn(`Ignoring resolver passed as options for scale: ${id2}`);
    }
    const axis = determineAxis(id2, scaleConf, retrieveAxisFromDatasets(id2, config), defaults$1.scales[scaleConf.type]);
    const defaultId = getDefaultScaleIDFromAxis(axis, chartIndexAxis);
    const defaultScaleOptions = chartDefaults.scales || {};
    scales2[id2] = mergeIf(/* @__PURE__ */ Object.create(null), [
      {
        axis
      },
      scaleConf,
      defaultScaleOptions[axis],
      defaultScaleOptions[defaultId]
    ]);
  });
  config.data.datasets.forEach((dataset) => {
    const type = dataset.type || config.type;
    const indexAxis = dataset.indexAxis || getIndexAxis(type, options);
    const datasetDefaults = overrides[type] || {};
    const defaultScaleOptions = datasetDefaults.scales || {};
    Object.keys(defaultScaleOptions).forEach((defaultID) => {
      const axis = getAxisFromDefaultScaleID(defaultID, indexAxis);
      const id2 = dataset[axis + "AxisID"] || axis;
      scales2[id2] = scales2[id2] || /* @__PURE__ */ Object.create(null);
      mergeIf(scales2[id2], [
        {
          axis
        },
        configScales[id2],
        defaultScaleOptions[defaultID]
      ]);
    });
  });
  Object.keys(scales2).forEach((key) => {
    const scale = scales2[key];
    mergeIf(scale, [
      defaults$1.scales[scale.type],
      defaults$1.scale
    ]);
  });
  return scales2;
}
function initOptions(config) {
  const options = config.options || (config.options = {});
  options.plugins = valueOrDefault(options.plugins, {});
  options.scales = mergeScaleConfig(config, options);
}
function initData(data) {
  data = data || {};
  data.datasets = data.datasets || [];
  data.labels = data.labels || [];
  return data;
}
function initConfig(config) {
  config = config || {};
  config.data = initData(config.data);
  initOptions(config);
  return config;
}
const keyCache = /* @__PURE__ */ new Map();
const keysCached = /* @__PURE__ */ new Set();
function cachedKeys(cacheKey, generate) {
  let keys2 = keyCache.get(cacheKey);
  if (!keys2) {
    keys2 = generate();
    keyCache.set(cacheKey, keys2);
    keysCached.add(keys2);
  }
  return keys2;
}
const addIfFound = (set2, obj, key) => {
  const opts = resolveObjectKey(obj, key);
  if (opts !== void 0) {
    set2.add(opts);
  }
};
class Config {
  constructor(config) {
    this._config = initConfig(config);
    this._scopeCache = /* @__PURE__ */ new Map();
    this._resolverCache = /* @__PURE__ */ new Map();
  }
  get platform() {
    return this._config.platform;
  }
  get type() {
    return this._config.type;
  }
  set type(type) {
    this._config.type = type;
  }
  get data() {
    return this._config.data;
  }
  set data(data) {
    this._config.data = initData(data);
  }
  get options() {
    return this._config.options;
  }
  set options(options) {
    this._config.options = options;
  }
  get plugins() {
    return this._config.plugins;
  }
  update() {
    const config = this._config;
    this.clearCache();
    initOptions(config);
  }
  clearCache() {
    this._scopeCache.clear();
    this._resolverCache.clear();
  }
  datasetScopeKeys(datasetType) {
    return cachedKeys(datasetType, () => [
      [
        `datasets.${datasetType}`,
        ""
      ]
    ]);
  }
  datasetAnimationScopeKeys(datasetType, transition) {
    return cachedKeys(`${datasetType}.transition.${transition}`, () => [
      [
        `datasets.${datasetType}.transitions.${transition}`,
        `transitions.${transition}`
      ],
      [
        `datasets.${datasetType}`,
        ""
      ]
    ]);
  }
  datasetElementScopeKeys(datasetType, elementType) {
    return cachedKeys(`${datasetType}-${elementType}`, () => [
      [
        `datasets.${datasetType}.elements.${elementType}`,
        `datasets.${datasetType}`,
        `elements.${elementType}`,
        ""
      ]
    ]);
  }
  pluginScopeKeys(plugin) {
    const id2 = plugin.id;
    const type = this.type;
    return cachedKeys(`${type}-plugin-${id2}`, () => [
      [
        `plugins.${id2}`,
        ...plugin.additionalOptionScopes || []
      ]
    ]);
  }
  _cachedScopes(mainScope, resetCache) {
    const _scopeCache = this._scopeCache;
    let cache = _scopeCache.get(mainScope);
    if (!cache || resetCache) {
      cache = /* @__PURE__ */ new Map();
      _scopeCache.set(mainScope, cache);
    }
    return cache;
  }
  getOptionScopes(mainScope, keyLists, resetCache) {
    const { options, type } = this;
    const cache = this._cachedScopes(mainScope, resetCache);
    const cached = cache.get(keyLists);
    if (cached) {
      return cached;
    }
    const scopes = /* @__PURE__ */ new Set();
    keyLists.forEach((keys2) => {
      if (mainScope) {
        scopes.add(mainScope);
        keys2.forEach((key) => addIfFound(scopes, mainScope, key));
      }
      keys2.forEach((key) => addIfFound(scopes, options, key));
      keys2.forEach((key) => addIfFound(scopes, overrides[type] || {}, key));
      keys2.forEach((key) => addIfFound(scopes, defaults$1, key));
      keys2.forEach((key) => addIfFound(scopes, descriptors, key));
    });
    const array = Array.from(scopes);
    if (array.length === 0) {
      array.push(/* @__PURE__ */ Object.create(null));
    }
    if (keysCached.has(keyLists)) {
      cache.set(keyLists, array);
    }
    return array;
  }
  chartOptionScopes() {
    const { options, type } = this;
    return [
      options,
      overrides[type] || {},
      defaults$1.datasets[type] || {},
      {
        type
      },
      defaults$1,
      descriptors
    ];
  }
  resolveNamedOptions(scopes, names2, context, prefixes = [
    ""
  ]) {
    const result = {
      $shared: true
    };
    const { resolver, subPrefixes } = getResolver(this._resolverCache, scopes, prefixes);
    let options = resolver;
    if (needContext(resolver, names2)) {
      result.$shared = false;
      context = isFunction$1(context) ? context() : context;
      const subResolver = this.createResolver(scopes, context, subPrefixes);
      options = _attachContext(resolver, context, subResolver);
    }
    for (const prop of names2) {
      result[prop] = options[prop];
    }
    return result;
  }
  createResolver(scopes, context, prefixes = [
    ""
  ], descriptorDefaults) {
    const { resolver } = getResolver(this._resolverCache, scopes, prefixes);
    return isObject$1(context) ? _attachContext(resolver, context, void 0, descriptorDefaults) : resolver;
  }
}
function getResolver(resolverCache, scopes, prefixes) {
  let cache = resolverCache.get(scopes);
  if (!cache) {
    cache = /* @__PURE__ */ new Map();
    resolverCache.set(scopes, cache);
  }
  const cacheKey = prefixes.join();
  let cached = cache.get(cacheKey);
  if (!cached) {
    const resolver = _createResolver(scopes, prefixes);
    cached = {
      resolver,
      subPrefixes: prefixes.filter((p2) => !p2.toLowerCase().includes("hover"))
    };
    cache.set(cacheKey, cached);
  }
  return cached;
}
const hasFunction = (value) => isObject$1(value) && Object.getOwnPropertyNames(value).reduce((acc, key) => acc || isFunction$1(value[key]), false);
function needContext(proxy, names2) {
  const { isScriptable, isIndexable } = _descriptors(proxy);
  for (const prop of names2) {
    const scriptable = isScriptable(prop);
    const indexable = isIndexable(prop);
    const value = (indexable || scriptable) && proxy[prop];
    if (scriptable && (isFunction$1(value) || hasFunction(value)) || indexable && isArray$1(value)) {
      return true;
    }
  }
  return false;
}
var version = "4.4.0";
const KNOWN_POSITIONS = [
  "top",
  "bottom",
  "left",
  "right",
  "chartArea"
];
function positionIsHorizontal(position, axis) {
  return position === "top" || position === "bottom" || KNOWN_POSITIONS.indexOf(position) === -1 && axis === "x";
}
function compare2Level(l1, l2) {
  return function(a, b) {
    return a[l1] === b[l1] ? a[l2] - b[l2] : a[l1] - b[l1];
  };
}
function onAnimationsComplete(context) {
  const chart = context.chart;
  const animationOptions = chart.options.animation;
  chart.notifyPlugins("afterRender");
  callback(animationOptions && animationOptions.onComplete, [
    context
  ], chart);
}
function onAnimationProgress(context) {
  const chart = context.chart;
  const animationOptions = chart.options.animation;
  callback(animationOptions && animationOptions.onProgress, [
    context
  ], chart);
}
function getCanvas(item) {
  if (_isDomSupported() && typeof item === "string") {
    item = document.getElementById(item);
  } else if (item && item.length) {
    item = item[0];
  }
  if (item && item.canvas) {
    item = item.canvas;
  }
  return item;
}
const instances = {};
const getChart = (key) => {
  const canvas = getCanvas(key);
  return Object.values(instances).filter((c) => c.canvas === canvas).pop();
};
function moveNumericKeys(obj, start, move) {
  const keys2 = Object.keys(obj);
  for (const key of keys2) {
    const intKey = +key;
    if (intKey >= start) {
      const value = obj[key];
      delete obj[key];
      if (move > 0 || intKey > start) {
        obj[intKey + move] = value;
      }
    }
  }
}
function determineLastEvent(e, lastEvent, inChartArea, isClick) {
  if (!inChartArea || e.type === "mouseout") {
    return null;
  }
  if (isClick) {
    return lastEvent;
  }
  return e;
}
function getSizeForArea(scale, chartArea, field) {
  return scale.options.clip ? scale[field] : chartArea[field];
}
function getDatasetArea(meta, chartArea) {
  const { xScale, yScale } = meta;
  if (xScale && yScale) {
    return {
      left: getSizeForArea(xScale, chartArea, "left"),
      right: getSizeForArea(xScale, chartArea, "right"),
      top: getSizeForArea(yScale, chartArea, "top"),
      bottom: getSizeForArea(yScale, chartArea, "bottom")
    };
  }
  return chartArea;
}
let Chart$1 = (_b = class {
  static register(...items) {
    registry.add(...items);
    invalidatePlugins();
  }
  static unregister(...items) {
    registry.remove(...items);
    invalidatePlugins();
  }
  constructor(item, userConfig) {
    const config = this.config = new Config(userConfig);
    const initialCanvas = getCanvas(item);
    const existingChart = getChart(initialCanvas);
    if (existingChart) {
      throw new Error("Canvas is already in use. Chart with ID '" + existingChart.id + "' must be destroyed before the canvas with ID '" + existingChart.canvas.id + "' can be reused.");
    }
    const options = config.createResolver(config.chartOptionScopes(), this.getContext());
    this.platform = new (config.platform || _detectPlatform(initialCanvas))();
    this.platform.updateConfig(config);
    const context = this.platform.acquireContext(initialCanvas, options.aspectRatio);
    const canvas = context && context.canvas;
    const height = canvas && canvas.height;
    const width = canvas && canvas.width;
    this.id = uid();
    this.ctx = context;
    this.canvas = canvas;
    this.width = width;
    this.height = height;
    this._options = options;
    this._aspectRatio = this.aspectRatio;
    this._layers = [];
    this._metasets = [];
    this._stacks = void 0;
    this.boxes = [];
    this.currentDevicePixelRatio = void 0;
    this.chartArea = void 0;
    this._active = [];
    this._lastEvent = void 0;
    this._listeners = {};
    this._responsiveListeners = void 0;
    this._sortedMetasets = [];
    this.scales = {};
    this._plugins = new PluginService();
    this.$proxies = {};
    this._hiddenIndices = {};
    this.attached = false;
    this._animationsDisabled = void 0;
    this.$context = void 0;
    this._doResize = debounce((mode) => this.update(mode), options.resizeDelay || 0);
    this._dataChanges = [];
    instances[this.id] = this;
    if (!context || !canvas) {
      console.error("Failed to create chart: can't acquire context from the given item");
      return;
    }
    animator.listen(this, "complete", onAnimationsComplete);
    animator.listen(this, "progress", onAnimationProgress);
    this._initialize();
    if (this.attached) {
      this.update();
    }
  }
  get aspectRatio() {
    const { options: { aspectRatio, maintainAspectRatio }, width, height, _aspectRatio } = this;
    if (!isNullOrUndef(aspectRatio)) {
      return aspectRatio;
    }
    if (maintainAspectRatio && _aspectRatio) {
      return _aspectRatio;
    }
    return height ? width / height : null;
  }
  get data() {
    return this.config.data;
  }
  set data(data) {
    this.config.data = data;
  }
  get options() {
    return this._options;
  }
  set options(options) {
    this.config.options = options;
  }
  get registry() {
    return registry;
  }
  _initialize() {
    this.notifyPlugins("beforeInit");
    if (this.options.responsive) {
      this.resize();
    } else {
      retinaScale(this, this.options.devicePixelRatio);
    }
    this.bindEvents();
    this.notifyPlugins("afterInit");
    return this;
  }
  clear() {
    clearCanvas(this.canvas, this.ctx);
    return this;
  }
  stop() {
    animator.stop(this);
    return this;
  }
  resize(width, height) {
    if (!animator.running(this)) {
      this._resize(width, height);
    } else {
      this._resizeBeforeDraw = {
        width,
        height
      };
    }
  }
  _resize(width, height) {
    const options = this.options;
    const canvas = this.canvas;
    const aspectRatio = options.maintainAspectRatio && this.aspectRatio;
    const newSize = this.platform.getMaximumSize(canvas, width, height, aspectRatio);
    const newRatio = options.devicePixelRatio || this.platform.getDevicePixelRatio();
    const mode = this.width ? "resize" : "attach";
    this.width = newSize.width;
    this.height = newSize.height;
    this._aspectRatio = this.aspectRatio;
    if (!retinaScale(this, newRatio, true)) {
      return;
    }
    this.notifyPlugins("resize", {
      size: newSize
    });
    callback(options.onResize, [
      this,
      newSize
    ], this);
    if (this.attached) {
      if (this._doResize(mode)) {
        this.render();
      }
    }
  }
  ensureScalesHaveIDs() {
    const options = this.options;
    const scalesOptions = options.scales || {};
    each(scalesOptions, (axisOptions, axisID) => {
      axisOptions.id = axisID;
    });
  }
  buildOrUpdateScales() {
    const options = this.options;
    const scaleOpts = options.scales;
    const scales2 = this.scales;
    const updated = Object.keys(scales2).reduce((obj, id2) => {
      obj[id2] = false;
      return obj;
    }, {});
    let items = [];
    if (scaleOpts) {
      items = items.concat(Object.keys(scaleOpts).map((id2) => {
        const scaleOptions = scaleOpts[id2];
        const axis = determineAxis(id2, scaleOptions);
        const isRadial = axis === "r";
        const isHorizontal = axis === "x";
        return {
          options: scaleOptions,
          dposition: isRadial ? "chartArea" : isHorizontal ? "bottom" : "left",
          dtype: isRadial ? "radialLinear" : isHorizontal ? "category" : "linear"
        };
      }));
    }
    each(items, (item) => {
      const scaleOptions = item.options;
      const id2 = scaleOptions.id;
      const axis = determineAxis(id2, scaleOptions);
      const scaleType = valueOrDefault(scaleOptions.type, item.dtype);
      if (scaleOptions.position === void 0 || positionIsHorizontal(scaleOptions.position, axis) !== positionIsHorizontal(item.dposition)) {
        scaleOptions.position = item.dposition;
      }
      updated[id2] = true;
      let scale = null;
      if (id2 in scales2 && scales2[id2].type === scaleType) {
        scale = scales2[id2];
      } else {
        const scaleClass = registry.getScale(scaleType);
        scale = new scaleClass({
          id: id2,
          type: scaleType,
          ctx: this.ctx,
          chart: this
        });
        scales2[scale.id] = scale;
      }
      scale.init(scaleOptions, options);
    });
    each(updated, (hasUpdated, id2) => {
      if (!hasUpdated) {
        delete scales2[id2];
      }
    });
    each(scales2, (scale) => {
      layouts.configure(this, scale, scale.options);
      layouts.addBox(this, scale);
    });
  }
  _updateMetasets() {
    const metasets = this._metasets;
    const numData = this.data.datasets.length;
    const numMeta = metasets.length;
    metasets.sort((a, b) => a.index - b.index);
    if (numMeta > numData) {
      for (let i = numData; i < numMeta; ++i) {
        this._destroyDatasetMeta(i);
      }
      metasets.splice(numData, numMeta - numData);
    }
    this._sortedMetasets = metasets.slice(0).sort(compare2Level("order", "index"));
  }
  _removeUnreferencedMetasets() {
    const { _metasets: metasets, data: { datasets } } = this;
    if (metasets.length > datasets.length) {
      delete this._stacks;
    }
    metasets.forEach((meta, index2) => {
      if (datasets.filter((x2) => x2 === meta._dataset).length === 0) {
        this._destroyDatasetMeta(index2);
      }
    });
  }
  buildOrUpdateControllers() {
    const newControllers = [];
    const datasets = this.data.datasets;
    let i, ilen;
    this._removeUnreferencedMetasets();
    for (i = 0, ilen = datasets.length; i < ilen; i++) {
      const dataset = datasets[i];
      let meta = this.getDatasetMeta(i);
      const type = dataset.type || this.config.type;
      if (meta.type && meta.type !== type) {
        this._destroyDatasetMeta(i);
        meta = this.getDatasetMeta(i);
      }
      meta.type = type;
      meta.indexAxis = dataset.indexAxis || getIndexAxis(type, this.options);
      meta.order = dataset.order || 0;
      meta.index = i;
      meta.label = "" + dataset.label;
      meta.visible = this.isDatasetVisible(i);
      if (meta.controller) {
        meta.controller.updateIndex(i);
        meta.controller.linkScales();
      } else {
        const ControllerClass = registry.getController(type);
        const { datasetElementType, dataElementType } = defaults$1.datasets[type];
        Object.assign(ControllerClass, {
          dataElementType: registry.getElement(dataElementType),
          datasetElementType: datasetElementType && registry.getElement(datasetElementType)
        });
        meta.controller = new ControllerClass(this, i);
        newControllers.push(meta.controller);
      }
    }
    this._updateMetasets();
    return newControllers;
  }
  _resetElements() {
    each(this.data.datasets, (dataset, datasetIndex) => {
      this.getDatasetMeta(datasetIndex).controller.reset();
    }, this);
  }
  reset() {
    this._resetElements();
    this.notifyPlugins("reset");
  }
  update(mode) {
    const config = this.config;
    config.update();
    const options = this._options = config.createResolver(config.chartOptionScopes(), this.getContext());
    const animsDisabled = this._animationsDisabled = !options.animation;
    this._updateScales();
    this._checkEventBindings();
    this._updateHiddenIndices();
    this._plugins.invalidate();
    if (this.notifyPlugins("beforeUpdate", {
      mode,
      cancelable: true
    }) === false) {
      return;
    }
    const newControllers = this.buildOrUpdateControllers();
    this.notifyPlugins("beforeElementsUpdate");
    let minPadding = 0;
    for (let i = 0, ilen = this.data.datasets.length; i < ilen; i++) {
      const { controller } = this.getDatasetMeta(i);
      const reset = !animsDisabled && newControllers.indexOf(controller) === -1;
      controller.buildOrUpdateElements(reset);
      minPadding = Math.max(+controller.getMaxOverflow(), minPadding);
    }
    minPadding = this._minPadding = options.layout.autoPadding ? minPadding : 0;
    this._updateLayout(minPadding);
    if (!animsDisabled) {
      each(newControllers, (controller) => {
        controller.reset();
      });
    }
    this._updateDatasets(mode);
    this.notifyPlugins("afterUpdate", {
      mode
    });
    this._layers.sort(compare2Level("z", "_idx"));
    const { _active, _lastEvent } = this;
    if (_lastEvent) {
      this._eventHandler(_lastEvent, true);
    } else if (_active.length) {
      this._updateHoverStyles(_active, _active, true);
    }
    this.render();
  }
  _updateScales() {
    each(this.scales, (scale) => {
      layouts.removeBox(this, scale);
    });
    this.ensureScalesHaveIDs();
    this.buildOrUpdateScales();
  }
  _checkEventBindings() {
    const options = this.options;
    const existingEvents = new Set(Object.keys(this._listeners));
    const newEvents = new Set(options.events);
    if (!setsEqual(existingEvents, newEvents) || !!this._responsiveListeners !== options.responsive) {
      this.unbindEvents();
      this.bindEvents();
    }
  }
  _updateHiddenIndices() {
    const { _hiddenIndices } = this;
    const changes = this._getUniformDataChanges() || [];
    for (const { method, start, count } of changes) {
      const move = method === "_removeElements" ? -count : count;
      moveNumericKeys(_hiddenIndices, start, move);
    }
  }
  _getUniformDataChanges() {
    const _dataChanges = this._dataChanges;
    if (!_dataChanges || !_dataChanges.length) {
      return;
    }
    this._dataChanges = [];
    const datasetCount = this.data.datasets.length;
    const makeSet = (idx) => new Set(_dataChanges.filter((c) => c[0] === idx).map((c, i) => i + "," + c.splice(1).join(",")));
    const changeSet = makeSet(0);
    for (let i = 1; i < datasetCount; i++) {
      if (!setsEqual(changeSet, makeSet(i))) {
        return;
      }
    }
    return Array.from(changeSet).map((c) => c.split(",")).map((a) => ({
      method: a[1],
      start: +a[2],
      count: +a[3]
    }));
  }
  _updateLayout(minPadding) {
    if (this.notifyPlugins("beforeLayout", {
      cancelable: true
    }) === false) {
      return;
    }
    layouts.update(this, this.width, this.height, minPadding);
    const area = this.chartArea;
    const noArea = area.width <= 0 || area.height <= 0;
    this._layers = [];
    each(this.boxes, (box) => {
      if (noArea && box.position === "chartArea") {
        return;
      }
      if (box.configure) {
        box.configure();
      }
      this._layers.push(...box._layers());
    }, this);
    this._layers.forEach((item, index2) => {
      item._idx = index2;
    });
    this.notifyPlugins("afterLayout");
  }
  _updateDatasets(mode) {
    if (this.notifyPlugins("beforeDatasetsUpdate", {
      mode,
      cancelable: true
    }) === false) {
      return;
    }
    for (let i = 0, ilen = this.data.datasets.length; i < ilen; ++i) {
      this.getDatasetMeta(i).controller.configure();
    }
    for (let i = 0, ilen = this.data.datasets.length; i < ilen; ++i) {
      this._updateDataset(i, isFunction$1(mode) ? mode({
        datasetIndex: i
      }) : mode);
    }
    this.notifyPlugins("afterDatasetsUpdate", {
      mode
    });
  }
  _updateDataset(index2, mode) {
    const meta = this.getDatasetMeta(index2);
    const args = {
      meta,
      index: index2,
      mode,
      cancelable: true
    };
    if (this.notifyPlugins("beforeDatasetUpdate", args) === false) {
      return;
    }
    meta.controller._update(mode);
    args.cancelable = false;
    this.notifyPlugins("afterDatasetUpdate", args);
  }
  render() {
    if (this.notifyPlugins("beforeRender", {
      cancelable: true
    }) === false) {
      return;
    }
    if (animator.has(this)) {
      if (this.attached && !animator.running(this)) {
        animator.start(this);
      }
    } else {
      this.draw();
      onAnimationsComplete({
        chart: this
      });
    }
  }
  draw() {
    let i;
    if (this._resizeBeforeDraw) {
      const { width, height } = this._resizeBeforeDraw;
      this._resize(width, height);
      this._resizeBeforeDraw = null;
    }
    this.clear();
    if (this.width <= 0 || this.height <= 0) {
      return;
    }
    if (this.notifyPlugins("beforeDraw", {
      cancelable: true
    }) === false) {
      return;
    }
    const layers = this._layers;
    for (i = 0; i < layers.length && layers[i].z <= 0; ++i) {
      layers[i].draw(this.chartArea);
    }
    this._drawDatasets();
    for (; i < layers.length; ++i) {
      layers[i].draw(this.chartArea);
    }
    this.notifyPlugins("afterDraw");
  }
  _getSortedDatasetMetas(filterVisible) {
    const metasets = this._sortedMetasets;
    const result = [];
    let i, ilen;
    for (i = 0, ilen = metasets.length; i < ilen; ++i) {
      const meta = metasets[i];
      if (!filterVisible || meta.visible) {
        result.push(meta);
      }
    }
    return result;
  }
  getSortedVisibleDatasetMetas() {
    return this._getSortedDatasetMetas(true);
  }
  _drawDatasets() {
    if (this.notifyPlugins("beforeDatasetsDraw", {
      cancelable: true
    }) === false) {
      return;
    }
    const metasets = this.getSortedVisibleDatasetMetas();
    for (let i = metasets.length - 1; i >= 0; --i) {
      this._drawDataset(metasets[i]);
    }
    this.notifyPlugins("afterDatasetsDraw");
  }
  _drawDataset(meta) {
    const ctx = this.ctx;
    const clip = meta._clip;
    const useClip = !clip.disabled;
    const area = getDatasetArea(meta, this.chartArea);
    const args = {
      meta,
      index: meta.index,
      cancelable: true
    };
    if (this.notifyPlugins("beforeDatasetDraw", args) === false) {
      return;
    }
    if (useClip) {
      clipArea(ctx, {
        left: clip.left === false ? 0 : area.left - clip.left,
        right: clip.right === false ? this.width : area.right + clip.right,
        top: clip.top === false ? 0 : area.top - clip.top,
        bottom: clip.bottom === false ? this.height : area.bottom + clip.bottom
      });
    }
    meta.controller.draw();
    if (useClip) {
      unclipArea(ctx);
    }
    args.cancelable = false;
    this.notifyPlugins("afterDatasetDraw", args);
  }
  isPointInArea(point) {
    return _isPointInArea(point, this.chartArea, this._minPadding);
  }
  getElementsAtEventForMode(e, mode, options, useFinalPosition) {
    const method = Interaction.modes[mode];
    if (typeof method === "function") {
      return method(this, e, options, useFinalPosition);
    }
    return [];
  }
  getDatasetMeta(datasetIndex) {
    const dataset = this.data.datasets[datasetIndex];
    const metasets = this._metasets;
    let meta = metasets.filter((x2) => x2 && x2._dataset === dataset).pop();
    if (!meta) {
      meta = {
        type: null,
        data: [],
        dataset: null,
        controller: null,
        hidden: null,
        xAxisID: null,
        yAxisID: null,
        order: dataset && dataset.order || 0,
        index: datasetIndex,
        _dataset: dataset,
        _parsed: [],
        _sorted: false
      };
      metasets.push(meta);
    }
    return meta;
  }
  getContext() {
    return this.$context || (this.$context = createContext(null, {
      chart: this,
      type: "chart"
    }));
  }
  getVisibleDatasetCount() {
    return this.getSortedVisibleDatasetMetas().length;
  }
  isDatasetVisible(datasetIndex) {
    const dataset = this.data.datasets[datasetIndex];
    if (!dataset) {
      return false;
    }
    const meta = this.getDatasetMeta(datasetIndex);
    return typeof meta.hidden === "boolean" ? !meta.hidden : !dataset.hidden;
  }
  setDatasetVisibility(datasetIndex, visible) {
    const meta = this.getDatasetMeta(datasetIndex);
    meta.hidden = !visible;
  }
  toggleDataVisibility(index2) {
    this._hiddenIndices[index2] = !this._hiddenIndices[index2];
  }
  getDataVisibility(index2) {
    return !this._hiddenIndices[index2];
  }
  _updateVisibility(datasetIndex, dataIndex, visible) {
    const mode = visible ? "show" : "hide";
    const meta = this.getDatasetMeta(datasetIndex);
    const anims = meta.controller._resolveAnimations(void 0, mode);
    if (defined(dataIndex)) {
      meta.data[dataIndex].hidden = !visible;
      this.update();
    } else {
      this.setDatasetVisibility(datasetIndex, visible);
      anims.update(meta, {
        visible
      });
      this.update((ctx) => ctx.datasetIndex === datasetIndex ? mode : void 0);
    }
  }
  hide(datasetIndex, dataIndex) {
    this._updateVisibility(datasetIndex, dataIndex, false);
  }
  show(datasetIndex, dataIndex) {
    this._updateVisibility(datasetIndex, dataIndex, true);
  }
  _destroyDatasetMeta(datasetIndex) {
    const meta = this._metasets[datasetIndex];
    if (meta && meta.controller) {
      meta.controller._destroy();
    }
    delete this._metasets[datasetIndex];
  }
  _stop() {
    let i, ilen;
    this.stop();
    animator.remove(this);
    for (i = 0, ilen = this.data.datasets.length; i < ilen; ++i) {
      this._destroyDatasetMeta(i);
    }
  }
  destroy() {
    this.notifyPlugins("beforeDestroy");
    const { canvas, ctx } = this;
    this._stop();
    this.config.clearCache();
    if (canvas) {
      this.unbindEvents();
      clearCanvas(canvas, ctx);
      this.platform.releaseContext(ctx);
      this.canvas = null;
      this.ctx = null;
    }
    delete instances[this.id];
    this.notifyPlugins("afterDestroy");
  }
  toBase64Image(...args) {
    return this.canvas.toDataURL(...args);
  }
  bindEvents() {
    this.bindUserEvents();
    if (this.options.responsive) {
      this.bindResponsiveEvents();
    } else {
      this.attached = true;
    }
  }
  bindUserEvents() {
    const listeners2 = this._listeners;
    const platform = this.platform;
    const _add = (type, listener2) => {
      platform.addEventListener(this, type, listener2);
      listeners2[type] = listener2;
    };
    const listener = (e, x2, y2) => {
      e.offsetX = x2;
      e.offsetY = y2;
      this._eventHandler(e);
    };
    each(this.options.events, (type) => _add(type, listener));
  }
  bindResponsiveEvents() {
    if (!this._responsiveListeners) {
      this._responsiveListeners = {};
    }
    const listeners2 = this._responsiveListeners;
    const platform = this.platform;
    const _add = (type, listener2) => {
      platform.addEventListener(this, type, listener2);
      listeners2[type] = listener2;
    };
    const _remove = (type, listener2) => {
      if (listeners2[type]) {
        platform.removeEventListener(this, type, listener2);
        delete listeners2[type];
      }
    };
    const listener = (width, height) => {
      if (this.canvas) {
        this.resize(width, height);
      }
    };
    let detached;
    const attached = () => {
      _remove("attach", attached);
      this.attached = true;
      this.resize();
      _add("resize", listener);
      _add("detach", detached);
    };
    detached = () => {
      this.attached = false;
      _remove("resize", listener);
      this._stop();
      this._resize(0, 0);
      _add("attach", attached);
    };
    if (platform.isAttached(this.canvas)) {
      attached();
    } else {
      detached();
    }
  }
  unbindEvents() {
    each(this._listeners, (listener, type) => {
      this.platform.removeEventListener(this, type, listener);
    });
    this._listeners = {};
    each(this._responsiveListeners, (listener, type) => {
      this.platform.removeEventListener(this, type, listener);
    });
    this._responsiveListeners = void 0;
  }
  updateHoverStyle(items, mode, enabled) {
    const prefix = enabled ? "set" : "remove";
    let meta, item, i, ilen;
    if (mode === "dataset") {
      meta = this.getDatasetMeta(items[0].datasetIndex);
      meta.controller["_" + prefix + "DatasetHoverStyle"]();
    }
    for (i = 0, ilen = items.length; i < ilen; ++i) {
      item = items[i];
      const controller = item && this.getDatasetMeta(item.datasetIndex).controller;
      if (controller) {
        controller[prefix + "HoverStyle"](item.element, item.datasetIndex, item.index);
      }
    }
  }
  getActiveElements() {
    return this._active || [];
  }
  setActiveElements(activeElements) {
    const lastActive = this._active || [];
    const active = activeElements.map(({ datasetIndex, index: index2 }) => {
      const meta = this.getDatasetMeta(datasetIndex);
      if (!meta) {
        throw new Error("No dataset found at index " + datasetIndex);
      }
      return {
        datasetIndex,
        element: meta.data[index2],
        index: index2
      };
    });
    const changed = !_elementsEqual(active, lastActive);
    if (changed) {
      this._active = active;
      this._lastEvent = null;
      this._updateHoverStyles(active, lastActive);
    }
  }
  notifyPlugins(hook, args, filter) {
    return this._plugins.notify(this, hook, args, filter);
  }
  isPluginEnabled(pluginId) {
    return this._plugins._cache.filter((p2) => p2.plugin.id === pluginId).length === 1;
  }
  _updateHoverStyles(active, lastActive, replay) {
    const hoverOptions = this.options.hover;
    const diff2 = (a, b) => a.filter((x2) => !b.some((y2) => x2.datasetIndex === y2.datasetIndex && x2.index === y2.index));
    const deactivated = diff2(lastActive, active);
    const activated = replay ? active : diff2(active, lastActive);
    if (deactivated.length) {
      this.updateHoverStyle(deactivated, hoverOptions.mode, false);
    }
    if (activated.length && hoverOptions.mode) {
      this.updateHoverStyle(activated, hoverOptions.mode, true);
    }
  }
  _eventHandler(e, replay) {
    const args = {
      event: e,
      replay,
      cancelable: true,
      inChartArea: this.isPointInArea(e)
    };
    const eventFilter = (plugin) => (plugin.options.events || this.options.events).includes(e.native.type);
    if (this.notifyPlugins("beforeEvent", args, eventFilter) === false) {
      return;
    }
    const changed = this._handleEvent(e, replay, args.inChartArea);
    args.cancelable = false;
    this.notifyPlugins("afterEvent", args, eventFilter);
    if (changed || args.changed) {
      this.render();
    }
    return this;
  }
  _handleEvent(e, replay, inChartArea) {
    const { _active: lastActive = [], options } = this;
    const useFinalPosition = replay;
    const active = this._getActiveElements(e, lastActive, inChartArea, useFinalPosition);
    const isClick = _isClickEvent(e);
    const lastEvent = determineLastEvent(e, this._lastEvent, inChartArea, isClick);
    if (inChartArea) {
      this._lastEvent = null;
      callback(options.onHover, [
        e,
        active,
        this
      ], this);
      if (isClick) {
        callback(options.onClick, [
          e,
          active,
          this
        ], this);
      }
    }
    const changed = !_elementsEqual(active, lastActive);
    if (changed || replay) {
      this._active = active;
      this._updateHoverStyles(active, lastActive, replay);
    }
    this._lastEvent = lastEvent;
    return changed;
  }
  _getActiveElements(e, lastActive, inChartArea, useFinalPosition) {
    if (e.type === "mouseout") {
      return [];
    }
    if (!inChartArea) {
      return lastActive;
    }
    const hoverOptions = this.options.hover;
    return this.getElementsAtEventForMode(e, hoverOptions.mode, hoverOptions, useFinalPosition);
  }
}, __publicField(_b, "defaults", defaults$1), __publicField(_b, "instances", instances), __publicField(_b, "overrides", overrides), __publicField(_b, "registry", registry), __publicField(_b, "version", version), __publicField(_b, "getChart", getChart), _b);
function invalidatePlugins() {
  return each(Chart$1.instances, (chart) => chart._plugins.invalidate());
}
function clipArc(ctx, element, endAngle) {
  const { startAngle, pixelMargin, x: x2, y: y2, outerRadius, innerRadius } = element;
  let angleMargin = pixelMargin / outerRadius;
  ctx.beginPath();
  ctx.arc(x2, y2, outerRadius, startAngle - angleMargin, endAngle + angleMargin);
  if (innerRadius > pixelMargin) {
    angleMargin = pixelMargin / innerRadius;
    ctx.arc(x2, y2, innerRadius, endAngle + angleMargin, startAngle - angleMargin, true);
  } else {
    ctx.arc(x2, y2, pixelMargin, endAngle + HALF_PI, startAngle - HALF_PI);
  }
  ctx.closePath();
  ctx.clip();
}
function toRadiusCorners(value) {
  return _readValueToProps(value, [
    "outerStart",
    "outerEnd",
    "innerStart",
    "innerEnd"
  ]);
}
function parseBorderRadius$1(arc, innerRadius, outerRadius, angleDelta) {
  const o = toRadiusCorners(arc.options.borderRadius);
  const halfThickness = (outerRadius - innerRadius) / 2;
  const innerLimit = Math.min(halfThickness, angleDelta * innerRadius / 2);
  const computeOuterLimit = (val) => {
    const outerArcLimit = (outerRadius - Math.min(halfThickness, val)) * angleDelta / 2;
    return _limitValue(val, 0, Math.min(halfThickness, outerArcLimit));
  };
  return {
    outerStart: computeOuterLimit(o.outerStart),
    outerEnd: computeOuterLimit(o.outerEnd),
    innerStart: _limitValue(o.innerStart, 0, innerLimit),
    innerEnd: _limitValue(o.innerEnd, 0, innerLimit)
  };
}
function rThetaToXY(r2, theta, x2, y2) {
  return {
    x: x2 + r2 * Math.cos(theta),
    y: y2 + r2 * Math.sin(theta)
  };
}
function pathArc(ctx, element, offset2, spacing, end, circular) {
  const { x: x2, y: y2, startAngle: start, pixelMargin, innerRadius: innerR } = element;
  const outerRadius = Math.max(element.outerRadius + spacing + offset2 - pixelMargin, 0);
  const innerRadius = innerR > 0 ? innerR + spacing + offset2 + pixelMargin : 0;
  let spacingOffset = 0;
  const alpha2 = end - start;
  if (spacing) {
    const noSpacingInnerRadius = innerR > 0 ? innerR - spacing : 0;
    const noSpacingOuterRadius = outerRadius > 0 ? outerRadius - spacing : 0;
    const avNogSpacingRadius = (noSpacingInnerRadius + noSpacingOuterRadius) / 2;
    const adjustedAngle = avNogSpacingRadius !== 0 ? alpha2 * avNogSpacingRadius / (avNogSpacingRadius + spacing) : alpha2;
    spacingOffset = (alpha2 - adjustedAngle) / 2;
  }
  const beta = Math.max(1e-3, alpha2 * outerRadius - offset2 / PI) / outerRadius;
  const angleOffset = (alpha2 - beta) / 2;
  const startAngle = start + angleOffset + spacingOffset;
  const endAngle = end - angleOffset - spacingOffset;
  const { outerStart, outerEnd, innerStart, innerEnd } = parseBorderRadius$1(element, innerRadius, outerRadius, endAngle - startAngle);
  const outerStartAdjustedRadius = outerRadius - outerStart;
  const outerEndAdjustedRadius = outerRadius - outerEnd;
  const outerStartAdjustedAngle = startAngle + outerStart / outerStartAdjustedRadius;
  const outerEndAdjustedAngle = endAngle - outerEnd / outerEndAdjustedRadius;
  const innerStartAdjustedRadius = innerRadius + innerStart;
  const innerEndAdjustedRadius = innerRadius + innerEnd;
  const innerStartAdjustedAngle = startAngle + innerStart / innerStartAdjustedRadius;
  const innerEndAdjustedAngle = endAngle - innerEnd / innerEndAdjustedRadius;
  ctx.beginPath();
  if (circular) {
    const outerMidAdjustedAngle = (outerStartAdjustedAngle + outerEndAdjustedAngle) / 2;
    ctx.arc(x2, y2, outerRadius, outerStartAdjustedAngle, outerMidAdjustedAngle);
    ctx.arc(x2, y2, outerRadius, outerMidAdjustedAngle, outerEndAdjustedAngle);
    if (outerEnd > 0) {
      const pCenter = rThetaToXY(outerEndAdjustedRadius, outerEndAdjustedAngle, x2, y2);
      ctx.arc(pCenter.x, pCenter.y, outerEnd, outerEndAdjustedAngle, endAngle + HALF_PI);
    }
    const p4 = rThetaToXY(innerEndAdjustedRadius, endAngle, x2, y2);
    ctx.lineTo(p4.x, p4.y);
    if (innerEnd > 0) {
      const pCenter = rThetaToXY(innerEndAdjustedRadius, innerEndAdjustedAngle, x2, y2);
      ctx.arc(pCenter.x, pCenter.y, innerEnd, endAngle + HALF_PI, innerEndAdjustedAngle + Math.PI);
    }
    const innerMidAdjustedAngle = (endAngle - innerEnd / innerRadius + (startAngle + innerStart / innerRadius)) / 2;
    ctx.arc(x2, y2, innerRadius, endAngle - innerEnd / innerRadius, innerMidAdjustedAngle, true);
    ctx.arc(x2, y2, innerRadius, innerMidAdjustedAngle, startAngle + innerStart / innerRadius, true);
    if (innerStart > 0) {
      const pCenter = rThetaToXY(innerStartAdjustedRadius, innerStartAdjustedAngle, x2, y2);
      ctx.arc(pCenter.x, pCenter.y, innerStart, innerStartAdjustedAngle + Math.PI, startAngle - HALF_PI);
    }
    const p8 = rThetaToXY(outerStartAdjustedRadius, startAngle, x2, y2);
    ctx.lineTo(p8.x, p8.y);
    if (outerStart > 0) {
      const pCenter = rThetaToXY(outerStartAdjustedRadius, outerStartAdjustedAngle, x2, y2);
      ctx.arc(pCenter.x, pCenter.y, outerStart, startAngle - HALF_PI, outerStartAdjustedAngle);
    }
  } else {
    ctx.moveTo(x2, y2);
    const outerStartX = Math.cos(outerStartAdjustedAngle) * outerRadius + x2;
    const outerStartY = Math.sin(outerStartAdjustedAngle) * outerRadius + y2;
    ctx.lineTo(outerStartX, outerStartY);
    const outerEndX = Math.cos(outerEndAdjustedAngle) * outerRadius + x2;
    const outerEndY = Math.sin(outerEndAdjustedAngle) * outerRadius + y2;
    ctx.lineTo(outerEndX, outerEndY);
  }
  ctx.closePath();
}
function drawArc(ctx, element, offset2, spacing, circular) {
  const { fullCircles, startAngle, circumference } = element;
  let endAngle = element.endAngle;
  if (fullCircles) {
    pathArc(ctx, element, offset2, spacing, endAngle, circular);
    for (let i = 0; i < fullCircles; ++i) {
      ctx.fill();
    }
    if (!isNaN(circumference)) {
      endAngle = startAngle + (circumference % TAU || TAU);
    }
  }
  pathArc(ctx, element, offset2, spacing, endAngle, circular);
  ctx.fill();
  return endAngle;
}
function drawBorder(ctx, element, offset2, spacing, circular) {
  const { fullCircles, startAngle, circumference, options } = element;
  const { borderWidth, borderJoinStyle, borderDash, borderDashOffset } = options;
  const inner = options.borderAlign === "inner";
  if (!borderWidth) {
    return;
  }
  ctx.setLineDash(borderDash || []);
  ctx.lineDashOffset = borderDashOffset;
  if (inner) {
    ctx.lineWidth = borderWidth * 2;
    ctx.lineJoin = borderJoinStyle || "round";
  } else {
    ctx.lineWidth = borderWidth;
    ctx.lineJoin = borderJoinStyle || "bevel";
  }
  let endAngle = element.endAngle;
  if (fullCircles) {
    pathArc(ctx, element, offset2, spacing, endAngle, circular);
    for (let i = 0; i < fullCircles; ++i) {
      ctx.stroke();
    }
    if (!isNaN(circumference)) {
      endAngle = startAngle + (circumference % TAU || TAU);
    }
  }
  if (inner) {
    clipArc(ctx, element, endAngle);
  }
  if (!fullCircles) {
    pathArc(ctx, element, offset2, spacing, endAngle, circular);
    ctx.stroke();
  }
}
class ArcElement extends Element$1 {
  constructor(cfg) {
    super();
    __publicField(this, "circumference");
    __publicField(this, "endAngle");
    __publicField(this, "fullCircles");
    __publicField(this, "innerRadius");
    __publicField(this, "outerRadius");
    __publicField(this, "pixelMargin");
    __publicField(this, "startAngle");
    this.options = void 0;
    this.circumference = void 0;
    this.startAngle = void 0;
    this.endAngle = void 0;
    this.innerRadius = void 0;
    this.outerRadius = void 0;
    this.pixelMargin = 0;
    this.fullCircles = 0;
    if (cfg) {
      Object.assign(this, cfg);
    }
  }
  inRange(chartX, chartY, useFinalPosition) {
    const point = this.getProps([
      "x",
      "y"
    ], useFinalPosition);
    const { angle, distance } = getAngleFromPoint(point, {
      x: chartX,
      y: chartY
    });
    const { startAngle, endAngle, innerRadius, outerRadius, circumference } = this.getProps([
      "startAngle",
      "endAngle",
      "innerRadius",
      "outerRadius",
      "circumference"
    ], useFinalPosition);
    const rAdjust = (this.options.spacing + this.options.borderWidth) / 2;
    const _circumference = valueOrDefault(circumference, endAngle - startAngle);
    const betweenAngles = _circumference >= TAU || _angleBetween(angle, startAngle, endAngle);
    const withinRadius = _isBetween(distance, innerRadius + rAdjust, outerRadius + rAdjust);
    return betweenAngles && withinRadius;
  }
  getCenterPoint(useFinalPosition) {
    const { x: x2, y: y2, startAngle, endAngle, innerRadius, outerRadius } = this.getProps([
      "x",
      "y",
      "startAngle",
      "endAngle",
      "innerRadius",
      "outerRadius"
    ], useFinalPosition);
    const { offset: offset2, spacing } = this.options;
    const halfAngle = (startAngle + endAngle) / 2;
    const halfRadius = (innerRadius + outerRadius + spacing + offset2) / 2;
    return {
      x: x2 + Math.cos(halfAngle) * halfRadius,
      y: y2 + Math.sin(halfAngle) * halfRadius
    };
  }
  tooltipPosition(useFinalPosition) {
    return this.getCenterPoint(useFinalPosition);
  }
  draw(ctx) {
    const { options, circumference } = this;
    const offset2 = (options.offset || 0) / 4;
    const spacing = (options.spacing || 0) / 2;
    const circular = options.circular;
    this.pixelMargin = options.borderAlign === "inner" ? 0.33 : 0;
    this.fullCircles = circumference > TAU ? Math.floor(circumference / TAU) : 0;
    if (circumference === 0 || this.innerRadius < 0 || this.outerRadius < 0) {
      return;
    }
    ctx.save();
    const halfAngle = (this.startAngle + this.endAngle) / 2;
    ctx.translate(Math.cos(halfAngle) * offset2, Math.sin(halfAngle) * offset2);
    const fix = 1 - Math.sin(Math.min(PI, circumference || 0));
    const radiusOffset = offset2 * fix;
    ctx.fillStyle = options.backgroundColor;
    ctx.strokeStyle = options.borderColor;
    drawArc(ctx, this, radiusOffset, spacing, circular);
    drawBorder(ctx, this, radiusOffset, spacing, circular);
    ctx.restore();
  }
}
__publicField(ArcElement, "id", "arc");
__publicField(ArcElement, "defaults", {
  borderAlign: "center",
  borderColor: "#fff",
  borderDash: [],
  borderDashOffset: 0,
  borderJoinStyle: void 0,
  borderRadius: 0,
  borderWidth: 2,
  offset: 0,
  spacing: 0,
  angle: void 0,
  circular: true
});
__publicField(ArcElement, "defaultRoutes", {
  backgroundColor: "backgroundColor"
});
__publicField(ArcElement, "descriptors", {
  _scriptable: true,
  _indexable: (name) => name !== "borderDash"
});
function setStyle(ctx, options, style2 = options) {
  ctx.lineCap = valueOrDefault(style2.borderCapStyle, options.borderCapStyle);
  ctx.setLineDash(valueOrDefault(style2.borderDash, options.borderDash));
  ctx.lineDashOffset = valueOrDefault(style2.borderDashOffset, options.borderDashOffset);
  ctx.lineJoin = valueOrDefault(style2.borderJoinStyle, options.borderJoinStyle);
  ctx.lineWidth = valueOrDefault(style2.borderWidth, options.borderWidth);
  ctx.strokeStyle = valueOrDefault(style2.borderColor, options.borderColor);
}
function lineTo(ctx, previous, target) {
  ctx.lineTo(target.x, target.y);
}
function getLineMethod(options) {
  if (options.stepped) {
    return _steppedLineTo;
  }
  if (options.tension || options.cubicInterpolationMode === "monotone") {
    return _bezierCurveTo;
  }
  return lineTo;
}
function pathVars(points, segment, params = {}) {
  const count = points.length;
  const { start: paramsStart = 0, end: paramsEnd = count - 1 } = params;
  const { start: segmentStart, end: segmentEnd } = segment;
  const start = Math.max(paramsStart, segmentStart);
  const end = Math.min(paramsEnd, segmentEnd);
  const outside = paramsStart < segmentStart && paramsEnd < segmentStart || paramsStart > segmentEnd && paramsEnd > segmentEnd;
  return {
    count,
    start,
    loop: segment.loop,
    ilen: end < start && !outside ? count + end - start : end - start
  };
}
function pathSegment(ctx, line, segment, params) {
  const { points, options } = line;
  const { count, start, loop, ilen } = pathVars(points, segment, params);
  const lineMethod = getLineMethod(options);
  let { move = true, reverse } = params || {};
  let i, point, prev;
  for (i = 0; i <= ilen; ++i) {
    point = points[(start + (reverse ? ilen - i : i)) % count];
    if (point.skip) {
      continue;
    } else if (move) {
      ctx.moveTo(point.x, point.y);
      move = false;
    } else {
      lineMethod(ctx, prev, point, reverse, options.stepped);
    }
    prev = point;
  }
  if (loop) {
    point = points[(start + (reverse ? ilen : 0)) % count];
    lineMethod(ctx, prev, point, reverse, options.stepped);
  }
  return !!loop;
}
function fastPathSegment(ctx, line, segment, params) {
  const points = line.points;
  const { count, start, ilen } = pathVars(points, segment, params);
  const { move = true, reverse } = params || {};
  let avgX = 0;
  let countX = 0;
  let i, point, prevX, minY, maxY, lastY;
  const pointIndex = (index2) => (start + (reverse ? ilen - index2 : index2)) % count;
  const drawX = () => {
    if (minY !== maxY) {
      ctx.lineTo(avgX, maxY);
      ctx.lineTo(avgX, minY);
      ctx.lineTo(avgX, lastY);
    }
  };
  if (move) {
    point = points[pointIndex(0)];
    ctx.moveTo(point.x, point.y);
  }
  for (i = 0; i <= ilen; ++i) {
    point = points[pointIndex(i)];
    if (point.skip) {
      continue;
    }
    const x2 = point.x;
    const y2 = point.y;
    const truncX = x2 | 0;
    if (truncX === prevX) {
      if (y2 < minY) {
        minY = y2;
      } else if (y2 > maxY) {
        maxY = y2;
      }
      avgX = (countX * avgX + x2) / ++countX;
    } else {
      drawX();
      ctx.lineTo(x2, y2);
      prevX = truncX;
      countX = 0;
      minY = maxY = y2;
    }
    lastY = y2;
  }
  drawX();
}
function _getSegmentMethod(line) {
  const opts = line.options;
  const borderDash = opts.borderDash && opts.borderDash.length;
  const useFastPath = !line._decimated && !line._loop && !opts.tension && opts.cubicInterpolationMode !== "monotone" && !opts.stepped && !borderDash;
  return useFastPath ? fastPathSegment : pathSegment;
}
function _getInterpolationMethod(options) {
  if (options.stepped) {
    return _steppedInterpolation;
  }
  if (options.tension || options.cubicInterpolationMode === "monotone") {
    return _bezierInterpolation;
  }
  return _pointInLine;
}
function strokePathWithCache(ctx, line, start, count) {
  let path = line._path;
  if (!path) {
    path = line._path = new Path2D();
    if (line.path(path, start, count)) {
      path.closePath();
    }
  }
  setStyle(ctx, line.options);
  ctx.stroke(path);
}
function strokePathDirect(ctx, line, start, count) {
  const { segments, options } = line;
  const segmentMethod = _getSegmentMethod(line);
  for (const segment of segments) {
    setStyle(ctx, options, segment.style);
    ctx.beginPath();
    if (segmentMethod(ctx, line, segment, {
      start,
      end: start + count - 1
    })) {
      ctx.closePath();
    }
    ctx.stroke();
  }
}
const usePath2D = typeof Path2D === "function";
function draw(ctx, line, start, count) {
  if (usePath2D && !line.options.segment) {
    strokePathWithCache(ctx, line, start, count);
  } else {
    strokePathDirect(ctx, line, start, count);
  }
}
class LineElement extends Element$1 {
  constructor(cfg) {
    super();
    this.animated = true;
    this.options = void 0;
    this._chart = void 0;
    this._loop = void 0;
    this._fullLoop = void 0;
    this._path = void 0;
    this._points = void 0;
    this._segments = void 0;
    this._decimated = false;
    this._pointsUpdated = false;
    this._datasetIndex = void 0;
    if (cfg) {
      Object.assign(this, cfg);
    }
  }
  updateControlPoints(chartArea, indexAxis) {
    const options = this.options;
    if ((options.tension || options.cubicInterpolationMode === "monotone") && !options.stepped && !this._pointsUpdated) {
      const loop = options.spanGaps ? this._loop : this._fullLoop;
      _updateBezierControlPoints(this._points, options, chartArea, loop, indexAxis);
      this._pointsUpdated = true;
    }
  }
  set points(points) {
    this._points = points;
    delete this._segments;
    delete this._path;
    this._pointsUpdated = false;
  }
  get points() {
    return this._points;
  }
  get segments() {
    return this._segments || (this._segments = _computeSegments(this, this.options.segment));
  }
  first() {
    const segments = this.segments;
    const points = this.points;
    return segments.length && points[segments[0].start];
  }
  last() {
    const segments = this.segments;
    const points = this.points;
    const count = segments.length;
    return count && points[segments[count - 1].end];
  }
  interpolate(point, property) {
    const options = this.options;
    const value = point[property];
    const points = this.points;
    const segments = _boundSegments(this, {
      property,
      start: value,
      end: value
    });
    if (!segments.length) {
      return;
    }
    const result = [];
    const _interpolate = _getInterpolationMethod(options);
    let i, ilen;
    for (i = 0, ilen = segments.length; i < ilen; ++i) {
      const { start, end } = segments[i];
      const p1 = points[start];
      const p2 = points[end];
      if (p1 === p2) {
        result.push(p1);
        continue;
      }
      const t2 = Math.abs((value - p1[property]) / (p2[property] - p1[property]));
      const interpolated = _interpolate(p1, p2, t2, options.stepped);
      interpolated[property] = point[property];
      result.push(interpolated);
    }
    return result.length === 1 ? result[0] : result;
  }
  pathSegment(ctx, segment, params) {
    const segmentMethod = _getSegmentMethod(this);
    return segmentMethod(ctx, this, segment, params);
  }
  path(ctx, start, count) {
    const segments = this.segments;
    const segmentMethod = _getSegmentMethod(this);
    let loop = this._loop;
    start = start || 0;
    count = count || this.points.length - start;
    for (const segment of segments) {
      loop &= segmentMethod(ctx, this, segment, {
        start,
        end: start + count - 1
      });
    }
    return !!loop;
  }
  draw(ctx, chartArea, start, count) {
    const options = this.options || {};
    const points = this.points || [];
    if (points.length && options.borderWidth) {
      ctx.save();
      draw(ctx, this, start, count);
      ctx.restore();
    }
    if (this.animated) {
      this._pointsUpdated = false;
      this._path = void 0;
    }
  }
}
__publicField(LineElement, "id", "line");
__publicField(LineElement, "defaults", {
  borderCapStyle: "butt",
  borderDash: [],
  borderDashOffset: 0,
  borderJoinStyle: "miter",
  borderWidth: 3,
  capBezierPoints: true,
  cubicInterpolationMode: "default",
  fill: false,
  spanGaps: false,
  stepped: false,
  tension: 0
});
__publicField(LineElement, "defaultRoutes", {
  backgroundColor: "backgroundColor",
  borderColor: "borderColor"
});
__publicField(LineElement, "descriptors", {
  _scriptable: true,
  _indexable: (name) => name !== "borderDash" && name !== "fill"
});
function inRange$1(el2, pos, axis, useFinalPosition) {
  const options = el2.options;
  const { [axis]: value } = el2.getProps([
    axis
  ], useFinalPosition);
  return Math.abs(pos - value) < options.radius + options.hitRadius;
}
class PointElement extends Element$1 {
  constructor(cfg) {
    super();
    __publicField(this, "parsed");
    __publicField(this, "skip");
    __publicField(this, "stop");
    this.options = void 0;
    this.parsed = void 0;
    this.skip = void 0;
    this.stop = void 0;
    if (cfg) {
      Object.assign(this, cfg);
    }
  }
  inRange(mouseX, mouseY, useFinalPosition) {
    const options = this.options;
    const { x: x2, y: y2 } = this.getProps([
      "x",
      "y"
    ], useFinalPosition);
    return Math.pow(mouseX - x2, 2) + Math.pow(mouseY - y2, 2) < Math.pow(options.hitRadius + options.radius, 2);
  }
  inXRange(mouseX, useFinalPosition) {
    return inRange$1(this, mouseX, "x", useFinalPosition);
  }
  inYRange(mouseY, useFinalPosition) {
    return inRange$1(this, mouseY, "y", useFinalPosition);
  }
  getCenterPoint(useFinalPosition) {
    const { x: x2, y: y2 } = this.getProps([
      "x",
      "y"
    ], useFinalPosition);
    return {
      x: x2,
      y: y2
    };
  }
  size(options) {
    options = options || this.options || {};
    let radius = options.radius || 0;
    radius = Math.max(radius, radius && options.hoverRadius || 0);
    const borderWidth = radius && options.borderWidth || 0;
    return (radius + borderWidth) * 2;
  }
  draw(ctx, area) {
    const options = this.options;
    if (this.skip || options.radius < 0.1 || !_isPointInArea(this, area, this.size(options) / 2)) {
      return;
    }
    ctx.strokeStyle = options.borderColor;
    ctx.lineWidth = options.borderWidth;
    ctx.fillStyle = options.backgroundColor;
    drawPoint(ctx, options, this.x, this.y);
  }
  getRange() {
    const options = this.options || {};
    return options.radius + options.hitRadius;
  }
}
__publicField(PointElement, "id", "point");
/**
* @type {any}
*/
__publicField(PointElement, "defaults", {
  borderWidth: 1,
  hitRadius: 1,
  hoverBorderWidth: 1,
  hoverRadius: 4,
  pointStyle: "circle",
  radius: 3,
  rotation: 0
});
/**
* @type {any}
*/
__publicField(PointElement, "defaultRoutes", {
  backgroundColor: "backgroundColor",
  borderColor: "borderColor"
});
function getBarBounds(bar, useFinalPosition) {
  const { x: x2, y: y2, base, width, height } = bar.getProps([
    "x",
    "y",
    "base",
    "width",
    "height"
  ], useFinalPosition);
  let left, right, top, bottom, half;
  if (bar.horizontal) {
    half = height / 2;
    left = Math.min(x2, base);
    right = Math.max(x2, base);
    top = y2 - half;
    bottom = y2 + half;
  } else {
    half = width / 2;
    left = x2 - half;
    right = x2 + half;
    top = Math.min(y2, base);
    bottom = Math.max(y2, base);
  }
  return {
    left,
    top,
    right,
    bottom
  };
}
function skipOrLimit(skip2, value, min2, max2) {
  return skip2 ? 0 : _limitValue(value, min2, max2);
}
function parseBorderWidth(bar, maxW, maxH) {
  const value = bar.options.borderWidth;
  const skip2 = bar.borderSkipped;
  const o = toTRBL(value);
  return {
    t: skipOrLimit(skip2.top, o.top, 0, maxH),
    r: skipOrLimit(skip2.right, o.right, 0, maxW),
    b: skipOrLimit(skip2.bottom, o.bottom, 0, maxH),
    l: skipOrLimit(skip2.left, o.left, 0, maxW)
  };
}
function parseBorderRadius(bar, maxW, maxH) {
  const { enableBorderRadius } = bar.getProps([
    "enableBorderRadius"
  ]);
  const value = bar.options.borderRadius;
  const o = toTRBLCorners(value);
  const maxR = Math.min(maxW, maxH);
  const skip2 = bar.borderSkipped;
  const enableBorder = enableBorderRadius || isObject$1(value);
  return {
    topLeft: skipOrLimit(!enableBorder || skip2.top || skip2.left, o.topLeft, 0, maxR),
    topRight: skipOrLimit(!enableBorder || skip2.top || skip2.right, o.topRight, 0, maxR),
    bottomLeft: skipOrLimit(!enableBorder || skip2.bottom || skip2.left, o.bottomLeft, 0, maxR),
    bottomRight: skipOrLimit(!enableBorder || skip2.bottom || skip2.right, o.bottomRight, 0, maxR)
  };
}
function boundingRects(bar) {
  const bounds = getBarBounds(bar);
  const width = bounds.right - bounds.left;
  const height = bounds.bottom - bounds.top;
  const border = parseBorderWidth(bar, width / 2, height / 2);
  const radius = parseBorderRadius(bar, width / 2, height / 2);
  return {
    outer: {
      x: bounds.left,
      y: bounds.top,
      w: width,
      h: height,
      radius
    },
    inner: {
      x: bounds.left + border.l,
      y: bounds.top + border.t,
      w: width - border.l - border.r,
      h: height - border.t - border.b,
      radius: {
        topLeft: Math.max(0, radius.topLeft - Math.max(border.t, border.l)),
        topRight: Math.max(0, radius.topRight - Math.max(border.t, border.r)),
        bottomLeft: Math.max(0, radius.bottomLeft - Math.max(border.b, border.l)),
        bottomRight: Math.max(0, radius.bottomRight - Math.max(border.b, border.r))
      }
    }
  };
}
function inRange(bar, x2, y2, useFinalPosition) {
  const skipX = x2 === null;
  const skipY = y2 === null;
  const skipBoth = skipX && skipY;
  const bounds = bar && !skipBoth && getBarBounds(bar, useFinalPosition);
  return bounds && (skipX || _isBetween(x2, bounds.left, bounds.right)) && (skipY || _isBetween(y2, bounds.top, bounds.bottom));
}
function hasRadius(radius) {
  return radius.topLeft || radius.topRight || radius.bottomLeft || radius.bottomRight;
}
function addNormalRectPath(ctx, rect) {
  ctx.rect(rect.x, rect.y, rect.w, rect.h);
}
function inflateRect(rect, amount, refRect = {}) {
  const x2 = rect.x !== refRect.x ? -amount : 0;
  const y2 = rect.y !== refRect.y ? -amount : 0;
  const w2 = (rect.x + rect.w !== refRect.x + refRect.w ? amount : 0) - x2;
  const h = (rect.y + rect.h !== refRect.y + refRect.h ? amount : 0) - y2;
  return {
    x: rect.x + x2,
    y: rect.y + y2,
    w: rect.w + w2,
    h: rect.h + h,
    radius: rect.radius
  };
}
class BarElement extends Element$1 {
  constructor(cfg) {
    super();
    this.options = void 0;
    this.horizontal = void 0;
    this.base = void 0;
    this.width = void 0;
    this.height = void 0;
    this.inflateAmount = void 0;
    if (cfg) {
      Object.assign(this, cfg);
    }
  }
  draw(ctx) {
    const { inflateAmount, options: { borderColor, backgroundColor } } = this;
    const { inner, outer } = boundingRects(this);
    const addRectPath = hasRadius(outer.radius) ? addRoundedRectPath : addNormalRectPath;
    ctx.save();
    if (outer.w !== inner.w || outer.h !== inner.h) {
      ctx.beginPath();
      addRectPath(ctx, inflateRect(outer, inflateAmount, inner));
      ctx.clip();
      addRectPath(ctx, inflateRect(inner, -inflateAmount, outer));
      ctx.fillStyle = borderColor;
      ctx.fill("evenodd");
    }
    ctx.beginPath();
    addRectPath(ctx, inflateRect(inner, inflateAmount));
    ctx.fillStyle = backgroundColor;
    ctx.fill();
    ctx.restore();
  }
  inRange(mouseX, mouseY, useFinalPosition) {
    return inRange(this, mouseX, mouseY, useFinalPosition);
  }
  inXRange(mouseX, useFinalPosition) {
    return inRange(this, mouseX, null, useFinalPosition);
  }
  inYRange(mouseY, useFinalPosition) {
    return inRange(this, null, mouseY, useFinalPosition);
  }
  getCenterPoint(useFinalPosition) {
    const { x: x2, y: y2, base, horizontal } = this.getProps([
      "x",
      "y",
      "base",
      "horizontal"
    ], useFinalPosition);
    return {
      x: horizontal ? (x2 + base) / 2 : x2,
      y: horizontal ? y2 : (y2 + base) / 2
    };
  }
  getRange(axis) {
    return axis === "x" ? this.width / 2 : this.height / 2;
  }
}
__publicField(BarElement, "id", "bar");
__publicField(BarElement, "defaults", {
  borderSkipped: "start",
  borderWidth: 0,
  borderRadius: 0,
  inflateAmount: "auto",
  pointStyle: void 0
});
__publicField(BarElement, "defaultRoutes", {
  backgroundColor: "backgroundColor",
  borderColor: "borderColor"
});
var elements = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  ArcElement,
  BarElement,
  LineElement,
  PointElement
});
const BORDER_COLORS = [
  "rgb(54, 162, 235)",
  "rgb(255, 99, 132)",
  "rgb(255, 159, 64)",
  "rgb(255, 205, 86)",
  "rgb(75, 192, 192)",
  "rgb(153, 102, 255)",
  "rgb(201, 203, 207)"
  // grey
];
const BACKGROUND_COLORS = /* @__PURE__ */ BORDER_COLORS.map((color2) => color2.replace("rgb(", "rgba(").replace(")", ", 0.5)"));
function getBorderColor(i) {
  return BORDER_COLORS[i % BORDER_COLORS.length];
}
function getBackgroundColor(i) {
  return BACKGROUND_COLORS[i % BACKGROUND_COLORS.length];
}
function colorizeDefaultDataset(dataset, i) {
  dataset.borderColor = getBorderColor(i);
  dataset.backgroundColor = getBackgroundColor(i);
  return ++i;
}
function colorizeDoughnutDataset(dataset, i) {
  dataset.backgroundColor = dataset.data.map(() => getBorderColor(i++));
  return i;
}
function colorizePolarAreaDataset(dataset, i) {
  dataset.backgroundColor = dataset.data.map(() => getBackgroundColor(i++));
  return i;
}
function getColorizer(chart) {
  let i = 0;
  return (dataset, datasetIndex) => {
    const controller = chart.getDatasetMeta(datasetIndex).controller;
    if (controller instanceof DoughnutController) {
      i = colorizeDoughnutDataset(dataset, i);
    } else if (controller instanceof PolarAreaController) {
      i = colorizePolarAreaDataset(dataset, i);
    } else if (controller) {
      i = colorizeDefaultDataset(dataset, i);
    }
  };
}
function containsColorsDefinitions(descriptors2) {
  let k2;
  for (k2 in descriptors2) {
    if (descriptors2[k2].borderColor || descriptors2[k2].backgroundColor) {
      return true;
    }
  }
  return false;
}
function containsColorsDefinition(descriptor) {
  return descriptor && (descriptor.borderColor || descriptor.backgroundColor);
}
var plugin_colors = {
  id: "colors",
  defaults: {
    enabled: true,
    forceOverride: false
  },
  beforeLayout(chart, _args, options) {
    if (!options.enabled) {
      return;
    }
    const { data: { datasets }, options: chartOptions } = chart.config;
    const { elements: elements2 } = chartOptions;
    if (!options.forceOverride && (containsColorsDefinitions(datasets) || containsColorsDefinition(chartOptions) || elements2 && containsColorsDefinitions(elements2))) {
      return;
    }
    const colorizer = getColorizer(chart);
    datasets.forEach(colorizer);
  }
};
function lttbDecimation(data, start, count, availableWidth, options) {
  const samples = options.samples || availableWidth;
  if (samples >= count) {
    return data.slice(start, start + count);
  }
  const decimated = [];
  const bucketWidth = (count - 2) / (samples - 2);
  let sampledIndex = 0;
  const endIndex = start + count - 1;
  let a = start;
  let i, maxAreaPoint, maxArea, area, nextA;
  decimated[sampledIndex++] = data[a];
  for (i = 0; i < samples - 2; i++) {
    let avgX = 0;
    let avgY = 0;
    let j;
    const avgRangeStart = Math.floor((i + 1) * bucketWidth) + 1 + start;
    const avgRangeEnd = Math.min(Math.floor((i + 2) * bucketWidth) + 1, count) + start;
    const avgRangeLength = avgRangeEnd - avgRangeStart;
    for (j = avgRangeStart; j < avgRangeEnd; j++) {
      avgX += data[j].x;
      avgY += data[j].y;
    }
    avgX /= avgRangeLength;
    avgY /= avgRangeLength;
    const rangeOffs = Math.floor(i * bucketWidth) + 1 + start;
    const rangeTo = Math.min(Math.floor((i + 1) * bucketWidth) + 1, count) + start;
    const { x: pointAx, y: pointAy } = data[a];
    maxArea = area = -1;
    for (j = rangeOffs; j < rangeTo; j++) {
      area = 0.5 * Math.abs((pointAx - avgX) * (data[j].y - pointAy) - (pointAx - data[j].x) * (avgY - pointAy));
      if (area > maxArea) {
        maxArea = area;
        maxAreaPoint = data[j];
        nextA = j;
      }
    }
    decimated[sampledIndex++] = maxAreaPoint;
    a = nextA;
  }
  decimated[sampledIndex++] = data[endIndex];
  return decimated;
}
function minMaxDecimation(data, start, count, availableWidth) {
  let avgX = 0;
  let countX = 0;
  let i, point, x2, y2, prevX, minIndex, maxIndex, startIndex, minY, maxY;
  const decimated = [];
  const endIndex = start + count - 1;
  const xMin = data[start].x;
  const xMax = data[endIndex].x;
  const dx = xMax - xMin;
  for (i = start; i < start + count; ++i) {
    point = data[i];
    x2 = (point.x - xMin) / dx * availableWidth;
    y2 = point.y;
    const truncX = x2 | 0;
    if (truncX === prevX) {
      if (y2 < minY) {
        minY = y2;
        minIndex = i;
      } else if (y2 > maxY) {
        maxY = y2;
        maxIndex = i;
      }
      avgX = (countX * avgX + point.x) / ++countX;
    } else {
      const lastIndex = i - 1;
      if (!isNullOrUndef(minIndex) && !isNullOrUndef(maxIndex)) {
        const intermediateIndex1 = Math.min(minIndex, maxIndex);
        const intermediateIndex2 = Math.max(minIndex, maxIndex);
        if (intermediateIndex1 !== startIndex && intermediateIndex1 !== lastIndex) {
          decimated.push({
            ...data[intermediateIndex1],
            x: avgX
          });
        }
        if (intermediateIndex2 !== startIndex && intermediateIndex2 !== lastIndex) {
          decimated.push({
            ...data[intermediateIndex2],
            x: avgX
          });
        }
      }
      if (i > 0 && lastIndex !== startIndex) {
        decimated.push(data[lastIndex]);
      }
      decimated.push(point);
      prevX = truncX;
      countX = 0;
      minY = maxY = y2;
      minIndex = maxIndex = startIndex = i;
    }
  }
  return decimated;
}
function cleanDecimatedDataset(dataset) {
  if (dataset._decimated) {
    const data = dataset._data;
    delete dataset._decimated;
    delete dataset._data;
    Object.defineProperty(dataset, "data", {
      configurable: true,
      enumerable: true,
      writable: true,
      value: data
    });
  }
}
function cleanDecimatedData(chart) {
  chart.data.datasets.forEach((dataset) => {
    cleanDecimatedDataset(dataset);
  });
}
function getStartAndCountOfVisiblePointsSimplified(meta, points) {
  const pointCount = points.length;
  let start = 0;
  let count;
  const { iScale } = meta;
  const { min: min2, max: max2, minDefined, maxDefined } = iScale.getUserBounds();
  if (minDefined) {
    start = _limitValue(_lookupByKey(points, iScale.axis, min2).lo, 0, pointCount - 1);
  }
  if (maxDefined) {
    count = _limitValue(_lookupByKey(points, iScale.axis, max2).hi + 1, start, pointCount) - start;
  } else {
    count = pointCount - start;
  }
  return {
    start,
    count
  };
}
var plugin_decimation = {
  id: "decimation",
  defaults: {
    algorithm: "min-max",
    enabled: false
  },
  beforeElementsUpdate: (chart, args, options) => {
    if (!options.enabled) {
      cleanDecimatedData(chart);
      return;
    }
    const availableWidth = chart.width;
    chart.data.datasets.forEach((dataset, datasetIndex) => {
      const { _data, indexAxis } = dataset;
      const meta = chart.getDatasetMeta(datasetIndex);
      const data = _data || dataset.data;
      if (resolve([
        indexAxis,
        chart.options.indexAxis
      ]) === "y") {
        return;
      }
      if (!meta.controller.supportsDecimation) {
        return;
      }
      const xAxis = chart.scales[meta.xAxisID];
      if (xAxis.type !== "linear" && xAxis.type !== "time") {
        return;
      }
      if (chart.options.parsing) {
        return;
      }
      let { start, count } = getStartAndCountOfVisiblePointsSimplified(meta, data);
      const threshold = options.threshold || 4 * availableWidth;
      if (count <= threshold) {
        cleanDecimatedDataset(dataset);
        return;
      }
      if (isNullOrUndef(_data)) {
        dataset._data = data;
        delete dataset.data;
        Object.defineProperty(dataset, "data", {
          configurable: true,
          enumerable: true,
          get: function() {
            return this._decimated;
          },
          set: function(d) {
            this._data = d;
          }
        });
      }
      let decimated;
      switch (options.algorithm) {
        case "lttb":
          decimated = lttbDecimation(data, start, count, availableWidth, options);
          break;
        case "min-max":
          decimated = minMaxDecimation(data, start, count, availableWidth);
          break;
        default:
          throw new Error(`Unsupported decimation algorithm '${options.algorithm}'`);
      }
      dataset._decimated = decimated;
    });
  },
  destroy(chart) {
    cleanDecimatedData(chart);
  }
};
function _segments(line, target, property) {
  const segments = line.segments;
  const points = line.points;
  const tpoints = target.points;
  const parts = [];
  for (const segment of segments) {
    let { start, end } = segment;
    end = _findSegmentEnd(start, end, points);
    const bounds = _getBounds(property, points[start], points[end], segment.loop);
    if (!target.segments) {
      parts.push({
        source: segment,
        target: bounds,
        start: points[start],
        end: points[end]
      });
      continue;
    }
    const targetSegments = _boundSegments(target, bounds);
    for (const tgt of targetSegments) {
      const subBounds = _getBounds(property, tpoints[tgt.start], tpoints[tgt.end], tgt.loop);
      const fillSources = _boundSegment(segment, points, subBounds);
      for (const fillSource of fillSources) {
        parts.push({
          source: fillSource,
          target: tgt,
          start: {
            [property]: _getEdge(bounds, subBounds, "start", Math.max)
          },
          end: {
            [property]: _getEdge(bounds, subBounds, "end", Math.min)
          }
        });
      }
    }
  }
  return parts;
}
function _getBounds(property, first, last2, loop) {
  if (loop) {
    return;
  }
  let start = first[property];
  let end = last2[property];
  if (property === "angle") {
    start = _normalizeAngle(start);
    end = _normalizeAngle(end);
  }
  return {
    property,
    start,
    end
  };
}
function _pointsFromSegments(boundary, line) {
  const { x: x2 = null, y: y2 = null } = boundary || {};
  const linePoints = line.points;
  const points = [];
  line.segments.forEach(({ start, end }) => {
    end = _findSegmentEnd(start, end, linePoints);
    const first = linePoints[start];
    const last2 = linePoints[end];
    if (y2 !== null) {
      points.push({
        x: first.x,
        y: y2
      });
      points.push({
        x: last2.x,
        y: y2
      });
    } else if (x2 !== null) {
      points.push({
        x: x2,
        y: first.y
      });
      points.push({
        x: x2,
        y: last2.y
      });
    }
  });
  return points;
}
function _findSegmentEnd(start, end, points) {
  for (; end > start; end--) {
    const point = points[end];
    if (!isNaN(point.x) && !isNaN(point.y)) {
      break;
    }
  }
  return end;
}
function _getEdge(a, b, prop, fn) {
  if (a && b) {
    return fn(a[prop], b[prop]);
  }
  return a ? a[prop] : b ? b[prop] : 0;
}
function _createBoundaryLine(boundary, line) {
  let points = [];
  let _loop = false;
  if (isArray$1(boundary)) {
    _loop = true;
    points = boundary;
  } else {
    points = _pointsFromSegments(boundary, line);
  }
  return points.length ? new LineElement({
    points,
    options: {
      tension: 0
    },
    _loop,
    _fullLoop: _loop
  }) : null;
}
function _shouldApplyFill(source) {
  return source && source.fill !== false;
}
function _resolveTarget(sources, index2, propagate) {
  const source = sources[index2];
  let fill2 = source.fill;
  const visited = [
    index2
  ];
  let target;
  if (!propagate) {
    return fill2;
  }
  while (fill2 !== false && visited.indexOf(fill2) === -1) {
    if (!isNumberFinite(fill2)) {
      return fill2;
    }
    target = sources[fill2];
    if (!target) {
      return false;
    }
    if (target.visible) {
      return fill2;
    }
    visited.push(fill2);
    fill2 = target.fill;
  }
  return false;
}
function _decodeFill(line, index2, count) {
  const fill2 = parseFillOption(line);
  if (isObject$1(fill2)) {
    return isNaN(fill2.value) ? false : fill2;
  }
  let target = parseFloat(fill2);
  if (isNumberFinite(target) && Math.floor(target) === target) {
    return decodeTargetIndex(fill2[0], index2, target, count);
  }
  return [
    "origin",
    "start",
    "end",
    "stack",
    "shape"
  ].indexOf(fill2) >= 0 && fill2;
}
function decodeTargetIndex(firstCh, index2, target, count) {
  if (firstCh === "-" || firstCh === "+") {
    target = index2 + target;
  }
  if (target === index2 || target < 0 || target >= count) {
    return false;
  }
  return target;
}
function _getTargetPixel(fill2, scale) {
  let pixel = null;
  if (fill2 === "start") {
    pixel = scale.bottom;
  } else if (fill2 === "end") {
    pixel = scale.top;
  } else if (isObject$1(fill2)) {
    pixel = scale.getPixelForValue(fill2.value);
  } else if (scale.getBasePixel) {
    pixel = scale.getBasePixel();
  }
  return pixel;
}
function _getTargetValue(fill2, scale, startValue) {
  let value;
  if (fill2 === "start") {
    value = startValue;
  } else if (fill2 === "end") {
    value = scale.options.reverse ? scale.min : scale.max;
  } else if (isObject$1(fill2)) {
    value = fill2.value;
  } else {
    value = scale.getBaseValue();
  }
  return value;
}
function parseFillOption(line) {
  const options = line.options;
  const fillOption = options.fill;
  let fill2 = valueOrDefault(fillOption && fillOption.target, fillOption);
  if (fill2 === void 0) {
    fill2 = !!options.backgroundColor;
  }
  if (fill2 === false || fill2 === null) {
    return false;
  }
  if (fill2 === true) {
    return "origin";
  }
  return fill2;
}
function _buildStackLine(source) {
  const { scale, index: index2, line } = source;
  const points = [];
  const segments = line.segments;
  const sourcePoints = line.points;
  const linesBelow = getLinesBelow(scale, index2);
  linesBelow.push(_createBoundaryLine({
    x: null,
    y: scale.bottom
  }, line));
  for (let i = 0; i < segments.length; i++) {
    const segment = segments[i];
    for (let j = segment.start; j <= segment.end; j++) {
      addPointsBelow(points, sourcePoints[j], linesBelow);
    }
  }
  return new LineElement({
    points,
    options: {}
  });
}
function getLinesBelow(scale, index2) {
  const below = [];
  const metas = scale.getMatchingVisibleMetas("line");
  for (let i = 0; i < metas.length; i++) {
    const meta = metas[i];
    if (meta.index === index2) {
      break;
    }
    if (!meta.hidden) {
      below.unshift(meta.dataset);
    }
  }
  return below;
}
function addPointsBelow(points, sourcePoint, linesBelow) {
  const postponed = [];
  for (let j = 0; j < linesBelow.length; j++) {
    const line = linesBelow[j];
    const { first, last: last2, point } = findPoint(line, sourcePoint, "x");
    if (!point || first && last2) {
      continue;
    }
    if (first) {
      postponed.unshift(point);
    } else {
      points.push(point);
      if (!last2) {
        break;
      }
    }
  }
  points.push(...postponed);
}
function findPoint(line, sourcePoint, property) {
  const point = line.interpolate(sourcePoint, property);
  if (!point) {
    return {};
  }
  const pointValue = point[property];
  const segments = line.segments;
  const linePoints = line.points;
  let first = false;
  let last2 = false;
  for (let i = 0; i < segments.length; i++) {
    const segment = segments[i];
    const firstValue = linePoints[segment.start][property];
    const lastValue = linePoints[segment.end][property];
    if (_isBetween(pointValue, firstValue, lastValue)) {
      first = pointValue === firstValue;
      last2 = pointValue === lastValue;
      break;
    }
  }
  return {
    first,
    last: last2,
    point
  };
}
class simpleArc {
  constructor(opts) {
    this.x = opts.x;
    this.y = opts.y;
    this.radius = opts.radius;
  }
  pathSegment(ctx, bounds, opts) {
    const { x: x2, y: y2, radius } = this;
    bounds = bounds || {
      start: 0,
      end: TAU
    };
    ctx.arc(x2, y2, radius, bounds.end, bounds.start, true);
    return !opts.bounds;
  }
  interpolate(point) {
    const { x: x2, y: y2, radius } = this;
    const angle = point.angle;
    return {
      x: x2 + Math.cos(angle) * radius,
      y: y2 + Math.sin(angle) * radius,
      angle
    };
  }
}
function _getTarget(source) {
  const { chart, fill: fill2, line } = source;
  if (isNumberFinite(fill2)) {
    return getLineByIndex(chart, fill2);
  }
  if (fill2 === "stack") {
    return _buildStackLine(source);
  }
  if (fill2 === "shape") {
    return true;
  }
  const boundary = computeBoundary(source);
  if (boundary instanceof simpleArc) {
    return boundary;
  }
  return _createBoundaryLine(boundary, line);
}
function getLineByIndex(chart, index2) {
  const meta = chart.getDatasetMeta(index2);
  const visible = meta && chart.isDatasetVisible(index2);
  return visible ? meta.dataset : null;
}
function computeBoundary(source) {
  const scale = source.scale || {};
  if (scale.getPointPositionForValue) {
    return computeCircularBoundary(source);
  }
  return computeLinearBoundary(source);
}
function computeLinearBoundary(source) {
  const { scale = {}, fill: fill2 } = source;
  const pixel = _getTargetPixel(fill2, scale);
  if (isNumberFinite(pixel)) {
    const horizontal = scale.isHorizontal();
    return {
      x: horizontal ? pixel : null,
      y: horizontal ? null : pixel
    };
  }
  return null;
}
function computeCircularBoundary(source) {
  const { scale, fill: fill2 } = source;
  const options = scale.options;
  const length = scale.getLabels().length;
  const start = options.reverse ? scale.max : scale.min;
  const value = _getTargetValue(fill2, scale, start);
  const target = [];
  if (options.grid.circular) {
    const center = scale.getPointPositionForValue(0, start);
    return new simpleArc({
      x: center.x,
      y: center.y,
      radius: scale.getDistanceFromCenterForValue(value)
    });
  }
  for (let i = 0; i < length; ++i) {
    target.push(scale.getPointPositionForValue(i, value));
  }
  return target;
}
function _drawfill(ctx, source, area) {
  const target = _getTarget(source);
  const { line, scale, axis } = source;
  const lineOpts = line.options;
  const fillOption = lineOpts.fill;
  const color2 = lineOpts.backgroundColor;
  const { above = color2, below = color2 } = fillOption || {};
  if (target && line.points.length) {
    clipArea(ctx, area);
    doFill(ctx, {
      line,
      target,
      above,
      below,
      area,
      scale,
      axis
    });
    unclipArea(ctx);
  }
}
function doFill(ctx, cfg) {
  const { line, target, above, below, area, scale } = cfg;
  const property = line._loop ? "angle" : cfg.axis;
  ctx.save();
  if (property === "x" && below !== above) {
    clipVertical(ctx, target, area.top);
    fill(ctx, {
      line,
      target,
      color: above,
      scale,
      property
    });
    ctx.restore();
    ctx.save();
    clipVertical(ctx, target, area.bottom);
  }
  fill(ctx, {
    line,
    target,
    color: below,
    scale,
    property
  });
  ctx.restore();
}
function clipVertical(ctx, target, clipY) {
  const { segments, points } = target;
  let first = true;
  let lineLoop = false;
  ctx.beginPath();
  for (const segment of segments) {
    const { start, end } = segment;
    const firstPoint = points[start];
    const lastPoint = points[_findSegmentEnd(start, end, points)];
    if (first) {
      ctx.moveTo(firstPoint.x, firstPoint.y);
      first = false;
    } else {
      ctx.lineTo(firstPoint.x, clipY);
      ctx.lineTo(firstPoint.x, firstPoint.y);
    }
    lineLoop = !!target.pathSegment(ctx, segment, {
      move: lineLoop
    });
    if (lineLoop) {
      ctx.closePath();
    } else {
      ctx.lineTo(lastPoint.x, clipY);
    }
  }
  ctx.lineTo(target.first().x, clipY);
  ctx.closePath();
  ctx.clip();
}
function fill(ctx, cfg) {
  const { line, target, property, color: color2, scale } = cfg;
  const segments = _segments(line, target, property);
  for (const { source: src, target: tgt, start, end } of segments) {
    const { style: { backgroundColor = color2 } = {} } = src;
    const notShape = target !== true;
    ctx.save();
    ctx.fillStyle = backgroundColor;
    clipBounds(ctx, scale, notShape && _getBounds(property, start, end));
    ctx.beginPath();
    const lineLoop = !!line.pathSegment(ctx, src);
    let loop;
    if (notShape) {
      if (lineLoop) {
        ctx.closePath();
      } else {
        interpolatedLineTo(ctx, target, end, property);
      }
      const targetLoop = !!target.pathSegment(ctx, tgt, {
        move: lineLoop,
        reverse: true
      });
      loop = lineLoop && targetLoop;
      if (!loop) {
        interpolatedLineTo(ctx, target, start, property);
      }
    }
    ctx.closePath();
    ctx.fill(loop ? "evenodd" : "nonzero");
    ctx.restore();
  }
}
function clipBounds(ctx, scale, bounds) {
  const { top, bottom } = scale.chart.chartArea;
  const { property, start, end } = bounds || {};
  if (property === "x") {
    ctx.beginPath();
    ctx.rect(start, top, end - start, bottom - top);
    ctx.clip();
  }
}
function interpolatedLineTo(ctx, target, point, property) {
  const interpolatedPoint = target.interpolate(point, property);
  if (interpolatedPoint) {
    ctx.lineTo(interpolatedPoint.x, interpolatedPoint.y);
  }
}
var index$1 = {
  id: "filler",
  afterDatasetsUpdate(chart, _args, options) {
    const count = (chart.data.datasets || []).length;
    const sources = [];
    let meta, i, line, source;
    for (i = 0; i < count; ++i) {
      meta = chart.getDatasetMeta(i);
      line = meta.dataset;
      source = null;
      if (line && line.options && line instanceof LineElement) {
        source = {
          visible: chart.isDatasetVisible(i),
          index: i,
          fill: _decodeFill(line, i, count),
          chart,
          axis: meta.controller.options.indexAxis,
          scale: meta.vScale,
          line
        };
      }
      meta.$filler = source;
      sources.push(source);
    }
    for (i = 0; i < count; ++i) {
      source = sources[i];
      if (!source || source.fill === false) {
        continue;
      }
      source.fill = _resolveTarget(sources, i, options.propagate);
    }
  },
  beforeDraw(chart, _args, options) {
    const draw2 = options.drawTime === "beforeDraw";
    const metasets = chart.getSortedVisibleDatasetMetas();
    const area = chart.chartArea;
    for (let i = metasets.length - 1; i >= 0; --i) {
      const source = metasets[i].$filler;
      if (!source) {
        continue;
      }
      source.line.updateControlPoints(area, source.axis);
      if (draw2 && source.fill) {
        _drawfill(chart.ctx, source, area);
      }
    }
  },
  beforeDatasetsDraw(chart, _args, options) {
    if (options.drawTime !== "beforeDatasetsDraw") {
      return;
    }
    const metasets = chart.getSortedVisibleDatasetMetas();
    for (let i = metasets.length - 1; i >= 0; --i) {
      const source = metasets[i].$filler;
      if (_shouldApplyFill(source)) {
        _drawfill(chart.ctx, source, chart.chartArea);
      }
    }
  },
  beforeDatasetDraw(chart, args, options) {
    const source = args.meta.$filler;
    if (!_shouldApplyFill(source) || options.drawTime !== "beforeDatasetDraw") {
      return;
    }
    _drawfill(chart.ctx, source, chart.chartArea);
  },
  defaults: {
    propagate: true,
    drawTime: "beforeDatasetDraw"
  }
};
const getBoxSize = (labelOpts, fontSize) => {
  let { boxHeight = fontSize, boxWidth = fontSize } = labelOpts;
  if (labelOpts.usePointStyle) {
    boxHeight = Math.min(boxHeight, fontSize);
    boxWidth = labelOpts.pointStyleWidth || Math.min(boxWidth, fontSize);
  }
  return {
    boxWidth,
    boxHeight,
    itemHeight: Math.max(fontSize, boxHeight)
  };
};
const itemsEqual = (a, b) => a !== null && b !== null && a.datasetIndex === b.datasetIndex && a.index === b.index;
class Legend extends Element$1 {
  constructor(config) {
    super();
    this._added = false;
    this.legendHitBoxes = [];
    this._hoveredItem = null;
    this.doughnutMode = false;
    this.chart = config.chart;
    this.options = config.options;
    this.ctx = config.ctx;
    this.legendItems = void 0;
    this.columnSizes = void 0;
    this.lineWidths = void 0;
    this.maxHeight = void 0;
    this.maxWidth = void 0;
    this.top = void 0;
    this.bottom = void 0;
    this.left = void 0;
    this.right = void 0;
    this.height = void 0;
    this.width = void 0;
    this._margins = void 0;
    this.position = void 0;
    this.weight = void 0;
    this.fullSize = void 0;
  }
  update(maxWidth, maxHeight, margins) {
    this.maxWidth = maxWidth;
    this.maxHeight = maxHeight;
    this._margins = margins;
    this.setDimensions();
    this.buildLabels();
    this.fit();
  }
  setDimensions() {
    if (this.isHorizontal()) {
      this.width = this.maxWidth;
      this.left = this._margins.left;
      this.right = this.width;
    } else {
      this.height = this.maxHeight;
      this.top = this._margins.top;
      this.bottom = this.height;
    }
  }
  buildLabels() {
    const labelOpts = this.options.labels || {};
    let legendItems = callback(labelOpts.generateLabels, [
      this.chart
    ], this) || [];
    if (labelOpts.filter) {
      legendItems = legendItems.filter((item) => labelOpts.filter(item, this.chart.data));
    }
    if (labelOpts.sort) {
      legendItems = legendItems.sort((a, b) => labelOpts.sort(a, b, this.chart.data));
    }
    if (this.options.reverse) {
      legendItems.reverse();
    }
    this.legendItems = legendItems;
  }
  fit() {
    const { options, ctx } = this;
    if (!options.display) {
      this.width = this.height = 0;
      return;
    }
    const labelOpts = options.labels;
    const labelFont = toFont(labelOpts.font);
    const fontSize = labelFont.size;
    const titleHeight = this._computeTitleHeight();
    const { boxWidth, itemHeight } = getBoxSize(labelOpts, fontSize);
    let width, height;
    ctx.font = labelFont.string;
    if (this.isHorizontal()) {
      width = this.maxWidth;
      height = this._fitRows(titleHeight, fontSize, boxWidth, itemHeight) + 10;
    } else {
      height = this.maxHeight;
      width = this._fitCols(titleHeight, labelFont, boxWidth, itemHeight) + 10;
    }
    this.width = Math.min(width, options.maxWidth || this.maxWidth);
    this.height = Math.min(height, options.maxHeight || this.maxHeight);
  }
  _fitRows(titleHeight, fontSize, boxWidth, itemHeight) {
    const { ctx, maxWidth, options: { labels: { padding } } } = this;
    const hitboxes = this.legendHitBoxes = [];
    const lineWidths = this.lineWidths = [
      0
    ];
    const lineHeight = itemHeight + padding;
    let totalHeight = titleHeight;
    ctx.textAlign = "left";
    ctx.textBaseline = "middle";
    let row = -1;
    let top = -lineHeight;
    this.legendItems.forEach((legendItem, i) => {
      const itemWidth = boxWidth + fontSize / 2 + ctx.measureText(legendItem.text).width;
      if (i === 0 || lineWidths[lineWidths.length - 1] + itemWidth + 2 * padding > maxWidth) {
        totalHeight += lineHeight;
        lineWidths[lineWidths.length - (i > 0 ? 0 : 1)] = 0;
        top += lineHeight;
        row++;
      }
      hitboxes[i] = {
        left: 0,
        top,
        row,
        width: itemWidth,
        height: itemHeight
      };
      lineWidths[lineWidths.length - 1] += itemWidth + padding;
    });
    return totalHeight;
  }
  _fitCols(titleHeight, labelFont, boxWidth, _itemHeight) {
    const { ctx, maxHeight, options: { labels: { padding } } } = this;
    const hitboxes = this.legendHitBoxes = [];
    const columnSizes = this.columnSizes = [];
    const heightLimit = maxHeight - titleHeight;
    let totalWidth = padding;
    let currentColWidth = 0;
    let currentColHeight = 0;
    let left = 0;
    let col = 0;
    this.legendItems.forEach((legendItem, i) => {
      const { itemWidth, itemHeight } = calculateItemSize(boxWidth, labelFont, ctx, legendItem, _itemHeight);
      if (i > 0 && currentColHeight + itemHeight + 2 * padding > heightLimit) {
        totalWidth += currentColWidth + padding;
        columnSizes.push({
          width: currentColWidth,
          height: currentColHeight
        });
        left += currentColWidth + padding;
        col++;
        currentColWidth = currentColHeight = 0;
      }
      hitboxes[i] = {
        left,
        top: currentColHeight,
        col,
        width: itemWidth,
        height: itemHeight
      };
      currentColWidth = Math.max(currentColWidth, itemWidth);
      currentColHeight += itemHeight + padding;
    });
    totalWidth += currentColWidth;
    columnSizes.push({
      width: currentColWidth,
      height: currentColHeight
    });
    return totalWidth;
  }
  adjustHitBoxes() {
    if (!this.options.display) {
      return;
    }
    const titleHeight = this._computeTitleHeight();
    const { legendHitBoxes: hitboxes, options: { align, labels: { padding }, rtl } } = this;
    const rtlHelper = getRtlAdapter(rtl, this.left, this.width);
    if (this.isHorizontal()) {
      let row = 0;
      let left = _alignStartEnd(align, this.left + padding, this.right - this.lineWidths[row]);
      for (const hitbox of hitboxes) {
        if (row !== hitbox.row) {
          row = hitbox.row;
          left = _alignStartEnd(align, this.left + padding, this.right - this.lineWidths[row]);
        }
        hitbox.top += this.top + titleHeight + padding;
        hitbox.left = rtlHelper.leftForLtr(rtlHelper.x(left), hitbox.width);
        left += hitbox.width + padding;
      }
    } else {
      let col = 0;
      let top = _alignStartEnd(align, this.top + titleHeight + padding, this.bottom - this.columnSizes[col].height);
      for (const hitbox of hitboxes) {
        if (hitbox.col !== col) {
          col = hitbox.col;
          top = _alignStartEnd(align, this.top + titleHeight + padding, this.bottom - this.columnSizes[col].height);
        }
        hitbox.top = top;
        hitbox.left += this.left + padding;
        hitbox.left = rtlHelper.leftForLtr(rtlHelper.x(hitbox.left), hitbox.width);
        top += hitbox.height + padding;
      }
    }
  }
  isHorizontal() {
    return this.options.position === "top" || this.options.position === "bottom";
  }
  draw() {
    if (this.options.display) {
      const ctx = this.ctx;
      clipArea(ctx, this);
      this._draw();
      unclipArea(ctx);
    }
  }
  _draw() {
    const { options: opts, columnSizes, lineWidths, ctx } = this;
    const { align, labels: labelOpts } = opts;
    const defaultColor = defaults$1.color;
    const rtlHelper = getRtlAdapter(opts.rtl, this.left, this.width);
    const labelFont = toFont(labelOpts.font);
    const { padding } = labelOpts;
    const fontSize = labelFont.size;
    const halfFontSize = fontSize / 2;
    let cursor;
    this.drawTitle();
    ctx.textAlign = rtlHelper.textAlign("left");
    ctx.textBaseline = "middle";
    ctx.lineWidth = 0.5;
    ctx.font = labelFont.string;
    const { boxWidth, boxHeight, itemHeight } = getBoxSize(labelOpts, fontSize);
    const drawLegendBox = function(x2, y2, legendItem) {
      if (isNaN(boxWidth) || boxWidth <= 0 || isNaN(boxHeight) || boxHeight < 0) {
        return;
      }
      ctx.save();
      const lineWidth = valueOrDefault(legendItem.lineWidth, 1);
      ctx.fillStyle = valueOrDefault(legendItem.fillStyle, defaultColor);
      ctx.lineCap = valueOrDefault(legendItem.lineCap, "butt");
      ctx.lineDashOffset = valueOrDefault(legendItem.lineDashOffset, 0);
      ctx.lineJoin = valueOrDefault(legendItem.lineJoin, "miter");
      ctx.lineWidth = lineWidth;
      ctx.strokeStyle = valueOrDefault(legendItem.strokeStyle, defaultColor);
      ctx.setLineDash(valueOrDefault(legendItem.lineDash, []));
      if (labelOpts.usePointStyle) {
        const drawOptions = {
          radius: boxHeight * Math.SQRT2 / 2,
          pointStyle: legendItem.pointStyle,
          rotation: legendItem.rotation,
          borderWidth: lineWidth
        };
        const centerX = rtlHelper.xPlus(x2, boxWidth / 2);
        const centerY = y2 + halfFontSize;
        drawPointLegend(ctx, drawOptions, centerX, centerY, labelOpts.pointStyleWidth && boxWidth);
      } else {
        const yBoxTop = y2 + Math.max((fontSize - boxHeight) / 2, 0);
        const xBoxLeft = rtlHelper.leftForLtr(x2, boxWidth);
        const borderRadius = toTRBLCorners(legendItem.borderRadius);
        ctx.beginPath();
        if (Object.values(borderRadius).some((v2) => v2 !== 0)) {
          addRoundedRectPath(ctx, {
            x: xBoxLeft,
            y: yBoxTop,
            w: boxWidth,
            h: boxHeight,
            radius: borderRadius
          });
        } else {
          ctx.rect(xBoxLeft, yBoxTop, boxWidth, boxHeight);
        }
        ctx.fill();
        if (lineWidth !== 0) {
          ctx.stroke();
        }
      }
      ctx.restore();
    };
    const fillText = function(x2, y2, legendItem) {
      renderText(ctx, legendItem.text, x2, y2 + itemHeight / 2, labelFont, {
        strikethrough: legendItem.hidden,
        textAlign: rtlHelper.textAlign(legendItem.textAlign)
      });
    };
    const isHorizontal = this.isHorizontal();
    const titleHeight = this._computeTitleHeight();
    if (isHorizontal) {
      cursor = {
        x: _alignStartEnd(align, this.left + padding, this.right - lineWidths[0]),
        y: this.top + padding + titleHeight,
        line: 0
      };
    } else {
      cursor = {
        x: this.left + padding,
        y: _alignStartEnd(align, this.top + titleHeight + padding, this.bottom - columnSizes[0].height),
        line: 0
      };
    }
    overrideTextDirection(this.ctx, opts.textDirection);
    const lineHeight = itemHeight + padding;
    this.legendItems.forEach((legendItem, i) => {
      ctx.strokeStyle = legendItem.fontColor;
      ctx.fillStyle = legendItem.fontColor;
      const textWidth = ctx.measureText(legendItem.text).width;
      const textAlign = rtlHelper.textAlign(legendItem.textAlign || (legendItem.textAlign = labelOpts.textAlign));
      const width = boxWidth + halfFontSize + textWidth;
      let x2 = cursor.x;
      let y2 = cursor.y;
      rtlHelper.setWidth(this.width);
      if (isHorizontal) {
        if (i > 0 && x2 + width + padding > this.right) {
          y2 = cursor.y += lineHeight;
          cursor.line++;
          x2 = cursor.x = _alignStartEnd(align, this.left + padding, this.right - lineWidths[cursor.line]);
        }
      } else if (i > 0 && y2 + lineHeight > this.bottom) {
        x2 = cursor.x = x2 + columnSizes[cursor.line].width + padding;
        cursor.line++;
        y2 = cursor.y = _alignStartEnd(align, this.top + titleHeight + padding, this.bottom - columnSizes[cursor.line].height);
      }
      const realX = rtlHelper.x(x2);
      drawLegendBox(realX, y2, legendItem);
      x2 = _textX(textAlign, x2 + boxWidth + halfFontSize, isHorizontal ? x2 + width : this.right, opts.rtl);
      fillText(rtlHelper.x(x2), y2, legendItem);
      if (isHorizontal) {
        cursor.x += width + padding;
      } else if (typeof legendItem.text !== "string") {
        const fontLineHeight = labelFont.lineHeight;
        cursor.y += calculateLegendItemHeight(legendItem, fontLineHeight) + padding;
      } else {
        cursor.y += lineHeight;
      }
    });
    restoreTextDirection(this.ctx, opts.textDirection);
  }
  drawTitle() {
    const opts = this.options;
    const titleOpts = opts.title;
    const titleFont = toFont(titleOpts.font);
    const titlePadding = toPadding(titleOpts.padding);
    if (!titleOpts.display) {
      return;
    }
    const rtlHelper = getRtlAdapter(opts.rtl, this.left, this.width);
    const ctx = this.ctx;
    const position = titleOpts.position;
    const halfFontSize = titleFont.size / 2;
    const topPaddingPlusHalfFontSize = titlePadding.top + halfFontSize;
    let y2;
    let left = this.left;
    let maxWidth = this.width;
    if (this.isHorizontal()) {
      maxWidth = Math.max(...this.lineWidths);
      y2 = this.top + topPaddingPlusHalfFontSize;
      left = _alignStartEnd(opts.align, left, this.right - maxWidth);
    } else {
      const maxHeight = this.columnSizes.reduce((acc, size) => Math.max(acc, size.height), 0);
      y2 = topPaddingPlusHalfFontSize + _alignStartEnd(opts.align, this.top, this.bottom - maxHeight - opts.labels.padding - this._computeTitleHeight());
    }
    const x2 = _alignStartEnd(position, left, left + maxWidth);
    ctx.textAlign = rtlHelper.textAlign(_toLeftRightCenter(position));
    ctx.textBaseline = "middle";
    ctx.strokeStyle = titleOpts.color;
    ctx.fillStyle = titleOpts.color;
    ctx.font = titleFont.string;
    renderText(ctx, titleOpts.text, x2, y2, titleFont);
  }
  _computeTitleHeight() {
    const titleOpts = this.options.title;
    const titleFont = toFont(titleOpts.font);
    const titlePadding = toPadding(titleOpts.padding);
    return titleOpts.display ? titleFont.lineHeight + titlePadding.height : 0;
  }
  _getLegendItemAt(x2, y2) {
    let i, hitBox, lh2;
    if (_isBetween(x2, this.left, this.right) && _isBetween(y2, this.top, this.bottom)) {
      lh2 = this.legendHitBoxes;
      for (i = 0; i < lh2.length; ++i) {
        hitBox = lh2[i];
        if (_isBetween(x2, hitBox.left, hitBox.left + hitBox.width) && _isBetween(y2, hitBox.top, hitBox.top + hitBox.height)) {
          return this.legendItems[i];
        }
      }
    }
    return null;
  }
  handleEvent(e) {
    const opts = this.options;
    if (!isListened(e.type, opts)) {
      return;
    }
    const hoveredItem = this._getLegendItemAt(e.x, e.y);
    if (e.type === "mousemove" || e.type === "mouseout") {
      const previous = this._hoveredItem;
      const sameItem = itemsEqual(previous, hoveredItem);
      if (previous && !sameItem) {
        callback(opts.onLeave, [
          e,
          previous,
          this
        ], this);
      }
      this._hoveredItem = hoveredItem;
      if (hoveredItem && !sameItem) {
        callback(opts.onHover, [
          e,
          hoveredItem,
          this
        ], this);
      }
    } else if (hoveredItem) {
      callback(opts.onClick, [
        e,
        hoveredItem,
        this
      ], this);
    }
  }
}
function calculateItemSize(boxWidth, labelFont, ctx, legendItem, _itemHeight) {
  const itemWidth = calculateItemWidth(legendItem, boxWidth, labelFont, ctx);
  const itemHeight = calculateItemHeight(_itemHeight, legendItem, labelFont.lineHeight);
  return {
    itemWidth,
    itemHeight
  };
}
function calculateItemWidth(legendItem, boxWidth, labelFont, ctx) {
  let legendItemText = legendItem.text;
  if (legendItemText && typeof legendItemText !== "string") {
    legendItemText = legendItemText.reduce((a, b) => a.length > b.length ? a : b);
  }
  return boxWidth + labelFont.size / 2 + ctx.measureText(legendItemText).width;
}
function calculateItemHeight(_itemHeight, legendItem, fontLineHeight) {
  let itemHeight = _itemHeight;
  if (typeof legendItem.text !== "string") {
    itemHeight = calculateLegendItemHeight(legendItem, fontLineHeight);
  }
  return itemHeight;
}
function calculateLegendItemHeight(legendItem, fontLineHeight) {
  const labelHeight = legendItem.text ? legendItem.text.length : 0;
  return fontLineHeight * labelHeight;
}
function isListened(type, opts) {
  if ((type === "mousemove" || type === "mouseout") && (opts.onHover || opts.onLeave)) {
    return true;
  }
  if (opts.onClick && (type === "click" || type === "mouseup")) {
    return true;
  }
  return false;
}
var plugin_legend = {
  id: "legend",
  _element: Legend,
  start(chart, _args, options) {
    const legend = chart.legend = new Legend({
      ctx: chart.ctx,
      options,
      chart
    });
    layouts.configure(chart, legend, options);
    layouts.addBox(chart, legend);
  },
  stop(chart) {
    layouts.removeBox(chart, chart.legend);
    delete chart.legend;
  },
  beforeUpdate(chart, _args, options) {
    const legend = chart.legend;
    layouts.configure(chart, legend, options);
    legend.options = options;
  },
  afterUpdate(chart) {
    const legend = chart.legend;
    legend.buildLabels();
    legend.adjustHitBoxes();
  },
  afterEvent(chart, args) {
    if (!args.replay) {
      chart.legend.handleEvent(args.event);
    }
  },
  defaults: {
    display: true,
    position: "top",
    align: "center",
    fullSize: true,
    reverse: false,
    weight: 1e3,
    onClick(e, legendItem, legend) {
      const index2 = legendItem.datasetIndex;
      const ci2 = legend.chart;
      if (ci2.isDatasetVisible(index2)) {
        ci2.hide(index2);
        legendItem.hidden = true;
      } else {
        ci2.show(index2);
        legendItem.hidden = false;
      }
    },
    onHover: null,
    onLeave: null,
    labels: {
      color: (ctx) => ctx.chart.options.color,
      boxWidth: 40,
      padding: 10,
      generateLabels(chart) {
        const datasets = chart.data.datasets;
        const { labels: { usePointStyle, pointStyle, textAlign, color: color2, useBorderRadius, borderRadius } } = chart.legend.options;
        return chart._getSortedDatasetMetas().map((meta) => {
          const style2 = meta.controller.getStyle(usePointStyle ? 0 : void 0);
          const borderWidth = toPadding(style2.borderWidth);
          return {
            text: datasets[meta.index].label,
            fillStyle: style2.backgroundColor,
            fontColor: color2,
            hidden: !meta.visible,
            lineCap: style2.borderCapStyle,
            lineDash: style2.borderDash,
            lineDashOffset: style2.borderDashOffset,
            lineJoin: style2.borderJoinStyle,
            lineWidth: (borderWidth.width + borderWidth.height) / 4,
            strokeStyle: style2.borderColor,
            pointStyle: pointStyle || style2.pointStyle,
            rotation: style2.rotation,
            textAlign: textAlign || style2.textAlign,
            borderRadius: useBorderRadius && (borderRadius || style2.borderRadius),
            datasetIndex: meta.index
          };
        }, this);
      }
    },
    title: {
      color: (ctx) => ctx.chart.options.color,
      display: false,
      position: "center",
      text: ""
    }
  },
  descriptors: {
    _scriptable: (name) => !name.startsWith("on"),
    labels: {
      _scriptable: (name) => ![
        "generateLabels",
        "filter",
        "sort"
      ].includes(name)
    }
  }
};
class Title extends Element$1 {
  constructor(config) {
    super();
    this.chart = config.chart;
    this.options = config.options;
    this.ctx = config.ctx;
    this._padding = void 0;
    this.top = void 0;
    this.bottom = void 0;
    this.left = void 0;
    this.right = void 0;
    this.width = void 0;
    this.height = void 0;
    this.position = void 0;
    this.weight = void 0;
    this.fullSize = void 0;
  }
  update(maxWidth, maxHeight) {
    const opts = this.options;
    this.left = 0;
    this.top = 0;
    if (!opts.display) {
      this.width = this.height = this.right = this.bottom = 0;
      return;
    }
    this.width = this.right = maxWidth;
    this.height = this.bottom = maxHeight;
    const lineCount = isArray$1(opts.text) ? opts.text.length : 1;
    this._padding = toPadding(opts.padding);
    const textSize = lineCount * toFont(opts.font).lineHeight + this._padding.height;
    if (this.isHorizontal()) {
      this.height = textSize;
    } else {
      this.width = textSize;
    }
  }
  isHorizontal() {
    const pos = this.options.position;
    return pos === "top" || pos === "bottom";
  }
  _drawArgs(offset2) {
    const { top, left, bottom, right, options } = this;
    const align = options.align;
    let rotation = 0;
    let maxWidth, titleX, titleY;
    if (this.isHorizontal()) {
      titleX = _alignStartEnd(align, left, right);
      titleY = top + offset2;
      maxWidth = right - left;
    } else {
      if (options.position === "left") {
        titleX = left + offset2;
        titleY = _alignStartEnd(align, bottom, top);
        rotation = PI * -0.5;
      } else {
        titleX = right - offset2;
        titleY = _alignStartEnd(align, top, bottom);
        rotation = PI * 0.5;
      }
      maxWidth = bottom - top;
    }
    return {
      titleX,
      titleY,
      maxWidth,
      rotation
    };
  }
  draw() {
    const ctx = this.ctx;
    const opts = this.options;
    if (!opts.display) {
      return;
    }
    const fontOpts = toFont(opts.font);
    const lineHeight = fontOpts.lineHeight;
    const offset2 = lineHeight / 2 + this._padding.top;
    const { titleX, titleY, maxWidth, rotation } = this._drawArgs(offset2);
    renderText(ctx, opts.text, 0, 0, fontOpts, {
      color: opts.color,
      maxWidth,
      rotation,
      textAlign: _toLeftRightCenter(opts.align),
      textBaseline: "middle",
      translation: [
        titleX,
        titleY
      ]
    });
  }
}
function createTitle(chart, titleOpts) {
  const title = new Title({
    ctx: chart.ctx,
    options: titleOpts,
    chart
  });
  layouts.configure(chart, title, titleOpts);
  layouts.addBox(chart, title);
  chart.titleBlock = title;
}
var plugin_title = {
  id: "title",
  _element: Title,
  start(chart, _args, options) {
    createTitle(chart, options);
  },
  stop(chart) {
    const titleBlock = chart.titleBlock;
    layouts.removeBox(chart, titleBlock);
    delete chart.titleBlock;
  },
  beforeUpdate(chart, _args, options) {
    const title = chart.titleBlock;
    layouts.configure(chart, title, options);
    title.options = options;
  },
  defaults: {
    align: "center",
    display: false,
    font: {
      weight: "bold"
    },
    fullSize: true,
    padding: 10,
    position: "top",
    text: "",
    weight: 2e3
  },
  defaultRoutes: {
    color: "color"
  },
  descriptors: {
    _scriptable: true,
    _indexable: false
  }
};
const map$1 = /* @__PURE__ */ new WeakMap();
var plugin_subtitle = {
  id: "subtitle",
  start(chart, _args, options) {
    const title = new Title({
      ctx: chart.ctx,
      options,
      chart
    });
    layouts.configure(chart, title, options);
    layouts.addBox(chart, title);
    map$1.set(chart, title);
  },
  stop(chart) {
    layouts.removeBox(chart, map$1.get(chart));
    map$1.delete(chart);
  },
  beforeUpdate(chart, _args, options) {
    const title = map$1.get(chart);
    layouts.configure(chart, title, options);
    title.options = options;
  },
  defaults: {
    align: "center",
    display: false,
    font: {
      weight: "normal"
    },
    fullSize: true,
    padding: 0,
    position: "top",
    text: "",
    weight: 1500
  },
  defaultRoutes: {
    color: "color"
  },
  descriptors: {
    _scriptable: true,
    _indexable: false
  }
};
const positioners = {
  average(items) {
    if (!items.length) {
      return false;
    }
    let i, len;
    let x2 = 0;
    let y2 = 0;
    let count = 0;
    for (i = 0, len = items.length; i < len; ++i) {
      const el2 = items[i].element;
      if (el2 && el2.hasValue()) {
        const pos = el2.tooltipPosition();
        x2 += pos.x;
        y2 += pos.y;
        ++count;
      }
    }
    return {
      x: x2 / count,
      y: y2 / count
    };
  },
  nearest(items, eventPosition) {
    if (!items.length) {
      return false;
    }
    let x2 = eventPosition.x;
    let y2 = eventPosition.y;
    let minDistance = Number.POSITIVE_INFINITY;
    let i, len, nearestElement;
    for (i = 0, len = items.length; i < len; ++i) {
      const el2 = items[i].element;
      if (el2 && el2.hasValue()) {
        const center = el2.getCenterPoint();
        const d = distanceBetweenPoints(eventPosition, center);
        if (d < minDistance) {
          minDistance = d;
          nearestElement = el2;
        }
      }
    }
    if (nearestElement) {
      const tp = nearestElement.tooltipPosition();
      x2 = tp.x;
      y2 = tp.y;
    }
    return {
      x: x2,
      y: y2
    };
  }
};
function pushOrConcat(base, toPush) {
  if (toPush) {
    if (isArray$1(toPush)) {
      Array.prototype.push.apply(base, toPush);
    } else {
      base.push(toPush);
    }
  }
  return base;
}
function splitNewlines(str) {
  if ((typeof str === "string" || str instanceof String) && str.indexOf("\n") > -1) {
    return str.split("\n");
  }
  return str;
}
function createTooltipItem(chart, item) {
  const { element, datasetIndex, index: index2 } = item;
  const controller = chart.getDatasetMeta(datasetIndex).controller;
  const { label, value } = controller.getLabelAndValue(index2);
  return {
    chart,
    label,
    parsed: controller.getParsed(index2),
    raw: chart.data.datasets[datasetIndex].data[index2],
    formattedValue: value,
    dataset: controller.getDataset(),
    dataIndex: index2,
    datasetIndex,
    element
  };
}
function getTooltipSize(tooltip, options) {
  const ctx = tooltip.chart.ctx;
  const { body, footer, title } = tooltip;
  const { boxWidth, boxHeight } = options;
  const bodyFont = toFont(options.bodyFont);
  const titleFont = toFont(options.titleFont);
  const footerFont = toFont(options.footerFont);
  const titleLineCount = title.length;
  const footerLineCount = footer.length;
  const bodyLineItemCount = body.length;
  const padding = toPadding(options.padding);
  let height = padding.height;
  let width = 0;
  let combinedBodyLength = body.reduce((count, bodyItem) => count + bodyItem.before.length + bodyItem.lines.length + bodyItem.after.length, 0);
  combinedBodyLength += tooltip.beforeBody.length + tooltip.afterBody.length;
  if (titleLineCount) {
    height += titleLineCount * titleFont.lineHeight + (titleLineCount - 1) * options.titleSpacing + options.titleMarginBottom;
  }
  if (combinedBodyLength) {
    const bodyLineHeight = options.displayColors ? Math.max(boxHeight, bodyFont.lineHeight) : bodyFont.lineHeight;
    height += bodyLineItemCount * bodyLineHeight + (combinedBodyLength - bodyLineItemCount) * bodyFont.lineHeight + (combinedBodyLength - 1) * options.bodySpacing;
  }
  if (footerLineCount) {
    height += options.footerMarginTop + footerLineCount * footerFont.lineHeight + (footerLineCount - 1) * options.footerSpacing;
  }
  let widthPadding = 0;
  const maxLineWidth = function(line) {
    width = Math.max(width, ctx.measureText(line).width + widthPadding);
  };
  ctx.save();
  ctx.font = titleFont.string;
  each(tooltip.title, maxLineWidth);
  ctx.font = bodyFont.string;
  each(tooltip.beforeBody.concat(tooltip.afterBody), maxLineWidth);
  widthPadding = options.displayColors ? boxWidth + 2 + options.boxPadding : 0;
  each(body, (bodyItem) => {
    each(bodyItem.before, maxLineWidth);
    each(bodyItem.lines, maxLineWidth);
    each(bodyItem.after, maxLineWidth);
  });
  widthPadding = 0;
  ctx.font = footerFont.string;
  each(tooltip.footer, maxLineWidth);
  ctx.restore();
  width += padding.width;
  return {
    width,
    height
  };
}
function determineYAlign(chart, size) {
  const { y: y2, height } = size;
  if (y2 < height / 2) {
    return "top";
  } else if (y2 > chart.height - height / 2) {
    return "bottom";
  }
  return "center";
}
function doesNotFitWithAlign(xAlign, chart, options, size) {
  const { x: x2, width } = size;
  const caret = options.caretSize + options.caretPadding;
  if (xAlign === "left" && x2 + width + caret > chart.width) {
    return true;
  }
  if (xAlign === "right" && x2 - width - caret < 0) {
    return true;
  }
}
function determineXAlign(chart, options, size, yAlign) {
  const { x: x2, width } = size;
  const { width: chartWidth, chartArea: { left, right } } = chart;
  let xAlign = "center";
  if (yAlign === "center") {
    xAlign = x2 <= (left + right) / 2 ? "left" : "right";
  } else if (x2 <= width / 2) {
    xAlign = "left";
  } else if (x2 >= chartWidth - width / 2) {
    xAlign = "right";
  }
  if (doesNotFitWithAlign(xAlign, chart, options, size)) {
    xAlign = "center";
  }
  return xAlign;
}
function determineAlignment(chart, options, size) {
  const yAlign = size.yAlign || options.yAlign || determineYAlign(chart, size);
  return {
    xAlign: size.xAlign || options.xAlign || determineXAlign(chart, options, size, yAlign),
    yAlign
  };
}
function alignX(size, xAlign) {
  let { x: x2, width } = size;
  if (xAlign === "right") {
    x2 -= width;
  } else if (xAlign === "center") {
    x2 -= width / 2;
  }
  return x2;
}
function alignY(size, yAlign, paddingAndSize) {
  let { y: y2, height } = size;
  if (yAlign === "top") {
    y2 += paddingAndSize;
  } else if (yAlign === "bottom") {
    y2 -= height + paddingAndSize;
  } else {
    y2 -= height / 2;
  }
  return y2;
}
function getBackgroundPoint(options, size, alignment, chart) {
  const { caretSize, caretPadding, cornerRadius } = options;
  const { xAlign, yAlign } = alignment;
  const paddingAndSize = caretSize + caretPadding;
  const { topLeft, topRight, bottomLeft, bottomRight } = toTRBLCorners(cornerRadius);
  let x2 = alignX(size, xAlign);
  const y2 = alignY(size, yAlign, paddingAndSize);
  if (yAlign === "center") {
    if (xAlign === "left") {
      x2 += paddingAndSize;
    } else if (xAlign === "right") {
      x2 -= paddingAndSize;
    }
  } else if (xAlign === "left") {
    x2 -= Math.max(topLeft, bottomLeft) + caretSize;
  } else if (xAlign === "right") {
    x2 += Math.max(topRight, bottomRight) + caretSize;
  }
  return {
    x: _limitValue(x2, 0, chart.width - size.width),
    y: _limitValue(y2, 0, chart.height - size.height)
  };
}
function getAlignedX(tooltip, align, options) {
  const padding = toPadding(options.padding);
  return align === "center" ? tooltip.x + tooltip.width / 2 : align === "right" ? tooltip.x + tooltip.width - padding.right : tooltip.x + padding.left;
}
function getBeforeAfterBodyLines(callback2) {
  return pushOrConcat([], splitNewlines(callback2));
}
function createTooltipContext(parent, tooltip, tooltipItems) {
  return createContext(parent, {
    tooltip,
    tooltipItems,
    type: "tooltip"
  });
}
function overrideCallbacks(callbacks, context) {
  const override = context && context.dataset && context.dataset.tooltip && context.dataset.tooltip.callbacks;
  return override ? callbacks.override(override) : callbacks;
}
const defaultCallbacks = {
  beforeTitle: noop,
  title(tooltipItems) {
    if (tooltipItems.length > 0) {
      const item = tooltipItems[0];
      const labels = item.chart.data.labels;
      const labelCount = labels ? labels.length : 0;
      if (this && this.options && this.options.mode === "dataset") {
        return item.dataset.label || "";
      } else if (item.label) {
        return item.label;
      } else if (labelCount > 0 && item.dataIndex < labelCount) {
        return labels[item.dataIndex];
      }
    }
    return "";
  },
  afterTitle: noop,
  beforeBody: noop,
  beforeLabel: noop,
  label(tooltipItem) {
    if (this && this.options && this.options.mode === "dataset") {
      return tooltipItem.label + ": " + tooltipItem.formattedValue || tooltipItem.formattedValue;
    }
    let label = tooltipItem.dataset.label || "";
    if (label) {
      label += ": ";
    }
    const value = tooltipItem.formattedValue;
    if (!isNullOrUndef(value)) {
      label += value;
    }
    return label;
  },
  labelColor(tooltipItem) {
    const meta = tooltipItem.chart.getDatasetMeta(tooltipItem.datasetIndex);
    const options = meta.controller.getStyle(tooltipItem.dataIndex);
    return {
      borderColor: options.borderColor,
      backgroundColor: options.backgroundColor,
      borderWidth: options.borderWidth,
      borderDash: options.borderDash,
      borderDashOffset: options.borderDashOffset,
      borderRadius: 0
    };
  },
  labelTextColor() {
    return this.options.bodyColor;
  },
  labelPointStyle(tooltipItem) {
    const meta = tooltipItem.chart.getDatasetMeta(tooltipItem.datasetIndex);
    const options = meta.controller.getStyle(tooltipItem.dataIndex);
    return {
      pointStyle: options.pointStyle,
      rotation: options.rotation
    };
  },
  afterLabel: noop,
  afterBody: noop,
  beforeFooter: noop,
  footer: noop,
  afterFooter: noop
};
function invokeCallbackWithFallback(callbacks, name, ctx, arg) {
  const result = callbacks[name].call(ctx, arg);
  if (typeof result === "undefined") {
    return defaultCallbacks[name].call(ctx, arg);
  }
  return result;
}
class Tooltip extends Element$1 {
  constructor(config) {
    super();
    this.opacity = 0;
    this._active = [];
    this._eventPosition = void 0;
    this._size = void 0;
    this._cachedAnimations = void 0;
    this._tooltipItems = [];
    this.$animations = void 0;
    this.$context = void 0;
    this.chart = config.chart;
    this.options = config.options;
    this.dataPoints = void 0;
    this.title = void 0;
    this.beforeBody = void 0;
    this.body = void 0;
    this.afterBody = void 0;
    this.footer = void 0;
    this.xAlign = void 0;
    this.yAlign = void 0;
    this.x = void 0;
    this.y = void 0;
    this.height = void 0;
    this.width = void 0;
    this.caretX = void 0;
    this.caretY = void 0;
    this.labelColors = void 0;
    this.labelPointStyles = void 0;
    this.labelTextColors = void 0;
  }
  initialize(options) {
    this.options = options;
    this._cachedAnimations = void 0;
    this.$context = void 0;
  }
  _resolveAnimations() {
    const cached = this._cachedAnimations;
    if (cached) {
      return cached;
    }
    const chart = this.chart;
    const options = this.options.setContext(this.getContext());
    const opts = options.enabled && chart.options.animation && options.animations;
    const animations = new Animations(this.chart, opts);
    if (opts._cacheable) {
      this._cachedAnimations = Object.freeze(animations);
    }
    return animations;
  }
  getContext() {
    return this.$context || (this.$context = createTooltipContext(this.chart.getContext(), this, this._tooltipItems));
  }
  getTitle(context, options) {
    const { callbacks } = options;
    const beforeTitle = invokeCallbackWithFallback(callbacks, "beforeTitle", this, context);
    const title = invokeCallbackWithFallback(callbacks, "title", this, context);
    const afterTitle = invokeCallbackWithFallback(callbacks, "afterTitle", this, context);
    let lines = [];
    lines = pushOrConcat(lines, splitNewlines(beforeTitle));
    lines = pushOrConcat(lines, splitNewlines(title));
    lines = pushOrConcat(lines, splitNewlines(afterTitle));
    return lines;
  }
  getBeforeBody(tooltipItems, options) {
    return getBeforeAfterBodyLines(invokeCallbackWithFallback(options.callbacks, "beforeBody", this, tooltipItems));
  }
  getBody(tooltipItems, options) {
    const { callbacks } = options;
    const bodyItems = [];
    each(tooltipItems, (context) => {
      const bodyItem = {
        before: [],
        lines: [],
        after: []
      };
      const scoped = overrideCallbacks(callbacks, context);
      pushOrConcat(bodyItem.before, splitNewlines(invokeCallbackWithFallback(scoped, "beforeLabel", this, context)));
      pushOrConcat(bodyItem.lines, invokeCallbackWithFallback(scoped, "label", this, context));
      pushOrConcat(bodyItem.after, splitNewlines(invokeCallbackWithFallback(scoped, "afterLabel", this, context)));
      bodyItems.push(bodyItem);
    });
    return bodyItems;
  }
  getAfterBody(tooltipItems, options) {
    return getBeforeAfterBodyLines(invokeCallbackWithFallback(options.callbacks, "afterBody", this, tooltipItems));
  }
  getFooter(tooltipItems, options) {
    const { callbacks } = options;
    const beforeFooter = invokeCallbackWithFallback(callbacks, "beforeFooter", this, tooltipItems);
    const footer = invokeCallbackWithFallback(callbacks, "footer", this, tooltipItems);
    const afterFooter = invokeCallbackWithFallback(callbacks, "afterFooter", this, tooltipItems);
    let lines = [];
    lines = pushOrConcat(lines, splitNewlines(beforeFooter));
    lines = pushOrConcat(lines, splitNewlines(footer));
    lines = pushOrConcat(lines, splitNewlines(afterFooter));
    return lines;
  }
  _createItems(options) {
    const active = this._active;
    const data = this.chart.data;
    const labelColors = [];
    const labelPointStyles = [];
    const labelTextColors = [];
    let tooltipItems = [];
    let i, len;
    for (i = 0, len = active.length; i < len; ++i) {
      tooltipItems.push(createTooltipItem(this.chart, active[i]));
    }
    if (options.filter) {
      tooltipItems = tooltipItems.filter((element, index2, array) => options.filter(element, index2, array, data));
    }
    if (options.itemSort) {
      tooltipItems = tooltipItems.sort((a, b) => options.itemSort(a, b, data));
    }
    each(tooltipItems, (context) => {
      const scoped = overrideCallbacks(options.callbacks, context);
      labelColors.push(invokeCallbackWithFallback(scoped, "labelColor", this, context));
      labelPointStyles.push(invokeCallbackWithFallback(scoped, "labelPointStyle", this, context));
      labelTextColors.push(invokeCallbackWithFallback(scoped, "labelTextColor", this, context));
    });
    this.labelColors = labelColors;
    this.labelPointStyles = labelPointStyles;
    this.labelTextColors = labelTextColors;
    this.dataPoints = tooltipItems;
    return tooltipItems;
  }
  update(changed, replay) {
    const options = this.options.setContext(this.getContext());
    const active = this._active;
    let properties;
    let tooltipItems = [];
    if (!active.length) {
      if (this.opacity !== 0) {
        properties = {
          opacity: 0
        };
      }
    } else {
      const position = positioners[options.position].call(this, active, this._eventPosition);
      tooltipItems = this._createItems(options);
      this.title = this.getTitle(tooltipItems, options);
      this.beforeBody = this.getBeforeBody(tooltipItems, options);
      this.body = this.getBody(tooltipItems, options);
      this.afterBody = this.getAfterBody(tooltipItems, options);
      this.footer = this.getFooter(tooltipItems, options);
      const size = this._size = getTooltipSize(this, options);
      const positionAndSize = Object.assign({}, position, size);
      const alignment = determineAlignment(this.chart, options, positionAndSize);
      const backgroundPoint = getBackgroundPoint(options, positionAndSize, alignment, this.chart);
      this.xAlign = alignment.xAlign;
      this.yAlign = alignment.yAlign;
      properties = {
        opacity: 1,
        x: backgroundPoint.x,
        y: backgroundPoint.y,
        width: size.width,
        height: size.height,
        caretX: position.x,
        caretY: position.y
      };
    }
    this._tooltipItems = tooltipItems;
    this.$context = void 0;
    if (properties) {
      this._resolveAnimations().update(this, properties);
    }
    if (changed && options.external) {
      options.external.call(this, {
        chart: this.chart,
        tooltip: this,
        replay
      });
    }
  }
  drawCaret(tooltipPoint, ctx, size, options) {
    const caretPosition = this.getCaretPosition(tooltipPoint, size, options);
    ctx.lineTo(caretPosition.x1, caretPosition.y1);
    ctx.lineTo(caretPosition.x2, caretPosition.y2);
    ctx.lineTo(caretPosition.x3, caretPosition.y3);
  }
  getCaretPosition(tooltipPoint, size, options) {
    const { xAlign, yAlign } = this;
    const { caretSize, cornerRadius } = options;
    const { topLeft, topRight, bottomLeft, bottomRight } = toTRBLCorners(cornerRadius);
    const { x: ptX, y: ptY } = tooltipPoint;
    const { width, height } = size;
    let x1, x2, x3, y1, y2, y3;
    if (yAlign === "center") {
      y2 = ptY + height / 2;
      if (xAlign === "left") {
        x1 = ptX;
        x2 = x1 - caretSize;
        y1 = y2 + caretSize;
        y3 = y2 - caretSize;
      } else {
        x1 = ptX + width;
        x2 = x1 + caretSize;
        y1 = y2 - caretSize;
        y3 = y2 + caretSize;
      }
      x3 = x1;
    } else {
      if (xAlign === "left") {
        x2 = ptX + Math.max(topLeft, bottomLeft) + caretSize;
      } else if (xAlign === "right") {
        x2 = ptX + width - Math.max(topRight, bottomRight) - caretSize;
      } else {
        x2 = this.caretX;
      }
      if (yAlign === "top") {
        y1 = ptY;
        y2 = y1 - caretSize;
        x1 = x2 - caretSize;
        x3 = x2 + caretSize;
      } else {
        y1 = ptY + height;
        y2 = y1 + caretSize;
        x1 = x2 + caretSize;
        x3 = x2 - caretSize;
      }
      y3 = y1;
    }
    return {
      x1,
      x2,
      x3,
      y1,
      y2,
      y3
    };
  }
  drawTitle(pt, ctx, options) {
    const title = this.title;
    const length = title.length;
    let titleFont, titleSpacing, i;
    if (length) {
      const rtlHelper = getRtlAdapter(options.rtl, this.x, this.width);
      pt.x = getAlignedX(this, options.titleAlign, options);
      ctx.textAlign = rtlHelper.textAlign(options.titleAlign);
      ctx.textBaseline = "middle";
      titleFont = toFont(options.titleFont);
      titleSpacing = options.titleSpacing;
      ctx.fillStyle = options.titleColor;
      ctx.font = titleFont.string;
      for (i = 0; i < length; ++i) {
        ctx.fillText(title[i], rtlHelper.x(pt.x), pt.y + titleFont.lineHeight / 2);
        pt.y += titleFont.lineHeight + titleSpacing;
        if (i + 1 === length) {
          pt.y += options.titleMarginBottom - titleSpacing;
        }
      }
    }
  }
  _drawColorBox(ctx, pt, i, rtlHelper, options) {
    const labelColor = this.labelColors[i];
    const labelPointStyle = this.labelPointStyles[i];
    const { boxHeight, boxWidth } = options;
    const bodyFont = toFont(options.bodyFont);
    const colorX = getAlignedX(this, "left", options);
    const rtlColorX = rtlHelper.x(colorX);
    const yOffSet = boxHeight < bodyFont.lineHeight ? (bodyFont.lineHeight - boxHeight) / 2 : 0;
    const colorY = pt.y + yOffSet;
    if (options.usePointStyle) {
      const drawOptions = {
        radius: Math.min(boxWidth, boxHeight) / 2,
        pointStyle: labelPointStyle.pointStyle,
        rotation: labelPointStyle.rotation,
        borderWidth: 1
      };
      const centerX = rtlHelper.leftForLtr(rtlColorX, boxWidth) + boxWidth / 2;
      const centerY = colorY + boxHeight / 2;
      ctx.strokeStyle = options.multiKeyBackground;
      ctx.fillStyle = options.multiKeyBackground;
      drawPoint(ctx, drawOptions, centerX, centerY);
      ctx.strokeStyle = labelColor.borderColor;
      ctx.fillStyle = labelColor.backgroundColor;
      drawPoint(ctx, drawOptions, centerX, centerY);
    } else {
      ctx.lineWidth = isObject$1(labelColor.borderWidth) ? Math.max(...Object.values(labelColor.borderWidth)) : labelColor.borderWidth || 1;
      ctx.strokeStyle = labelColor.borderColor;
      ctx.setLineDash(labelColor.borderDash || []);
      ctx.lineDashOffset = labelColor.borderDashOffset || 0;
      const outerX = rtlHelper.leftForLtr(rtlColorX, boxWidth);
      const innerX = rtlHelper.leftForLtr(rtlHelper.xPlus(rtlColorX, 1), boxWidth - 2);
      const borderRadius = toTRBLCorners(labelColor.borderRadius);
      if (Object.values(borderRadius).some((v2) => v2 !== 0)) {
        ctx.beginPath();
        ctx.fillStyle = options.multiKeyBackground;
        addRoundedRectPath(ctx, {
          x: outerX,
          y: colorY,
          w: boxWidth,
          h: boxHeight,
          radius: borderRadius
        });
        ctx.fill();
        ctx.stroke();
        ctx.fillStyle = labelColor.backgroundColor;
        ctx.beginPath();
        addRoundedRectPath(ctx, {
          x: innerX,
          y: colorY + 1,
          w: boxWidth - 2,
          h: boxHeight - 2,
          radius: borderRadius
        });
        ctx.fill();
      } else {
        ctx.fillStyle = options.multiKeyBackground;
        ctx.fillRect(outerX, colorY, boxWidth, boxHeight);
        ctx.strokeRect(outerX, colorY, boxWidth, boxHeight);
        ctx.fillStyle = labelColor.backgroundColor;
        ctx.fillRect(innerX, colorY + 1, boxWidth - 2, boxHeight - 2);
      }
    }
    ctx.fillStyle = this.labelTextColors[i];
  }
  drawBody(pt, ctx, options) {
    const { body } = this;
    const { bodySpacing, bodyAlign, displayColors, boxHeight, boxWidth, boxPadding } = options;
    const bodyFont = toFont(options.bodyFont);
    let bodyLineHeight = bodyFont.lineHeight;
    let xLinePadding = 0;
    const rtlHelper = getRtlAdapter(options.rtl, this.x, this.width);
    const fillLineOfText = function(line) {
      ctx.fillText(line, rtlHelper.x(pt.x + xLinePadding), pt.y + bodyLineHeight / 2);
      pt.y += bodyLineHeight + bodySpacing;
    };
    const bodyAlignForCalculation = rtlHelper.textAlign(bodyAlign);
    let bodyItem, textColor, lines, i, j, ilen, jlen;
    ctx.textAlign = bodyAlign;
    ctx.textBaseline = "middle";
    ctx.font = bodyFont.string;
    pt.x = getAlignedX(this, bodyAlignForCalculation, options);
    ctx.fillStyle = options.bodyColor;
    each(this.beforeBody, fillLineOfText);
    xLinePadding = displayColors && bodyAlignForCalculation !== "right" ? bodyAlign === "center" ? boxWidth / 2 + boxPadding : boxWidth + 2 + boxPadding : 0;
    for (i = 0, ilen = body.length; i < ilen; ++i) {
      bodyItem = body[i];
      textColor = this.labelTextColors[i];
      ctx.fillStyle = textColor;
      each(bodyItem.before, fillLineOfText);
      lines = bodyItem.lines;
      if (displayColors && lines.length) {
        this._drawColorBox(ctx, pt, i, rtlHelper, options);
        bodyLineHeight = Math.max(bodyFont.lineHeight, boxHeight);
      }
      for (j = 0, jlen = lines.length; j < jlen; ++j) {
        fillLineOfText(lines[j]);
        bodyLineHeight = bodyFont.lineHeight;
      }
      each(bodyItem.after, fillLineOfText);
    }
    xLinePadding = 0;
    bodyLineHeight = bodyFont.lineHeight;
    each(this.afterBody, fillLineOfText);
    pt.y -= bodySpacing;
  }
  drawFooter(pt, ctx, options) {
    const footer = this.footer;
    const length = footer.length;
    let footerFont, i;
    if (length) {
      const rtlHelper = getRtlAdapter(options.rtl, this.x, this.width);
      pt.x = getAlignedX(this, options.footerAlign, options);
      pt.y += options.footerMarginTop;
      ctx.textAlign = rtlHelper.textAlign(options.footerAlign);
      ctx.textBaseline = "middle";
      footerFont = toFont(options.footerFont);
      ctx.fillStyle = options.footerColor;
      ctx.font = footerFont.string;
      for (i = 0; i < length; ++i) {
        ctx.fillText(footer[i], rtlHelper.x(pt.x), pt.y + footerFont.lineHeight / 2);
        pt.y += footerFont.lineHeight + options.footerSpacing;
      }
    }
  }
  drawBackground(pt, ctx, tooltipSize, options) {
    const { xAlign, yAlign } = this;
    const { x: x2, y: y2 } = pt;
    const { width, height } = tooltipSize;
    const { topLeft, topRight, bottomLeft, bottomRight } = toTRBLCorners(options.cornerRadius);
    ctx.fillStyle = options.backgroundColor;
    ctx.strokeStyle = options.borderColor;
    ctx.lineWidth = options.borderWidth;
    ctx.beginPath();
    ctx.moveTo(x2 + topLeft, y2);
    if (yAlign === "top") {
      this.drawCaret(pt, ctx, tooltipSize, options);
    }
    ctx.lineTo(x2 + width - topRight, y2);
    ctx.quadraticCurveTo(x2 + width, y2, x2 + width, y2 + topRight);
    if (yAlign === "center" && xAlign === "right") {
      this.drawCaret(pt, ctx, tooltipSize, options);
    }
    ctx.lineTo(x2 + width, y2 + height - bottomRight);
    ctx.quadraticCurveTo(x2 + width, y2 + height, x2 + width - bottomRight, y2 + height);
    if (yAlign === "bottom") {
      this.drawCaret(pt, ctx, tooltipSize, options);
    }
    ctx.lineTo(x2 + bottomLeft, y2 + height);
    ctx.quadraticCurveTo(x2, y2 + height, x2, y2 + height - bottomLeft);
    if (yAlign === "center" && xAlign === "left") {
      this.drawCaret(pt, ctx, tooltipSize, options);
    }
    ctx.lineTo(x2, y2 + topLeft);
    ctx.quadraticCurveTo(x2, y2, x2 + topLeft, y2);
    ctx.closePath();
    ctx.fill();
    if (options.borderWidth > 0) {
      ctx.stroke();
    }
  }
  _updateAnimationTarget(options) {
    const chart = this.chart;
    const anims = this.$animations;
    const animX = anims && anims.x;
    const animY = anims && anims.y;
    if (animX || animY) {
      const position = positioners[options.position].call(this, this._active, this._eventPosition);
      if (!position) {
        return;
      }
      const size = this._size = getTooltipSize(this, options);
      const positionAndSize = Object.assign({}, position, this._size);
      const alignment = determineAlignment(chart, options, positionAndSize);
      const point = getBackgroundPoint(options, positionAndSize, alignment, chart);
      if (animX._to !== point.x || animY._to !== point.y) {
        this.xAlign = alignment.xAlign;
        this.yAlign = alignment.yAlign;
        this.width = size.width;
        this.height = size.height;
        this.caretX = position.x;
        this.caretY = position.y;
        this._resolveAnimations().update(this, point);
      }
    }
  }
  _willRender() {
    return !!this.opacity;
  }
  draw(ctx) {
    const options = this.options.setContext(this.getContext());
    let opacity = this.opacity;
    if (!opacity) {
      return;
    }
    this._updateAnimationTarget(options);
    const tooltipSize = {
      width: this.width,
      height: this.height
    };
    const pt = {
      x: this.x,
      y: this.y
    };
    opacity = Math.abs(opacity) < 1e-3 ? 0 : opacity;
    const padding = toPadding(options.padding);
    const hasTooltipContent = this.title.length || this.beforeBody.length || this.body.length || this.afterBody.length || this.footer.length;
    if (options.enabled && hasTooltipContent) {
      ctx.save();
      ctx.globalAlpha = opacity;
      this.drawBackground(pt, ctx, tooltipSize, options);
      overrideTextDirection(ctx, options.textDirection);
      pt.y += padding.top;
      this.drawTitle(pt, ctx, options);
      this.drawBody(pt, ctx, options);
      this.drawFooter(pt, ctx, options);
      restoreTextDirection(ctx, options.textDirection);
      ctx.restore();
    }
  }
  getActiveElements() {
    return this._active || [];
  }
  setActiveElements(activeElements, eventPosition) {
    const lastActive = this._active;
    const active = activeElements.map(({ datasetIndex, index: index2 }) => {
      const meta = this.chart.getDatasetMeta(datasetIndex);
      if (!meta) {
        throw new Error("Cannot find a dataset at index " + datasetIndex);
      }
      return {
        datasetIndex,
        element: meta.data[index2],
        index: index2
      };
    });
    const changed = !_elementsEqual(lastActive, active);
    const positionChanged = this._positionChanged(active, eventPosition);
    if (changed || positionChanged) {
      this._active = active;
      this._eventPosition = eventPosition;
      this._ignoreReplayEvents = true;
      this.update(true);
    }
  }
  handleEvent(e, replay, inChartArea = true) {
    if (replay && this._ignoreReplayEvents) {
      return false;
    }
    this._ignoreReplayEvents = false;
    const options = this.options;
    const lastActive = this._active || [];
    const active = this._getActiveElements(e, lastActive, replay, inChartArea);
    const positionChanged = this._positionChanged(active, e);
    const changed = replay || !_elementsEqual(active, lastActive) || positionChanged;
    if (changed) {
      this._active = active;
      if (options.enabled || options.external) {
        this._eventPosition = {
          x: e.x,
          y: e.y
        };
        this.update(true, replay);
      }
    }
    return changed;
  }
  _getActiveElements(e, lastActive, replay, inChartArea) {
    const options = this.options;
    if (e.type === "mouseout") {
      return [];
    }
    if (!inChartArea) {
      return lastActive;
    }
    const active = this.chart.getElementsAtEventForMode(e, options.mode, options, replay);
    if (options.reverse) {
      active.reverse();
    }
    return active;
  }
  _positionChanged(active, e) {
    const { caretX, caretY, options } = this;
    const position = positioners[options.position].call(this, active, e);
    return position !== false && (caretX !== position.x || caretY !== position.y);
  }
}
__publicField(Tooltip, "positioners", positioners);
var plugin_tooltip = {
  id: "tooltip",
  _element: Tooltip,
  positioners,
  afterInit(chart, _args, options) {
    if (options) {
      chart.tooltip = new Tooltip({
        chart,
        options
      });
    }
  },
  beforeUpdate(chart, _args, options) {
    if (chart.tooltip) {
      chart.tooltip.initialize(options);
    }
  },
  reset(chart, _args, options) {
    if (chart.tooltip) {
      chart.tooltip.initialize(options);
    }
  },
  afterDraw(chart) {
    const tooltip = chart.tooltip;
    if (tooltip && tooltip._willRender()) {
      const args = {
        tooltip
      };
      if (chart.notifyPlugins("beforeTooltipDraw", {
        ...args,
        cancelable: true
      }) === false) {
        return;
      }
      tooltip.draw(chart.ctx);
      chart.notifyPlugins("afterTooltipDraw", args);
    }
  },
  afterEvent(chart, args) {
    if (chart.tooltip) {
      const useFinalPosition = args.replay;
      if (chart.tooltip.handleEvent(args.event, useFinalPosition, args.inChartArea)) {
        args.changed = true;
      }
    }
  },
  defaults: {
    enabled: true,
    external: null,
    position: "average",
    backgroundColor: "rgba(0,0,0,0.8)",
    titleColor: "#fff",
    titleFont: {
      weight: "bold"
    },
    titleSpacing: 2,
    titleMarginBottom: 6,
    titleAlign: "left",
    bodyColor: "#fff",
    bodySpacing: 2,
    bodyFont: {},
    bodyAlign: "left",
    footerColor: "#fff",
    footerSpacing: 2,
    footerMarginTop: 6,
    footerFont: {
      weight: "bold"
    },
    footerAlign: "left",
    padding: 6,
    caretPadding: 2,
    caretSize: 5,
    cornerRadius: 6,
    boxHeight: (ctx, opts) => opts.bodyFont.size,
    boxWidth: (ctx, opts) => opts.bodyFont.size,
    multiKeyBackground: "#fff",
    displayColors: true,
    boxPadding: 0,
    borderColor: "rgba(0,0,0,0)",
    borderWidth: 0,
    animation: {
      duration: 400,
      easing: "easeOutQuart"
    },
    animations: {
      numbers: {
        type: "number",
        properties: [
          "x",
          "y",
          "width",
          "height",
          "caretX",
          "caretY"
        ]
      },
      opacity: {
        easing: "linear",
        duration: 200
      }
    },
    callbacks: defaultCallbacks
  },
  defaultRoutes: {
    bodyFont: "font",
    footerFont: "font",
    titleFont: "font"
  },
  descriptors: {
    _scriptable: (name) => name !== "filter" && name !== "itemSort" && name !== "external",
    _indexable: false,
    callbacks: {
      _scriptable: false,
      _indexable: false
    },
    animation: {
      _fallback: false
    },
    animations: {
      _fallback: "animation"
    }
  },
  additionalOptionScopes: [
    "interaction"
  ]
};
var plugins = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  Colors: plugin_colors,
  Decimation: plugin_decimation,
  Filler: index$1,
  Legend: plugin_legend,
  SubTitle: plugin_subtitle,
  Title: plugin_title,
  Tooltip: plugin_tooltip
});
const addIfString = (labels, raw, index2, addedLabels) => {
  if (typeof raw === "string") {
    index2 = labels.push(raw) - 1;
    addedLabels.unshift({
      index: index2,
      label: raw
    });
  } else if (isNaN(raw)) {
    index2 = null;
  }
  return index2;
};
function findOrAddLabel(labels, raw, index2, addedLabels) {
  const first = labels.indexOf(raw);
  if (first === -1) {
    return addIfString(labels, raw, index2, addedLabels);
  }
  const last2 = labels.lastIndexOf(raw);
  return first !== last2 ? index2 : first;
}
const validIndex = (index2, max2) => index2 === null ? null : _limitValue(Math.round(index2), 0, max2);
function _getLabelForValue(value) {
  const labels = this.getLabels();
  if (value >= 0 && value < labels.length) {
    return labels[value];
  }
  return value;
}
class CategoryScale extends Scale {
  constructor(cfg) {
    super(cfg);
    this._startValue = void 0;
    this._valueRange = 0;
    this._addedLabels = [];
  }
  init(scaleOptions) {
    const added = this._addedLabels;
    if (added.length) {
      const labels = this.getLabels();
      for (const { index: index2, label } of added) {
        if (labels[index2] === label) {
          labels.splice(index2, 1);
        }
      }
      this._addedLabels = [];
    }
    super.init(scaleOptions);
  }
  parse(raw, index2) {
    if (isNullOrUndef(raw)) {
      return null;
    }
    const labels = this.getLabels();
    index2 = isFinite(index2) && labels[index2] === raw ? index2 : findOrAddLabel(labels, raw, valueOrDefault(index2, raw), this._addedLabels);
    return validIndex(index2, labels.length - 1);
  }
  determineDataLimits() {
    const { minDefined, maxDefined } = this.getUserBounds();
    let { min: min2, max: max2 } = this.getMinMax(true);
    if (this.options.bounds === "ticks") {
      if (!minDefined) {
        min2 = 0;
      }
      if (!maxDefined) {
        max2 = this.getLabels().length - 1;
      }
    }
    this.min = min2;
    this.max = max2;
  }
  buildTicks() {
    const min2 = this.min;
    const max2 = this.max;
    const offset2 = this.options.offset;
    const ticks = [];
    let labels = this.getLabels();
    labels = min2 === 0 && max2 === labels.length - 1 ? labels : labels.slice(min2, max2 + 1);
    this._valueRange = Math.max(labels.length - (offset2 ? 0 : 1), 1);
    this._startValue = this.min - (offset2 ? 0.5 : 0);
    for (let value = min2; value <= max2; value++) {
      ticks.push({
        value
      });
    }
    return ticks;
  }
  getLabelForValue(value) {
    return _getLabelForValue.call(this, value);
  }
  configure() {
    super.configure();
    if (!this.isHorizontal()) {
      this._reversePixels = !this._reversePixels;
    }
  }
  getPixelForValue(value) {
    if (typeof value !== "number") {
      value = this.parse(value);
    }
    return value === null ? NaN : this.getPixelForDecimal((value - this._startValue) / this._valueRange);
  }
  getPixelForTick(index2) {
    const ticks = this.ticks;
    if (index2 < 0 || index2 > ticks.length - 1) {
      return null;
    }
    return this.getPixelForValue(ticks[index2].value);
  }
  getValueForPixel(pixel) {
    return Math.round(this._startValue + this.getDecimalForPixel(pixel) * this._valueRange);
  }
  getBasePixel() {
    return this.bottom;
  }
}
__publicField(CategoryScale, "id", "category");
__publicField(CategoryScale, "defaults", {
  ticks: {
    callback: _getLabelForValue
  }
});
function generateTicks$1(generationOptions, dataRange) {
  const ticks = [];
  const MIN_SPACING = 1e-14;
  const { bounds, step, min: min2, max: max2, precision, count, maxTicks, maxDigits, includeBounds } = generationOptions;
  const unit = step || 1;
  const maxSpaces = maxTicks - 1;
  const { min: rmin, max: rmax } = dataRange;
  const minDefined = !isNullOrUndef(min2);
  const maxDefined = !isNullOrUndef(max2);
  const countDefined = !isNullOrUndef(count);
  const minSpacing = (rmax - rmin) / (maxDigits + 1);
  let spacing = niceNum((rmax - rmin) / maxSpaces / unit) * unit;
  let factor, niceMin, niceMax, numSpaces;
  if (spacing < MIN_SPACING && !minDefined && !maxDefined) {
    return [
      {
        value: rmin
      },
      {
        value: rmax
      }
    ];
  }
  numSpaces = Math.ceil(rmax / spacing) - Math.floor(rmin / spacing);
  if (numSpaces > maxSpaces) {
    spacing = niceNum(numSpaces * spacing / maxSpaces / unit) * unit;
  }
  if (!isNullOrUndef(precision)) {
    factor = Math.pow(10, precision);
    spacing = Math.ceil(spacing * factor) / factor;
  }
  if (bounds === "ticks") {
    niceMin = Math.floor(rmin / spacing) * spacing;
    niceMax = Math.ceil(rmax / spacing) * spacing;
  } else {
    niceMin = rmin;
    niceMax = rmax;
  }
  if (minDefined && maxDefined && step && almostWhole((max2 - min2) / step, spacing / 1e3)) {
    numSpaces = Math.round(Math.min((max2 - min2) / spacing, maxTicks));
    spacing = (max2 - min2) / numSpaces;
    niceMin = min2;
    niceMax = max2;
  } else if (countDefined) {
    niceMin = minDefined ? min2 : niceMin;
    niceMax = maxDefined ? max2 : niceMax;
    numSpaces = count - 1;
    spacing = (niceMax - niceMin) / numSpaces;
  } else {
    numSpaces = (niceMax - niceMin) / spacing;
    if (almostEquals(numSpaces, Math.round(numSpaces), spacing / 1e3)) {
      numSpaces = Math.round(numSpaces);
    } else {
      numSpaces = Math.ceil(numSpaces);
    }
  }
  const decimalPlaces = Math.max(_decimalPlaces(spacing), _decimalPlaces(niceMin));
  factor = Math.pow(10, isNullOrUndef(precision) ? decimalPlaces : precision);
  niceMin = Math.round(niceMin * factor) / factor;
  niceMax = Math.round(niceMax * factor) / factor;
  let j = 0;
  if (minDefined) {
    if (includeBounds && niceMin !== min2) {
      ticks.push({
        value: min2
      });
      if (niceMin < min2) {
        j++;
      }
      if (almostEquals(Math.round((niceMin + j * spacing) * factor) / factor, min2, relativeLabelSize(min2, minSpacing, generationOptions))) {
        j++;
      }
    } else if (niceMin < min2) {
      j++;
    }
  }
  for (; j < numSpaces; ++j) {
    const tickValue = Math.round((niceMin + j * spacing) * factor) / factor;
    if (maxDefined && tickValue > max2) {
      break;
    }
    ticks.push({
      value: tickValue
    });
  }
  if (maxDefined && includeBounds && niceMax !== max2) {
    if (ticks.length && almostEquals(ticks[ticks.length - 1].value, max2, relativeLabelSize(max2, minSpacing, generationOptions))) {
      ticks[ticks.length - 1].value = max2;
    } else {
      ticks.push({
        value: max2
      });
    }
  } else if (!maxDefined || niceMax === max2) {
    ticks.push({
      value: niceMax
    });
  }
  return ticks;
}
function relativeLabelSize(value, minSpacing, { horizontal, minRotation }) {
  const rad = toRadians(minRotation);
  const ratio = (horizontal ? Math.sin(rad) : Math.cos(rad)) || 1e-3;
  const length = 0.75 * minSpacing * ("" + value).length;
  return Math.min(minSpacing / ratio, length);
}
class LinearScaleBase extends Scale {
  constructor(cfg) {
    super(cfg);
    this.start = void 0;
    this.end = void 0;
    this._startValue = void 0;
    this._endValue = void 0;
    this._valueRange = 0;
  }
  parse(raw, index2) {
    if (isNullOrUndef(raw)) {
      return null;
    }
    if ((typeof raw === "number" || raw instanceof Number) && !isFinite(+raw)) {
      return null;
    }
    return +raw;
  }
  handleTickRangeOptions() {
    const { beginAtZero } = this.options;
    const { minDefined, maxDefined } = this.getUserBounds();
    let { min: min2, max: max2 } = this;
    const setMin = (v2) => min2 = minDefined ? min2 : v2;
    const setMax = (v2) => max2 = maxDefined ? max2 : v2;
    if (beginAtZero) {
      const minSign = sign$1(min2);
      const maxSign = sign$1(max2);
      if (minSign < 0 && maxSign < 0) {
        setMax(0);
      } else if (minSign > 0 && maxSign > 0) {
        setMin(0);
      }
    }
    if (min2 === max2) {
      let offset2 = max2 === 0 ? 1 : Math.abs(max2 * 0.05);
      setMax(max2 + offset2);
      if (!beginAtZero) {
        setMin(min2 - offset2);
      }
    }
    this.min = min2;
    this.max = max2;
  }
  getTickLimit() {
    const tickOpts = this.options.ticks;
    let { maxTicksLimit, stepSize } = tickOpts;
    let maxTicks;
    if (stepSize) {
      maxTicks = Math.ceil(this.max / stepSize) - Math.floor(this.min / stepSize) + 1;
      if (maxTicks > 1e3) {
        console.warn(`scales.${this.id}.ticks.stepSize: ${stepSize} would result generating up to ${maxTicks} ticks. Limiting to 1000.`);
        maxTicks = 1e3;
      }
    } else {
      maxTicks = this.computeTickLimit();
      maxTicksLimit = maxTicksLimit || 11;
    }
    if (maxTicksLimit) {
      maxTicks = Math.min(maxTicksLimit, maxTicks);
    }
    return maxTicks;
  }
  computeTickLimit() {
    return Number.POSITIVE_INFINITY;
  }
  buildTicks() {
    const opts = this.options;
    const tickOpts = opts.ticks;
    let maxTicks = this.getTickLimit();
    maxTicks = Math.max(2, maxTicks);
    const numericGeneratorOptions = {
      maxTicks,
      bounds: opts.bounds,
      min: opts.min,
      max: opts.max,
      precision: tickOpts.precision,
      step: tickOpts.stepSize,
      count: tickOpts.count,
      maxDigits: this._maxDigits(),
      horizontal: this.isHorizontal(),
      minRotation: tickOpts.minRotation || 0,
      includeBounds: tickOpts.includeBounds !== false
    };
    const dataRange = this._range || this;
    const ticks = generateTicks$1(numericGeneratorOptions, dataRange);
    if (opts.bounds === "ticks") {
      _setMinAndMaxByKey(ticks, this, "value");
    }
    if (opts.reverse) {
      ticks.reverse();
      this.start = this.max;
      this.end = this.min;
    } else {
      this.start = this.min;
      this.end = this.max;
    }
    return ticks;
  }
  configure() {
    const ticks = this.ticks;
    let start = this.min;
    let end = this.max;
    super.configure();
    if (this.options.offset && ticks.length) {
      const offset2 = (end - start) / Math.max(ticks.length - 1, 1) / 2;
      start -= offset2;
      end += offset2;
    }
    this._startValue = start;
    this._endValue = end;
    this._valueRange = end - start;
  }
  getLabelForValue(value) {
    return formatNumber(value, this.chart.options.locale, this.options.ticks.format);
  }
}
class LinearScale extends LinearScaleBase {
  determineDataLimits() {
    const { min: min2, max: max2 } = this.getMinMax(true);
    this.min = isNumberFinite(min2) ? min2 : 0;
    this.max = isNumberFinite(max2) ? max2 : 1;
    this.handleTickRangeOptions();
  }
  computeTickLimit() {
    const horizontal = this.isHorizontal();
    const length = horizontal ? this.width : this.height;
    const minRotation = toRadians(this.options.ticks.minRotation);
    const ratio = (horizontal ? Math.sin(minRotation) : Math.cos(minRotation)) || 1e-3;
    const tickFont = this._resolveTickFontOptions(0);
    return Math.ceil(length / Math.min(40, tickFont.lineHeight / ratio));
  }
  getPixelForValue(value) {
    return value === null ? NaN : this.getPixelForDecimal((value - this._startValue) / this._valueRange);
  }
  getValueForPixel(pixel) {
    return this._startValue + this.getDecimalForPixel(pixel) * this._valueRange;
  }
}
__publicField(LinearScale, "id", "linear");
__publicField(LinearScale, "defaults", {
  ticks: {
    callback: Ticks.formatters.numeric
  }
});
const log10Floor = (v2) => Math.floor(log10(v2));
const changeExponent = (v2, m2) => Math.pow(10, log10Floor(v2) + m2);
function isMajor(tickVal) {
  const remain = tickVal / Math.pow(10, log10Floor(tickVal));
  return remain === 1;
}
function steps(min2, max2, rangeExp) {
  const rangeStep = Math.pow(10, rangeExp);
  const start = Math.floor(min2 / rangeStep);
  const end = Math.ceil(max2 / rangeStep);
  return end - start;
}
function startExp(min2, max2) {
  const range = max2 - min2;
  let rangeExp = log10Floor(range);
  while (steps(min2, max2, rangeExp) > 10) {
    rangeExp++;
  }
  while (steps(min2, max2, rangeExp) < 10) {
    rangeExp--;
  }
  return Math.min(rangeExp, log10Floor(min2));
}
function generateTicks(generationOptions, { min: min2, max: max2 }) {
  min2 = finiteOrDefault(generationOptions.min, min2);
  const ticks = [];
  const minExp = log10Floor(min2);
  let exp = startExp(min2, max2);
  let precision = exp < 0 ? Math.pow(10, Math.abs(exp)) : 1;
  const stepSize = Math.pow(10, exp);
  const base = minExp > exp ? Math.pow(10, minExp) : 0;
  const start = Math.round((min2 - base) * precision) / precision;
  const offset2 = Math.floor((min2 - base) / stepSize / 10) * stepSize * 10;
  let significand = Math.floor((start - offset2) / Math.pow(10, exp));
  let value = finiteOrDefault(generationOptions.min, Math.round((base + offset2 + significand * Math.pow(10, exp)) * precision) / precision);
  while (value < max2) {
    ticks.push({
      value,
      major: isMajor(value),
      significand
    });
    if (significand >= 10) {
      significand = significand < 15 ? 15 : 20;
    } else {
      significand++;
    }
    if (significand >= 20) {
      exp++;
      significand = 2;
      precision = exp >= 0 ? 1 : precision;
    }
    value = Math.round((base + offset2 + significand * Math.pow(10, exp)) * precision) / precision;
  }
  const lastTick = finiteOrDefault(generationOptions.max, value);
  ticks.push({
    value: lastTick,
    major: isMajor(lastTick),
    significand
  });
  return ticks;
}
class LogarithmicScale extends Scale {
  constructor(cfg) {
    super(cfg);
    this.start = void 0;
    this.end = void 0;
    this._startValue = void 0;
    this._valueRange = 0;
  }
  parse(raw, index2) {
    const value = LinearScaleBase.prototype.parse.apply(this, [
      raw,
      index2
    ]);
    if (value === 0) {
      this._zero = true;
      return void 0;
    }
    return isNumberFinite(value) && value > 0 ? value : null;
  }
  determineDataLimits() {
    const { min: min2, max: max2 } = this.getMinMax(true);
    this.min = isNumberFinite(min2) ? Math.max(0, min2) : null;
    this.max = isNumberFinite(max2) ? Math.max(0, max2) : null;
    if (this.options.beginAtZero) {
      this._zero = true;
    }
    if (this._zero && this.min !== this._suggestedMin && !isNumberFinite(this._userMin)) {
      this.min = min2 === changeExponent(this.min, 0) ? changeExponent(this.min, -1) : changeExponent(this.min, 0);
    }
    this.handleTickRangeOptions();
  }
  handleTickRangeOptions() {
    const { minDefined, maxDefined } = this.getUserBounds();
    let min2 = this.min;
    let max2 = this.max;
    const setMin = (v2) => min2 = minDefined ? min2 : v2;
    const setMax = (v2) => max2 = maxDefined ? max2 : v2;
    if (min2 === max2) {
      if (min2 <= 0) {
        setMin(1);
        setMax(10);
      } else {
        setMin(changeExponent(min2, -1));
        setMax(changeExponent(max2, 1));
      }
    }
    if (min2 <= 0) {
      setMin(changeExponent(max2, -1));
    }
    if (max2 <= 0) {
      setMax(changeExponent(min2, 1));
    }
    this.min = min2;
    this.max = max2;
  }
  buildTicks() {
    const opts = this.options;
    const generationOptions = {
      min: this._userMin,
      max: this._userMax
    };
    const ticks = generateTicks(generationOptions, this);
    if (opts.bounds === "ticks") {
      _setMinAndMaxByKey(ticks, this, "value");
    }
    if (opts.reverse) {
      ticks.reverse();
      this.start = this.max;
      this.end = this.min;
    } else {
      this.start = this.min;
      this.end = this.max;
    }
    return ticks;
  }
  getLabelForValue(value) {
    return value === void 0 ? "0" : formatNumber(value, this.chart.options.locale, this.options.ticks.format);
  }
  configure() {
    const start = this.min;
    super.configure();
    this._startValue = log10(start);
    this._valueRange = log10(this.max) - log10(start);
  }
  getPixelForValue(value) {
    if (value === void 0 || value === 0) {
      value = this.min;
    }
    if (value === null || isNaN(value)) {
      return NaN;
    }
    return this.getPixelForDecimal(value === this.min ? 0 : (log10(value) - this._startValue) / this._valueRange);
  }
  getValueForPixel(pixel) {
    const decimal = this.getDecimalForPixel(pixel);
    return Math.pow(10, this._startValue + decimal * this._valueRange);
  }
}
__publicField(LogarithmicScale, "id", "logarithmic");
__publicField(LogarithmicScale, "defaults", {
  ticks: {
    callback: Ticks.formatters.logarithmic,
    major: {
      enabled: true
    }
  }
});
function getTickBackdropHeight(opts) {
  const tickOpts = opts.ticks;
  if (tickOpts.display && opts.display) {
    const padding = toPadding(tickOpts.backdropPadding);
    return valueOrDefault(tickOpts.font && tickOpts.font.size, defaults$1.font.size) + padding.height;
  }
  return 0;
}
function measureLabelSize(ctx, font, label) {
  label = isArray$1(label) ? label : [
    label
  ];
  return {
    w: _longestText(ctx, font.string, label),
    h: label.length * font.lineHeight
  };
}
function determineLimits(angle, pos, size, min2, max2) {
  if (angle === min2 || angle === max2) {
    return {
      start: pos - size / 2,
      end: pos + size / 2
    };
  } else if (angle < min2 || angle > max2) {
    return {
      start: pos - size,
      end: pos
    };
  }
  return {
    start: pos,
    end: pos + size
  };
}
function fitWithPointLabels(scale) {
  const orig = {
    l: scale.left + scale._padding.left,
    r: scale.right - scale._padding.right,
    t: scale.top + scale._padding.top,
    b: scale.bottom - scale._padding.bottom
  };
  const limits = Object.assign({}, orig);
  const labelSizes = [];
  const padding = [];
  const valueCount = scale._pointLabels.length;
  const pointLabelOpts = scale.options.pointLabels;
  const additionalAngle = pointLabelOpts.centerPointLabels ? PI / valueCount : 0;
  for (let i = 0; i < valueCount; i++) {
    const opts = pointLabelOpts.setContext(scale.getPointLabelContext(i));
    padding[i] = opts.padding;
    const pointPosition = scale.getPointPosition(i, scale.drawingArea + padding[i], additionalAngle);
    const plFont = toFont(opts.font);
    const textSize = measureLabelSize(scale.ctx, plFont, scale._pointLabels[i]);
    labelSizes[i] = textSize;
    const angleRadians = _normalizeAngle(scale.getIndexAngle(i) + additionalAngle);
    const angle = Math.round(toDegrees(angleRadians));
    const hLimits = determineLimits(angle, pointPosition.x, textSize.w, 0, 180);
    const vLimits = determineLimits(angle, pointPosition.y, textSize.h, 90, 270);
    updateLimits(limits, orig, angleRadians, hLimits, vLimits);
  }
  scale.setCenterPoint(orig.l - limits.l, limits.r - orig.r, orig.t - limits.t, limits.b - orig.b);
  scale._pointLabelItems = buildPointLabelItems(scale, labelSizes, padding);
}
function updateLimits(limits, orig, angle, hLimits, vLimits) {
  const sin = Math.abs(Math.sin(angle));
  const cos = Math.abs(Math.cos(angle));
  let x2 = 0;
  let y2 = 0;
  if (hLimits.start < orig.l) {
    x2 = (orig.l - hLimits.start) / sin;
    limits.l = Math.min(limits.l, orig.l - x2);
  } else if (hLimits.end > orig.r) {
    x2 = (hLimits.end - orig.r) / sin;
    limits.r = Math.max(limits.r, orig.r + x2);
  }
  if (vLimits.start < orig.t) {
    y2 = (orig.t - vLimits.start) / cos;
    limits.t = Math.min(limits.t, orig.t - y2);
  } else if (vLimits.end > orig.b) {
    y2 = (vLimits.end - orig.b) / cos;
    limits.b = Math.max(limits.b, orig.b + y2);
  }
}
function createPointLabelItem(scale, index2, itemOpts) {
  const outerDistance = scale.drawingArea;
  const { extra, additionalAngle, padding, size } = itemOpts;
  const pointLabelPosition = scale.getPointPosition(index2, outerDistance + extra + padding, additionalAngle);
  const angle = Math.round(toDegrees(_normalizeAngle(pointLabelPosition.angle + HALF_PI)));
  const y2 = yForAngle(pointLabelPosition.y, size.h, angle);
  const textAlign = getTextAlignForAngle(angle);
  const left = leftForTextAlign(pointLabelPosition.x, size.w, textAlign);
  return {
    visible: true,
    x: pointLabelPosition.x,
    y: y2,
    textAlign,
    left,
    top: y2,
    right: left + size.w,
    bottom: y2 + size.h
  };
}
function isNotOverlapped(item, area) {
  if (!area) {
    return true;
  }
  const { left, top, right, bottom } = item;
  const apexesInArea = _isPointInArea({
    x: left,
    y: top
  }, area) || _isPointInArea({
    x: left,
    y: bottom
  }, area) || _isPointInArea({
    x: right,
    y: top
  }, area) || _isPointInArea({
    x: right,
    y: bottom
  }, area);
  return !apexesInArea;
}
function buildPointLabelItems(scale, labelSizes, padding) {
  const items = [];
  const valueCount = scale._pointLabels.length;
  const opts = scale.options;
  const { centerPointLabels, display } = opts.pointLabels;
  const itemOpts = {
    extra: getTickBackdropHeight(opts) / 2,
    additionalAngle: centerPointLabels ? PI / valueCount : 0
  };
  let area;
  for (let i = 0; i < valueCount; i++) {
    itemOpts.padding = padding[i];
    itemOpts.size = labelSizes[i];
    const item = createPointLabelItem(scale, i, itemOpts);
    items.push(item);
    if (display === "auto") {
      item.visible = isNotOverlapped(item, area);
      if (item.visible) {
        area = item;
      }
    }
  }
  return items;
}
function getTextAlignForAngle(angle) {
  if (angle === 0 || angle === 180) {
    return "center";
  } else if (angle < 180) {
    return "left";
  }
  return "right";
}
function leftForTextAlign(x2, w2, align) {
  if (align === "right") {
    x2 -= w2;
  } else if (align === "center") {
    x2 -= w2 / 2;
  }
  return x2;
}
function yForAngle(y2, h, angle) {
  if (angle === 90 || angle === 270) {
    y2 -= h / 2;
  } else if (angle > 270 || angle < 90) {
    y2 -= h;
  }
  return y2;
}
function drawPointLabelBox(ctx, opts, item) {
  const { left, top, right, bottom } = item;
  const { backdropColor } = opts;
  if (!isNullOrUndef(backdropColor)) {
    const borderRadius = toTRBLCorners(opts.borderRadius);
    const padding = toPadding(opts.backdropPadding);
    ctx.fillStyle = backdropColor;
    const backdropLeft = left - padding.left;
    const backdropTop = top - padding.top;
    const backdropWidth = right - left + padding.width;
    const backdropHeight = bottom - top + padding.height;
    if (Object.values(borderRadius).some((v2) => v2 !== 0)) {
      ctx.beginPath();
      addRoundedRectPath(ctx, {
        x: backdropLeft,
        y: backdropTop,
        w: backdropWidth,
        h: backdropHeight,
        radius: borderRadius
      });
      ctx.fill();
    } else {
      ctx.fillRect(backdropLeft, backdropTop, backdropWidth, backdropHeight);
    }
  }
}
function drawPointLabels(scale, labelCount) {
  const { ctx, options: { pointLabels } } = scale;
  for (let i = labelCount - 1; i >= 0; i--) {
    const item = scale._pointLabelItems[i];
    if (!item.visible) {
      continue;
    }
    const optsAtIndex = pointLabels.setContext(scale.getPointLabelContext(i));
    drawPointLabelBox(ctx, optsAtIndex, item);
    const plFont = toFont(optsAtIndex.font);
    const { x: x2, y: y2, textAlign } = item;
    renderText(ctx, scale._pointLabels[i], x2, y2 + plFont.lineHeight / 2, plFont, {
      color: optsAtIndex.color,
      textAlign,
      textBaseline: "middle"
    });
  }
}
function pathRadiusLine(scale, radius, circular, labelCount) {
  const { ctx } = scale;
  if (circular) {
    ctx.arc(scale.xCenter, scale.yCenter, radius, 0, TAU);
  } else {
    let pointPosition = scale.getPointPosition(0, radius);
    ctx.moveTo(pointPosition.x, pointPosition.y);
    for (let i = 1; i < labelCount; i++) {
      pointPosition = scale.getPointPosition(i, radius);
      ctx.lineTo(pointPosition.x, pointPosition.y);
    }
  }
}
function drawRadiusLine(scale, gridLineOpts, radius, labelCount, borderOpts) {
  const ctx = scale.ctx;
  const circular = gridLineOpts.circular;
  const { color: color2, lineWidth } = gridLineOpts;
  if (!circular && !labelCount || !color2 || !lineWidth || radius < 0) {
    return;
  }
  ctx.save();
  ctx.strokeStyle = color2;
  ctx.lineWidth = lineWidth;
  ctx.setLineDash(borderOpts.dash);
  ctx.lineDashOffset = borderOpts.dashOffset;
  ctx.beginPath();
  pathRadiusLine(scale, radius, circular, labelCount);
  ctx.closePath();
  ctx.stroke();
  ctx.restore();
}
function createPointLabelContext(parent, index2, label) {
  return createContext(parent, {
    label,
    index: index2,
    type: "pointLabel"
  });
}
class RadialLinearScale extends LinearScaleBase {
  constructor(cfg) {
    super(cfg);
    this.xCenter = void 0;
    this.yCenter = void 0;
    this.drawingArea = void 0;
    this._pointLabels = [];
    this._pointLabelItems = [];
  }
  setDimensions() {
    const padding = this._padding = toPadding(getTickBackdropHeight(this.options) / 2);
    const w2 = this.width = this.maxWidth - padding.width;
    const h = this.height = this.maxHeight - padding.height;
    this.xCenter = Math.floor(this.left + w2 / 2 + padding.left);
    this.yCenter = Math.floor(this.top + h / 2 + padding.top);
    this.drawingArea = Math.floor(Math.min(w2, h) / 2);
  }
  determineDataLimits() {
    const { min: min2, max: max2 } = this.getMinMax(false);
    this.min = isNumberFinite(min2) && !isNaN(min2) ? min2 : 0;
    this.max = isNumberFinite(max2) && !isNaN(max2) ? max2 : 0;
    this.handleTickRangeOptions();
  }
  computeTickLimit() {
    return Math.ceil(this.drawingArea / getTickBackdropHeight(this.options));
  }
  generateTickLabels(ticks) {
    LinearScaleBase.prototype.generateTickLabels.call(this, ticks);
    this._pointLabels = this.getLabels().map((value, index2) => {
      const label = callback(this.options.pointLabels.callback, [
        value,
        index2
      ], this);
      return label || label === 0 ? label : "";
    }).filter((v2, i) => this.chart.getDataVisibility(i));
  }
  fit() {
    const opts = this.options;
    if (opts.display && opts.pointLabels.display) {
      fitWithPointLabels(this);
    } else {
      this.setCenterPoint(0, 0, 0, 0);
    }
  }
  setCenterPoint(leftMovement, rightMovement, topMovement, bottomMovement) {
    this.xCenter += Math.floor((leftMovement - rightMovement) / 2);
    this.yCenter += Math.floor((topMovement - bottomMovement) / 2);
    this.drawingArea -= Math.min(this.drawingArea / 2, Math.max(leftMovement, rightMovement, topMovement, bottomMovement));
  }
  getIndexAngle(index2) {
    const angleMultiplier = TAU / (this._pointLabels.length || 1);
    const startAngle = this.options.startAngle || 0;
    return _normalizeAngle(index2 * angleMultiplier + toRadians(startAngle));
  }
  getDistanceFromCenterForValue(value) {
    if (isNullOrUndef(value)) {
      return NaN;
    }
    const scalingFactor = this.drawingArea / (this.max - this.min);
    if (this.options.reverse) {
      return (this.max - value) * scalingFactor;
    }
    return (value - this.min) * scalingFactor;
  }
  getValueForDistanceFromCenter(distance) {
    if (isNullOrUndef(distance)) {
      return NaN;
    }
    const scaledDistance = distance / (this.drawingArea / (this.max - this.min));
    return this.options.reverse ? this.max - scaledDistance : this.min + scaledDistance;
  }
  getPointLabelContext(index2) {
    const pointLabels = this._pointLabels || [];
    if (index2 >= 0 && index2 < pointLabels.length) {
      const pointLabel = pointLabels[index2];
      return createPointLabelContext(this.getContext(), index2, pointLabel);
    }
  }
  getPointPosition(index2, distanceFromCenter, additionalAngle = 0) {
    const angle = this.getIndexAngle(index2) - HALF_PI + additionalAngle;
    return {
      x: Math.cos(angle) * distanceFromCenter + this.xCenter,
      y: Math.sin(angle) * distanceFromCenter + this.yCenter,
      angle
    };
  }
  getPointPositionForValue(index2, value) {
    return this.getPointPosition(index2, this.getDistanceFromCenterForValue(value));
  }
  getBasePosition(index2) {
    return this.getPointPositionForValue(index2 || 0, this.getBaseValue());
  }
  getPointLabelPosition(index2) {
    const { left, top, right, bottom } = this._pointLabelItems[index2];
    return {
      left,
      top,
      right,
      bottom
    };
  }
  drawBackground() {
    const { backgroundColor, grid: { circular } } = this.options;
    if (backgroundColor) {
      const ctx = this.ctx;
      ctx.save();
      ctx.beginPath();
      pathRadiusLine(this, this.getDistanceFromCenterForValue(this._endValue), circular, this._pointLabels.length);
      ctx.closePath();
      ctx.fillStyle = backgroundColor;
      ctx.fill();
      ctx.restore();
    }
  }
  drawGrid() {
    const ctx = this.ctx;
    const opts = this.options;
    const { angleLines, grid, border } = opts;
    const labelCount = this._pointLabels.length;
    let i, offset2, position;
    if (opts.pointLabels.display) {
      drawPointLabels(this, labelCount);
    }
    if (grid.display) {
      this.ticks.forEach((tick, index2) => {
        if (index2 !== 0) {
          offset2 = this.getDistanceFromCenterForValue(tick.value);
          const context = this.getContext(index2);
          const optsAtIndex = grid.setContext(context);
          const optsAtIndexBorder = border.setContext(context);
          drawRadiusLine(this, optsAtIndex, offset2, labelCount, optsAtIndexBorder);
        }
      });
    }
    if (angleLines.display) {
      ctx.save();
      for (i = labelCount - 1; i >= 0; i--) {
        const optsAtIndex = angleLines.setContext(this.getPointLabelContext(i));
        const { color: color2, lineWidth } = optsAtIndex;
        if (!lineWidth || !color2) {
          continue;
        }
        ctx.lineWidth = lineWidth;
        ctx.strokeStyle = color2;
        ctx.setLineDash(optsAtIndex.borderDash);
        ctx.lineDashOffset = optsAtIndex.borderDashOffset;
        offset2 = this.getDistanceFromCenterForValue(opts.ticks.reverse ? this.min : this.max);
        position = this.getPointPosition(i, offset2);
        ctx.beginPath();
        ctx.moveTo(this.xCenter, this.yCenter);
        ctx.lineTo(position.x, position.y);
        ctx.stroke();
      }
      ctx.restore();
    }
  }
  drawBorder() {
  }
  drawLabels() {
    const ctx = this.ctx;
    const opts = this.options;
    const tickOpts = opts.ticks;
    if (!tickOpts.display) {
      return;
    }
    const startAngle = this.getIndexAngle(0);
    let offset2, width;
    ctx.save();
    ctx.translate(this.xCenter, this.yCenter);
    ctx.rotate(startAngle);
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    this.ticks.forEach((tick, index2) => {
      if (index2 === 0 && !opts.reverse) {
        return;
      }
      const optsAtIndex = tickOpts.setContext(this.getContext(index2));
      const tickFont = toFont(optsAtIndex.font);
      offset2 = this.getDistanceFromCenterForValue(this.ticks[index2].value);
      if (optsAtIndex.showLabelBackdrop) {
        ctx.font = tickFont.string;
        width = ctx.measureText(tick.label).width;
        ctx.fillStyle = optsAtIndex.backdropColor;
        const padding = toPadding(optsAtIndex.backdropPadding);
        ctx.fillRect(-width / 2 - padding.left, -offset2 - tickFont.size / 2 - padding.top, width + padding.width, tickFont.size + padding.height);
      }
      renderText(ctx, tick.label, 0, -offset2, tickFont, {
        color: optsAtIndex.color,
        strokeColor: optsAtIndex.textStrokeColor,
        strokeWidth: optsAtIndex.textStrokeWidth
      });
    });
    ctx.restore();
  }
  drawTitle() {
  }
}
__publicField(RadialLinearScale, "id", "radialLinear");
__publicField(RadialLinearScale, "defaults", {
  display: true,
  animate: true,
  position: "chartArea",
  angleLines: {
    display: true,
    lineWidth: 1,
    borderDash: [],
    borderDashOffset: 0
  },
  grid: {
    circular: false
  },
  startAngle: 0,
  ticks: {
    showLabelBackdrop: true,
    callback: Ticks.formatters.numeric
  },
  pointLabels: {
    backdropColor: void 0,
    backdropPadding: 2,
    display: true,
    font: {
      size: 10
    },
    callback(label) {
      return label;
    },
    padding: 5,
    centerPointLabels: false
  }
});
__publicField(RadialLinearScale, "defaultRoutes", {
  "angleLines.color": "borderColor",
  "pointLabels.color": "color",
  "ticks.color": "color"
});
__publicField(RadialLinearScale, "descriptors", {
  angleLines: {
    _fallback: "grid"
  }
});
const INTERVALS = {
  millisecond: {
    common: true,
    size: 1,
    steps: 1e3
  },
  second: {
    common: true,
    size: 1e3,
    steps: 60
  },
  minute: {
    common: true,
    size: 6e4,
    steps: 60
  },
  hour: {
    common: true,
    size: 36e5,
    steps: 24
  },
  day: {
    common: true,
    size: 864e5,
    steps: 30
  },
  week: {
    common: false,
    size: 6048e5,
    steps: 4
  },
  month: {
    common: true,
    size: 2628e6,
    steps: 12
  },
  quarter: {
    common: false,
    size: 7884e6,
    steps: 4
  },
  year: {
    common: true,
    size: 3154e7
  }
};
const UNITS = /* @__PURE__ */ Object.keys(INTERVALS);
function sorter(a, b) {
  return a - b;
}
function parse(scale, input) {
  if (isNullOrUndef(input)) {
    return null;
  }
  const adapter = scale._adapter;
  const { parser, round: round2, isoWeekday } = scale._parseOpts;
  let value = input;
  if (typeof parser === "function") {
    value = parser(value);
  }
  if (!isNumberFinite(value)) {
    value = typeof parser === "string" ? adapter.parse(value, parser) : adapter.parse(value);
  }
  if (value === null) {
    return null;
  }
  if (round2) {
    value = round2 === "week" && (isNumber$1(isoWeekday) || isoWeekday === true) ? adapter.startOf(value, "isoWeek", isoWeekday) : adapter.startOf(value, round2);
  }
  return +value;
}
function determineUnitForAutoTicks(minUnit, min2, max2, capacity) {
  const ilen = UNITS.length;
  for (let i = UNITS.indexOf(minUnit); i < ilen - 1; ++i) {
    const interval = INTERVALS[UNITS[i]];
    const factor = interval.steps ? interval.steps : Number.MAX_SAFE_INTEGER;
    if (interval.common && Math.ceil((max2 - min2) / (factor * interval.size)) <= capacity) {
      return UNITS[i];
    }
  }
  return UNITS[ilen - 1];
}
function determineUnitForFormatting(scale, numTicks, minUnit, min2, max2) {
  for (let i = UNITS.length - 1; i >= UNITS.indexOf(minUnit); i--) {
    const unit = UNITS[i];
    if (INTERVALS[unit].common && scale._adapter.diff(max2, min2, unit) >= numTicks - 1) {
      return unit;
    }
  }
  return UNITS[minUnit ? UNITS.indexOf(minUnit) : 0];
}
function determineMajorUnit(unit) {
  for (let i = UNITS.indexOf(unit) + 1, ilen = UNITS.length; i < ilen; ++i) {
    if (INTERVALS[UNITS[i]].common) {
      return UNITS[i];
    }
  }
}
function addTick(ticks, time, timestamps) {
  if (!timestamps) {
    ticks[time] = true;
  } else if (timestamps.length) {
    const { lo, hi: hi2 } = _lookup(timestamps, time);
    const timestamp = timestamps[lo] >= time ? timestamps[lo] : timestamps[hi2];
    ticks[timestamp] = true;
  }
}
function setMajorTicks(scale, ticks, map2, majorUnit) {
  const adapter = scale._adapter;
  const first = +adapter.startOf(ticks[0].value, majorUnit);
  const last2 = ticks[ticks.length - 1].value;
  let major, index2;
  for (major = first; major <= last2; major = +adapter.add(major, 1, majorUnit)) {
    index2 = map2[major];
    if (index2 >= 0) {
      ticks[index2].major = true;
    }
  }
  return ticks;
}
function ticksFromTimestamps(scale, values2, majorUnit) {
  const ticks = [];
  const map2 = {};
  const ilen = values2.length;
  let i, value;
  for (i = 0; i < ilen; ++i) {
    value = values2[i];
    map2[value] = i;
    ticks.push({
      value,
      major: false
    });
  }
  return ilen === 0 || !majorUnit ? ticks : setMajorTicks(scale, ticks, map2, majorUnit);
}
class TimeScale extends Scale {
  constructor(props) {
    super(props);
    this._cache = {
      data: [],
      labels: [],
      all: []
    };
    this._unit = "day";
    this._majorUnit = void 0;
    this._offsets = {};
    this._normalized = false;
    this._parseOpts = void 0;
  }
  init(scaleOpts, opts = {}) {
    const time = scaleOpts.time || (scaleOpts.time = {});
    const adapter = this._adapter = new adapters._date(scaleOpts.adapters.date);
    adapter.init(opts);
    mergeIf(time.displayFormats, adapter.formats());
    this._parseOpts = {
      parser: time.parser,
      round: time.round,
      isoWeekday: time.isoWeekday
    };
    super.init(scaleOpts);
    this._normalized = opts.normalized;
  }
  parse(raw, index2) {
    if (raw === void 0) {
      return null;
    }
    return parse(this, raw);
  }
  beforeLayout() {
    super.beforeLayout();
    this._cache = {
      data: [],
      labels: [],
      all: []
    };
  }
  determineDataLimits() {
    const options = this.options;
    const adapter = this._adapter;
    const unit = options.time.unit || "day";
    let { min: min2, max: max2, minDefined, maxDefined } = this.getUserBounds();
    function _applyBounds(bounds) {
      if (!minDefined && !isNaN(bounds.min)) {
        min2 = Math.min(min2, bounds.min);
      }
      if (!maxDefined && !isNaN(bounds.max)) {
        max2 = Math.max(max2, bounds.max);
      }
    }
    if (!minDefined || !maxDefined) {
      _applyBounds(this._getLabelBounds());
      if (options.bounds !== "ticks" || options.ticks.source !== "labels") {
        _applyBounds(this.getMinMax(false));
      }
    }
    min2 = isNumberFinite(min2) && !isNaN(min2) ? min2 : +adapter.startOf(Date.now(), unit);
    max2 = isNumberFinite(max2) && !isNaN(max2) ? max2 : +adapter.endOf(Date.now(), unit) + 1;
    this.min = Math.min(min2, max2 - 1);
    this.max = Math.max(min2 + 1, max2);
  }
  _getLabelBounds() {
    const arr = this.getLabelTimestamps();
    let min2 = Number.POSITIVE_INFINITY;
    let max2 = Number.NEGATIVE_INFINITY;
    if (arr.length) {
      min2 = arr[0];
      max2 = arr[arr.length - 1];
    }
    return {
      min: min2,
      max: max2
    };
  }
  buildTicks() {
    const options = this.options;
    const timeOpts = options.time;
    const tickOpts = options.ticks;
    const timestamps = tickOpts.source === "labels" ? this.getLabelTimestamps() : this._generate();
    if (options.bounds === "ticks" && timestamps.length) {
      this.min = this._userMin || timestamps[0];
      this.max = this._userMax || timestamps[timestamps.length - 1];
    }
    const min2 = this.min;
    const max2 = this.max;
    const ticks = _filterBetween(timestamps, min2, max2);
    this._unit = timeOpts.unit || (tickOpts.autoSkip ? determineUnitForAutoTicks(timeOpts.minUnit, this.min, this.max, this._getLabelCapacity(min2)) : determineUnitForFormatting(this, ticks.length, timeOpts.minUnit, this.min, this.max));
    this._majorUnit = !tickOpts.major.enabled || this._unit === "year" ? void 0 : determineMajorUnit(this._unit);
    this.initOffsets(timestamps);
    if (options.reverse) {
      ticks.reverse();
    }
    return ticksFromTimestamps(this, ticks, this._majorUnit);
  }
  afterAutoSkip() {
    if (this.options.offsetAfterAutoskip) {
      this.initOffsets(this.ticks.map((tick) => +tick.value));
    }
  }
  initOffsets(timestamps = []) {
    let start = 0;
    let end = 0;
    let first, last2;
    if (this.options.offset && timestamps.length) {
      first = this.getDecimalForValue(timestamps[0]);
      if (timestamps.length === 1) {
        start = 1 - first;
      } else {
        start = (this.getDecimalForValue(timestamps[1]) - first) / 2;
      }
      last2 = this.getDecimalForValue(timestamps[timestamps.length - 1]);
      if (timestamps.length === 1) {
        end = last2;
      } else {
        end = (last2 - this.getDecimalForValue(timestamps[timestamps.length - 2])) / 2;
      }
    }
    const limit = timestamps.length < 3 ? 0.5 : 0.25;
    start = _limitValue(start, 0, limit);
    end = _limitValue(end, 0, limit);
    this._offsets = {
      start,
      end,
      factor: 1 / (start + 1 + end)
    };
  }
  _generate() {
    const adapter = this._adapter;
    const min2 = this.min;
    const max2 = this.max;
    const options = this.options;
    const timeOpts = options.time;
    const minor = timeOpts.unit || determineUnitForAutoTicks(timeOpts.minUnit, min2, max2, this._getLabelCapacity(min2));
    const stepSize = valueOrDefault(options.ticks.stepSize, 1);
    const weekday = minor === "week" ? timeOpts.isoWeekday : false;
    const hasWeekday = isNumber$1(weekday) || weekday === true;
    const ticks = {};
    let first = min2;
    let time, count;
    if (hasWeekday) {
      first = +adapter.startOf(first, "isoWeek", weekday);
    }
    first = +adapter.startOf(first, hasWeekday ? "day" : minor);
    if (adapter.diff(max2, min2, minor) > 1e5 * stepSize) {
      throw new Error(min2 + " and " + max2 + " are too far apart with stepSize of " + stepSize + " " + minor);
    }
    const timestamps = options.ticks.source === "data" && this.getDataTimestamps();
    for (time = first, count = 0; time < max2; time = +adapter.add(time, stepSize, minor), count++) {
      addTick(ticks, time, timestamps);
    }
    if (time === max2 || options.bounds === "ticks" || count === 1) {
      addTick(ticks, time, timestamps);
    }
    return Object.keys(ticks).sort(sorter).map((x2) => +x2);
  }
  getLabelForValue(value) {
    const adapter = this._adapter;
    const timeOpts = this.options.time;
    if (timeOpts.tooltipFormat) {
      return adapter.format(value, timeOpts.tooltipFormat);
    }
    return adapter.format(value, timeOpts.displayFormats.datetime);
  }
  format(value, format2) {
    const options = this.options;
    const formats = options.time.displayFormats;
    const unit = this._unit;
    const fmt = format2 || formats[unit];
    return this._adapter.format(value, fmt);
  }
  _tickFormatFunction(time, index2, ticks, format2) {
    const options = this.options;
    const formatter = options.ticks.callback;
    if (formatter) {
      return callback(formatter, [
        time,
        index2,
        ticks
      ], this);
    }
    const formats = options.time.displayFormats;
    const unit = this._unit;
    const majorUnit = this._majorUnit;
    const minorFormat = unit && formats[unit];
    const majorFormat = majorUnit && formats[majorUnit];
    const tick = ticks[index2];
    const major = majorUnit && majorFormat && tick && tick.major;
    return this._adapter.format(time, format2 || (major ? majorFormat : minorFormat));
  }
  generateTickLabels(ticks) {
    let i, ilen, tick;
    for (i = 0, ilen = ticks.length; i < ilen; ++i) {
      tick = ticks[i];
      tick.label = this._tickFormatFunction(tick.value, i, ticks);
    }
  }
  getDecimalForValue(value) {
    return value === null ? NaN : (value - this.min) / (this.max - this.min);
  }
  getPixelForValue(value) {
    const offsets = this._offsets;
    const pos = this.getDecimalForValue(value);
    return this.getPixelForDecimal((offsets.start + pos) * offsets.factor);
  }
  getValueForPixel(pixel) {
    const offsets = this._offsets;
    const pos = this.getDecimalForPixel(pixel) / offsets.factor - offsets.end;
    return this.min + pos * (this.max - this.min);
  }
  _getLabelSize(label) {
    const ticksOpts = this.options.ticks;
    const tickLabelWidth = this.ctx.measureText(label).width;
    const angle = toRadians(this.isHorizontal() ? ticksOpts.maxRotation : ticksOpts.minRotation);
    const cosRotation = Math.cos(angle);
    const sinRotation = Math.sin(angle);
    const tickFontSize = this._resolveTickFontOptions(0).size;
    return {
      w: tickLabelWidth * cosRotation + tickFontSize * sinRotation,
      h: tickLabelWidth * sinRotation + tickFontSize * cosRotation
    };
  }
  _getLabelCapacity(exampleTime) {
    const timeOpts = this.options.time;
    const displayFormats = timeOpts.displayFormats;
    const format2 = displayFormats[timeOpts.unit] || displayFormats.millisecond;
    const exampleLabel = this._tickFormatFunction(exampleTime, 0, ticksFromTimestamps(this, [
      exampleTime
    ], this._majorUnit), format2);
    const size = this._getLabelSize(exampleLabel);
    const capacity = Math.floor(this.isHorizontal() ? this.width / size.w : this.height / size.h) - 1;
    return capacity > 0 ? capacity : 1;
  }
  getDataTimestamps() {
    let timestamps = this._cache.data || [];
    let i, ilen;
    if (timestamps.length) {
      return timestamps;
    }
    const metas = this.getMatchingVisibleMetas();
    if (this._normalized && metas.length) {
      return this._cache.data = metas[0].controller.getAllParsedValues(this);
    }
    for (i = 0, ilen = metas.length; i < ilen; ++i) {
      timestamps = timestamps.concat(metas[i].controller.getAllParsedValues(this));
    }
    return this._cache.data = this.normalize(timestamps);
  }
  getLabelTimestamps() {
    const timestamps = this._cache.labels || [];
    let i, ilen;
    if (timestamps.length) {
      return timestamps;
    }
    const labels = this.getLabels();
    for (i = 0, ilen = labels.length; i < ilen; ++i) {
      timestamps.push(parse(this, labels[i]));
    }
    return this._cache.labels = this._normalized ? timestamps : this.normalize(timestamps);
  }
  normalize(values2) {
    return _arrayUnique(values2.sort(sorter));
  }
}
__publicField(TimeScale, "id", "time");
__publicField(TimeScale, "defaults", {
  bounds: "data",
  adapters: {},
  time: {
    parser: false,
    unit: false,
    round: false,
    isoWeekday: false,
    minUnit: "millisecond",
    displayFormats: {}
  },
  ticks: {
    source: "auto",
    callback: false,
    major: {
      enabled: false
    }
  }
});
function interpolate(table, val, reverse) {
  let lo = 0;
  let hi2 = table.length - 1;
  let prevSource, nextSource, prevTarget, nextTarget;
  if (reverse) {
    if (val >= table[lo].pos && val <= table[hi2].pos) {
      ({ lo, hi: hi2 } = _lookupByKey(table, "pos", val));
    }
    ({ pos: prevSource, time: prevTarget } = table[lo]);
    ({ pos: nextSource, time: nextTarget } = table[hi2]);
  } else {
    if (val >= table[lo].time && val <= table[hi2].time) {
      ({ lo, hi: hi2 } = _lookupByKey(table, "time", val));
    }
    ({ time: prevSource, pos: prevTarget } = table[lo]);
    ({ time: nextSource, pos: nextTarget } = table[hi2]);
  }
  const span = nextSource - prevSource;
  return span ? prevTarget + (nextTarget - prevTarget) * (val - prevSource) / span : prevTarget;
}
class TimeSeriesScale extends TimeScale {
  constructor(props) {
    super(props);
    this._table = [];
    this._minPos = void 0;
    this._tableRange = void 0;
  }
  initOffsets() {
    const timestamps = this._getTimestampsForTable();
    const table = this._table = this.buildLookupTable(timestamps);
    this._minPos = interpolate(table, this.min);
    this._tableRange = interpolate(table, this.max) - this._minPos;
    super.initOffsets(timestamps);
  }
  buildLookupTable(timestamps) {
    const { min: min2, max: max2 } = this;
    const items = [];
    const table = [];
    let i, ilen, prev, curr, next;
    for (i = 0, ilen = timestamps.length; i < ilen; ++i) {
      curr = timestamps[i];
      if (curr >= min2 && curr <= max2) {
        items.push(curr);
      }
    }
    if (items.length < 2) {
      return [
        {
          time: min2,
          pos: 0
        },
        {
          time: max2,
          pos: 1
        }
      ];
    }
    for (i = 0, ilen = items.length; i < ilen; ++i) {
      next = items[i + 1];
      prev = items[i - 1];
      curr = items[i];
      if (Math.round((next + prev) / 2) !== curr) {
        table.push({
          time: curr,
          pos: i / (ilen - 1)
        });
      }
    }
    return table;
  }
  _generate() {
    const min2 = this.min;
    const max2 = this.max;
    let timestamps = super.getDataTimestamps();
    if (!timestamps.includes(min2) || !timestamps.length) {
      timestamps.splice(0, 0, min2);
    }
    if (!timestamps.includes(max2) || timestamps.length === 1) {
      timestamps.push(max2);
    }
    return timestamps.sort((a, b) => a - b);
  }
  _getTimestampsForTable() {
    let timestamps = this._cache.all || [];
    if (timestamps.length) {
      return timestamps;
    }
    const data = this.getDataTimestamps();
    const label = this.getLabelTimestamps();
    if (data.length && label.length) {
      timestamps = this.normalize(data.concat(label));
    } else {
      timestamps = data.length ? data : label;
    }
    timestamps = this._cache.all = timestamps;
    return timestamps;
  }
  getDecimalForValue(value) {
    return (interpolate(this._table, value) - this._minPos) / this._tableRange;
  }
  getValueForPixel(pixel) {
    const offsets = this._offsets;
    const decimal = this.getDecimalForPixel(pixel) / offsets.factor - offsets.end;
    return interpolate(this._table, decimal * this._tableRange + this._minPos, true);
  }
}
__publicField(TimeSeriesScale, "id", "timeseries");
__publicField(TimeSeriesScale, "defaults", TimeScale.defaults);
var scales = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  CategoryScale,
  LinearScale,
  LogarithmicScale,
  RadialLinearScale,
  TimeScale,
  TimeSeriesScale
});
const registerables = [
  controllers,
  elements,
  plugins,
  scales
];
Chart$1.register(...registerables);
const defaultDatasetIdKey = "label";
function reforwardRef(ref, value) {
  if (typeof ref === "function") {
    ref(value);
  } else if (ref) {
    ref.current = value;
  }
}
function setOptions(chart, nextOptions) {
  const options = chart.options;
  if (options && nextOptions) {
    Object.assign(options, nextOptions);
  }
}
function setLabels(currentData, nextLabels) {
  currentData.labels = nextLabels;
}
function setDatasets(currentData, nextDatasets) {
  let datasetIdKey = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : defaultDatasetIdKey;
  const addedDatasets = [];
  currentData.datasets = nextDatasets.map((nextDataset) => {
    const currentDataset = currentData.datasets.find((dataset) => dataset[datasetIdKey] === nextDataset[datasetIdKey]);
    if (!currentDataset || !nextDataset.data || addedDatasets.includes(currentDataset)) {
      return {
        ...nextDataset
      };
    }
    addedDatasets.push(currentDataset);
    Object.assign(currentDataset, nextDataset);
    return currentDataset;
  });
}
function cloneData(data) {
  let datasetIdKey = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : defaultDatasetIdKey;
  const nextData = {
    labels: [],
    datasets: []
  };
  setLabels(nextData, data.labels);
  setDatasets(nextData, data.datasets, datasetIdKey);
  return nextData;
}
function ChartComponent(props, ref) {
  const { height = 150, width = 300, redraw = false, datasetIdKey, type, data, options, plugins: plugins2 = [], fallbackContent, updateMode, ...canvasProps } = props;
  const canvasRef = reactExports.useRef(null);
  const chartRef = reactExports.useRef();
  const renderChart = () => {
    if (!canvasRef.current)
      return;
    chartRef.current = new Chart$1(canvasRef.current, {
      type,
      data: cloneData(data, datasetIdKey),
      options: options && {
        ...options
      },
      plugins: plugins2
    });
    reforwardRef(ref, chartRef.current);
  };
  const destroyChart = () => {
    reforwardRef(ref, null);
    if (chartRef.current) {
      chartRef.current.destroy();
      chartRef.current = null;
    }
  };
  reactExports.useEffect(() => {
    if (!redraw && chartRef.current && options) {
      setOptions(chartRef.current, options);
    }
  }, [
    redraw,
    options
  ]);
  reactExports.useEffect(() => {
    if (!redraw && chartRef.current) {
      setLabels(chartRef.current.config.data, data.labels);
    }
  }, [
    redraw,
    data.labels
  ]);
  reactExports.useEffect(() => {
    if (!redraw && chartRef.current && data.datasets) {
      setDatasets(chartRef.current.config.data, data.datasets, datasetIdKey);
    }
  }, [
    redraw,
    data.datasets
  ]);
  reactExports.useEffect(() => {
    if (!chartRef.current)
      return;
    if (redraw) {
      destroyChart();
      setTimeout(renderChart);
    } else {
      chartRef.current.update(updateMode);
    }
  }, [
    redraw,
    options,
    data.labels,
    data.datasets,
    updateMode
  ]);
  reactExports.useEffect(() => {
    if (!chartRef.current)
      return;
    destroyChart();
    setTimeout(renderChart);
  }, [
    type
  ]);
  reactExports.useEffect(() => {
    renderChart();
    return () => destroyChart();
  }, []);
  return /* @__PURE__ */ React.createElement("canvas", Object.assign({
    ref: canvasRef,
    role: "img",
    height,
    width
  }, canvasProps), fallbackContent);
}
const Chart = /* @__PURE__ */ reactExports.forwardRef(ChartComponent);
function createTypedChart(type, registerables2) {
  Chart$1.register(registerables2);
  return /* @__PURE__ */ reactExports.forwardRef((props, ref) => /* @__PURE__ */ React.createElement(Chart, Object.assign({}, props, {
    ref,
    type
  })));
}
const Line = /* @__PURE__ */ createTypedChart("line", LineController);
//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var hookCallback;
function hooks() {
  return hookCallback.apply(null, arguments);
}
function setHookCallback(callback2) {
  hookCallback = callback2;
}
function isArray(input) {
  return input instanceof Array || Object.prototype.toString.call(input) === "[object Array]";
}
function isObject(input) {
  return input != null && Object.prototype.toString.call(input) === "[object Object]";
}
function hasOwnProp(a, b) {
  return Object.prototype.hasOwnProperty.call(a, b);
}
function isObjectEmpty(obj) {
  if (Object.getOwnPropertyNames) {
    return Object.getOwnPropertyNames(obj).length === 0;
  } else {
    var k2;
    for (k2 in obj) {
      if (hasOwnProp(obj, k2)) {
        return false;
      }
    }
    return true;
  }
}
function isUndefined(input) {
  return input === void 0;
}
function isNumber(input) {
  return typeof input === "number" || Object.prototype.toString.call(input) === "[object Number]";
}
function isDate(input) {
  return input instanceof Date || Object.prototype.toString.call(input) === "[object Date]";
}
function map(arr, fn) {
  var res = [], i, arrLen = arr.length;
  for (i = 0; i < arrLen; ++i) {
    res.push(fn(arr[i], i));
  }
  return res;
}
function extend(a, b) {
  for (var i in b) {
    if (hasOwnProp(b, i)) {
      a[i] = b[i];
    }
  }
  if (hasOwnProp(b, "toString")) {
    a.toString = b.toString;
  }
  if (hasOwnProp(b, "valueOf")) {
    a.valueOf = b.valueOf;
  }
  return a;
}
function createUTC(input, format2, locale2, strict) {
  return createLocalOrUTC(input, format2, locale2, strict, true).utc();
}
function defaultParsingFlags() {
  return {
    empty: false,
    unusedTokens: [],
    unusedInput: [],
    overflow: -2,
    charsLeftOver: 0,
    nullInput: false,
    invalidEra: null,
    invalidMonth: null,
    invalidFormat: false,
    userInvalidated: false,
    iso: false,
    parsedDateParts: [],
    era: null,
    meridiem: null,
    rfc2822: false,
    weekdayMismatch: false
  };
}
function getParsingFlags(m2) {
  if (m2._pf == null) {
    m2._pf = defaultParsingFlags();
  }
  return m2._pf;
}
var some;
if (Array.prototype.some) {
  some = Array.prototype.some;
} else {
  some = function(fun) {
    var t2 = Object(this), len = t2.length >>> 0, i;
    for (i = 0; i < len; i++) {
      if (i in t2 && fun.call(this, t2[i], i, t2)) {
        return true;
      }
    }
    return false;
  };
}
function isValid(m2) {
  if (m2._isValid == null) {
    var flags = getParsingFlags(m2), parsedParts = some.call(flags.parsedDateParts, function(i) {
      return i != null;
    }), isNowValid = !isNaN(m2._d.getTime()) && flags.overflow < 0 && !flags.empty && !flags.invalidEra && !flags.invalidMonth && !flags.invalidWeekday && !flags.weekdayMismatch && !flags.nullInput && !flags.invalidFormat && !flags.userInvalidated && (!flags.meridiem || flags.meridiem && parsedParts);
    if (m2._strict) {
      isNowValid = isNowValid && flags.charsLeftOver === 0 && flags.unusedTokens.length === 0 && flags.bigHour === void 0;
    }
    if (Object.isFrozen == null || !Object.isFrozen(m2)) {
      m2._isValid = isNowValid;
    } else {
      return isNowValid;
    }
  }
  return m2._isValid;
}
function createInvalid(flags) {
  var m2 = createUTC(NaN);
  if (flags != null) {
    extend(getParsingFlags(m2), flags);
  } else {
    getParsingFlags(m2).userInvalidated = true;
  }
  return m2;
}
var momentProperties = hooks.momentProperties = [], updateInProgress = false;
function copyConfig(to2, from2) {
  var i, prop, val, momentPropertiesLen = momentProperties.length;
  if (!isUndefined(from2._isAMomentObject)) {
    to2._isAMomentObject = from2._isAMomentObject;
  }
  if (!isUndefined(from2._i)) {
    to2._i = from2._i;
  }
  if (!isUndefined(from2._f)) {
    to2._f = from2._f;
  }
  if (!isUndefined(from2._l)) {
    to2._l = from2._l;
  }
  if (!isUndefined(from2._strict)) {
    to2._strict = from2._strict;
  }
  if (!isUndefined(from2._tzm)) {
    to2._tzm = from2._tzm;
  }
  if (!isUndefined(from2._isUTC)) {
    to2._isUTC = from2._isUTC;
  }
  if (!isUndefined(from2._offset)) {
    to2._offset = from2._offset;
  }
  if (!isUndefined(from2._pf)) {
    to2._pf = getParsingFlags(from2);
  }
  if (!isUndefined(from2._locale)) {
    to2._locale = from2._locale;
  }
  if (momentPropertiesLen > 0) {
    for (i = 0; i < momentPropertiesLen; i++) {
      prop = momentProperties[i];
      val = from2[prop];
      if (!isUndefined(val)) {
        to2[prop] = val;
      }
    }
  }
  return to2;
}
function Moment(config) {
  copyConfig(this, config);
  this._d = new Date(config._d != null ? config._d.getTime() : NaN);
  if (!this.isValid()) {
    this._d = /* @__PURE__ */ new Date(NaN);
  }
  if (updateInProgress === false) {
    updateInProgress = true;
    hooks.updateOffset(this);
    updateInProgress = false;
  }
}
function isMoment(obj) {
  return obj instanceof Moment || obj != null && obj._isAMomentObject != null;
}
function warn(msg) {
  if (hooks.suppressDeprecationWarnings === false && typeof console !== "undefined" && console.warn) {
    console.warn("Deprecation warning: " + msg);
  }
}
function deprecate(msg, fn) {
  var firstTime = true;
  return extend(function() {
    if (hooks.deprecationHandler != null) {
      hooks.deprecationHandler(null, msg);
    }
    if (firstTime) {
      var args = [], arg, i, key, argLen = arguments.length;
      for (i = 0; i < argLen; i++) {
        arg = "";
        if (typeof arguments[i] === "object") {
          arg += "\n[" + i + "] ";
          for (key in arguments[0]) {
            if (hasOwnProp(arguments[0], key)) {
              arg += key + ": " + arguments[0][key] + ", ";
            }
          }
          arg = arg.slice(0, -2);
        } else {
          arg = arguments[i];
        }
        args.push(arg);
      }
      warn(
        msg + "\nArguments: " + Array.prototype.slice.call(args).join("") + "\n" + new Error().stack
      );
      firstTime = false;
    }
    return fn.apply(this, arguments);
  }, fn);
}
var deprecations = {};
function deprecateSimple(name, msg) {
  if (hooks.deprecationHandler != null) {
    hooks.deprecationHandler(name, msg);
  }
  if (!deprecations[name]) {
    warn(msg);
    deprecations[name] = true;
  }
}
hooks.suppressDeprecationWarnings = false;
hooks.deprecationHandler = null;
function isFunction(input) {
  return typeof Function !== "undefined" && input instanceof Function || Object.prototype.toString.call(input) === "[object Function]";
}
function set(config) {
  var prop, i;
  for (i in config) {
    if (hasOwnProp(config, i)) {
      prop = config[i];
      if (isFunction(prop)) {
        this[i] = prop;
      } else {
        this["_" + i] = prop;
      }
    }
  }
  this._config = config;
  this._dayOfMonthOrdinalParseLenient = new RegExp(
    (this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) + "|" + /\d{1,2}/.source
  );
}
function mergeConfigs(parentConfig, childConfig) {
  var res = extend({}, parentConfig), prop;
  for (prop in childConfig) {
    if (hasOwnProp(childConfig, prop)) {
      if (isObject(parentConfig[prop]) && isObject(childConfig[prop])) {
        res[prop] = {};
        extend(res[prop], parentConfig[prop]);
        extend(res[prop], childConfig[prop]);
      } else if (childConfig[prop] != null) {
        res[prop] = childConfig[prop];
      } else {
        delete res[prop];
      }
    }
  }
  for (prop in parentConfig) {
    if (hasOwnProp(parentConfig, prop) && !hasOwnProp(childConfig, prop) && isObject(parentConfig[prop])) {
      res[prop] = extend({}, res[prop]);
    }
  }
  return res;
}
function Locale(config) {
  if (config != null) {
    this.set(config);
  }
}
var keys;
if (Object.keys) {
  keys = Object.keys;
} else {
  keys = function(obj) {
    var i, res = [];
    for (i in obj) {
      if (hasOwnProp(obj, i)) {
        res.push(i);
      }
    }
    return res;
  };
}
var defaultCalendar = {
  sameDay: "[Today at] LT",
  nextDay: "[Tomorrow at] LT",
  nextWeek: "dddd [at] LT",
  lastDay: "[Yesterday at] LT",
  lastWeek: "[Last] dddd [at] LT",
  sameElse: "L"
};
function calendar(key, mom, now2) {
  var output = this._calendar[key] || this._calendar["sameElse"];
  return isFunction(output) ? output.call(mom, now2) : output;
}
function zeroFill(number, targetLength, forceSign) {
  var absNumber = "" + Math.abs(number), zerosToFill = targetLength - absNumber.length, sign2 = number >= 0;
  return (sign2 ? forceSign ? "+" : "" : "-") + Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;
}
var formattingTokens = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g, localFormattingTokens = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g, formatFunctions = {}, formatTokenFunctions = {};
function addFormatToken(token2, padded, ordinal2, callback2) {
  var func = callback2;
  if (typeof callback2 === "string") {
    func = function() {
      return this[callback2]();
    };
  }
  if (token2) {
    formatTokenFunctions[token2] = func;
  }
  if (padded) {
    formatTokenFunctions[padded[0]] = function() {
      return zeroFill(func.apply(this, arguments), padded[1], padded[2]);
    };
  }
  if (ordinal2) {
    formatTokenFunctions[ordinal2] = function() {
      return this.localeData().ordinal(
        func.apply(this, arguments),
        token2
      );
    };
  }
}
function removeFormattingTokens(input) {
  if (input.match(/\[[\s\S]/)) {
    return input.replace(/^\[|\]$/g, "");
  }
  return input.replace(/\\/g, "");
}
function makeFormatFunction(format2) {
  var array = format2.match(formattingTokens), i, length;
  for (i = 0, length = array.length; i < length; i++) {
    if (formatTokenFunctions[array[i]]) {
      array[i] = formatTokenFunctions[array[i]];
    } else {
      array[i] = removeFormattingTokens(array[i]);
    }
  }
  return function(mom) {
    var output = "", i2;
    for (i2 = 0; i2 < length; i2++) {
      output += isFunction(array[i2]) ? array[i2].call(mom, format2) : array[i2];
    }
    return output;
  };
}
function formatMoment(m2, format2) {
  if (!m2.isValid()) {
    return m2.localeData().invalidDate();
  }
  format2 = expandFormat(format2, m2.localeData());
  formatFunctions[format2] = formatFunctions[format2] || makeFormatFunction(format2);
  return formatFunctions[format2](m2);
}
function expandFormat(format2, locale2) {
  var i = 5;
  function replaceLongDateFormatTokens(input) {
    return locale2.longDateFormat(input) || input;
  }
  localFormattingTokens.lastIndex = 0;
  while (i >= 0 && localFormattingTokens.test(format2)) {
    format2 = format2.replace(
      localFormattingTokens,
      replaceLongDateFormatTokens
    );
    localFormattingTokens.lastIndex = 0;
    i -= 1;
  }
  return format2;
}
var defaultLongDateFormat = {
  LTS: "h:mm:ss A",
  LT: "h:mm A",
  L: "MM/DD/YYYY",
  LL: "MMMM D, YYYY",
  LLL: "MMMM D, YYYY h:mm A",
  LLLL: "dddd, MMMM D, YYYY h:mm A"
};
function longDateFormat(key) {
  var format2 = this._longDateFormat[key], formatUpper = this._longDateFormat[key.toUpperCase()];
  if (format2 || !formatUpper) {
    return format2;
  }
  this._longDateFormat[key] = formatUpper.match(formattingTokens).map(function(tok) {
    if (tok === "MMMM" || tok === "MM" || tok === "DD" || tok === "dddd") {
      return tok.slice(1);
    }
    return tok;
  }).join("");
  return this._longDateFormat[key];
}
var defaultInvalidDate = "Invalid date";
function invalidDate() {
  return this._invalidDate;
}
var defaultOrdinal = "%d", defaultDayOfMonthOrdinalParse = /\d{1,2}/;
function ordinal(number) {
  return this._ordinal.replace("%d", number);
}
var defaultRelativeTime = {
  future: "in %s",
  past: "%s ago",
  s: "a few seconds",
  ss: "%d seconds",
  m: "a minute",
  mm: "%d minutes",
  h: "an hour",
  hh: "%d hours",
  d: "a day",
  dd: "%d days",
  w: "a week",
  ww: "%d weeks",
  M: "a month",
  MM: "%d months",
  y: "a year",
  yy: "%d years"
};
function relativeTime(number, withoutSuffix, string, isFuture) {
  var output = this._relativeTime[string];
  return isFunction(output) ? output(number, withoutSuffix, string, isFuture) : output.replace(/%d/i, number);
}
function pastFuture(diff2, output) {
  var format2 = this._relativeTime[diff2 > 0 ? "future" : "past"];
  return isFunction(format2) ? format2(output) : format2.replace(/%s/i, output);
}
var aliases = {};
function addUnitAlias(unit, shorthand) {
  var lowerCase = unit.toLowerCase();
  aliases[lowerCase] = aliases[lowerCase + "s"] = aliases[shorthand] = unit;
}
function normalizeUnits(units) {
  return typeof units === "string" ? aliases[units] || aliases[units.toLowerCase()] : void 0;
}
function normalizeObjectUnits(inputObject) {
  var normalizedInput = {}, normalizedProp, prop;
  for (prop in inputObject) {
    if (hasOwnProp(inputObject, prop)) {
      normalizedProp = normalizeUnits(prop);
      if (normalizedProp) {
        normalizedInput[normalizedProp] = inputObject[prop];
      }
    }
  }
  return normalizedInput;
}
var priorities = {};
function addUnitPriority(unit, priority) {
  priorities[unit] = priority;
}
function getPrioritizedUnits(unitsObj) {
  var units = [], u2;
  for (u2 in unitsObj) {
    if (hasOwnProp(unitsObj, u2)) {
      units.push({ unit: u2, priority: priorities[u2] });
    }
  }
  units.sort(function(a, b) {
    return a.priority - b.priority;
  });
  return units;
}
function isLeapYear(year) {
  return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
}
function absFloor(number) {
  if (number < 0) {
    return Math.ceil(number) || 0;
  } else {
    return Math.floor(number);
  }
}
function toInt(argumentForCoercion) {
  var coercedNumber = +argumentForCoercion, value = 0;
  if (coercedNumber !== 0 && isFinite(coercedNumber)) {
    value = absFloor(coercedNumber);
  }
  return value;
}
function makeGetSet(unit, keepTime) {
  return function(value) {
    if (value != null) {
      set$1(this, unit, value);
      hooks.updateOffset(this, keepTime);
      return this;
    } else {
      return get(this, unit);
    }
  };
}
function get(mom, unit) {
  return mom.isValid() ? mom._d["get" + (mom._isUTC ? "UTC" : "") + unit]() : NaN;
}
function set$1(mom, unit, value) {
  if (mom.isValid() && !isNaN(value)) {
    if (unit === "FullYear" && isLeapYear(mom.year()) && mom.month() === 1 && mom.date() === 29) {
      value = toInt(value);
      mom._d["set" + (mom._isUTC ? "UTC" : "") + unit](
        value,
        mom.month(),
        daysInMonth(value, mom.month())
      );
    } else {
      mom._d["set" + (mom._isUTC ? "UTC" : "") + unit](value);
    }
  }
}
function stringGet(units) {
  units = normalizeUnits(units);
  if (isFunction(this[units])) {
    return this[units]();
  }
  return this;
}
function stringSet(units, value) {
  if (typeof units === "object") {
    units = normalizeObjectUnits(units);
    var prioritized = getPrioritizedUnits(units), i, prioritizedLen = prioritized.length;
    for (i = 0; i < prioritizedLen; i++) {
      this[prioritized[i].unit](units[prioritized[i].unit]);
    }
  } else {
    units = normalizeUnits(units);
    if (isFunction(this[units])) {
      return this[units](value);
    }
  }
  return this;
}
var match1 = /\d/, match2 = /\d\d/, match3 = /\d{3}/, match4 = /\d{4}/, match6 = /[+-]?\d{6}/, match1to2 = /\d\d?/, match3to4 = /\d\d\d\d?/, match5to6 = /\d\d\d\d\d\d?/, match1to3 = /\d{1,3}/, match1to4 = /\d{1,4}/, match1to6 = /[+-]?\d{1,6}/, matchUnsigned = /\d+/, matchSigned = /[+-]?\d+/, matchOffset = /Z|[+-]\d\d:?\d\d/gi, matchShortOffset = /Z|[+-]\d\d(?::?\d\d)?/gi, matchTimestamp = /[+-]?\d+(\.\d{1,3})?/, matchWord = /[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i, regexes;
regexes = {};
function addRegexToken(token2, regex, strictRegex) {
  regexes[token2] = isFunction(regex) ? regex : function(isStrict, localeData2) {
    return isStrict && strictRegex ? strictRegex : regex;
  };
}
function getParseRegexForToken(token2, config) {
  if (!hasOwnProp(regexes, token2)) {
    return new RegExp(unescapeFormat(token2));
  }
  return regexes[token2](config._strict, config._locale);
}
function unescapeFormat(s2) {
  return regexEscape(
    s2.replace("\\", "").replace(
      /\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,
      function(matched, p1, p2, p3, p4) {
        return p1 || p2 || p3 || p4;
      }
    )
  );
}
function regexEscape(s2) {
  return s2.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&");
}
var tokens = {};
function addParseToken(token2, callback2) {
  var i, func = callback2, tokenLen;
  if (typeof token2 === "string") {
    token2 = [token2];
  }
  if (isNumber(callback2)) {
    func = function(input, array) {
      array[callback2] = toInt(input);
    };
  }
  tokenLen = token2.length;
  for (i = 0; i < tokenLen; i++) {
    tokens[token2[i]] = func;
  }
}
function addWeekParseToken(token2, callback2) {
  addParseToken(token2, function(input, array, config, token3) {
    config._w = config._w || {};
    callback2(input, config._w, config, token3);
  });
}
function addTimeToArrayFromToken(token2, input, config) {
  if (input != null && hasOwnProp(tokens, token2)) {
    tokens[token2](input, config._a, config, token2);
  }
}
var YEAR = 0, MONTH = 1, DATE = 2, HOUR = 3, MINUTE = 4, SECOND = 5, MILLISECOND = 6, WEEK = 7, WEEKDAY = 8;
function mod(n2, x2) {
  return (n2 % x2 + x2) % x2;
}
var indexOf;
if (Array.prototype.indexOf) {
  indexOf = Array.prototype.indexOf;
} else {
  indexOf = function(o) {
    var i;
    for (i = 0; i < this.length; ++i) {
      if (this[i] === o) {
        return i;
      }
    }
    return -1;
  };
}
function daysInMonth(year, month) {
  if (isNaN(year) || isNaN(month)) {
    return NaN;
  }
  var modMonth = mod(month, 12);
  year += (month - modMonth) / 12;
  return modMonth === 1 ? isLeapYear(year) ? 29 : 28 : 31 - modMonth % 7 % 2;
}
addFormatToken("M", ["MM", 2], "Mo", function() {
  return this.month() + 1;
});
addFormatToken("MMM", 0, 0, function(format2) {
  return this.localeData().monthsShort(this, format2);
});
addFormatToken("MMMM", 0, 0, function(format2) {
  return this.localeData().months(this, format2);
});
addUnitAlias("month", "M");
addUnitPriority("month", 8);
addRegexToken("M", match1to2);
addRegexToken("MM", match1to2, match2);
addRegexToken("MMM", function(isStrict, locale2) {
  return locale2.monthsShortRegex(isStrict);
});
addRegexToken("MMMM", function(isStrict, locale2) {
  return locale2.monthsRegex(isStrict);
});
addParseToken(["M", "MM"], function(input, array) {
  array[MONTH] = toInt(input) - 1;
});
addParseToken(["MMM", "MMMM"], function(input, array, config, token2) {
  var month = config._locale.monthsParse(input, token2, config._strict);
  if (month != null) {
    array[MONTH] = month;
  } else {
    getParsingFlags(config).invalidMonth = input;
  }
});
var defaultLocaleMonths = "January_February_March_April_May_June_July_August_September_October_November_December".split(
  "_"
), defaultLocaleMonthsShort = "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), MONTHS_IN_FORMAT = /D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/, defaultMonthsShortRegex = matchWord, defaultMonthsRegex = matchWord;
function localeMonths(m2, format2) {
  if (!m2) {
    return isArray(this._months) ? this._months : this._months["standalone"];
  }
  return isArray(this._months) ? this._months[m2.month()] : this._months[(this._months.isFormat || MONTHS_IN_FORMAT).test(format2) ? "format" : "standalone"][m2.month()];
}
function localeMonthsShort(m2, format2) {
  if (!m2) {
    return isArray(this._monthsShort) ? this._monthsShort : this._monthsShort["standalone"];
  }
  return isArray(this._monthsShort) ? this._monthsShort[m2.month()] : this._monthsShort[MONTHS_IN_FORMAT.test(format2) ? "format" : "standalone"][m2.month()];
}
function handleStrictParse(monthName, format2, strict) {
  var i, ii2, mom, llc = monthName.toLocaleLowerCase();
  if (!this._monthsParse) {
    this._monthsParse = [];
    this._longMonthsParse = [];
    this._shortMonthsParse = [];
    for (i = 0; i < 12; ++i) {
      mom = createUTC([2e3, i]);
      this._shortMonthsParse[i] = this.monthsShort(
        mom,
        ""
      ).toLocaleLowerCase();
      this._longMonthsParse[i] = this.months(mom, "").toLocaleLowerCase();
    }
  }
  if (strict) {
    if (format2 === "MMM") {
      ii2 = indexOf.call(this._shortMonthsParse, llc);
      return ii2 !== -1 ? ii2 : null;
    } else {
      ii2 = indexOf.call(this._longMonthsParse, llc);
      return ii2 !== -1 ? ii2 : null;
    }
  } else {
    if (format2 === "MMM") {
      ii2 = indexOf.call(this._shortMonthsParse, llc);
      if (ii2 !== -1) {
        return ii2;
      }
      ii2 = indexOf.call(this._longMonthsParse, llc);
      return ii2 !== -1 ? ii2 : null;
    } else {
      ii2 = indexOf.call(this._longMonthsParse, llc);
      if (ii2 !== -1) {
        return ii2;
      }
      ii2 = indexOf.call(this._shortMonthsParse, llc);
      return ii2 !== -1 ? ii2 : null;
    }
  }
}
function localeMonthsParse(monthName, format2, strict) {
  var i, mom, regex;
  if (this._monthsParseExact) {
    return handleStrictParse.call(this, monthName, format2, strict);
  }
  if (!this._monthsParse) {
    this._monthsParse = [];
    this._longMonthsParse = [];
    this._shortMonthsParse = [];
  }
  for (i = 0; i < 12; i++) {
    mom = createUTC([2e3, i]);
    if (strict && !this._longMonthsParse[i]) {
      this._longMonthsParse[i] = new RegExp(
        "^" + this.months(mom, "").replace(".", "") + "$",
        "i"
      );
      this._shortMonthsParse[i] = new RegExp(
        "^" + this.monthsShort(mom, "").replace(".", "") + "$",
        "i"
      );
    }
    if (!strict && !this._monthsParse[i]) {
      regex = "^" + this.months(mom, "") + "|^" + this.monthsShort(mom, "");
      this._monthsParse[i] = new RegExp(regex.replace(".", ""), "i");
    }
    if (strict && format2 === "MMMM" && this._longMonthsParse[i].test(monthName)) {
      return i;
    } else if (strict && format2 === "MMM" && this._shortMonthsParse[i].test(monthName)) {
      return i;
    } else if (!strict && this._monthsParse[i].test(monthName)) {
      return i;
    }
  }
}
function setMonth(mom, value) {
  var dayOfMonth;
  if (!mom.isValid()) {
    return mom;
  }
  if (typeof value === "string") {
    if (/^\d+$/.test(value)) {
      value = toInt(value);
    } else {
      value = mom.localeData().monthsParse(value);
      if (!isNumber(value)) {
        return mom;
      }
    }
  }
  dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));
  mom._d["set" + (mom._isUTC ? "UTC" : "") + "Month"](value, dayOfMonth);
  return mom;
}
function getSetMonth(value) {
  if (value != null) {
    setMonth(this, value);
    hooks.updateOffset(this, true);
    return this;
  } else {
    return get(this, "Month");
  }
}
function getDaysInMonth() {
  return daysInMonth(this.year(), this.month());
}
function monthsShortRegex(isStrict) {
  if (this._monthsParseExact) {
    if (!hasOwnProp(this, "_monthsRegex")) {
      computeMonthsParse.call(this);
    }
    if (isStrict) {
      return this._monthsShortStrictRegex;
    } else {
      return this._monthsShortRegex;
    }
  } else {
    if (!hasOwnProp(this, "_monthsShortRegex")) {
      this._monthsShortRegex = defaultMonthsShortRegex;
    }
    return this._monthsShortStrictRegex && isStrict ? this._monthsShortStrictRegex : this._monthsShortRegex;
  }
}
function monthsRegex(isStrict) {
  if (this._monthsParseExact) {
    if (!hasOwnProp(this, "_monthsRegex")) {
      computeMonthsParse.call(this);
    }
    if (isStrict) {
      return this._monthsStrictRegex;
    } else {
      return this._monthsRegex;
    }
  } else {
    if (!hasOwnProp(this, "_monthsRegex")) {
      this._monthsRegex = defaultMonthsRegex;
    }
    return this._monthsStrictRegex && isStrict ? this._monthsStrictRegex : this._monthsRegex;
  }
}
function computeMonthsParse() {
  function cmpLenRev(a, b) {
    return b.length - a.length;
  }
  var shortPieces = [], longPieces = [], mixedPieces = [], i, mom;
  for (i = 0; i < 12; i++) {
    mom = createUTC([2e3, i]);
    shortPieces.push(this.monthsShort(mom, ""));
    longPieces.push(this.months(mom, ""));
    mixedPieces.push(this.months(mom, ""));
    mixedPieces.push(this.monthsShort(mom, ""));
  }
  shortPieces.sort(cmpLenRev);
  longPieces.sort(cmpLenRev);
  mixedPieces.sort(cmpLenRev);
  for (i = 0; i < 12; i++) {
    shortPieces[i] = regexEscape(shortPieces[i]);
    longPieces[i] = regexEscape(longPieces[i]);
  }
  for (i = 0; i < 24; i++) {
    mixedPieces[i] = regexEscape(mixedPieces[i]);
  }
  this._monthsRegex = new RegExp("^(" + mixedPieces.join("|") + ")", "i");
  this._monthsShortRegex = this._monthsRegex;
  this._monthsStrictRegex = new RegExp(
    "^(" + longPieces.join("|") + ")",
    "i"
  );
  this._monthsShortStrictRegex = new RegExp(
    "^(" + shortPieces.join("|") + ")",
    "i"
  );
}
addFormatToken("Y", 0, 0, function() {
  var y2 = this.year();
  return y2 <= 9999 ? zeroFill(y2, 4) : "+" + y2;
});
addFormatToken(0, ["YY", 2], 0, function() {
  return this.year() % 100;
});
addFormatToken(0, ["YYYY", 4], 0, "year");
addFormatToken(0, ["YYYYY", 5], 0, "year");
addFormatToken(0, ["YYYYYY", 6, true], 0, "year");
addUnitAlias("year", "y");
addUnitPriority("year", 1);
addRegexToken("Y", matchSigned);
addRegexToken("YY", match1to2, match2);
addRegexToken("YYYY", match1to4, match4);
addRegexToken("YYYYY", match1to6, match6);
addRegexToken("YYYYYY", match1to6, match6);
addParseToken(["YYYYY", "YYYYYY"], YEAR);
addParseToken("YYYY", function(input, array) {
  array[YEAR] = input.length === 2 ? hooks.parseTwoDigitYear(input) : toInt(input);
});
addParseToken("YY", function(input, array) {
  array[YEAR] = hooks.parseTwoDigitYear(input);
});
addParseToken("Y", function(input, array) {
  array[YEAR] = parseInt(input, 10);
});
function daysInYear(year) {
  return isLeapYear(year) ? 366 : 365;
}
hooks.parseTwoDigitYear = function(input) {
  return toInt(input) + (toInt(input) > 68 ? 1900 : 2e3);
};
var getSetYear = makeGetSet("FullYear", true);
function getIsLeapYear() {
  return isLeapYear(this.year());
}
function createDate(y2, m2, d, h, M2, s2, ms) {
  var date;
  if (y2 < 100 && y2 >= 0) {
    date = new Date(y2 + 400, m2, d, h, M2, s2, ms);
    if (isFinite(date.getFullYear())) {
      date.setFullYear(y2);
    }
  } else {
    date = new Date(y2, m2, d, h, M2, s2, ms);
  }
  return date;
}
function createUTCDate(y2) {
  var date, args;
  if (y2 < 100 && y2 >= 0) {
    args = Array.prototype.slice.call(arguments);
    args[0] = y2 + 400;
    date = new Date(Date.UTC.apply(null, args));
    if (isFinite(date.getUTCFullYear())) {
      date.setUTCFullYear(y2);
    }
  } else {
    date = new Date(Date.UTC.apply(null, arguments));
  }
  return date;
}
function firstWeekOffset(year, dow, doy) {
  var fwd = 7 + dow - doy, fwdlw = (7 + createUTCDate(year, 0, fwd).getUTCDay() - dow) % 7;
  return -fwdlw + fwd - 1;
}
function dayOfYearFromWeeks(year, week, weekday, dow, doy) {
  var localWeekday = (7 + weekday - dow) % 7, weekOffset = firstWeekOffset(year, dow, doy), dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset, resYear, resDayOfYear;
  if (dayOfYear <= 0) {
    resYear = year - 1;
    resDayOfYear = daysInYear(resYear) + dayOfYear;
  } else if (dayOfYear > daysInYear(year)) {
    resYear = year + 1;
    resDayOfYear = dayOfYear - daysInYear(year);
  } else {
    resYear = year;
    resDayOfYear = dayOfYear;
  }
  return {
    year: resYear,
    dayOfYear: resDayOfYear
  };
}
function weekOfYear(mom, dow, doy) {
  var weekOffset = firstWeekOffset(mom.year(), dow, doy), week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1, resWeek, resYear;
  if (week < 1) {
    resYear = mom.year() - 1;
    resWeek = week + weeksInYear(resYear, dow, doy);
  } else if (week > weeksInYear(mom.year(), dow, doy)) {
    resWeek = week - weeksInYear(mom.year(), dow, doy);
    resYear = mom.year() + 1;
  } else {
    resYear = mom.year();
    resWeek = week;
  }
  return {
    week: resWeek,
    year: resYear
  };
}
function weeksInYear(year, dow, doy) {
  var weekOffset = firstWeekOffset(year, dow, doy), weekOffsetNext = firstWeekOffset(year + 1, dow, doy);
  return (daysInYear(year) - weekOffset + weekOffsetNext) / 7;
}
addFormatToken("w", ["ww", 2], "wo", "week");
addFormatToken("W", ["WW", 2], "Wo", "isoWeek");
addUnitAlias("week", "w");
addUnitAlias("isoWeek", "W");
addUnitPriority("week", 5);
addUnitPriority("isoWeek", 5);
addRegexToken("w", match1to2);
addRegexToken("ww", match1to2, match2);
addRegexToken("W", match1to2);
addRegexToken("WW", match1to2, match2);
addWeekParseToken(
  ["w", "ww", "W", "WW"],
  function(input, week, config, token2) {
    week[token2.substr(0, 1)] = toInt(input);
  }
);
function localeWeek(mom) {
  return weekOfYear(mom, this._week.dow, this._week.doy).week;
}
var defaultLocaleWeek = {
  dow: 0,
  // Sunday is the first day of the week.
  doy: 6
  // The week that contains Jan 6th is the first week of the year.
};
function localeFirstDayOfWeek() {
  return this._week.dow;
}
function localeFirstDayOfYear() {
  return this._week.doy;
}
function getSetWeek(input) {
  var week = this.localeData().week(this);
  return input == null ? week : this.add((input - week) * 7, "d");
}
function getSetISOWeek(input) {
  var week = weekOfYear(this, 1, 4).week;
  return input == null ? week : this.add((input - week) * 7, "d");
}
addFormatToken("d", 0, "do", "day");
addFormatToken("dd", 0, 0, function(format2) {
  return this.localeData().weekdaysMin(this, format2);
});
addFormatToken("ddd", 0, 0, function(format2) {
  return this.localeData().weekdaysShort(this, format2);
});
addFormatToken("dddd", 0, 0, function(format2) {
  return this.localeData().weekdays(this, format2);
});
addFormatToken("e", 0, 0, "weekday");
addFormatToken("E", 0, 0, "isoWeekday");
addUnitAlias("day", "d");
addUnitAlias("weekday", "e");
addUnitAlias("isoWeekday", "E");
addUnitPriority("day", 11);
addUnitPriority("weekday", 11);
addUnitPriority("isoWeekday", 11);
addRegexToken("d", match1to2);
addRegexToken("e", match1to2);
addRegexToken("E", match1to2);
addRegexToken("dd", function(isStrict, locale2) {
  return locale2.weekdaysMinRegex(isStrict);
});
addRegexToken("ddd", function(isStrict, locale2) {
  return locale2.weekdaysShortRegex(isStrict);
});
addRegexToken("dddd", function(isStrict, locale2) {
  return locale2.weekdaysRegex(isStrict);
});
addWeekParseToken(["dd", "ddd", "dddd"], function(input, week, config, token2) {
  var weekday = config._locale.weekdaysParse(input, token2, config._strict);
  if (weekday != null) {
    week.d = weekday;
  } else {
    getParsingFlags(config).invalidWeekday = input;
  }
});
addWeekParseToken(["d", "e", "E"], function(input, week, config, token2) {
  week[token2] = toInt(input);
});
function parseWeekday(input, locale2) {
  if (typeof input !== "string") {
    return input;
  }
  if (!isNaN(input)) {
    return parseInt(input, 10);
  }
  input = locale2.weekdaysParse(input);
  if (typeof input === "number") {
    return input;
  }
  return null;
}
function parseIsoWeekday(input, locale2) {
  if (typeof input === "string") {
    return locale2.weekdaysParse(input) % 7 || 7;
  }
  return isNaN(input) ? null : input;
}
function shiftWeekdays(ws, n2) {
  return ws.slice(n2, 7).concat(ws.slice(0, n2));
}
var defaultLocaleWeekdays = "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), defaultLocaleWeekdaysShort = "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), defaultLocaleWeekdaysMin = "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), defaultWeekdaysRegex = matchWord, defaultWeekdaysShortRegex = matchWord, defaultWeekdaysMinRegex = matchWord;
function localeWeekdays(m2, format2) {
  var weekdays = isArray(this._weekdays) ? this._weekdays : this._weekdays[m2 && m2 !== true && this._weekdays.isFormat.test(format2) ? "format" : "standalone"];
  return m2 === true ? shiftWeekdays(weekdays, this._week.dow) : m2 ? weekdays[m2.day()] : weekdays;
}
function localeWeekdaysShort(m2) {
  return m2 === true ? shiftWeekdays(this._weekdaysShort, this._week.dow) : m2 ? this._weekdaysShort[m2.day()] : this._weekdaysShort;
}
function localeWeekdaysMin(m2) {
  return m2 === true ? shiftWeekdays(this._weekdaysMin, this._week.dow) : m2 ? this._weekdaysMin[m2.day()] : this._weekdaysMin;
}
function handleStrictParse$1(weekdayName, format2, strict) {
  var i, ii2, mom, llc = weekdayName.toLocaleLowerCase();
  if (!this._weekdaysParse) {
    this._weekdaysParse = [];
    this._shortWeekdaysParse = [];
    this._minWeekdaysParse = [];
    for (i = 0; i < 7; ++i) {
      mom = createUTC([2e3, 1]).day(i);
      this._minWeekdaysParse[i] = this.weekdaysMin(
        mom,
        ""
      ).toLocaleLowerCase();
      this._shortWeekdaysParse[i] = this.weekdaysShort(
        mom,
        ""
      ).toLocaleLowerCase();
      this._weekdaysParse[i] = this.weekdays(mom, "").toLocaleLowerCase();
    }
  }
  if (strict) {
    if (format2 === "dddd") {
      ii2 = indexOf.call(this._weekdaysParse, llc);
      return ii2 !== -1 ? ii2 : null;
    } else if (format2 === "ddd") {
      ii2 = indexOf.call(this._shortWeekdaysParse, llc);
      return ii2 !== -1 ? ii2 : null;
    } else {
      ii2 = indexOf.call(this._minWeekdaysParse, llc);
      return ii2 !== -1 ? ii2 : null;
    }
  } else {
    if (format2 === "dddd") {
      ii2 = indexOf.call(this._weekdaysParse, llc);
      if (ii2 !== -1) {
        return ii2;
      }
      ii2 = indexOf.call(this._shortWeekdaysParse, llc);
      if (ii2 !== -1) {
        return ii2;
      }
      ii2 = indexOf.call(this._minWeekdaysParse, llc);
      return ii2 !== -1 ? ii2 : null;
    } else if (format2 === "ddd") {
      ii2 = indexOf.call(this._shortWeekdaysParse, llc);
      if (ii2 !== -1) {
        return ii2;
      }
      ii2 = indexOf.call(this._weekdaysParse, llc);
      if (ii2 !== -1) {
        return ii2;
      }
      ii2 = indexOf.call(this._minWeekdaysParse, llc);
      return ii2 !== -1 ? ii2 : null;
    } else {
      ii2 = indexOf.call(this._minWeekdaysParse, llc);
      if (ii2 !== -1) {
        return ii2;
      }
      ii2 = indexOf.call(this._weekdaysParse, llc);
      if (ii2 !== -1) {
        return ii2;
      }
      ii2 = indexOf.call(this._shortWeekdaysParse, llc);
      return ii2 !== -1 ? ii2 : null;
    }
  }
}
function localeWeekdaysParse(weekdayName, format2, strict) {
  var i, mom, regex;
  if (this._weekdaysParseExact) {
    return handleStrictParse$1.call(this, weekdayName, format2, strict);
  }
  if (!this._weekdaysParse) {
    this._weekdaysParse = [];
    this._minWeekdaysParse = [];
    this._shortWeekdaysParse = [];
    this._fullWeekdaysParse = [];
  }
  for (i = 0; i < 7; i++) {
    mom = createUTC([2e3, 1]).day(i);
    if (strict && !this._fullWeekdaysParse[i]) {
      this._fullWeekdaysParse[i] = new RegExp(
        "^" + this.weekdays(mom, "").replace(".", "\\.?") + "$",
        "i"
      );
      this._shortWeekdaysParse[i] = new RegExp(
        "^" + this.weekdaysShort(mom, "").replace(".", "\\.?") + "$",
        "i"
      );
      this._minWeekdaysParse[i] = new RegExp(
        "^" + this.weekdaysMin(mom, "").replace(".", "\\.?") + "$",
        "i"
      );
    }
    if (!this._weekdaysParse[i]) {
      regex = "^" + this.weekdays(mom, "") + "|^" + this.weekdaysShort(mom, "") + "|^" + this.weekdaysMin(mom, "");
      this._weekdaysParse[i] = new RegExp(regex.replace(".", ""), "i");
    }
    if (strict && format2 === "dddd" && this._fullWeekdaysParse[i].test(weekdayName)) {
      return i;
    } else if (strict && format2 === "ddd" && this._shortWeekdaysParse[i].test(weekdayName)) {
      return i;
    } else if (strict && format2 === "dd" && this._minWeekdaysParse[i].test(weekdayName)) {
      return i;
    } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {
      return i;
    }
  }
}
function getSetDayOfWeek(input) {
  if (!this.isValid()) {
    return input != null ? this : NaN;
  }
  var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
  if (input != null) {
    input = parseWeekday(input, this.localeData());
    return this.add(input - day, "d");
  } else {
    return day;
  }
}
function getSetLocaleDayOfWeek(input) {
  if (!this.isValid()) {
    return input != null ? this : NaN;
  }
  var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;
  return input == null ? weekday : this.add(input - weekday, "d");
}
function getSetISODayOfWeek(input) {
  if (!this.isValid()) {
    return input != null ? this : NaN;
  }
  if (input != null) {
    var weekday = parseIsoWeekday(input, this.localeData());
    return this.day(this.day() % 7 ? weekday : weekday - 7);
  } else {
    return this.day() || 7;
  }
}
function weekdaysRegex(isStrict) {
  if (this._weekdaysParseExact) {
    if (!hasOwnProp(this, "_weekdaysRegex")) {
      computeWeekdaysParse.call(this);
    }
    if (isStrict) {
      return this._weekdaysStrictRegex;
    } else {
      return this._weekdaysRegex;
    }
  } else {
    if (!hasOwnProp(this, "_weekdaysRegex")) {
      this._weekdaysRegex = defaultWeekdaysRegex;
    }
    return this._weekdaysStrictRegex && isStrict ? this._weekdaysStrictRegex : this._weekdaysRegex;
  }
}
function weekdaysShortRegex(isStrict) {
  if (this._weekdaysParseExact) {
    if (!hasOwnProp(this, "_weekdaysRegex")) {
      computeWeekdaysParse.call(this);
    }
    if (isStrict) {
      return this._weekdaysShortStrictRegex;
    } else {
      return this._weekdaysShortRegex;
    }
  } else {
    if (!hasOwnProp(this, "_weekdaysShortRegex")) {
      this._weekdaysShortRegex = defaultWeekdaysShortRegex;
    }
    return this._weekdaysShortStrictRegex && isStrict ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex;
  }
}
function weekdaysMinRegex(isStrict) {
  if (this._weekdaysParseExact) {
    if (!hasOwnProp(this, "_weekdaysRegex")) {
      computeWeekdaysParse.call(this);
    }
    if (isStrict) {
      return this._weekdaysMinStrictRegex;
    } else {
      return this._weekdaysMinRegex;
    }
  } else {
    if (!hasOwnProp(this, "_weekdaysMinRegex")) {
      this._weekdaysMinRegex = defaultWeekdaysMinRegex;
    }
    return this._weekdaysMinStrictRegex && isStrict ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex;
  }
}
function computeWeekdaysParse() {
  function cmpLenRev(a, b) {
    return b.length - a.length;
  }
  var minPieces = [], shortPieces = [], longPieces = [], mixedPieces = [], i, mom, minp, shortp, longp;
  for (i = 0; i < 7; i++) {
    mom = createUTC([2e3, 1]).day(i);
    minp = regexEscape(this.weekdaysMin(mom, ""));
    shortp = regexEscape(this.weekdaysShort(mom, ""));
    longp = regexEscape(this.weekdays(mom, ""));
    minPieces.push(minp);
    shortPieces.push(shortp);
    longPieces.push(longp);
    mixedPieces.push(minp);
    mixedPieces.push(shortp);
    mixedPieces.push(longp);
  }
  minPieces.sort(cmpLenRev);
  shortPieces.sort(cmpLenRev);
  longPieces.sort(cmpLenRev);
  mixedPieces.sort(cmpLenRev);
  this._weekdaysRegex = new RegExp("^(" + mixedPieces.join("|") + ")", "i");
  this._weekdaysShortRegex = this._weekdaysRegex;
  this._weekdaysMinRegex = this._weekdaysRegex;
  this._weekdaysStrictRegex = new RegExp(
    "^(" + longPieces.join("|") + ")",
    "i"
  );
  this._weekdaysShortStrictRegex = new RegExp(
    "^(" + shortPieces.join("|") + ")",
    "i"
  );
  this._weekdaysMinStrictRegex = new RegExp(
    "^(" + minPieces.join("|") + ")",
    "i"
  );
}
function hFormat() {
  return this.hours() % 12 || 12;
}
function kFormat() {
  return this.hours() || 24;
}
addFormatToken("H", ["HH", 2], 0, "hour");
addFormatToken("h", ["hh", 2], 0, hFormat);
addFormatToken("k", ["kk", 2], 0, kFormat);
addFormatToken("hmm", 0, 0, function() {
  return "" + hFormat.apply(this) + zeroFill(this.minutes(), 2);
});
addFormatToken("hmmss", 0, 0, function() {
  return "" + hFormat.apply(this) + zeroFill(this.minutes(), 2) + zeroFill(this.seconds(), 2);
});
addFormatToken("Hmm", 0, 0, function() {
  return "" + this.hours() + zeroFill(this.minutes(), 2);
});
addFormatToken("Hmmss", 0, 0, function() {
  return "" + this.hours() + zeroFill(this.minutes(), 2) + zeroFill(this.seconds(), 2);
});
function meridiem(token2, lowercase) {
  addFormatToken(token2, 0, 0, function() {
    return this.localeData().meridiem(
      this.hours(),
      this.minutes(),
      lowercase
    );
  });
}
meridiem("a", true);
meridiem("A", false);
addUnitAlias("hour", "h");
addUnitPriority("hour", 13);
function matchMeridiem(isStrict, locale2) {
  return locale2._meridiemParse;
}
addRegexToken("a", matchMeridiem);
addRegexToken("A", matchMeridiem);
addRegexToken("H", match1to2);
addRegexToken("h", match1to2);
addRegexToken("k", match1to2);
addRegexToken("HH", match1to2, match2);
addRegexToken("hh", match1to2, match2);
addRegexToken("kk", match1to2, match2);
addRegexToken("hmm", match3to4);
addRegexToken("hmmss", match5to6);
addRegexToken("Hmm", match3to4);
addRegexToken("Hmmss", match5to6);
addParseToken(["H", "HH"], HOUR);
addParseToken(["k", "kk"], function(input, array, config) {
  var kInput = toInt(input);
  array[HOUR] = kInput === 24 ? 0 : kInput;
});
addParseToken(["a", "A"], function(input, array, config) {
  config._isPm = config._locale.isPM(input);
  config._meridiem = input;
});
addParseToken(["h", "hh"], function(input, array, config) {
  array[HOUR] = toInt(input);
  getParsingFlags(config).bigHour = true;
});
addParseToken("hmm", function(input, array, config) {
  var pos = input.length - 2;
  array[HOUR] = toInt(input.substr(0, pos));
  array[MINUTE] = toInt(input.substr(pos));
  getParsingFlags(config).bigHour = true;
});
addParseToken("hmmss", function(input, array, config) {
  var pos1 = input.length - 4, pos2 = input.length - 2;
  array[HOUR] = toInt(input.substr(0, pos1));
  array[MINUTE] = toInt(input.substr(pos1, 2));
  array[SECOND] = toInt(input.substr(pos2));
  getParsingFlags(config).bigHour = true;
});
addParseToken("Hmm", function(input, array, config) {
  var pos = input.length - 2;
  array[HOUR] = toInt(input.substr(0, pos));
  array[MINUTE] = toInt(input.substr(pos));
});
addParseToken("Hmmss", function(input, array, config) {
  var pos1 = input.length - 4, pos2 = input.length - 2;
  array[HOUR] = toInt(input.substr(0, pos1));
  array[MINUTE] = toInt(input.substr(pos1, 2));
  array[SECOND] = toInt(input.substr(pos2));
});
function localeIsPM(input) {
  return (input + "").toLowerCase().charAt(0) === "p";
}
var defaultLocaleMeridiemParse = /[ap]\.?m?\.?/i, getSetHour = makeGetSet("Hours", true);
function localeMeridiem(hours2, minutes2, isLower) {
  if (hours2 > 11) {
    return isLower ? "pm" : "PM";
  } else {
    return isLower ? "am" : "AM";
  }
}
var baseConfig = {
  calendar: defaultCalendar,
  longDateFormat: defaultLongDateFormat,
  invalidDate: defaultInvalidDate,
  ordinal: defaultOrdinal,
  dayOfMonthOrdinalParse: defaultDayOfMonthOrdinalParse,
  relativeTime: defaultRelativeTime,
  months: defaultLocaleMonths,
  monthsShort: defaultLocaleMonthsShort,
  week: defaultLocaleWeek,
  weekdays: defaultLocaleWeekdays,
  weekdaysMin: defaultLocaleWeekdaysMin,
  weekdaysShort: defaultLocaleWeekdaysShort,
  meridiemParse: defaultLocaleMeridiemParse
};
var locales = {}, localeFamilies = {}, globalLocale;
function commonPrefix(arr1, arr2) {
  var i, minl = Math.min(arr1.length, arr2.length);
  for (i = 0; i < minl; i += 1) {
    if (arr1[i] !== arr2[i]) {
      return i;
    }
  }
  return minl;
}
function normalizeLocale(key) {
  return key ? key.toLowerCase().replace("_", "-") : key;
}
function chooseLocale(names2) {
  var i = 0, j, next, locale2, split;
  while (i < names2.length) {
    split = normalizeLocale(names2[i]).split("-");
    j = split.length;
    next = normalizeLocale(names2[i + 1]);
    next = next ? next.split("-") : null;
    while (j > 0) {
      locale2 = loadLocale(split.slice(0, j).join("-"));
      if (locale2) {
        return locale2;
      }
      if (next && next.length >= j && commonPrefix(split, next) >= j - 1) {
        break;
      }
      j--;
    }
    i++;
  }
  return globalLocale;
}
function isLocaleNameSane(name) {
  return name.match("^[^/\\\\]*$") != null;
}
function loadLocale(name) {
  var oldLocale = null, aliasedRequire;
  if (locales[name] === void 0 && typeof module !== "undefined" && module && module.exports && isLocaleNameSane(name)) {
    try {
      oldLocale = globalLocale._abbr;
      aliasedRequire = require;
      aliasedRequire("./locale/" + name);
      getSetGlobalLocale(oldLocale);
    } catch (e) {
      locales[name] = null;
    }
  }
  return locales[name];
}
function getSetGlobalLocale(key, values2) {
  var data;
  if (key) {
    if (isUndefined(values2)) {
      data = getLocale(key);
    } else {
      data = defineLocale(key, values2);
    }
    if (data) {
      globalLocale = data;
    } else {
      if (typeof console !== "undefined" && console.warn) {
        console.warn(
          "Locale " + key + " not found. Did you forget to load it?"
        );
      }
    }
  }
  return globalLocale._abbr;
}
function defineLocale(name, config) {
  if (config !== null) {
    var locale2, parentConfig = baseConfig;
    config.abbr = name;
    if (locales[name] != null) {
      deprecateSimple(
        "defineLocaleOverride",
        "use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."
      );
      parentConfig = locales[name]._config;
    } else if (config.parentLocale != null) {
      if (locales[config.parentLocale] != null) {
        parentConfig = locales[config.parentLocale]._config;
      } else {
        locale2 = loadLocale(config.parentLocale);
        if (locale2 != null) {
          parentConfig = locale2._config;
        } else {
          if (!localeFamilies[config.parentLocale]) {
            localeFamilies[config.parentLocale] = [];
          }
          localeFamilies[config.parentLocale].push({
            name,
            config
          });
          return null;
        }
      }
    }
    locales[name] = new Locale(mergeConfigs(parentConfig, config));
    if (localeFamilies[name]) {
      localeFamilies[name].forEach(function(x2) {
        defineLocale(x2.name, x2.config);
      });
    }
    getSetGlobalLocale(name);
    return locales[name];
  } else {
    delete locales[name];
    return null;
  }
}
function updateLocale(name, config) {
  if (config != null) {
    var locale2, tmpLocale, parentConfig = baseConfig;
    if (locales[name] != null && locales[name].parentLocale != null) {
      locales[name].set(mergeConfigs(locales[name]._config, config));
    } else {
      tmpLocale = loadLocale(name);
      if (tmpLocale != null) {
        parentConfig = tmpLocale._config;
      }
      config = mergeConfigs(parentConfig, config);
      if (tmpLocale == null) {
        config.abbr = name;
      }
      locale2 = new Locale(config);
      locale2.parentLocale = locales[name];
      locales[name] = locale2;
    }
    getSetGlobalLocale(name);
  } else {
    if (locales[name] != null) {
      if (locales[name].parentLocale != null) {
        locales[name] = locales[name].parentLocale;
        if (name === getSetGlobalLocale()) {
          getSetGlobalLocale(name);
        }
      } else if (locales[name] != null) {
        delete locales[name];
      }
    }
  }
  return locales[name];
}
function getLocale(key) {
  var locale2;
  if (key && key._locale && key._locale._abbr) {
    key = key._locale._abbr;
  }
  if (!key) {
    return globalLocale;
  }
  if (!isArray(key)) {
    locale2 = loadLocale(key);
    if (locale2) {
      return locale2;
    }
    key = [key];
  }
  return chooseLocale(key);
}
function listLocales() {
  return keys(locales);
}
function checkOverflow(m2) {
  var overflow, a = m2._a;
  if (a && getParsingFlags(m2).overflow === -2) {
    overflow = a[MONTH] < 0 || a[MONTH] > 11 ? MONTH : a[DATE] < 1 || a[DATE] > daysInMonth(a[YEAR], a[MONTH]) ? DATE : a[HOUR] < 0 || a[HOUR] > 24 || a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0) ? HOUR : a[MINUTE] < 0 || a[MINUTE] > 59 ? MINUTE : a[SECOND] < 0 || a[SECOND] > 59 ? SECOND : a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND : -1;
    if (getParsingFlags(m2)._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {
      overflow = DATE;
    }
    if (getParsingFlags(m2)._overflowWeeks && overflow === -1) {
      overflow = WEEK;
    }
    if (getParsingFlags(m2)._overflowWeekday && overflow === -1) {
      overflow = WEEKDAY;
    }
    getParsingFlags(m2).overflow = overflow;
  }
  return m2;
}
var extendedIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/, basicIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/, tzRegex = /Z|[+-]\d\d(?::?\d\d)?/, isoDates = [
  ["YYYYYY-MM-DD", /[+-]\d{6}-\d\d-\d\d/],
  ["YYYY-MM-DD", /\d{4}-\d\d-\d\d/],
  ["GGGG-[W]WW-E", /\d{4}-W\d\d-\d/],
  ["GGGG-[W]WW", /\d{4}-W\d\d/, false],
  ["YYYY-DDD", /\d{4}-\d{3}/],
  ["YYYY-MM", /\d{4}-\d\d/, false],
  ["YYYYYYMMDD", /[+-]\d{10}/],
  ["YYYYMMDD", /\d{8}/],
  ["GGGG[W]WWE", /\d{4}W\d{3}/],
  ["GGGG[W]WW", /\d{4}W\d{2}/, false],
  ["YYYYDDD", /\d{7}/],
  ["YYYYMM", /\d{6}/, false],
  ["YYYY", /\d{4}/, false]
], isoTimes = [
  ["HH:mm:ss.SSSS", /\d\d:\d\d:\d\d\.\d+/],
  ["HH:mm:ss,SSSS", /\d\d:\d\d:\d\d,\d+/],
  ["HH:mm:ss", /\d\d:\d\d:\d\d/],
  ["HH:mm", /\d\d:\d\d/],
  ["HHmmss.SSSS", /\d\d\d\d\d\d\.\d+/],
  ["HHmmss,SSSS", /\d\d\d\d\d\d,\d+/],
  ["HHmmss", /\d\d\d\d\d\d/],
  ["HHmm", /\d\d\d\d/],
  ["HH", /\d\d/]
], aspNetJsonRegex = /^\/?Date\((-?\d+)/i, rfc2822 = /^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/, obsOffsets = {
  UT: 0,
  GMT: 0,
  EDT: -4 * 60,
  EST: -5 * 60,
  CDT: -5 * 60,
  CST: -6 * 60,
  MDT: -6 * 60,
  MST: -7 * 60,
  PDT: -7 * 60,
  PST: -8 * 60
};
function configFromISO(config) {
  var i, l2, string = config._i, match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string), allowTime, dateFormat, timeFormat, tzFormat, isoDatesLen = isoDates.length, isoTimesLen = isoTimes.length;
  if (match) {
    getParsingFlags(config).iso = true;
    for (i = 0, l2 = isoDatesLen; i < l2; i++) {
      if (isoDates[i][1].exec(match[1])) {
        dateFormat = isoDates[i][0];
        allowTime = isoDates[i][2] !== false;
        break;
      }
    }
    if (dateFormat == null) {
      config._isValid = false;
      return;
    }
    if (match[3]) {
      for (i = 0, l2 = isoTimesLen; i < l2; i++) {
        if (isoTimes[i][1].exec(match[3])) {
          timeFormat = (match[2] || " ") + isoTimes[i][0];
          break;
        }
      }
      if (timeFormat == null) {
        config._isValid = false;
        return;
      }
    }
    if (!allowTime && timeFormat != null) {
      config._isValid = false;
      return;
    }
    if (match[4]) {
      if (tzRegex.exec(match[4])) {
        tzFormat = "Z";
      } else {
        config._isValid = false;
        return;
      }
    }
    config._f = dateFormat + (timeFormat || "") + (tzFormat || "");
    configFromStringAndFormat(config);
  } else {
    config._isValid = false;
  }
}
function extractFromRFC2822Strings(yearStr, monthStr, dayStr, hourStr, minuteStr, secondStr) {
  var result = [
    untruncateYear(yearStr),
    defaultLocaleMonthsShort.indexOf(monthStr),
    parseInt(dayStr, 10),
    parseInt(hourStr, 10),
    parseInt(minuteStr, 10)
  ];
  if (secondStr) {
    result.push(parseInt(secondStr, 10));
  }
  return result;
}
function untruncateYear(yearStr) {
  var year = parseInt(yearStr, 10);
  if (year <= 49) {
    return 2e3 + year;
  } else if (year <= 999) {
    return 1900 + year;
  }
  return year;
}
function preprocessRFC2822(s2) {
  return s2.replace(/\([^()]*\)|[\n\t]/g, " ").replace(/(\s\s+)/g, " ").replace(/^\s\s*/, "").replace(/\s\s*$/, "");
}
function checkWeekday(weekdayStr, parsedInput, config) {
  if (weekdayStr) {
    var weekdayProvided = defaultLocaleWeekdaysShort.indexOf(weekdayStr), weekdayActual = new Date(
      parsedInput[0],
      parsedInput[1],
      parsedInput[2]
    ).getDay();
    if (weekdayProvided !== weekdayActual) {
      getParsingFlags(config).weekdayMismatch = true;
      config._isValid = false;
      return false;
    }
  }
  return true;
}
function calculateOffset(obsOffset, militaryOffset, numOffset) {
  if (obsOffset) {
    return obsOffsets[obsOffset];
  } else if (militaryOffset) {
    return 0;
  } else {
    var hm = parseInt(numOffset, 10), m2 = hm % 100, h = (hm - m2) / 100;
    return h * 60 + m2;
  }
}
function configFromRFC2822(config) {
  var match = rfc2822.exec(preprocessRFC2822(config._i)), parsedArray;
  if (match) {
    parsedArray = extractFromRFC2822Strings(
      match[4],
      match[3],
      match[2],
      match[5],
      match[6],
      match[7]
    );
    if (!checkWeekday(match[1], parsedArray, config)) {
      return;
    }
    config._a = parsedArray;
    config._tzm = calculateOffset(match[8], match[9], match[10]);
    config._d = createUTCDate.apply(null, config._a);
    config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
    getParsingFlags(config).rfc2822 = true;
  } else {
    config._isValid = false;
  }
}
function configFromString(config) {
  var matched = aspNetJsonRegex.exec(config._i);
  if (matched !== null) {
    config._d = /* @__PURE__ */ new Date(+matched[1]);
    return;
  }
  configFromISO(config);
  if (config._isValid === false) {
    delete config._isValid;
  } else {
    return;
  }
  configFromRFC2822(config);
  if (config._isValid === false) {
    delete config._isValid;
  } else {
    return;
  }
  if (config._strict) {
    config._isValid = false;
  } else {
    hooks.createFromInputFallback(config);
  }
}
hooks.createFromInputFallback = deprecate(
  "value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",
  function(config) {
    config._d = /* @__PURE__ */ new Date(config._i + (config._useUTC ? " UTC" : ""));
  }
);
function defaults(a, b, c) {
  if (a != null) {
    return a;
  }
  if (b != null) {
    return b;
  }
  return c;
}
function currentDateArray(config) {
  var nowValue = new Date(hooks.now());
  if (config._useUTC) {
    return [
      nowValue.getUTCFullYear(),
      nowValue.getUTCMonth(),
      nowValue.getUTCDate()
    ];
  }
  return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];
}
function configFromArray(config) {
  var i, date, input = [], currentDate, expectedWeekday, yearToUse;
  if (config._d) {
    return;
  }
  currentDate = currentDateArray(config);
  if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {
    dayOfYearFromWeekInfo(config);
  }
  if (config._dayOfYear != null) {
    yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);
    if (config._dayOfYear > daysInYear(yearToUse) || config._dayOfYear === 0) {
      getParsingFlags(config)._overflowDayOfYear = true;
    }
    date = createUTCDate(yearToUse, 0, config._dayOfYear);
    config._a[MONTH] = date.getUTCMonth();
    config._a[DATE] = date.getUTCDate();
  }
  for (i = 0; i < 3 && config._a[i] == null; ++i) {
    config._a[i] = input[i] = currentDate[i];
  }
  for (; i < 7; i++) {
    config._a[i] = input[i] = config._a[i] == null ? i === 2 ? 1 : 0 : config._a[i];
  }
  if (config._a[HOUR] === 24 && config._a[MINUTE] === 0 && config._a[SECOND] === 0 && config._a[MILLISECOND] === 0) {
    config._nextDay = true;
    config._a[HOUR] = 0;
  }
  config._d = (config._useUTC ? createUTCDate : createDate).apply(
    null,
    input
  );
  expectedWeekday = config._useUTC ? config._d.getUTCDay() : config._d.getDay();
  if (config._tzm != null) {
    config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
  }
  if (config._nextDay) {
    config._a[HOUR] = 24;
  }
  if (config._w && typeof config._w.d !== "undefined" && config._w.d !== expectedWeekday) {
    getParsingFlags(config).weekdayMismatch = true;
  }
}
function dayOfYearFromWeekInfo(config) {
  var w2, weekYear, week, weekday, dow, doy, temp, weekdayOverflow, curWeek;
  w2 = config._w;
  if (w2.GG != null || w2.W != null || w2.E != null) {
    dow = 1;
    doy = 4;
    weekYear = defaults(
      w2.GG,
      config._a[YEAR],
      weekOfYear(createLocal(), 1, 4).year
    );
    week = defaults(w2.W, 1);
    weekday = defaults(w2.E, 1);
    if (weekday < 1 || weekday > 7) {
      weekdayOverflow = true;
    }
  } else {
    dow = config._locale._week.dow;
    doy = config._locale._week.doy;
    curWeek = weekOfYear(createLocal(), dow, doy);
    weekYear = defaults(w2.gg, config._a[YEAR], curWeek.year);
    week = defaults(w2.w, curWeek.week);
    if (w2.d != null) {
      weekday = w2.d;
      if (weekday < 0 || weekday > 6) {
        weekdayOverflow = true;
      }
    } else if (w2.e != null) {
      weekday = w2.e + dow;
      if (w2.e < 0 || w2.e > 6) {
        weekdayOverflow = true;
      }
    } else {
      weekday = dow;
    }
  }
  if (week < 1 || week > weeksInYear(weekYear, dow, doy)) {
    getParsingFlags(config)._overflowWeeks = true;
  } else if (weekdayOverflow != null) {
    getParsingFlags(config)._overflowWeekday = true;
  } else {
    temp = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy);
    config._a[YEAR] = temp.year;
    config._dayOfYear = temp.dayOfYear;
  }
}
hooks.ISO_8601 = function() {
};
hooks.RFC_2822 = function() {
};
function configFromStringAndFormat(config) {
  if (config._f === hooks.ISO_8601) {
    configFromISO(config);
    return;
  }
  if (config._f === hooks.RFC_2822) {
    configFromRFC2822(config);
    return;
  }
  config._a = [];
  getParsingFlags(config).empty = true;
  var string = "" + config._i, i, parsedInput, tokens2, token2, skipped, stringLength = string.length, totalParsedInputLength = 0, era, tokenLen;
  tokens2 = expandFormat(config._f, config._locale).match(formattingTokens) || [];
  tokenLen = tokens2.length;
  for (i = 0; i < tokenLen; i++) {
    token2 = tokens2[i];
    parsedInput = (string.match(getParseRegexForToken(token2, config)) || [])[0];
    if (parsedInput) {
      skipped = string.substr(0, string.indexOf(parsedInput));
      if (skipped.length > 0) {
        getParsingFlags(config).unusedInput.push(skipped);
      }
      string = string.slice(
        string.indexOf(parsedInput) + parsedInput.length
      );
      totalParsedInputLength += parsedInput.length;
    }
    if (formatTokenFunctions[token2]) {
      if (parsedInput) {
        getParsingFlags(config).empty = false;
      } else {
        getParsingFlags(config).unusedTokens.push(token2);
      }
      addTimeToArrayFromToken(token2, parsedInput, config);
    } else if (config._strict && !parsedInput) {
      getParsingFlags(config).unusedTokens.push(token2);
    }
  }
  getParsingFlags(config).charsLeftOver = stringLength - totalParsedInputLength;
  if (string.length > 0) {
    getParsingFlags(config).unusedInput.push(string);
  }
  if (config._a[HOUR] <= 12 && getParsingFlags(config).bigHour === true && config._a[HOUR] > 0) {
    getParsingFlags(config).bigHour = void 0;
  }
  getParsingFlags(config).parsedDateParts = config._a.slice(0);
  getParsingFlags(config).meridiem = config._meridiem;
  config._a[HOUR] = meridiemFixWrap(
    config._locale,
    config._a[HOUR],
    config._meridiem
  );
  era = getParsingFlags(config).era;
  if (era !== null) {
    config._a[YEAR] = config._locale.erasConvertYear(era, config._a[YEAR]);
  }
  configFromArray(config);
  checkOverflow(config);
}
function meridiemFixWrap(locale2, hour, meridiem2) {
  var isPm;
  if (meridiem2 == null) {
    return hour;
  }
  if (locale2.meridiemHour != null) {
    return locale2.meridiemHour(hour, meridiem2);
  } else if (locale2.isPM != null) {
    isPm = locale2.isPM(meridiem2);
    if (isPm && hour < 12) {
      hour += 12;
    }
    if (!isPm && hour === 12) {
      hour = 0;
    }
    return hour;
  } else {
    return hour;
  }
}
function configFromStringAndArray(config) {
  var tempConfig, bestMoment, scoreToBeat, i, currentScore, validFormatFound, bestFormatIsValid = false, configfLen = config._f.length;
  if (configfLen === 0) {
    getParsingFlags(config).invalidFormat = true;
    config._d = /* @__PURE__ */ new Date(NaN);
    return;
  }
  for (i = 0; i < configfLen; i++) {
    currentScore = 0;
    validFormatFound = false;
    tempConfig = copyConfig({}, config);
    if (config._useUTC != null) {
      tempConfig._useUTC = config._useUTC;
    }
    tempConfig._f = config._f[i];
    configFromStringAndFormat(tempConfig);
    if (isValid(tempConfig)) {
      validFormatFound = true;
    }
    currentScore += getParsingFlags(tempConfig).charsLeftOver;
    currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;
    getParsingFlags(tempConfig).score = currentScore;
    if (!bestFormatIsValid) {
      if (scoreToBeat == null || currentScore < scoreToBeat || validFormatFound) {
        scoreToBeat = currentScore;
        bestMoment = tempConfig;
        if (validFormatFound) {
          bestFormatIsValid = true;
        }
      }
    } else {
      if (currentScore < scoreToBeat) {
        scoreToBeat = currentScore;
        bestMoment = tempConfig;
      }
    }
  }
  extend(config, bestMoment || tempConfig);
}
function configFromObject(config) {
  if (config._d) {
    return;
  }
  var i = normalizeObjectUnits(config._i), dayOrDate = i.day === void 0 ? i.date : i.day;
  config._a = map(
    [i.year, i.month, dayOrDate, i.hour, i.minute, i.second, i.millisecond],
    function(obj) {
      return obj && parseInt(obj, 10);
    }
  );
  configFromArray(config);
}
function createFromConfig(config) {
  var res = new Moment(checkOverflow(prepareConfig(config)));
  if (res._nextDay) {
    res.add(1, "d");
    res._nextDay = void 0;
  }
  return res;
}
function prepareConfig(config) {
  var input = config._i, format2 = config._f;
  config._locale = config._locale || getLocale(config._l);
  if (input === null || format2 === void 0 && input === "") {
    return createInvalid({ nullInput: true });
  }
  if (typeof input === "string") {
    config._i = input = config._locale.preparse(input);
  }
  if (isMoment(input)) {
    return new Moment(checkOverflow(input));
  } else if (isDate(input)) {
    config._d = input;
  } else if (isArray(format2)) {
    configFromStringAndArray(config);
  } else if (format2) {
    configFromStringAndFormat(config);
  } else {
    configFromInput(config);
  }
  if (!isValid(config)) {
    config._d = null;
  }
  return config;
}
function configFromInput(config) {
  var input = config._i;
  if (isUndefined(input)) {
    config._d = new Date(hooks.now());
  } else if (isDate(input)) {
    config._d = new Date(input.valueOf());
  } else if (typeof input === "string") {
    configFromString(config);
  } else if (isArray(input)) {
    config._a = map(input.slice(0), function(obj) {
      return parseInt(obj, 10);
    });
    configFromArray(config);
  } else if (isObject(input)) {
    configFromObject(config);
  } else if (isNumber(input)) {
    config._d = new Date(input);
  } else {
    hooks.createFromInputFallback(config);
  }
}
function createLocalOrUTC(input, format2, locale2, strict, isUTC) {
  var c = {};
  if (format2 === true || format2 === false) {
    strict = format2;
    format2 = void 0;
  }
  if (locale2 === true || locale2 === false) {
    strict = locale2;
    locale2 = void 0;
  }
  if (isObject(input) && isObjectEmpty(input) || isArray(input) && input.length === 0) {
    input = void 0;
  }
  c._isAMomentObject = true;
  c._useUTC = c._isUTC = isUTC;
  c._l = locale2;
  c._i = input;
  c._f = format2;
  c._strict = strict;
  return createFromConfig(c);
}
function createLocal(input, format2, locale2, strict) {
  return createLocalOrUTC(input, format2, locale2, strict, false);
}
var prototypeMin = deprecate(
  "moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",
  function() {
    var other = createLocal.apply(null, arguments);
    if (this.isValid() && other.isValid()) {
      return other < this ? this : other;
    } else {
      return createInvalid();
    }
  }
), prototypeMax = deprecate(
  "moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",
  function() {
    var other = createLocal.apply(null, arguments);
    if (this.isValid() && other.isValid()) {
      return other > this ? this : other;
    } else {
      return createInvalid();
    }
  }
);
function pickBy(fn, moments) {
  var res, i;
  if (moments.length === 1 && isArray(moments[0])) {
    moments = moments[0];
  }
  if (!moments.length) {
    return createLocal();
  }
  res = moments[0];
  for (i = 1; i < moments.length; ++i) {
    if (!moments[i].isValid() || moments[i][fn](res)) {
      res = moments[i];
    }
  }
  return res;
}
function min() {
  var args = [].slice.call(arguments, 0);
  return pickBy("isBefore", args);
}
function max() {
  var args = [].slice.call(arguments, 0);
  return pickBy("isAfter", args);
}
var now = function() {
  return Date.now ? Date.now() : +/* @__PURE__ */ new Date();
};
var ordering = [
  "year",
  "quarter",
  "month",
  "week",
  "day",
  "hour",
  "minute",
  "second",
  "millisecond"
];
function isDurationValid(m2) {
  var key, unitHasDecimal = false, i, orderLen = ordering.length;
  for (key in m2) {
    if (hasOwnProp(m2, key) && !(indexOf.call(ordering, key) !== -1 && (m2[key] == null || !isNaN(m2[key])))) {
      return false;
    }
  }
  for (i = 0; i < orderLen; ++i) {
    if (m2[ordering[i]]) {
      if (unitHasDecimal) {
        return false;
      }
      if (parseFloat(m2[ordering[i]]) !== toInt(m2[ordering[i]])) {
        unitHasDecimal = true;
      }
    }
  }
  return true;
}
function isValid$1() {
  return this._isValid;
}
function createInvalid$1() {
  return createDuration(NaN);
}
function Duration(duration) {
  var normalizedInput = normalizeObjectUnits(duration), years2 = normalizedInput.year || 0, quarters = normalizedInput.quarter || 0, months2 = normalizedInput.month || 0, weeks2 = normalizedInput.week || normalizedInput.isoWeek || 0, days2 = normalizedInput.day || 0, hours2 = normalizedInput.hour || 0, minutes2 = normalizedInput.minute || 0, seconds2 = normalizedInput.second || 0, milliseconds2 = normalizedInput.millisecond || 0;
  this._isValid = isDurationValid(normalizedInput);
  this._milliseconds = +milliseconds2 + seconds2 * 1e3 + // 1000
  minutes2 * 6e4 + // 1000 * 60
  hours2 * 1e3 * 60 * 60;
  this._days = +days2 + weeks2 * 7;
  this._months = +months2 + quarters * 3 + years2 * 12;
  this._data = {};
  this._locale = getLocale();
  this._bubble();
}
function isDuration(obj) {
  return obj instanceof Duration;
}
function absRound(number) {
  if (number < 0) {
    return Math.round(-1 * number) * -1;
  } else {
    return Math.round(number);
  }
}
function compareArrays(array1, array2, dontConvert) {
  var len = Math.min(array1.length, array2.length), lengthDiff = Math.abs(array1.length - array2.length), diffs = 0, i;
  for (i = 0; i < len; i++) {
    if (dontConvert && array1[i] !== array2[i] || !dontConvert && toInt(array1[i]) !== toInt(array2[i])) {
      diffs++;
    }
  }
  return diffs + lengthDiff;
}
function offset(token2, separator) {
  addFormatToken(token2, 0, 0, function() {
    var offset2 = this.utcOffset(), sign2 = "+";
    if (offset2 < 0) {
      offset2 = -offset2;
      sign2 = "-";
    }
    return sign2 + zeroFill(~~(offset2 / 60), 2) + separator + zeroFill(~~offset2 % 60, 2);
  });
}
offset("Z", ":");
offset("ZZ", "");
addRegexToken("Z", matchShortOffset);
addRegexToken("ZZ", matchShortOffset);
addParseToken(["Z", "ZZ"], function(input, array, config) {
  config._useUTC = true;
  config._tzm = offsetFromString(matchShortOffset, input);
});
var chunkOffset = /([\+\-]|\d\d)/gi;
function offsetFromString(matcher, string) {
  var matches = (string || "").match(matcher), chunk, parts, minutes2;
  if (matches === null) {
    return null;
  }
  chunk = matches[matches.length - 1] || [];
  parts = (chunk + "").match(chunkOffset) || ["-", 0, 0];
  minutes2 = +(parts[1] * 60) + toInt(parts[2]);
  return minutes2 === 0 ? 0 : parts[0] === "+" ? minutes2 : -minutes2;
}
function cloneWithOffset(input, model) {
  var res, diff2;
  if (model._isUTC) {
    res = model.clone();
    diff2 = (isMoment(input) || isDate(input) ? input.valueOf() : createLocal(input).valueOf()) - res.valueOf();
    res._d.setTime(res._d.valueOf() + diff2);
    hooks.updateOffset(res, false);
    return res;
  } else {
    return createLocal(input).local();
  }
}
function getDateOffset(m2) {
  return -Math.round(m2._d.getTimezoneOffset());
}
hooks.updateOffset = function() {
};
function getSetOffset(input, keepLocalTime, keepMinutes) {
  var offset2 = this._offset || 0, localAdjust;
  if (!this.isValid()) {
    return input != null ? this : NaN;
  }
  if (input != null) {
    if (typeof input === "string") {
      input = offsetFromString(matchShortOffset, input);
      if (input === null) {
        return this;
      }
    } else if (Math.abs(input) < 16 && !keepMinutes) {
      input = input * 60;
    }
    if (!this._isUTC && keepLocalTime) {
      localAdjust = getDateOffset(this);
    }
    this._offset = input;
    this._isUTC = true;
    if (localAdjust != null) {
      this.add(localAdjust, "m");
    }
    if (offset2 !== input) {
      if (!keepLocalTime || this._changeInProgress) {
        addSubtract(
          this,
          createDuration(input - offset2, "m"),
          1,
          false
        );
      } else if (!this._changeInProgress) {
        this._changeInProgress = true;
        hooks.updateOffset(this, true);
        this._changeInProgress = null;
      }
    }
    return this;
  } else {
    return this._isUTC ? offset2 : getDateOffset(this);
  }
}
function getSetZone(input, keepLocalTime) {
  if (input != null) {
    if (typeof input !== "string") {
      input = -input;
    }
    this.utcOffset(input, keepLocalTime);
    return this;
  } else {
    return -this.utcOffset();
  }
}
function setOffsetToUTC(keepLocalTime) {
  return this.utcOffset(0, keepLocalTime);
}
function setOffsetToLocal(keepLocalTime) {
  if (this._isUTC) {
    this.utcOffset(0, keepLocalTime);
    this._isUTC = false;
    if (keepLocalTime) {
      this.subtract(getDateOffset(this), "m");
    }
  }
  return this;
}
function setOffsetToParsedOffset() {
  if (this._tzm != null) {
    this.utcOffset(this._tzm, false, true);
  } else if (typeof this._i === "string") {
    var tZone = offsetFromString(matchOffset, this._i);
    if (tZone != null) {
      this.utcOffset(tZone);
    } else {
      this.utcOffset(0, true);
    }
  }
  return this;
}
function hasAlignedHourOffset(input) {
  if (!this.isValid()) {
    return false;
  }
  input = input ? createLocal(input).utcOffset() : 0;
  return (this.utcOffset() - input) % 60 === 0;
}
function isDaylightSavingTime() {
  return this.utcOffset() > this.clone().month(0).utcOffset() || this.utcOffset() > this.clone().month(5).utcOffset();
}
function isDaylightSavingTimeShifted() {
  if (!isUndefined(this._isDSTShifted)) {
    return this._isDSTShifted;
  }
  var c = {}, other;
  copyConfig(c, this);
  c = prepareConfig(c);
  if (c._a) {
    other = c._isUTC ? createUTC(c._a) : createLocal(c._a);
    this._isDSTShifted = this.isValid() && compareArrays(c._a, other.toArray()) > 0;
  } else {
    this._isDSTShifted = false;
  }
  return this._isDSTShifted;
}
function isLocal() {
  return this.isValid() ? !this._isUTC : false;
}
function isUtcOffset() {
  return this.isValid() ? this._isUTC : false;
}
function isUtc() {
  return this.isValid() ? this._isUTC && this._offset === 0 : false;
}
var aspNetRegex = /^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/, isoRegex = /^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;
function createDuration(input, key) {
  var duration = input, match = null, sign2, ret, diffRes;
  if (isDuration(input)) {
    duration = {
      ms: input._milliseconds,
      d: input._days,
      M: input._months
    };
  } else if (isNumber(input) || !isNaN(+input)) {
    duration = {};
    if (key) {
      duration[key] = +input;
    } else {
      duration.milliseconds = +input;
    }
  } else if (match = aspNetRegex.exec(input)) {
    sign2 = match[1] === "-" ? -1 : 1;
    duration = {
      y: 0,
      d: toInt(match[DATE]) * sign2,
      h: toInt(match[HOUR]) * sign2,
      m: toInt(match[MINUTE]) * sign2,
      s: toInt(match[SECOND]) * sign2,
      ms: toInt(absRound(match[MILLISECOND] * 1e3)) * sign2
      // the millisecond decimal point is included in the match
    };
  } else if (match = isoRegex.exec(input)) {
    sign2 = match[1] === "-" ? -1 : 1;
    duration = {
      y: parseIso(match[2], sign2),
      M: parseIso(match[3], sign2),
      w: parseIso(match[4], sign2),
      d: parseIso(match[5], sign2),
      h: parseIso(match[6], sign2),
      m: parseIso(match[7], sign2),
      s: parseIso(match[8], sign2)
    };
  } else if (duration == null) {
    duration = {};
  } else if (typeof duration === "object" && ("from" in duration || "to" in duration)) {
    diffRes = momentsDifference(
      createLocal(duration.from),
      createLocal(duration.to)
    );
    duration = {};
    duration.ms = diffRes.milliseconds;
    duration.M = diffRes.months;
  }
  ret = new Duration(duration);
  if (isDuration(input) && hasOwnProp(input, "_locale")) {
    ret._locale = input._locale;
  }
  if (isDuration(input) && hasOwnProp(input, "_isValid")) {
    ret._isValid = input._isValid;
  }
  return ret;
}
createDuration.fn = Duration.prototype;
createDuration.invalid = createInvalid$1;
function parseIso(inp, sign2) {
  var res = inp && parseFloat(inp.replace(",", "."));
  return (isNaN(res) ? 0 : res) * sign2;
}
function positiveMomentsDifference(base, other) {
  var res = {};
  res.months = other.month() - base.month() + (other.year() - base.year()) * 12;
  if (base.clone().add(res.months, "M").isAfter(other)) {
    --res.months;
  }
  res.milliseconds = +other - +base.clone().add(res.months, "M");
  return res;
}
function momentsDifference(base, other) {
  var res;
  if (!(base.isValid() && other.isValid())) {
    return { milliseconds: 0, months: 0 };
  }
  other = cloneWithOffset(other, base);
  if (base.isBefore(other)) {
    res = positiveMomentsDifference(base, other);
  } else {
    res = positiveMomentsDifference(other, base);
    res.milliseconds = -res.milliseconds;
    res.months = -res.months;
  }
  return res;
}
function createAdder(direction, name) {
  return function(val, period) {
    var dur, tmp;
    if (period !== null && !isNaN(+period)) {
      deprecateSimple(
        name,
        "moment()." + name + "(period, number) is deprecated. Please use moment()." + name + "(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."
      );
      tmp = val;
      val = period;
      period = tmp;
    }
    dur = createDuration(val, period);
    addSubtract(this, dur, direction);
    return this;
  };
}
function addSubtract(mom, duration, isAdding, updateOffset) {
  var milliseconds2 = duration._milliseconds, days2 = absRound(duration._days), months2 = absRound(duration._months);
  if (!mom.isValid()) {
    return;
  }
  updateOffset = updateOffset == null ? true : updateOffset;
  if (months2) {
    setMonth(mom, get(mom, "Month") + months2 * isAdding);
  }
  if (days2) {
    set$1(mom, "Date", get(mom, "Date") + days2 * isAdding);
  }
  if (milliseconds2) {
    mom._d.setTime(mom._d.valueOf() + milliseconds2 * isAdding);
  }
  if (updateOffset) {
    hooks.updateOffset(mom, days2 || months2);
  }
}
var add = createAdder(1, "add"), subtract = createAdder(-1, "subtract");
function isString(input) {
  return typeof input === "string" || input instanceof String;
}
function isMomentInput(input) {
  return isMoment(input) || isDate(input) || isString(input) || isNumber(input) || isNumberOrStringArray(input) || isMomentInputObject(input) || input === null || input === void 0;
}
function isMomentInputObject(input) {
  var objectTest = isObject(input) && !isObjectEmpty(input), propertyTest = false, properties = [
    "years",
    "year",
    "y",
    "months",
    "month",
    "M",
    "days",
    "day",
    "d",
    "dates",
    "date",
    "D",
    "hours",
    "hour",
    "h",
    "minutes",
    "minute",
    "m",
    "seconds",
    "second",
    "s",
    "milliseconds",
    "millisecond",
    "ms"
  ], i, property, propertyLen = properties.length;
  for (i = 0; i < propertyLen; i += 1) {
    property = properties[i];
    propertyTest = propertyTest || hasOwnProp(input, property);
  }
  return objectTest && propertyTest;
}
function isNumberOrStringArray(input) {
  var arrayTest = isArray(input), dataTypeTest = false;
  if (arrayTest) {
    dataTypeTest = input.filter(function(item) {
      return !isNumber(item) && isString(input);
    }).length === 0;
  }
  return arrayTest && dataTypeTest;
}
function isCalendarSpec(input) {
  var objectTest = isObject(input) && !isObjectEmpty(input), propertyTest = false, properties = [
    "sameDay",
    "nextDay",
    "lastDay",
    "nextWeek",
    "lastWeek",
    "sameElse"
  ], i, property;
  for (i = 0; i < properties.length; i += 1) {
    property = properties[i];
    propertyTest = propertyTest || hasOwnProp(input, property);
  }
  return objectTest && propertyTest;
}
function getCalendarFormat(myMoment, now2) {
  var diff2 = myMoment.diff(now2, "days", true);
  return diff2 < -6 ? "sameElse" : diff2 < -1 ? "lastWeek" : diff2 < 0 ? "lastDay" : diff2 < 1 ? "sameDay" : diff2 < 2 ? "nextDay" : diff2 < 7 ? "nextWeek" : "sameElse";
}
function calendar$1(time, formats) {
  if (arguments.length === 1) {
    if (!arguments[0]) {
      time = void 0;
      formats = void 0;
    } else if (isMomentInput(arguments[0])) {
      time = arguments[0];
      formats = void 0;
    } else if (isCalendarSpec(arguments[0])) {
      formats = arguments[0];
      time = void 0;
    }
  }
  var now2 = time || createLocal(), sod = cloneWithOffset(now2, this).startOf("day"), format2 = hooks.calendarFormat(this, sod) || "sameElse", output = formats && (isFunction(formats[format2]) ? formats[format2].call(this, now2) : formats[format2]);
  return this.format(
    output || this.localeData().calendar(format2, this, createLocal(now2))
  );
}
function clone() {
  return new Moment(this);
}
function isAfter(input, units) {
  var localInput = isMoment(input) ? input : createLocal(input);
  if (!(this.isValid() && localInput.isValid())) {
    return false;
  }
  units = normalizeUnits(units) || "millisecond";
  if (units === "millisecond") {
    return this.valueOf() > localInput.valueOf();
  } else {
    return localInput.valueOf() < this.clone().startOf(units).valueOf();
  }
}
function isBefore(input, units) {
  var localInput = isMoment(input) ? input : createLocal(input);
  if (!(this.isValid() && localInput.isValid())) {
    return false;
  }
  units = normalizeUnits(units) || "millisecond";
  if (units === "millisecond") {
    return this.valueOf() < localInput.valueOf();
  } else {
    return this.clone().endOf(units).valueOf() < localInput.valueOf();
  }
}
function isBetween(from2, to2, units, inclusivity) {
  var localFrom = isMoment(from2) ? from2 : createLocal(from2), localTo = isMoment(to2) ? to2 : createLocal(to2);
  if (!(this.isValid() && localFrom.isValid() && localTo.isValid())) {
    return false;
  }
  inclusivity = inclusivity || "()";
  return (inclusivity[0] === "(" ? this.isAfter(localFrom, units) : !this.isBefore(localFrom, units)) && (inclusivity[1] === ")" ? this.isBefore(localTo, units) : !this.isAfter(localTo, units));
}
function isSame(input, units) {
  var localInput = isMoment(input) ? input : createLocal(input), inputMs;
  if (!(this.isValid() && localInput.isValid())) {
    return false;
  }
  units = normalizeUnits(units) || "millisecond";
  if (units === "millisecond") {
    return this.valueOf() === localInput.valueOf();
  } else {
    inputMs = localInput.valueOf();
    return this.clone().startOf(units).valueOf() <= inputMs && inputMs <= this.clone().endOf(units).valueOf();
  }
}
function isSameOrAfter(input, units) {
  return this.isSame(input, units) || this.isAfter(input, units);
}
function isSameOrBefore(input, units) {
  return this.isSame(input, units) || this.isBefore(input, units);
}
function diff(input, units, asFloat) {
  var that, zoneDelta, output;
  if (!this.isValid()) {
    return NaN;
  }
  that = cloneWithOffset(input, this);
  if (!that.isValid()) {
    return NaN;
  }
  zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;
  units = normalizeUnits(units);
  switch (units) {
    case "year":
      output = monthDiff(this, that) / 12;
      break;
    case "month":
      output = monthDiff(this, that);
      break;
    case "quarter":
      output = monthDiff(this, that) / 3;
      break;
    case "second":
      output = (this - that) / 1e3;
      break;
    case "minute":
      output = (this - that) / 6e4;
      break;
    case "hour":
      output = (this - that) / 36e5;
      break;
    case "day":
      output = (this - that - zoneDelta) / 864e5;
      break;
    case "week":
      output = (this - that - zoneDelta) / 6048e5;
      break;
    default:
      output = this - that;
  }
  return asFloat ? output : absFloor(output);
}
function monthDiff(a, b) {
  if (a.date() < b.date()) {
    return -monthDiff(b, a);
  }
  var wholeMonthDiff = (b.year() - a.year()) * 12 + (b.month() - a.month()), anchor = a.clone().add(wholeMonthDiff, "months"), anchor2, adjust;
  if (b - anchor < 0) {
    anchor2 = a.clone().add(wholeMonthDiff - 1, "months");
    adjust = (b - anchor) / (anchor - anchor2);
  } else {
    anchor2 = a.clone().add(wholeMonthDiff + 1, "months");
    adjust = (b - anchor) / (anchor2 - anchor);
  }
  return -(wholeMonthDiff + adjust) || 0;
}
hooks.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ";
hooks.defaultFormatUtc = "YYYY-MM-DDTHH:mm:ss[Z]";
function toString() {
  return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ");
}
function toISOString(keepOffset) {
  if (!this.isValid()) {
    return null;
  }
  var utc = keepOffset !== true, m2 = utc ? this.clone().utc() : this;
  if (m2.year() < 0 || m2.year() > 9999) {
    return formatMoment(
      m2,
      utc ? "YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]" : "YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"
    );
  }
  if (isFunction(Date.prototype.toISOString)) {
    if (utc) {
      return this.toDate().toISOString();
    } else {
      return new Date(this.valueOf() + this.utcOffset() * 60 * 1e3).toISOString().replace("Z", formatMoment(m2, "Z"));
    }
  }
  return formatMoment(
    m2,
    utc ? "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]" : "YYYY-MM-DD[T]HH:mm:ss.SSSZ"
  );
}
function inspect() {
  if (!this.isValid()) {
    return "moment.invalid(/* " + this._i + " */)";
  }
  var func = "moment", zone = "", prefix, year, datetime, suffix;
  if (!this.isLocal()) {
    func = this.utcOffset() === 0 ? "moment.utc" : "moment.parseZone";
    zone = "Z";
  }
  prefix = "[" + func + '("]';
  year = 0 <= this.year() && this.year() <= 9999 ? "YYYY" : "YYYYYY";
  datetime = "-MM-DD[T]HH:mm:ss.SSS";
  suffix = zone + '[")]';
  return this.format(prefix + year + datetime + suffix);
}
function format(inputString) {
  if (!inputString) {
    inputString = this.isUtc() ? hooks.defaultFormatUtc : hooks.defaultFormat;
  }
  var output = formatMoment(this, inputString);
  return this.localeData().postformat(output);
}
function from(time, withoutSuffix) {
  if (this.isValid() && (isMoment(time) && time.isValid() || createLocal(time).isValid())) {
    return createDuration({ to: this, from: time }).locale(this.locale()).humanize(!withoutSuffix);
  } else {
    return this.localeData().invalidDate();
  }
}
function fromNow(withoutSuffix) {
  return this.from(createLocal(), withoutSuffix);
}
function to(time, withoutSuffix) {
  if (this.isValid() && (isMoment(time) && time.isValid() || createLocal(time).isValid())) {
    return createDuration({ from: this, to: time }).locale(this.locale()).humanize(!withoutSuffix);
  } else {
    return this.localeData().invalidDate();
  }
}
function toNow(withoutSuffix) {
  return this.to(createLocal(), withoutSuffix);
}
function locale(key) {
  var newLocaleData;
  if (key === void 0) {
    return this._locale._abbr;
  } else {
    newLocaleData = getLocale(key);
    if (newLocaleData != null) {
      this._locale = newLocaleData;
    }
    return this;
  }
}
var lang = deprecate(
  "moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",
  function(key) {
    if (key === void 0) {
      return this.localeData();
    } else {
      return this.locale(key);
    }
  }
);
function localeData() {
  return this._locale;
}
var MS_PER_SECOND = 1e3, MS_PER_MINUTE = 60 * MS_PER_SECOND, MS_PER_HOUR = 60 * MS_PER_MINUTE, MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;
function mod$1(dividend, divisor) {
  return (dividend % divisor + divisor) % divisor;
}
function localStartOfDate(y2, m2, d) {
  if (y2 < 100 && y2 >= 0) {
    return new Date(y2 + 400, m2, d) - MS_PER_400_YEARS;
  } else {
    return new Date(y2, m2, d).valueOf();
  }
}
function utcStartOfDate(y2, m2, d) {
  if (y2 < 100 && y2 >= 0) {
    return Date.UTC(y2 + 400, m2, d) - MS_PER_400_YEARS;
  } else {
    return Date.UTC(y2, m2, d);
  }
}
function startOf(units) {
  var time, startOfDate;
  units = normalizeUnits(units);
  if (units === void 0 || units === "millisecond" || !this.isValid()) {
    return this;
  }
  startOfDate = this._isUTC ? utcStartOfDate : localStartOfDate;
  switch (units) {
    case "year":
      time = startOfDate(this.year(), 0, 1);
      break;
    case "quarter":
      time = startOfDate(
        this.year(),
        this.month() - this.month() % 3,
        1
      );
      break;
    case "month":
      time = startOfDate(this.year(), this.month(), 1);
      break;
    case "week":
      time = startOfDate(
        this.year(),
        this.month(),
        this.date() - this.weekday()
      );
      break;
    case "isoWeek":
      time = startOfDate(
        this.year(),
        this.month(),
        this.date() - (this.isoWeekday() - 1)
      );
      break;
    case "day":
    case "date":
      time = startOfDate(this.year(), this.month(), this.date());
      break;
    case "hour":
      time = this._d.valueOf();
      time -= mod$1(
        time + (this._isUTC ? 0 : this.utcOffset() * MS_PER_MINUTE),
        MS_PER_HOUR
      );
      break;
    case "minute":
      time = this._d.valueOf();
      time -= mod$1(time, MS_PER_MINUTE);
      break;
    case "second":
      time = this._d.valueOf();
      time -= mod$1(time, MS_PER_SECOND);
      break;
  }
  this._d.setTime(time);
  hooks.updateOffset(this, true);
  return this;
}
function endOf(units) {
  var time, startOfDate;
  units = normalizeUnits(units);
  if (units === void 0 || units === "millisecond" || !this.isValid()) {
    return this;
  }
  startOfDate = this._isUTC ? utcStartOfDate : localStartOfDate;
  switch (units) {
    case "year":
      time = startOfDate(this.year() + 1, 0, 1) - 1;
      break;
    case "quarter":
      time = startOfDate(
        this.year(),
        this.month() - this.month() % 3 + 3,
        1
      ) - 1;
      break;
    case "month":
      time = startOfDate(this.year(), this.month() + 1, 1) - 1;
      break;
    case "week":
      time = startOfDate(
        this.year(),
        this.month(),
        this.date() - this.weekday() + 7
      ) - 1;
      break;
    case "isoWeek":
      time = startOfDate(
        this.year(),
        this.month(),
        this.date() - (this.isoWeekday() - 1) + 7
      ) - 1;
      break;
    case "day":
    case "date":
      time = startOfDate(this.year(), this.month(), this.date() + 1) - 1;
      break;
    case "hour":
      time = this._d.valueOf();
      time += MS_PER_HOUR - mod$1(
        time + (this._isUTC ? 0 : this.utcOffset() * MS_PER_MINUTE),
        MS_PER_HOUR
      ) - 1;
      break;
    case "minute":
      time = this._d.valueOf();
      time += MS_PER_MINUTE - mod$1(time, MS_PER_MINUTE) - 1;
      break;
    case "second":
      time = this._d.valueOf();
      time += MS_PER_SECOND - mod$1(time, MS_PER_SECOND) - 1;
      break;
  }
  this._d.setTime(time);
  hooks.updateOffset(this, true);
  return this;
}
function valueOf() {
  return this._d.valueOf() - (this._offset || 0) * 6e4;
}
function unix() {
  return Math.floor(this.valueOf() / 1e3);
}
function toDate() {
  return new Date(this.valueOf());
}
function toArray() {
  var m2 = this;
  return [
    m2.year(),
    m2.month(),
    m2.date(),
    m2.hour(),
    m2.minute(),
    m2.second(),
    m2.millisecond()
  ];
}
function toObject() {
  var m2 = this;
  return {
    years: m2.year(),
    months: m2.month(),
    date: m2.date(),
    hours: m2.hours(),
    minutes: m2.minutes(),
    seconds: m2.seconds(),
    milliseconds: m2.milliseconds()
  };
}
function toJSON() {
  return this.isValid() ? this.toISOString() : null;
}
function isValid$2() {
  return isValid(this);
}
function parsingFlags() {
  return extend({}, getParsingFlags(this));
}
function invalidAt() {
  return getParsingFlags(this).overflow;
}
function creationData() {
  return {
    input: this._i,
    format: this._f,
    locale: this._locale,
    isUTC: this._isUTC,
    strict: this._strict
  };
}
addFormatToken("N", 0, 0, "eraAbbr");
addFormatToken("NN", 0, 0, "eraAbbr");
addFormatToken("NNN", 0, 0, "eraAbbr");
addFormatToken("NNNN", 0, 0, "eraName");
addFormatToken("NNNNN", 0, 0, "eraNarrow");
addFormatToken("y", ["y", 1], "yo", "eraYear");
addFormatToken("y", ["yy", 2], 0, "eraYear");
addFormatToken("y", ["yyy", 3], 0, "eraYear");
addFormatToken("y", ["yyyy", 4], 0, "eraYear");
addRegexToken("N", matchEraAbbr);
addRegexToken("NN", matchEraAbbr);
addRegexToken("NNN", matchEraAbbr);
addRegexToken("NNNN", matchEraName);
addRegexToken("NNNNN", matchEraNarrow);
addParseToken(
  ["N", "NN", "NNN", "NNNN", "NNNNN"],
  function(input, array, config, token2) {
    var era = config._locale.erasParse(input, token2, config._strict);
    if (era) {
      getParsingFlags(config).era = era;
    } else {
      getParsingFlags(config).invalidEra = input;
    }
  }
);
addRegexToken("y", matchUnsigned);
addRegexToken("yy", matchUnsigned);
addRegexToken("yyy", matchUnsigned);
addRegexToken("yyyy", matchUnsigned);
addRegexToken("yo", matchEraYearOrdinal);
addParseToken(["y", "yy", "yyy", "yyyy"], YEAR);
addParseToken(["yo"], function(input, array, config, token2) {
  var match;
  if (config._locale._eraYearOrdinalRegex) {
    match = input.match(config._locale._eraYearOrdinalRegex);
  }
  if (config._locale.eraYearOrdinalParse) {
    array[YEAR] = config._locale.eraYearOrdinalParse(input, match);
  } else {
    array[YEAR] = parseInt(input, 10);
  }
});
function localeEras(m2, format2) {
  var i, l2, date, eras = this._eras || getLocale("en")._eras;
  for (i = 0, l2 = eras.length; i < l2; ++i) {
    switch (typeof eras[i].since) {
      case "string":
        date = hooks(eras[i].since).startOf("day");
        eras[i].since = date.valueOf();
        break;
    }
    switch (typeof eras[i].until) {
      case "undefined":
        eras[i].until = Infinity;
        break;
      case "string":
        date = hooks(eras[i].until).startOf("day").valueOf();
        eras[i].until = date.valueOf();
        break;
    }
  }
  return eras;
}
function localeErasParse(eraName, format2, strict) {
  var i, l2, eras = this.eras(), name, abbr, narrow;
  eraName = eraName.toUpperCase();
  for (i = 0, l2 = eras.length; i < l2; ++i) {
    name = eras[i].name.toUpperCase();
    abbr = eras[i].abbr.toUpperCase();
    narrow = eras[i].narrow.toUpperCase();
    if (strict) {
      switch (format2) {
        case "N":
        case "NN":
        case "NNN":
          if (abbr === eraName) {
            return eras[i];
          }
          break;
        case "NNNN":
          if (name === eraName) {
            return eras[i];
          }
          break;
        case "NNNNN":
          if (narrow === eraName) {
            return eras[i];
          }
          break;
      }
    } else if ([name, abbr, narrow].indexOf(eraName) >= 0) {
      return eras[i];
    }
  }
}
function localeErasConvertYear(era, year) {
  var dir = era.since <= era.until ? 1 : -1;
  if (year === void 0) {
    return hooks(era.since).year();
  } else {
    return hooks(era.since).year() + (year - era.offset) * dir;
  }
}
function getEraName() {
  var i, l2, val, eras = this.localeData().eras();
  for (i = 0, l2 = eras.length; i < l2; ++i) {
    val = this.clone().startOf("day").valueOf();
    if (eras[i].since <= val && val <= eras[i].until) {
      return eras[i].name;
    }
    if (eras[i].until <= val && val <= eras[i].since) {
      return eras[i].name;
    }
  }
  return "";
}
function getEraNarrow() {
  var i, l2, val, eras = this.localeData().eras();
  for (i = 0, l2 = eras.length; i < l2; ++i) {
    val = this.clone().startOf("day").valueOf();
    if (eras[i].since <= val && val <= eras[i].until) {
      return eras[i].narrow;
    }
    if (eras[i].until <= val && val <= eras[i].since) {
      return eras[i].narrow;
    }
  }
  return "";
}
function getEraAbbr() {
  var i, l2, val, eras = this.localeData().eras();
  for (i = 0, l2 = eras.length; i < l2; ++i) {
    val = this.clone().startOf("day").valueOf();
    if (eras[i].since <= val && val <= eras[i].until) {
      return eras[i].abbr;
    }
    if (eras[i].until <= val && val <= eras[i].since) {
      return eras[i].abbr;
    }
  }
  return "";
}
function getEraYear() {
  var i, l2, dir, val, eras = this.localeData().eras();
  for (i = 0, l2 = eras.length; i < l2; ++i) {
    dir = eras[i].since <= eras[i].until ? 1 : -1;
    val = this.clone().startOf("day").valueOf();
    if (eras[i].since <= val && val <= eras[i].until || eras[i].until <= val && val <= eras[i].since) {
      return (this.year() - hooks(eras[i].since).year()) * dir + eras[i].offset;
    }
  }
  return this.year();
}
function erasNameRegex(isStrict) {
  if (!hasOwnProp(this, "_erasNameRegex")) {
    computeErasParse.call(this);
  }
  return isStrict ? this._erasNameRegex : this._erasRegex;
}
function erasAbbrRegex(isStrict) {
  if (!hasOwnProp(this, "_erasAbbrRegex")) {
    computeErasParse.call(this);
  }
  return isStrict ? this._erasAbbrRegex : this._erasRegex;
}
function erasNarrowRegex(isStrict) {
  if (!hasOwnProp(this, "_erasNarrowRegex")) {
    computeErasParse.call(this);
  }
  return isStrict ? this._erasNarrowRegex : this._erasRegex;
}
function matchEraAbbr(isStrict, locale2) {
  return locale2.erasAbbrRegex(isStrict);
}
function matchEraName(isStrict, locale2) {
  return locale2.erasNameRegex(isStrict);
}
function matchEraNarrow(isStrict, locale2) {
  return locale2.erasNarrowRegex(isStrict);
}
function matchEraYearOrdinal(isStrict, locale2) {
  return locale2._eraYearOrdinalRegex || matchUnsigned;
}
function computeErasParse() {
  var abbrPieces = [], namePieces = [], narrowPieces = [], mixedPieces = [], i, l2, eras = this.eras();
  for (i = 0, l2 = eras.length; i < l2; ++i) {
    namePieces.push(regexEscape(eras[i].name));
    abbrPieces.push(regexEscape(eras[i].abbr));
    narrowPieces.push(regexEscape(eras[i].narrow));
    mixedPieces.push(regexEscape(eras[i].name));
    mixedPieces.push(regexEscape(eras[i].abbr));
    mixedPieces.push(regexEscape(eras[i].narrow));
  }
  this._erasRegex = new RegExp("^(" + mixedPieces.join("|") + ")", "i");
  this._erasNameRegex = new RegExp("^(" + namePieces.join("|") + ")", "i");
  this._erasAbbrRegex = new RegExp("^(" + abbrPieces.join("|") + ")", "i");
  this._erasNarrowRegex = new RegExp(
    "^(" + narrowPieces.join("|") + ")",
    "i"
  );
}
addFormatToken(0, ["gg", 2], 0, function() {
  return this.weekYear() % 100;
});
addFormatToken(0, ["GG", 2], 0, function() {
  return this.isoWeekYear() % 100;
});
function addWeekYearFormatToken(token2, getter) {
  addFormatToken(0, [token2, token2.length], 0, getter);
}
addWeekYearFormatToken("gggg", "weekYear");
addWeekYearFormatToken("ggggg", "weekYear");
addWeekYearFormatToken("GGGG", "isoWeekYear");
addWeekYearFormatToken("GGGGG", "isoWeekYear");
addUnitAlias("weekYear", "gg");
addUnitAlias("isoWeekYear", "GG");
addUnitPriority("weekYear", 1);
addUnitPriority("isoWeekYear", 1);
addRegexToken("G", matchSigned);
addRegexToken("g", matchSigned);
addRegexToken("GG", match1to2, match2);
addRegexToken("gg", match1to2, match2);
addRegexToken("GGGG", match1to4, match4);
addRegexToken("gggg", match1to4, match4);
addRegexToken("GGGGG", match1to6, match6);
addRegexToken("ggggg", match1to6, match6);
addWeekParseToken(
  ["gggg", "ggggg", "GGGG", "GGGGG"],
  function(input, week, config, token2) {
    week[token2.substr(0, 2)] = toInt(input);
  }
);
addWeekParseToken(["gg", "GG"], function(input, week, config, token2) {
  week[token2] = hooks.parseTwoDigitYear(input);
});
function getSetWeekYear(input) {
  return getSetWeekYearHelper.call(
    this,
    input,
    this.week(),
    this.weekday(),
    this.localeData()._week.dow,
    this.localeData()._week.doy
  );
}
function getSetISOWeekYear(input) {
  return getSetWeekYearHelper.call(
    this,
    input,
    this.isoWeek(),
    this.isoWeekday(),
    1,
    4
  );
}
function getISOWeeksInYear() {
  return weeksInYear(this.year(), 1, 4);
}
function getISOWeeksInISOWeekYear() {
  return weeksInYear(this.isoWeekYear(), 1, 4);
}
function getWeeksInYear() {
  var weekInfo = this.localeData()._week;
  return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);
}
function getWeeksInWeekYear() {
  var weekInfo = this.localeData()._week;
  return weeksInYear(this.weekYear(), weekInfo.dow, weekInfo.doy);
}
function getSetWeekYearHelper(input, week, weekday, dow, doy) {
  var weeksTarget;
  if (input == null) {
    return weekOfYear(this, dow, doy).year;
  } else {
    weeksTarget = weeksInYear(input, dow, doy);
    if (week > weeksTarget) {
      week = weeksTarget;
    }
    return setWeekAll.call(this, input, week, weekday, dow, doy);
  }
}
function setWeekAll(weekYear, week, weekday, dow, doy) {
  var dayOfYearData = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy), date = createUTCDate(dayOfYearData.year, 0, dayOfYearData.dayOfYear);
  this.year(date.getUTCFullYear());
  this.month(date.getUTCMonth());
  this.date(date.getUTCDate());
  return this;
}
addFormatToken("Q", 0, "Qo", "quarter");
addUnitAlias("quarter", "Q");
addUnitPriority("quarter", 7);
addRegexToken("Q", match1);
addParseToken("Q", function(input, array) {
  array[MONTH] = (toInt(input) - 1) * 3;
});
function getSetQuarter(input) {
  return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);
}
addFormatToken("D", ["DD", 2], "Do", "date");
addUnitAlias("date", "D");
addUnitPriority("date", 9);
addRegexToken("D", match1to2);
addRegexToken("DD", match1to2, match2);
addRegexToken("Do", function(isStrict, locale2) {
  return isStrict ? locale2._dayOfMonthOrdinalParse || locale2._ordinalParse : locale2._dayOfMonthOrdinalParseLenient;
});
addParseToken(["D", "DD"], DATE);
addParseToken("Do", function(input, array) {
  array[DATE] = toInt(input.match(match1to2)[0]);
});
var getSetDayOfMonth = makeGetSet("Date", true);
addFormatToken("DDD", ["DDDD", 3], "DDDo", "dayOfYear");
addUnitAlias("dayOfYear", "DDD");
addUnitPriority("dayOfYear", 4);
addRegexToken("DDD", match1to3);
addRegexToken("DDDD", match3);
addParseToken(["DDD", "DDDD"], function(input, array, config) {
  config._dayOfYear = toInt(input);
});
function getSetDayOfYear(input) {
  var dayOfYear = Math.round(
    (this.clone().startOf("day") - this.clone().startOf("year")) / 864e5
  ) + 1;
  return input == null ? dayOfYear : this.add(input - dayOfYear, "d");
}
addFormatToken("m", ["mm", 2], 0, "minute");
addUnitAlias("minute", "m");
addUnitPriority("minute", 14);
addRegexToken("m", match1to2);
addRegexToken("mm", match1to2, match2);
addParseToken(["m", "mm"], MINUTE);
var getSetMinute = makeGetSet("Minutes", false);
addFormatToken("s", ["ss", 2], 0, "second");
addUnitAlias("second", "s");
addUnitPriority("second", 15);
addRegexToken("s", match1to2);
addRegexToken("ss", match1to2, match2);
addParseToken(["s", "ss"], SECOND);
var getSetSecond = makeGetSet("Seconds", false);
addFormatToken("S", 0, 0, function() {
  return ~~(this.millisecond() / 100);
});
addFormatToken(0, ["SS", 2], 0, function() {
  return ~~(this.millisecond() / 10);
});
addFormatToken(0, ["SSS", 3], 0, "millisecond");
addFormatToken(0, ["SSSS", 4], 0, function() {
  return this.millisecond() * 10;
});
addFormatToken(0, ["SSSSS", 5], 0, function() {
  return this.millisecond() * 100;
});
addFormatToken(0, ["SSSSSS", 6], 0, function() {
  return this.millisecond() * 1e3;
});
addFormatToken(0, ["SSSSSSS", 7], 0, function() {
  return this.millisecond() * 1e4;
});
addFormatToken(0, ["SSSSSSSS", 8], 0, function() {
  return this.millisecond() * 1e5;
});
addFormatToken(0, ["SSSSSSSSS", 9], 0, function() {
  return this.millisecond() * 1e6;
});
addUnitAlias("millisecond", "ms");
addUnitPriority("millisecond", 16);
addRegexToken("S", match1to3, match1);
addRegexToken("SS", match1to3, match2);
addRegexToken("SSS", match1to3, match3);
var token, getSetMillisecond;
for (token = "SSSS"; token.length <= 9; token += "S") {
  addRegexToken(token, matchUnsigned);
}
function parseMs(input, array) {
  array[MILLISECOND] = toInt(("0." + input) * 1e3);
}
for (token = "S"; token.length <= 9; token += "S") {
  addParseToken(token, parseMs);
}
getSetMillisecond = makeGetSet("Milliseconds", false);
addFormatToken("z", 0, 0, "zoneAbbr");
addFormatToken("zz", 0, 0, "zoneName");
function getZoneAbbr() {
  return this._isUTC ? "UTC" : "";
}
function getZoneName() {
  return this._isUTC ? "Coordinated Universal Time" : "";
}
var proto = Moment.prototype;
proto.add = add;
proto.calendar = calendar$1;
proto.clone = clone;
proto.diff = diff;
proto.endOf = endOf;
proto.format = format;
proto.from = from;
proto.fromNow = fromNow;
proto.to = to;
proto.toNow = toNow;
proto.get = stringGet;
proto.invalidAt = invalidAt;
proto.isAfter = isAfter;
proto.isBefore = isBefore;
proto.isBetween = isBetween;
proto.isSame = isSame;
proto.isSameOrAfter = isSameOrAfter;
proto.isSameOrBefore = isSameOrBefore;
proto.isValid = isValid$2;
proto.lang = lang;
proto.locale = locale;
proto.localeData = localeData;
proto.max = prototypeMax;
proto.min = prototypeMin;
proto.parsingFlags = parsingFlags;
proto.set = stringSet;
proto.startOf = startOf;
proto.subtract = subtract;
proto.toArray = toArray;
proto.toObject = toObject;
proto.toDate = toDate;
proto.toISOString = toISOString;
proto.inspect = inspect;
if (typeof Symbol !== "undefined" && Symbol.for != null) {
  proto[Symbol.for("nodejs.util.inspect.custom")] = function() {
    return "Moment<" + this.format() + ">";
  };
}
proto.toJSON = toJSON;
proto.toString = toString;
proto.unix = unix;
proto.valueOf = valueOf;
proto.creationData = creationData;
proto.eraName = getEraName;
proto.eraNarrow = getEraNarrow;
proto.eraAbbr = getEraAbbr;
proto.eraYear = getEraYear;
proto.year = getSetYear;
proto.isLeapYear = getIsLeapYear;
proto.weekYear = getSetWeekYear;
proto.isoWeekYear = getSetISOWeekYear;
proto.quarter = proto.quarters = getSetQuarter;
proto.month = getSetMonth;
proto.daysInMonth = getDaysInMonth;
proto.week = proto.weeks = getSetWeek;
proto.isoWeek = proto.isoWeeks = getSetISOWeek;
proto.weeksInYear = getWeeksInYear;
proto.weeksInWeekYear = getWeeksInWeekYear;
proto.isoWeeksInYear = getISOWeeksInYear;
proto.isoWeeksInISOWeekYear = getISOWeeksInISOWeekYear;
proto.date = getSetDayOfMonth;
proto.day = proto.days = getSetDayOfWeek;
proto.weekday = getSetLocaleDayOfWeek;
proto.isoWeekday = getSetISODayOfWeek;
proto.dayOfYear = getSetDayOfYear;
proto.hour = proto.hours = getSetHour;
proto.minute = proto.minutes = getSetMinute;
proto.second = proto.seconds = getSetSecond;
proto.millisecond = proto.milliseconds = getSetMillisecond;
proto.utcOffset = getSetOffset;
proto.utc = setOffsetToUTC;
proto.local = setOffsetToLocal;
proto.parseZone = setOffsetToParsedOffset;
proto.hasAlignedHourOffset = hasAlignedHourOffset;
proto.isDST = isDaylightSavingTime;
proto.isLocal = isLocal;
proto.isUtcOffset = isUtcOffset;
proto.isUtc = isUtc;
proto.isUTC = isUtc;
proto.zoneAbbr = getZoneAbbr;
proto.zoneName = getZoneName;
proto.dates = deprecate(
  "dates accessor is deprecated. Use date instead.",
  getSetDayOfMonth
);
proto.months = deprecate(
  "months accessor is deprecated. Use month instead",
  getSetMonth
);
proto.years = deprecate(
  "years accessor is deprecated. Use year instead",
  getSetYear
);
proto.zone = deprecate(
  "moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",
  getSetZone
);
proto.isDSTShifted = deprecate(
  "isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",
  isDaylightSavingTimeShifted
);
function createUnix(input) {
  return createLocal(input * 1e3);
}
function createInZone() {
  return createLocal.apply(null, arguments).parseZone();
}
function preParsePostFormat(string) {
  return string;
}
var proto$1 = Locale.prototype;
proto$1.calendar = calendar;
proto$1.longDateFormat = longDateFormat;
proto$1.invalidDate = invalidDate;
proto$1.ordinal = ordinal;
proto$1.preparse = preParsePostFormat;
proto$1.postformat = preParsePostFormat;
proto$1.relativeTime = relativeTime;
proto$1.pastFuture = pastFuture;
proto$1.set = set;
proto$1.eras = localeEras;
proto$1.erasParse = localeErasParse;
proto$1.erasConvertYear = localeErasConvertYear;
proto$1.erasAbbrRegex = erasAbbrRegex;
proto$1.erasNameRegex = erasNameRegex;
proto$1.erasNarrowRegex = erasNarrowRegex;
proto$1.months = localeMonths;
proto$1.monthsShort = localeMonthsShort;
proto$1.monthsParse = localeMonthsParse;
proto$1.monthsRegex = monthsRegex;
proto$1.monthsShortRegex = monthsShortRegex;
proto$1.week = localeWeek;
proto$1.firstDayOfYear = localeFirstDayOfYear;
proto$1.firstDayOfWeek = localeFirstDayOfWeek;
proto$1.weekdays = localeWeekdays;
proto$1.weekdaysMin = localeWeekdaysMin;
proto$1.weekdaysShort = localeWeekdaysShort;
proto$1.weekdaysParse = localeWeekdaysParse;
proto$1.weekdaysRegex = weekdaysRegex;
proto$1.weekdaysShortRegex = weekdaysShortRegex;
proto$1.weekdaysMinRegex = weekdaysMinRegex;
proto$1.isPM = localeIsPM;
proto$1.meridiem = localeMeridiem;
function get$1(format2, index2, field, setter) {
  var locale2 = getLocale(), utc = createUTC().set(setter, index2);
  return locale2[field](utc, format2);
}
function listMonthsImpl(format2, index2, field) {
  if (isNumber(format2)) {
    index2 = format2;
    format2 = void 0;
  }
  format2 = format2 || "";
  if (index2 != null) {
    return get$1(format2, index2, field, "month");
  }
  var i, out = [];
  for (i = 0; i < 12; i++) {
    out[i] = get$1(format2, i, field, "month");
  }
  return out;
}
function listWeekdaysImpl(localeSorted, format2, index2, field) {
  if (typeof localeSorted === "boolean") {
    if (isNumber(format2)) {
      index2 = format2;
      format2 = void 0;
    }
    format2 = format2 || "";
  } else {
    format2 = localeSorted;
    index2 = format2;
    localeSorted = false;
    if (isNumber(format2)) {
      index2 = format2;
      format2 = void 0;
    }
    format2 = format2 || "";
  }
  var locale2 = getLocale(), shift = localeSorted ? locale2._week.dow : 0, i, out = [];
  if (index2 != null) {
    return get$1(format2, (index2 + shift) % 7, field, "day");
  }
  for (i = 0; i < 7; i++) {
    out[i] = get$1(format2, (i + shift) % 7, field, "day");
  }
  return out;
}
function listMonths(format2, index2) {
  return listMonthsImpl(format2, index2, "months");
}
function listMonthsShort(format2, index2) {
  return listMonthsImpl(format2, index2, "monthsShort");
}
function listWeekdays(localeSorted, format2, index2) {
  return listWeekdaysImpl(localeSorted, format2, index2, "weekdays");
}
function listWeekdaysShort(localeSorted, format2, index2) {
  return listWeekdaysImpl(localeSorted, format2, index2, "weekdaysShort");
}
function listWeekdaysMin(localeSorted, format2, index2) {
  return listWeekdaysImpl(localeSorted, format2, index2, "weekdaysMin");
}
getSetGlobalLocale("en", {
  eras: [
    {
      since: "0001-01-01",
      until: Infinity,
      offset: 1,
      name: "Anno Domini",
      narrow: "AD",
      abbr: "AD"
    },
    {
      since: "0000-12-31",
      until: -Infinity,
      offset: 1,
      name: "Before Christ",
      narrow: "BC",
      abbr: "BC"
    }
  ],
  dayOfMonthOrdinalParse: /\d{1,2}(th|st|nd|rd)/,
  ordinal: function(number) {
    var b = number % 10, output = toInt(number % 100 / 10) === 1 ? "th" : b === 1 ? "st" : b === 2 ? "nd" : b === 3 ? "rd" : "th";
    return number + output;
  }
});
hooks.lang = deprecate(
  "moment.lang is deprecated. Use moment.locale instead.",
  getSetGlobalLocale
);
hooks.langData = deprecate(
  "moment.langData is deprecated. Use moment.localeData instead.",
  getLocale
);
var mathAbs = Math.abs;
function abs() {
  var data = this._data;
  this._milliseconds = mathAbs(this._milliseconds);
  this._days = mathAbs(this._days);
  this._months = mathAbs(this._months);
  data.milliseconds = mathAbs(data.milliseconds);
  data.seconds = mathAbs(data.seconds);
  data.minutes = mathAbs(data.minutes);
  data.hours = mathAbs(data.hours);
  data.months = mathAbs(data.months);
  data.years = mathAbs(data.years);
  return this;
}
function addSubtract$1(duration, input, value, direction) {
  var other = createDuration(input, value);
  duration._milliseconds += direction * other._milliseconds;
  duration._days += direction * other._days;
  duration._months += direction * other._months;
  return duration._bubble();
}
function add$1(input, value) {
  return addSubtract$1(this, input, value, 1);
}
function subtract$1(input, value) {
  return addSubtract$1(this, input, value, -1);
}
function absCeil(number) {
  if (number < 0) {
    return Math.floor(number);
  } else {
    return Math.ceil(number);
  }
}
function bubble() {
  var milliseconds2 = this._milliseconds, days2 = this._days, months2 = this._months, data = this._data, seconds2, minutes2, hours2, years2, monthsFromDays;
  if (!(milliseconds2 >= 0 && days2 >= 0 && months2 >= 0 || milliseconds2 <= 0 && days2 <= 0 && months2 <= 0)) {
    milliseconds2 += absCeil(monthsToDays(months2) + days2) * 864e5;
    days2 = 0;
    months2 = 0;
  }
  data.milliseconds = milliseconds2 % 1e3;
  seconds2 = absFloor(milliseconds2 / 1e3);
  data.seconds = seconds2 % 60;
  minutes2 = absFloor(seconds2 / 60);
  data.minutes = minutes2 % 60;
  hours2 = absFloor(minutes2 / 60);
  data.hours = hours2 % 24;
  days2 += absFloor(hours2 / 24);
  monthsFromDays = absFloor(daysToMonths(days2));
  months2 += monthsFromDays;
  days2 -= absCeil(monthsToDays(monthsFromDays));
  years2 = absFloor(months2 / 12);
  months2 %= 12;
  data.days = days2;
  data.months = months2;
  data.years = years2;
  return this;
}
function daysToMonths(days2) {
  return days2 * 4800 / 146097;
}
function monthsToDays(months2) {
  return months2 * 146097 / 4800;
}
function as(units) {
  if (!this.isValid()) {
    return NaN;
  }
  var days2, months2, milliseconds2 = this._milliseconds;
  units = normalizeUnits(units);
  if (units === "month" || units === "quarter" || units === "year") {
    days2 = this._days + milliseconds2 / 864e5;
    months2 = this._months + daysToMonths(days2);
    switch (units) {
      case "month":
        return months2;
      case "quarter":
        return months2 / 3;
      case "year":
        return months2 / 12;
    }
  } else {
    days2 = this._days + Math.round(monthsToDays(this._months));
    switch (units) {
      case "week":
        return days2 / 7 + milliseconds2 / 6048e5;
      case "day":
        return days2 + milliseconds2 / 864e5;
      case "hour":
        return days2 * 24 + milliseconds2 / 36e5;
      case "minute":
        return days2 * 1440 + milliseconds2 / 6e4;
      case "second":
        return days2 * 86400 + milliseconds2 / 1e3;
      case "millisecond":
        return Math.floor(days2 * 864e5) + milliseconds2;
      default:
        throw new Error("Unknown unit " + units);
    }
  }
}
function valueOf$1() {
  if (!this.isValid()) {
    return NaN;
  }
  return this._milliseconds + this._days * 864e5 + this._months % 12 * 2592e6 + toInt(this._months / 12) * 31536e6;
}
function makeAs(alias) {
  return function() {
    return this.as(alias);
  };
}
var asMilliseconds = makeAs("ms"), asSeconds = makeAs("s"), asMinutes = makeAs("m"), asHours = makeAs("h"), asDays = makeAs("d"), asWeeks = makeAs("w"), asMonths = makeAs("M"), asQuarters = makeAs("Q"), asYears = makeAs("y");
function clone$1() {
  return createDuration(this);
}
function get$2(units) {
  units = normalizeUnits(units);
  return this.isValid() ? this[units + "s"]() : NaN;
}
function makeGetter(name) {
  return function() {
    return this.isValid() ? this._data[name] : NaN;
  };
}
var milliseconds = makeGetter("milliseconds"), seconds = makeGetter("seconds"), minutes = makeGetter("minutes"), hours = makeGetter("hours"), days = makeGetter("days"), months = makeGetter("months"), years = makeGetter("years");
function weeks() {
  return absFloor(this.days() / 7);
}
var round = Math.round, thresholds = {
  ss: 44,
  // a few seconds to seconds
  s: 45,
  // seconds to minute
  m: 45,
  // minutes to hour
  h: 22,
  // hours to day
  d: 26,
  // days to month/week
  w: null,
  // weeks to month
  M: 11
  // months to year
};
function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale2) {
  return locale2.relativeTime(number || 1, !!withoutSuffix, string, isFuture);
}
function relativeTime$1(posNegDuration, withoutSuffix, thresholds2, locale2) {
  var duration = createDuration(posNegDuration).abs(), seconds2 = round(duration.as("s")), minutes2 = round(duration.as("m")), hours2 = round(duration.as("h")), days2 = round(duration.as("d")), months2 = round(duration.as("M")), weeks2 = round(duration.as("w")), years2 = round(duration.as("y")), a = seconds2 <= thresholds2.ss && ["s", seconds2] || seconds2 < thresholds2.s && ["ss", seconds2] || minutes2 <= 1 && ["m"] || minutes2 < thresholds2.m && ["mm", minutes2] || hours2 <= 1 && ["h"] || hours2 < thresholds2.h && ["hh", hours2] || days2 <= 1 && ["d"] || days2 < thresholds2.d && ["dd", days2];
  if (thresholds2.w != null) {
    a = a || weeks2 <= 1 && ["w"] || weeks2 < thresholds2.w && ["ww", weeks2];
  }
  a = a || months2 <= 1 && ["M"] || months2 < thresholds2.M && ["MM", months2] || years2 <= 1 && ["y"] || ["yy", years2];
  a[2] = withoutSuffix;
  a[3] = +posNegDuration > 0;
  a[4] = locale2;
  return substituteTimeAgo.apply(null, a);
}
function getSetRelativeTimeRounding(roundingFunction) {
  if (roundingFunction === void 0) {
    return round;
  }
  if (typeof roundingFunction === "function") {
    round = roundingFunction;
    return true;
  }
  return false;
}
function getSetRelativeTimeThreshold(threshold, limit) {
  if (thresholds[threshold] === void 0) {
    return false;
  }
  if (limit === void 0) {
    return thresholds[threshold];
  }
  thresholds[threshold] = limit;
  if (threshold === "s") {
    thresholds.ss = limit - 1;
  }
  return true;
}
function humanize(argWithSuffix, argThresholds) {
  if (!this.isValid()) {
    return this.localeData().invalidDate();
  }
  var withSuffix = false, th2 = thresholds, locale2, output;
  if (typeof argWithSuffix === "object") {
    argThresholds = argWithSuffix;
    argWithSuffix = false;
  }
  if (typeof argWithSuffix === "boolean") {
    withSuffix = argWithSuffix;
  }
  if (typeof argThresholds === "object") {
    th2 = Object.assign({}, thresholds, argThresholds);
    if (argThresholds.s != null && argThresholds.ss == null) {
      th2.ss = argThresholds.s - 1;
    }
  }
  locale2 = this.localeData();
  output = relativeTime$1(this, !withSuffix, th2, locale2);
  if (withSuffix) {
    output = locale2.pastFuture(+this, output);
  }
  return locale2.postformat(output);
}
var abs$1 = Math.abs;
function sign(x2) {
  return (x2 > 0) - (x2 < 0) || +x2;
}
function toISOString$1() {
  if (!this.isValid()) {
    return this.localeData().invalidDate();
  }
  var seconds2 = abs$1(this._milliseconds) / 1e3, days2 = abs$1(this._days), months2 = abs$1(this._months), minutes2, hours2, years2, s2, total = this.asSeconds(), totalSign, ymSign, daysSign, hmsSign;
  if (!total) {
    return "P0D";
  }
  minutes2 = absFloor(seconds2 / 60);
  hours2 = absFloor(minutes2 / 60);
  seconds2 %= 60;
  minutes2 %= 60;
  years2 = absFloor(months2 / 12);
  months2 %= 12;
  s2 = seconds2 ? seconds2.toFixed(3).replace(/\.?0+$/, "") : "";
  totalSign = total < 0 ? "-" : "";
  ymSign = sign(this._months) !== sign(total) ? "-" : "";
  daysSign = sign(this._days) !== sign(total) ? "-" : "";
  hmsSign = sign(this._milliseconds) !== sign(total) ? "-" : "";
  return totalSign + "P" + (years2 ? ymSign + years2 + "Y" : "") + (months2 ? ymSign + months2 + "M" : "") + (days2 ? daysSign + days2 + "D" : "") + (hours2 || minutes2 || seconds2 ? "T" : "") + (hours2 ? hmsSign + hours2 + "H" : "") + (minutes2 ? hmsSign + minutes2 + "M" : "") + (seconds2 ? hmsSign + s2 + "S" : "");
}
var proto$2 = Duration.prototype;
proto$2.isValid = isValid$1;
proto$2.abs = abs;
proto$2.add = add$1;
proto$2.subtract = subtract$1;
proto$2.as = as;
proto$2.asMilliseconds = asMilliseconds;
proto$2.asSeconds = asSeconds;
proto$2.asMinutes = asMinutes;
proto$2.asHours = asHours;
proto$2.asDays = asDays;
proto$2.asWeeks = asWeeks;
proto$2.asMonths = asMonths;
proto$2.asQuarters = asQuarters;
proto$2.asYears = asYears;
proto$2.valueOf = valueOf$1;
proto$2._bubble = bubble;
proto$2.clone = clone$1;
proto$2.get = get$2;
proto$2.milliseconds = milliseconds;
proto$2.seconds = seconds;
proto$2.minutes = minutes;
proto$2.hours = hours;
proto$2.days = days;
proto$2.weeks = weeks;
proto$2.months = months;
proto$2.years = years;
proto$2.humanize = humanize;
proto$2.toISOString = toISOString$1;
proto$2.toString = toISOString$1;
proto$2.toJSON = toISOString$1;
proto$2.locale = locale;
proto$2.localeData = localeData;
proto$2.toIsoString = deprecate(
  "toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",
  toISOString$1
);
proto$2.lang = lang;
addFormatToken("X", 0, 0, "unix");
addFormatToken("x", 0, 0, "valueOf");
addRegexToken("x", matchSigned);
addRegexToken("X", matchTimestamp);
addParseToken("X", function(input, array, config) {
  config._d = new Date(parseFloat(input) * 1e3);
});
addParseToken("x", function(input, array, config) {
  config._d = new Date(toInt(input));
});
//! moment.js
hooks.version = "2.29.4";
setHookCallback(createLocal);
hooks.fn = proto;
hooks.min = min;
hooks.max = max;
hooks.now = now;
hooks.utc = createUTC;
hooks.unix = createUnix;
hooks.months = listMonths;
hooks.isDate = isDate;
hooks.locale = getSetGlobalLocale;
hooks.invalid = createInvalid;
hooks.duration = createDuration;
hooks.isMoment = isMoment;
hooks.weekdays = listWeekdays;
hooks.parseZone = createInZone;
hooks.localeData = getLocale;
hooks.isDuration = isDuration;
hooks.monthsShort = listMonthsShort;
hooks.weekdaysMin = listWeekdaysMin;
hooks.defineLocale = defineLocale;
hooks.updateLocale = updateLocale;
hooks.locales = listLocales;
hooks.weekdaysShort = listWeekdaysShort;
hooks.normalizeUnits = normalizeUnits;
hooks.relativeTimeRounding = getSetRelativeTimeRounding;
hooks.relativeTimeThreshold = getSetRelativeTimeThreshold;
hooks.calendarFormat = getCalendarFormat;
hooks.prototype = proto;
hooks.HTML5_FMT = {
  DATETIME_LOCAL: "YYYY-MM-DDTHH:mm",
  // <input type="datetime-local" />
  DATETIME_LOCAL_SECONDS: "YYYY-MM-DDTHH:mm:ss",
  // <input type="datetime-local" step="1" />
  DATETIME_LOCAL_MS: "YYYY-MM-DDTHH:mm:ss.SSS",
  // <input type="datetime-local" step="0.001" />
  DATE: "YYYY-MM-DD",
  // <input type="date" />
  TIME: "HH:mm",
  // <input type="time" />
  TIME_SECONDS: "HH:mm:ss",
  // <input type="time" step="1" />
  TIME_MS: "HH:mm:ss.SSS",
  // <input type="time" step="0.001" />
  WEEK: "GGGG-[W]WW",
  // <input type="week" />
  MONTH: "YYYY-MM"
  // <input type="month" />
};
/*!
  * chartjs-adapter-moment v1.0.1
  * https://www.chartjs.org
  * (c) 2022 chartjs-adapter-moment Contributors
  * Released under the MIT license
  */
const FORMATS = {
  datetime: "MMM D, YYYY, h:mm:ss a",
  millisecond: "h:mm:ss.SSS a",
  second: "h:mm:ss a",
  minute: "h:mm a",
  hour: "hA",
  day: "MMM D",
  week: "ll",
  month: "MMM YYYY",
  quarter: "[Q]Q - YYYY",
  year: "YYYY"
};
adapters._date.override(typeof hooks === "function" ? {
  _id: "moment",
  // DEBUG ONLY
  formats: function() {
    return FORMATS;
  },
  parse: function(value, format2) {
    if (typeof value === "string" && typeof format2 === "string") {
      value = hooks(value, format2);
    } else if (!(value instanceof hooks)) {
      value = hooks(value);
    }
    return value.isValid() ? value.valueOf() : null;
  },
  format: function(time, format2) {
    return hooks(time).format(format2);
  },
  add: function(time, amount, unit) {
    return hooks(time).add(amount, unit).valueOf();
  },
  diff: function(max2, min2, unit) {
    return hooks(max2).diff(hooks(min2), unit);
  },
  startOf: function(time, unit, weekday) {
    time = hooks(time);
    if (unit === "isoWeek") {
      weekday = Math.trunc(Math.min(Math.max(0, weekday), 6));
      return time.isoWeekday(weekday).startOf("day").valueOf();
    }
    return time.startOf(unit).valueOf();
  },
  endOf: function(time, unit) {
    return hooks(time).endOf(unit).valueOf();
  }
} : {});
function mapZero(value) {
  return value === 0 ? NaN : value;
}
function ChartPanel(props) {
  const [data1, setData1] = reactExports.useState(store.chartData.map((p2) => ({ x: p2.time, y: mapZero(p2.in) })));
  const [data2, setData2] = reactExports.useState(store.chartData.map((p2) => ({ x: p2.time, y: mapZero(p2.out) })));
  const chartData = {
    datasets: [
      {
        label: "Sent",
        backgroundColor: "rgb(99, 255, 132)",
        borderColor: "transparent",
        data: data2,
        yAxisID: "Y"
      },
      {
        label: "Received",
        backgroundColor: "rgb(255, 99, 132)",
        borderColor: "rgb(255, 99, 132)",
        data: data1,
        lineTension: 0.3,
        yAxisID: "Y"
      }
    ]
  };
  reactExports.useEffect(() => {
    const listener = (message) => {
      if (message.type === "initial") {
        const d1 = store.chartData.map((p2) => ({ x: p2.time, y: mapZero(p2.in) }));
        setData1(d1);
        const d2 = store.chartData.map((p2) => ({ x: p2.time, y: mapZero(p2.out) }));
        setData2(d2);
      } else if (message.type === "update") {
        const d1 = message.chartData.map((p2) => ({ x: p2.time, y: mapZero(p2.in) }));
        setData1((d) => {
          let newData = [...d, ...d1];
          if (newData.length > CHART_SIZE) {
            newData = newData.slice(newData.length - CHART_SIZE);
          }
          return newData;
        });
        const d2 = message.chartData.map((p2) => ({ x: p2.time, y: mapZero(p2.out) }));
        setData2((d) => {
          let newData = [...d, ...d2];
          if (newData.length > CHART_SIZE) {
            newData = newData.slice(newData.length - CHART_SIZE);
          }
          return newData;
        });
      }
    };
    events.on("initial", listener);
    events.on("update", listener);
    return () => {
      events.off("initial", listener);
      events.off("update", listener);
    };
  }, []);
  const yaxisType = props.yaxisType;
  return /* @__PURE__ */ jsxRuntimeExports.jsx(
    Line,
    {
      data: chartData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        animation: {
          duration: 0
        },
        scales: {
          xAxis: {
            type: "time",
            offset: true,
            time: {
              unit: "second"
            },
            ticks: {
              major: {
                enabled: true
              }
            }
          },
          Y: {
            type: yaxisType,
            position: "left",
            title: {
              display: true,
              text: "characters/sec"
            }
          }
        }
      }
    }
  );
}
const ROW_HEIGHT = 25;
function ApiLog() {
  const [selectedRow, setSelectedRow] = reactExports.useState(null);
  const [apiLines, setApiLines] = reactExports.useState(store.apiLines);
  const gridApi = reactExports.useRef(null);
  const toolbarRef = reactExports.useRef(null);
  const [showDetail, setShowDetail] = reactExports.useState(false);
  const scrollToBottom = reactExports.useRef(false);
  const { onFind, findRegEx } = useFind(apiLines, getApiFindText, gridApi, scrollToBottom);
  const apiLinesRef = reactExports.useRef(apiLines);
  const onFindRef = reactExports.useRef(null);
  const filter = reactExports.useRef(null);
  const [, setApiFilterText] = reactExports.useState("");
  apiLinesRef.current = apiLines;
  const [columnDefs] = reactExports.useState([
    {
      headerName: "Line",
      field: "lineNumber",
      width: 80,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true
    },
    {
      field: "timestamp",
      width: 270,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true,
      cellRenderer: (p2) => {
        return highlightCellRenderer(p2.data.timestamp, findRegEx.current);
      }
    },
    {
      field: "classType",
      headerName: "Class",
      width: 200,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true,
      cellRenderer: (p2) => {
        return highlightCellRenderer(p2.data.classType, findRegEx.current);
      }
    },
    {
      field: "method",
      width: 250,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true,
      cellRenderer: (p2) => {
        return highlightCellRenderer(p2.data.method, findRegEx.current);
      }
    },
    {
      field: "params",
      headerName: "Parameters",
      width: 2e3,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true,
      valueFormatter: () => {
        return "";
      },
      cellRenderer: (p2) => {
        const v2 = getParamsJson(p2.data);
        return highlightCellRenderer(v2, findRegEx.current);
      }
    },
    {
      field: "type",
      width: 100,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true,
      cellRenderer: (p2) => {
        return highlightCellRenderer(p2.data.type, findRegEx.current);
      }
    },
    {
      field: "caller",
      width: 300,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true,
      cellRenderer: (p2) => {
        return highlightCellRenderer(p2.data.caller, findRegEx.current);
      }
    },
    {
      field: "subscriptionId",
      width: 300,
      resizable: true,
      cellStyle: { textAlign: "left" },
      sortable: true,
      cellRenderer: (p2) => {
        return highlightCellRenderer(p2.data.subscriptionId, findRegEx.current);
      }
    }
  ]);
  reactExports.useEffect(() => {
    const listener = (message) => {
      if (message.type === "initial") {
        const addLines = filterApiLines(store.apiLines, filter.current);
        setApiLines(addLines);
      } else {
        const addLines = filterApiLines(message.apiLines, filter.current);
        setApiLines((apiLines2) => {
          return [...apiLines2, ...addLines];
        });
      }
    };
    const filterListener = (message) => {
      var _a2;
      setApiFilterText(message);
      (_a2 = toolbarRef.current) == null ? void 0 : _a2.updateFilterText(message);
      filter.current = new RegExp(message);
      setApiLines(filterApiLines(store.apiLines, filter.current));
    };
    events.on("initial", listener);
    events.on("update", listener);
    events.on("externalFilterChange", filterListener);
    return () => {
      events.off("reloadApi", listener);
      events.off("update", listener);
      events.off("externalFilterChange", filterListener);
    };
  }, []);
  reactExports.useEffect(() => {
    if (scrollToBottom.current && gridApi.current && apiLines.length > 0) {
      gridApi.current.ensureIndexVisible(apiLines.length - 1);
    }
  });
  function onFilter(regex) {
    filter.current = regex;
    setApiLines(filterApiLines(store.apiLines, filter.current));
  }
  function onClear() {
    store.onClearApi();
    setApiLines([]);
  }
  function filterApiLines(apiLines2, regex) {
    if (regex === null) {
      return apiLines2;
    }
    const filteredLines = apiLines2.filter((l2) => getApiFindText(l2).match(regex));
    return filteredLines;
  }
  onFindRef.current = onFind;
  const onKeyDown = (evt) => {
    const event = evt.event;
    if (event.code === "Enter") {
      onFindRef.current(findRegEx.current, !event.shiftKey);
    } else if (event.metaKey || event.ctrlKey) {
      if (event.code === "KeyC") {
        const selected = gridApi.current.getSelectedNodes();
        const lines = selected.map((r2) => getApiFindText(apiLinesRef.current[r2.rowIndex]));
        copyTextToClipboard(lines.join("\n"));
      } else if (event.code === "KeyA") {
        gridApi.current.selectAll();
      }
    }
  };
  const onCellDoubleClicked = () => {
    setShowDetail(true);
  };
  const toggleShowDetail = () => {
    setShowDetail(!showDetail);
  };
  const onRowSelected = (event) => {
    if (event.node.isSelected()) {
      setSelectedRow(event.data);
    }
  };
  const onBodyScroll = (p2) => {
    if (p2.direction === "vertical") {
      const gridBottom = gridApi.current.getVerticalPixelRange().bottom;
      if (gridBottom !== 0) {
        scrollToBottom.current = Math.abs(gridBottom - apiLinesRef.current.length * ROW_HEIGHT) < ROW_HEIGHT;
      }
    }
  };
  const getRowId = (r2) => {
    return String(r2.data.index);
  };
  const getRowStyle = (params) => {
    const data = params.data;
    if (data.type === "call") {
      if (data.method === "subscribe" || data.method === "unsubscribe") {
        return { background: "#BFE9DB    " };
      }
      return { background: "#E4F9F5" };
    }
    if (data.type === "callback" && data.classType === "ConnectionListener") {
      return { background: "#FFFFE7" };
    }
  };
  const splitterComponents = [];
  splitterComponents.push(/* @__PURE__ */ jsxRuntimeExports.jsx(
    main.AgGridReact,
    {
      rowData: apiLines,
      rowSelection: "multiple",
      rowHeight: ROW_HEIGHT,
      getRowId,
      onRowSelected,
      headerHeight: ROW_HEIGHT,
      columnDefs,
      onGridReady: (p2) => gridApi.current = p2.api,
      gridOptions: {
        onBodyScroll,
        getRowStyle,
        onCellKeyDown: onKeyDown,
        onCellDoubleClicked
      }
    }
  ));
  if (showDetail) {
    let displayObj = "";
    if (selectedRow) {
      displayObj = JSON.stringify({
        lineNumber: selectedRow.lineNumber,
        timestamp: selectedRow.timestamp,
        "class": selectedRow.classType,
        method: selectedRow.method,
        params: selectedRow.params,
        type: selectedRow.type,
        caller: selectedRow.caller,
        subscriptionId: selectedRow.subscriptionId
      }, null, "	");
    }
    splitterComponents.push(
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "detail-panel", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
        "pre",
        {
          className: "detail-panel-pre",
          children: selectedRow ? highlightCellRenderer(displayObj, findRegEx.current) : ""
        }
      ) })
    );
  }
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "container ag-theme-alpine", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      Toolbar,
      {
        ref: toolbarRef,
        showLevel: false,
        onFind,
        onFilter,
        onClear,
        toggleShowDetail,
        showDetail
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Splitter, { components: splitterComponents })
  ] });
}
function getApiFindText(obj) {
  return obj.timestamp + "	" + obj.classType + "	" + obj.method + "	" + getParamsJson(obj) + "	" + obj.type + "	" + obj.caller + "	" + obj.subscriptionId;
}
function getParamsJson(obj) {
  let json = "";
  if (obj !== void 0) {
    const paramsJson = obj.paramsJson;
    if (paramsJson !== void 0) {
      json = paramsJson;
    } else {
      json = JSON.stringify(obj.params);
      obj.paramsJson = json;
    }
  }
  return json;
}
const layoutJson = {
  "global": {
    // "tabSetTabLocation": "bottom",
    "tabEnableClose": false,
    "tabEnableRename": false,
    "enableEdgeDock": false,
    "tabSetMinHeight": 25,
    "tabSetMinWidth": 25
  },
  "layout": {
    "type": "row",
    "children": [
      {
        "type": "tabset",
        "weight": 50,
        "children": [
          {
            "type": "tab",
            "name": "StreamLink Log",
            "component": "streamlinklog"
          },
          {
            "type": "tab",
            "id": "apilog",
            "name": "API Log",
            "component": "apilog"
          },
          {
            "type": "tab",
            "name": "Subscriptions",
            "component": "subscriptions"
          },
          {
            "type": "tab",
            "name": "Tools",
            "component": "message_interceptor"
          },
          {
            "type": "tab",
            "name": "Data Flow",
            "component": "chart"
          }
        ]
      }
    ]
  }
};
function App() {
  const [dataFlowAxisType, setDataFlowAxisType] = reactExports.useState("linear");
  const [flexModel] = reactExports.useState(Model.fromJson(layoutJson));
  const factory = (node) => {
    switch (node.getComponent()) {
      case "streamlinklog":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(StreamLinkLog, {});
      case "apilog":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(ApiLog, {});
      case "subscriptions":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(SubscriptionPanel, { parentModel: flexModel });
      case "chart":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(ChartPanel, { yaxisType: dataFlowAxisType });
      case "message_interceptor":
        return /* @__PURE__ */ jsxRuntimeExports.jsx(ToolsPanel, {});
    }
  };
  function handleChange(e) {
    setDataFlowAxisType(e.target.checked ? "logarithmic" : "linear");
  }
  function onRenderTabSet(tabSetNode, renderValues) {
    const selectedNode = tabSetNode.getSelectedNode();
    if (selectedNode instanceof TabNode) {
      const selectedTab = selectedNode;
      if (selectedTab.getComponent() === "chart") {
        renderValues.buttons.push(
          /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("input", { checked: dataFlowAxisType === "logarithmic", type: "checkbox", onChange: handleChange }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { style: { marginLeft: 5, marginRight: 5 }, children: "Logarithmic" })
          ] })
        );
      }
    }
  }
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Layout, { model: flexModel, factory, onRenderTabSet });
}
const index = "";
class Store {
  constructor() {
    __publicField(this, "subscriptions");
    __publicField(this, "logLines");
    __publicField(this, "apiLines");
    __publicField(this, "chartData");
    __publicField(this, "subscription");
    __publicField(this, "port");
    __publicField(this, "portToStreamLink");
    __publicField(this, "portFromStreamLink");
    __publicField(this, "toolsConfig");
    __publicField(this, "toolsConfigApplied");
    this.subscriptions = [];
    this.logLines = [];
    this.apiLines = [];
    this.chartData = [];
    this.subscription = null;
    this.port = null;
    this.portToStreamLink = null;
    this.portFromStreamLink = null;
    this.toolsConfig = {};
    this.toolsConfigApplied = false;
  }
  onClearLog() {
    this.logLines = [];
  }
  onClearApi() {
    this.apiLines = [];
  }
}
const events = new eventsExports.EventEmitter();
const store = new Store();
function connectToContentScript() {
  if (chrome && chrome.devtools) {
    try {
      store.port = chrome.tabs.connect(chrome.devtools.inspectedWindow.tabId, { name: "__caplin_streamlink_devtool__" });
      store.port.onMessage.addListener(onMessage);
    } catch (e) {
      console.log("Unable to connect as Chrome dev tool");
    }
  } else {
    store.portFromStreamLink = new BroadcastChannel("__from_caplin_streamlink__");
    store.portToStreamLink = new BroadcastChannel("__to_caplin_streamlink__");
    store.portFromStreamLink.onmessage = (msg) => {
      if (msg.data.type === "connect") {
        store.portToStreamLink.postMessage({ type: "connect" });
      }
      onMessage(msg.data);
    };
    store.portToStreamLink.postMessage({ type: "connect" });
  }
}
connectToContentScript();
try {
  chrome.tabs.onUpdated.addListener(function(tabId, changeInfo) {
    if (tabId == chrome.devtools.inspectedWindow.tabId && changeInfo.status === "complete") {
      connectToContentScript();
    }
  });
} catch (e) {
}
const LOG_SIZE = 1e4;
const CHART_SIZE = 60;
let nextLogIndex = 1;
let nextApiIndex = 1;
function onMessage(message) {
  if (message.logLines) {
    message.logLines.forEach((m2) => m2.index = nextLogIndex++);
    message.apiLines.forEach((m2) => m2.index = nextApiIndex++);
  }
  switch (message.type) {
    case "initial":
      store.subscriptions = message.subscriptions.sort((a, b) => a.subject.localeCompare(b.subject));
      store.logLines = message.logLines;
      store.apiLines = message.apiLines;
      store.chartData = message.chartData;
      store.toolsConfig = message.toolsConfig;
      store.toolsConfigApplied = message.toolsConfigApplied;
      break;
    case "update":
      {
        let newLogLines = [...store.logLines, ...message.logLines];
        let newApiLines = [...store.apiLines, ...message.apiLines];
        let newChartData = [...store.chartData, ...message.chartData];
        if (newLogLines.length > LOG_SIZE * 2) {
          newLogLines = newLogLines.slice(LOG_SIZE);
          message.type = "initial";
        }
        if (newApiLines.length > LOG_SIZE * 2) {
          newApiLines = newApiLines.slice(LOG_SIZE);
          message.type = "initial";
        }
        if (newChartData.length > CHART_SIZE) {
          newChartData = newChartData.slice(newChartData.length - CHART_SIZE);
        }
        store.subscriptions = message.subscriptions.sort((a, b) => a.subject.localeCompare(b.subject));
        store.logLines = newLogLines;
        store.apiLines = newApiLines;
        store.chartData = newChartData;
      }
      break;
    case "updateSubscription":
      store.subscription = message.subscription;
      break;
  }
  events.emit(message.type, message);
}
createRoot(document.getElementById("root")).render(
  /* @__PURE__ */ jsxRuntimeExports.jsx(reactExports.StrictMode, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(App, {}) })
);
//# sourceMappingURL=index-96ff46d3.js.map
